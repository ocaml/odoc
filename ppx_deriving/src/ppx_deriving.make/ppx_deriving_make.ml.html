<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: ppx_deriving_make.ml (ppx_deriving.src.ppx_deriving.make)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ppx_deriving</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; ppx_deriving.make &#x00BB; ppx_deriving_make.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>ppx_deriving_make.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ppx_deriving</a><ul><li>Library <code>ppx_deriving.api</code><ul><li><a href="../../ppx_deriving.api/Ppx_deriving/index.html">Ppx_deriving</a></li></ul></li><li>Library <code>ppx_deriving.create</code><ul><li><a href="../../ppx_deriving.create/Ppx_deriving_create/index.html">Ppx_deriving_create</a></li></ul></li><li>Library <code>ppx_deriving.enum</code><ul><li><a href="../../ppx_deriving.enum/Ppx_deriving_enum/index.html">Ppx_deriving_enum</a></li></ul></li><li>Library <code>ppx_deriving.eq</code><ul><li><a href="../../ppx_deriving.eq/Ppx_deriving_eq/index.html">Ppx_deriving_eq</a></li></ul></li><li>Library <code>ppx_deriving.fold</code><ul><li><a href="../../ppx_deriving.fold/Ppx_deriving_fold/index.html">Ppx_deriving_fold</a></li></ul></li><li>Library <code>ppx_deriving.iter</code><ul><li><a href="../../ppx_deriving.iter/Ppx_deriving_iter/index.html">Ppx_deriving_iter</a></li></ul></li><li>Library <code>ppx_deriving.make</code><ul><li><a href="../../ppx_deriving.make/Ppx_deriving_make/index.html">Ppx_deriving_make</a></li></ul></li><li>Library <code>ppx_deriving.map</code><ul><li><a href="../../ppx_deriving.map/Ppx_deriving_map/index.html">Ppx_deriving_map</a></li></ul></li><li>Library <code>ppx_deriving.ord</code><ul><li><a href="../../ppx_deriving.ord/Ppx_deriving_ord/index.html">Ppx_deriving_ord</a></li></ul></li><li>Library <code>ppx_deriving.runtime</code><ul><li><a href="../../ppx_deriving.runtime/Ppx_deriving_runtime/index.html">Ppx_deriving_runtime</a></li></ul></li><li>Library <code>ppx_deriving.show</code><ul><li><a href="../../ppx_deriving.show/Ppx_deriving_show/index.html">Ppx_deriving_show</a></li></ul></li><li>Library <code>ppx_deriving.std</code><ul><li><a href="../../ppx_deriving.std/Ppx_deriving_std/index.html">Ppx_deriving_std</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>ppx_deriving.api<ul><li><a href="../ppx_deriving.api/ppx_deriving.ml.html">ppx_deriving.ml</a></li></ul></li><li>ppx_deriving.create<ul><li><a href="../ppx_deriving.create/ppx_deriving_create.ml.html">ppx_deriving_create.ml</a></li></ul></li><li>ppx_deriving.enum<ul><li><a href="../ppx_deriving.enum/ppx_deriving_enum.ml.html">ppx_deriving_enum.ml</a></li></ul></li><li>ppx_deriving.eq<ul><li><a href="../ppx_deriving.eq/ppx_deriving_eq.ml.html">ppx_deriving_eq.ml</a></li></ul></li><li>ppx_deriving.fold<ul><li><a href="../ppx_deriving.fold/ppx_deriving_fold.ml.html">ppx_deriving_fold.ml</a></li></ul></li><li>ppx_deriving.iter<ul><li><a href="../ppx_deriving.iter/ppx_deriving_iter.ml.html">ppx_deriving_iter.ml</a></li></ul></li><li>ppx_deriving.make<ul><li><a href="#" class="current_unit">ppx_deriving_make.ml</a></li></ul></li><li>ppx_deriving.map<ul><li><a href="../ppx_deriving.map/ppx_deriving_map.ml.html">ppx_deriving_map.ml</a></li></ul></li><li>ppx_deriving.ord<ul><li><a href="../ppx_deriving.ord/ppx_deriving_ord.ml.html">ppx_deriving_ord.ml</a></li></ul></li><li>ppx_deriving.runtime<ul><li><a href="../ppx_deriving.runtime/ppx_deriving_runtime.ml.html">ppx_deriving_runtime.ml</a></li></ul></li><li>ppx_deriving.show<ul><li><a href="../ppx_deriving.show/ppx_deriving_show.ml.html">ppx_deriving_show.ml</a></li></ul></li><li>ppx_deriving.std<ul><li><a href="../ppx_deriving.std/ppx_deriving_std.ml.html">ppx_deriving_std.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
</code><code class="source_code"><span><span class="OPEN">open</span> <a href="../../../ppxlib/src/ppxlib/ppxlib.ml.html"><span class="UIDENT">Ppxlib</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_500.ml.html#module-Asttypes"><span class="UIDENT">Asttypes</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_500.ml.html#module-Parsetree"><span class="UIDENT">Parsetree</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html"><span class="UIDENT">Ast_helper</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="UIDENT">Ast_convenience</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-deriver"><span class="LIDENT">deriver</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;make&quot;</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-raise_errorf"><span class="LIDENT">raise_errorf</span></span> <span class="EQUAL">=</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-raise_errorf"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">raise_errorf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-{attr_default}1/shadowed/(ppx_deriving-src-ppx_deriving.make-ppx_deriving_make.ml)"><span class="LIDENT">attr_default</span></span> <span id="local_context_1"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-declare"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">declare</span></a> <span class="STRING">&quot;deriving.make.default&quot;</span> <a href="#local_context_1"><span class="LIDENT">context</span></a><span class="EOL">
</span>  <a href="../../../ppxlib/src/ppxlib/ast_pattern.ml.html"><span class="UIDENT">Ast_pattern</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib/ast_pattern.ml.html#val-single_expr_payload"><span class="LIDENT">single_expr_payload</span></a> <a href="../../../ppxlib/src/ppxlib/ast_pattern.ml.html#val-__"><span class="LIDENT">__</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_2"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_e_2"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-attr_default"><span class="LIDENT">attr_default</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">attr_default</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#module-Context.val-label_declaration"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="UIDENT">Context</span><span class="DOT">.</span><span class="LIDENT">label_declaration</span></a><span class="COMMA">,</span> <span class="LIDENT">attr_default</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#module-Context.val-core_type"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="UIDENT">Context</span><span class="DOT">.</span><span class="LIDENT">core_type</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mk_attr_split"><span class="LIDENT">mk_attr_split</span></span> <span id="local_context_3"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-declare_flag"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">declare_flag</span></a> <span class="STRING">&quot;deriving.make.split&quot;</span> <a href="#local_context_3"><span class="LIDENT">context</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-ct_attr_split"><span class="LIDENT">ct_attr_split</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_attr_split</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#module-Context.val-core_type"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="UIDENT">Context</span><span class="DOT">.</span><span class="LIDENT">core_type</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-label_attr_split"><span class="LIDENT">label_attr_split</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_attr_split</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#module-Context.val-label_declaration"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="UIDENT">Context</span><span class="DOT">.</span><span class="LIDENT">label_declaration</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-attr_split"><span class="LIDENT">attr_split</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">label_attr_split</span><span class="COMMA">,</span> <span class="LIDENT">ct_attr_split</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mk_attr_main"><span class="LIDENT">mk_attr_main</span></span> <span id="local_context_4"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-declare_flag"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">declare_flag</span></a> <span class="STRING">&quot;deriving.make.main&quot;</span> <a href="#local_context_4"><span class="LIDENT">context</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-ct_attr_main"><span class="LIDENT">ct_attr_main</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_attr_main</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#module-Context.val-core_type"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="UIDENT">Context</span><span class="DOT">.</span><span class="LIDENT">core_type</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-label_attr_main"><span class="LIDENT">label_attr_main</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_attr_main</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#module-Context.val-label_declaration"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="UIDENT">Context</span><span class="DOT">.</span><span class="LIDENT">label_declaration</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-attr_main"><span class="LIDENT">attr_main</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">label_attr_main</span><span class="COMMA">,</span> <span class="LIDENT">ct_attr_main</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_label_attribute"><span class="LIDENT">get_label_attribute</span></span> <span class="LPAREN">(</span><span id="local_label_attr_5"><span class="LIDENT">label_attr</span></span><span class="COMMA">,</span> <span id="local_ct_attr_6"><span class="LIDENT">ct_attr</span></span><span class="RPAREN">)</span> <span id="local_label_7"><span class="LIDENT">label</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-get"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_label_attr_5"><span class="LIDENT">label_attr</span></a> <a href="#local_label_7"><span class="LIDENT">label</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_v_8"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_v_8"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-get"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_ct_attr_6"><span class="LIDENT">ct_attr</span></a> <a href="#local_label_7"><span class="LIDENT">label</span></a><span class="DOT">.</span><span class="LIDENT">pld_type</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-has_label_flag"><span class="LIDENT">has_label_flag</span></span> <span class="LPAREN">(</span><span id="local_label_flag_9"><span class="LIDENT">label_flag</span></span><span class="COMMA">,</span> <span id="local_ct_flag_10"><span class="LIDENT">ct_flag</span></span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LBRACE">{</span><span id="local_pld_type_12"><span class="LIDENT">pld_type</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_label_11"><span class="LIDENT">label</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-has_flag"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">has_flag</span></a> <a href="#local_ct_flag_10"><span class="LIDENT">ct_flag</span></a> <a href="#local_pld_type_12"><span class="LIDENT">pld_type</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="../../../ppxlib/src/ppxlib/attribute.ml.html#val-has_flag"><span class="UIDENT">Attribute</span><span class="DOT">.</span><span class="LIDENT">has_flag</span></a> <a href="#local_label_flag_9"><span class="LIDENT">label_flag</span></a> <a href="#local_label_11"><span class="LIDENT">label</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_main"><span class="LIDENT">find_main</span></span> <span id="local_labels_13"><span class="LIDENT">labels</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_99"><span id="local_mains_14"><span class="LIDENT">mains</span></span><span class="COMMA">,</span> <span id="local_regulars_15"><span class="LIDENT">regulars</span></span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-partition"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">partition</span></a> <span class="LPAREN">(</span><span class="LIDENT">has_label_flag</span> <span class="LIDENT">attr_main</span><span class="RPAREN">)</span> <a href="#local_labels_13"><span class="LIDENT">labels</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_mains_14"><span class="LIDENT">mains</span></a><span class="COMMA">,</span> <a href="#local_regulars_15"><span class="LIDENT">regulars</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <span id="local_labels_16"><span class="LIDENT">labels</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="UIDENT">None</span><span class="COMMA">,</span> <a href="#local_labels_16"><span class="LIDENT">labels</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span id="local_main_17"><span class="LIDENT">main</span></span><span class="RBRACKET">]</span><span class="COMMA">,</span> <span id="local_labels_18"><span class="LIDENT">labels</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_main_17"><span class="LIDENT">main</span></a><span class="COMMA">,</span> <a href="#local_labels_18"><span class="LIDENT">labels</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COLONCOLON">::</span><span class="LBRACE">{</span><span id="local_pld_loc_19"><span class="LIDENT">pld_loc</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span><span class="COLONCOLON">::</span><span class="UNDERSCORE">_</span> <span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Error</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib/location.ml.html#val-error_extensionf"><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">error_extensionf</span></a> <span class="LABEL">~loc:</span><a href="#local_pld_loc_19"><span class="LIDENT">pld_loc</span></a><span class="EOL">
</span>         <span class="STRING">&quot;Duplicate [@deriving.%s.main] annotation&quot;</span> <span class="LIDENT">deriver</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_optional"><span class="LIDENT">is_optional</span></span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">pld_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_21"><span class="LIDENT">name</span></span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_pld_type_22"><span class="LIDENT">pld_type</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_label_20"><span class="LIDENT">label</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">get_label_attribute</span> <span class="LIDENT">attr_default</span> <a href="#local_label_20"><span class="LIDENT">label</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">has_label_flag</span> <span class="LIDENT">attr_split</span> <a href="#local_label_20"><span class="LIDENT">label</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-remove_pervasives"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">remove_pervasives</span></a> <span class="TILDE">~</span><span class="LIDENT">deriver</span> <a href="#local_pld_type_22"><span class="LIDENT">pld_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span class="UNDERSCORE">_</span><span class="RBRACKET">]</span> <span class="LIDENT">list</span><span class="RBRACKET">]</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span class="UNDERSCORE">_</span><span class="RBRACKET">]</span> <span class="LIDENT">option</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_str_label_arg"><span class="LIDENT">add_str_label_arg</span></span> <span class="TILDE">~</span><span id="local_quoter_23"><span class="LIDENT">quoter</span></span> <span class="TILDE">~</span><span id="local_loc_24"><span class="LIDENT">loc</span></span> <span id="local_accum_25"><span class="LIDENT">accum</span></span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LBRACE">{</span><span class="LIDENT">pld_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_27"><span class="LIDENT">name</span></span><span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_pld_type_28"><span class="LIDENT">pld_type</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_label_26"><span class="LIDENT">label</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">get_label_attribute</span> <span class="LIDENT">attr_default</span> <a href="#local_label_26"><span class="LIDENT">label</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_default_29"><span class="LIDENT">default</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#val-quote"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">quote</span></a> <span class="TILDE">~</span><a href="#local_quoter_23"><span class="LIDENT">quoter</span></a> <a href="#local_default_29"><span class="LIDENT">default</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <a href="#local_accum_25"><span class="LIDENT">accum</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pld_type_30"><span class="LIDENT">pld_type</span></span> <span class="EQUAL">=</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-remove_pervasives"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">remove_pervasives</span></a> <span class="TILDE">~</span><span class="LIDENT">deriver</span> <a href="#local_pld_type_28"><span class="LIDENT">pld_type</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">has_label_flag</span> <span class="LIDENT">attr_split</span> <a href="#local_label_26"><span class="LIDENT">label</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_pld_type_30"><span class="LIDENT">pld_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span id="local_lhs_31"><span class="LIDENT">lhs</span></span><span class="RBRACKET">]</span> <span class="STAR">*</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span id="local_rhs_32"><span class="LIDENT">rhs</span></span><span class="RBRACKET">]</span> <span class="LIDENT">list</span><span class="RBRACKET">]</span> <span class="WHEN">when</span> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'s'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_name'_33"><span class="LIDENT">name'</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-labelled"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">labelled</span></a> <a href="#local_name'_33"><span class="LIDENT">name'</span></a><span class="RPAREN">)</span> <span class="UIDENT">None</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name'_33"><span class="LIDENT">name'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">expr</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">expr</span> <span class="LET">let</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">p</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RBRACKET">]</span> <span class="EQUAL">=</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">e</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-evar"><span class="LIDENT">evar</span></a> <a href="#local_name'_33"><span class="LIDENT">name'</span></a><span class="RBRACKET">]</span><span class="COMMA">,</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">e</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-evar"><span class="LIDENT">evar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RBRACKET">]</span> <span class="IN">in</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">e</span> <a href="#local_accum_25"><span class="LIDENT">accum</span></a><span class="RBRACKET">]</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib/ast_builder_generated.ml.html#module-M.val-pexp_extension"><span class="UIDENT">Ast_builder</span><span class="DOT">.</span><span class="UIDENT">Default</span><span class="DOT">.</span><span class="LIDENT">pexp_extension</span></a> <span class="TILDE">~</span><a href="#local_loc_24"><span class="LIDENT">loc</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib/location.ml.html#val-error_extensionf"><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">error_extensionf</span></a> <span class="TILDE">~</span><a href="#local_loc_24"><span class="LIDENT">loc</span></a><span class="EOL">
</span>             <span class="STRING">&quot;[@deriving.%s.split] annotation requires a type of form \
              'a * 'a list and label name ending with `s'&quot;</span><span class="EOL">
</span>             <span class="LIDENT">deriver</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_pld_type_30"><span class="LIDENT">pld_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span class="UNDERSCORE">_</span><span class="RBRACKET">]</span> <span class="LIDENT">list</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">expr</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <a href="#local_accum_25"><span class="LIDENT">accum</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span class="UNDERSCORE">_</span><span class="RBRACKET">]</span> <span class="LIDENT">option</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="UIDENT">None</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <a href="#local_accum_25"><span class="LIDENT">accum</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-labelled"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">labelled</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="UIDENT">None</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_27"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <a href="#local_accum_25"><span class="LIDENT">accum</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-str_of_record_type"><span class="LIDENT">str_of_record_type</span></span> <span class="TILDE">~</span><span id="local_quoter_34"><span class="LIDENT">quoter</span></span> <span class="TILDE">~</span><span id="local_loc_35"><span class="LIDENT">loc</span></span> <span id="local_labels_36"><span class="LIDENT">labels</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_fields_37"><span class="LIDENT">fields</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_labels_36"><span class="LIDENT">labels</span></a> <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LBRACE">{</span> <span class="LIDENT">pld_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_38"><span class="LIDENT">name</span></span><span class="SEMI">;</span> <span id="local_loc_39"><span class="LIDENT">loc</span></span> <span class="RBRACE">}</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_name_38"><span class="LIDENT">name</span></a><span class="COMMA">,</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-evar"><span class="LIDENT">evar</span></a> <a href="#local_name_38"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">find_main</span> <a href="#local_labels_36"><span class="LIDENT">labels</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_extension_40"><span class="LIDENT">extension</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib/ast_builder_generated.ml.html#module-M.val-pexp_extension"><span class="UIDENT">Ast_builder</span><span class="DOT">.</span><span class="UIDENT">Default</span><span class="DOT">.</span><span class="LIDENT">pexp_extension</span></a> <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a> <a href="#local_extension_40"><span class="LIDENT">extension</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span id="local_main_41"><span class="LIDENT">main</span></span><span class="COMMA">,</span> <span id="local_labels_42"><span class="LIDENT">labels</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_has_option_43"><span class="LIDENT">has_option</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-exists"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">exists</span></a> <span class="LIDENT">is_optional</span> <a href="#local_labels_42"><span class="LIDENT">labels</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_fn_44"><span class="LIDENT">fn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_main_41"><span class="LIDENT">main</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span class="LIDENT">pld_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_45"><span class="LIDENT">name</span></span> <span class="RBRACE">}</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-nolabel"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">nolabel</span></a> <span class="UIDENT">None</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <a href="#local_name_45"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-record"><span class="LIDENT">record</span></a> <a href="#local_fields_37"><span class="LIDENT">fields</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="WHEN">when</span> <a href="#local_has_option_43"><span class="LIDENT">has_option</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Exp.val-fun_"><span class="UIDENT">Exp</span><span class="DOT">.</span><span class="LIDENT">fun_</span></a> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-nolabel"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">nolabel</span></a> <span class="UIDENT">None</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-punit"><span class="LIDENT">punit</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-record"><span class="LIDENT">record</span></a> <a href="#local_fields_37"><span class="LIDENT">fields</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-record"><span class="LIDENT">record</span></a> <a href="#local_fields_37"><span class="LIDENT">fields</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* The labels list must be reversed here so that the arguments are in the
       same order as the record fields. *)</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <span class="LPAREN">(</span><span class="LIDENT">add_str_label_arg</span> <span class="TILDE">~</span><a href="#local_quoter_34"><span class="LIDENT">quoter</span></a> <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="RPAREN">)</span> <a href="#local_fn_44"><span class="LIDENT">fn</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_labels_42"><span class="LIDENT">labels</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-str_of_type"><span class="LIDENT">str_of_type</span></span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">ptype_loc</span> <span class="EQUAL">=</span> <span id="local_loc_47"><span class="LIDENT">loc</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_type_decl_46"><span class="LIDENT">type_decl</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_quoter_48"><span class="LIDENT">quoter</span></span> <span class="EQUAL">=</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-create_quoter"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">create_quoter</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_type_decl_46"><span class="LIDENT">type_decl</span></a><span class="DOT">.</span><span class="LIDENT">ptype_kind</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ptype_record</span> <span id="local_labels_49"><span class="LIDENT">labels</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_creator_50"><span class="LIDENT">creator</span></span> <span class="EQUAL">=</span> <span class="LIDENT">str_of_record_type</span> <span class="TILDE">~</span><a href="#local_quoter_48"><span class="LIDENT">quoter</span></a> <span class="TILDE">~</span><a href="#local_loc_47"><span class="LIDENT">loc</span></a> <a href="#local_labels_49"><span class="LIDENT">labels</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Ok</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Vb.val-mk"><span class="UIDENT">Vb</span><span class="DOT">.</span><span class="LIDENT">mk</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-pvar"><span class="LIDENT">pvar</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#val-mangle_type_decl"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">mangle_type_decl</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefix</span> <span class="LIDENT">deriver</span><span class="RPAREN">)</span> <a href="#local_type_decl_46"><span class="LIDENT">type_decl</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>         <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#val-sanitize"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">sanitize</span></a> <span class="TILDE">~</span><a href="#local_quoter_48"><span class="LIDENT">quoter</span></a> <a href="#local_creator_50"><span class="LIDENT">creator</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Error</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib/location.ml.html#val-error_extensionf"><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">error_extensionf</span></a> <span class="TILDE">~</span><a href="#local_loc_47"><span class="LIDENT">loc</span></a><span class="EOL">
</span>         <span class="STRING">&quot;%s can be derived only for record types&quot;</span> <span class="LIDENT">deriver</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-wrap_predef_option"><span class="LIDENT">wrap_predef_option</span></span> <span id="local_typ_51"><span class="LIDENT">typ</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_typ_51"><span class="LIDENT">typ</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_sig_label_arg"><span class="LIDENT">add_sig_label_arg</span></span> <span id="local_accum_52"><span class="LIDENT">accum</span></span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LBRACE">{</span><span class="LIDENT">pld_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_54"><span class="LIDENT">name</span></span><span class="SEMI">;</span> <span id="local_loc_55"><span class="LIDENT">loc</span></span><span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_pld_type_56"><span class="LIDENT">pld_type</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_label_53"><span class="LIDENT">label</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">get_label_attribute</span> <span class="LIDENT">attr_default</span> <a href="#local_label_53"><span class="LIDENT">label</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">wrap_predef_option</span> <a href="#local_pld_type_56"><span class="LIDENT">pld_type</span></a><span class="RPAREN">)</span> <a href="#local_accum_52"><span class="LIDENT">accum</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pld_type_57"><span class="LIDENT">pld_type</span></span> <span class="EQUAL">=</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-remove_pervasives"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">remove_pervasives</span></a> <span class="TILDE">~</span><span class="LIDENT">deriver</span> <a href="#local_pld_type_56"><span class="LIDENT">pld_type</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">has_label_flag</span> <span class="LIDENT">attr_split</span> <a href="#local_label_53"><span class="LIDENT">label</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_pld_type_57"><span class="LIDENT">pld_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span id="local_lhs_58"><span class="LIDENT">lhs</span></span><span class="RBRACKET">]</span> <span class="STAR">*</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span id="local_rhs_59"><span class="LIDENT">rhs</span></span><span class="RBRACKET">]</span> <span class="LIDENT">list</span><span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="WHEN">when</span> <a href="#local_name_54"><span class="LIDENT">name</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'s'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_name'_60"><span class="LIDENT">name'</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-labelled"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">labelled</span></a> <a href="#local_name'_60"><span class="LIDENT">name'</span></a><span class="RPAREN">)</span> <a href="#local_lhs_58"><span class="LIDENT">lhs</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="LPAREN">(</span><span class="LIDENT">wrap_predef_option</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span> <a href="#local_rhs_59"><span class="LIDENT">rhs</span></a><span class="RBRACKET">]</span> <span class="LIDENT">list</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_accum_52"><span class="LIDENT">accum</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib/ast_builder_generated.ml.html#module-M.val-ptyp_extension"><span class="UIDENT">Ast_builder</span><span class="DOT">.</span><span class="UIDENT">Default</span><span class="DOT">.</span><span class="LIDENT">ptyp_extension</span></a> <span class="TILDE">~</span><a href="#local_loc_55"><span class="LIDENT">loc</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib/location.ml.html#val-error_extensionf"><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">error_extensionf</span></a> <span class="TILDE">~</span><a href="#local_loc_55"><span class="LIDENT">loc</span></a><span class="EOL">
</span>             <span class="STRING">&quot;[@deriving.%s.split] annotation requires a type of form \
              'a * 'a list and label name ending with `s'&quot;</span><span class="EOL">
</span>             <span class="LIDENT">deriver</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_pld_type_57"><span class="LIDENT">pld_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span class="UNDERSCORE">_</span><span class="RBRACKET">]</span> <span class="LIDENT">list</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">wrap_predef_option</span> <a href="#local_pld_type_57"><span class="LIDENT">pld_type</span></a><span class="RPAREN">)</span> <a href="#local_accum_52"><span class="LIDENT">accum</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKETPERCENT">[%</span><span class="TYPE">type</span><span class="COLON">:</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">t</span><span class="QUESTION">?</span> <span id="local_opt_61"><span class="LIDENT">opt</span></span><span class="RBRACKET">]</span> <span class="LIDENT">option</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-optional"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">optional</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">wrap_predef_option</span> <a href="#local_opt_61"><span class="LIDENT">opt</span></a><span class="RPAREN">)</span> <a href="#local_accum_52"><span class="LIDENT">accum</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-labelled"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">labelled</span></a> <a href="#local_name_54"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <a href="#local_pld_type_57"><span class="LIDENT">pld_type</span></a> <a href="#local_accum_52"><span class="LIDENT">accum</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sig_of_record_type"><span class="LIDENT">sig_of_record_type</span></span> <span class="TILDE">~</span><span id="local_loc_62"><span class="LIDENT">loc</span></span> <span class="TILDE">~</span><span id="local_typ_63"><span class="LIDENT">typ</span></span> <span id="local_labels_64"><span class="LIDENT">labels</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">find_main</span> <a href="#local_labels_64"><span class="LIDENT">labels</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_extension_65"><span class="LIDENT">extension</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib/ast_builder_generated.ml.html#module-M.val-ptyp_extension"><span class="UIDENT">Ast_builder</span><span class="DOT">.</span><span class="UIDENT">Default</span><span class="DOT">.</span><span class="LIDENT">ptyp_extension</span></a> <span class="TILDE">~</span><a href="#local_loc_62"><span class="LIDENT">loc</span></a> <a href="#local_extension_65"><span class="LIDENT">extension</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span id="local_main_66"><span class="LIDENT">main</span></span><span class="COMMA">,</span> <span id="local_labels_67"><span class="LIDENT">labels</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_has_option_68"><span class="LIDENT">has_option</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-exists"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">exists</span></a> <span class="LIDENT">is_optional</span> <a href="#local_labels_67"><span class="LIDENT">labels</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_typ_69"><span class="LIDENT">typ</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_main_66"><span class="LIDENT">main</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span class="LIDENT">pld_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_70"><span class="LIDENT">name</span></span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_pld_type_71"><span class="LIDENT">pld_type</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-nolabel"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">nolabel</span></a> <a href="#local_pld_type_71"><span class="LIDENT">pld_type</span></a> <a href="#local_typ_63"><span class="LIDENT">typ</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="WHEN">when</span> <a href="#local_has_option_68"><span class="LIDENT">has_option</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Typ.val-arrow"><span class="UIDENT">Typ</span><span class="DOT">.</span><span class="LIDENT">arrow</span></a> <a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.module-Label.val-nolabel"><span class="UIDENT">Label</span><span class="DOT">.</span><span class="LIDENT">nolabel</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-tconstr"><span class="LIDENT">tconstr</span></a> <span class="STRING">&quot;unit&quot;</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_typ_63"><span class="LIDENT">typ</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_typ_63"><span class="LIDENT">typ</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* The labels list must be reversed here so that the arguments are in the
       same order as the record fields. *)</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <span class="LIDENT">add_sig_label_arg</span> <a href="#local_typ_69"><span class="LIDENT">typ</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_labels_67"><span class="LIDENT">labels</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sig_of_type"><span class="LIDENT">sig_of_type</span></span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">ptype_loc</span> <span class="EQUAL">=</span> <span id="local_loc_73"><span class="LIDENT">loc</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_type_decl_72"><span class="LIDENT">type_decl</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_typ_74"><span class="LIDENT">typ</span></span> <span class="EQUAL">=</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-core_type_of_type_decl"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">core_type_of_type_decl</span></a> <a href="#local_type_decl_72"><span class="LIDENT">type_decl</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_type_decl_72"><span class="LIDENT">type_decl</span></a><span class="DOT">.</span><span class="LIDENT">ptype_kind</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ptype_record</span> <span id="local_labels_75"><span class="LIDENT">labels</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_typ_76"><span class="LIDENT">typ</span></span> <span class="EQUAL">=</span> <span class="LIDENT">sig_of_record_type</span> <span class="TILDE">~</span><a href="#local_loc_73"><span class="LIDENT">loc</span></a> <span class="TILDE">~</span><a href="#local_typ_74"><span class="LIDENT">typ</span></a> <a href="#local_labels_75"><span class="LIDENT">labels</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_val_name_77"><span class="LIDENT">val_name</span></span> <span class="EQUAL">=</span> <a href="../ppx_deriving.api/ppx_deriving.ml.html#val-mangle_type_decl"><span class="UIDENT">Ppx_deriving</span><span class="DOT">.</span><span class="LIDENT">mangle_type_decl</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefix</span> <span class="LIDENT">deriver</span><span class="RPAREN">)</span> <a href="#local_type_decl_72"><span class="LIDENT">type_decl</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Sig.val-value"><span class="UIDENT">Sig</span><span class="DOT">.</span><span class="LIDENT">value</span></a> <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Val.val-mk"><span class="UIDENT">Val</span><span class="DOT">.</span><span class="LIDENT">mk</span></a> <span class="LPAREN">(</span><a href="../ppx_deriving.api/ppx_deriving.ml.html#module-Ast_convenience.val-mknoloc"><span class="LIDENT">mknoloc</span></a> <a href="#local_val_name_77"><span class="LIDENT">val_name</span></a><span class="RPAREN">)</span> <a href="#local_typ_76"><span class="LIDENT">typ</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Error</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib/location.ml.html#val-error_extensionf"><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">error_extensionf</span></a> <span class="TILDE">~</span><a href="#local_loc_73"><span class="LIDENT">loc</span></a><span class="EOL">
</span>         <span class="STRING">&quot;%s can only be derived for record types&quot;</span> <span class="LIDENT">deriver</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Ppxlib does not keep track of which type the attribute was attached to
   in a set of type declarations and does not provide a nice and reliable
   way to manually check it.
   Until we have something better, we have to assume that the
   [[@@deriving make]] attribute was meant for the whole set and properly
   placed. That means that if there is at least one type declaration in the
   set for which we can derive make, we will ignore errors from the rest. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-partition_result"><span class="LIDENT">partition_result</span></span> <span id="local_l_78"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_98"><span id="local_errors_79"><span class="LIDENT">errors</span></span><span class="COMMA">,</span> <span id="local_oks_80"><span class="LIDENT">oks</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_errors_81"><span class="LIDENT">errors</span></span><span class="COMMA">,</span> <span id="local_oks_82"><span class="LIDENT">oks</span></span><span class="RPAREN">)</span> <span id="local_res_83"><span class="LIDENT">res</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="MATCH">match</span> <a href="#local_res_83"><span class="LIDENT">res</span></a> <span class="WITH">with</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_x_84"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_errors_81"><span class="LIDENT">errors</span></a><span class="COMMA">,</span> <a href="#local_x_84"><span class="LIDENT">x</span></a> <span class="COLONCOLON">::</span> <a href="#local_oks_82"><span class="LIDENT">oks</span></a><span class="RPAREN">)</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_e_85"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_e_85"><span class="LIDENT">e</span></a> <span class="COLONCOLON">::</span> <a href="#local_errors_81"><span class="LIDENT">errors</span></a><span class="COMMA">,</span> <a href="#local_oks_82"><span class="LIDENT">oks</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>      <a href="#local_l_78"><span class="LIDENT">l</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_errors_79"><span class="LIDENT">errors</span></a><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_oks_80"><span class="LIDENT">oks</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-impl_generator"><span class="LIDENT">impl_generator</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ppxlib/src/ppxlib/deriving.ml.html#module-Generator.module-V2.val-make_noarg"><span class="UIDENT">Deriving</span><span class="DOT">.</span><span class="UIDENT">Generator</span><span class="DOT">.</span><span class="UIDENT">V2</span><span class="DOT">.</span><span class="LIDENT">make_noarg</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="TILDE">~</span><span id="local_ctxt_86"><span class="LIDENT">ctxt</span></span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_type_decls_87"><span class="LIDENT">type_decls</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="LIDENT">partition_result</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">str_of_type</span> <a href="#local_type_decls_87"><span class="LIDENT">type_decls</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COLONCOLON">::</span><span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_vbs_88"><span class="LIDENT">vbs</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Str.val-value"><span class="UIDENT">Str</span><span class="DOT">.</span><span class="LIDENT">value</span></a> <span class="UIDENT">Nonrecursive</span> <a href="#local_vbs_88"><span class="LIDENT">vbs</span></a><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_errors_89"><span class="LIDENT">errors</span></span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_loc_90"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib/expansion_context.ml.html#module-Deriver.val-derived_item_loc"><span class="UIDENT">Expansion_context</span><span class="DOT">.</span><span class="UIDENT">Deriver</span><span class="DOT">.</span><span class="LIDENT">derived_item_loc</span></a> <a href="#local_ctxt_86"><span class="LIDENT">ctxt</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_ext_91"><span class="LIDENT">ext</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib/ast_builder_generated.ml.html#module-M.val-pstr_extension"><span class="UIDENT">Ast_builder</span><span class="DOT">.</span><span class="UIDENT">Default</span><span class="DOT">.</span><span class="LIDENT">pstr_extension</span></a> <span class="TILDE">~</span><a href="#local_loc_90"><span class="LIDENT">loc</span></a> <a href="#local_ext_91"><span class="LIDENT">ext</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="#local_errors_89"><span class="LIDENT">errors</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-intf_generator"><span class="LIDENT">intf_generator</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ppxlib/src/ppxlib/deriving.ml.html#module-Generator.module-V2.val-make_noarg"><span class="UIDENT">Deriving</span><span class="DOT">.</span><span class="UIDENT">Generator</span><span class="DOT">.</span><span class="UIDENT">V2</span><span class="DOT">.</span><span class="LIDENT">make_noarg</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="TILDE">~</span><span id="local_ctxt_92"><span class="LIDENT">ctxt</span></span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_type_decls_93"><span class="LIDENT">type_decls</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="LIDENT">partition_result</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">sig_of_type</span> <a href="#local_type_decls_93"><span class="LIDENT">type_decls</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COLONCOLON">::</span><span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_vds_94"><span class="LIDENT">vds</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_vds_94"><span class="LIDENT">vds</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_errors_95"><span class="LIDENT">errors</span></span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_loc_96"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib/expansion_context.ml.html#module-Deriver.val-derived_item_loc"><span class="UIDENT">Expansion_context</span><span class="DOT">.</span><span class="UIDENT">Deriver</span><span class="DOT">.</span><span class="LIDENT">derived_item_loc</span></a> <a href="#local_ctxt_92"><span class="LIDENT">ctxt</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_ext_97"><span class="LIDENT">ext</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib/ast_builder_generated.ml.html#module-M.val-psig_extension"><span class="UIDENT">Ast_builder</span><span class="DOT">.</span><span class="UIDENT">Default</span><span class="DOT">.</span><span class="LIDENT">psig_extension</span></a> <span class="TILDE">~</span><a href="#local_loc_96"><span class="LIDENT">loc</span></a> <a href="#local_ext_97"><span class="LIDENT">ext</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="#local_errors_95"><span class="LIDENT">errors</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-deriving"><span class="LIDENT">deriving</span></span><span class="COLON">:</span> <a href="../../../ppxlib/src/ppxlib/deriving.ml.html#type-t"><span class="UIDENT">Deriving</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ppxlib/src/ppxlib/deriving.ml.html#val-add"><span class="UIDENT">Deriving</span><span class="DOT">.</span><span class="LIDENT">add</span></a><span class="EOL">
</span>    <span class="LIDENT">deriver</span><span class="EOL">
</span>    <span class="LABEL">~str_type_decl:</span><span class="LIDENT">impl_generator</span><span class="EOL">
</span>    <span class="LABEL">~sig_type_decl:</span><span class="LIDENT">intf_generator</span><span class="EOL">
</span></span></code></pre></body></html>
