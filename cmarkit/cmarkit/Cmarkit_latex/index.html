<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cmarkit_latex (cmarkit.cmarkit.Cmarkit_latex)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../sherlodoc_db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../../index.html">Up</a> ‚Äì <a href="../../../index.html">üè†</a> &#x00BB; <a href="../../index.html">Cmarkit  <span class="version">v0.3.0</span></a> &#x00BB; Library <code>cmarkit</code> &#x00BB; Cmarkit_latex</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Cmarkit_latex</span></code></h1><p>Rendering CommonMark to L<sup>A</sup>T<sub>E</sub>X.</p><p>Generates L<sup>A</sup>T<sub>E</sub>X fragments, consult the <a href="#integration" title="integration">integration notes</a> for requirements on the document.</p><p>See <span class="xref-unresolved" title="index.quick">a quick example</span> and <a href="#doc_frame" title="doc_frame">another one</a>.</p><p><b>Warning.</b> Rendering outputs are unstable, they may be tweaked even between minor versions of the library.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#rendering">Rendering</a></li><li><a href="#renderer">Renderer</a></li><li><a href="#render">Render functions</a></li><li><a href="#integration">L<sup>A</sup>T<sub>E</sub>X integration notes</a><ul><li><a href="#char_encoding">Character encoding</a></li><li><a href="#links">Autolinks and links</a></li><li><a href="#images">Images</a></li><li><a href="#labels">Section labels</a></li><li><a href="#lists">Lists</a></li><li><a href="#code_blocks">Code blocks</a></li><li><a href="#doc_frame">Document frame</a></li></ul></li></ul></nav><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">Cmarkit  <span class="version">v0.3.0</span></a><ul><li>Library <code>cmarkit</code><ul><li><a href="../Cmarkit/index.html">Cmarkit</a></li><li><a href="../Cmarkit_commonmark/index.html">Cmarkit_commonmark</a></li><li><a href="../Cmarkit_html/index.html">Cmarkit_html</a></li><li><a href="#" class="current_unit">Cmarkit_latex</a></li><li><a href="../Cmarkit_renderer/index.html">Cmarkit_renderer</a></li></ul></li></ul></li></ul></nav></div><div class="odoc-content"><h2 id="rendering"><a href="#rendering" class="anchor"></a>Rendering</h2><div class="odoc-spec"><div class="spec value anchored" id="val-of_doc"><a href="#val-of_doc" class="anchor"></a><code><span><span class="keyword">val</span> of_doc : <span><span class="optlabel">?backend_blocks</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../Cmarkit/Doc/index.html#type-t">Cmarkit.Doc.t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>of_doc d</code> is a L<sup>A</sup>T<sub>E</sub>X fragment for <code>d</code>. See <a href="#val-renderer"><code>renderer</code></a> for more details and documentation about rendering options.</p></div></div><h2 id="renderer"><a href="#renderer" class="anchor"></a>Renderer</h2><div class="odoc-spec"><div class="spec value anchored" id="val-renderer"><a href="#val-renderer" class="anchor"></a><code><span><span class="keyword">val</span> renderer : <span><span class="optlabel">?backend_blocks</span>:bool <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../Cmarkit_renderer/index.html#type-t">Cmarkit_renderer.t</a></span></code></div><div class="spec-doc"><p><code>renderer</code> is a default L<sup>A</sup>T<sub>E</sub>X renderer. This renders the strict CommonMark abstract syntax tree and the supported Cmarkit <a href="../Cmarkit/index.html#extensions" title="extensions">extensions</a>.</p><p>The inline, block and document renderers always return <code>true</code>. Unknown block and inline values are rendered by a L<sup>A</sup>T<sub>E</sub>X comment.</p><p>The following options are available:</p><ul><li><code>backend_blocks</code>, if <code>true</code>, code blocks with language <code>=latex</code> are written verbatim in the output and any other code block whose langage starts with <code>=</code> is dropped. Defaults to <code>false</code>.</li></ul><p>See <a href="../Cmarkit_renderer/index.html#example" title="example">this example</a> to extend or selectively override the renderer.</p></div></div><h2 id="render"><a href="#render" class="anchor"></a>Render functions</h2><p>Only useful if you extend the renderer.</p><div class="odoc-spec"><div class="spec value anchored" id="val-newline"><a href="#val-newline" class="anchor"></a><code><span><span class="keyword">val</span> newline : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>newline c</code> starts a new line. Except on the first call on <code>c</code> which is a nop.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-latex_escaped_uchar"><a href="#val-latex_escaped_uchar" class="anchor"></a><code><span><span class="keyword">val</span> latex_escaped_uchar : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#type-t">Uchar.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>latex_escaped_uchar c u</code> renders the UTF-8 encoding of <code>u</code> on <code>c</code> propertly escaped for L<sup>A</sup>T<sub>E</sub>X. That is the characters <code>&amp;</code>‚ÄÇ<code>%</code>‚ÄÇ<code>$</code>‚ÄÇ<code>#</code>‚ÄÇ<code>_</code>‚ÄÇ<code>{</code>‚ÄÇ<code>}</code>‚ÄÇ<code>~</code>‚ÄÇ<code>^</code>‚ÄÇ<code>\ </code> are escaped. This also renders U+0000 to <a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#val-rep"><code>Uchar.rep</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-buffer_add_latex_escaped_uchar"><a href="#val-buffer_add_latex_escaped_uchar" class="anchor"></a><code><span><span class="keyword">val</span> buffer_add_latex_escaped_uchar : <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Buffer/index.html#type-t">Buffer.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#type-t">Uchar.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>buffer_add_latex_escaped_uchar</code> is <a href="#val-latex_escaped_uchar"><code>latex_escaped_uchar</code></a> but appends to a buffer value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-latex_escaped_string"><a href="#val-latex_escaped_string" class="anchor"></a><code><span><span class="keyword">val</span> latex_escaped_string : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>latex_escaped_string c s</code> renders string <code>s</code> on <code>c</code> with characters <code>&amp;</code>‚ÄÇ<code>%</code>‚ÄÇ<code>$</code>‚ÄÇ<code>#</code>‚ÄÇ<code>_</code>‚ÄÇ<code>{</code>‚ÄÇ<code>}</code>‚ÄÇ<code>~</code>‚ÄÇ<code>^</code>‚ÄÇ<code>\ </code> escaped. This also escapes U+0000 to <a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#val-rep"><code>Uchar.rep</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-buffer_add_latex_escaped_string"><a href="#val-buffer_add_latex_escaped_string" class="anchor"></a><code><span><span class="keyword">val</span> buffer_add_latex_escaped_string : <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Buffer/index.html#type-t">Buffer.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>buffer_add_latex_escaped_string</code> is <a href="#val-latex_escaped_string"><code>latex_escaped_string</code></a> but acts on a buffer value.</p></div></div><h2 id="integration"><a href="#integration" class="anchor"></a>L<sup>A</sup>T<sub>E</sub>X integration notes</h2><p>Along with the built-in <code>graphicx</code> package, the following L<sup>A</sup>T<sub>E</sub>X packages are needed to use the outputs of the default renderer:</p><pre>tlmgr install enumitem listings hyperref  # Required
tlmgr install ulem                        # Strikethrough extension
tlmgr install bera fontspec               # Optional</pre><p>This means you should have at least the following in your document preamble:</p><pre>% Required
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{hyperref}
\usepackage[normalem]{ulem} % Strikethrough extension

% Optional
\usepackage[scaled=0.8]{beramono} % A font for code blocks
\usepackage{fontspec}             % Supports more Unicode characters</pre><p>See the sections below for more details.</p><h3 id="char_encoding"><a href="#char_encoding" class="anchor"></a>Character encoding</h3><p>The output is UTF-8 encoded. <a href="https://tug.org/TUGboat/tb39-1/tb121ltnews28.pdf">It became</a> the the default encoding for L<sup>A</sup>T<sub>E</sub>X in 2018. But if you are using an older version a <code>\usepackage[utf8]{inputenc}</code> may be needed.</p><p>Using <code>xelatex</code> rather than <code>pdflatex</code> will not get stuck on missing glyphs.</p><h3 id="links"><a href="#links" class="anchor"></a>Autolinks and links</h3><p>The <a href="https://www.ctan.org/pkg/hyperref"><code>hyperref</code></a> package is used to render links (<code>\href</code>) and autolink (<code>\url</code>). Link destination starting with a <code>#</code> are assumed to refer to <a href="#labels" title="labels">section labels</a> and are rendered using the <code>\hyperref</code> macro, with the <code>#</code> chopped.</p><h3 id="images"><a href="#images" class="anchor"></a>Images</h3><p>Images are inserted using the <a href="https://ctan.org/pkg/graphicx">graphicx</a>'s package. Only images with relative URLs are supported, those that point to external ressources on the www are turned into links.</p><h3 id="labels"><a href="#labels" class="anchor"></a>Section labels</h3><p>Section labels are added to the output whenever <a href="../Cmarkit/Block/Heading/index.html#val-id"><code>Cmarkit.Block.Heading.id</code></a> holds a value. If the identifier already exists it is made unique by appending <code>&quot;-&quot;</code> and the first number starting from 1 that makes it unique. Also the character <code>_</code> seems problematic in labels even when escaped, we map it to <code>-</code> (if you know any better get in touch).</p><h3 id="lists"><a href="#lists" class="anchor"></a>Lists</h3><p>To support the starting point of ordereded lists without having to fiddle with <code>enumi</code> counters, the <a href="https://www.ctan.org/pkg/enumitem"><code>enumitem</code></a> package is used.</p><h3 id="code_blocks"><a href="#code_blocks" class="anchor"></a>Code blocks</h3><p>If a language <code>lang</code> can be <a href="../Cmarkit/Block/Code_block/index.html#val-language_of_info_string" title="Cmarkit.Block.Code_block.language_of_info_string">extracted</a> from a code block info string, the <a href="https://www.ctan.org/pkg/listings"><code>listings</code></a> package is used with the corresponding language in a <code>lstlisting</code> environment. Otherwise the built-in <code>verbatim</code> environment is used.</p><p>Note that the <code>listings</code> package has no definition for the <code>ocaml</code> language, the default renderings are a bit subpar and break on character literals with double quotes. This improves things:</p><pre>\lstset{
  columns=[c]fixed,
  basicstyle=\small\ttfamily,
  keywordstyle=\bfseries,
  upquote=true,
  commentstyle=\slshape,
  breaklines=true,
  showstringspaces=false}

\lstdefinelanguage{ocaml}{language=[objective]caml,
   % Fixes double quotes in char literals
   literate={'&quot;'}{\textquotesingle &quot;\textquotesingle}3
            {'\\&quot;'}{\textquotesingle \textbackslash&quot;\textquotesingle}4,
}</pre><h3 id="doc_frame"><a href="#doc_frame" class="anchor"></a>Document frame</h3><p>The default renderer only generates L<sup>A</sup>T<sub>E</sub>X fragments. You may want to add a document frame. For example:</p><pre class="language-ocaml"><code>let latex_doc_of_md ?(title = &quot;&quot;) md =
  let doc = Cmarkit.Doc.of_string md in
  let r = Cmarkit_latex.renderer () in
  let buffer_add_doc = Cmarkit_renderer.buffer_add_doc r in
  let buffer_add_title = Cmarkit_latex.buffer_add_latex_escaped_string in
  let maketitle = if title = &quot;&quot; then &quot;&quot; else {|\maketitle|} in
  Printf.kbprintf Buffer.contents (Buffer.create 1024)
{|\documentclass{article}

\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{hyperref}
\usepackage[normalem]{ulem}
\usepackage[scaled=0.8]{beramono}
\usepackage{fontspec}

\lstset{
  columns=[c]fixed,
  basicstyle=\small\ttfamily,
  keywordstyle=\bfseries,
  upquote=true,
  commentstyle=\slshape,
  breaklines=true,
  showstringspaces=false}

\lstdefinelanguage{ocaml}{language=[objective]caml,
  literate={'&quot;'}{\textquotesingle &quot;\textquotesingle}3
            {'\\&quot;'}{\textquotesingle \textbackslash&quot;\textquotesingle}4,
}

\title{%a}
\begin{document}
%s
%a
\end{document}|} buffer_add_title title maketitle buffer_add_doc doc</code></pre><p>Ignore this: &quot;.</p></div></body></html>
