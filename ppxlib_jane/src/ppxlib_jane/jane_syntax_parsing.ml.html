<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: jane_syntax_parsing.ml (ppxlib_jane.src.ppxlib_jane)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ppxlib_jane</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; ppxlib_jane &#x00BB; jane_syntax_parsing.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>jane_syntax_parsing.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ppxlib_jane</a><ul><li>Library <code>ppxlib_jane</code><ul><li><a href="../../ppxlib_jane/Ppxlib_jane/index.html">Ppxlib_jane</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>ppxlib_jane<ul><li><a href="ast_builder.ml.html">ast_builder.ml</a></li><li><a href="ast_builder_intf.ml.html">ast_builder_intf.ml</a></li><li><a href="jane_asttypes.ml.html">jane_asttypes.ml</a></li><li><a href="jane_syntax.ml.html">jane_syntax.ml</a></li><li><a href="#" class="current_unit">jane_syntax_parsing.ml</a></li><li><a href="language_extension.ml.html">language_extension.ml</a></li><li><a href="language_extension_kernel.ml.html">language_extension_kernel.ml</a></li><li><a href="ppxlib_jane.ml.html">ppxlib_jane.ml</a></li><li><a href="ppxlib_jane__.ml.html">ppxlib_jane__.ml</a></li><li><a href="shadow_compiler_distribution.ml.html">shadow_compiler_distribution.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
</code><code class="source_code"><span><span class="COMMENT">(*_ This file is manually imported from the Jane Street version of the
   OCaml compiler. Don't make changes directly to this file. *)</span><span class="EOL">
</span><span class="LBRACKETATATAT">[@@@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">warning</span> <span class="STRING">&quot;-missing-record-field-pattern&quot;</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span><span class="BANG">!</span> <a href="shadow_compiler_distribution.ml.html"><span class="UIDENT">Shadow_compiler_distribution</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** As mentioned in the .mli file, there are some gory details around the
    particular translation scheme we adopt for moving to and from OCaml ASTs
    ([Parsetree.expression], etc.).  The general idea is that we adopt a schem<span id="module-Language_extension.type-maturity.constructor-Stable">e
    wh</span>ere<span id="module-Language_extension.type-maturity.constructor-Beta"> each </span>nov<span id="module-Language_extension.type-maturity.constructor-Alpha">el piec</span>e of syntax is represented using one of two embeddings:

    1. As an AST item carrying an attribute. The AST item serves as the &quot;body&quot;
      of the syntax indicated by the attribute.
    2. As a pair of an extension node and an AST item that serv<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Comprehensions">es as the &quot;body&quot;.
       </span>Her<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Mode">e, the &quot;pair&quot; i</span>s e<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Unique">mbedded as a pair</span>-li<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Include_functor">ke construct in the releva</span>nt <span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Polymorphic_parameters">AST
       category, e.g. [includ</span>e s<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Immutable_arrays">ig [%jane.ERASABILITY.EXTNA</span>ME]<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Module_strengthening">;; BODY end] for
       signatu</span>re <span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Layouts">items.

    In particu</span>lar<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-SIMD">, for an langua</span>ge <span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Labeled_tuples">extension named [EXTNAME]</span> (i<span id="module-Language_extension.type-{t}2/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml).constructor-Small_numbers">.e., one that is
    ena</span>bled by [-extension EXTNAME] on the command line), the attribute (if
    used) must be [[@jane.ERASABILITY.EXTNAME]], and the extension node (if
    used) must be [[%jane.ERASABILITY.EXTNAME]]. For built-in syntax, we use
    [_builtin] instead of an language extension name.

    The [ERASABILITY] component indicates to tools such as ocamlformat and
    ppxlib whether or not the attribute is erasable. See the documentation of
    [Erasability] for more information on how tools make use of this
    information.

    In the below example, we use attributes an examples, but it applies equally
    to extensions. We also provide utilities for further desugaring similar
    applications where the embeddings have the longer form
    [[@jane.ERASABILITY.FEATNAME.ID1.ID2.â€¦.IDn]] (with the outermost one being
    the [n = 0] case), as these might be used inside the [EXPR]. (For example,
    within the outermost [[@jane.non_erasable.comprehensions]] term for list and
    array comprehensions, we can also use
    [[@jane.non_erasable.comprehensions.list]],
    [[@jane.non_erasable.comprehensions.array]],
    [[@jane.non_erasable.comprehensions.for.in]], etc.).

    As mentioned, we represent terms as a &quot;pair&quot; and don't use the extension
    node or attribute payload; this is so that ppxen can see inside these
    extension nodes or attributes. If we put the subexpressions inside the
    payload, then we couldn't write something like [[[%string &quot;Hello, %{x}!&quot;]
    for x in names]], as [ppx_string] wouldn't traverse inside the payload to
    find the [[%string]] extension node.

    Our novel syntactic features are of course allowed to impose extra
    constraints on what legal bodies are; we're also happy for this translation
    to error in various ways on malformed input, since nobody should ever be
    writing these forms directly.  They're just an implementation detail.

    See modules of type AST below to see how different syntactic categories
    are represented. For example, expressions are encoded using an attribute.

    We provide one module per syntactic category (e.g., [Expression]), of module
    type [AST].  They also provide some simple machinery for working with the
    general [@jane.ERASABILITY.FEATNAME.ID1.ID2.â€¦.IDn] wrapped forms. To
    construct one, we provide [make_jane_syntax]; to destructure one, we provide
    [match_jane_syntax] (which we expose via [make_of_ast]). Users of this
    module still have to write the transformations in both directions for all
    new syntax, lowering it to extension nodes or attributes and then lifting it
    back out. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** How did we choose between using the attribute embedding and the extension
    node embedding for a particular syntactic category?

    Generally, we prefer the attribute embedding: it's more compatible with
    ppxes that aren't aware of Jane Syntax. (E.g., if a type looks like a tuple,
    it truly is a tuple and not an extension node embedding.)

    We can't apply the attribute embedding everywhere because some syntactic
    categories, like structure items, don't carry attributes. For these, we
    use extension nodes.

    However, the attribute embedding is more inconvenient in some ways than
    the extension node embedding. For example, the attribute embedding requires
    callers to strip out Jane Syntax-related attributes from the attribute list
    before processing it. We've tried to make this obvious from the signature
    of, say, [Jane_syntax.Expression.of_ast], but this is somewhat more
    inconvenient than just operating on the [expr_desc]. Nonetheless, because
    of the advantages with ppxlib interoperability, we've opted for the
    attribute embedding where possible.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_500.ml.html#module-Parsetree"><span class="UIDENT">Parsetree</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** We carefully regulate which bindings we import from [Language_extension]
    to ensure that we can import this file into the Jane Street internal
    repo with no changes.
*)</span><span class="EOL">
</span><span id="module-Language_extension"><span class="MODULE">module</span> <span class="UIDENT">Language_extension</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <a href="language_extension_kernel.ml.html"><span class="UIDENT">Language_extension_kernel</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <a href="language_extension.ml.html"><span class="UIDENT">Language_extension</span></a> <span class="COLON">:</span> <a href="language_extension_kernel.ml.html#module-type-Language_extension_for_jane_syntax"><span class="UIDENT">Language_extension_kernel</span><span class="DOT">.</span><span class="UIDENT">Language_extension_for_jane_syntax</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Feature"><span class="MODULE">module</span> <span class="UIDENT">Feature</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-Feature.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Feature.type-t.constructor-Language_extension"><span class="BAR">|</span> <span class="UIDENT">Language_extension</span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>    <span id="module-Feature.type-t.constructor-Builtin"><span class="BAR">|</span> <span class="UIDENT">Builtin</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Feature.type-error"><span class="TYPE">type</span> <span class="LIDENT">error</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Feature.type-error.constructor-Disabled_extension"><span class="BAR">|</span> <span class="UIDENT">Disabled_extension</span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">error</span></span><span class="EOL">
</span>    <span id="module-Feature.type-error.constructor-Unknown_extension"><span class="BAR">|</span> <span class="UIDENT">Unknown_extension</span> <span class="OF">of</span> <span class="LIDENT">string</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Feature.val-describe_uppercase"><span class="VAL">val</span> <span class="LIDENT">describe_uppercase</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span id="module-Feature.val-extension_component"><span class="VAL">val</span> <span class="LIDENT">extension_component</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span id="module-Feature.val-of_component"><span class="VAL">val</span> <span class="LIDENT">of_component</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-result"><span class="LPAREN">(</span><span class="LIDENT">t</span><span class="COMMA">,</span> <span class="LIDENT">error</span><span class="RPAREN">)</span> <span class="LIDENT">result</span></a></span><span class="EOL">
</span>  <span id="module-Feature.val-is_erasable"><span class="VAL">val</span> <span class="LIDENT">is_erasable</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span><span class="END">end</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Feature.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Feature.type-t.constructor-Language_extension"><span class="BAR">|</span> <span class="UIDENT">Language_extension</span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>    <span id="module-Feature.type-t.constructor-Builtin"><span class="BAR">|</span> <span class="UIDENT">Builtin</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Feature.type-error"><span class="TYPE">type</span> <span class="LIDENT">error</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Feature.type-error.constructor-Disabled_extension"><span class="BAR">|</span> <span class="UIDENT">Disabled_extension</span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">error</span></span><span class="EOL">
</span>    <span id="module-Feature.type-error.constructor-Unknown_extension"><span class="BAR">|</span> <span class="UIDENT">Unknown_extension</span> <span class="OF">of</span> <span class="LIDENT">string</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Feature.val-builtin_component"><span class="LIDENT">builtin_component</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;_builtin&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Feature.val-describe_uppercase"><span class="LIDENT">describe_uppercase</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Language_extension</span> <span id="local_ext_1"><span class="LIDENT">ext</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="STRING">&quot;The extension \&quot;&quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_ext_1"><span class="LIDENT">ext</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;\&quot;&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Builtin</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Built-in syntax&quot;</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Feature.val-extension_component"><span class="LIDENT">extension_component</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Language_extension</span> <span id="local_ext_2"><span class="LIDENT">ext</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_ext_2"><span class="LIDENT">ext</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Builtin</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">builtin_component</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Feature.val-of_component"><span class="LIDENT">of_component</span></span> <span id="local_str_3"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-equal"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">equal</span></a> <a href="#local_str_3"><span class="LIDENT">str</span></a> <span class="LIDENT">builtin_component</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Ok</span> <span class="UIDENT">Builtin</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">of_string</span> <a href="#local_str_3"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Pack</span> <span id="local_ext_4"><span class="LIDENT">ext</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">is_enabled</span> <a href="#local_ext_4"><span class="LIDENT">ext</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="UIDENT">Language_extension</span> <a href="#local_ext_4"><span class="LIDENT">ext</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="UIDENT">Disabled_extension</span> <a href="#local_ext_4"><span class="LIDENT">ext</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="UIDENT">Unknown_extension</span> <a href="#local_str_3"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Feature.val-is_erasable"><span class="LIDENT">is_erasable</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Language_extension</span> <span id="local_ext_5"><span class="LIDENT">ext</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">is_erasable</span> <a href="#local_ext_5"><span class="LIDENT">ext</span></a><span class="EOL">
</span>    <span class="COMMENT">(* Builtin syntax changes don't involve additions or changes to concrete
       syntax and are always erasable.
    *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Builtin</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Was this embedded as an [[%extension_node]] or an [[@attribute]]?  Not
    exported. Used only for error messages. *)</span><span class="EOL">
</span><span id="module-Embedding_syntax"><span class="MODULE">module</span> <span class="UIDENT">Embedding_syntax</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Embedding_syntax.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Embedding_syntax.type-t.constructor-Extension_node"><span class="BAR">|</span> <span class="UIDENT">Extension_node</span></span><span class="EOL">
</span>    <span id="module-Embedding_syntax.type-t.constructor-Attribute"><span class="BAR">|</span> <span class="UIDENT">Attribute</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedding_syntax.val-name"><span class="LIDENT">name</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Extension_node</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;extension node&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Attribute</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;attribute&quot;</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedding_syntax.val-name_indefinite"><span class="LIDENT">name_indefinite</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Extension_node</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;an extension node&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Attribute</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;an attribute&quot;</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedding_syntax.val-name_plural"><span class="LIDENT">name_plural</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Extension_node</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;extension nodes&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Attribute</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;attributes&quot;</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedding_syntax.val-pp"><span class="LIDENT">pp</span></span> <span id="local_ppf_6"><span class="LIDENT">ppf</span></span> <span class="LPAREN">(</span><span id="local_t_7"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_name_8"><span class="LIDENT">name</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sigil_9"><span class="LIDENT">sigil</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_t_7"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Extension_node</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Attribute</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@&quot;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_ppf_6"><span class="LIDENT">ppf</span></a> <span class="STRING">&quot;[%s%s]&quot;</span> <a href="#local_sigil_9"><span class="LIDENT">sigil</span></a> <a href="#local_name_8"><span class="LIDENT">name</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Misnamed_embedding_error"><span class="MODULE">module</span> <span class="UIDENT">Misnamed_embedding_error</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Misnamed_embedding_error.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Misnamed_embedding_error.type-t.constructor-No_erasability"><span class="BAR">|</span> <span class="UIDENT">No_erasability</span></span><span class="EOL">
</span>    <span id="module-Misnamed_embedding_error.type-t.constructor-No_feature"><span class="BAR">|</span> <span class="UIDENT">No_feature</span></span><span class="EOL">
</span>    <span id="module-Misnamed_embedding_error.type-t.constructor-Unknown_erasability"><span class="BAR">|</span> <span class="UIDENT">Unknown_erasability</span> <span class="OF">of</span> <span class="LIDENT">string</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Misnamed_embedding_error.val-to_string"><span class="LIDENT">to_string</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_erasability</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Missing erasability and feature components&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_feature</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Missing a feature component&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Unknown_erasability</span> <span id="local_str_10"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;Unrecognized component where erasability was expected: `%s'&quot;</span> <a href="#local_str_10"><span class="LIDENT">str</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** The component of an attribute or extension name that identifies whether or
    not the embedded syntax is *erasable*; that is, whether or not the
    upstream OCaml compiler can safely interpret the AST while ignoring the
    attribute or extension.  (This means that syntax encoded as extension
    nodes should always be non-erasable.)  Tools that consume the parse tree
    we generate can make use of this information; for instance, ocamlformat
    will use it to guide how we present code that can be run with both our
    compiler and the upstream compiler, and ppxlib can use it to decide
    whether it's ok to allow ppxes to construct syntax that uses this
    emedding.  In particular, the upstream version of ppxlib will allow ppxes
    to produce [[@jane.erasable.*]] attributes, but will report an error if a
    ppx produces a [[@jane.non_erasable.*]] attribute.

    As mentioned above, unlike for attributes, the erasable/non-erasable
    distinction is not meaningful for extension nodes, as the compiler will
    always error if it sees an uninterpreted extension node. So, for purposes
    of tools in the wider OCaml ecosystem, it is irrelevant whether embeddings
    that use extension nodes indicate [Erasable] or [Non_erasable] for this
    component, but the semantically correct choice and the one we've settled
    on is to use [Non_erasable]. *)</span><span class="EOL">
</span><span id="module-Erasability"><span class="MODULE">module</span> <span class="UIDENT">Erasability</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Erasability.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Erasability.type-t.constructor-Erasable"><span class="BAR">|</span> <span class="UIDENT">Erasable</span></span><span class="EOL">
</span>    <span id="module-Erasability.type-t.constructor-Non_erasable"><span class="BAR">|</span> <span class="UIDENT">Non_erasable</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Erasability.val-to_string"><span class="LIDENT">to_string</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Erasable</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;erasable&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Non_erasable</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;non_erasable&quot;</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Erasability.val-of_string"><span class="LIDENT">of_string</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="STRING">&quot;erasable&quot;</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="UIDENT">Erasable</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="STRING">&quot;non_erasable&quot;</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="UIDENT">Non_erasable</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** An AST-style representation of the names used when generating extension
    nodes or attributes for modular syntax; see the .mli file for more
    details. *)</span><span class="EOL">
</span><span id="module-Embedded_name"><span class="MODULE">module</span> <span class="UIDENT">Embedded_name</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="DOCSTRING">(** A nonempty list of name components, without the first two components.
      (That is, without the leading root component that identifies it as part of
      the modular syntax mechanism, and without the next component that
      identifies the erasability.) See the .mli file for more details. *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.type-components"><span class="TYPE">type</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span id="module-Embedded_name.type-components.constructor-::"><span class="LPAREN">(</span> <span class="COLONCOLON">::</span> <span class="RPAREN">)</span> <span class="OF">of</span> <span class="LIDENT">string</span> <span class="STAR">*</span> <span class="LIDENT">string</span> <span class="LIDENT">list</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Embedded_name.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_237"><span class="LIDENT">erasability</span> <span class="COLON">:</span> <span class="UIDENT">Erasability</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_231"><span class="LIDENT">components</span> <span class="COLON">:</span> <span class="LIDENT">components</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** See the mli. *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.val-of_feature"><span class="VAL">val</span> <span class="LIDENT">of_feature</span> <span class="COLON">:</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="LIDENT">list</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Embedded_name.val-components"><span class="VAL">val</span> <span class="LIDENT">components</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">components</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** See the mli. *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.val-to_string"><span class="VAL">val</span> <span class="LIDENT">to_string</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Parse a Jane syntax name from the OCaml AST, either as the name of an
      extension node or an attribute:
        - [Some (Ok _)] if it's a legal Jane-syntax name;
        - [Some (Error _)] if the root is present, but the name has fewer than 3
          components or the erasability component is malformed; and
        - [None] if it doesn't start with the leading root name and isn't part
          of our Jane-syntax machinery.
      Not exposed. *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.val-of_string"><span class="VAL">val</span> <span class="LIDENT">of_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-result"><span class="LPAREN">(</span><span class="LIDENT">t</span><span class="COMMA">,</span> <span class="UIDENT">Misnamed_embedding_error</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">result</span></a> <span class="LIDENT">option</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Print out the embedded form of a Jane-syntax name, in quotes; for use in
      error messages. *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.val-pp_quoted_name"><span class="VAL">val</span> <span class="LIDENT">pp_quoted_name</span> <span class="COLON">:</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#type-formatter"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">formatter</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Print out an empty extension node or attribute with a Jane-syntax name,
      accompanied by an indefinite article; for use in error messages.  Not
      exposed. *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.val-pp_a_term"><span class="VAL">val</span> <span class="LIDENT">pp_a_term</span> <span class="COLON">:</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#type-formatter"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">formatter</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span><span class="END">end</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="DOCSTRING">(** The three parameters that control how we encode Jane-syntax extension node
      names.  When updating these, update comments that refer to them by their
      contents! *)</span><span class="EOL">
</span>  <span id="module-Embedded_name.module-Config"><span class="MODULE">module</span> <span class="UIDENT">Config</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="DOCSTRING">(** The separator between name components *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Embedded_name.module-Config.val-separator"><span class="LIDENT">separator</span></span> <span class="EQUAL">=</span> <span class="CHAR">'.'</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="DOCSTRING">(** The leading namespace that identifies this extension node or attribute
        as reserved for a piece of modular syntax *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Embedded_name.module-Config.val-root"><span class="LIDENT">root</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;jane&quot;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="DOCSTRING">(** For printing purposes, the appropriate indefinite article for [root] *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Embedded_name.module-Config.val-article"><span class="LIDENT">article</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;a&quot;</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">Config</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-separator_str"><span class="LIDENT">separator_str</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">1</span> <span class="LIDENT">separator</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Embedded_name.type-components"><span class="TYPE">type</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span id="module-Embedded_name.type-components.constructor-::"><span class="LPAREN">(</span> <span class="COLONCOLON">::</span> <span class="RPAREN">)</span> <span class="OF">of</span> <span class="LIDENT">string</span> <span class="STAR">*</span> <span class="LIDENT">string</span> <span class="LIDENT">list</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Embedded_name.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_235"><span class="LIDENT">erasability</span> <span class="COLON">:</span> <span class="UIDENT">Erasability</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_240"><span class="LIDENT">components</span> <span class="COLON">:</span> <span class="LIDENT">components</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-of_feature"><span class="LIDENT">of_feature</span></span> <span id="local_feature_11"><span class="LIDENT">feature</span></span> <span id="local_trailing_components_12"><span class="LIDENT">trailing_components</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_feature_component_13"><span class="LIDENT">feature_component</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">extension_component</span> <a href="#local_feature_11"><span class="LIDENT">feature</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_erasability_14"><span class="LIDENT">erasability</span></span> <span class="COLON">:</span> <span class="UIDENT">Erasability</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">is_erasable</span> <a href="#local_feature_11"><span class="LIDENT">feature</span></a> <span class="THEN">then</span> <span class="UIDENT">Erasable</span> <span class="ELSE">else</span> <span class="UIDENT">Non_erasable</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <a href="#local_erasability_14"><span class="LIDENT">erasability</span></a><span class="SEMI">;</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <a href="#local_feature_component_13"><span class="LIDENT">feature_component</span></a> <span class="COLONCOLON">::</span> <a href="#local_trailing_components_12"><span class="LIDENT">trailing_components</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-components"><span class="LIDENT">components</span></span> <span id="local_t_15"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_15"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">components</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-to_string"><span class="LIDENT">to_string</span></span> <span class="LBRACE">{</span> <span id="local_erasability_16"><span class="LIDENT">erasability</span></span><span class="SEMI">;</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span id="local_feat_17"><span class="LIDENT">feat</span></span> <span class="COLONCOLON">::</span> <span id="local_subparts_18"><span class="LIDENT">subparts</span></span> <span class="RBRACE">}</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-concat"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">concat</span></a><span class="EOL">
</span>      <span class="LIDENT">separator_str</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">root</span> <span class="COLONCOLON">::</span> <span class="UIDENT">Erasability</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_erasability_16"><span class="LIDENT">erasability</span></a> <span class="COLONCOLON">::</span> <a href="#local_feat_17"><span class="LIDENT">feat</span></a> <span class="COLONCOLON">::</span> <a href="#local_subparts_18"><span class="LIDENT">subparts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_str_19"><span class="LIDENT">str</span></span> <span class="COLON">:</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-result"><span class="LPAREN">(</span><span class="LIDENT">t</span><span class="COMMA">,</span> <span class="UIDENT">Misnamed_embedding_error</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">result</span></a> <span class="LIDENT">option</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-split_on_char"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">split_on_char</span></a> <span class="LIDENT">separator</span> <a href="#local_str_19"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_root'_20"><span class="LIDENT">root'</span></span> <span class="COLONCOLON">::</span> <span id="local_parts_21"><span class="LIDENT">parts</span></span> <span class="WHEN">when</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-equal"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">equal</span></a> <span class="LIDENT">root</span> <a href="#local_root'_20"><span class="LIDENT">root'</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_parts_21"><span class="LIDENT">parts</span></a> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span class="UIDENT">No_erasability</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="LBRACKET">[</span> <span class="UNDERSCORE">_</span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span class="UIDENT">No_feature</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="BAR">|</span> <span id="local_erasability_22"><span class="LIDENT">erasability</span></span> <span class="COLONCOLON">::</span> <span id="local_feat_23"><span class="LIDENT">feat</span></span> <span class="COLONCOLON">::</span> <span id="local_subparts_24"><span class="LIDENT">subparts</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="UIDENT">Erasability</span><span class="DOT">.</span><span class="LIDENT">of_string</span> <a href="#local_erasability_22"><span class="LIDENT">erasability</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_erasability_25"><span class="LIDENT">erasability</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Ok</span> <span class="LBRACE">{</span> <a href="#local_erasability_25"><span class="LIDENT">erasability</span></a><span class="SEMI">;</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <a href="#local_feat_23"><span class="LIDENT">feat</span></a> <span class="COLONCOLON">::</span> <a href="#local_subparts_24"><span class="LIDENT">subparts</span></a> <span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="UIDENT">Unknown_erasability</span> <a href="#local_erasability_22"><span class="LIDENT">erasability</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-pp_quoted_name"><span class="LIDENT">pp_quoted_name</span></span> <span id="local_ppf_26"><span class="LIDENT">ppf</span></span> <span id="local_t_27"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_ppf_26"><span class="LIDENT">ppf</span></a> <span class="STRING">&quot;\&quot;%s\&quot;&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">to_string</span> <a href="#local_t_27"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Embedded_name.val-pp_a_term"><span class="LIDENT">pp_a_term</span></span> <span id="local_ppf_28"><span class="LIDENT">ppf</span></span> <span class="LPAREN">(</span><span id="local_esyn_29"><span class="LIDENT">esyn</span></span><span class="COMMA">,</span> <span id="local_t_30"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_ppf_28"><span class="LIDENT">ppf</span></a> <span class="STRING">&quot;%s %a&quot;</span> <span class="LIDENT">article</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">pp</span> <span class="LPAREN">(</span><a href="#local_esyn_29"><span class="LIDENT">esyn</span></a><span class="COMMA">,</span> <span class="LIDENT">to_string</span> <a href="#local_t_30"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span><span id="module-Error"><span class="MODULE">module</span> <span class="UIDENT">Error</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="DOCSTRING">(** An error triggered when desugaring a language extension from an OCaml
      AST; should always be fatal *)</span><span class="EOL">
</span>  <span id="module-Error.type-error"><span class="TYPE">type</span> <span class="LIDENT">error</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Error.type-error.constructor-Introduction_has_payload"><span class="BAR">|</span> <span class="UIDENT">Introduction_has_payload</span> <span class="OF">of</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-payload"><span class="LIDENT">payload</span></a></span><span class="EOL">
</span>    <span id="module-Error.type-error.constructor-Unknown_extension"><span class="BAR">|</span> <span class="UIDENT">Unknown_extension</span> <span class="OF">of</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">Erasability</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>    <span id="module-Error.type-error.constructor-Disabled_extension"><span class="BAR">|</span> <span class="UIDENT">Disabled_extension</span> <span class="COLON">:</span><span class="EOL">
</span>        <span class="LBRACE">{</span> <span id="def_227"><span class="LIDENT">ext</span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>        <span class="SEMI">;</span></span> <span id="def_232"><span class="LIDENT">maturity</span> <span class="COLON">:</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">maturity</span> <span class="LIDENT">option</span></span><span class="EOL">
</span>        <span class="RBRACE">}</span><span class="EOL">
</span>        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">error</span></span><span class="EOL">
</span>    <span id="module-Error.type-error.constructor-Wrong_syntactic_category"><span class="BAR">|</span> <span class="UIDENT">Wrong_syntactic_category</span> <span class="OF">of</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>    <span id="module-Error.type-error.constructor-Misnamed_embedding"><span class="BAR">|</span> <span class="UIDENT">Misnamed_embedding</span> <span class="OF">of</span> <span class="UIDENT">Misnamed_embedding_error</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LIDENT">string</span> <span class="STAR">*</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>    <span id="module-Error.type-error.constructor-Bad_introduction"><span class="BAR">|</span> <span class="UIDENT">Bad_introduction</span> <span class="OF">of</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">t</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** The exception type thrown when desugaring a piece of modular syntax from
      an OCaml AST *)</span><span class="EOL">
</span>  <span id="module-Error.exception-Error"><span class="EXCEPTION">exception</span> <span class="UIDENT">Error</span> <span class="OF">of</span> <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LIDENT">error</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <span class="UIDENT">Error</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-assert_extension_enabled"><span class="LIDENT">assert_extension_enabled</span></span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_loc_31"><span class="LIDENT">loc</span></span> <span class="LPAREN">(</span><span id="local_ext_32"><span class="LIDENT">ext</span></span> <span class="COLON">:</span> <span class="LIDENT">a</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_setting_33"><span class="LIDENT">setting</span></span> <span class="COLON">:</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">is_at_least</span> <a href="#local_ext_32"><span class="LIDENT">ext</span></a> <a href="#local_setting_33"><span class="LIDENT">setting</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_maturity_34"><span class="LIDENT">maturity</span></span> <span class="COLON">:</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">maturity</span> <span class="LIDENT">option</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_ext_32"><span class="LIDENT">ext</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Layouts</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_setting_33"><span class="LIDENT">setting</span></a> <span class="COLON">:</span> <span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">maturity</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><a href="#local_loc_31"><span class="LIDENT">loc</span></a><span class="COMMA">,</span> <span class="UIDENT">Disabled_extension</span> <span class="LBRACE">{</span> <a href="#local_ext_32"><span class="LIDENT">ext</span></a><span class="SEMI">;</span> <a href="#local_maturity_34"><span class="LIDENT">maturity</span></a> <span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-report_error"><span class="LIDENT">report_error</span></span> <span class="TILDE">~</span><span id="local_loc_35"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Introduction_has_payload</span> <span class="LPAREN">(</span><span id="local_what_36"><span class="LIDENT">what</span></span><span class="COMMA">,</span> <span id="local_name_37"><span class="LIDENT">name</span></span><span class="COMMA">,</span> <span id="local__payload_38"><span class="LIDENT">_payload</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="EOL">
</span>      <span class="STRING">&quot;@[Modular syntax %s are not allowed to have a payload,@ but %a does@]&quot;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">name_plural</span> <a href="#local_what_36"><span class="LIDENT">what</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">pp_quoted_name</span><span class="EOL">
</span>      <a href="#local_name_37"><span class="LIDENT">name</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Unknown_extension</span> <span class="LPAREN">(</span><span id="local_what_39"><span class="LIDENT">what</span></span><span class="COMMA">,</span> <span id="local_erasability_40"><span class="LIDENT">erasability</span></span><span class="COMMA">,</span> <span id="local_name_41"><span class="LIDENT">name</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_embedded_name_42"><span class="LIDENT">embedded_name</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_erasability_40"><span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">erasability</span></a><span class="SEMI">;</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <a href="#local_name_41"><span class="LIDENT">name</span></a> <span class="RBRACKET">]</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="EOL">
</span>      <span class="STRING">&quot;@[Unknown extension \&quot;%s\&quot; referenced via@ %a %s@]&quot;</span><span class="EOL">
</span>      <a href="#local_name_41"><span class="LIDENT">name</span></a><span class="EOL">
</span>      <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">pp_a_term</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="#local_what_39"><span class="LIDENT">what</span></a><span class="COMMA">,</span> <a href="#local_embedded_name_42"><span class="LIDENT">embedded_name</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">name</span> <a href="#local_what_39"><span class="LIDENT">what</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Disabled_extension</span> <span class="LBRACE">{</span> <span id="local_ext_43"><span class="LIDENT">ext</span></span><span class="SEMI">;</span> <span id="local_maturity_44"><span class="LIDENT">maturity</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_maturity_44"><span class="LIDENT">maturity</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span><span class="EOL">
</span>         <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="EOL">
</span>         <span class="STRING">&quot;The extension \&quot;%s\&quot; is disabled and cannot be used&quot;</span><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_ext_43"><span class="LIDENT">ext</span></a><span class="RPAREN">)</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_maturity_45"><span class="LIDENT">maturity</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span><span class="EOL">
</span>         <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="EOL">
</span>         <span class="STRING">&quot;This construct requires the %s version of the extension \&quot;%s\&quot;, which is \
          disabled and cannot be used&quot;</span><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">maturity_to_string</span> <a href="#local_maturity_45"><span class="LIDENT">maturity</span></a><span class="RPAREN">)</span><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="UIDENT">Language_extension</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_ext_43"><span class="LIDENT">ext</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Wrong_syntactic_category</span> <span class="LPAREN">(</span><span id="local_feat_46"><span class="LIDENT">feat</span></span><span class="COMMA">,</span> <span id="local_cat_47"><span class="LIDENT">cat</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span> <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a> <span class="STRING">&quot;%s cannot appear in %s&quot;</span> <span class="LPAREN">(</span><span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">describe_uppercase</span> <a href="#local_feat_46"><span class="LIDENT">feat</span></a><span class="RPAREN">)</span> <a href="#local_cat_47"><span class="LIDENT">cat</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Misnamed_embedding</span> <span class="LPAREN">(</span><span id="local_err_48"><span class="LIDENT">err</span></span><span class="COMMA">,</span> <span id="local_name_49"><span class="LIDENT">name</span></span><span class="COMMA">,</span> <span id="local_what_50"><span class="LIDENT">what</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="EOL">
</span>      <span class="STRING">&quot;Cannot have %s named %a: %s&quot;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">name_indefinite</span> <a href="#local_what_50"><span class="LIDENT">what</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">pp</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="#local_what_50"><span class="LIDENT">what</span></a><span class="COMMA">,</span> <a href="#local_name_49"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Misnamed_embedding_error</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_err_48"><span class="LIDENT">err</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bad_introduction</span> <span class="LPAREN">(</span><span id="local_what_51"><span class="LIDENT">what</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span id="local_ext_53"><span class="LIDENT">ext</span></span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_name_52"><span class="LIDENT">name</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">errorf</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_loc_35"><span class="LIDENT">loc</span></a><span class="EOL">
</span>      <span class="STRING">&quot;@[The extension \&quot;%s\&quot; was referenced improperly; it started with@ %a %s,@ not %a \
       one@]&quot;</span><span class="EOL">
</span>      <a href="#local_ext_53"><span class="LIDENT">ext</span></a><span class="EOL">
</span>      <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">pp_a_term</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="#local_what_51"><span class="LIDENT">what</span></a><span class="COMMA">,</span> <a href="#local_name_52"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">name</span> <a href="#local_what_51"><span class="LIDENT">what</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">pp_a_term</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="#local_what_51"><span class="LIDENT">what</span></a><span class="COMMA">,</span> <span class="LBRACE">{</span> <a href="#local_name_52"><span class="LIDENT">name</span></a> <span class="WITH">with</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <a href="#local_ext_53"><span class="LIDENT">ext</span></a> <span class="RBRACKET">]</span> <span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">register_error_of_exn</span> <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span id="local_loc_54"><span class="LIDENT">loc</span></span><span class="COMMA">,</span> <span id="local_err_55"><span class="LIDENT">err</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">report_error</span> <span class="TILDE">~</span><a href="#local_loc_54"><span class="LIDENT">loc</span></a> <a href="#local_err_55"><span class="LIDENT">err</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span><span class="DOCSTRING">(** Generically find and create the OCaml AST syntax used to encode one of our
    novel syntactic features.  One module per variety of AST (expressions,
    patterns, etc.). *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** The parameters that define how to look for [[%jane.*.FEATNAME]] and
    [[@jane.*.FEATNAME]] inside ASTs of a certain syntactic category. This
    module type describes the input to the [Make_with_attribute] and
    [Make_with_extension_node] functors (though they stipulate additional
    requirements for their inputs).
*)</span><span class="EOL">
</span><span id="module-type-AST_syntactic_category"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">AST_syntactic_category</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="DOCSTRING">(** The AST type (e.g., [Parsetree.expression]) *)</span><span class="EOL">
</span>  <span id="module-type-AST_syntactic_category.type-ast"><span class="TYPE">type</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** The name for this syntactic category in the plural form; used for error
      messages (e.g., &quot;expressions&quot;) *)</span><span class="EOL">
</span>  <span id="module-type-AST_syntactic_category.val-plural"><span class="VAL">val</span> <span class="LIDENT">plural</span> <span class="COLON">:</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** How to get the location attached to an AST node.  Should just be
      [fun tm -&gt; tm.pCAT_loc] for the appropriate syntactic category [CAT]. *)</span><span class="EOL">
</span>  <span id="module-type-AST_syntactic_category.val-location"><span class="VAL">val</span> <span class="LIDENT">location</span> <span class="COLON">:</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Set the location of an AST node. *)</span><span class="EOL">
</span>  <span id="module-type-AST_syntactic_category.val-with_location"><span class="VAL">val</span> <span class="LIDENT">with_location</span> <span class="COLON">:</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-AST_internal"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">AST_internal</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-AST_internal.val-embedding_syntax"><span class="VAL">val</span> <span class="LIDENT">embedding_syntax</span> <span class="COLON">:</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-AST_internal.val-make_jane_syntax"><span class="VAL">val</span> <span class="LIDENT">make_jane_syntax</span> <span class="COLON">:</span> <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="OPTLABEL">?payload:</span><a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-payload"><span class="LIDENT">payload</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given an AST node, check if it's a representation of a term from one of
      our novel syntactic features; if it is, split it back up into its name,
      the location of the extension/attribute, any payload, and the body.  If
      the embedded term is malformed in any way, raises an error; if the input
      isn't an embedding of one of our novel syntactic features, returns [None].
      Partial inverse of [make_jane_syntax]. *)</span><span class="EOL">
</span>  <span id="module-type-AST_internal.val-match_jane_syntax"><span class="VAL">val</span> <span class="LIDENT">match_jane_syntax</span><span class="EOL">
</span>    <span class="COLON">:</span>  <span class="LIDENT">ast</span><span class="EOL">
</span>    <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-payload"><span class="UIDENT">Parsetree</span><span class="DOT">.</span><span class="LIDENT">payload</span></a> <span class="STAR">*</span> <span class="LIDENT">ast</span><span class="RPAREN">)</span> <span class="LIDENT">option</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Parses the embedded name from an embedding, raising if
    the embedding is malformed. Malformed means that
    NAME is missing; e.g. the attribute is just [[@jane]].
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_embedding_exn"><span class="LIDENT">parse_embedding_exn</span></span> <span class="TILDE">~</span><span id="local_loc_56"><span class="LIDENT">loc</span></span> <span class="TILDE">~</span><span id="local_name_57"><span class="LIDENT">name</span></span> <span class="TILDE">~</span><span id="local_embedding_syntax_58"><span class="LIDENT">embedding_syntax</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_raise_error_59"><span class="LIDENT">raise_error</span></span> <span id="local_err_60"><span class="LIDENT">err</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><a href="#local_loc_56"><span class="LIDENT">loc</span></a><span class="COMMA">,</span> <a href="#local_err_60"><span class="LIDENT">err</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">of_string</span> <a href="#local_name_57"><span class="LIDENT">name</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Ok</span> <span id="local_name_61"><span class="LIDENT">name</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_name_61"><span class="LIDENT">name</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span id="local_err_62"><span class="LIDENT">err</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_raise_error_59"><span class="LIDENT">raise_error</span></a> <span class="LPAREN">(</span><span class="UIDENT">Misnamed_embedding</span> <span class="LPAREN">(</span><a href="#local_err_62"><span class="LIDENT">err</span></a><span class="COMMA">,</span> <a href="#local_name_57"><span class="LIDENT">name</span></a><span class="COMMA">,</span> <a href="#local_embedding_syntax_58"><span class="LIDENT">embedding_syntax</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_and_remove_jane_syntax_attribute"><span class="LIDENT">find_and_remove_jane_syntax_attribute</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* Recurs on [rev_prefix] *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_63"><span class="LIDENT">loop</span></span> <span class="TILDE">~</span><span id="local_rev_prefix_64"><span class="LIDENT">rev_prefix</span></span> <span class="TILDE">~</span><span id="local_suffix_65"><span class="LIDENT">suffix</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_rev_prefix_64"><span class="LIDENT">rev_prefix</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_attr_66"><span class="LIDENT">attr</span></span> <span class="COLONCOLON">::</span> <span id="local_rev_prefix_67"><span class="LIDENT">rev_prefix</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_226"><span class="LBRACE">{</span> <span class="LIDENT">attr_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_68"><span class="LIDENT">name</span></span><span class="SEMI">;</span> <span class="LIDENT">loc</span> <span class="EQUAL">=</span> <span id="local_attr_loc_69"><span class="LIDENT">attr_loc</span></span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_attr_payload_70"><span class="LIDENT">attr_payload</span></span> <span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_attr_66"><span class="LIDENT">attr</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="LIDENT">parse_embedding_exn</span> <span class="LABEL">~loc:</span><a href="#local_attr_loc_69"><span class="LIDENT">attr_loc</span></a> <span class="TILDE">~</span><a href="#local_name_68"><span class="LIDENT">name</span></a> <span class="LABEL">~embedding_syntax:</span><span class="UIDENT">Attribute</span> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_63"><span class="LIDENT">loop</span></a> <span class="TILDE">~</span><a href="#local_rev_prefix_67"><span class="LIDENT">rev_prefix</span></a> <span class="LABEL">~suffix:</span><span class="LPAREN">(</span><a href="#local_attr_66"><span class="LIDENT">attr</span></a> <span class="COLONCOLON">::</span> <a href="#local_suffix_65"><span class="LIDENT">suffix</span></a><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_name_71"><span class="LIDENT">name</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LET">let</span> <span id="local_unconsumed_attributes_72"><span class="LIDENT">unconsumed_attributes</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_append"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_append</span></a> <a href="#local_rev_prefix_67"><span class="LIDENT">rev_prefix</span></a> <a href="#local_suffix_65"><span class="LIDENT">suffix</span></a> <span class="IN">in</span><span class="EOL">
</span>         <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_name_71"><span class="LIDENT">name</span></a><span class="COMMA">,</span> <a href="#local_attr_loc_69"><span class="LIDENT">attr_loc</span></a><span class="COMMA">,</span> <a href="#local_attr_payload_70"><span class="LIDENT">attr_payload</span></a><span class="COMMA">,</span> <a href="#local_unconsumed_attributes_72"><span class="LIDENT">unconsumed_attributes</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_attributes_73"><span class="LIDENT">attributes</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_63"><span class="LIDENT">loop</span></a> <span class="LABEL">~rev_prefix:</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_attributes_73"><span class="LIDENT">attributes</span></a><span class="RPAREN">)</span> <span class="LABEL">~suffix:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-{make_jane_syntax_attribute}1/shadowed/(ppxlib_jane-src-ppxlib_jane-jane_syntax_parsing.ml)"><span class="LIDENT">make_jane_syntax_attribute</span></span> <span id="local_name_74"><span class="LIDENT">name</span></span> <span id="local_payload_75"><span class="LIDENT">payload</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span class="LIDENT">attr_name</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_name_74"><span class="LIDENT">name</span></a><span class="SEMI">;</span> <span class="LIDENT">loc</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#val-default_loc"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="LIDENT">default_loc</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMI">;</span> <span class="LIDENT">attr_loc</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#val-default_loc"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="LIDENT">default_loc</span></a><span class="EOL">
</span>  <span class="SEMI">;</span> <span class="LIDENT">attr_payload</span> <span class="EQUAL">=</span> <a href="#local_payload_75"><span class="LIDENT">payload</span></a><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** For a syntactic category, produce translations into and out of
    our novel syntax, using parsetree attributes as the encoding.
*)</span><span class="EOL">
</span><span id="module-Make_with_attribute"><span class="MODULE">module</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="UIDENT">AST_syntactic_category</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make_with_attribute.argument-1-AST_syntactic_category.val-attributes"><span class="VAL">val</span> <span class="LIDENT">attributes</span> <span class="COLON">:</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-attributes"><span class="LIDENT">attributes</span></a></span><span class="EOL">
</span>  <span id="module-Make_with_attribute.argument-1-AST_syntactic_category.val-with_attributes"><span class="VAL">val</span> <span class="LIDENT">with_attributes</span> <span class="COLON">:</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-attributes"><span class="LIDENT">attributes</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span> <span class="COLON">:</span> <span class="UIDENT">AST_internal</span> <span class="WITH">with</span> <span id="def_241"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <span class="UIDENT">AST_syntactic_category</span><span class="DOT">.</span><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_with_attribute.val-embedding_syntax"><span class="LIDENT">embedding_syntax</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="UIDENT">Attribute</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_with_attribute.val-make_jane_syntax"><span class="LIDENT">make_jane_syntax</span></span> <span id="local_name_76"><span class="LIDENT">name</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_payload_77"><span class="LIDENT">payload</span></span> <span class="EQUAL">=</span> <span class="UIDENT">PStr</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span id="local_ast_78"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_attr_79"><span class="LIDENT">attr</span></span> <span class="EQUAL">=</span> <span class="LIDENT">make_jane_syntax_attribute</span> <a href="#local_name_76"><span class="LIDENT">name</span></a> <a href="#local_payload_77"><span class="LIDENT">payload</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* See Note [Outer attributes at end] in jane_syntax.ml *)</span><span class="EOL">
</span>    <span class="LIDENT">with_attributes</span> <a href="#local_ast_78"><span class="LIDENT">ast</span></a> <span class="LPAREN">(</span><span class="LIDENT">attributes</span> <a href="#local_ast_78"><span class="LIDENT">ast</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(@)"><span class="INFIXOP1">@</span></a> <span class="LBRACKET">[</span> <a href="#local_attr_79"><span class="LIDENT">attr</span></a> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_with_attribute.val-match_jane_syntax"><span class="LIDENT">match_jane_syntax</span></span> <span id="local_ast_80"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">find_and_remove_jane_syntax_attribute</span> <span class="LPAREN">(</span><span class="LIDENT">attributes</span> <a href="#local_ast_80"><span class="LIDENT">ast</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span id="local_name_81"><span class="LIDENT">name</span></span><span class="COMMA">,</span> <span id="local_loc_82"><span class="LIDENT">loc</span></span><span class="COMMA">,</span> <span id="local_payload_83"><span class="LIDENT">payload</span></span><span class="COMMA">,</span> <span id="local_attrs_84"><span class="LIDENT">attrs</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_name_81"><span class="LIDENT">name</span></a><span class="COMMA">,</span> <a href="#local_loc_82"><span class="LIDENT">loc</span></a><span class="COMMA">,</span> <a href="#local_payload_83"><span class="LIDENT">payload</span></a><span class="COMMA">,</span> <span class="LIDENT">with_attributes</span> <a href="#local_ast_80"><span class="LIDENT">ast</span></a> <a href="#local_attrs_84"><span class="LIDENT">attrs</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** For a syntactic category, produce translations into and out of
    our novel syntax, using extension nodes as the encoding.
*)</span><span class="EOL">
</span><span id="module-Make_with_extension_node"><span class="MODULE">module</span> <span class="UIDENT">Make_with_extension_node</span> <span class="LPAREN">(</span><span class="UIDENT">AST_syntactic_category</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** How to construct an extension node for this AST (something of the
          shape [[%name]]). Should just be [Ast_helper.CAT.extension] for the
          appropriate syntactic category [CAT]. (This means that [?loc] should
          default to [!Ast_helper.default_loc.].) *)</span><span class="EOL">
</span>  <span id="module-Make_with_extension_node.argument-1-AST_syntactic_category.val-make_extension_node"><span class="VAL">val</span> <span class="LIDENT">make_extension_node</span> <span class="COLON">:</span> <span class="OPTLABEL">?loc:</span><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="OPTLABEL">?attrs:</span><a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-attributes"><span class="LIDENT">attributes</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-extension"><span class="LIDENT">extension</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given an extension node (as created by [make_extension_node]) with an
          appropriately-formed name and a body, combine them into the special
          syntactic form we use for novel syntactic features in this syntactic
          category. Partial inverse of [match_extension_use]. *)</span><span class="EOL">
</span>  <span id="module-Make_with_extension_node.argument-1-AST_syntactic_category.val-make_extension_use"><span class="VAL">val</span> <span class="LIDENT">make_extension_use</span> <span class="COLON">:</span> <span class="LIDENT">extension_node</span><span class="COLON">:</span><span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given an AST node, check if it's of the special syntactic form
          indicating that this is one of our novel syntactic features (as
          created by [make_extension_node]), split it back up into the extension
          node and the possible body. Doesn't do any checking about the
          name/format of the extension or the possible body terms (for which see
          [AST.match_extension]). Partial inverse of [make_extension_use]. *)</span><span class="EOL">
</span>  <span id="module-Make_with_extension_node.argument-1-AST_syntactic_category.val-match_extension_use"><span class="VAL">val</span> <span class="LIDENT">match_extension_use</span> <span class="COLON">:</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-extension"><span class="LIDENT">extension</span></a> <span class="STAR">*</span> <span class="LIDENT">ast</span><span class="RPAREN">)</span> <span class="LIDENT">option</span></span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span> <span class="COLON">:</span> <span class="UIDENT">AST_internal</span> <span class="WITH">with</span> <span id="def_229"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <span class="UIDENT">AST_syntactic_category</span><span class="DOT">.</span><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_with_extension_node.val-embedding_syntax"><span class="LIDENT">embedding_syntax</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Embedding_syntax</span><span class="DOT">.</span><span class="UIDENT">Extension_node</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_with_extension_node.val-make_jane_syntax"><span class="LIDENT">make_jane_syntax</span></span> <span id="local_name_85"><span class="LIDENT">name</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_payload_86"><span class="LIDENT">payload</span></span> <span class="EQUAL">=</span> <span class="UIDENT">PStr</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span id="local_ast_87"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">make_extension_use</span><span class="EOL">
</span>      <a href="#local_ast_87"><span class="LIDENT">ast</span></a><span class="EOL">
</span>      <span class="LABEL">~extension_node:</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LIDENT">make_extension_node</span><span class="EOL">
</span>           <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_name_85"><span class="LIDENT">name</span></a><span class="SEMI">;</span> <span class="LIDENT">loc</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#val-default_loc"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="LIDENT">default_loc</span></a> <span class="RBRACE">}</span><span class="COMMA">,</span> <a href="#local_payload_86"><span class="LIDENT">payload</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_with_extension_node.val-match_jane_syntax"><span class="LIDENT">match_jane_syntax</span></span> <span id="local_ast_88"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">match_extension_use</span> <a href="#local_ast_88"><span class="LIDENT">ast</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">txt</span> <span class="EQUAL">=</span> <span id="local_name_89"><span class="LIDENT">name</span></span><span class="SEMI">;</span> <span class="LIDENT">loc</span> <span class="EQUAL">=</span> <span id="local_ext_loc_90"><span class="LIDENT">ext_loc</span></span> <span class="RBRACE">}</span><span class="COMMA">,</span> <span id="local_ext_payload_91"><span class="LIDENT">ext_payload</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_body_92"><span class="LIDENT">body</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="LIDENT">parse_embedding_exn</span> <span class="LABEL">~loc:</span><a href="#local_ext_loc_90"><span class="LIDENT">ext_loc</span></a> <span class="TILDE">~</span><a href="#local_name_89"><span class="LIDENT">name</span></a> <span class="TILDE">~</span><span class="LIDENT">embedding_syntax</span> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_name_93"><span class="LIDENT">name</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_name_93"><span class="LIDENT">name</span></a><span class="COMMA">,</span> <a href="#local_ext_loc_90"><span class="LIDENT">ext_loc</span></a><span class="COMMA">,</span> <a href="#local_ext_payload_91"><span class="LIDENT">ext_payload</span></a><span class="COMMA">,</span> <a href="#local_body_92"><span class="LIDENT">body</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(********************************************************)</span><span class="EOL">
</span><span class="COMMENT">(* Modules representing individual syntactic categories *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Note [Hiding internal details]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

   Each such module is first written with a '0' suffix. These '0'
   modules are used internally as arguments to [Make_ast] to produce
   non-'0' modules which are exported. This approach allows us to
   hide details of these modules necessary for [Make_ast] but
   unnecessary for external uses.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** The AST parameters for every subset of types; embedded with attributes. *)</span><span class="EOL">
</span><span id="module-Type_AST_syntactic_category"><span class="MODULE">module</span> <span class="UIDENT">Type_AST_syntactic_category</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Type_AST_syntactic_category.type-ast"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-core_type"><span class="LIDENT">core_type</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Missing [plural] *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Type_AST_syntactic_category.val-location"><span class="LIDENT">location</span></span> <span id="local_typ_94"><span class="LIDENT">typ</span></span> <span class="EQUAL">=</span> <a href="#local_typ_94"><span class="LIDENT">typ</span></a><span class="DOT">.</span><span class="LIDENT">ptyp_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Type_AST_syntactic_category.val-with_location"><span class="LIDENT">with_location</span></span> <span id="local_typ_95"><span class="LIDENT">typ</span></span> <span id="local_l_96"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_typ_95"><span class="LIDENT">typ</span></a> <span class="WITH">with</span> <span class="LIDENT">ptyp_loc</span> <span class="EQUAL">=</span> <a href="#local_l_96"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Type_AST_syntactic_category.val-attributes"><span class="LIDENT">attributes</span></span> <span id="local_typ_97"><span class="LIDENT">typ</span></span> <span class="EQUAL">=</span> <a href="#local_typ_97"><span class="LIDENT">typ</span></a><span class="DOT">.</span><span class="LIDENT">ptyp_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Type_AST_syntactic_category.val-with_attributes"><span class="LIDENT">with_attributes</span></span> <span id="local_typ_98"><span class="LIDENT">typ</span></span> <span id="local_ptyp_attributes_99"><span class="LIDENT">ptyp_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_typ_98"><span class="LIDENT">typ</span></a> <span class="WITH">with</span> <a href="#local_ptyp_attributes_99"><span class="LIDENT">ptyp_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Types; embedded with attributes. *)</span><span class="EOL">
</span><span id="module-Core_type0"><span class="MODULE">module</span> <span class="UIDENT">Core_type0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">Type_AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_100"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;types&quot;</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Constructor arguments; the same as types, but used in fewer places *)</span><span class="EOL">
</span><span id="module-Constructor_argument0"><span class="MODULE">module</span> <span class="UIDENT">Constructor_argument0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">Type_AST_syntactic_category</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_101"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;constructor arguments&quot;</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Expressions; embedded using an attribute on the expression. *)</span><span class="EOL">
</span><span id="module-Expression0"><span class="MODULE">module</span> <span class="UIDENT">Expression0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_234"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-expression"><span class="LIDENT">expression</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_102"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;expressions&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_103"><span class="LIDENT">location</span></span> <span id="local_expr_104"><span class="LIDENT">expr</span></span> <span class="EQUAL">=</span> <a href="#local_expr_104"><span class="LIDENT">expr</span></a><span class="DOT">.</span><span class="LIDENT">pexp_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_105"><span class="LIDENT">with_location</span></span> <span id="local_expr_106"><span class="LIDENT">expr</span></span> <span id="local_l_107"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_expr_106"><span class="LIDENT">expr</span></a> <span class="WITH">with</span> <span class="LIDENT">pexp_loc</span> <span class="EQUAL">=</span> <a href="#local_l_107"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_attributes_108"><span class="LIDENT">attributes</span></span> <span id="local_expr_109"><span class="LIDENT">expr</span></span> <span class="EQUAL">=</span> <a href="#local_expr_109"><span class="LIDENT">expr</span></a><span class="DOT">.</span><span class="LIDENT">pexp_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_attributes_110"><span class="LIDENT">with_attributes</span></span> <span id="local_expr_111"><span class="LIDENT">expr</span></span> <span id="local_pexp_attributes_112"><span class="LIDENT">pexp_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_expr_111"><span class="LIDENT">expr</span></a> <span class="WITH">with</span> <a href="#local_pexp_attributes_112"><span class="LIDENT">pexp_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Patterns; embedded using an attribute on the pattern. *)</span><span class="EOL">
</span><span id="module-Pattern0"><span class="MODULE">module</span> <span class="UIDENT">Pattern0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_233"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-pattern"><span class="LIDENT">pattern</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_113"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;patterns&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_114"><span class="LIDENT">location</span></span> <span id="local_pat_115"><span class="LIDENT">pat</span></span> <span class="EQUAL">=</span> <a href="#local_pat_115"><span class="LIDENT">pat</span></a><span class="DOT">.</span><span class="LIDENT">ppat_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_116"><span class="LIDENT">with_location</span></span> <span id="local_pat_117"><span class="LIDENT">pat</span></span> <span id="local_l_118"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_pat_117"><span class="LIDENT">pat</span></a> <span class="WITH">with</span> <span class="LIDENT">ppat_loc</span> <span class="EQUAL">=</span> <a href="#local_l_118"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_attributes_119"><span class="LIDENT">attributes</span></span> <span id="local_pat_120"><span class="LIDENT">pat</span></span> <span class="EQUAL">=</span> <a href="#local_pat_120"><span class="LIDENT">pat</span></a><span class="DOT">.</span><span class="LIDENT">ppat_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_attributes_121"><span class="LIDENT">with_attributes</span></span> <span id="local_pat_122"><span class="LIDENT">pat</span></span> <span id="local_ppat_attributes_123"><span class="LIDENT">ppat_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_pat_122"><span class="LIDENT">pat</span></a> <span class="WITH">with</span> <a href="#local_ppat_attributes_123"><span class="LIDENT">ppat_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Module types; embedded using an attribute on the module type. *)</span><span class="EOL">
</span><span id="module-Module_type0"><span class="MODULE">module</span> <span class="UIDENT">Module_type0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_228"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-module_type"><span class="LIDENT">module_type</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_124"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;module types&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_125"><span class="LIDENT">location</span></span> <span id="local_mty_126"><span class="LIDENT">mty</span></span> <span class="EQUAL">=</span> <a href="#local_mty_126"><span class="LIDENT">mty</span></a><span class="DOT">.</span><span class="LIDENT">pmty_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_127"><span class="LIDENT">with_location</span></span> <span id="local_mty_128"><span class="LIDENT">mty</span></span> <span id="local_l_129"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_mty_128"><span class="LIDENT">mty</span></a> <span class="WITH">with</span> <span class="LIDENT">pmty_loc</span> <span class="EQUAL">=</span> <a href="#local_l_129"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_attributes_130"><span class="LIDENT">attributes</span></span> <span id="local_mty_131"><span class="LIDENT">mty</span></span> <span class="EQUAL">=</span> <a href="#local_mty_131"><span class="LIDENT">mty</span></a><span class="DOT">.</span><span class="LIDENT">pmty_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_attributes_132"><span class="LIDENT">with_attributes</span></span> <span id="local_mty_133"><span class="LIDENT">mty</span></span> <span id="local_pmty_attributes_134"><span class="LIDENT">pmty_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_mty_133"><span class="LIDENT">mty</span></a> <span class="WITH">with</span> <a href="#local_pmty_attributes_134"><span class="LIDENT">pmty_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Extension constructors; embedded using an attribute. *)</span><span class="EOL">
</span><span id="module-Extension_constructor0"><span class="MODULE">module</span> <span class="UIDENT">Extension_constructor0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_230"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-extension_constructor"><span class="LIDENT">extension_constructor</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_135"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;extension constructors&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_136"><span class="LIDENT">location</span></span> <span id="local_ext_137"><span class="LIDENT">ext</span></span> <span class="EQUAL">=</span> <a href="#local_ext_137"><span class="LIDENT">ext</span></a><span class="DOT">.</span><span class="LIDENT">pext_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_138"><span class="LIDENT">with_location</span></span> <span id="local_ext_139"><span class="LIDENT">ext</span></span> <span id="local_l_140"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_ext_139"><span class="LIDENT">ext</span></a> <span class="WITH">with</span> <span class="LIDENT">pext_loc</span> <span class="EQUAL">=</span> <a href="#local_l_140"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_attributes_141"><span class="LIDENT">attributes</span></span> <span id="local_ext_142"><span class="LIDENT">ext</span></span> <span class="EQUAL">=</span> <a href="#local_ext_142"><span class="LIDENT">ext</span></a><span class="DOT">.</span><span class="LIDENT">pext_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_attributes_143"><span class="LIDENT">with_attributes</span></span> <span id="local_ext_144"><span class="LIDENT">ext</span></span> <span id="local_pext_attributes_145"><span class="LIDENT">pext_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_ext_144"><span class="LIDENT">ext</span></a> <span class="WITH">with</span> <a href="#local_pext_attributes_145"><span class="LIDENT">pext_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Signature items; embedded as
    [include sig [%%extension.EXTNAME];; BODY end]. Signature items don't have
    attributes or we'd use them instead.
*)</span><span class="EOL">
</span><span id="module-Signature_item0"><span class="MODULE">module</span> <span class="UIDENT">Signature_item0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_extension_node</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_236"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-signature_item"><span class="LIDENT">signature_item</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_146"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;signature items&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_147"><span class="LIDENT">location</span></span> <span id="local_sigi_148"><span class="LIDENT">sigi</span></span> <span class="EQUAL">=</span> <a href="#local_sigi_148"><span class="LIDENT">sigi</span></a><span class="DOT">.</span><span class="LIDENT">psig_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_149"><span class="LIDENT">with_location</span></span> <span id="local_sigi_150"><span class="LIDENT">sigi</span></span> <span id="local_l_151"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_sigi_150"><span class="LIDENT">sigi</span></a> <span class="WITH">with</span> <span class="LIDENT">psig_loc</span> <span class="EQUAL">=</span> <a href="#local_l_151"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_make_extension_node_152"><span class="LIDENT">make_extension_node</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Sig.val-extension"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="UIDENT">Sig</span><span class="DOT">.</span><span class="LIDENT">extension</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_make_extension_use_153"><span class="LIDENT">make_extension_use</span></span> <span class="TILDE">~</span><span id="local_extension_node_154"><span class="LIDENT">extension_node</span></span> <span id="local_sigi_155"><span class="LIDENT">sigi</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Sig.val-include_"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="UIDENT">Sig</span><span class="DOT">.</span><span class="LIDENT">include_</span></a><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">pincl_mod</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Mty.val-signature"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="UIDENT">Mty</span><span class="DOT">.</span><span class="LIDENT">signature</span></a> <span class="LBRACKET">[</span> <a href="#local_extension_node_154"><span class="LIDENT">extension_node</span></a><span class="SEMI">;</span> <a href="#local_sigi_155"><span class="LIDENT">sigi</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">pincl_loc</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#val-default_loc"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="LIDENT">default_loc</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">pincl_attributes</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_match_extension_use_156"><span class="LIDENT">match_extension_use</span></span> <span id="local_sigi_157"><span class="LIDENT">sigi</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_sigi_157"><span class="LIDENT">sigi</span></a><span class="DOT">.</span><span class="LIDENT">psig_desc</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Psig_include</span><span class="EOL">
</span>        <span class="LBRACE">{</span> <span class="LIDENT">pincl_mod</span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="LBRACE">{</span> <span class="LIDENT">pmty_desc</span> <span class="EQUAL">=</span><span class="EOL">
</span>                <span class="UIDENT">Pmty_signature</span> <span class="LBRACKET">[</span> <span class="LBRACE">{</span> <span class="LIDENT">psig_desc</span> <span class="EQUAL">=</span> <span class="UIDENT">Psig_extension</span> <span class="LPAREN">(</span><span id="local_ext_158"><span class="LIDENT">ext</span></span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_sigi_159"><span class="LIDENT">sigi</span></span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>            <span class="RBRACE">}</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>        <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_ext_158"><span class="LIDENT">ext</span></a><span class="COMMA">,</span> <a href="#local_sigi_159"><span class="LIDENT">sigi</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Structure items; embedded as
    [include struct [%%extension.EXTNAME];; BODY end]. Structure items don't
    have attributes or we'd use them instead.
*)</span><span class="EOL">
</span><span id="module-Structure_item0"><span class="MODULE">module</span> <span class="UIDENT">Structure_item0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_extension_node</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_225"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-structure_item"><span class="LIDENT">structure_item</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_160"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;structure items&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_161"><span class="LIDENT">location</span></span> <span id="local_stri_162"><span class="LIDENT">stri</span></span> <span class="EQUAL">=</span> <a href="#local_stri_162"><span class="LIDENT">stri</span></a><span class="DOT">.</span><span class="LIDENT">pstr_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_163"><span class="LIDENT">with_location</span></span> <span id="local_stri_164"><span class="LIDENT">stri</span></span> <span id="local_l_165"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_stri_164"><span class="LIDENT">stri</span></a> <span class="WITH">with</span> <span class="LIDENT">pstr_loc</span> <span class="EQUAL">=</span> <a href="#local_l_165"><span class="LIDENT">l</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_make_extension_node_166"><span class="LIDENT">make_extension_node</span></span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Str.val-extension"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="UIDENT">Str</span><span class="DOT">.</span><span class="LIDENT">extension</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_make_extension_use_167"><span class="LIDENT">make_extension_use</span></span> <span class="TILDE">~</span><span id="local_extension_node_168"><span class="LIDENT">extension_node</span></span> <span id="local_stri_169"><span class="LIDENT">stri</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Str.val-include_"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="UIDENT">Str</span><span class="DOT">.</span><span class="LIDENT">include_</span></a><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">pincl_mod</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#module-Mod.val-structure"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="UIDENT">Mod</span><span class="DOT">.</span><span class="LIDENT">structure</span></a> <span class="LBRACKET">[</span> <a href="#local_extension_node_168"><span class="LIDENT">extension_node</span></a><span class="SEMI">;</span> <a href="#local_stri_169"><span class="LIDENT">stri</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">pincl_loc</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#val-default_loc"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="LIDENT">default_loc</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">pincl_attributes</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_match_extension_use_170"><span class="LIDENT">match_extension_use</span></span> <span id="local_stri_171"><span class="LIDENT">stri</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_stri_171"><span class="LIDENT">stri</span></a><span class="DOT">.</span><span class="LIDENT">pstr_desc</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Pstr_include</span><span class="EOL">
</span>        <span class="LBRACE">{</span> <span class="LIDENT">pincl_mod</span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="LBRACE">{</span> <span class="LIDENT">pmod_desc</span> <span class="EQUAL">=</span><span class="EOL">
</span>                <span class="UIDENT">Pmod_structure</span> <span class="LBRACKET">[</span> <span class="LBRACE">{</span> <span class="LIDENT">pstr_desc</span> <span class="EQUAL">=</span> <span class="UIDENT">Pstr_extension</span> <span class="LPAREN">(</span><span id="local_ext_172"><span class="LIDENT">ext</span></span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_stri_173"><span class="LIDENT">stri</span></span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>            <span class="RBRACE">}</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>        <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_ext_172"><span class="LIDENT">ext</span></a><span class="COMMA">,</span> <a href="#local_stri_173"><span class="LIDENT">stri</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Constructor declarations; embedded with attributes. *)</span><span class="EOL">
</span><span id="module-Constructor_declaration0"><span class="MODULE">module</span> <span class="UIDENT">Constructor_declaration0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_242"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-constructor_declaration"><span class="UIDENT">Parsetree</span><span class="DOT">.</span><span class="LIDENT">constructor_declaration</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_174"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;constructor declarations&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_175"><span class="LIDENT">location</span></span> <span id="local_pcd_176"><span class="LIDENT">pcd</span></span> <span class="EQUAL">=</span> <a href="#local_pcd_176"><span class="LIDENT">pcd</span></a><span class="DOT">.</span><span class="LIDENT">pcd_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_177"><span class="LIDENT">with_location</span></span> <span id="local_pcd_178"><span class="LIDENT">pcd</span></span> <span id="local_loc_179"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_pcd_178"><span class="LIDENT">pcd</span></a> <span class="WITH">with</span> <span class="LIDENT">pcd_loc</span> <span class="EQUAL">=</span> <a href="#local_loc_179"><span class="LIDENT">loc</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_attributes_180"><span class="LIDENT">attributes</span></span> <span id="local_pcd_181"><span class="LIDENT">pcd</span></span> <span class="EQUAL">=</span> <a href="#local_pcd_181"><span class="LIDENT">pcd</span></a><span class="DOT">.</span><span class="LIDENT">pcd_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_attributes_182"><span class="LIDENT">with_attributes</span></span> <span id="local_pcd_183"><span class="LIDENT">pcd</span></span> <span id="local_pcd_attributes_184"><span class="LIDENT">pcd_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_pcd_183"><span class="LIDENT">pcd</span></a> <span class="WITH">with</span> <a href="#local_pcd_attributes_184"><span class="LIDENT">pcd_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Type declarations; embedded with attributes. *)</span><span class="EOL">
</span><span id="module-Type_declaration0"><span class="MODULE">module</span> <span class="UIDENT">Type_declaration0</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_with_attribute</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="def_239"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-type_declaration"><span class="UIDENT">Parsetree</span><span class="DOT">.</span><span class="LIDENT">type_declaration</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_plural_185"><span class="LIDENT">plural</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;type declarations&quot;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_location_186"><span class="LIDENT">location</span></span> <span id="local_ptype_187"><span class="LIDENT">ptype</span></span> <span class="EQUAL">=</span> <a href="#local_ptype_187"><span class="LIDENT">ptype</span></a><span class="DOT">.</span><span class="LIDENT">ptype_loc</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_location_188"><span class="LIDENT">with_location</span></span> <span id="local_ptype_189"><span class="LIDENT">ptype</span></span> <span id="local_loc_190"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_ptype_189"><span class="LIDENT">ptype</span></a> <span class="WITH">with</span> <span class="LIDENT">ptype_loc</span> <span class="EQUAL">=</span> <a href="#local_loc_190"><span class="LIDENT">loc</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_attributes_191"><span class="LIDENT">attributes</span></span> <span id="local_ptype_192"><span class="LIDENT">ptype</span></span> <span class="EQUAL">=</span> <a href="#local_ptype_192"><span class="LIDENT">ptype</span></a><span class="DOT">.</span><span class="LIDENT">ptype_attributes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_with_attributes_193"><span class="LIDENT">with_attributes</span></span> <span id="local_ptype_194"><span class="LIDENT">ptype</span></span> <span id="local_ptype_attributes_195"><span class="LIDENT">ptype_attributes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_ptype_194"><span class="LIDENT">ptype</span></a> <span class="WITH">with</span> <a href="#local_ptype_attributes_195"><span class="LIDENT">ptype_attributes</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(* Main exports *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-AST"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">AST</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-AST.type-ast"><span class="TYPE">type</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-AST.val-make_jane_syntax"><span class="VAL">val</span> <span class="LIDENT">make_jane_syntax</span> <span class="COLON">:</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="LIDENT">list</span> <span class="MINUSGREATER">-&gt;</span> <span class="OPTLABEL">?payload:</span><a href="../../../ppxlib/src/ppxlib.astlib/ast_414.ml.html#module-Parsetree.type-payload"><span class="LIDENT">payload</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span>  <span id="module-type-AST.val-make_entire_jane_syntax"><span class="VAL">val</span> <span class="LIDENT">make_entire_jane_syntax</span> <span class="COLON">:</span> <span class="LIDENT">loc</span><span class="COLON">:</span><span class="UIDENT">Location</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span></span><span class="EOL">
</span>  <span id="module-type-AST.val-make_of_ast"><span class="VAL">val</span> <span class="LIDENT">make_of_ast</span> <span class="COLON">:</span> <span class="LIDENT">of_ast_internal</span><span class="COLON">:</span><span class="LPAREN">(</span><span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">option</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ast</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">option</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Most of our features make full use of the Jane Syntax framework, which
   encodes information in a specific way (e.g., payload left empty on purpose).
   It is therefore nice to check that these conditions are met. This functions
   returns [true] if the given feature needs these extra checks. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-needs_extra_checks"><span class="LIDENT">needs_extra_checks</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="UIDENT">Language_extension</span> <span class="UIDENT">Mode</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* See Note [Hiding internal details] *)</span><span class="EOL">
</span><span id="module-Make_ast"><span class="MODULE">module</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">AST</span> <span class="COLON">:</span> <span class="UIDENT">AST_internal</span><span class="RPAREN">)</span> <span class="COLON">:</span> <span class="UIDENT">AST</span> <span class="WITH">with</span> <span id="def_238"><span class="TYPE">type</span> <span class="LIDENT">ast</span> <span class="EQUAL">=</span> <span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">AST</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_ast.val-make_jane_syntax"><span class="LIDENT">make_jane_syntax</span></span> <span id="local_feature_196"><span class="LIDENT">feature</span></span> <span id="local_trailing_components_197"><span class="LIDENT">trailing_components</span></span> <span class="QUESTION">?</span><span id="local_payload_198"><span class="LIDENT">payload</span></span> <span id="local_ast_199"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">make_jane_syntax</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">of_feature</span> <a href="#local_feature_196"><span class="LIDENT">feature</span></a> <a href="#local_trailing_components_197"><span class="LIDENT">trailing_components</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="QUESTION">?</span><a href="#local_payload_198"><span class="LIDENT">payload</span></a><span class="EOL">
</span>      <a href="#local_ast_199"><span class="LIDENT">ast</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_ast.val-make_entire_jane_syntax"><span class="LIDENT">make_entire_jane_syntax</span></span> <span class="TILDE">~</span><span id="local_loc_200"><span class="LIDENT">loc</span></span> <span id="local_feature_201"><span class="LIDENT">feature</span></span> <span id="local_ast_202"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">with_location</span><span class="EOL">
</span>      <span class="COMMENT">(* We can't call [Location.ghostify] here, as we need
         [jane_syntax_parsing.ml] to build with the upstream compiler; see
         Note [Buildable with upstream] in jane_syntax.mli for details. *)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../../../ppxlib/src/ppxlib.ast/ast_helper_lite.ml.html#val-with_default_loc"><span class="UIDENT">Ast_helper</span><span class="DOT">.</span><span class="LIDENT">with_default_loc</span></a> <span class="LBRACE">{</span> <a href="#local_loc_200"><span class="LIDENT">loc</span></a> <span class="WITH">with</span> <span class="LIDENT">loc_ghost</span> <span class="EQUAL">=</span> <span class="TRUE">true</span> <span class="RBRACE">}</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LIDENT">make_jane_syntax</span> <a href="#local_feature_201"><span class="LIDENT">feature</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LPAREN">(</span><a href="#local_ast_202"><span class="LIDENT">ast</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <a href="#local_loc_200"><span class="LIDENT">loc</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Generically lift our custom ASTs for our novel syntax from OCaml ASTs. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_ast.val-make_of_ast"><span class="LIDENT">make_of_ast</span></span> <span class="TILDE">~</span><span id="local_of_ast_internal_203"><span class="LIDENT">of_ast_internal</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_of_ast_204"><span class="LIDENT">of_ast</span></span> <span id="local_ast_205"><span class="LIDENT">ast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_loc_206"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">location</span> <a href="#local_ast_205"><span class="LIDENT">ast</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_raise_error_207"><span class="LIDENT">raise_error</span></span> <span id="local_loc_208"><span class="LIDENT">loc</span></span> <span id="local_err_209"><span class="LIDENT">err</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><a href="#local_loc_208"><span class="LIDENT">loc</span></a><span class="COMMA">,</span> <a href="#local_err_209"><span class="LIDENT">err</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">match_jane_syntax</span> <a href="#local_ast_205"><span class="LIDENT">ast</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span><span class="EOL">
</span>          <span class="LPAREN">(</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_erasability_211"><span class="LIDENT">erasability</span></span><span class="SEMI">;</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span id="local_name_212"><span class="LIDENT">name</span></span> <span class="RBRACKET">]</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_embedded_name_210"><span class="LIDENT">embedded_name</span></span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="COMMA">,</span> <span id="local_syntax_loc_213"><span class="LIDENT">syntax_loc</span></span><span class="EOL">
</span>          <span class="COMMA">,</span> <span id="local_payload_214"><span class="LIDENT">payload</span></span><span class="EOL">
</span>          <span class="COMMA">,</span> <span id="local_ast_215"><span class="LIDENT">ast</span></span> <span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="UIDENT">Feature</span><span class="DOT">.</span><span class="LIDENT">of_component</span> <a href="#local_name_212"><span class="LIDENT">name</span></a> <span class="WITH">with</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_feat_216"><span class="LIDENT">feat</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="IF">if</span> <span class="LIDENT">needs_extra_checks</span> <a href="#local_feat_216"><span class="LIDENT">feat</span></a><span class="EOL">
</span>           <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>             <span class="MATCH">match</span> <a href="#local_payload_214"><span class="LIDENT">payload</span></a> <span class="WITH">with</span><span class="EOL">
</span>             <span class="BAR">|</span> <span class="UIDENT">PStr</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>               <a href="#local_raise_error_207"><span class="LIDENT">raise_error</span></a><span class="EOL">
</span>                 <a href="#local_syntax_loc_213"><span class="LIDENT">syntax_loc</span></a><span class="EOL">
</span>                 <span class="LPAREN">(</span><span class="UIDENT">Introduction_has_payload</span> <span class="LPAREN">(</span><span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">embedding_syntax</span><span class="COMMA">,</span> <a href="#local_embedded_name_210"><span class="LIDENT">embedded_name</span></a><span class="COMMA">,</span> <a href="#local_payload_214"><span class="LIDENT">payload</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>           <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_of_ast_internal_203"><span class="LIDENT">of_ast_internal</span></a> <a href="#local_feat_216"><span class="LIDENT">feat</span></a> <a href="#local_ast_215"><span class="LIDENT">ast</span></a> <span class="WITH">with</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_ext_ast_217"><span class="LIDENT">ext_ast</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_ext_ast_217"><span class="LIDENT">ext_ast</span></a><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="IF">if</span> <span class="LIDENT">needs_extra_checks</span> <a href="#local_feat_216"><span class="LIDENT">feat</span></a><span class="EOL">
</span>              <span class="THEN">then</span> <a href="#local_raise_error_207"><span class="LIDENT">raise_error</span></a> <a href="#local_loc_206"><span class="LIDENT">loc</span></a> <span class="LPAREN">(</span><span class="UIDENT">Wrong_syntactic_category</span> <span class="LPAREN">(</span><a href="#local_feat_216"><span class="LIDENT">feat</span></a><span class="COMMA">,</span> <span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">plural</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_err_218"><span class="LIDENT">err</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <a href="#local_raise_error_207"><span class="LIDENT">raise_error</span></a><span class="EOL">
</span>             <a href="#local_loc_206"><span class="LIDENT">loc</span></a><span class="EOL">
</span>             <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_err_218"><span class="LIDENT">err</span></a> <span class="WITH">with</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UIDENT">Disabled_extension</span> <span id="local_ext_219"><span class="LIDENT">ext</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Disabled_extension</span> <span class="LBRACE">{</span> <a href="#local_ext_219"><span class="LIDENT">ext</span></a><span class="SEMI">;</span> <span class="LIDENT">maturity</span> <span class="EQUAL">=</span> <span class="UIDENT">None</span> <span class="RBRACE">}</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UIDENT">Unknown_extension</span> <span id="local_name_220"><span class="LIDENT">name</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                <span class="UIDENT">Unknown_extension</span> <span class="LPAREN">(</span><span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">embedding_syntax</span><span class="COMMA">,</span> <a href="#local_erasability_211"><span class="LIDENT">erasability</span></a><span class="COMMA">,</span> <a href="#local_name_220"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">components</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_name_221"><span class="LIDENT">name</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_raise_error_207"><span class="LIDENT">raise_error</span></a> <a href="#local_loc_206"><span class="LIDENT">loc</span></a> <span class="LPAREN">(</span><span class="UIDENT">Bad_introduction</span> <span class="LPAREN">(</span><span class="UIDENT">AST</span><span class="DOT">.</span><span class="LIDENT">embedding_syntax</span><span class="COMMA">,</span> <a href="#local_name_221"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_of_ast_204"><span class="LIDENT">of_ast</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_jane_syntax_attribute"><span class="LIDENT">make_jane_syntax_attribute</span></span> <span id="local_feature_222"><span class="LIDENT">feature</span></span> <span id="local_trailing_components_223"><span class="LIDENT">trailing_components</span></span> <span id="local_payload_224"><span class="LIDENT">payload</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">make_jane_syntax_attribute</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">Embedded_name</span><span class="DOT">.</span><span class="LIDENT">of_feature</span> <a href="#local_feature_222"><span class="LIDENT">feature</span></a> <a href="#local_trailing_components_223"><span class="LIDENT">trailing_components</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <a href="#local_payload_224"><span class="LIDENT">payload</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* See Note [Hiding internal details] *)</span><span class="EOL">
</span><span id="module-Expression"><span class="MODULE">module</span> <span class="UIDENT">Expression</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Expression0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Pattern"><span class="MODULE">module</span> <span class="UIDENT">Pattern</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Pattern0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Module_type"><span class="MODULE">module</span> <span class="UIDENT">Module_type</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Module_type0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Signature_item"><span class="MODULE">module</span> <span class="UIDENT">Signature_item</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Signature_item0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Structure_item"><span class="MODULE">module</span> <span class="UIDENT">Structure_item</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Structure_item0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Core_type"><span class="MODULE">module</span> <span class="UIDENT">Core_type</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Core_type0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Constructor_argument"><span class="MODULE">module</span> <span class="UIDENT">Constructor_argument</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Constructor_argument0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Extension_constructor"><span class="MODULE">module</span> <span class="UIDENT">Extension_constructor</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Extension_constructor0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Constructor_declaration"><span class="MODULE">module</span> <span class="UIDENT">Constructor_declaration</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Constructor_declaration0</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-Type_declaration"><span class="MODULE">module</span> <span class="UIDENT">Type_declaration</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_ast</span> <span class="LPAREN">(</span><span class="UIDENT">Type_declaration0</span><span class="RPAREN">)</span></span><span class="EOL">
</span></span></code></pre></body></html>
