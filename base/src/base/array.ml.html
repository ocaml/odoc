<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: array.ml (base.src.base)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Base</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; base &#x00BB; array.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>array.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">Base</a><ul><li>Library <code>base</code><ul><li><a href="../../base/Base/index.html">Base</a></li></ul></li><li>Library <code>base.base_internalhash_types</code><ul><li><a href="../../base.base_internalhash_types/Base_internalhash_types/index.html">Base_internalhash_types</a></li></ul></li><li>Library <code>base.caml</code><ul><li><a href="../../base.caml/Caml/index.html">Caml</a></li></ul></li><li>Library <code>base.md5</code><ul><li><a href="../../base.md5/Md5_lib/index.html">Md5_lib</a></li></ul></li><li>Library <code>base.shadow_stdlib</code><ul><li><a href="../../base.shadow_stdlib/Shadow_stdlib/index.html">Shadow_stdlib</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>base<ul><li><a href="applicative.ml.html">applicative.ml</a></li><li><a href="applicative_intf.ml.html">applicative_intf.ml</a></li><li><a href="#" class="current_unit">array.ml</a></li><li><a href="array0.ml.html">array0.ml</a></li><li><a href="array_permute.ml.html">array_permute.ml</a></li><li><a href="avltree.ml.html">avltree.ml</a></li><li><a href="backtrace.ml.html">backtrace.ml</a></li><li><a href="base.ml.html">base.ml</a></li><li><a href="base__.ml.html">base__.ml</a></li><li><a href="binary_search.ml.html">binary_search.ml</a></li><li><a href="binary_searchable.ml.html">binary_searchable.ml</a></li><li><a href="binary_searchable_intf.ml.html">binary_searchable_intf.ml</a></li><li><a href="blit.ml.html">blit.ml</a></li><li><a href="blit_intf.ml.html">blit_intf.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="bool0.ml.html">bool0.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="buffer_intf.ml.html">buffer_intf.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytes0.ml.html">bytes0.ml</a></li><li><a href="bytes_tr.ml.html">bytes_tr.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="char0.ml.html">char0.ml</a></li><li><a href="comparable.ml.html">comparable.ml</a></li><li><a href="comparable_intf.ml.html">comparable_intf.ml</a></li><li><a href="comparator.ml.html">comparator.ml</a></li><li><a href="comparisons.ml.html">comparisons.ml</a></li><li><a href="container.ml.html">container.ml</a></li><li><a href="container_intf.ml.html">container_intf.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="either0.ml.html">either0.ml</a></li><li><a href="either_intf.ml.html">either_intf.ml</a></li><li><a href="equal.ml.html">equal.ml</a></li><li><a href="error.ml.html">error.ml</a></li><li><a href="exn.ml.html">exn.ml</a></li><li><a href="field.ml.html">field.ml</a></li><li><a href="fieldslib.ml.html">fieldslib.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="float0.ml.html">float0.ml</a></li><li><a href="floatable.ml.html">floatable.ml</a></li><li><a href="fn.ml.html">fn.ml</a></li><li><a href="formatter.ml.html">formatter.ml</a></li><li><a href="globalize.ml.html">globalize.ml</a></li><li><a href="hash.ml.html">hash.ml</a></li><li><a href="hash_intf.ml.html">hash_intf.ml</a></li><li><a href="hash_set.ml.html">hash_set.ml</a></li><li><a href="hash_set_intf.ml.html">hash_set_intf.ml</a></li><li><a href="hashable.ml.html">hashable.ml</a></li><li><a href="hashable_intf.ml.html">hashable_intf.ml</a></li><li><a href="hasher.ml.html">hasher.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="hashtbl_intf.ml.html">hashtbl_intf.ml</a></li><li><a href="hex_lexer.ml.html">hex_lexer.ml</a></li><li><a href="identifiable.ml.html">identifiable.ml</a></li><li><a href="identifiable_intf.ml.html">identifiable_intf.ml</a></li><li><a href="import.ml.html">import.ml</a></li><li><a href="import0.ml.html">import0.ml</a></li><li><a href="indexed_container.ml.html">indexed_container.ml</a></li><li><a href="indexed_container_intf.ml.html">indexed_container_intf.ml</a></li><li><a href="info.ml.html">info.ml</a></li><li><a href="info_intf.ml.html">info_intf.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int0.ml.html">int0.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int63.ml.html">int63.ml</a></li><li><a href="int63_emul.ml.html">int63_emul.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="int_conversions.ml.html">int_conversions.ml</a></li><li><a href="int_intf.ml.html">int_intf.ml</a></li><li><a href="int_math.ml.html">int_math.ml</a></li><li><a href="intable.ml.html">intable.ml</a></li><li><a href="invariant.ml.html">invariant.ml</a></li><li><a href="invariant_intf.ml.html">invariant_intf.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="linked_queue.ml.html">linked_queue.ml</a></li><li><a href="linked_queue0.ml.html">linked_queue0.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="list0.ml.html">list0.ml</a></li><li><a href="list1.ml.html">list1.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="map_intf.ml.html">map_intf.ml</a></li><li><a href="maybe_bound.ml.html">maybe_bound.ml</a></li><li><a href="monad.ml.html">monad.ml</a></li><li><a href="monad_intf.ml.html">monad_intf.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="nothing.ml.html">nothing.ml</a></li><li><a href="obj_array.ml.html">obj_array.ml</a></li><li><a href="obj_local.ml.html">obj_local.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="option_array.ml.html">option_array.ml</a></li><li><a href="or_error.ml.html">or_error.ml</a></li><li><a href="ordered_collection_common.ml.html">ordered_collection_common.ml</a></li><li><a href="ordered_collection_common0.ml.html">ordered_collection_common0.ml</a></li><li><a href="ordering.ml.html">ordering.ml</a></li><li><a href="poly0.ml.html">poly0.ml</a></li><li><a href="popcount.ml.html">popcount.ml</a></li><li><a href="pow_overflow_bounds.ml.html">pow_overflow_bounds.ml</a></li><li><a href="ppx_compare_lib.ml.html">ppx_compare_lib.ml</a></li><li><a href="ppx_enumerate_lib.ml.html">ppx_enumerate_lib.ml</a></li><li><a href="ppx_hash_lib.ml.html">ppx_hash_lib.ml</a></li><li><a href="pretty_printer.ml.html">pretty_printer.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="queue_intf.ml.html">queue_intf.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="random_repr.ml.html">random_repr.ml</a></li><li><a href="ref.ml.html">ref.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="sequence.ml.html">sequence.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="set_intf.ml.html">set_intf.ml</a></li><li><a href="sexp.ml.html">sexp.ml</a></li><li><a href="sexp_with_comparable.ml.html">sexp_with_comparable.ml</a></li><li><a href="sexpable.ml.html">sexpable.ml</a></li><li><a href="sign.ml.html">sign.ml</a></li><li><a href="sign0.ml.html">sign0.ml</a></li><li><a href="sign_or_nan.ml.html">sign_or_nan.ml</a></li><li><a href="source_code_position.ml.html">source_code_position.ml</a></li><li><a href="source_code_position0.ml.html">source_code_position0.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stack_intf.ml.html">stack_intf.ml</a></li><li><a href="staged.ml.html">staged.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="string0.ml.html">string0.ml</a></li><li><a href="stringable.ml.html">stringable.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="sys0.ml.html">sys0.ml</a></li><li><a href="t.ml.html">t.ml</a></li><li><a href="type_equal.ml.html">type_equal.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="uchar0.ml.html">uchar0.ml</a></li><li><a href="uniform_array.ml.html">uniform_array.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="variant.ml.html">variant.ml</a></li><li><a href="variantslib.ml.html">variantslib.ml</a></li><li><a href="with_return.ml.html">with_return.ml</a></li><li><a href="word_size.ml.html">word_size.ml</a></li></ul></li><li>base.base_internalhash_types<ul><li><a href="../base.base_internalhash_types/base_internalhash_types.ml.html">base_internalhash_types.ml</a></li></ul></li><li>base.caml<ul><li><a href="../base.caml/caml.ml.html">caml.ml</a></li></ul></li><li>base.md5<ul><li><a href="../base.md5/md5_lib.ml.html">md5_lib.ml</a></li></ul></li><li>base.shadow_stdlib<ul><li><a href="../base.shadow_stdlib/shadow_stdlib.ml.html">shadow_stdlib.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
</code><code class="source_code"><span><span class="OPEN">open</span><span class="BANG">!</span> <a href="import.ml.html"><span class="UIDENT">Import</span></a><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="array0.ml.html"><span class="UIDENT">Array0</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="type-t"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">array</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">deriving_inline</span> <span class="LIDENT">compare</span><span class="COMMA">,</span> <span class="LIDENT">globalize</span><span class="COMMA">,</span> <span class="LIDENT">sexp</span><span class="COMMA">,</span> <span class="LIDENT">sexp_grammar</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-compare"><span class="LIDENT">compare</span></span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="DOT">.</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <a href="ppx_compare_lib.ml.html#module-Builtin.val-compare_array"><span class="LIDENT">compare_array</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-globalize"><span class="LIDENT">globalize</span></span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="DOT">.</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="globalize.ml.html#val-globalize_array"><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">a__005_</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="COLON">:</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">a__005_</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a__005_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">a__005_</span> <span class="LIDENT">t</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a__005_</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">globalize_array</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-t_of_sexp"><span class="LIDENT">t_of_sexp</span></span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="DOT">.</span> <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-array_of_sexp"><span class="LIDENT">array_of_sexp</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_t"><span class="LIDENT">sexp_of_t</span></span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="DOT">.</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-sexp_of_array"><span class="LIDENT">sexp_of_array</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-t_sexp_grammar"><span class="LIDENT">t_sexp_grammar</span></span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="DOT">.</span> <a href="../../../sexplib0/src/sexplib0/sexp_grammar.ml.html#type-t"><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_grammar</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp_grammar.ml.html#type-t"><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_grammar</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local__'a_sexp_grammar_1"><span class="LIDENT">_'a_sexp_grammar</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv_grammar.ml.html#val-array_sexp_grammar"><span class="LIDENT">array_sexp_grammar</span></a> <a href="#local__'a_sexp_grammar_1"><span class="LIDENT">_'a_sexp_grammar</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LBRACKETATATAT">[@@@</span><span class="END">end</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* This module implements a new in-place, constant heap sorting algorithm to replace the
   one used by the standard libraries.  Its only purpose is to be faster (hopefully
   strictly faster) than the base sort and stable_sort.

   At a high level the algorithm is:
   - pick two pivot points by:
   - pick 5 arbitrary elements from the array
   - sort them within the array
   - take the elements on either side of the middle element of the sort as the pivots
   - sort the array with:
   - all elements less than pivot1 to the left (range 1)
   - all elements &gt;= pivot1 and &lt;= pivot2 in the middle (range 2)
   - all elements &gt; pivot2 to the right (range 3)
   - if pivot1 and pivot2 are equal, then the middle range is sorted, so ignore it
   - recurse into range 1, 2 (if pivot1 and pivot2 are unequal), and 3
   - during recursion there are two inflection points:
   - if the size of the current range is small, use insertion sort to sort it
   - if the stack depth is large, sort the range with heap-sort to avoid n^2 worst-case
     behavior

   See the following for more information:
   - &quot;Dual-Pivot Quicksort&quot; by Vladimir Yaroslavskiy.
     Available at
     http://www.kriche.com.ar/root/programming/spaceTimeComplexity/DualPivotQuicksort.pdf
   - &quot;Quicksort is Optimal&quot; by Sedgewick and Bentley.
     Slides at http://www.cs.princeton.edu/~rs/talks/QuicksortIsOptimal.pdf
   - http://www.sorting-algorithms.com/quick-sort-3-way *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Sorter"><span class="MODULE">module</span> <span class="UIDENT">Sorter</span> <span class="LPAREN">(</span><span class="UIDENT">S</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span id="module-Sorter.argument-1-S.type-t"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Sorter.argument-1-S.val-get"><span class="VAL">val</span> <span class="LIDENT">get</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span></span><span class="EOL">
</span>    <span id="module-Sorter.argument-1-S.val-set"><span class="VAL">val</span> <span class="LIDENT">set</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>    <span id="module-Sorter.argument-1-S.val-length"><span class="VAL">val</span> <span class="LIDENT">length</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">S</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Sorter.val-swap"><span class="LIDENT">swap</span></span> <span id="local_arr_2"><span class="LIDENT">arr</span></span> <span id="local_i_3"><span class="LIDENT">i</span></span> <span id="local_j_4"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tmp_5"><span class="LIDENT">tmp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_arr_2"><span class="LIDENT">arr</span></a> <a href="#local_i_3"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">set</span> <a href="#local_arr_2"><span class="LIDENT">arr</span></a> <a href="#local_i_3"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_2"><span class="LIDENT">arr</span></a> <a href="#local_j_4"><span class="LIDENT">j</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">set</span> <a href="#local_arr_2"><span class="LIDENT">arr</span></a> <a href="#local_j_4"><span class="LIDENT">j</span></a> <a href="#local_tmp_5"><span class="LIDENT">tmp</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Sorter.module-type-Sort"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">Sort</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span id="module-Sorter.module-type-Sort.val-sort"><span class="VAL">val</span> <span class="LIDENT">sort</span><span class="EOL">
</span>      <span class="COLON">:</span>  <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compare</span><span class="COLON">:</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="RPAREN">)</span><span class="LBRACKETAT">[@</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">left</span><span class="COLON">:</span><span class="LIDENT">int</span> <span class="COMMENT">(* leftmost index of sub-array to sort *)</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">right</span><span class="COLON">:</span><span class="LIDENT">int</span> <span class="COMMENT">(* rightmost index of sub-array to sort *)</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* http://en.wikipedia.org/wiki/Insertion_sort *)</span><span class="EOL">
</span>  <span id="module-Sorter.module-Insertion_sort"><span class="MODULE">module</span> <span class="UIDENT">Insertion_sort</span> <span class="COLON">:</span> <span class="UIDENT">Sort</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="COMMENT">(* loop invariants:
       1.  the subarray arr[left .. i-1] is sorted
       2.  the subarray arr[i+1 .. pos] is sorted and contains only elements &gt; v
       3.  arr[i] may be thought of as containing v
    *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Sorter.module-Insertion_sort.val-insert_loop"><span class="LIDENT">insert_loop</span></span> <span id="local_arr_6"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_left_7"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_compare_8"><span class="LIDENT">compare</span></span> <span id="local_i_9"><span class="LIDENT">i</span></span> <span id="local_v_10"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_next_11"><span class="LIDENT">i_next</span></span> <span class="EQUAL">=</span> <a href="#local_i_9"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_i_next_11"><span class="LIDENT">i_next</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_left_7"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_compare_8"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_6"><span class="LIDENT">arr</span></a> <a href="#local_i_next_11"><span class="LIDENT">i_next</span></a><span class="RPAREN">)</span> <a href="#local_v_10"><span class="LIDENT">v</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">set</span> <a href="#local_arr_6"><span class="LIDENT">arr</span></a> <a href="#local_i_9"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_6"><span class="LIDENT">arr</span></a> <a href="#local_i_next_11"><span class="LIDENT">i_next</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">insert_loop</span> <a href="#local_arr_6"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_left_7"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_compare_8"><span class="LIDENT">compare</span></a> <a href="#local_i_next_11"><span class="LIDENT">i_next</span></a> <a href="#local_v_10"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_i_9"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Insertion_sort.val-sort"><span class="LIDENT">sort</span></span> <span id="local_arr_12"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_compare_13"><span class="LIDENT">compare</span></span> <span class="TILDE">~</span><span id="local_left_14"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_15"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* loop invariant:
         [arr] is sorted from [left] to [pos - 1], inclusive *)</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">pos</span> <span class="EQUAL">=</span> <a href="#local_left_14"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="TO">to</span> <a href="#local_right_15"><span class="LIDENT">right</span></a> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_v_16"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_arr_12"><span class="LIDENT">arr</span></a> <span class="LIDENT">pos</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_final_pos_17"><span class="LIDENT">final_pos</span></span> <span class="EQUAL">=</span> <span class="LIDENT">insert_loop</span> <a href="#local_arr_12"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_left_14"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_compare_13"><span class="LIDENT">compare</span></a> <span class="LIDENT">pos</span> <a href="#local_v_16"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">set</span> <a href="#local_arr_12"><span class="LIDENT">arr</span></a> <a href="#local_final_pos_17"><span class="LIDENT">final_pos</span></a> <a href="#local_v_16"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* http://en.wikipedia.org/wiki/Heapsort *)</span><span class="EOL">
</span>  <span id="module-Sorter.module-Heap_sort"><span class="MODULE">module</span> <span class="UIDENT">Heap_sort</span> <span class="COLON">:</span> <span class="UIDENT">Sort</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="COMMENT">(* loop invariant:
       root's children are both either roots of max-heaps or &gt; right *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Sorter.module-Heap_sort.val-heapify"><span class="LIDENT">heapify</span></span> <span id="local_arr_18"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_compare_19"><span class="LIDENT">compare</span></span> <span id="local_root_20"><span class="LIDENT">root</span></span> <span class="TILDE">~</span><span id="local_left_21"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_22"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_relative_root_23"><span class="LIDENT">relative_root</span></span> <span class="EQUAL">=</span> <a href="#local_root_20"><span class="LIDENT">root</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_left_21"><span class="LIDENT">left</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_left_child_24"><span class="LIDENT">left_child</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">2</span> <a href="import0.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_relative_root_23"><span class="LIDENT">relative_root</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_left_21"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_right_child_25"><span class="LIDENT">right_child</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">2</span> <a href="import0.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_relative_root_23"><span class="LIDENT">relative_root</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_left_21"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_largest_26"><span class="LIDENT">largest</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_left_child_24"><span class="LIDENT">left_child</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_right_22"><span class="LIDENT">right</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_compare_19"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_18"><span class="LIDENT">arr</span></a> <a href="#local_left_child_24"><span class="LIDENT">left_child</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_18"><span class="LIDENT">arr</span></a> <a href="#local_root_20"><span class="LIDENT">root</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <a href="#local_left_child_24"><span class="LIDENT">left_child</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_root_20"><span class="LIDENT">root</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_largest_27"><span class="LIDENT">largest</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_right_child_25"><span class="LIDENT">right_child</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_right_22"><span class="LIDENT">right</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_compare_19"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_18"><span class="LIDENT">arr</span></a> <a href="#local_right_child_25"><span class="LIDENT">right_child</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_18"><span class="LIDENT">arr</span></a> <a href="#local_largest_26"><span class="LIDENT">largest</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <a href="#local_right_child_25"><span class="LIDENT">right_child</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_largest_26"><span class="LIDENT">largest</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_largest_27"><span class="LIDENT">largest</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_root_20"><span class="LIDENT">root</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">swap</span> <a href="#local_arr_18"><span class="LIDENT">arr</span></a> <a href="#local_root_20"><span class="LIDENT">root</span></a> <a href="#local_largest_27"><span class="LIDENT">largest</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">heapify</span> <a href="#local_arr_18"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_19"><span class="LIDENT">compare</span></a> <a href="#local_largest_27"><span class="LIDENT">largest</span></a> <span class="TILDE">~</span><a href="#local_left_21"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_22"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Heap_sort.val-build_heap"><span class="LIDENT">build_heap</span></span> <span id="local_arr_28"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_compare_29"><span class="LIDENT">compare</span></span> <span class="TILDE">~</span><span id="local_left_30"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_31"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* Elements in the second half of the array are already heaps of size 1.  We move
         through the first half of the array from back to front examining the element at
         hand, and the left and right children, fixing the heap property as we go. *)</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_left_30"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_right_31"><span class="LIDENT">right</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">2</span> <span class="DOWNTO">downto</span> <a href="#local_left_30"><span class="LIDENT">left</span></a> <span class="DO">do</span><span class="EOL">
</span>        <span class="LIDENT">heapify</span> <a href="#local_arr_28"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_29"><span class="LIDENT">compare</span></a> <span class="LIDENT">i</span> <span class="TILDE">~</span><a href="#local_left_30"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_31"><span class="LIDENT">right</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Heap_sort.val-sort"><span class="LIDENT">sort</span></span> <span id="local_arr_32"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_compare_33"><span class="LIDENT">compare</span></span> <span class="TILDE">~</span><span id="local_left_34"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_35"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">build_heap</span> <a href="#local_arr_32"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_33"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_34"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_35"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="COMMENT">(* loop invariants:
         1.  the subarray arr[left ... i] is a max-heap H
         2.  the subarray arr[i+1 ... right] is sorted (call it S)
         3.  every element of H is less than every element of S *)</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <a href="#local_right_35"><span class="LIDENT">right</span></a> <span class="DOWNTO">downto</span> <a href="#local_left_34"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LIDENT">swap</span> <a href="#local_arr_32"><span class="LIDENT">arr</span></a> <a href="#local_left_34"><span class="LIDENT">left</span></a> <span class="LIDENT">i</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">heapify</span> <a href="#local_arr_32"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_33"><span class="LIDENT">compare</span></a> <a href="#local_left_34"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_left_34"><span class="LIDENT">left</span></a> <span class="LABEL">~right:</span><span class="LPAREN">(</span><span class="LIDENT">i</span> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* http://en.wikipedia.org/wiki/Introsort *)</span><span class="EOL">
</span>  <span id="module-Sorter.module-Intro_sort"><span class="MODULE">module</span> <span class="UIDENT">Intro_sort</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Sort</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Sorter.module-Intro_sort.val-five_element_sort"><span class="VAL">val</span> <span class="LIDENT">five_element_sort</span><span class="EOL">
</span>      <span class="COLON">:</span>  <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compare</span><span class="COLON">:</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="RPAREN">)</span><span class="LBRACKETAT">[@</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span class="END">end</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Intro_sort.val-five_element_sort"><span class="LIDENT">five_element_sort</span></span> <span id="local_arr_36"><span class="LIDENT">arr</span></span> <span class="LABEL">~compare:</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span id="local_compare_37"><span class="LIDENT">compare</span></span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span id="local_m1_38"><span class="LIDENT">m1</span></span> <span id="local_m2_39"><span class="LIDENT">m2</span></span> <span id="local_m3_40"><span class="LIDENT">m3</span></span> <span id="local_m4_41"><span class="LIDENT">m4</span></span> <span id="local_m5_42"><span class="LIDENT">m5</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></span> <span id="local_i_44"><span class="LIDENT">i</span></span> <span id="local_j_45"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_compare_37"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_36"><span class="LIDENT">arr</span></a> <a href="#local_i_44"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_36"><span class="LIDENT">arr</span></a> <a href="#local_j_45"><span class="LIDENT">j</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">swap</span> <a href="#local_arr_36"><span class="LIDENT">arr</span></a> <a href="#local_i_44"><span class="LIDENT">i</span></a> <a href="#local_j_45"><span class="LIDENT">j</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* Optimal 5-element sorting network:

         {v
            1--o-----o-----o--------------1
               |     |     |
            2--o-----|--o--|-----o--o-----2
                     |  |  |     |  |
            3--------o--o--|--o--|--o-----3
                           |  |  |
            4-----o--------o--o--|-----o--4
                  |              |     |
            5-----o--------------o-----o--5
          v} *)</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m1_38"><span class="LIDENT">m1</span></a> <a href="#local_m2_39"><span class="LIDENT">m2</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m4_41"><span class="LIDENT">m4</span></a> <a href="#local_m5_42"><span class="LIDENT">m5</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m1_38"><span class="LIDENT">m1</span></a> <a href="#local_m3_40"><span class="LIDENT">m3</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m2_39"><span class="LIDENT">m2</span></a> <a href="#local_m3_40"><span class="LIDENT">m3</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m1_38"><span class="LIDENT">m1</span></a> <a href="#local_m4_41"><span class="LIDENT">m4</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m3_40"><span class="LIDENT">m3</span></a> <a href="#local_m4_41"><span class="LIDENT">m4</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m2_39"><span class="LIDENT">m2</span></a> <a href="#local_m5_42"><span class="LIDENT">m5</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m2_39"><span class="LIDENT">m2</span></a> <a href="#local_m3_40"><span class="LIDENT">m3</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_compare_and_swap_43"><span class="LIDENT">compare_and_swap</span></a> <a href="#local_m4_41"><span class="LIDENT">m4</span></a> <a href="#local_m5_42"><span class="LIDENT">m5</span></a> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* choose pivots for the array by sorting 5 elements and examining the center three
       elements.  The goal is to choose two pivots that will either:
       - break the range up into 3 even partitions
         or
       - eliminate a commonly appearing element by sorting it into the center partition
         by itself
         To this end we look at the center 3 elements of the 5 and return pairs of equal
         elements or the widest range *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Intro_sort.val-choose_pivots"><span class="LIDENT">choose_pivots</span></span> <span id="local_arr_46"><span class="LIDENT">arr</span></span> <span class="LABEL">~compare:</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span id="local_compare_47"><span class="LIDENT">compare</span></span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_left_48"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_49"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_sixth_50"><span class="LIDENT">sixth</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_right_49"><span class="LIDENT">right</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_left_48"><span class="LIDENT">left</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">6</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m1_51"><span class="LIDENT">m1</span></span> <span class="EQUAL">=</span> <a href="#local_left_48"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_sixth_50"><span class="LIDENT">sixth</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m2_52"><span class="LIDENT">m2</span></span> <span class="EQUAL">=</span> <a href="#local_m1_51"><span class="LIDENT">m1</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_sixth_50"><span class="LIDENT">sixth</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m3_53"><span class="LIDENT">m3</span></span> <span class="EQUAL">=</span> <a href="#local_m2_52"><span class="LIDENT">m2</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_sixth_50"><span class="LIDENT">sixth</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m4_54"><span class="LIDENT">m4</span></span> <span class="EQUAL">=</span> <a href="#local_m3_53"><span class="LIDENT">m3</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_sixth_50"><span class="LIDENT">sixth</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m5_55"><span class="LIDENT">m5</span></span> <span class="EQUAL">=</span> <a href="#local_m4_54"><span class="LIDENT">m4</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_sixth_50"><span class="LIDENT">sixth</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">five_element_sort</span> <a href="#local_arr_46"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_47"><span class="LIDENT">compare</span></a> <a href="#local_m1_51"><span class="LIDENT">m1</span></a> <a href="#local_m2_52"><span class="LIDENT">m2</span></a> <a href="#local_m3_53"><span class="LIDENT">m3</span></a> <a href="#local_m4_54"><span class="LIDENT">m4</span></a> <a href="#local_m5_55"><span class="LIDENT">m5</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m2_val_56"><span class="LIDENT">m2_val</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_arr_46"><span class="LIDENT">arr</span></a> <a href="#local_m2_52"><span class="LIDENT">m2</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m3_val_57"><span class="LIDENT">m3_val</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_arr_46"><span class="LIDENT">arr</span></a> <a href="#local_m3_53"><span class="LIDENT">m3</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m4_val_58"><span class="LIDENT">m4_val</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_arr_46"><span class="LIDENT">arr</span></a> <a href="#local_m4_54"><span class="LIDENT">m4</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_compare_47"><span class="LIDENT">compare</span></a> <a href="#local_m2_val_56"><span class="LIDENT">m2_val</span></a> <a href="#local_m3_val_57"><span class="LIDENT">m3_val</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_m2_val_56"><span class="LIDENT">m2_val</span></a><span class="COMMA">,</span> <a href="#local_m3_val_57"><span class="LIDENT">m3_val</span></a><span class="COMMA">,</span> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_compare_47"><span class="LIDENT">compare</span></a> <a href="#local_m3_val_57"><span class="LIDENT">m3_val</span></a> <a href="#local_m4_val_58"><span class="LIDENT">m4_val</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_m3_val_57"><span class="LIDENT">m3_val</span></a><span class="COMMA">,</span> <a href="#local_m4_val_58"><span class="LIDENT">m4_val</span></a><span class="COMMA">,</span> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_m2_val_56"><span class="LIDENT">m2_val</span></a><span class="COMMA">,</span> <a href="#local_m4_val_58"><span class="LIDENT">m4_val</span></a><span class="COMMA">,</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Intro_sort.val-dual_pivot_partition"><span class="LIDENT">dual_pivot_partition</span></span> <span id="local_arr_59"><span class="LIDENT">arr</span></span> <span class="LABEL">~compare:</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span id="local_compare_60"><span class="LIDENT">compare</span></span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_left_61"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_62"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_438"><span id="local_pivot1_63"><span class="LIDENT">pivot1</span></span><span class="COMMA">,</span> <span id="local_pivot2_64"><span class="LIDENT">pivot2</span></span><span class="COMMA">,</span> <span id="local_pivots_equal_65"><span class="LIDENT">pivots_equal</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">choose_pivots</span> <a href="#local_arr_59"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_60"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_61"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_62"><span class="LIDENT">right</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* loop invariants:
         1.  left &lt;= l &lt; r &lt;= right
         2.  l &lt;= p &lt;= r
         3.  l &lt;= x &lt; p     implies arr[x] &gt;= pivot1
         and arr[x] &lt;= pivot2
         4.  left &lt;= x &lt; l  implies arr[x] &lt; pivot1
         5.  r &lt; x &lt;= right implies arr[x] &gt; pivot2 *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_66"><span class="LIDENT">loop</span></span> <span id="local_l_67"><span class="LIDENT">l</span></span> <span id="local_p_68"><span class="LIDENT">p</span></span> <span id="local_r_69"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_pv_70"><span class="LIDENT">pv</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_arr_59"><span class="LIDENT">arr</span></a> <a href="#local_p_68"><span class="LIDENT">p</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_compare_60"><span class="LIDENT">compare</span></a> <a href="#local_pv_70"><span class="LIDENT">pv</span></a> <a href="#local_pivot1_63"><span class="LIDENT">pivot1</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LIDENT">swap</span> <a href="#local_arr_59"><span class="LIDENT">arr</span></a> <a href="#local_p_68"><span class="LIDENT">p</span></a> <a href="#local_l_67"><span class="LIDENT">l</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_cont_74"><span class="LIDENT">cont</span></a> <span class="LPAREN">(</span><a href="#local_l_67"><span class="LIDENT">l</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_p_68"><span class="LIDENT">p</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_r_69"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_compare_60"><span class="LIDENT">compare</span></a> <a href="#local_pv_70"><span class="LIDENT">pv</span></a> <a href="#local_pivot2_64"><span class="LIDENT">pivot2</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="COMMENT">(* loop invariants:  same as those of the outer loop *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span class="REC">rec</span> <span id="local_scan_backwards_71"><span class="LIDENT">scan_backwards</span></span> <span id="local_r_72"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_r_72"><span class="LIDENT">r</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_p_68"><span class="LIDENT">p</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_compare_60"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">get</span> <a href="#local_arr_59"><span class="LIDENT">arr</span></a> <a href="#local_r_72"><span class="LIDENT">r</span></a><span class="RPAREN">)</span> <a href="#local_pivot2_64"><span class="LIDENT">pivot2</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_scan_backwards_71"><span class="LIDENT">scan_backwards</span></a> <span class="LPAREN">(</span><a href="#local_r_72"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_r_72"><span class="LIDENT">r</span></a><span class="EOL">
</span>          <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_r_73"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="#local_scan_backwards_71"><span class="LIDENT">scan_backwards</span></a> <a href="#local_r_69"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">swap</span> <a href="#local_arr_59"><span class="LIDENT">arr</span></a> <a href="#local_r_73"><span class="LIDENT">r</span></a> <a href="#local_p_68"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_cont_74"><span class="LIDENT">cont</span></a> <a href="#local_l_67"><span class="LIDENT">l</span></a> <a href="#local_p_68"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_r_73"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_cont_74"><span class="LIDENT">cont</span></a> <a href="#local_l_67"><span class="LIDENT">l</span></a> <span class="LPAREN">(</span><a href="#local_p_68"><span class="LIDENT">p</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_r_69"><span class="LIDENT">r</span></a><span class="EOL">
</span>      <span class="AND">and</span> <span id="local_cont_74"><span class="LIDENT">cont</span></span> <span id="local_l_75"><span class="LIDENT">l</span></span> <span id="local_p_76"><span class="LIDENT">p</span></span> <span id="local_r_77"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_p_76"><span class="LIDENT">p</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_r_77"><span class="LIDENT">r</span></a> <span class="THEN">then</span> <a href="#local_l_75"><span class="LIDENT">l</span></a><span class="COMMA">,</span> <a href="#local_r_77"><span class="LIDENT">r</span></a> <span class="ELSE">else</span> <a href="#local_loop_66"><span class="LIDENT">loop</span></a> <a href="#local_l_75"><span class="LIDENT">l</span></a> <a href="#local_p_76"><span class="LIDENT">p</span></a> <a href="#local_r_77"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_440"><span id="local_l_78"><span class="LIDENT">l</span></span><span class="COMMA">,</span> <span id="local_r_79"><span class="LIDENT">r</span></span></span> <span class="EQUAL">=</span> <a href="#local_cont_74"><span class="LIDENT">cont</span></a> <a href="#local_left_61"><span class="LIDENT">left</span></a> <a href="#local_left_61"><span class="LIDENT">left</span></a> <a href="#local_right_62"><span class="LIDENT">right</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_l_78"><span class="LIDENT">l</span></a><span class="COMMA">,</span> <a href="#local_r_79"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#local_pivots_equal_65"><span class="LIDENT">pivots_equal</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Sorter.module-Intro_sort.val-intro_sort"><span class="LIDENT">intro_sort</span></span> <span id="local_arr_80"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_max_depth_81"><span class="LIDENT">max_depth</span></span> <span class="TILDE">~</span><span id="local_compare_82"><span class="LIDENT">compare</span></span> <span class="TILDE">~</span><span id="local_left_83"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_84"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len_85"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_right_84"><span class="LIDENT">right</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_left_83"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* This takes care of some edge cases, such as left &gt; right or very short arrays,
         since Insertion_sort.sort handles these cases properly.  Thus we don't need to
         make sure that left and right are valid in recursive calls. *)</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_len_85"><span class="LIDENT">len</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">32</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="UIDENT">Insertion_sort</span><span class="DOT">.</span><span class="LIDENT">sort</span> <a href="#local_arr_80"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_82"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_83"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_84"><span class="LIDENT">right</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_max_depth_81"><span class="LIDENT">max_depth</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="UIDENT">Heap_sort</span><span class="DOT">.</span><span class="LIDENT">sort</span> <a href="#local_arr_80"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_82"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_83"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_84"><span class="LIDENT">right</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_max_depth_86"><span class="LIDENT">max_depth</span></span> <span class="EQUAL">=</span> <a href="#local_max_depth_81"><span class="LIDENT">max_depth</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_437"><span id="local_l_87"><span class="LIDENT">l</span></span><span class="COMMA">,</span> <span id="local_r_88"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_middle_sorted_89"><span class="LIDENT">middle_sorted</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">dual_pivot_partition</span> <a href="#local_arr_80"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_82"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_83"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_84"><span class="LIDENT">right</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">intro_sort</span> <a href="#local_arr_80"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_max_depth_86"><span class="LIDENT">max_depth</span></a> <span class="TILDE">~</span><a href="#local_compare_82"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_83"><span class="LIDENT">left</span></a> <span class="LABEL">~right:</span><span class="LPAREN">(</span><a href="#local_l_87"><span class="LIDENT">l</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_middle_sorted_89"><span class="LIDENT">middle_sorted</span></a> <span class="THEN">then</span> <span class="LIDENT">intro_sort</span> <a href="#local_arr_80"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_max_depth_86"><span class="LIDENT">max_depth</span></a> <span class="TILDE">~</span><a href="#local_compare_82"><span class="LIDENT">compare</span></a> <span class="LABEL">~left:</span><a href="#local_l_87"><span class="LIDENT">l</span></a> <span class="LABEL">~right:</span><a href="#local_r_88"><span class="LIDENT">r</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">intro_sort</span> <a href="#local_arr_80"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_max_depth_86"><span class="LIDENT">max_depth</span></a> <span class="TILDE">~</span><a href="#local_compare_82"><span class="LIDENT">compare</span></a> <span class="LABEL">~left:</span><span class="LPAREN">(</span><a href="#local_r_88"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_right_84"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Sorter.module-Intro_sort.val-sort"><span class="LIDENT">sort</span></span> <span id="local_arr_90"><span class="LIDENT">arr</span></span> <span class="TILDE">~</span><span id="local_compare_91"><span class="LIDENT">compare</span></span> <span class="TILDE">~</span><span id="local_left_92"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_93"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_heap_sort_switch_depth_94"><span class="LIDENT">heap_sort_switch_depth</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="COMMENT">(* We bail out to heap sort at a recursion depth of 32. GNU introsort uses 2lg(n).
           The expected recursion depth for perfect 3-way splits is log_3(n).

           Using 32 means a balanced 3-way split would work up to 3^32 elements (roughly
           2^50 or 10^15). GNU reaches a depth of 32 at 65536 elements.

           For small arrays, this makes us less likely to bail out to heap sort, but the
           32*N cost before we do is not that much.

           For large arrays, this means we are more likely to bail out to heap sort at
           some point if we get some bad splits or if the array is huge. But that's only a
           constant factor cost in the final stages of recursion.

           All in all, this seems to be a small tradeoff and avoids paying a cost to
           compute a logarithm at the start. *)</span><span class="EOL">
</span>        <span class="INT">32</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">intro_sort</span> <a href="#local_arr_90"><span class="LIDENT">arr</span></a> <span class="LABEL">~max_depth:</span><a href="#local_heap_sort_switch_depth_94"><span class="LIDENT">heap_sort_switch_depth</span></a> <span class="TILDE">~</span><a href="#local_compare_91"><span class="LIDENT">compare</span></a> <span class="TILDE">~</span><a href="#local_left_92"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_right_93"><span class="LIDENT">right</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Sorter.val-sort"><span class="LIDENT">sort</span></span> <span class="QUESTION">?</span><span id="local_pos_95"><span class="LIDENT">pos</span></span> <span class="QUESTION">?</span><span id="local_len_96"><span class="LIDENT">len</span></span> <span id="local_arr_97"><span class="LIDENT">arr</span></span> <span class="LABEL">~compare:</span><span class="LPAREN">(</span><span class="LPAREN">(</span><span id="local_compare_98"><span class="LIDENT">compare</span></span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_436"><span id="local_pos_99"><span class="LIDENT">pos</span></span><span class="COMMA">,</span> <span id="local_len_100"><span class="LIDENT">len</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="ordered_collection_common0.ml.html#val-get_pos_len_exn"><span class="UIDENT">Ordered_collection_common</span><span class="DOT">.</span><span class="LIDENT">get_pos_len_exn</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><a href="#local_pos_95"><span class="LIDENT">pos</span></a> <span class="QUESTION">?</span><a href="#local_len_96"><span class="LIDENT">len</span></a> <span class="LABEL">~total_length:</span><span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_arr_97"><span class="LIDENT">arr</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Intro_sort</span><span class="DOT">.</span><span class="LIDENT">sort</span> <a href="#local_arr_97"><span class="LIDENT">arr</span></a> <span class="TILDE">~</span><a href="#local_compare_98"><span class="LIDENT">compare</span></a> <span class="LABEL">~left:</span><a href="#local_pos_99"><span class="LIDENT">pos</span></a> <span class="LABEL">~right:</span><span class="LPAREN">(</span><a href="#local_pos_99"><span class="LIDENT">pos</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_100"><span class="LIDENT">len</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span><span class="EOL">
</span><span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Sort"><span class="MODULE">module</span> <span class="UIDENT">Sort</span> <span class="EQUAL">=</span> <span class="UIDENT">Sorter</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="def_442"><span class="TYPE">type</span> <span class="NONREC">nonrec</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_101"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_set_102"><span class="LIDENT">set</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_set</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_103"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sort"><span class="LIDENT">sort</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Sort</span><span class="DOT">.</span><span class="LIDENT">sort</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_array"><span class="LIDENT">of_array</span></span> <span id="local_t_104"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_104"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_array"><span class="LIDENT">to_array</span></span> <span id="local_t_105"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_105"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_empty"><span class="LIDENT">is_empty</span></span> <span id="local_t_106"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_106"><span class="LIDENT">t</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_sorted"><span class="LIDENT">is_sorted</span></span> <span id="local_t_107"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_108"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_109"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_107"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_110"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_109"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_110"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elt_i_111"><span class="LIDENT">elt_i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_107"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_109"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elt_i_minus_1_112"><span class="LIDENT">elt_i_minus_1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_107"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_109"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_compare_108"><span class="LIDENT">compare</span></a> <a href="#local_elt_i_minus_1_112"><span class="LIDENT">elt_i_minus_1</span></a> <a href="#local_elt_i_111"><span class="LIDENT">elt_i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_result_110"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_109"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_110"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_sorted_strictly"><span class="LIDENT">is_sorted_strictly</span></span> <span id="local_t_113"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_114"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_115"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_113"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_116"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_115"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_116"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elt_i_117"><span class="LIDENT">elt_i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_113"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_115"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elt_i_minus_1_118"><span class="LIDENT">elt_i_minus_1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_113"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_115"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_compare_114"><span class="LIDENT">compare</span></a> <a href="#local_elt_i_minus_1_118"><span class="LIDENT">elt_i_minus_1</span></a> <a href="#local_elt_i_117"><span class="LIDENT">elt_i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_result_116"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_115"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_116"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-merge"><span class="LIDENT">merge</span></span> <span id="local_a1_119"><span class="LIDENT">a1</span></span> <span id="local_a2_120"><span class="LIDENT">a2</span></span> <span class="TILDE">~</span><span id="local_compare_121"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l1_122"><span class="LIDENT">l1</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l2_123"><span class="LIDENT">l2</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_l1_122"><span class="LIDENT">l1</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">copy</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_l2_123"><span class="LIDENT">l2</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">copy</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_compare_121"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <span class="LPAREN">(</span><a href="#local_l1_122"><span class="LIDENT">l1</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">append</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <a href="#local_a2_120"><span class="LIDENT">a2</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_compare_121"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a> <span class="LPAREN">(</span><a href="#local_l2_123"><span class="LIDENT">l2</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">append</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a> <a href="#local_a1_119"><span class="LIDENT">a1</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_124"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_l1_122"><span class="LIDENT">l1</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l2_123"><span class="LIDENT">l2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_merged_125"><span class="LIDENT">merged</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="TILDE">~</span><a href="#local_len_124"><span class="LIDENT">len</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a1_index_126"><span class="LIDENT">a1_index</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a2_index_127"><span class="LIDENT">a2_index</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_124"><span class="LIDENT">len</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_use_a1_128"><span class="LIDENT">use_a1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_l1_122"><span class="LIDENT">l1</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a1_index_126"><span class="LIDENT">a1_index</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_l2_123"><span class="LIDENT">l2</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a2_index_127"><span class="LIDENT">a2_index</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_compare_121"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a1_index_126"><span class="LIDENT">a1_index</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a2_index_127"><span class="LIDENT">a2_index</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_use_a1_128"><span class="LIDENT">use_a1</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set</span> <a href="#local_merged_125"><span class="LIDENT">merged</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a1_119"><span class="LIDENT">a1</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a1_index_126"><span class="LIDENT">a1_index</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_a1_index_126"><span class="LIDENT">a1_index</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a1_index_126"><span class="LIDENT">a1_index</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set</span> <a href="#local_merged_125"><span class="LIDENT">merged</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a2_120"><span class="LIDENT">a2</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a2_index_127"><span class="LIDENT">a2_index</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_a2_index_127"><span class="LIDENT">a2_index</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_a2_index_127"><span class="LIDENT">a2_index</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_merged_125"><span class="LIDENT">merged</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-copy_matrix"><span class="LIDENT">copy_matrix</span></span> <span class="EQUAL">=</span> <span class="LIDENT">map</span> <span class="LABEL">~f:</span><span class="LIDENT">copy</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-folding_map"><span class="LIDENT">folding_map</span></span> <span id="local_t_129"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_130"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_131"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_acc_132"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_init_130"><span class="LIDENT">init</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">map</span> <a href="#local_t_129"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_133"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_439"><span id="local_new_acc_134"><span class="LIDENT">new_acc</span></span><span class="COMMA">,</span> <span id="local_y_135"><span class="LIDENT">y</span></span></span> <span class="EQUAL">=</span> <a href="#local_f_131"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_132"><span class="LIDENT">acc</span></a> <a href="#local_x_133"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_acc_132"><span class="LIDENT">acc</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_new_acc_134"><span class="LIDENT">new_acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_y_135"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold_map"><span class="LIDENT">fold_map</span></span> <span id="local_t_136"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_137"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_138"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_acc_139"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_init_137"><span class="LIDENT">init</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_140"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">map</span> <a href="#local_t_136"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_141"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_435"><span id="local_new_acc_142"><span class="LIDENT">new_acc</span></span><span class="COMMA">,</span> <span id="local_y_143"><span class="LIDENT">y</span></span></span> <span class="EQUAL">=</span> <a href="#local_f_138"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_139"><span class="LIDENT">acc</span></a> <a href="#local_x_141"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_acc_139"><span class="LIDENT">acc</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_new_acc_142"><span class="LIDENT">new_acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_y_143"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_139"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_result_140"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold_result"><span class="LIDENT">fold_result</span></span> <span id="local_t_144"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_145"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_146"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="container.ml.html#val-fold_result"><span class="UIDENT">Container</span><span class="DOT">.</span><span class="LIDENT">fold_result</span></a> <span class="TILDE">~</span><span class="LIDENT">fold</span> <span class="TILDE">~</span><a href="#local_init_145"><span class="LIDENT">init</span></a> <span class="TILDE">~</span><a href="#local_f_146"><span class="LIDENT">f</span></a> <a href="#local_t_144"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold_until"><span class="LIDENT">fold_until</span></span> <span id="local_t_147"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_148"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_149"><span class="LIDENT">f</span></span> <span class="TILDE">~</span><span id="local_finish_150"><span class="LIDENT">finish</span></span> <span class="EQUAL">=</span> <a href="container.ml.html#val-fold_until"><span class="UIDENT">Container</span><span class="DOT">.</span><span class="LIDENT">fold_until</span></a> <span class="TILDE">~</span><span class="LIDENT">fold</span> <span class="TILDE">~</span><a href="#local_init_148"><span class="LIDENT">init</span></a> <span class="TILDE">~</span><a href="#local_f_149"><span class="LIDENT">f</span></a> <a href="#local_t_147"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_finish_150"><span class="LIDENT">finish</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-count"><span class="LIDENT">count</span></span> <span id="local_t_151"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_152"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="container.ml.html#val-count"><span class="UIDENT">Container</span><span class="DOT">.</span><span class="LIDENT">count</span></a> <span class="TILDE">~</span><span class="LIDENT">fold</span> <a href="#local_t_151"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_f_152"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sum"><span class="LIDENT">sum</span></span> <span id="local_m_153"><span class="LIDENT">m</span></span> <span id="local_t_154"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_155"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="container.ml.html#val-sum"><span class="UIDENT">Container</span><span class="DOT">.</span><span class="LIDENT">sum</span></a> <span class="TILDE">~</span><span class="LIDENT">fold</span> <a href="#local_m_153"><span class="LIDENT">m</span></a> <a href="#local_t_154"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_f_155"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-min_elt"><span class="LIDENT">min_elt</span></span> <span id="local_t_156"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_157"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span> <a href="container.ml.html#val-min_elt"><span class="UIDENT">Container</span><span class="DOT">.</span><span class="LIDENT">min_elt</span></a> <span class="TILDE">~</span><span class="LIDENT">fold</span> <a href="#local_t_156"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_compare_157"><span class="LIDENT">compare</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-max_elt"><span class="LIDENT">max_elt</span></span> <span id="local_t_158"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_159"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span> <a href="container.ml.html#val-max_elt"><span class="UIDENT">Container</span><span class="DOT">.</span><span class="LIDENT">max_elt</span></a> <span class="TILDE">~</span><span class="LIDENT">fold</span> <a href="#local_t_158"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_compare_159"><span class="LIDENT">compare</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-foldi"><span class="LIDENT">foldi</span></span> <span id="local_t_160"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_161"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_162"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_acc_163"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_init_161"><span class="LIDENT">init</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_t_160"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="#local_acc_163"><span class="LIDENT">acc</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_f_162"><span class="LIDENT">f</span></a> <span class="LIDENT">i</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_163"><span class="LIDENT">acc</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_160"><span class="LIDENT">t</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_163"><span class="LIDENT">acc</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-folding_mapi"><span class="LIDENT">folding_mapi</span></span> <span id="local_t_164"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_165"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_166"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_acc_167"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_init_165"><span class="LIDENT">init</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">mapi</span> <a href="#local_t_164"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_168"><span class="LIDENT">i</span></span> <span id="local_x_169"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_441"><span id="local_new_acc_170"><span class="LIDENT">new_acc</span></span><span class="COMMA">,</span> <span id="local_y_171"><span class="LIDENT">y</span></span></span> <span class="EQUAL">=</span> <a href="#local_f_166"><span class="LIDENT">f</span></a> <a href="#local_i_168"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_167"><span class="LIDENT">acc</span></a> <a href="#local_x_169"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_acc_167"><span class="LIDENT">acc</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_new_acc_170"><span class="LIDENT">new_acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_y_171"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold_mapi"><span class="LIDENT">fold_mapi</span></span> <span id="local_t_172"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_173"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_174"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_acc_175"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_init_173"><span class="LIDENT">init</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_176"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">mapi</span> <a href="#local_t_172"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_177"><span class="LIDENT">i</span></span> <span id="local_x_178"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_434"><span id="local_new_acc_179"><span class="LIDENT">new_acc</span></span><span class="COMMA">,</span> <span id="local_y_180"><span class="LIDENT">y</span></span></span> <span class="EQUAL">=</span> <a href="#local_f_174"><span class="LIDENT">f</span></a> <a href="#local_i_177"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_175"><span class="LIDENT">acc</span></a> <a href="#local_x_178"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_acc_175"><span class="LIDENT">acc</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_new_acc_179"><span class="LIDENT">new_acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_y_180"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_acc_175"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_result_176"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-counti"><span class="LIDENT">counti</span></span> <span id="local_t_181"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_182"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">foldi</span> <a href="#local_t_181"><span class="LIDENT">t</span></a> <span class="LABEL">~init:</span><span class="INT">0</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_idx_183"><span class="LIDENT">idx</span></span> <span id="local_count_184"><span class="LIDENT">count</span></span> <span id="local_a_185"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_f_182"><span class="LIDENT">f</span></a> <a href="#local_idx_183"><span class="LIDENT">idx</span></a> <a href="#local_a_185"><span class="LIDENT">a</span></a> <span class="THEN">then</span> <a href="#local_count_184"><span class="LIDENT">count</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="ELSE">else</span> <a href="#local_count_184"><span class="LIDENT">count</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-concat_map"><span class="LIDENT">concat_map</span></span> <span id="local_t_186"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_187"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">concat</span> <span class="LPAREN">(</span><span class="LIDENT">to_list</span> <span class="LPAREN">(</span><span class="LIDENT">map</span> <span class="TILDE">~</span><a href="#local_f_187"><span class="LIDENT">f</span></a> <a href="#local_t_186"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-concat_mapi"><span class="LIDENT">concat_mapi</span></span> <span id="local_t_188"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_189"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">concat</span> <span class="LPAREN">(</span><span class="LIDENT">to_list</span> <span class="LPAREN">(</span><span class="LIDENT">mapi</span> <span class="TILDE">~</span><a href="#local_f_189"><span class="LIDENT">f</span></a> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rev_inplace"><span class="LIDENT">rev_inplace</span></span> <span id="local_t_190"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_191"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_j_192"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_190"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_191"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_192"><span class="LIDENT">j</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="LIDENT">swap</span> <a href="#local_t_190"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_191"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_192"><span class="LIDENT">j</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_191"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_j_192"><span class="LIDENT">j</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rev"><span class="LIDENT">rev</span></span> <span id="local_t_193"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t_194"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">copy</span> <a href="#local_t_193"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">rev_inplace</span> <a href="#local_t_194"><span class="LIDENT">t</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_t_194"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_list_rev"><span class="LIDENT">of_list_rev</span></span> <span id="local_l_195"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_l_195"><span class="LIDENT">l</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_a_196"><span class="LIDENT">a</span></span> <span class="COLONCOLON">::</span> <span id="local_l_197"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_198"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="list0.ml.html#val-length"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_l_197"><span class="LIDENT">l</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t_199"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="TILDE">~</span><a href="#local_len_198"><span class="LIDENT">len</span></a> <a href="#local_a_196"><span class="LIDENT">a</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_200"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_l_197"><span class="LIDENT">l</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* We start at [len - 2] because we already put [a] at [t.(len - 1)]. *)</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <a href="#local_len_198"><span class="LIDENT">len</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span> <span class="DOWNTO">downto</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_200"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_a_201"><span class="LIDENT">a</span></span> <span class="COLONCOLON">::</span> <span id="local_l_202"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_t_199"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a_201"><span class="LIDENT">a</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_r_200"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_l_202"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_t_199"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* [of_list_map] and [of_list_rev_map] are based on functions from the OCaml
   distribution. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_list_map"><span class="LIDENT">of_list_map</span></span> <span id="local_xs_203"><span class="LIDENT">xs</span></span> <span class="TILDE">~</span><span id="local_f_204"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_xs_203"><span class="LIDENT">xs</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hd_205"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span id="local_tl_206"><span class="LIDENT">tl</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a_207"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LABEL">~len:</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="list0.ml.html#val-length"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_tl_206"><span class="LIDENT">tl</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_f_204"><span class="LIDENT">f</span></a> <a href="#local_hd_205"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_fill_208"><span class="LIDENT">fill</span></span> <span id="local_i_209"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_a_207"><span class="LIDENT">a</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_hd_210"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span id="local_tl_211"><span class="LIDENT">tl</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set</span> <a href="#local_a_207"><span class="LIDENT">a</span></a> <a href="#local_i_209"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_f_204"><span class="LIDENT">f</span></a> <a href="#local_hd_210"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_fill_208"><span class="LIDENT">fill</span></a> <span class="LPAREN">(</span><a href="#local_i_209"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_tl_211"><span class="LIDENT">tl</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_fill_208"><span class="LIDENT">fill</span></a> <span class="INT">1</span> <a href="#local_tl_206"><span class="LIDENT">tl</span></a> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_list_mapi"><span class="LIDENT">of_list_mapi</span></span> <span id="local_xs_212"><span class="LIDENT">xs</span></span> <span class="TILDE">~</span><span id="local_f_213"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_xs_212"><span class="LIDENT">xs</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hd_214"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span id="local_tl_215"><span class="LIDENT">tl</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a_216"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LABEL">~len:</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="list0.ml.html#val-length"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_tl_215"><span class="LIDENT">tl</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_f_213"><span class="LIDENT">f</span></a> <span class="INT">0</span> <a href="#local_hd_214"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_fill_217"><span class="LIDENT">fill</span></span> <span id="local_a_218"><span class="LIDENT">a</span></span> <span id="local_i_219"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_a_218"><span class="LIDENT">a</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_hd_220"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span id="local_tl_221"><span class="LIDENT">tl</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set</span> <a href="#local_a_218"><span class="LIDENT">a</span></a> <a href="#local_i_219"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_f_213"><span class="LIDENT">f</span></a> <a href="#local_i_219"><span class="LIDENT">i</span></a> <a href="#local_hd_220"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_fill_217"><span class="LIDENT">fill</span></a> <a href="#local_a_218"><span class="LIDENT">a</span></a> <span class="LPAREN">(</span><a href="#local_i_219"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_tl_221"><span class="LIDENT">tl</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_fill_217"><span class="LIDENT">fill</span></a> <a href="#local_a_216"><span class="LIDENT">a</span></a> <span class="INT">1</span> <a href="#local_tl_215"><span class="LIDENT">tl</span></a> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_list_rev_map"><span class="LIDENT">of_list_rev_map</span></span> <span id="local_xs_222"><span class="LIDENT">xs</span></span> <span class="TILDE">~</span><span id="local_f_223"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t_224"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_list_map</span> <a href="#local_xs_222"><span class="LIDENT">xs</span></a> <span class="TILDE">~</span><a href="#local_f_223"><span class="LIDENT">f</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">rev_inplace</span> <a href="#local_t_224"><span class="LIDENT">t</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_t_224"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_list_rev_mapi"><span class="LIDENT">of_list_rev_mapi</span></span> <span id="local_xs_225"><span class="LIDENT">xs</span></span> <span class="TILDE">~</span><span id="local_f_226"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t_227"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_list_mapi</span> <a href="#local_xs_225"><span class="LIDENT">xs</span></a> <span class="TILDE">~</span><a href="#local_f_226"><span class="LIDENT">f</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">rev_inplace</span> <a href="#local_t_227"><span class="LIDENT">t</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_t_227"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-filter_mapi"><span class="LIDENT">filter_mapi</span></span> <span id="local_t_228"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_229"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_230"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_k_231"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_t_228"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_f_229"><span class="LIDENT">f</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_228"><span class="LIDENT">t</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_a_232"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_231"><span class="LIDENT">k</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_r_230"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">create</span> <span class="LABEL">~len:</span><span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_228"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <a href="#local_a_232"><span class="LIDENT">a</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_230"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_231"><span class="LIDENT">k</span></a> <a href="#local_a_232"><span class="LIDENT">a</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_k_231"><span class="LIDENT">k</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_231"><span class="LIDENT">k</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">length</span> <a href="#local_t_228"><span class="LIDENT">t</span></a> <span class="THEN">then</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_230"><span class="LIDENT">r</span></a> <span class="ELSE">else</span> <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_231"><span class="LIDENT">k</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">sub</span> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="LABEL">~len:</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_231"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_230"><span class="LIDENT">r</span></a> <span class="ELSE">else</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-filter_map"><span class="LIDENT">filter_map</span></span> <span id="local_t_233"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_234"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">filter_mapi</span> <a href="#local_t_233"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local__i_235"><span class="LIDENT">_i</span></span> <span id="local_a_236"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_234"><span class="LIDENT">f</span></a> <a href="#local_a_236"><span class="LIDENT">a</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-filter_opt"><span class="LIDENT">filter_opt</span></span> <span id="local_t_237"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">filter_map</span> <a href="#local_t_237"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><a href="fn.ml.html#val-id"><span class="UIDENT">Fn</span><span class="DOT">.</span><span class="LIDENT">id</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-raise_length_mismatch"><span class="LIDENT">raise_length_mismatch</span></span> <span id="local_name_238"><span class="LIDENT">name</span></span> <span id="local_n1_239"><span class="LIDENT">n1</span></span> <span id="local_n2_240"><span class="LIDENT">n2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">invalid_argf</span> <span class="STRING">&quot;length mismatch in %s: %d &lt;&gt; %d&quot;</span> <a href="#local_name_238"><span class="LIDENT">name</span></a> <a href="#local_n1_239"><span class="LIDENT">n1</span></a> <a href="#local_n2_240"><span class="LIDENT">n2</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LBRACKETATAT">[@@</span><span class="LIDENT">cold</span><span class="RBRACKET">]</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span> <span class="LIDENT">never</span><span class="RBRACKET">]</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">local</span> <span class="LIDENT">never</span><span class="RBRACKET">]</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">specialise</span> <span class="LIDENT">never</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-check_length2_exn"><span class="LIDENT">check_length2_exn</span></span> <span id="local_name_241"><span class="LIDENT">name</span></span> <span id="local_t1_242"><span class="LIDENT">t1</span></span> <span id="local_t2_243"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n1_244"><span class="LIDENT">n1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t1_242"><span class="LIDENT">t1</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n2_245"><span class="LIDENT">n2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t2_243"><span class="LIDENT">t2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n1_244"><span class="LIDENT">n1</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_n2_245"><span class="LIDENT">n2</span></a> <span class="THEN">then</span> <span class="LIDENT">raise_length_mismatch</span> <a href="#local_name_241"><span class="LIDENT">name</span></a> <a href="#local_n1_244"><span class="LIDENT">n1</span></a> <a href="#local_n2_245"><span class="LIDENT">n2</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iter2_exn"><span class="LIDENT">iter2_exn</span></span> <span id="local_t1_246"><span class="LIDENT">t1</span></span> <span id="local_t2_247"><span class="LIDENT">t2</span></span> <span class="TILDE">~</span><span id="local_f_248"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">check_length2_exn</span> <span class="STRING">&quot;Array.iter2_exn&quot;</span> <a href="#local_t1_246"><span class="LIDENT">t1</span></a> <a href="#local_t2_247"><span class="LIDENT">t2</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">iteri</span> <a href="#local_t1_246"><span class="LIDENT">t1</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_249"><span class="LIDENT">i</span></span> <span id="local_x1_250"><span class="LIDENT">x1</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_248"><span class="LIDENT">f</span></a> <a href="#local_x1_250"><span class="LIDENT">x1</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t2_247"><span class="LIDENT">t2</span></a> <a href="#local_i_249"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-map2_exn"><span class="LIDENT">map2_exn</span></span> <span id="local_t1_251"><span class="LIDENT">t1</span></span> <span id="local_t2_252"><span class="LIDENT">t2</span></span> <span class="TILDE">~</span><span id="local_f_253"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">check_length2_exn</span> <span class="STRING">&quot;Array.map2_exn&quot;</span> <a href="#local_t1_251"><span class="LIDENT">t1</span></a> <a href="#local_t2_252"><span class="LIDENT">t2</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">init</span> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t1_251"><span class="LIDENT">t1</span></a><span class="RPAREN">)</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_254"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_253"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t1_251"><span class="LIDENT">t1</span></a> <a href="#local_i_254"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t2_252"><span class="LIDENT">t2</span></a> <a href="#local_i_254"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold2_exn"><span class="LIDENT">fold2_exn</span></span> <span id="local_t1_255"><span class="LIDENT">t1</span></span> <span id="local_t2_256"><span class="LIDENT">t2</span></span> <span class="TILDE">~</span><span id="local_init_257"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_258"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">check_length2_exn</span> <span class="STRING">&quot;Array.fold2_exn&quot;</span> <a href="#local_t1_255"><span class="LIDENT">t1</span></a> <a href="#local_t2_256"><span class="LIDENT">t2</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">foldi</span> <a href="#local_t1_255"><span class="LIDENT">t1</span></a> <span class="TILDE">~</span><a href="#local_init_257"><span class="LIDENT">init</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_259"><span class="LIDENT">i</span></span> <span id="local_ac_260"><span class="LIDENT">ac</span></span> <span id="local_x_261"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_258"><span class="LIDENT">f</span></a> <a href="#local_ac_260"><span class="LIDENT">ac</span></a> <a href="#local_x_261"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t2_256"><span class="LIDENT">t2</span></a> <a href="#local_i_259"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-filter"><span class="LIDENT">filter</span></span> <span id="local_t_262"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_263"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">filter_map</span> <a href="#local_t_262"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_264"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_f_263"><span class="LIDENT">f</span></a> <a href="#local_x_264"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <span class="UIDENT">Some</span> <a href="#local_x_264"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-filteri"><span class="LIDENT">filteri</span></span> <span id="local_t_265"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_266"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">filter_mapi</span> <a href="#local_t_265"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_267"><span class="LIDENT">i</span></span> <span id="local_x_268"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_f_266"><span class="LIDENT">f</span></a> <a href="#local_i_267"><span class="LIDENT">i</span></a> <a href="#local_x_268"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <span class="UIDENT">Some</span> <a href="#local_x_268"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exists"><span class="LIDENT">exists</span></span> <span id="local_t_269"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_270"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_271"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_269"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_272"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_271"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_272"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_f_270"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_269"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_271"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_result_272"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span> <span class="ELSE">else</span> <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_271"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_272"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-existsi"><span class="LIDENT">existsi</span></span> <span id="local_t_273"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_274"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_275"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_273"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_276"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_275"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_276"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_f_274"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_275"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_273"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_275"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_result_276"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span> <span class="ELSE">else</span> <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_275"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_276"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mem"><span class="LIDENT">mem</span></span> <span id="local_t_277"><span class="LIDENT">t</span></span> <span id="local_a_278"><span class="LIDENT">a</span></span> <span class="TILDE">~</span><span id="local_equal_279"><span class="LIDENT">equal</span></span> <span class="EQUAL">=</span> <span class="LIDENT">exists</span> <a href="#local_t_277"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><a href="#local_equal_279"><span class="LIDENT">equal</span></a> <a href="#local_a_278"><span class="LIDENT">a</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-for_all"><span class="LIDENT">for_all</span></span> <span id="local_t_280"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_281"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_282"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_280"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_283"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_282"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_283"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_f_281"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_280"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_282"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_result_283"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span> <span class="ELSE">else</span> <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_282"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_283"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-for_alli"><span class="LIDENT">for_alli</span></span> <span id="local_t_284"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_285"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_length_286"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_284"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_287"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_length_286"><span class="LIDENT">length</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_288"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_287"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_288"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_f_285"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_287"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_284"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_287"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_result_288"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span> <span class="ELSE">else</span> <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_287"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_288"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exists2_exn"><span class="LIDENT">exists2_exn</span></span> <span id="local_t1_289"><span class="LIDENT">t1</span></span> <span id="local_t2_290"><span class="LIDENT">t2</span></span> <span class="TILDE">~</span><span id="local_f_291"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">check_length2_exn</span> <span class="STRING">&quot;Array.exists2_exn&quot;</span> <a href="#local_t1_289"><span class="LIDENT">t1</span></a> <a href="#local_t2_290"><span class="LIDENT">t2</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_292"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t1_289"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_293"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_292"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_293"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_f_291"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t1_289"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_292"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t2_290"><span class="LIDENT">t2</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_292"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_result_293"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span> <span class="ELSE">else</span> <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_292"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_293"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-for_all2_exn"><span class="LIDENT">for_all2_exn</span></span> <span id="local_t1_294"><span class="LIDENT">t1</span></span> <span id="local_t2_295"><span class="LIDENT">t2</span></span> <span class="TILDE">~</span><span id="local_f_296"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">check_length2_exn</span> <span class="STRING">&quot;Array.for_all2_exn&quot;</span> <a href="#local_t1_294"><span class="LIDENT">t1</span></a> <a href="#local_t2_295"><span class="LIDENT">t2</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_297"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t1_294"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_result_298"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_298"><span class="LIDENT">result</span></a> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_f_296"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t1_294"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_297"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t2_295"><span class="LIDENT">t2</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_297"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_result_298"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span> <span class="ELSE">else</span> <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_i_297"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_298"><span class="LIDENT">result</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-equal"><span class="LIDENT">equal</span></span> <span id="local_equal_299"><span class="LIDENT">equal</span></span> <span id="local_t1_300"><span class="LIDENT">t1</span></span> <span id="local_t2_301"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t1_300"><span class="LIDENT">t1</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">length</span> <a href="#local_t2_301"><span class="LIDENT">t2</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">for_all2_exn</span> <a href="#local_t1_300"><span class="LIDENT">t1</span></a> <a href="#local_t2_301"><span class="LIDENT">t2</span></a> <span class="LABEL">~f:</span><a href="#local_equal_299"><span class="LIDENT">equal</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-map_inplace"><span class="LIDENT">map_inplace</span></span> <span id="local_t_302"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_303"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_t_302"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set</span> <a href="#local_t_302"><span class="LIDENT">t</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_f_303"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_302"><span class="LIDENT">t</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-findi_internal"><span class="LIDENT">findi_internal</span></span> <span id="local_t_304"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_305"><span class="LIDENT">f</span></span> <span class="TILDE">~</span><span id="local_if_found_306"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_307"><span class="LIDENT">if_not_found</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_length_308"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_304"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_length_308"><span class="LIDENT">length</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="#local_if_not_found_307"><span class="LIDENT">if_not_found</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_309"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_found_310"><span class="LIDENT">found</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_value_found_311"><span class="LIDENT">value_found</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_304"><span class="LIDENT">t</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <span class="LPAREN">(</span><a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_found_310"><span class="LIDENT">found</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_309"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_length_308"><span class="LIDENT">length</span></a> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_value_312"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_304"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_309"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_f_305"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_309"><span class="LIDENT">i</span></a> <a href="#local_value_312"><span class="LIDENT">value</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_value_found_311"><span class="LIDENT">value_found</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_value_312"><span class="LIDENT">value</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_found_310"><span class="LIDENT">found</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_309"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_found_310"><span class="LIDENT">found</span></a> <span class="THEN">then</span> <a href="#local_if_found_306"><span class="LIDENT">if_found</span></a> <span class="LABEL">~i:</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_309"><span class="LIDENT">i</span></a> <span class="LABEL">~value:</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_value_found_311"><span class="LIDENT">value_found</span></a> <span class="ELSE">else</span> <a href="#local_if_not_found_307"><span class="LIDENT">if_not_found</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-findi"><span class="LIDENT">findi</span></span> <span id="local_t_313"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_314"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">findi_internal</span><span class="EOL">
</span>    <a href="#local_t_313"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="TILDE">~</span><a href="#local_f_314"><span class="LIDENT">f</span></a><span class="EOL">
</span>    <span class="LABEL">~if_found:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="TILDE">~</span><span id="local_i_315"><span class="LIDENT">i</span></span> <span class="TILDE">~</span><span id="local_value_316"><span class="LIDENT">value</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_i_315"><span class="LIDENT">i</span></a><span class="COMMA">,</span> <a href="#local_value_316"><span class="LIDENT">value</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LABEL">~if_not_found:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-findi_exn"><span class="LIDENT">findi_exn</span></span> <span id="local_t_317"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_318"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">findi_internal</span><span class="EOL">
</span>    <a href="#local_t_317"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="TILDE">~</span><a href="#local_f_318"><span class="LIDENT">f</span></a><span class="EOL">
</span>    <span class="LABEL">~if_found:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="TILDE">~</span><span id="local_i_319"><span class="LIDENT">i</span></span> <span class="TILDE">~</span><span id="local_value_320"><span class="LIDENT">value</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_i_319"><span class="LIDENT">i</span></a><span class="COMMA">,</span> <a href="#local_value_320"><span class="LIDENT">value</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LABEL">~if_not_found:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Not_found_s</span> <span class="LPAREN">(</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Array.findi_exn: not found&quot;</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_exn"><span class="LIDENT">find_exn</span></span> <span id="local_t_321"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_322"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">findi_internal</span><span class="EOL">
</span>    <a href="#local_t_321"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local__i_323"><span class="LIDENT">_i</span></span> <span id="local_x_324"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_322"><span class="LIDENT">f</span></a> <a href="#local_x_324"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LABEL">~if_found:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LABEL">~i:</span><span class="UNDERSCORE">_</span> <span class="TILDE">~</span><span id="local_value_325"><span class="LIDENT">value</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_value_325"><span class="LIDENT">value</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LABEL">~if_not_found:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Not_found_s</span> <span class="LPAREN">(</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Array.find_exn: not found&quot;</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find"><span class="LIDENT">find</span></span> <span id="local_t_326"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_327"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="applicative.ml.html#module-Make3_using_map2_local.val-map"><span class="UIDENT">Option</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="LIDENT">findi</span> <a href="#local_t_326"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local__i_328"><span class="LIDENT">_i</span></span> <span id="local_x_329"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_327"><span class="LIDENT">f</span></a> <a href="#local_x_329"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local__i_330"><span class="LIDENT">_i</span></span><span class="COMMA">,</span> <span id="local_x_331"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_331"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_map"><span class="LIDENT">find_map</span></span> <span id="local_t_332"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_333"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_length_334"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_332"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_length_334"><span class="LIDENT">length</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_335"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_value_found_336"><span class="LIDENT">value_found</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">None</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="option.ml.html#val-is_none"><span class="UIDENT">Option</span><span class="DOT">.</span><span class="LIDENT">is_none</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_value_found_336"><span class="LIDENT">value_found</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_335"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_length_334"><span class="LIDENT">length</span></a> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_value_337"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_332"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_335"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_value_found_336"><span class="LIDENT">value_found</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_f_333"><span class="LIDENT">f</span></a> <a href="#local_value_337"><span class="LIDENT">value</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_335"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_value_found_336"><span class="LIDENT">value_found</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_map_exn"><span class="LIDENT">find_map_exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_not_found_338"><span class="LIDENT">not_found</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Not_found_s</span> <span class="LPAREN">(</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Array.find_map_exn: not found&quot;</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_find_map_exn_339"><span class="LIDENT">find_map_exn</span></span> <span id="local_t_340"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_341"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">find_map</span> <a href="#local_t_340"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_f_341"><span class="LIDENT">f</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_not_found_338"><span class="LIDENT">not_found</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_342"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_342"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* named to preserve symbol in compiled binary *)</span><span class="EOL">
</span>  <a href="#local_find_map_exn_339"><span class="LIDENT">find_map_exn</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_mapi"><span class="LIDENT">find_mapi</span></span> <span id="local_t_343"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_344"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_length_345"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_343"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_length_345"><span class="LIDENT">length</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_346"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_value_found_347"><span class="LIDENT">value_found</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">None</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="option.ml.html#val-is_none"><span class="UIDENT">Option</span><span class="DOT">.</span><span class="LIDENT">is_none</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_value_found_347"><span class="LIDENT">value_found</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_346"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_length_345"><span class="LIDENT">length</span></a> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_value_348"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_343"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_346"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_value_found_347"><span class="LIDENT">value_found</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_f_344"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_346"><span class="LIDENT">i</span></a> <a href="#local_value_348"><span class="LIDENT">value</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_346"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_value_found_347"><span class="LIDENT">value_found</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_mapi_exn"><span class="LIDENT">find_mapi_exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_not_found_349"><span class="LIDENT">not_found</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Not_found_s</span> <span class="LPAREN">(</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Array.find_mapi_exn: not found&quot;</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_find_mapi_exn_350"><span class="LIDENT">find_mapi_exn</span></span> <span id="local_t_351"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_352"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">find_mapi</span> <a href="#local_t_351"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_f_352"><span class="LIDENT">f</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_not_found_349"><span class="LIDENT">not_found</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_353"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_353"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* named to preserve symbol in compiled binary *)</span><span class="EOL">
</span>  <a href="#local_find_mapi_exn_350"><span class="LIDENT">find_mapi_exn</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_consecutive_duplicate"><span class="LIDENT">find_consecutive_duplicate</span></span> <span id="local_t_354"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_equal_355"><span class="LIDENT">equal</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_356"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_354"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_356"><span class="LIDENT">n</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_result_357"><span class="LIDENT">result</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">None</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_358"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prev_359"><span class="LIDENT">prev</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_354"><span class="LIDENT">t</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_358"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_n_356"><span class="LIDENT">n</span></a> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_cur_360"><span class="LIDENT">cur</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_354"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_358"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_equal_355"><span class="LIDENT">equal</span></a> <a href="#local_cur_360"><span class="LIDENT">cur</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_prev_359"><span class="LIDENT">prev</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_result_357"><span class="LIDENT">result</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_prev_359"><span class="LIDENT">prev</span></a><span class="COMMA">,</span> <a href="#local_cur_360"><span class="LIDENT">cur</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_i_358"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_n_356"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_prev_359"><span class="LIDENT">prev</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_cur_360"><span class="LIDENT">cur</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_358"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_result_357"><span class="LIDENT">result</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-reduce"><span class="LIDENT">reduce</span></span> <span id="local_t_361"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_362"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">length</span> <a href="#local_t_361"><span class="LIDENT">t</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_363"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_361"><span class="LIDENT">t</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_t_361"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <a href="#local_r_363"><span class="LIDENT">r</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_f_362"><span class="LIDENT">f</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_363"><span class="LIDENT">r</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_361"><span class="LIDENT">t</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="UIDENT">Some</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_363"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-reduce_exn"><span class="LIDENT">reduce_exn</span></span> <span id="local_t_364"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_365"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">reduce</span> <a href="#local_t_364"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_f_365"><span class="LIDENT">f</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Array.reduce_exn&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_v_366"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_v_366"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-permute"><span class="LIDENT">permute</span></span> <span class="EQUAL">=</span> <a href="array_permute.ml.html#val-permute"><span class="UIDENT">Array_permute</span><span class="DOT">.</span><span class="LIDENT">permute</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-random_element_exn"><span class="LIDENT">random_element_exn</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_random_state_367"><span class="LIDENT">random_state</span></span> <span class="EQUAL">=</span> <a href="random.ml.html#module-State.val-default"><span class="UIDENT">Random</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">default</span></a><span class="RPAREN">)</span> <span id="local_t_368"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">is_empty</span> <a href="#local_t_368"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="import0.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Array.random_element_exn: empty array&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="#local_t_368"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="random.ml.html#module-State.val-int"><span class="UIDENT">Random</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">int</span></a> <a href="#local_random_state_367"><span class="LIDENT">random_state</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_368"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-random_element"><span class="LIDENT">random_element</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_random_state_369"><span class="LIDENT">random_state</span></span> <span class="EQUAL">=</span> <a href="random.ml.html#module-State.val-default"><span class="UIDENT">Random</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">default</span></a><span class="RPAREN">)</span> <span id="local_t_370"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">random_element_exn</span> <span class="TILDE">~</span><a href="#local_random_state_369"><span class="LIDENT">random_state</span></a> <a href="#local_t_370"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-zip"><span class="LIDENT">zip</span></span> <span id="local_t1_371"><span class="LIDENT">t1</span></span> <span id="local_t2_372"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">length</span> <a href="#local_t1_371"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_t2_372"><span class="LIDENT">t2</span></a> <span class="THEN">then</span> <span class="UIDENT">None</span> <span class="ELSE">else</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">map2_exn</span> <a href="#local_t1_371"><span class="LIDENT">t1</span></a> <a href="#local_t2_372"><span class="LIDENT">t2</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x1_373"><span class="LIDENT">x1</span></span> <span id="local_x2_374"><span class="LIDENT">x2</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x1_373"><span class="LIDENT">x1</span></a><span class="COMMA">,</span> <a href="#local_x2_374"><span class="LIDENT">x2</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-zip_exn"><span class="LIDENT">zip_exn</span></span> <span id="local_t1_375"><span class="LIDENT">t1</span></span> <span id="local_t2_376"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">length</span> <a href="#local_t1_375"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_t2_376"><span class="LIDENT">t2</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="import0.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Array.zip_exn&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">map2_exn</span> <a href="#local_t1_375"><span class="LIDENT">t1</span></a> <a href="#local_t2_376"><span class="LIDENT">t2</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x1_377"><span class="LIDENT">x1</span></span> <span id="local_x2_378"><span class="LIDENT">x2</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x1_377"><span class="LIDENT">x1</span></a><span class="COMMA">,</span> <a href="#local_x2_378"><span class="LIDENT">x2</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unzip"><span class="LIDENT">unzip</span></span> <span id="local_t_379"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_380"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t_379"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_380"><span class="LIDENT">n</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="COMMA">,</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_443"><span id="local_x_381"><span class="LIDENT">x</span></span><span class="COMMA">,</span> <span id="local_y_382"><span class="LIDENT">y</span></span></span> <span class="EQUAL">=</span> <a href="#local_t_379"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res1_383"><span class="LIDENT">res1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LABEL">~len:</span><a href="#local_n_380"><span class="LIDENT">n</span></a> <a href="#local_x_381"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res2_384"><span class="LIDENT">res2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LABEL">~len:</span><a href="#local_n_380"><span class="LIDENT">n</span></a> <a href="#local_y_382"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <a href="#local_n_380"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_445"><span id="local_x_385"><span class="LIDENT">x</span></span><span class="COMMA">,</span> <span id="local_y_386"><span class="LIDENT">y</span></span></span> <span class="EQUAL">=</span> <a href="#local_t_379"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_res1_383"><span class="LIDENT">res1</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_x_385"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_res2_384"><span class="LIDENT">res2</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_y_386"><span class="LIDENT">y</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_res1_383"><span class="LIDENT">res1</span></a><span class="COMMA">,</span> <a href="#local_res2_384"><span class="LIDENT">res2</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sorted_copy"><span class="LIDENT">sorted_copy</span></span> <span id="local_t_387"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_388"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t1_389"><span class="LIDENT">t1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">copy</span> <a href="#local_t_387"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">sort</span> <a href="#local_t1_389"><span class="LIDENT">t1</span></a> <span class="TILDE">~</span><a href="#local_compare_388"><span class="LIDENT">compare</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_t1_389"><span class="LIDENT">t1</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-partition_mapi"><span class="LIDENT">partition_mapi</span></span> <span id="local_t_390"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_391"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span id="local_both_392"><span class="LIDENT">both</span></span> <span class="COLON">:</span> <a href="either0.ml.html#type-t"><span class="UNDERSCORE">_</span> <span class="UIDENT">Either</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">mapi</span> <a href="#local_t_390"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_f_391"><span class="LIDENT">f</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_firsts_393"><span class="LIDENT">firsts</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">filter_map</span> <a href="#local_both_392"><span class="LIDENT">both</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">First</span> <span id="local_x_394"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_x_394"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Second</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_seconds_395"><span class="LIDENT">seconds</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">filter_map</span> <a href="#local_both_392"><span class="LIDENT">both</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">First</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Second</span> <span id="local_x_396"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_x_396"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_firsts_393"><span class="LIDENT">firsts</span></a><span class="COMMA">,</span> <a href="#local_seconds_395"><span class="LIDENT">seconds</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-partitioni_tf"><span class="LIDENT">partitioni_tf</span></span> <span id="local_t_397"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_398"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">partition_mapi</span> <a href="#local_t_397"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_399"><span class="LIDENT">i</span></span> <span id="local_x_400"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_f_398"><span class="LIDENT">f</span></a> <a href="#local_i_399"><span class="LIDENT">i</span></a> <a href="#local_x_400"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <span class="UIDENT">First</span> <a href="#local_x_400"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="UIDENT">Second</span> <a href="#local_x_400"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-partition_map"><span class="LIDENT">partition_map</span></span> <span id="local_t_401"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_402"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">partition_mapi</span> <a href="#local_t_401"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span id="local_x_403"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_402"><span class="LIDENT">f</span></a> <a href="#local_x_403"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-partition_tf"><span class="LIDENT">partition_tf</span></span> <span id="local_t_404"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_405"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">partitioni_tf</span> <a href="#local_t_404"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span id="local_x_406"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_405"><span class="LIDENT">f</span></a> <a href="#local_x_406"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">nontail</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-last"><span class="LIDENT">last</span></span> <span id="local_t_407"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_407"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_t_407"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert to a sequence but does not attempt to protect against modification
   in the array. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_sequence_mutable"><span class="LIDENT">to_sequence_mutable</span></span> <span id="local_t_408"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="sequence.ml.html#val-unfold_step"><span class="UIDENT">Sequence</span><span class="DOT">.</span><span class="LIDENT">unfold_step</span></a> <span class="LABEL">~init:</span><span class="INT">0</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_409"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_409"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">length</span> <a href="#local_t_408"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Sequence</span><span class="DOT">.</span><span class="UIDENT">Step</span><span class="DOT">.</span><span class="UIDENT">Done</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="UIDENT">Sequence</span><span class="DOT">.</span><span class="UIDENT">Step</span><span class="DOT">.</span><span class="UIDENT">Yield</span> <span class="LBRACE">{</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <a href="#local_t_408"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_409"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">state</span> <span class="EQUAL">=</span> <a href="#local_i_409"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_sequence"><span class="LIDENT">to_sequence</span></span> <span id="local_t_410"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">to_sequence_mutable</span> <span class="LPAREN">(</span><span class="LIDENT">copy</span> <a href="#local_t_410"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-cartesian_product"><span class="LIDENT">cartesian_product</span></span> <span id="local_t1_411"><span class="LIDENT">t1</span></span> <span id="local_t2_412"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">is_empty</span> <a href="#local_t1_411"><span class="LIDENT">t1</span></a> <a href="import0.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">is_empty</span> <a href="#local_t2_412"><span class="LIDENT">t2</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n1_413"><span class="LIDENT">n1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t1_411"><span class="LIDENT">t1</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n2_414"><span class="LIDENT">n2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_t2_412"><span class="LIDENT">t2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t_415"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LABEL">~len:</span><span class="LPAREN">(</span><a href="#local_n1_413"><span class="LIDENT">n1</span></a> <a href="import0.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_n2_414"><span class="LIDENT">n2</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_t1_411"><span class="LIDENT">t1</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_t2_412"><span class="LIDENT">t2</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_416"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i1</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_n1_413"><span class="LIDENT">n1</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i2</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_n2_414"><span class="LIDENT">n2</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_t_415"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_416"><span class="LIDENT">r</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t1_411"><span class="LIDENT">t1</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i1</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_t2_412"><span class="LIDENT">t2</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i2</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="import0.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_r_416"><span class="LIDENT">r</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_t_415"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-transpose"><span class="LIDENT">transpose</span></span> <span id="local_tt_417"><span class="LIDENT">tt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">length</span> <a href="#local_tt_417"><span class="LIDENT">tt</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_418"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_tt_417"><span class="LIDENT">tt</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_depth_419"><span class="LIDENT">depth</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_tt_417"><span class="LIDENT">tt</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">exists</span> <a href="#local_tt_417"><span class="LIDENT">tt</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_t_420"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">length</span> <a href="#local_t_420"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_depth_419"><span class="LIDENT">depth</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">init</span> <a href="#local_depth_419"><span class="LIDENT">depth</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_d_421"><span class="LIDENT">d</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">init</span> <a href="#local_width_418"><span class="LIDENT">width</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_w_422"><span class="LIDENT">w</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_tt_417"><span class="LIDENT">tt</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_w_422"><span class="LIDENT">w</span></a><span class="RPAREN">)</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_421"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-transpose_exn"><span class="LIDENT">transpose_exn</span></span> <span id="local_tt_423"><span class="LIDENT">tt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">transpose</span> <a href="#local_tt_423"><span class="LIDENT">tt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Array.transpose_exn&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_tt'_424"><span class="LIDENT">tt'</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_tt'_424"><span class="LIDENT">tt'</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="binary_searchable.ml.html#module-Make1"><span class="UIDENT">Binary_searchable</span><span class="DOT">.</span><span class="UIDENT">Make1</span></a> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="def_444"><span class="TYPE">type</span> <span class="NONREC">nonrec</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_425"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_426"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="blit.ml.html#module-Make1"><span class="UIDENT">Blit</span><span class="DOT">.</span><span class="UIDENT">Make1</span></a> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="def_446"><span class="TYPE">type</span> <span class="NONREC">nonrec</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_427"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_create_like_428"><span class="LIDENT">create_like</span></span> <span class="TILDE">~</span><span id="local_len_429"><span class="LIDENT">len</span></span> <span id="local_t_430"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_len_429"><span class="LIDENT">len</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_length_427"><span class="LIDENT">length</span></a> <a href="#local_t_430"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">create</span> <span class="TILDE">~</span><a href="#local_len_429"><span class="LIDENT">len</span></a> <a href="#local_t_430"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_unsafe_blit_431"><span class="LIDENT">unsafe_blit</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_blit</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-invariant"><span class="LIDENT">invariant</span></span> <span id="local_invariant_a_432"><span class="LIDENT">invariant_a</span></span> <span id="local_t_433"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">iter</span> <a href="#local_t_433"><span class="LIDENT">t</span></a> <span class="LABEL">~f:</span><a href="#local_invariant_a_432"><span class="LIDENT">invariant_a</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-Private"><span class="MODULE">module</span> <span class="UIDENT">Private</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Private.module-Sort"><span class="MODULE">module</span> <span class="UIDENT">Sort</span> <span class="EQUAL">=</span> <span class="UIDENT">Sort</span></span><span class="EOL">
</span>  <span id="module-Private.module-Sorter"><span class="MODULE">module</span> <span class="UIDENT">Sorter</span> <span class="EQUAL">=</span> <span class="UIDENT">Sorter</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span></span></code></pre></body></html>
