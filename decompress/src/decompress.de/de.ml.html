<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: de.ml (decompress.src.decompress.de)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">decompress</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; decompress.de &#x00BB; de.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>de.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">decompress</a><ul><li>Library <code>decompress.de</code><ul><li><a href="../../decompress.de/De/index.html">De</a></li></ul></li><li>Library <code>decompress.gz</code><ul><li><a href="../../decompress.gz/Gz/index.html">Gz</a></li></ul></li><li>Library <code>decompress.lz</code><ul><li><a href="../../decompress.lz/Lz/index.html">Lz</a></li></ul></li><li>Library <code>decompress.lzo</code><ul><li><a href="../../decompress.lzo/Lzo/index.html">Lzo</a></li></ul></li><li>Library <code>decompress.zl</code><ul><li><a href="../../decompress.zl/Zl/index.html">Zl</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>decompress.de<ul><li><a href="#" class="current_unit">de.ml</a></li></ul></li><li>decompress.gz<ul><li><a href="../decompress.gz/gz.ml.html">gz.ml</a></li></ul></li><li>decompress.lz<ul><li><a href="../decompress.lz/lz.ml.html">lz.ml</a></li></ul></li><li>decompress.lzo<ul><li><a href="../decompress.lzo/lzo.ml.html">lzo.ml</a></li></ul></li><li>decompress.zl<ul><li><a href="../decompress.zl/zl.ml.html">zl.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
<a id="L948" class="source_line" href="#L948">948</a>
<a id="L949" class="source_line" href="#L949">949</a>
<a id="L950" class="source_line" href="#L950">950</a>
<a id="L951" class="source_line" href="#L951">951</a>
<a id="L952" class="source_line" href="#L952">952</a>
<a id="L953" class="source_line" href="#L953">953</a>
<a id="L954" class="source_line" href="#L954">954</a>
<a id="L955" class="source_line" href="#L955">955</a>
<a id="L956" class="source_line" href="#L956">956</a>
<a id="L957" class="source_line" href="#L957">957</a>
<a id="L958" class="source_line" href="#L958">958</a>
<a id="L959" class="source_line" href="#L959">959</a>
<a id="L960" class="source_line" href="#L960">960</a>
<a id="L961" class="source_line" href="#L961">961</a>
<a id="L962" class="source_line" href="#L962">962</a>
<a id="L963" class="source_line" href="#L963">963</a>
<a id="L964" class="source_line" href="#L964">964</a>
<a id="L965" class="source_line" href="#L965">965</a>
<a id="L966" class="source_line" href="#L966">966</a>
<a id="L967" class="source_line" href="#L967">967</a>
<a id="L968" class="source_line" href="#L968">968</a>
<a id="L969" class="source_line" href="#L969">969</a>
<a id="L970" class="source_line" href="#L970">970</a>
<a id="L971" class="source_line" href="#L971">971</a>
<a id="L972" class="source_line" href="#L972">972</a>
<a id="L973" class="source_line" href="#L973">973</a>
<a id="L974" class="source_line" href="#L974">974</a>
<a id="L975" class="source_line" href="#L975">975</a>
<a id="L976" class="source_line" href="#L976">976</a>
<a id="L977" class="source_line" href="#L977">977</a>
<a id="L978" class="source_line" href="#L978">978</a>
<a id="L979" class="source_line" href="#L979">979</a>
<a id="L980" class="source_line" href="#L980">980</a>
<a id="L981" class="source_line" href="#L981">981</a>
<a id="L982" class="source_line" href="#L982">982</a>
<a id="L983" class="source_line" href="#L983">983</a>
<a id="L984" class="source_line" href="#L984">984</a>
<a id="L985" class="source_line" href="#L985">985</a>
<a id="L986" class="source_line" href="#L986">986</a>
<a id="L987" class="source_line" href="#L987">987</a>
<a id="L988" class="source_line" href="#L988">988</a>
<a id="L989" class="source_line" href="#L989">989</a>
<a id="L990" class="source_line" href="#L990">990</a>
<a id="L991" class="source_line" href="#L991">991</a>
<a id="L992" class="source_line" href="#L992">992</a>
<a id="L993" class="source_line" href="#L993">993</a>
<a id="L994" class="source_line" href="#L994">994</a>
<a id="L995" class="source_line" href="#L995">995</a>
<a id="L996" class="source_line" href="#L996">996</a>
<a id="L997" class="source_line" href="#L997">997</a>
<a id="L998" class="source_line" href="#L998">998</a>
<a id="L999" class="source_line" href="#L999">999</a>
<a id="L1000" class="source_line" href="#L1000">1000</a>
<a id="L1001" class="source_line" href="#L1001">1001</a>
<a id="L1002" class="source_line" href="#L1002">1002</a>
<a id="L1003" class="source_line" href="#L1003">1003</a>
<a id="L1004" class="source_line" href="#L1004">1004</a>
<a id="L1005" class="source_line" href="#L1005">1005</a>
<a id="L1006" class="source_line" href="#L1006">1006</a>
<a id="L1007" class="source_line" href="#L1007">1007</a>
<a id="L1008" class="source_line" href="#L1008">1008</a>
<a id="L1009" class="source_line" href="#L1009">1009</a>
<a id="L1010" class="source_line" href="#L1010">1010</a>
<a id="L1011" class="source_line" href="#L1011">1011</a>
<a id="L1012" class="source_line" href="#L1012">1012</a>
<a id="L1013" class="source_line" href="#L1013">1013</a>
<a id="L1014" class="source_line" href="#L1014">1014</a>
<a id="L1015" class="source_line" href="#L1015">1015</a>
<a id="L1016" class="source_line" href="#L1016">1016</a>
<a id="L1017" class="source_line" href="#L1017">1017</a>
<a id="L1018" class="source_line" href="#L1018">1018</a>
<a id="L1019" class="source_line" href="#L1019">1019</a>
<a id="L1020" class="source_line" href="#L1020">1020</a>
<a id="L1021" class="source_line" href="#L1021">1021</a>
<a id="L1022" class="source_line" href="#L1022">1022</a>
<a id="L1023" class="source_line" href="#L1023">1023</a>
<a id="L1024" class="source_line" href="#L1024">1024</a>
<a id="L1025" class="source_line" href="#L1025">1025</a>
<a id="L1026" class="source_line" href="#L1026">1026</a>
<a id="L1027" class="source_line" href="#L1027">1027</a>
<a id="L1028" class="source_line" href="#L1028">1028</a>
<a id="L1029" class="source_line" href="#L1029">1029</a>
<a id="L1030" class="source_line" href="#L1030">1030</a>
<a id="L1031" class="source_line" href="#L1031">1031</a>
<a id="L1032" class="source_line" href="#L1032">1032</a>
<a id="L1033" class="source_line" href="#L1033">1033</a>
<a id="L1034" class="source_line" href="#L1034">1034</a>
<a id="L1035" class="source_line" href="#L1035">1035</a>
<a id="L1036" class="source_line" href="#L1036">1036</a>
<a id="L1037" class="source_line" href="#L1037">1037</a>
<a id="L1038" class="source_line" href="#L1038">1038</a>
<a id="L1039" class="source_line" href="#L1039">1039</a>
<a id="L1040" class="source_line" href="#L1040">1040</a>
<a id="L1041" class="source_line" href="#L1041">1041</a>
<a id="L1042" class="source_line" href="#L1042">1042</a>
<a id="L1043" class="source_line" href="#L1043">1043</a>
<a id="L1044" class="source_line" href="#L1044">1044</a>
<a id="L1045" class="source_line" href="#L1045">1045</a>
<a id="L1046" class="source_line" href="#L1046">1046</a>
<a id="L1047" class="source_line" href="#L1047">1047</a>
<a id="L1048" class="source_line" href="#L1048">1048</a>
<a id="L1049" class="source_line" href="#L1049">1049</a>
<a id="L1050" class="source_line" href="#L1050">1050</a>
<a id="L1051" class="source_line" href="#L1051">1051</a>
<a id="L1052" class="source_line" href="#L1052">1052</a>
<a id="L1053" class="source_line" href="#L1053">1053</a>
<a id="L1054" class="source_line" href="#L1054">1054</a>
<a id="L1055" class="source_line" href="#L1055">1055</a>
<a id="L1056" class="source_line" href="#L1056">1056</a>
<a id="L1057" class="source_line" href="#L1057">1057</a>
<a id="L1058" class="source_line" href="#L1058">1058</a>
<a id="L1059" class="source_line" href="#L1059">1059</a>
<a id="L1060" class="source_line" href="#L1060">1060</a>
<a id="L1061" class="source_line" href="#L1061">1061</a>
<a id="L1062" class="source_line" href="#L1062">1062</a>
<a id="L1063" class="source_line" href="#L1063">1063</a>
<a id="L1064" class="source_line" href="#L1064">1064</a>
<a id="L1065" class="source_line" href="#L1065">1065</a>
<a id="L1066" class="source_line" href="#L1066">1066</a>
<a id="L1067" class="source_line" href="#L1067">1067</a>
<a id="L1068" class="source_line" href="#L1068">1068</a>
<a id="L1069" class="source_line" href="#L1069">1069</a>
<a id="L1070" class="source_line" href="#L1070">1070</a>
<a id="L1071" class="source_line" href="#L1071">1071</a>
<a id="L1072" class="source_line" href="#L1072">1072</a>
<a id="L1073" class="source_line" href="#L1073">1073</a>
<a id="L1074" class="source_line" href="#L1074">1074</a>
<a id="L1075" class="source_line" href="#L1075">1075</a>
<a id="L1076" class="source_line" href="#L1076">1076</a>
<a id="L1077" class="source_line" href="#L1077">1077</a>
<a id="L1078" class="source_line" href="#L1078">1078</a>
<a id="L1079" class="source_line" href="#L1079">1079</a>
<a id="L1080" class="source_line" href="#L1080">1080</a>
<a id="L1081" class="source_line" href="#L1081">1081</a>
<a id="L1082" class="source_line" href="#L1082">1082</a>
<a id="L1083" class="source_line" href="#L1083">1083</a>
<a id="L1084" class="source_line" href="#L1084">1084</a>
<a id="L1085" class="source_line" href="#L1085">1085</a>
<a id="L1086" class="source_line" href="#L1086">1086</a>
<a id="L1087" class="source_line" href="#L1087">1087</a>
<a id="L1088" class="source_line" href="#L1088">1088</a>
<a id="L1089" class="source_line" href="#L1089">1089</a>
<a id="L1090" class="source_line" href="#L1090">1090</a>
<a id="L1091" class="source_line" href="#L1091">1091</a>
<a id="L1092" class="source_line" href="#L1092">1092</a>
<a id="L1093" class="source_line" href="#L1093">1093</a>
<a id="L1094" class="source_line" href="#L1094">1094</a>
<a id="L1095" class="source_line" href="#L1095">1095</a>
<a id="L1096" class="source_line" href="#L1096">1096</a>
<a id="L1097" class="source_line" href="#L1097">1097</a>
<a id="L1098" class="source_line" href="#L1098">1098</a>
<a id="L1099" class="source_line" href="#L1099">1099</a>
<a id="L1100" class="source_line" href="#L1100">1100</a>
<a id="L1101" class="source_line" href="#L1101">1101</a>
<a id="L1102" class="source_line" href="#L1102">1102</a>
<a id="L1103" class="source_line" href="#L1103">1103</a>
<a id="L1104" class="source_line" href="#L1104">1104</a>
<a id="L1105" class="source_line" href="#L1105">1105</a>
<a id="L1106" class="source_line" href="#L1106">1106</a>
<a id="L1107" class="source_line" href="#L1107">1107</a>
<a id="L1108" class="source_line" href="#L1108">1108</a>
<a id="L1109" class="source_line" href="#L1109">1109</a>
<a id="L1110" class="source_line" href="#L1110">1110</a>
<a id="L1111" class="source_line" href="#L1111">1111</a>
<a id="L1112" class="source_line" href="#L1112">1112</a>
<a id="L1113" class="source_line" href="#L1113">1113</a>
<a id="L1114" class="source_line" href="#L1114">1114</a>
<a id="L1115" class="source_line" href="#L1115">1115</a>
<a id="L1116" class="source_line" href="#L1116">1116</a>
<a id="L1117" class="source_line" href="#L1117">1117</a>
<a id="L1118" class="source_line" href="#L1118">1118</a>
<a id="L1119" class="source_line" href="#L1119">1119</a>
<a id="L1120" class="source_line" href="#L1120">1120</a>
<a id="L1121" class="source_line" href="#L1121">1121</a>
<a id="L1122" class="source_line" href="#L1122">1122</a>
<a id="L1123" class="source_line" href="#L1123">1123</a>
<a id="L1124" class="source_line" href="#L1124">1124</a>
<a id="L1125" class="source_line" href="#L1125">1125</a>
<a id="L1126" class="source_line" href="#L1126">1126</a>
<a id="L1127" class="source_line" href="#L1127">1127</a>
<a id="L1128" class="source_line" href="#L1128">1128</a>
<a id="L1129" class="source_line" href="#L1129">1129</a>
<a id="L1130" class="source_line" href="#L1130">1130</a>
<a id="L1131" class="source_line" href="#L1131">1131</a>
<a id="L1132" class="source_line" href="#L1132">1132</a>
<a id="L1133" class="source_line" href="#L1133">1133</a>
<a id="L1134" class="source_line" href="#L1134">1134</a>
<a id="L1135" class="source_line" href="#L1135">1135</a>
<a id="L1136" class="source_line" href="#L1136">1136</a>
<a id="L1137" class="source_line" href="#L1137">1137</a>
<a id="L1138" class="source_line" href="#L1138">1138</a>
<a id="L1139" class="source_line" href="#L1139">1139</a>
<a id="L1140" class="source_line" href="#L1140">1140</a>
<a id="L1141" class="source_line" href="#L1141">1141</a>
<a id="L1142" class="source_line" href="#L1142">1142</a>
<a id="L1143" class="source_line" href="#L1143">1143</a>
<a id="L1144" class="source_line" href="#L1144">1144</a>
<a id="L1145" class="source_line" href="#L1145">1145</a>
<a id="L1146" class="source_line" href="#L1146">1146</a>
<a id="L1147" class="source_line" href="#L1147">1147</a>
<a id="L1148" class="source_line" href="#L1148">1148</a>
<a id="L1149" class="source_line" href="#L1149">1149</a>
<a id="L1150" class="source_line" href="#L1150">1150</a>
<a id="L1151" class="source_line" href="#L1151">1151</a>
<a id="L1152" class="source_line" href="#L1152">1152</a>
<a id="L1153" class="source_line" href="#L1153">1153</a>
<a id="L1154" class="source_line" href="#L1154">1154</a>
<a id="L1155" class="source_line" href="#L1155">1155</a>
<a id="L1156" class="source_line" href="#L1156">1156</a>
<a id="L1157" class="source_line" href="#L1157">1157</a>
<a id="L1158" class="source_line" href="#L1158">1158</a>
<a id="L1159" class="source_line" href="#L1159">1159</a>
<a id="L1160" class="source_line" href="#L1160">1160</a>
<a id="L1161" class="source_line" href="#L1161">1161</a>
<a id="L1162" class="source_line" href="#L1162">1162</a>
<a id="L1163" class="source_line" href="#L1163">1163</a>
<a id="L1164" class="source_line" href="#L1164">1164</a>
<a id="L1165" class="source_line" href="#L1165">1165</a>
<a id="L1166" class="source_line" href="#L1166">1166</a>
<a id="L1167" class="source_line" href="#L1167">1167</a>
<a id="L1168" class="source_line" href="#L1168">1168</a>
<a id="L1169" class="source_line" href="#L1169">1169</a>
<a id="L1170" class="source_line" href="#L1170">1170</a>
<a id="L1171" class="source_line" href="#L1171">1171</a>
<a id="L1172" class="source_line" href="#L1172">1172</a>
<a id="L1173" class="source_line" href="#L1173">1173</a>
<a id="L1174" class="source_line" href="#L1174">1174</a>
<a id="L1175" class="source_line" href="#L1175">1175</a>
<a id="L1176" class="source_line" href="#L1176">1176</a>
<a id="L1177" class="source_line" href="#L1177">1177</a>
<a id="L1178" class="source_line" href="#L1178">1178</a>
<a id="L1179" class="source_line" href="#L1179">1179</a>
<a id="L1180" class="source_line" href="#L1180">1180</a>
<a id="L1181" class="source_line" href="#L1181">1181</a>
<a id="L1182" class="source_line" href="#L1182">1182</a>
<a id="L1183" class="source_line" href="#L1183">1183</a>
<a id="L1184" class="source_line" href="#L1184">1184</a>
<a id="L1185" class="source_line" href="#L1185">1185</a>
<a id="L1186" class="source_line" href="#L1186">1186</a>
<a id="L1187" class="source_line" href="#L1187">1187</a>
<a id="L1188" class="source_line" href="#L1188">1188</a>
<a id="L1189" class="source_line" href="#L1189">1189</a>
<a id="L1190" class="source_line" href="#L1190">1190</a>
<a id="L1191" class="source_line" href="#L1191">1191</a>
<a id="L1192" class="source_line" href="#L1192">1192</a>
<a id="L1193" class="source_line" href="#L1193">1193</a>
<a id="L1194" class="source_line" href="#L1194">1194</a>
<a id="L1195" class="source_line" href="#L1195">1195</a>
<a id="L1196" class="source_line" href="#L1196">1196</a>
<a id="L1197" class="source_line" href="#L1197">1197</a>
<a id="L1198" class="source_line" href="#L1198">1198</a>
<a id="L1199" class="source_line" href="#L1199">1199</a>
<a id="L1200" class="source_line" href="#L1200">1200</a>
<a id="L1201" class="source_line" href="#L1201">1201</a>
<a id="L1202" class="source_line" href="#L1202">1202</a>
<a id="L1203" class="source_line" href="#L1203">1203</a>
<a id="L1204" class="source_line" href="#L1204">1204</a>
<a id="L1205" class="source_line" href="#L1205">1205</a>
<a id="L1206" class="source_line" href="#L1206">1206</a>
<a id="L1207" class="source_line" href="#L1207">1207</a>
<a id="L1208" class="source_line" href="#L1208">1208</a>
<a id="L1209" class="source_line" href="#L1209">1209</a>
<a id="L1210" class="source_line" href="#L1210">1210</a>
<a id="L1211" class="source_line" href="#L1211">1211</a>
<a id="L1212" class="source_line" href="#L1212">1212</a>
<a id="L1213" class="source_line" href="#L1213">1213</a>
<a id="L1214" class="source_line" href="#L1214">1214</a>
<a id="L1215" class="source_line" href="#L1215">1215</a>
<a id="L1216" class="source_line" href="#L1216">1216</a>
<a id="L1217" class="source_line" href="#L1217">1217</a>
<a id="L1218" class="source_line" href="#L1218">1218</a>
<a id="L1219" class="source_line" href="#L1219">1219</a>
<a id="L1220" class="source_line" href="#L1220">1220</a>
<a id="L1221" class="source_line" href="#L1221">1221</a>
<a id="L1222" class="source_line" href="#L1222">1222</a>
<a id="L1223" class="source_line" href="#L1223">1223</a>
<a id="L1224" class="source_line" href="#L1224">1224</a>
<a id="L1225" class="source_line" href="#L1225">1225</a>
<a id="L1226" class="source_line" href="#L1226">1226</a>
<a id="L1227" class="source_line" href="#L1227">1227</a>
<a id="L1228" class="source_line" href="#L1228">1228</a>
<a id="L1229" class="source_line" href="#L1229">1229</a>
<a id="L1230" class="source_line" href="#L1230">1230</a>
<a id="L1231" class="source_line" href="#L1231">1231</a>
<a id="L1232" class="source_line" href="#L1232">1232</a>
<a id="L1233" class="source_line" href="#L1233">1233</a>
<a id="L1234" class="source_line" href="#L1234">1234</a>
<a id="L1235" class="source_line" href="#L1235">1235</a>
<a id="L1236" class="source_line" href="#L1236">1236</a>
<a id="L1237" class="source_line" href="#L1237">1237</a>
<a id="L1238" class="source_line" href="#L1238">1238</a>
<a id="L1239" class="source_line" href="#L1239">1239</a>
<a id="L1240" class="source_line" href="#L1240">1240</a>
<a id="L1241" class="source_line" href="#L1241">1241</a>
<a id="L1242" class="source_line" href="#L1242">1242</a>
<a id="L1243" class="source_line" href="#L1243">1243</a>
<a id="L1244" class="source_line" href="#L1244">1244</a>
<a id="L1245" class="source_line" href="#L1245">1245</a>
<a id="L1246" class="source_line" href="#L1246">1246</a>
<a id="L1247" class="source_line" href="#L1247">1247</a>
<a id="L1248" class="source_line" href="#L1248">1248</a>
<a id="L1249" class="source_line" href="#L1249">1249</a>
<a id="L1250" class="source_line" href="#L1250">1250</a>
<a id="L1251" class="source_line" href="#L1251">1251</a>
<a id="L1252" class="source_line" href="#L1252">1252</a>
<a id="L1253" class="source_line" href="#L1253">1253</a>
<a id="L1254" class="source_line" href="#L1254">1254</a>
<a id="L1255" class="source_line" href="#L1255">1255</a>
<a id="L1256" class="source_line" href="#L1256">1256</a>
<a id="L1257" class="source_line" href="#L1257">1257</a>
<a id="L1258" class="source_line" href="#L1258">1258</a>
<a id="L1259" class="source_line" href="#L1259">1259</a>
<a id="L1260" class="source_line" href="#L1260">1260</a>
<a id="L1261" class="source_line" href="#L1261">1261</a>
<a id="L1262" class="source_line" href="#L1262">1262</a>
<a id="L1263" class="source_line" href="#L1263">1263</a>
<a id="L1264" class="source_line" href="#L1264">1264</a>
<a id="L1265" class="source_line" href="#L1265">1265</a>
<a id="L1266" class="source_line" href="#L1266">1266</a>
<a id="L1267" class="source_line" href="#L1267">1267</a>
<a id="L1268" class="source_line" href="#L1268">1268</a>
<a id="L1269" class="source_line" href="#L1269">1269</a>
<a id="L1270" class="source_line" href="#L1270">1270</a>
<a id="L1271" class="source_line" href="#L1271">1271</a>
<a id="L1272" class="source_line" href="#L1272">1272</a>
<a id="L1273" class="source_line" href="#L1273">1273</a>
<a id="L1274" class="source_line" href="#L1274">1274</a>
<a id="L1275" class="source_line" href="#L1275">1275</a>
<a id="L1276" class="source_line" href="#L1276">1276</a>
<a id="L1277" class="source_line" href="#L1277">1277</a>
<a id="L1278" class="source_line" href="#L1278">1278</a>
<a id="L1279" class="source_line" href="#L1279">1279</a>
<a id="L1280" class="source_line" href="#L1280">1280</a>
<a id="L1281" class="source_line" href="#L1281">1281</a>
<a id="L1282" class="source_line" href="#L1282">1282</a>
<a id="L1283" class="source_line" href="#L1283">1283</a>
<a id="L1284" class="source_line" href="#L1284">1284</a>
<a id="L1285" class="source_line" href="#L1285">1285</a>
<a id="L1286" class="source_line" href="#L1286">1286</a>
<a id="L1287" class="source_line" href="#L1287">1287</a>
<a id="L1288" class="source_line" href="#L1288">1288</a>
<a id="L1289" class="source_line" href="#L1289">1289</a>
<a id="L1290" class="source_line" href="#L1290">1290</a>
<a id="L1291" class="source_line" href="#L1291">1291</a>
<a id="L1292" class="source_line" href="#L1292">1292</a>
<a id="L1293" class="source_line" href="#L1293">1293</a>
<a id="L1294" class="source_line" href="#L1294">1294</a>
<a id="L1295" class="source_line" href="#L1295">1295</a>
<a id="L1296" class="source_line" href="#L1296">1296</a>
<a id="L1297" class="source_line" href="#L1297">1297</a>
<a id="L1298" class="source_line" href="#L1298">1298</a>
<a id="L1299" class="source_line" href="#L1299">1299</a>
<a id="L1300" class="source_line" href="#L1300">1300</a>
<a id="L1301" class="source_line" href="#L1301">1301</a>
<a id="L1302" class="source_line" href="#L1302">1302</a>
<a id="L1303" class="source_line" href="#L1303">1303</a>
<a id="L1304" class="source_line" href="#L1304">1304</a>
<a id="L1305" class="source_line" href="#L1305">1305</a>
<a id="L1306" class="source_line" href="#L1306">1306</a>
<a id="L1307" class="source_line" href="#L1307">1307</a>
<a id="L1308" class="source_line" href="#L1308">1308</a>
<a id="L1309" class="source_line" href="#L1309">1309</a>
<a id="L1310" class="source_line" href="#L1310">1310</a>
<a id="L1311" class="source_line" href="#L1311">1311</a>
<a id="L1312" class="source_line" href="#L1312">1312</a>
<a id="L1313" class="source_line" href="#L1313">1313</a>
<a id="L1314" class="source_line" href="#L1314">1314</a>
<a id="L1315" class="source_line" href="#L1315">1315</a>
<a id="L1316" class="source_line" href="#L1316">1316</a>
<a id="L1317" class="source_line" href="#L1317">1317</a>
<a id="L1318" class="source_line" href="#L1318">1318</a>
<a id="L1319" class="source_line" href="#L1319">1319</a>
<a id="L1320" class="source_line" href="#L1320">1320</a>
<a id="L1321" class="source_line" href="#L1321">1321</a>
<a id="L1322" class="source_line" href="#L1322">1322</a>
<a id="L1323" class="source_line" href="#L1323">1323</a>
<a id="L1324" class="source_line" href="#L1324">1324</a>
<a id="L1325" class="source_line" href="#L1325">1325</a>
<a id="L1326" class="source_line" href="#L1326">1326</a>
<a id="L1327" class="source_line" href="#L1327">1327</a>
<a id="L1328" class="source_line" href="#L1328">1328</a>
<a id="L1329" class="source_line" href="#L1329">1329</a>
<a id="L1330" class="source_line" href="#L1330">1330</a>
<a id="L1331" class="source_line" href="#L1331">1331</a>
<a id="L1332" class="source_line" href="#L1332">1332</a>
<a id="L1333" class="source_line" href="#L1333">1333</a>
<a id="L1334" class="source_line" href="#L1334">1334</a>
<a id="L1335" class="source_line" href="#L1335">1335</a>
<a id="L1336" class="source_line" href="#L1336">1336</a>
<a id="L1337" class="source_line" href="#L1337">1337</a>
<a id="L1338" class="source_line" href="#L1338">1338</a>
<a id="L1339" class="source_line" href="#L1339">1339</a>
<a id="L1340" class="source_line" href="#L1340">1340</a>
<a id="L1341" class="source_line" href="#L1341">1341</a>
<a id="L1342" class="source_line" href="#L1342">1342</a>
<a id="L1343" class="source_line" href="#L1343">1343</a>
<a id="L1344" class="source_line" href="#L1344">1344</a>
<a id="L1345" class="source_line" href="#L1345">1345</a>
<a id="L1346" class="source_line" href="#L1346">1346</a>
<a id="L1347" class="source_line" href="#L1347">1347</a>
<a id="L1348" class="source_line" href="#L1348">1348</a>
<a id="L1349" class="source_line" href="#L1349">1349</a>
<a id="L1350" class="source_line" href="#L1350">1350</a>
<a id="L1351" class="source_line" href="#L1351">1351</a>
<a id="L1352" class="source_line" href="#L1352">1352</a>
<a id="L1353" class="source_line" href="#L1353">1353</a>
<a id="L1354" class="source_line" href="#L1354">1354</a>
<a id="L1355" class="source_line" href="#L1355">1355</a>
<a id="L1356" class="source_line" href="#L1356">1356</a>
<a id="L1357" class="source_line" href="#L1357">1357</a>
<a id="L1358" class="source_line" href="#L1358">1358</a>
<a id="L1359" class="source_line" href="#L1359">1359</a>
<a id="L1360" class="source_line" href="#L1360">1360</a>
<a id="L1361" class="source_line" href="#L1361">1361</a>
<a id="L1362" class="source_line" href="#L1362">1362</a>
<a id="L1363" class="source_line" href="#L1363">1363</a>
<a id="L1364" class="source_line" href="#L1364">1364</a>
<a id="L1365" class="source_line" href="#L1365">1365</a>
<a id="L1366" class="source_line" href="#L1366">1366</a>
<a id="L1367" class="source_line" href="#L1367">1367</a>
<a id="L1368" class="source_line" href="#L1368">1368</a>
<a id="L1369" class="source_line" href="#L1369">1369</a>
<a id="L1370" class="source_line" href="#L1370">1370</a>
<a id="L1371" class="source_line" href="#L1371">1371</a>
<a id="L1372" class="source_line" href="#L1372">1372</a>
<a id="L1373" class="source_line" href="#L1373">1373</a>
<a id="L1374" class="source_line" href="#L1374">1374</a>
<a id="L1375" class="source_line" href="#L1375">1375</a>
<a id="L1376" class="source_line" href="#L1376">1376</a>
<a id="L1377" class="source_line" href="#L1377">1377</a>
<a id="L1378" class="source_line" href="#L1378">1378</a>
<a id="L1379" class="source_line" href="#L1379">1379</a>
<a id="L1380" class="source_line" href="#L1380">1380</a>
<a id="L1381" class="source_line" href="#L1381">1381</a>
<a id="L1382" class="source_line" href="#L1382">1382</a>
<a id="L1383" class="source_line" href="#L1383">1383</a>
<a id="L1384" class="source_line" href="#L1384">1384</a>
<a id="L1385" class="source_line" href="#L1385">1385</a>
<a id="L1386" class="source_line" href="#L1386">1386</a>
<a id="L1387" class="source_line" href="#L1387">1387</a>
<a id="L1388" class="source_line" href="#L1388">1388</a>
<a id="L1389" class="source_line" href="#L1389">1389</a>
<a id="L1390" class="source_line" href="#L1390">1390</a>
<a id="L1391" class="source_line" href="#L1391">1391</a>
<a id="L1392" class="source_line" href="#L1392">1392</a>
<a id="L1393" class="source_line" href="#L1393">1393</a>
<a id="L1394" class="source_line" href="#L1394">1394</a>
<a id="L1395" class="source_line" href="#L1395">1395</a>
<a id="L1396" class="source_line" href="#L1396">1396</a>
<a id="L1397" class="source_line" href="#L1397">1397</a>
<a id="L1398" class="source_line" href="#L1398">1398</a>
<a id="L1399" class="source_line" href="#L1399">1399</a>
<a id="L1400" class="source_line" href="#L1400">1400</a>
<a id="L1401" class="source_line" href="#L1401">1401</a>
<a id="L1402" class="source_line" href="#L1402">1402</a>
<a id="L1403" class="source_line" href="#L1403">1403</a>
<a id="L1404" class="source_line" href="#L1404">1404</a>
<a id="L1405" class="source_line" href="#L1405">1405</a>
<a id="L1406" class="source_line" href="#L1406">1406</a>
<a id="L1407" class="source_line" href="#L1407">1407</a>
<a id="L1408" class="source_line" href="#L1408">1408</a>
<a id="L1409" class="source_line" href="#L1409">1409</a>
<a id="L1410" class="source_line" href="#L1410">1410</a>
<a id="L1411" class="source_line" href="#L1411">1411</a>
<a id="L1412" class="source_line" href="#L1412">1412</a>
<a id="L1413" class="source_line" href="#L1413">1413</a>
<a id="L1414" class="source_line" href="#L1414">1414</a>
<a id="L1415" class="source_line" href="#L1415">1415</a>
<a id="L1416" class="source_line" href="#L1416">1416</a>
<a id="L1417" class="source_line" href="#L1417">1417</a>
<a id="L1418" class="source_line" href="#L1418">1418</a>
<a id="L1419" class="source_line" href="#L1419">1419</a>
<a id="L1420" class="source_line" href="#L1420">1420</a>
<a id="L1421" class="source_line" href="#L1421">1421</a>
<a id="L1422" class="source_line" href="#L1422">1422</a>
<a id="L1423" class="source_line" href="#L1423">1423</a>
<a id="L1424" class="source_line" href="#L1424">1424</a>
<a id="L1425" class="source_line" href="#L1425">1425</a>
<a id="L1426" class="source_line" href="#L1426">1426</a>
<a id="L1427" class="source_line" href="#L1427">1427</a>
<a id="L1428" class="source_line" href="#L1428">1428</a>
<a id="L1429" class="source_line" href="#L1429">1429</a>
<a id="L1430" class="source_line" href="#L1430">1430</a>
<a id="L1431" class="source_line" href="#L1431">1431</a>
<a id="L1432" class="source_line" href="#L1432">1432</a>
<a id="L1433" class="source_line" href="#L1433">1433</a>
<a id="L1434" class="source_line" href="#L1434">1434</a>
<a id="L1435" class="source_line" href="#L1435">1435</a>
<a id="L1436" class="source_line" href="#L1436">1436</a>
<a id="L1437" class="source_line" href="#L1437">1437</a>
<a id="L1438" class="source_line" href="#L1438">1438</a>
<a id="L1439" class="source_line" href="#L1439">1439</a>
<a id="L1440" class="source_line" href="#L1440">1440</a>
<a id="L1441" class="source_line" href="#L1441">1441</a>
<a id="L1442" class="source_line" href="#L1442">1442</a>
<a id="L1443" class="source_line" href="#L1443">1443</a>
<a id="L1444" class="source_line" href="#L1444">1444</a>
<a id="L1445" class="source_line" href="#L1445">1445</a>
<a id="L1446" class="source_line" href="#L1446">1446</a>
<a id="L1447" class="source_line" href="#L1447">1447</a>
<a id="L1448" class="source_line" href="#L1448">1448</a>
<a id="L1449" class="source_line" href="#L1449">1449</a>
<a id="L1450" class="source_line" href="#L1450">1450</a>
<a id="L1451" class="source_line" href="#L1451">1451</a>
<a id="L1452" class="source_line" href="#L1452">1452</a>
<a id="L1453" class="source_line" href="#L1453">1453</a>
<a id="L1454" class="source_line" href="#L1454">1454</a>
<a id="L1455" class="source_line" href="#L1455">1455</a>
<a id="L1456" class="source_line" href="#L1456">1456</a>
<a id="L1457" class="source_line" href="#L1457">1457</a>
<a id="L1458" class="source_line" href="#L1458">1458</a>
<a id="L1459" class="source_line" href="#L1459">1459</a>
<a id="L1460" class="source_line" href="#L1460">1460</a>
<a id="L1461" class="source_line" href="#L1461">1461</a>
<a id="L1462" class="source_line" href="#L1462">1462</a>
<a id="L1463" class="source_line" href="#L1463">1463</a>
<a id="L1464" class="source_line" href="#L1464">1464</a>
<a id="L1465" class="source_line" href="#L1465">1465</a>
<a id="L1466" class="source_line" href="#L1466">1466</a>
<a id="L1467" class="source_line" href="#L1467">1467</a>
<a id="L1468" class="source_line" href="#L1468">1468</a>
<a id="L1469" class="source_line" href="#L1469">1469</a>
<a id="L1470" class="source_line" href="#L1470">1470</a>
<a id="L1471" class="source_line" href="#L1471">1471</a>
<a id="L1472" class="source_line" href="#L1472">1472</a>
<a id="L1473" class="source_line" href="#L1473">1473</a>
<a id="L1474" class="source_line" href="#L1474">1474</a>
<a id="L1475" class="source_line" href="#L1475">1475</a>
<a id="L1476" class="source_line" href="#L1476">1476</a>
<a id="L1477" class="source_line" href="#L1477">1477</a>
<a id="L1478" class="source_line" href="#L1478">1478</a>
<a id="L1479" class="source_line" href="#L1479">1479</a>
<a id="L1480" class="source_line" href="#L1480">1480</a>
<a id="L1481" class="source_line" href="#L1481">1481</a>
<a id="L1482" class="source_line" href="#L1482">1482</a>
<a id="L1483" class="source_line" href="#L1483">1483</a>
<a id="L1484" class="source_line" href="#L1484">1484</a>
<a id="L1485" class="source_line" href="#L1485">1485</a>
<a id="L1486" class="source_line" href="#L1486">1486</a>
<a id="L1487" class="source_line" href="#L1487">1487</a>
<a id="L1488" class="source_line" href="#L1488">1488</a>
<a id="L1489" class="source_line" href="#L1489">1489</a>
<a id="L1490" class="source_line" href="#L1490">1490</a>
<a id="L1491" class="source_line" href="#L1491">1491</a>
<a id="L1492" class="source_line" href="#L1492">1492</a>
<a id="L1493" class="source_line" href="#L1493">1493</a>
<a id="L1494" class="source_line" href="#L1494">1494</a>
<a id="L1495" class="source_line" href="#L1495">1495</a>
<a id="L1496" class="source_line" href="#L1496">1496</a>
<a id="L1497" class="source_line" href="#L1497">1497</a>
<a id="L1498" class="source_line" href="#L1498">1498</a>
<a id="L1499" class="source_line" href="#L1499">1499</a>
<a id="L1500" class="source_line" href="#L1500">1500</a>
<a id="L1501" class="source_line" href="#L1501">1501</a>
<a id="L1502" class="source_line" href="#L1502">1502</a>
<a id="L1503" class="source_line" href="#L1503">1503</a>
<a id="L1504" class="source_line" href="#L1504">1504</a>
<a id="L1505" class="source_line" href="#L1505">1505</a>
<a id="L1506" class="source_line" href="#L1506">1506</a>
<a id="L1507" class="source_line" href="#L1507">1507</a>
<a id="L1508" class="source_line" href="#L1508">1508</a>
<a id="L1509" class="source_line" href="#L1509">1509</a>
<a id="L1510" class="source_line" href="#L1510">1510</a>
<a id="L1511" class="source_line" href="#L1511">1511</a>
<a id="L1512" class="source_line" href="#L1512">1512</a>
<a id="L1513" class="source_line" href="#L1513">1513</a>
<a id="L1514" class="source_line" href="#L1514">1514</a>
<a id="L1515" class="source_line" href="#L1515">1515</a>
<a id="L1516" class="source_line" href="#L1516">1516</a>
<a id="L1517" class="source_line" href="#L1517">1517</a>
<a id="L1518" class="source_line" href="#L1518">1518</a>
<a id="L1519" class="source_line" href="#L1519">1519</a>
<a id="L1520" class="source_line" href="#L1520">1520</a>
<a id="L1521" class="source_line" href="#L1521">1521</a>
<a id="L1522" class="source_line" href="#L1522">1522</a>
<a id="L1523" class="source_line" href="#L1523">1523</a>
<a id="L1524" class="source_line" href="#L1524">1524</a>
<a id="L1525" class="source_line" href="#L1525">1525</a>
<a id="L1526" class="source_line" href="#L1526">1526</a>
<a id="L1527" class="source_line" href="#L1527">1527</a>
<a id="L1528" class="source_line" href="#L1528">1528</a>
<a id="L1529" class="source_line" href="#L1529">1529</a>
<a id="L1530" class="source_line" href="#L1530">1530</a>
<a id="L1531" class="source_line" href="#L1531">1531</a>
<a id="L1532" class="source_line" href="#L1532">1532</a>
<a id="L1533" class="source_line" href="#L1533">1533</a>
<a id="L1534" class="source_line" href="#L1534">1534</a>
<a id="L1535" class="source_line" href="#L1535">1535</a>
<a id="L1536" class="source_line" href="#L1536">1536</a>
<a id="L1537" class="source_line" href="#L1537">1537</a>
<a id="L1538" class="source_line" href="#L1538">1538</a>
<a id="L1539" class="source_line" href="#L1539">1539</a>
<a id="L1540" class="source_line" href="#L1540">1540</a>
<a id="L1541" class="source_line" href="#L1541">1541</a>
<a id="L1542" class="source_line" href="#L1542">1542</a>
<a id="L1543" class="source_line" href="#L1543">1543</a>
<a id="L1544" class="source_line" href="#L1544">1544</a>
<a id="L1545" class="source_line" href="#L1545">1545</a>
<a id="L1546" class="source_line" href="#L1546">1546</a>
<a id="L1547" class="source_line" href="#L1547">1547</a>
<a id="L1548" class="source_line" href="#L1548">1548</a>
<a id="L1549" class="source_line" href="#L1549">1549</a>
<a id="L1550" class="source_line" href="#L1550">1550</a>
<a id="L1551" class="source_line" href="#L1551">1551</a>
<a id="L1552" class="source_line" href="#L1552">1552</a>
<a id="L1553" class="source_line" href="#L1553">1553</a>
<a id="L1554" class="source_line" href="#L1554">1554</a>
<a id="L1555" class="source_line" href="#L1555">1555</a>
<a id="L1556" class="source_line" href="#L1556">1556</a>
<a id="L1557" class="source_line" href="#L1557">1557</a>
<a id="L1558" class="source_line" href="#L1558">1558</a>
<a id="L1559" class="source_line" href="#L1559">1559</a>
<a id="L1560" class="source_line" href="#L1560">1560</a>
<a id="L1561" class="source_line" href="#L1561">1561</a>
<a id="L1562" class="source_line" href="#L1562">1562</a>
<a id="L1563" class="source_line" href="#L1563">1563</a>
<a id="L1564" class="source_line" href="#L1564">1564</a>
<a id="L1565" class="source_line" href="#L1565">1565</a>
<a id="L1566" class="source_line" href="#L1566">1566</a>
<a id="L1567" class="source_line" href="#L1567">1567</a>
<a id="L1568" class="source_line" href="#L1568">1568</a>
<a id="L1569" class="source_line" href="#L1569">1569</a>
<a id="L1570" class="source_line" href="#L1570">1570</a>
<a id="L1571" class="source_line" href="#L1571">1571</a>
<a id="L1572" class="source_line" href="#L1572">1572</a>
<a id="L1573" class="source_line" href="#L1573">1573</a>
<a id="L1574" class="source_line" href="#L1574">1574</a>
<a id="L1575" class="source_line" href="#L1575">1575</a>
<a id="L1576" class="source_line" href="#L1576">1576</a>
<a id="L1577" class="source_line" href="#L1577">1577</a>
<a id="L1578" class="source_line" href="#L1578">1578</a>
<a id="L1579" class="source_line" href="#L1579">1579</a>
<a id="L1580" class="source_line" href="#L1580">1580</a>
<a id="L1581" class="source_line" href="#L1581">1581</a>
<a id="L1582" class="source_line" href="#L1582">1582</a>
<a id="L1583" class="source_line" href="#L1583">1583</a>
<a id="L1584" class="source_line" href="#L1584">1584</a>
<a id="L1585" class="source_line" href="#L1585">1585</a>
<a id="L1586" class="source_line" href="#L1586">1586</a>
<a id="L1587" class="source_line" href="#L1587">1587</a>
<a id="L1588" class="source_line" href="#L1588">1588</a>
<a id="L1589" class="source_line" href="#L1589">1589</a>
<a id="L1590" class="source_line" href="#L1590">1590</a>
<a id="L1591" class="source_line" href="#L1591">1591</a>
<a id="L1592" class="source_line" href="#L1592">1592</a>
<a id="L1593" class="source_line" href="#L1593">1593</a>
<a id="L1594" class="source_line" href="#L1594">1594</a>
<a id="L1595" class="source_line" href="#L1595">1595</a>
<a id="L1596" class="source_line" href="#L1596">1596</a>
<a id="L1597" class="source_line" href="#L1597">1597</a>
<a id="L1598" class="source_line" href="#L1598">1598</a>
<a id="L1599" class="source_line" href="#L1599">1599</a>
<a id="L1600" class="source_line" href="#L1600">1600</a>
<a id="L1601" class="source_line" href="#L1601">1601</a>
<a id="L1602" class="source_line" href="#L1602">1602</a>
<a id="L1603" class="source_line" href="#L1603">1603</a>
<a id="L1604" class="source_line" href="#L1604">1604</a>
<a id="L1605" class="source_line" href="#L1605">1605</a>
<a id="L1606" class="source_line" href="#L1606">1606</a>
<a id="L1607" class="source_line" href="#L1607">1607</a>
<a id="L1608" class="source_line" href="#L1608">1608</a>
<a id="L1609" class="source_line" href="#L1609">1609</a>
<a id="L1610" class="source_line" href="#L1610">1610</a>
<a id="L1611" class="source_line" href="#L1611">1611</a>
<a id="L1612" class="source_line" href="#L1612">1612</a>
<a id="L1613" class="source_line" href="#L1613">1613</a>
<a id="L1614" class="source_line" href="#L1614">1614</a>
<a id="L1615" class="source_line" href="#L1615">1615</a>
<a id="L1616" class="source_line" href="#L1616">1616</a>
<a id="L1617" class="source_line" href="#L1617">1617</a>
<a id="L1618" class="source_line" href="#L1618">1618</a>
<a id="L1619" class="source_line" href="#L1619">1619</a>
<a id="L1620" class="source_line" href="#L1620">1620</a>
<a id="L1621" class="source_line" href="#L1621">1621</a>
<a id="L1622" class="source_line" href="#L1622">1622</a>
<a id="L1623" class="source_line" href="#L1623">1623</a>
<a id="L1624" class="source_line" href="#L1624">1624</a>
<a id="L1625" class="source_line" href="#L1625">1625</a>
<a id="L1626" class="source_line" href="#L1626">1626</a>
<a id="L1627" class="source_line" href="#L1627">1627</a>
<a id="L1628" class="source_line" href="#L1628">1628</a>
<a id="L1629" class="source_line" href="#L1629">1629</a>
<a id="L1630" class="source_line" href="#L1630">1630</a>
<a id="L1631" class="source_line" href="#L1631">1631</a>
<a id="L1632" class="source_line" href="#L1632">1632</a>
<a id="L1633" class="source_line" href="#L1633">1633</a>
<a id="L1634" class="source_line" href="#L1634">1634</a>
<a id="L1635" class="source_line" href="#L1635">1635</a>
<a id="L1636" class="source_line" href="#L1636">1636</a>
<a id="L1637" class="source_line" href="#L1637">1637</a>
<a id="L1638" class="source_line" href="#L1638">1638</a>
<a id="L1639" class="source_line" href="#L1639">1639</a>
<a id="L1640" class="source_line" href="#L1640">1640</a>
<a id="L1641" class="source_line" href="#L1641">1641</a>
<a id="L1642" class="source_line" href="#L1642">1642</a>
<a id="L1643" class="source_line" href="#L1643">1643</a>
<a id="L1644" class="source_line" href="#L1644">1644</a>
<a id="L1645" class="source_line" href="#L1645">1645</a>
<a id="L1646" class="source_line" href="#L1646">1646</a>
<a id="L1647" class="source_line" href="#L1647">1647</a>
<a id="L1648" class="source_line" href="#L1648">1648</a>
<a id="L1649" class="source_line" href="#L1649">1649</a>
<a id="L1650" class="source_line" href="#L1650">1650</a>
<a id="L1651" class="source_line" href="#L1651">1651</a>
<a id="L1652" class="source_line" href="#L1652">1652</a>
<a id="L1653" class="source_line" href="#L1653">1653</a>
<a id="L1654" class="source_line" href="#L1654">1654</a>
<a id="L1655" class="source_line" href="#L1655">1655</a>
<a id="L1656" class="source_line" href="#L1656">1656</a>
<a id="L1657" class="source_line" href="#L1657">1657</a>
<a id="L1658" class="source_line" href="#L1658">1658</a>
<a id="L1659" class="source_line" href="#L1659">1659</a>
<a id="L1660" class="source_line" href="#L1660">1660</a>
<a id="L1661" class="source_line" href="#L1661">1661</a>
<a id="L1662" class="source_line" href="#L1662">1662</a>
<a id="L1663" class="source_line" href="#L1663">1663</a>
<a id="L1664" class="source_line" href="#L1664">1664</a>
<a id="L1665" class="source_line" href="#L1665">1665</a>
<a id="L1666" class="source_line" href="#L1666">1666</a>
<a id="L1667" class="source_line" href="#L1667">1667</a>
<a id="L1668" class="source_line" href="#L1668">1668</a>
<a id="L1669" class="source_line" href="#L1669">1669</a>
<a id="L1670" class="source_line" href="#L1670">1670</a>
<a id="L1671" class="source_line" href="#L1671">1671</a>
<a id="L1672" class="source_line" href="#L1672">1672</a>
<a id="L1673" class="source_line" href="#L1673">1673</a>
<a id="L1674" class="source_line" href="#L1674">1674</a>
<a id="L1675" class="source_line" href="#L1675">1675</a>
<a id="L1676" class="source_line" href="#L1676">1676</a>
<a id="L1677" class="source_line" href="#L1677">1677</a>
<a id="L1678" class="source_line" href="#L1678">1678</a>
<a id="L1679" class="source_line" href="#L1679">1679</a>
<a id="L1680" class="source_line" href="#L1680">1680</a>
<a id="L1681" class="source_line" href="#L1681">1681</a>
<a id="L1682" class="source_line" href="#L1682">1682</a>
<a id="L1683" class="source_line" href="#L1683">1683</a>
<a id="L1684" class="source_line" href="#L1684">1684</a>
<a id="L1685" class="source_line" href="#L1685">1685</a>
<a id="L1686" class="source_line" href="#L1686">1686</a>
<a id="L1687" class="source_line" href="#L1687">1687</a>
<a id="L1688" class="source_line" href="#L1688">1688</a>
<a id="L1689" class="source_line" href="#L1689">1689</a>
<a id="L1690" class="source_line" href="#L1690">1690</a>
<a id="L1691" class="source_line" href="#L1691">1691</a>
<a id="L1692" class="source_line" href="#L1692">1692</a>
<a id="L1693" class="source_line" href="#L1693">1693</a>
<a id="L1694" class="source_line" href="#L1694">1694</a>
<a id="L1695" class="source_line" href="#L1695">1695</a>
<a id="L1696" class="source_line" href="#L1696">1696</a>
<a id="L1697" class="source_line" href="#L1697">1697</a>
<a id="L1698" class="source_line" href="#L1698">1698</a>
<a id="L1699" class="source_line" href="#L1699">1699</a>
<a id="L1700" class="source_line" href="#L1700">1700</a>
<a id="L1701" class="source_line" href="#L1701">1701</a>
<a id="L1702" class="source_line" href="#L1702">1702</a>
<a id="L1703" class="source_line" href="#L1703">1703</a>
<a id="L1704" class="source_line" href="#L1704">1704</a>
<a id="L1705" class="source_line" href="#L1705">1705</a>
<a id="L1706" class="source_line" href="#L1706">1706</a>
<a id="L1707" class="source_line" href="#L1707">1707</a>
<a id="L1708" class="source_line" href="#L1708">1708</a>
<a id="L1709" class="source_line" href="#L1709">1709</a>
<a id="L1710" class="source_line" href="#L1710">1710</a>
<a id="L1711" class="source_line" href="#L1711">1711</a>
<a id="L1712" class="source_line" href="#L1712">1712</a>
<a id="L1713" class="source_line" href="#L1713">1713</a>
<a id="L1714" class="source_line" href="#L1714">1714</a>
<a id="L1715" class="source_line" href="#L1715">1715</a>
<a id="L1716" class="source_line" href="#L1716">1716</a>
<a id="L1717" class="source_line" href="#L1717">1717</a>
<a id="L1718" class="source_line" href="#L1718">1718</a>
<a id="L1719" class="source_line" href="#L1719">1719</a>
<a id="L1720" class="source_line" href="#L1720">1720</a>
<a id="L1721" class="source_line" href="#L1721">1721</a>
<a id="L1722" class="source_line" href="#L1722">1722</a>
<a id="L1723" class="source_line" href="#L1723">1723</a>
<a id="L1724" class="source_line" href="#L1724">1724</a>
<a id="L1725" class="source_line" href="#L1725">1725</a>
<a id="L1726" class="source_line" href="#L1726">1726</a>
<a id="L1727" class="source_line" href="#L1727">1727</a>
<a id="L1728" class="source_line" href="#L1728">1728</a>
<a id="L1729" class="source_line" href="#L1729">1729</a>
<a id="L1730" class="source_line" href="#L1730">1730</a>
<a id="L1731" class="source_line" href="#L1731">1731</a>
<a id="L1732" class="source_line" href="#L1732">1732</a>
<a id="L1733" class="source_line" href="#L1733">1733</a>
<a id="L1734" class="source_line" href="#L1734">1734</a>
<a id="L1735" class="source_line" href="#L1735">1735</a>
<a id="L1736" class="source_line" href="#L1736">1736</a>
<a id="L1737" class="source_line" href="#L1737">1737</a>
<a id="L1738" class="source_line" href="#L1738">1738</a>
<a id="L1739" class="source_line" href="#L1739">1739</a>
<a id="L1740" class="source_line" href="#L1740">1740</a>
<a id="L1741" class="source_line" href="#L1741">1741</a>
<a id="L1742" class="source_line" href="#L1742">1742</a>
<a id="L1743" class="source_line" href="#L1743">1743</a>
<a id="L1744" class="source_line" href="#L1744">1744</a>
<a id="L1745" class="source_line" href="#L1745">1745</a>
<a id="L1746" class="source_line" href="#L1746">1746</a>
<a id="L1747" class="source_line" href="#L1747">1747</a>
<a id="L1748" class="source_line" href="#L1748">1748</a>
<a id="L1749" class="source_line" href="#L1749">1749</a>
<a id="L1750" class="source_line" href="#L1750">1750</a>
<a id="L1751" class="source_line" href="#L1751">1751</a>
<a id="L1752" class="source_line" href="#L1752">1752</a>
<a id="L1753" class="source_line" href="#L1753">1753</a>
<a id="L1754" class="source_line" href="#L1754">1754</a>
<a id="L1755" class="source_line" href="#L1755">1755</a>
<a id="L1756" class="source_line" href="#L1756">1756</a>
<a id="L1757" class="source_line" href="#L1757">1757</a>
<a id="L1758" class="source_line" href="#L1758">1758</a>
<a id="L1759" class="source_line" href="#L1759">1759</a>
<a id="L1760" class="source_line" href="#L1760">1760</a>
<a id="L1761" class="source_line" href="#L1761">1761</a>
<a id="L1762" class="source_line" href="#L1762">1762</a>
<a id="L1763" class="source_line" href="#L1763">1763</a>
<a id="L1764" class="source_line" href="#L1764">1764</a>
<a id="L1765" class="source_line" href="#L1765">1765</a>
<a id="L1766" class="source_line" href="#L1766">1766</a>
<a id="L1767" class="source_line" href="#L1767">1767</a>
<a id="L1768" class="source_line" href="#L1768">1768</a>
<a id="L1769" class="source_line" href="#L1769">1769</a>
<a id="L1770" class="source_line" href="#L1770">1770</a>
<a id="L1771" class="source_line" href="#L1771">1771</a>
<a id="L1772" class="source_line" href="#L1772">1772</a>
<a id="L1773" class="source_line" href="#L1773">1773</a>
<a id="L1774" class="source_line" href="#L1774">1774</a>
<a id="L1775" class="source_line" href="#L1775">1775</a>
<a id="L1776" class="source_line" href="#L1776">1776</a>
<a id="L1777" class="source_line" href="#L1777">1777</a>
<a id="L1778" class="source_line" href="#L1778">1778</a>
<a id="L1779" class="source_line" href="#L1779">1779</a>
<a id="L1780" class="source_line" href="#L1780">1780</a>
<a id="L1781" class="source_line" href="#L1781">1781</a>
<a id="L1782" class="source_line" href="#L1782">1782</a>
<a id="L1783" class="source_line" href="#L1783">1783</a>
<a id="L1784" class="source_line" href="#L1784">1784</a>
<a id="L1785" class="source_line" href="#L1785">1785</a>
<a id="L1786" class="source_line" href="#L1786">1786</a>
<a id="L1787" class="source_line" href="#L1787">1787</a>
<a id="L1788" class="source_line" href="#L1788">1788</a>
<a id="L1789" class="source_line" href="#L1789">1789</a>
<a id="L1790" class="source_line" href="#L1790">1790</a>
<a id="L1791" class="source_line" href="#L1791">1791</a>
<a id="L1792" class="source_line" href="#L1792">1792</a>
<a id="L1793" class="source_line" href="#L1793">1793</a>
<a id="L1794" class="source_line" href="#L1794">1794</a>
<a id="L1795" class="source_line" href="#L1795">1795</a>
<a id="L1796" class="source_line" href="#L1796">1796</a>
<a id="L1797" class="source_line" href="#L1797">1797</a>
<a id="L1798" class="source_line" href="#L1798">1798</a>
<a id="L1799" class="source_line" href="#L1799">1799</a>
<a id="L1800" class="source_line" href="#L1800">1800</a>
<a id="L1801" class="source_line" href="#L1801">1801</a>
<a id="L1802" class="source_line" href="#L1802">1802</a>
<a id="L1803" class="source_line" href="#L1803">1803</a>
<a id="L1804" class="source_line" href="#L1804">1804</a>
<a id="L1805" class="source_line" href="#L1805">1805</a>
<a id="L1806" class="source_line" href="#L1806">1806</a>
<a id="L1807" class="source_line" href="#L1807">1807</a>
<a id="L1808" class="source_line" href="#L1808">1808</a>
<a id="L1809" class="source_line" href="#L1809">1809</a>
<a id="L1810" class="source_line" href="#L1810">1810</a>
<a id="L1811" class="source_line" href="#L1811">1811</a>
<a id="L1812" class="source_line" href="#L1812">1812</a>
<a id="L1813" class="source_line" href="#L1813">1813</a>
<a id="L1814" class="source_line" href="#L1814">1814</a>
<a id="L1815" class="source_line" href="#L1815">1815</a>
<a id="L1816" class="source_line" href="#L1816">1816</a>
<a id="L1817" class="source_line" href="#L1817">1817</a>
<a id="L1818" class="source_line" href="#L1818">1818</a>
<a id="L1819" class="source_line" href="#L1819">1819</a>
<a id="L1820" class="source_line" href="#L1820">1820</a>
<a id="L1821" class="source_line" href="#L1821">1821</a>
<a id="L1822" class="source_line" href="#L1822">1822</a>
<a id="L1823" class="source_line" href="#L1823">1823</a>
<a id="L1824" class="source_line" href="#L1824">1824</a>
<a id="L1825" class="source_line" href="#L1825">1825</a>
<a id="L1826" class="source_line" href="#L1826">1826</a>
<a id="L1827" class="source_line" href="#L1827">1827</a>
<a id="L1828" class="source_line" href="#L1828">1828</a>
<a id="L1829" class="source_line" href="#L1829">1829</a>
<a id="L1830" class="source_line" href="#L1830">1830</a>
<a id="L1831" class="source_line" href="#L1831">1831</a>
<a id="L1832" class="source_line" href="#L1832">1832</a>
<a id="L1833" class="source_line" href="#L1833">1833</a>
<a id="L1834" class="source_line" href="#L1834">1834</a>
<a id="L1835" class="source_line" href="#L1835">1835</a>
<a id="L1836" class="source_line" href="#L1836">1836</a>
<a id="L1837" class="source_line" href="#L1837">1837</a>
<a id="L1838" class="source_line" href="#L1838">1838</a>
<a id="L1839" class="source_line" href="#L1839">1839</a>
<a id="L1840" class="source_line" href="#L1840">1840</a>
<a id="L1841" class="source_line" href="#L1841">1841</a>
<a id="L1842" class="source_line" href="#L1842">1842</a>
<a id="L1843" class="source_line" href="#L1843">1843</a>
<a id="L1844" class="source_line" href="#L1844">1844</a>
<a id="L1845" class="source_line" href="#L1845">1845</a>
<a id="L1846" class="source_line" href="#L1846">1846</a>
<a id="L1847" class="source_line" href="#L1847">1847</a>
<a id="L1848" class="source_line" href="#L1848">1848</a>
<a id="L1849" class="source_line" href="#L1849">1849</a>
<a id="L1850" class="source_line" href="#L1850">1850</a>
<a id="L1851" class="source_line" href="#L1851">1851</a>
<a id="L1852" class="source_line" href="#L1852">1852</a>
<a id="L1853" class="source_line" href="#L1853">1853</a>
<a id="L1854" class="source_line" href="#L1854">1854</a>
<a id="L1855" class="source_line" href="#L1855">1855</a>
<a id="L1856" class="source_line" href="#L1856">1856</a>
<a id="L1857" class="source_line" href="#L1857">1857</a>
<a id="L1858" class="source_line" href="#L1858">1858</a>
<a id="L1859" class="source_line" href="#L1859">1859</a>
<a id="L1860" class="source_line" href="#L1860">1860</a>
<a id="L1861" class="source_line" href="#L1861">1861</a>
<a id="L1862" class="source_line" href="#L1862">1862</a>
<a id="L1863" class="source_line" href="#L1863">1863</a>
<a id="L1864" class="source_line" href="#L1864">1864</a>
<a id="L1865" class="source_line" href="#L1865">1865</a>
<a id="L1866" class="source_line" href="#L1866">1866</a>
<a id="L1867" class="source_line" href="#L1867">1867</a>
<a id="L1868" class="source_line" href="#L1868">1868</a>
<a id="L1869" class="source_line" href="#L1869">1869</a>
<a id="L1870" class="source_line" href="#L1870">1870</a>
<a id="L1871" class="source_line" href="#L1871">1871</a>
<a id="L1872" class="source_line" href="#L1872">1872</a>
<a id="L1873" class="source_line" href="#L1873">1873</a>
<a id="L1874" class="source_line" href="#L1874">1874</a>
<a id="L1875" class="source_line" href="#L1875">1875</a>
<a id="L1876" class="source_line" href="#L1876">1876</a>
<a id="L1877" class="source_line" href="#L1877">1877</a>
<a id="L1878" class="source_line" href="#L1878">1878</a>
<a id="L1879" class="source_line" href="#L1879">1879</a>
<a id="L1880" class="source_line" href="#L1880">1880</a>
<a id="L1881" class="source_line" href="#L1881">1881</a>
<a id="L1882" class="source_line" href="#L1882">1882</a>
<a id="L1883" class="source_line" href="#L1883">1883</a>
<a id="L1884" class="source_line" href="#L1884">1884</a>
<a id="L1885" class="source_line" href="#L1885">1885</a>
<a id="L1886" class="source_line" href="#L1886">1886</a>
<a id="L1887" class="source_line" href="#L1887">1887</a>
<a id="L1888" class="source_line" href="#L1888">1888</a>
<a id="L1889" class="source_line" href="#L1889">1889</a>
<a id="L1890" class="source_line" href="#L1890">1890</a>
<a id="L1891" class="source_line" href="#L1891">1891</a>
<a id="L1892" class="source_line" href="#L1892">1892</a>
<a id="L1893" class="source_line" href="#L1893">1893</a>
<a id="L1894" class="source_line" href="#L1894">1894</a>
<a id="L1895" class="source_line" href="#L1895">1895</a>
<a id="L1896" class="source_line" href="#L1896">1896</a>
<a id="L1897" class="source_line" href="#L1897">1897</a>
<a id="L1898" class="source_line" href="#L1898">1898</a>
<a id="L1899" class="source_line" href="#L1899">1899</a>
<a id="L1900" class="source_line" href="#L1900">1900</a>
<a id="L1901" class="source_line" href="#L1901">1901</a>
<a id="L1902" class="source_line" href="#L1902">1902</a>
<a id="L1903" class="source_line" href="#L1903">1903</a>
<a id="L1904" class="source_line" href="#L1904">1904</a>
<a id="L1905" class="source_line" href="#L1905">1905</a>
<a id="L1906" class="source_line" href="#L1906">1906</a>
<a id="L1907" class="source_line" href="#L1907">1907</a>
<a id="L1908" class="source_line" href="#L1908">1908</a>
<a id="L1909" class="source_line" href="#L1909">1909</a>
<a id="L1910" class="source_line" href="#L1910">1910</a>
<a id="L1911" class="source_line" href="#L1911">1911</a>
<a id="L1912" class="source_line" href="#L1912">1912</a>
<a id="L1913" class="source_line" href="#L1913">1913</a>
<a id="L1914" class="source_line" href="#L1914">1914</a>
<a id="L1915" class="source_line" href="#L1915">1915</a>
<a id="L1916" class="source_line" href="#L1916">1916</a>
<a id="L1917" class="source_line" href="#L1917">1917</a>
<a id="L1918" class="source_line" href="#L1918">1918</a>
<a id="L1919" class="source_line" href="#L1919">1919</a>
<a id="L1920" class="source_line" href="#L1920">1920</a>
<a id="L1921" class="source_line" href="#L1921">1921</a>
<a id="L1922" class="source_line" href="#L1922">1922</a>
<a id="L1923" class="source_line" href="#L1923">1923</a>
<a id="L1924" class="source_line" href="#L1924">1924</a>
<a id="L1925" class="source_line" href="#L1925">1925</a>
<a id="L1926" class="source_line" href="#L1926">1926</a>
<a id="L1927" class="source_line" href="#L1927">1927</a>
<a id="L1928" class="source_line" href="#L1928">1928</a>
<a id="L1929" class="source_line" href="#L1929">1929</a>
<a id="L1930" class="source_line" href="#L1930">1930</a>
<a id="L1931" class="source_line" href="#L1931">1931</a>
<a id="L1932" class="source_line" href="#L1932">1932</a>
<a id="L1933" class="source_line" href="#L1933">1933</a>
<a id="L1934" class="source_line" href="#L1934">1934</a>
<a id="L1935" class="source_line" href="#L1935">1935</a>
<a id="L1936" class="source_line" href="#L1936">1936</a>
<a id="L1937" class="source_line" href="#L1937">1937</a>
<a id="L1938" class="source_line" href="#L1938">1938</a>
<a id="L1939" class="source_line" href="#L1939">1939</a>
<a id="L1940" class="source_line" href="#L1940">1940</a>
<a id="L1941" class="source_line" href="#L1941">1941</a>
<a id="L1942" class="source_line" href="#L1942">1942</a>
<a id="L1943" class="source_line" href="#L1943">1943</a>
<a id="L1944" class="source_line" href="#L1944">1944</a>
<a id="L1945" class="source_line" href="#L1945">1945</a>
<a id="L1946" class="source_line" href="#L1946">1946</a>
<a id="L1947" class="source_line" href="#L1947">1947</a>
<a id="L1948" class="source_line" href="#L1948">1948</a>
<a id="L1949" class="source_line" href="#L1949">1949</a>
<a id="L1950" class="source_line" href="#L1950">1950</a>
<a id="L1951" class="source_line" href="#L1951">1951</a>
<a id="L1952" class="source_line" href="#L1952">1952</a>
<a id="L1953" class="source_line" href="#L1953">1953</a>
<a id="L1954" class="source_line" href="#L1954">1954</a>
<a id="L1955" class="source_line" href="#L1955">1955</a>
<a id="L1956" class="source_line" href="#L1956">1956</a>
<a id="L1957" class="source_line" href="#L1957">1957</a>
<a id="L1958" class="source_line" href="#L1958">1958</a>
<a id="L1959" class="source_line" href="#L1959">1959</a>
<a id="L1960" class="source_line" href="#L1960">1960</a>
<a id="L1961" class="source_line" href="#L1961">1961</a>
<a id="L1962" class="source_line" href="#L1962">1962</a>
<a id="L1963" class="source_line" href="#L1963">1963</a>
<a id="L1964" class="source_line" href="#L1964">1964</a>
<a id="L1965" class="source_line" href="#L1965">1965</a>
<a id="L1966" class="source_line" href="#L1966">1966</a>
<a id="L1967" class="source_line" href="#L1967">1967</a>
<a id="L1968" class="source_line" href="#L1968">1968</a>
<a id="L1969" class="source_line" href="#L1969">1969</a>
<a id="L1970" class="source_line" href="#L1970">1970</a>
<a id="L1971" class="source_line" href="#L1971">1971</a>
<a id="L1972" class="source_line" href="#L1972">1972</a>
<a id="L1973" class="source_line" href="#L1973">1973</a>
<a id="L1974" class="source_line" href="#L1974">1974</a>
<a id="L1975" class="source_line" href="#L1975">1975</a>
<a id="L1976" class="source_line" href="#L1976">1976</a>
<a id="L1977" class="source_line" href="#L1977">1977</a>
<a id="L1978" class="source_line" href="#L1978">1978</a>
<a id="L1979" class="source_line" href="#L1979">1979</a>
<a id="L1980" class="source_line" href="#L1980">1980</a>
<a id="L1981" class="source_line" href="#L1981">1981</a>
<a id="L1982" class="source_line" href="#L1982">1982</a>
<a id="L1983" class="source_line" href="#L1983">1983</a>
<a id="L1984" class="source_line" href="#L1984">1984</a>
<a id="L1985" class="source_line" href="#L1985">1985</a>
<a id="L1986" class="source_line" href="#L1986">1986</a>
<a id="L1987" class="source_line" href="#L1987">1987</a>
<a id="L1988" class="source_line" href="#L1988">1988</a>
<a id="L1989" class="source_line" href="#L1989">1989</a>
<a id="L1990" class="source_line" href="#L1990">1990</a>
<a id="L1991" class="source_line" href="#L1991">1991</a>
<a id="L1992" class="source_line" href="#L1992">1992</a>
<a id="L1993" class="source_line" href="#L1993">1993</a>
<a id="L1994" class="source_line" href="#L1994">1994</a>
<a id="L1995" class="source_line" href="#L1995">1995</a>
<a id="L1996" class="source_line" href="#L1996">1996</a>
<a id="L1997" class="source_line" href="#L1997">1997</a>
<a id="L1998" class="source_line" href="#L1998">1998</a>
<a id="L1999" class="source_line" href="#L1999">1999</a>
<a id="L2000" class="source_line" href="#L2000">2000</a>
<a id="L2001" class="source_line" href="#L2001">2001</a>
<a id="L2002" class="source_line" href="#L2002">2002</a>
<a id="L2003" class="source_line" href="#L2003">2003</a>
<a id="L2004" class="source_line" href="#L2004">2004</a>
<a id="L2005" class="source_line" href="#L2005">2005</a>
<a id="L2006" class="source_line" href="#L2006">2006</a>
<a id="L2007" class="source_line" href="#L2007">2007</a>
<a id="L2008" class="source_line" href="#L2008">2008</a>
<a id="L2009" class="source_line" href="#L2009">2009</a>
<a id="L2010" class="source_line" href="#L2010">2010</a>
<a id="L2011" class="source_line" href="#L2011">2011</a>
<a id="L2012" class="source_line" href="#L2012">2012</a>
<a id="L2013" class="source_line" href="#L2013">2013</a>
<a id="L2014" class="source_line" href="#L2014">2014</a>
<a id="L2015" class="source_line" href="#L2015">2015</a>
<a id="L2016" class="source_line" href="#L2016">2016</a>
<a id="L2017" class="source_line" href="#L2017">2017</a>
<a id="L2018" class="source_line" href="#L2018">2018</a>
<a id="L2019" class="source_line" href="#L2019">2019</a>
<a id="L2020" class="source_line" href="#L2020">2020</a>
<a id="L2021" class="source_line" href="#L2021">2021</a>
<a id="L2022" class="source_line" href="#L2022">2022</a>
<a id="L2023" class="source_line" href="#L2023">2023</a>
<a id="L2024" class="source_line" href="#L2024">2024</a>
<a id="L2025" class="source_line" href="#L2025">2025</a>
<a id="L2026" class="source_line" href="#L2026">2026</a>
<a id="L2027" class="source_line" href="#L2027">2027</a>
<a id="L2028" class="source_line" href="#L2028">2028</a>
<a id="L2029" class="source_line" href="#L2029">2029</a>
<a id="L2030" class="source_line" href="#L2030">2030</a>
<a id="L2031" class="source_line" href="#L2031">2031</a>
<a id="L2032" class="source_line" href="#L2032">2032</a>
<a id="L2033" class="source_line" href="#L2033">2033</a>
<a id="L2034" class="source_line" href="#L2034">2034</a>
<a id="L2035" class="source_line" href="#L2035">2035</a>
<a id="L2036" class="source_line" href="#L2036">2036</a>
<a id="L2037" class="source_line" href="#L2037">2037</a>
<a id="L2038" class="source_line" href="#L2038">2038</a>
<a id="L2039" class="source_line" href="#L2039">2039</a>
<a id="L2040" class="source_line" href="#L2040">2040</a>
<a id="L2041" class="source_line" href="#L2041">2041</a>
<a id="L2042" class="source_line" href="#L2042">2042</a>
<a id="L2043" class="source_line" href="#L2043">2043</a>
<a id="L2044" class="source_line" href="#L2044">2044</a>
<a id="L2045" class="source_line" href="#L2045">2045</a>
<a id="L2046" class="source_line" href="#L2046">2046</a>
<a id="L2047" class="source_line" href="#L2047">2047</a>
<a id="L2048" class="source_line" href="#L2048">2048</a>
<a id="L2049" class="source_line" href="#L2049">2049</a>
<a id="L2050" class="source_line" href="#L2050">2050</a>
<a id="L2051" class="source_line" href="#L2051">2051</a>
<a id="L2052" class="source_line" href="#L2052">2052</a>
<a id="L2053" class="source_line" href="#L2053">2053</a>
<a id="L2054" class="source_line" href="#L2054">2054</a>
<a id="L2055" class="source_line" href="#L2055">2055</a>
<a id="L2056" class="source_line" href="#L2056">2056</a>
<a id="L2057" class="source_line" href="#L2057">2057</a>
<a id="L2058" class="source_line" href="#L2058">2058</a>
<a id="L2059" class="source_line" href="#L2059">2059</a>
<a id="L2060" class="source_line" href="#L2060">2060</a>
<a id="L2061" class="source_line" href="#L2061">2061</a>
<a id="L2062" class="source_line" href="#L2062">2062</a>
<a id="L2063" class="source_line" href="#L2063">2063</a>
<a id="L2064" class="source_line" href="#L2064">2064</a>
<a id="L2065" class="source_line" href="#L2065">2065</a>
<a id="L2066" class="source_line" href="#L2066">2066</a>
<a id="L2067" class="source_line" href="#L2067">2067</a>
<a id="L2068" class="source_line" href="#L2068">2068</a>
<a id="L2069" class="source_line" href="#L2069">2069</a>
<a id="L2070" class="source_line" href="#L2070">2070</a>
<a id="L2071" class="source_line" href="#L2071">2071</a>
<a id="L2072" class="source_line" href="#L2072">2072</a>
<a id="L2073" class="source_line" href="#L2073">2073</a>
<a id="L2074" class="source_line" href="#L2074">2074</a>
<a id="L2075" class="source_line" href="#L2075">2075</a>
<a id="L2076" class="source_line" href="#L2076">2076</a>
<a id="L2077" class="source_line" href="#L2077">2077</a>
<a id="L2078" class="source_line" href="#L2078">2078</a>
<a id="L2079" class="source_line" href="#L2079">2079</a>
<a id="L2080" class="source_line" href="#L2080">2080</a>
<a id="L2081" class="source_line" href="#L2081">2081</a>
<a id="L2082" class="source_line" href="#L2082">2082</a>
<a id="L2083" class="source_line" href="#L2083">2083</a>
<a id="L2084" class="source_line" href="#L2084">2084</a>
<a id="L2085" class="source_line" href="#L2085">2085</a>
<a id="L2086" class="source_line" href="#L2086">2086</a>
<a id="L2087" class="source_line" href="#L2087">2087</a>
<a id="L2088" class="source_line" href="#L2088">2088</a>
<a id="L2089" class="source_line" href="#L2089">2089</a>
<a id="L2090" class="source_line" href="#L2090">2090</a>
<a id="L2091" class="source_line" href="#L2091">2091</a>
<a id="L2092" class="source_line" href="#L2092">2092</a>
<a id="L2093" class="source_line" href="#L2093">2093</a>
<a id="L2094" class="source_line" href="#L2094">2094</a>
<a id="L2095" class="source_line" href="#L2095">2095</a>
<a id="L2096" class="source_line" href="#L2096">2096</a>
<a id="L2097" class="source_line" href="#L2097">2097</a>
<a id="L2098" class="source_line" href="#L2098">2098</a>
<a id="L2099" class="source_line" href="#L2099">2099</a>
<a id="L2100" class="source_line" href="#L2100">2100</a>
<a id="L2101" class="source_line" href="#L2101">2101</a>
<a id="L2102" class="source_line" href="#L2102">2102</a>
<a id="L2103" class="source_line" href="#L2103">2103</a>
<a id="L2104" class="source_line" href="#L2104">2104</a>
<a id="L2105" class="source_line" href="#L2105">2105</a>
<a id="L2106" class="source_line" href="#L2106">2106</a>
<a id="L2107" class="source_line" href="#L2107">2107</a>
<a id="L2108" class="source_line" href="#L2108">2108</a>
<a id="L2109" class="source_line" href="#L2109">2109</a>
<a id="L2110" class="source_line" href="#L2110">2110</a>
<a id="L2111" class="source_line" href="#L2111">2111</a>
<a id="L2112" class="source_line" href="#L2112">2112</a>
<a id="L2113" class="source_line" href="#L2113">2113</a>
<a id="L2114" class="source_line" href="#L2114">2114</a>
<a id="L2115" class="source_line" href="#L2115">2115</a>
<a id="L2116" class="source_line" href="#L2116">2116</a>
<a id="L2117" class="source_line" href="#L2117">2117</a>
<a id="L2118" class="source_line" href="#L2118">2118</a>
<a id="L2119" class="source_line" href="#L2119">2119</a>
<a id="L2120" class="source_line" href="#L2120">2120</a>
<a id="L2121" class="source_line" href="#L2121">2121</a>
<a id="L2122" class="source_line" href="#L2122">2122</a>
<a id="L2123" class="source_line" href="#L2123">2123</a>
<a id="L2124" class="source_line" href="#L2124">2124</a>
<a id="L2125" class="source_line" href="#L2125">2125</a>
<a id="L2126" class="source_line" href="#L2126">2126</a>
<a id="L2127" class="source_line" href="#L2127">2127</a>
<a id="L2128" class="source_line" href="#L2128">2128</a>
<a id="L2129" class="source_line" href="#L2129">2129</a>
<a id="L2130" class="source_line" href="#L2130">2130</a>
<a id="L2131" class="source_line" href="#L2131">2131</a>
<a id="L2132" class="source_line" href="#L2132">2132</a>
<a id="L2133" class="source_line" href="#L2133">2133</a>
<a id="L2134" class="source_line" href="#L2134">2134</a>
<a id="L2135" class="source_line" href="#L2135">2135</a>
<a id="L2136" class="source_line" href="#L2136">2136</a>
<a id="L2137" class="source_line" href="#L2137">2137</a>
<a id="L2138" class="source_line" href="#L2138">2138</a>
<a id="L2139" class="source_line" href="#L2139">2139</a>
<a id="L2140" class="source_line" href="#L2140">2140</a>
<a id="L2141" class="source_line" href="#L2141">2141</a>
<a id="L2142" class="source_line" href="#L2142">2142</a>
<a id="L2143" class="source_line" href="#L2143">2143</a>
<a id="L2144" class="source_line" href="#L2144">2144</a>
<a id="L2145" class="source_line" href="#L2145">2145</a>
<a id="L2146" class="source_line" href="#L2146">2146</a>
<a id="L2147" class="source_line" href="#L2147">2147</a>
<a id="L2148" class="source_line" href="#L2148">2148</a>
<a id="L2149" class="source_line" href="#L2149">2149</a>
<a id="L2150" class="source_line" href="#L2150">2150</a>
<a id="L2151" class="source_line" href="#L2151">2151</a>
<a id="L2152" class="source_line" href="#L2152">2152</a>
<a id="L2153" class="source_line" href="#L2153">2153</a>
<a id="L2154" class="source_line" href="#L2154">2154</a>
<a id="L2155" class="source_line" href="#L2155">2155</a>
<a id="L2156" class="source_line" href="#L2156">2156</a>
<a id="L2157" class="source_line" href="#L2157">2157</a>
<a id="L2158" class="source_line" href="#L2158">2158</a>
<a id="L2159" class="source_line" href="#L2159">2159</a>
<a id="L2160" class="source_line" href="#L2160">2160</a>
<a id="L2161" class="source_line" href="#L2161">2161</a>
<a id="L2162" class="source_line" href="#L2162">2162</a>
<a id="L2163" class="source_line" href="#L2163">2163</a>
<a id="L2164" class="source_line" href="#L2164">2164</a>
<a id="L2165" class="source_line" href="#L2165">2165</a>
<a id="L2166" class="source_line" href="#L2166">2166</a>
<a id="L2167" class="source_line" href="#L2167">2167</a>
<a id="L2168" class="source_line" href="#L2168">2168</a>
<a id="L2169" class="source_line" href="#L2169">2169</a>
<a id="L2170" class="source_line" href="#L2170">2170</a>
<a id="L2171" class="source_line" href="#L2171">2171</a>
<a id="L2172" class="source_line" href="#L2172">2172</a>
<a id="L2173" class="source_line" href="#L2173">2173</a>
<a id="L2174" class="source_line" href="#L2174">2174</a>
<a id="L2175" class="source_line" href="#L2175">2175</a>
<a id="L2176" class="source_line" href="#L2176">2176</a>
<a id="L2177" class="source_line" href="#L2177">2177</a>
<a id="L2178" class="source_line" href="#L2178">2178</a>
<a id="L2179" class="source_line" href="#L2179">2179</a>
<a id="L2180" class="source_line" href="#L2180">2180</a>
<a id="L2181" class="source_line" href="#L2181">2181</a>
<a id="L2182" class="source_line" href="#L2182">2182</a>
<a id="L2183" class="source_line" href="#L2183">2183</a>
<a id="L2184" class="source_line" href="#L2184">2184</a>
<a id="L2185" class="source_line" href="#L2185">2185</a>
<a id="L2186" class="source_line" href="#L2186">2186</a>
<a id="L2187" class="source_line" href="#L2187">2187</a>
<a id="L2188" class="source_line" href="#L2188">2188</a>
<a id="L2189" class="source_line" href="#L2189">2189</a>
<a id="L2190" class="source_line" href="#L2190">2190</a>
<a id="L2191" class="source_line" href="#L2191">2191</a>
<a id="L2192" class="source_line" href="#L2192">2192</a>
<a id="L2193" class="source_line" href="#L2193">2193</a>
<a id="L2194" class="source_line" href="#L2194">2194</a>
<a id="L2195" class="source_line" href="#L2195">2195</a>
<a id="L2196" class="source_line" href="#L2196">2196</a>
<a id="L2197" class="source_line" href="#L2197">2197</a>
<a id="L2198" class="source_line" href="#L2198">2198</a>
<a id="L2199" class="source_line" href="#L2199">2199</a>
<a id="L2200" class="source_line" href="#L2200">2200</a>
<a id="L2201" class="source_line" href="#L2201">2201</a>
<a id="L2202" class="source_line" href="#L2202">2202</a>
<a id="L2203" class="source_line" href="#L2203">2203</a>
<a id="L2204" class="source_line" href="#L2204">2204</a>
<a id="L2205" class="source_line" href="#L2205">2205</a>
<a id="L2206" class="source_line" href="#L2206">2206</a>
<a id="L2207" class="source_line" href="#L2207">2207</a>
<a id="L2208" class="source_line" href="#L2208">2208</a>
<a id="L2209" class="source_line" href="#L2209">2209</a>
<a id="L2210" class="source_line" href="#L2210">2210</a>
<a id="L2211" class="source_line" href="#L2211">2211</a>
<a id="L2212" class="source_line" href="#L2212">2212</a>
<a id="L2213" class="source_line" href="#L2213">2213</a>
<a id="L2214" class="source_line" href="#L2214">2214</a>
<a id="L2215" class="source_line" href="#L2215">2215</a>
<a id="L2216" class="source_line" href="#L2216">2216</a>
<a id="L2217" class="source_line" href="#L2217">2217</a>
<a id="L2218" class="source_line" href="#L2218">2218</a>
<a id="L2219" class="source_line" href="#L2219">2219</a>
<a id="L2220" class="source_line" href="#L2220">2220</a>
<a id="L2221" class="source_line" href="#L2221">2221</a>
<a id="L2222" class="source_line" href="#L2222">2222</a>
<a id="L2223" class="source_line" href="#L2223">2223</a>
<a id="L2224" class="source_line" href="#L2224">2224</a>
<a id="L2225" class="source_line" href="#L2225">2225</a>
<a id="L2226" class="source_line" href="#L2226">2226</a>
<a id="L2227" class="source_line" href="#L2227">2227</a>
<a id="L2228" class="source_line" href="#L2228">2228</a>
<a id="L2229" class="source_line" href="#L2229">2229</a>
<a id="L2230" class="source_line" href="#L2230">2230</a>
<a id="L2231" class="source_line" href="#L2231">2231</a>
<a id="L2232" class="source_line" href="#L2232">2232</a>
<a id="L2233" class="source_line" href="#L2233">2233</a>
<a id="L2234" class="source_line" href="#L2234">2234</a>
<a id="L2235" class="source_line" href="#L2235">2235</a>
<a id="L2236" class="source_line" href="#L2236">2236</a>
<a id="L2237" class="source_line" href="#L2237">2237</a>
<a id="L2238" class="source_line" href="#L2238">2238</a>
<a id="L2239" class="source_line" href="#L2239">2239</a>
<a id="L2240" class="source_line" href="#L2240">2240</a>
<a id="L2241" class="source_line" href="#L2241">2241</a>
<a id="L2242" class="source_line" href="#L2242">2242</a>
<a id="L2243" class="source_line" href="#L2243">2243</a>
<a id="L2244" class="source_line" href="#L2244">2244</a>
<a id="L2245" class="source_line" href="#L2245">2245</a>
<a id="L2246" class="source_line" href="#L2246">2246</a>
<a id="L2247" class="source_line" href="#L2247">2247</a>
<a id="L2248" class="source_line" href="#L2248">2248</a>
<a id="L2249" class="source_line" href="#L2249">2249</a>
<a id="L2250" class="source_line" href="#L2250">2250</a>
<a id="L2251" class="source_line" href="#L2251">2251</a>
<a id="L2252" class="source_line" href="#L2252">2252</a>
<a id="L2253" class="source_line" href="#L2253">2253</a>
<a id="L2254" class="source_line" href="#L2254">2254</a>
<a id="L2255" class="source_line" href="#L2255">2255</a>
<a id="L2256" class="source_line" href="#L2256">2256</a>
<a id="L2257" class="source_line" href="#L2257">2257</a>
<a id="L2258" class="source_line" href="#L2258">2258</a>
<a id="L2259" class="source_line" href="#L2259">2259</a>
<a id="L2260" class="source_line" href="#L2260">2260</a>
<a id="L2261" class="source_line" href="#L2261">2261</a>
<a id="L2262" class="source_line" href="#L2262">2262</a>
<a id="L2263" class="source_line" href="#L2263">2263</a>
<a id="L2264" class="source_line" href="#L2264">2264</a>
<a id="L2265" class="source_line" href="#L2265">2265</a>
<a id="L2266" class="source_line" href="#L2266">2266</a>
<a id="L2267" class="source_line" href="#L2267">2267</a>
<a id="L2268" class="source_line" href="#L2268">2268</a>
<a id="L2269" class="source_line" href="#L2269">2269</a>
<a id="L2270" class="source_line" href="#L2270">2270</a>
<a id="L2271" class="source_line" href="#L2271">2271</a>
<a id="L2272" class="source_line" href="#L2272">2272</a>
<a id="L2273" class="source_line" href="#L2273">2273</a>
<a id="L2274" class="source_line" href="#L2274">2274</a>
<a id="L2275" class="source_line" href="#L2275">2275</a>
<a id="L2276" class="source_line" href="#L2276">2276</a>
<a id="L2277" class="source_line" href="#L2277">2277</a>
<a id="L2278" class="source_line" href="#L2278">2278</a>
<a id="L2279" class="source_line" href="#L2279">2279</a>
<a id="L2280" class="source_line" href="#L2280">2280</a>
<a id="L2281" class="source_line" href="#L2281">2281</a>
<a id="L2282" class="source_line" href="#L2282">2282</a>
<a id="L2283" class="source_line" href="#L2283">2283</a>
<a id="L2284" class="source_line" href="#L2284">2284</a>
<a id="L2285" class="source_line" href="#L2285">2285</a>
<a id="L2286" class="source_line" href="#L2286">2286</a>
<a id="L2287" class="source_line" href="#L2287">2287</a>
<a id="L2288" class="source_line" href="#L2288">2288</a>
<a id="L2289" class="source_line" href="#L2289">2289</a>
<a id="L2290" class="source_line" href="#L2290">2290</a>
<a id="L2291" class="source_line" href="#L2291">2291</a>
<a id="L2292" class="source_line" href="#L2292">2292</a>
<a id="L2293" class="source_line" href="#L2293">2293</a>
<a id="L2294" class="source_line" href="#L2294">2294</a>
<a id="L2295" class="source_line" href="#L2295">2295</a>
<a id="L2296" class="source_line" href="#L2296">2296</a>
<a id="L2297" class="source_line" href="#L2297">2297</a>
<a id="L2298" class="source_line" href="#L2298">2298</a>
<a id="L2299" class="source_line" href="#L2299">2299</a>
<a id="L2300" class="source_line" href="#L2300">2300</a>
<a id="L2301" class="source_line" href="#L2301">2301</a>
<a id="L2302" class="source_line" href="#L2302">2302</a>
<a id="L2303" class="source_line" href="#L2303">2303</a>
<a id="L2304" class="source_line" href="#L2304">2304</a>
<a id="L2305" class="source_line" href="#L2305">2305</a>
<a id="L2306" class="source_line" href="#L2306">2306</a>
<a id="L2307" class="source_line" href="#L2307">2307</a>
<a id="L2308" class="source_line" href="#L2308">2308</a>
<a id="L2309" class="source_line" href="#L2309">2309</a>
<a id="L2310" class="source_line" href="#L2310">2310</a>
<a id="L2311" class="source_line" href="#L2311">2311</a>
<a id="L2312" class="source_line" href="#L2312">2312</a>
<a id="L2313" class="source_line" href="#L2313">2313</a>
<a id="L2314" class="source_line" href="#L2314">2314</a>
<a id="L2315" class="source_line" href="#L2315">2315</a>
<a id="L2316" class="source_line" href="#L2316">2316</a>
<a id="L2317" class="source_line" href="#L2317">2317</a>
<a id="L2318" class="source_line" href="#L2318">2318</a>
<a id="L2319" class="source_line" href="#L2319">2319</a>
<a id="L2320" class="source_line" href="#L2320">2320</a>
<a id="L2321" class="source_line" href="#L2321">2321</a>
<a id="L2322" class="source_line" href="#L2322">2322</a>
<a id="L2323" class="source_line" href="#L2323">2323</a>
<a id="L2324" class="source_line" href="#L2324">2324</a>
<a id="L2325" class="source_line" href="#L2325">2325</a>
<a id="L2326" class="source_line" href="#L2326">2326</a>
<a id="L2327" class="source_line" href="#L2327">2327</a>
<a id="L2328" class="source_line" href="#L2328">2328</a>
<a id="L2329" class="source_line" href="#L2329">2329</a>
<a id="L2330" class="source_line" href="#L2330">2330</a>
<a id="L2331" class="source_line" href="#L2331">2331</a>
<a id="L2332" class="source_line" href="#L2332">2332</a>
<a id="L2333" class="source_line" href="#L2333">2333</a>
<a id="L2334" class="source_line" href="#L2334">2334</a>
<a id="L2335" class="source_line" href="#L2335">2335</a>
<a id="L2336" class="source_line" href="#L2336">2336</a>
<a id="L2337" class="source_line" href="#L2337">2337</a>
<a id="L2338" class="source_line" href="#L2338">2338</a>
<a id="L2339" class="source_line" href="#L2339">2339</a>
<a id="L2340" class="source_line" href="#L2340">2340</a>
<a id="L2341" class="source_line" href="#L2341">2341</a>
<a id="L2342" class="source_line" href="#L2342">2342</a>
<a id="L2343" class="source_line" href="#L2343">2343</a>
<a id="L2344" class="source_line" href="#L2344">2344</a>
<a id="L2345" class="source_line" href="#L2345">2345</a>
<a id="L2346" class="source_line" href="#L2346">2346</a>
<a id="L2347" class="source_line" href="#L2347">2347</a>
<a id="L2348" class="source_line" href="#L2348">2348</a>
<a id="L2349" class="source_line" href="#L2349">2349</a>
<a id="L2350" class="source_line" href="#L2350">2350</a>
<a id="L2351" class="source_line" href="#L2351">2351</a>
<a id="L2352" class="source_line" href="#L2352">2352</a>
<a id="L2353" class="source_line" href="#L2353">2353</a>
<a id="L2354" class="source_line" href="#L2354">2354</a>
<a id="L2355" class="source_line" href="#L2355">2355</a>
<a id="L2356" class="source_line" href="#L2356">2356</a>
<a id="L2357" class="source_line" href="#L2357">2357</a>
<a id="L2358" class="source_line" href="#L2358">2358</a>
<a id="L2359" class="source_line" href="#L2359">2359</a>
<a id="L2360" class="source_line" href="#L2360">2360</a>
<a id="L2361" class="source_line" href="#L2361">2361</a>
<a id="L2362" class="source_line" href="#L2362">2362</a>
<a id="L2363" class="source_line" href="#L2363">2363</a>
<a id="L2364" class="source_line" href="#L2364">2364</a>
<a id="L2365" class="source_line" href="#L2365">2365</a>
<a id="L2366" class="source_line" href="#L2366">2366</a>
<a id="L2367" class="source_line" href="#L2367">2367</a>
<a id="L2368" class="source_line" href="#L2368">2368</a>
<a id="L2369" class="source_line" href="#L2369">2369</a>
<a id="L2370" class="source_line" href="#L2370">2370</a>
<a id="L2371" class="source_line" href="#L2371">2371</a>
<a id="L2372" class="source_line" href="#L2372">2372</a>
<a id="L2373" class="source_line" href="#L2373">2373</a>
<a id="L2374" class="source_line" href="#L2374">2374</a>
<a id="L2375" class="source_line" href="#L2375">2375</a>
<a id="L2376" class="source_line" href="#L2376">2376</a>
<a id="L2377" class="source_line" href="#L2377">2377</a>
<a id="L2378" class="source_line" href="#L2378">2378</a>
<a id="L2379" class="source_line" href="#L2379">2379</a>
<a id="L2380" class="source_line" href="#L2380">2380</a>
<a id="L2381" class="source_line" href="#L2381">2381</a>
<a id="L2382" class="source_line" href="#L2382">2382</a>
<a id="L2383" class="source_line" href="#L2383">2383</a>
<a id="L2384" class="source_line" href="#L2384">2384</a>
<a id="L2385" class="source_line" href="#L2385">2385</a>
<a id="L2386" class="source_line" href="#L2386">2386</a>
<a id="L2387" class="source_line" href="#L2387">2387</a>
<a id="L2388" class="source_line" href="#L2388">2388</a>
<a id="L2389" class="source_line" href="#L2389">2389</a>
<a id="L2390" class="source_line" href="#L2390">2390</a>
<a id="L2391" class="source_line" href="#L2391">2391</a>
<a id="L2392" class="source_line" href="#L2392">2392</a>
<a id="L2393" class="source_line" href="#L2393">2393</a>
<a id="L2394" class="source_line" href="#L2394">2394</a>
<a id="L2395" class="source_line" href="#L2395">2395</a>
<a id="L2396" class="source_line" href="#L2396">2396</a>
<a id="L2397" class="source_line" href="#L2397">2397</a>
<a id="L2398" class="source_line" href="#L2398">2398</a>
<a id="L2399" class="source_line" href="#L2399">2399</a>
<a id="L2400" class="source_line" href="#L2400">2400</a>
<a id="L2401" class="source_line" href="#L2401">2401</a>
<a id="L2402" class="source_line" href="#L2402">2402</a>
<a id="L2403" class="source_line" href="#L2403">2403</a>
<a id="L2404" class="source_line" href="#L2404">2404</a>
<a id="L2405" class="source_line" href="#L2405">2405</a>
<a id="L2406" class="source_line" href="#L2406">2406</a>
<a id="L2407" class="source_line" href="#L2407">2407</a>
<a id="L2408" class="source_line" href="#L2408">2408</a>
<a id="L2409" class="source_line" href="#L2409">2409</a>
<a id="L2410" class="source_line" href="#L2410">2410</a>
<a id="L2411" class="source_line" href="#L2411">2411</a>
<a id="L2412" class="source_line" href="#L2412">2412</a>
<a id="L2413" class="source_line" href="#L2413">2413</a>
<a id="L2414" class="source_line" href="#L2414">2414</a>
<a id="L2415" class="source_line" href="#L2415">2415</a>
<a id="L2416" class="source_line" href="#L2416">2416</a>
<a id="L2417" class="source_line" href="#L2417">2417</a>
<a id="L2418" class="source_line" href="#L2418">2418</a>
<a id="L2419" class="source_line" href="#L2419">2419</a>
<a id="L2420" class="source_line" href="#L2420">2420</a>
<a id="L2421" class="source_line" href="#L2421">2421</a>
<a id="L2422" class="source_line" href="#L2422">2422</a>
<a id="L2423" class="source_line" href="#L2423">2423</a>
<a id="L2424" class="source_line" href="#L2424">2424</a>
<a id="L2425" class="source_line" href="#L2425">2425</a>
<a id="L2426" class="source_line" href="#L2426">2426</a>
<a id="L2427" class="source_line" href="#L2427">2427</a>
<a id="L2428" class="source_line" href="#L2428">2428</a>
<a id="L2429" class="source_line" href="#L2429">2429</a>
<a id="L2430" class="source_line" href="#L2430">2430</a>
<a id="L2431" class="source_line" href="#L2431">2431</a>
<a id="L2432" class="source_line" href="#L2432">2432</a>
<a id="L2433" class="source_line" href="#L2433">2433</a>
<a id="L2434" class="source_line" href="#L2434">2434</a>
<a id="L2435" class="source_line" href="#L2435">2435</a>
<a id="L2436" class="source_line" href="#L2436">2436</a>
<a id="L2437" class="source_line" href="#L2437">2437</a>
<a id="L2438" class="source_line" href="#L2438">2438</a>
<a id="L2439" class="source_line" href="#L2439">2439</a>
<a id="L2440" class="source_line" href="#L2440">2440</a>
<a id="L2441" class="source_line" href="#L2441">2441</a>
<a id="L2442" class="source_line" href="#L2442">2442</a>
<a id="L2443" class="source_line" href="#L2443">2443</a>
<a id="L2444" class="source_line" href="#L2444">2444</a>
<a id="L2445" class="source_line" href="#L2445">2445</a>
<a id="L2446" class="source_line" href="#L2446">2446</a>
<a id="L2447" class="source_line" href="#L2447">2447</a>
<a id="L2448" class="source_line" href="#L2448">2448</a>
<a id="L2449" class="source_line" href="#L2449">2449</a>
<a id="L2450" class="source_line" href="#L2450">2450</a>
<a id="L2451" class="source_line" href="#L2451">2451</a>
<a id="L2452" class="source_line" href="#L2452">2452</a>
<a id="L2453" class="source_line" href="#L2453">2453</a>
<a id="L2454" class="source_line" href="#L2454">2454</a>
<a id="L2455" class="source_line" href="#L2455">2455</a>
<a id="L2456" class="source_line" href="#L2456">2456</a>
<a id="L2457" class="source_line" href="#L2457">2457</a>
<a id="L2458" class="source_line" href="#L2458">2458</a>
<a id="L2459" class="source_line" href="#L2459">2459</a>
<a id="L2460" class="source_line" href="#L2460">2460</a>
<a id="L2461" class="source_line" href="#L2461">2461</a>
<a id="L2462" class="source_line" href="#L2462">2462</a>
<a id="L2463" class="source_line" href="#L2463">2463</a>
<a id="L2464" class="source_line" href="#L2464">2464</a>
<a id="L2465" class="source_line" href="#L2465">2465</a>
<a id="L2466" class="source_line" href="#L2466">2466</a>
<a id="L2467" class="source_line" href="#L2467">2467</a>
<a id="L2468" class="source_line" href="#L2468">2468</a>
<a id="L2469" class="source_line" href="#L2469">2469</a>
<a id="L2470" class="source_line" href="#L2470">2470</a>
<a id="L2471" class="source_line" href="#L2471">2471</a>
<a id="L2472" class="source_line" href="#L2472">2472</a>
<a id="L2473" class="source_line" href="#L2473">2473</a>
<a id="L2474" class="source_line" href="#L2474">2474</a>
<a id="L2475" class="source_line" href="#L2475">2475</a>
<a id="L2476" class="source_line" href="#L2476">2476</a>
<a id="L2477" class="source_line" href="#L2477">2477</a>
<a id="L2478" class="source_line" href="#L2478">2478</a>
<a id="L2479" class="source_line" href="#L2479">2479</a>
<a id="L2480" class="source_line" href="#L2480">2480</a>
<a id="L2481" class="source_line" href="#L2481">2481</a>
<a id="L2482" class="source_line" href="#L2482">2482</a>
<a id="L2483" class="source_line" href="#L2483">2483</a>
<a id="L2484" class="source_line" href="#L2484">2484</a>
<a id="L2485" class="source_line" href="#L2485">2485</a>
<a id="L2486" class="source_line" href="#L2486">2486</a>
<a id="L2487" class="source_line" href="#L2487">2487</a>
<a id="L2488" class="source_line" href="#L2488">2488</a>
<a id="L2489" class="source_line" href="#L2489">2489</a>
<a id="L2490" class="source_line" href="#L2490">2490</a>
<a id="L2491" class="source_line" href="#L2491">2491</a>
<a id="L2492" class="source_line" href="#L2492">2492</a>
<a id="L2493" class="source_line" href="#L2493">2493</a>
<a id="L2494" class="source_line" href="#L2494">2494</a>
<a id="L2495" class="source_line" href="#L2495">2495</a>
<a id="L2496" class="source_line" href="#L2496">2496</a>
<a id="L2497" class="source_line" href="#L2497">2497</a>
<a id="L2498" class="source_line" href="#L2498">2498</a>
<a id="L2499" class="source_line" href="#L2499">2499</a>
<a id="L2500" class="source_line" href="#L2500">2500</a>
<a id="L2501" class="source_line" href="#L2501">2501</a>
<a id="L2502" class="source_line" href="#L2502">2502</a>
<a id="L2503" class="source_line" href="#L2503">2503</a>
<a id="L2504" class="source_line" href="#L2504">2504</a>
<a id="L2505" class="source_line" href="#L2505">2505</a>
<a id="L2506" class="source_line" href="#L2506">2506</a>
<a id="L2507" class="source_line" href="#L2507">2507</a>
<a id="L2508" class="source_line" href="#L2508">2508</a>
<a id="L2509" class="source_line" href="#L2509">2509</a>
<a id="L2510" class="source_line" href="#L2510">2510</a>
<a id="L2511" class="source_line" href="#L2511">2511</a>
<a id="L2512" class="source_line" href="#L2512">2512</a>
<a id="L2513" class="source_line" href="#L2513">2513</a>
<a id="L2514" class="source_line" href="#L2514">2514</a>
<a id="L2515" class="source_line" href="#L2515">2515</a>
<a id="L2516" class="source_line" href="#L2516">2516</a>
<a id="L2517" class="source_line" href="#L2517">2517</a>
<a id="L2518" class="source_line" href="#L2518">2518</a>
<a id="L2519" class="source_line" href="#L2519">2519</a>
<a id="L2520" class="source_line" href="#L2520">2520</a>
<a id="L2521" class="source_line" href="#L2521">2521</a>
<a id="L2522" class="source_line" href="#L2522">2522</a>
<a id="L2523" class="source_line" href="#L2523">2523</a>
<a id="L2524" class="source_line" href="#L2524">2524</a>
<a id="L2525" class="source_line" href="#L2525">2525</a>
<a id="L2526" class="source_line" href="#L2526">2526</a>
<a id="L2527" class="source_line" href="#L2527">2527</a>
<a id="L2528" class="source_line" href="#L2528">2528</a>
<a id="L2529" class="source_line" href="#L2529">2529</a>
<a id="L2530" class="source_line" href="#L2530">2530</a>
<a id="L2531" class="source_line" href="#L2531">2531</a>
<a id="L2532" class="source_line" href="#L2532">2532</a>
<a id="L2533" class="source_line" href="#L2533">2533</a>
<a id="L2534" class="source_line" href="#L2534">2534</a>
<a id="L2535" class="source_line" href="#L2535">2535</a>
<a id="L2536" class="source_line" href="#L2536">2536</a>
<a id="L2537" class="source_line" href="#L2537">2537</a>
<a id="L2538" class="source_line" href="#L2538">2538</a>
<a id="L2539" class="source_line" href="#L2539">2539</a>
<a id="L2540" class="source_line" href="#L2540">2540</a>
<a id="L2541" class="source_line" href="#L2541">2541</a>
<a id="L2542" class="source_line" href="#L2542">2542</a>
<a id="L2543" class="source_line" href="#L2543">2543</a>
<a id="L2544" class="source_line" href="#L2544">2544</a>
<a id="L2545" class="source_line" href="#L2545">2545</a>
<a id="L2546" class="source_line" href="#L2546">2546</a>
<a id="L2547" class="source_line" href="#L2547">2547</a>
<a id="L2548" class="source_line" href="#L2548">2548</a>
<a id="L2549" class="source_line" href="#L2549">2549</a>
<a id="L2550" class="source_line" href="#L2550">2550</a>
<a id="L2551" class="source_line" href="#L2551">2551</a>
<a id="L2552" class="source_line" href="#L2552">2552</a>
<a id="L2553" class="source_line" href="#L2553">2553</a>
<a id="L2554" class="source_line" href="#L2554">2554</a>
<a id="L2555" class="source_line" href="#L2555">2555</a>
<a id="L2556" class="source_line" href="#L2556">2556</a>
<a id="L2557" class="source_line" href="#L2557">2557</a>
<a id="L2558" class="source_line" href="#L2558">2558</a>
<a id="L2559" class="source_line" href="#L2559">2559</a>
<a id="L2560" class="source_line" href="#L2560">2560</a>
<a id="L2561" class="source_line" href="#L2561">2561</a>
<a id="L2562" class="source_line" href="#L2562">2562</a>
<a id="L2563" class="source_line" href="#L2563">2563</a>
<a id="L2564" class="source_line" href="#L2564">2564</a>
<a id="L2565" class="source_line" href="#L2565">2565</a>
<a id="L2566" class="source_line" href="#L2566">2566</a>
<a id="L2567" class="source_line" href="#L2567">2567</a>
<a id="L2568" class="source_line" href="#L2568">2568</a>
<a id="L2569" class="source_line" href="#L2569">2569</a>
<a id="L2570" class="source_line" href="#L2570">2570</a>
<a id="L2571" class="source_line" href="#L2571">2571</a>
<a id="L2572" class="source_line" href="#L2572">2572</a>
<a id="L2573" class="source_line" href="#L2573">2573</a>
<a id="L2574" class="source_line" href="#L2574">2574</a>
<a id="L2575" class="source_line" href="#L2575">2575</a>
<a id="L2576" class="source_line" href="#L2576">2576</a>
<a id="L2577" class="source_line" href="#L2577">2577</a>
<a id="L2578" class="source_line" href="#L2578">2578</a>
<a id="L2579" class="source_line" href="#L2579">2579</a>
<a id="L2580" class="source_line" href="#L2580">2580</a>
<a id="L2581" class="source_line" href="#L2581">2581</a>
<a id="L2582" class="source_line" href="#L2582">2582</a>
<a id="L2583" class="source_line" href="#L2583">2583</a>
<a id="L2584" class="source_line" href="#L2584">2584</a>
<a id="L2585" class="source_line" href="#L2585">2585</a>
<a id="L2586" class="source_line" href="#L2586">2586</a>
<a id="L2587" class="source_line" href="#L2587">2587</a>
<a id="L2588" class="source_line" href="#L2588">2588</a>
<a id="L2589" class="source_line" href="#L2589">2589</a>
<a id="L2590" class="source_line" href="#L2590">2590</a>
<a id="L2591" class="source_line" href="#L2591">2591</a>
<a id="L2592" class="source_line" href="#L2592">2592</a>
<a id="L2593" class="source_line" href="#L2593">2593</a>
<a id="L2594" class="source_line" href="#L2594">2594</a>
<a id="L2595" class="source_line" href="#L2595">2595</a>
<a id="L2596" class="source_line" href="#L2596">2596</a>
<a id="L2597" class="source_line" href="#L2597">2597</a>
<a id="L2598" class="source_line" href="#L2598">2598</a>
<a id="L2599" class="source_line" href="#L2599">2599</a>
<a id="L2600" class="source_line" href="#L2600">2600</a>
<a id="L2601" class="source_line" href="#L2601">2601</a>
<a id="L2602" class="source_line" href="#L2602">2602</a>
<a id="L2603" class="source_line" href="#L2603">2603</a>
<a id="L2604" class="source_line" href="#L2604">2604</a>
<a id="L2605" class="source_line" href="#L2605">2605</a>
<a id="L2606" class="source_line" href="#L2606">2606</a>
<a id="L2607" class="source_line" href="#L2607">2607</a>
<a id="L2608" class="source_line" href="#L2608">2608</a>
<a id="L2609" class="source_line" href="#L2609">2609</a>
<a id="L2610" class="source_line" href="#L2610">2610</a>
<a id="L2611" class="source_line" href="#L2611">2611</a>
<a id="L2612" class="source_line" href="#L2612">2612</a>
<a id="L2613" class="source_line" href="#L2613">2613</a>
<a id="L2614" class="source_line" href="#L2614">2614</a>
<a id="L2615" class="source_line" href="#L2615">2615</a>
<a id="L2616" class="source_line" href="#L2616">2616</a>
<a id="L2617" class="source_line" href="#L2617">2617</a>
<a id="L2618" class="source_line" href="#L2618">2618</a>
<a id="L2619" class="source_line" href="#L2619">2619</a>
<a id="L2620" class="source_line" href="#L2620">2620</a>
<a id="L2621" class="source_line" href="#L2621">2621</a>
<a id="L2622" class="source_line" href="#L2622">2622</a>
<a id="L2623" class="source_line" href="#L2623">2623</a>
<a id="L2624" class="source_line" href="#L2624">2624</a>
<a id="L2625" class="source_line" href="#L2625">2625</a>
<a id="L2626" class="source_line" href="#L2626">2626</a>
<a id="L2627" class="source_line" href="#L2627">2627</a>
<a id="L2628" class="source_line" href="#L2628">2628</a>
<a id="L2629" class="source_line" href="#L2629">2629</a>
<a id="L2630" class="source_line" href="#L2630">2630</a>
<a id="L2631" class="source_line" href="#L2631">2631</a>
<a id="L2632" class="source_line" href="#L2632">2632</a>
<a id="L2633" class="source_line" href="#L2633">2633</a>
<a id="L2634" class="source_line" href="#L2634">2634</a>
<a id="L2635" class="source_line" href="#L2635">2635</a>
<a id="L2636" class="source_line" href="#L2636">2636</a>
<a id="L2637" class="source_line" href="#L2637">2637</a>
<a id="L2638" class="source_line" href="#L2638">2638</a>
<a id="L2639" class="source_line" href="#L2639">2639</a>
<a id="L2640" class="source_line" href="#L2640">2640</a>
<a id="L2641" class="source_line" href="#L2641">2641</a>
<a id="L2642" class="source_line" href="#L2642">2642</a>
<a id="L2643" class="source_line" href="#L2643">2643</a>
<a id="L2644" class="source_line" href="#L2644">2644</a>
<a id="L2645" class="source_line" href="#L2645">2645</a>
<a id="L2646" class="source_line" href="#L2646">2646</a>
<a id="L2647" class="source_line" href="#L2647">2647</a>
<a id="L2648" class="source_line" href="#L2648">2648</a>
<a id="L2649" class="source_line" href="#L2649">2649</a>
<a id="L2650" class="source_line" href="#L2650">2650</a>
<a id="L2651" class="source_line" href="#L2651">2651</a>
<a id="L2652" class="source_line" href="#L2652">2652</a>
<a id="L2653" class="source_line" href="#L2653">2653</a>
<a id="L2654" class="source_line" href="#L2654">2654</a>
<a id="L2655" class="source_line" href="#L2655">2655</a>
<a id="L2656" class="source_line" href="#L2656">2656</a>
<a id="L2657" class="source_line" href="#L2657">2657</a>
<a id="L2658" class="source_line" href="#L2658">2658</a>
<a id="L2659" class="source_line" href="#L2659">2659</a>
<a id="L2660" class="source_line" href="#L2660">2660</a>
<a id="L2661" class="source_line" href="#L2661">2661</a>
<a id="L2662" class="source_line" href="#L2662">2662</a>
<a id="L2663" class="source_line" href="#L2663">2663</a>
<a id="L2664" class="source_line" href="#L2664">2664</a>
<a id="L2665" class="source_line" href="#L2665">2665</a>
<a id="L2666" class="source_line" href="#L2666">2666</a>
<a id="L2667" class="source_line" href="#L2667">2667</a>
<a id="L2668" class="source_line" href="#L2668">2668</a>
<a id="L2669" class="source_line" href="#L2669">2669</a>
<a id="L2670" class="source_line" href="#L2670">2670</a>
<a id="L2671" class="source_line" href="#L2671">2671</a>
<a id="L2672" class="source_line" href="#L2672">2672</a>
<a id="L2673" class="source_line" href="#L2673">2673</a>
<a id="L2674" class="source_line" href="#L2674">2674</a>
<a id="L2675" class="source_line" href="#L2675">2675</a>
<a id="L2676" class="source_line" href="#L2676">2676</a>
<a id="L2677" class="source_line" href="#L2677">2677</a>
<a id="L2678" class="source_line" href="#L2678">2678</a>
<a id="L2679" class="source_line" href="#L2679">2679</a>
<a id="L2680" class="source_line" href="#L2680">2680</a>
<a id="L2681" class="source_line" href="#L2681">2681</a>
<a id="L2682" class="source_line" href="#L2682">2682</a>
<a id="L2683" class="source_line" href="#L2683">2683</a>
<a id="L2684" class="source_line" href="#L2684">2684</a>
<a id="L2685" class="source_line" href="#L2685">2685</a>
<a id="L2686" class="source_line" href="#L2686">2686</a>
<a id="L2687" class="source_line" href="#L2687">2687</a>
<a id="L2688" class="source_line" href="#L2688">2688</a>
<a id="L2689" class="source_line" href="#L2689">2689</a>
<a id="L2690" class="source_line" href="#L2690">2690</a>
<a id="L2691" class="source_line" href="#L2691">2691</a>
<a id="L2692" class="source_line" href="#L2692">2692</a>
<a id="L2693" class="source_line" href="#L2693">2693</a>
<a id="L2694" class="source_line" href="#L2694">2694</a>
<a id="L2695" class="source_line" href="#L2695">2695</a>
<a id="L2696" class="source_line" href="#L2696">2696</a>
<a id="L2697" class="source_line" href="#L2697">2697</a>
<a id="L2698" class="source_line" href="#L2698">2698</a>
<a id="L2699" class="source_line" href="#L2699">2699</a>
<a id="L2700" class="source_line" href="#L2700">2700</a>
<a id="L2701" class="source_line" href="#L2701">2701</a>
<a id="L2702" class="source_line" href="#L2702">2702</a>
<a id="L2703" class="source_line" href="#L2703">2703</a>
<a id="L2704" class="source_line" href="#L2704">2704</a>
<a id="L2705" class="source_line" href="#L2705">2705</a>
<a id="L2706" class="source_line" href="#L2706">2706</a>
<a id="L2707" class="source_line" href="#L2707">2707</a>
<a id="L2708" class="source_line" href="#L2708">2708</a>
<a id="L2709" class="source_line" href="#L2709">2709</a>
<a id="L2710" class="source_line" href="#L2710">2710</a>
<a id="L2711" class="source_line" href="#L2711">2711</a>
<a id="L2712" class="source_line" href="#L2712">2712</a>
<a id="L2713" class="source_line" href="#L2713">2713</a>
<a id="L2714" class="source_line" href="#L2714">2714</a>
<a id="L2715" class="source_line" href="#L2715">2715</a>
<a id="L2716" class="source_line" href="#L2716">2716</a>
<a id="L2717" class="source_line" href="#L2717">2717</a>
<a id="L2718" class="source_line" href="#L2718">2718</a>
<a id="L2719" class="source_line" href="#L2719">2719</a>
<a id="L2720" class="source_line" href="#L2720">2720</a>
<a id="L2721" class="source_line" href="#L2721">2721</a>
<a id="L2722" class="source_line" href="#L2722">2722</a>
<a id="L2723" class="source_line" href="#L2723">2723</a>
<a id="L2724" class="source_line" href="#L2724">2724</a>
<a id="L2725" class="source_line" href="#L2725">2725</a>
<a id="L2726" class="source_line" href="#L2726">2726</a>
<a id="L2727" class="source_line" href="#L2727">2727</a>
<a id="L2728" class="source_line" href="#L2728">2728</a>
<a id="L2729" class="source_line" href="#L2729">2729</a>
<a id="L2730" class="source_line" href="#L2730">2730</a>
<a id="L2731" class="source_line" href="#L2731">2731</a>
<a id="L2732" class="source_line" href="#L2732">2732</a>
<a id="L2733" class="source_line" href="#L2733">2733</a>
<a id="L2734" class="source_line" href="#L2734">2734</a>
<a id="L2735" class="source_line" href="#L2735">2735</a>
<a id="L2736" class="source_line" href="#L2736">2736</a>
<a id="L2737" class="source_line" href="#L2737">2737</a>
<a id="L2738" class="source_line" href="#L2738">2738</a>
<a id="L2739" class="source_line" href="#L2739">2739</a>
<a id="L2740" class="source_line" href="#L2740">2740</a>
<a id="L2741" class="source_line" href="#L2741">2741</a>
<a id="L2742" class="source_line" href="#L2742">2742</a>
<a id="L2743" class="source_line" href="#L2743">2743</a>
<a id="L2744" class="source_line" href="#L2744">2744</a>
<a id="L2745" class="source_line" href="#L2745">2745</a>
<a id="L2746" class="source_line" href="#L2746">2746</a>
<a id="L2747" class="source_line" href="#L2747">2747</a>
<a id="L2748" class="source_line" href="#L2748">2748</a>
<a id="L2749" class="source_line" href="#L2749">2749</a>
<a id="L2750" class="source_line" href="#L2750">2750</a>
<a id="L2751" class="source_line" href="#L2751">2751</a>
<a id="L2752" class="source_line" href="#L2752">2752</a>
<a id="L2753" class="source_line" href="#L2753">2753</a>
<a id="L2754" class="source_line" href="#L2754">2754</a>
<a id="L2755" class="source_line" href="#L2755">2755</a>
<a id="L2756" class="source_line" href="#L2756">2756</a>
<a id="L2757" class="source_line" href="#L2757">2757</a>
<a id="L2758" class="source_line" href="#L2758">2758</a>
<a id="L2759" class="source_line" href="#L2759">2759</a>
<a id="L2760" class="source_line" href="#L2760">2760</a>
<a id="L2761" class="source_line" href="#L2761">2761</a>
<a id="L2762" class="source_line" href="#L2762">2762</a>
<a id="L2763" class="source_line" href="#L2763">2763</a>
<a id="L2764" class="source_line" href="#L2764">2764</a>
<a id="L2765" class="source_line" href="#L2765">2765</a>
<a id="L2766" class="source_line" href="#L2766">2766</a>
<a id="L2767" class="source_line" href="#L2767">2767</a>
<a id="L2768" class="source_line" href="#L2768">2768</a>
<a id="L2769" class="source_line" href="#L2769">2769</a>
<a id="L2770" class="source_line" href="#L2770">2770</a>
<a id="L2771" class="source_line" href="#L2771">2771</a>
<a id="L2772" class="source_line" href="#L2772">2772</a>
<a id="L2773" class="source_line" href="#L2773">2773</a>
<a id="L2774" class="source_line" href="#L2774">2774</a>
<a id="L2775" class="source_line" href="#L2775">2775</a>
<a id="L2776" class="source_line" href="#L2776">2776</a>
<a id="L2777" class="source_line" href="#L2777">2777</a>
<a id="L2778" class="source_line" href="#L2778">2778</a>
<a id="L2779" class="source_line" href="#L2779">2779</a>
<a id="L2780" class="source_line" href="#L2780">2780</a>
<a id="L2781" class="source_line" href="#L2781">2781</a>
<a id="L2782" class="source_line" href="#L2782">2782</a>
<a id="L2783" class="source_line" href="#L2783">2783</a>
<a id="L2784" class="source_line" href="#L2784">2784</a>
<a id="L2785" class="source_line" href="#L2785">2785</a>
<a id="L2786" class="source_line" href="#L2786">2786</a>
<a id="L2787" class="source_line" href="#L2787">2787</a>
<a id="L2788" class="source_line" href="#L2788">2788</a>
<a id="L2789" class="source_line" href="#L2789">2789</a>
<a id="L2790" class="source_line" href="#L2790">2790</a>
<a id="L2791" class="source_line" href="#L2791">2791</a>
<a id="L2792" class="source_line" href="#L2792">2792</a>
<a id="L2793" class="source_line" href="#L2793">2793</a>
<a id="L2794" class="source_line" href="#L2794">2794</a>
<a id="L2795" class="source_line" href="#L2795">2795</a>
<a id="L2796" class="source_line" href="#L2796">2796</a>
<a id="L2797" class="source_line" href="#L2797">2797</a>
<a id="L2798" class="source_line" href="#L2798">2798</a>
<a id="L2799" class="source_line" href="#L2799">2799</a>
<a id="L2800" class="source_line" href="#L2800">2800</a>
<a id="L2801" class="source_line" href="#L2801">2801</a>
<a id="L2802" class="source_line" href="#L2802">2802</a>
<a id="L2803" class="source_line" href="#L2803">2803</a>
<a id="L2804" class="source_line" href="#L2804">2804</a>
<a id="L2805" class="source_line" href="#L2805">2805</a>
<a id="L2806" class="source_line" href="#L2806">2806</a>
<a id="L2807" class="source_line" href="#L2807">2807</a>
<a id="L2808" class="source_line" href="#L2808">2808</a>
<a id="L2809" class="source_line" href="#L2809">2809</a>
<a id="L2810" class="source_line" href="#L2810">2810</a>
<a id="L2811" class="source_line" href="#L2811">2811</a>
<a id="L2812" class="source_line" href="#L2812">2812</a>
<a id="L2813" class="source_line" href="#L2813">2813</a>
<a id="L2814" class="source_line" href="#L2814">2814</a>
<a id="L2815" class="source_line" href="#L2815">2815</a>
<a id="L2816" class="source_line" href="#L2816">2816</a>
<a id="L2817" class="source_line" href="#L2817">2817</a>
<a id="L2818" class="source_line" href="#L2818">2818</a>
<a id="L2819" class="source_line" href="#L2819">2819</a>
<a id="L2820" class="source_line" href="#L2820">2820</a>
<a id="L2821" class="source_line" href="#L2821">2821</a>
<a id="L2822" class="source_line" href="#L2822">2822</a>
<a id="L2823" class="source_line" href="#L2823">2823</a>
<a id="L2824" class="source_line" href="#L2824">2824</a>
<a id="L2825" class="source_line" href="#L2825">2825</a>
<a id="L2826" class="source_line" href="#L2826">2826</a>
<a id="L2827" class="source_line" href="#L2827">2827</a>
<a id="L2828" class="source_line" href="#L2828">2828</a>
<a id="L2829" class="source_line" href="#L2829">2829</a>
<a id="L2830" class="source_line" href="#L2830">2830</a>
<a id="L2831" class="source_line" href="#L2831">2831</a>
<a id="L2832" class="source_line" href="#L2832">2832</a>
<a id="L2833" class="source_line" href="#L2833">2833</a>
<a id="L2834" class="source_line" href="#L2834">2834</a>
<a id="L2835" class="source_line" href="#L2835">2835</a>
<a id="L2836" class="source_line" href="#L2836">2836</a>
<a id="L2837" class="source_line" href="#L2837">2837</a>
<a id="L2838" class="source_line" href="#L2838">2838</a>
<a id="L2839" class="source_line" href="#L2839">2839</a>
<a id="L2840" class="source_line" href="#L2840">2840</a>
<a id="L2841" class="source_line" href="#L2841">2841</a>
<a id="L2842" class="source_line" href="#L2842">2842</a>
<a id="L2843" class="source_line" href="#L2843">2843</a>
<a id="L2844" class="source_line" href="#L2844">2844</a>
<a id="L2845" class="source_line" href="#L2845">2845</a>
<a id="L2846" class="source_line" href="#L2846">2846</a>
<a id="L2847" class="source_line" href="#L2847">2847</a>
<a id="L2848" class="source_line" href="#L2848">2848</a>
<a id="L2849" class="source_line" href="#L2849">2849</a>
<a id="L2850" class="source_line" href="#L2850">2850</a>
<a id="L2851" class="source_line" href="#L2851">2851</a>
<a id="L2852" class="source_line" href="#L2852">2852</a>
<a id="L2853" class="source_line" href="#L2853">2853</a>
<a id="L2854" class="source_line" href="#L2854">2854</a>
<a id="L2855" class="source_line" href="#L2855">2855</a>
<a id="L2856" class="source_line" href="#L2856">2856</a>
<a id="L2857" class="source_line" href="#L2857">2857</a>
<a id="L2858" class="source_line" href="#L2858">2858</a>
<a id="L2859" class="source_line" href="#L2859">2859</a>
<a id="L2860" class="source_line" href="#L2860">2860</a>
<a id="L2861" class="source_line" href="#L2861">2861</a>
<a id="L2862" class="source_line" href="#L2862">2862</a>
<a id="L2863" class="source_line" href="#L2863">2863</a>
<a id="L2864" class="source_line" href="#L2864">2864</a>
<a id="L2865" class="source_line" href="#L2865">2865</a>
<a id="L2866" class="source_line" href="#L2866">2866</a>
<a id="L2867" class="source_line" href="#L2867">2867</a>
<a id="L2868" class="source_line" href="#L2868">2868</a>
<a id="L2869" class="source_line" href="#L2869">2869</a>
<a id="L2870" class="source_line" href="#L2870">2870</a>
<a id="L2871" class="source_line" href="#L2871">2871</a>
<a id="L2872" class="source_line" href="#L2872">2872</a>
<a id="L2873" class="source_line" href="#L2873">2873</a>
<a id="L2874" class="source_line" href="#L2874">2874</a>
<a id="L2875" class="source_line" href="#L2875">2875</a>
<a id="L2876" class="source_line" href="#L2876">2876</a>
<a id="L2877" class="source_line" href="#L2877">2877</a>
<a id="L2878" class="source_line" href="#L2878">2878</a>
<a id="L2879" class="source_line" href="#L2879">2879</a>
<a id="L2880" class="source_line" href="#L2880">2880</a>
<a id="L2881" class="source_line" href="#L2881">2881</a>
<a id="L2882" class="source_line" href="#L2882">2882</a>
<a id="L2883" class="source_line" href="#L2883">2883</a>
<a id="L2884" class="source_line" href="#L2884">2884</a>
<a id="L2885" class="source_line" href="#L2885">2885</a>
<a id="L2886" class="source_line" href="#L2886">2886</a>
<a id="L2887" class="source_line" href="#L2887">2887</a>
<a id="L2888" class="source_line" href="#L2888">2888</a>
<a id="L2889" class="source_line" href="#L2889">2889</a>
<a id="L2890" class="source_line" href="#L2890">2890</a>
<a id="L2891" class="source_line" href="#L2891">2891</a>
<a id="L2892" class="source_line" href="#L2892">2892</a>
<a id="L2893" class="source_line" href="#L2893">2893</a>
<a id="L2894" class="source_line" href="#L2894">2894</a>
<a id="L2895" class="source_line" href="#L2895">2895</a>
<a id="L2896" class="source_line" href="#L2896">2896</a>
<a id="L2897" class="source_line" href="#L2897">2897</a>
<a id="L2898" class="source_line" href="#L2898">2898</a>
<a id="L2899" class="source_line" href="#L2899">2899</a>
<a id="L2900" class="source_line" href="#L2900">2900</a>
<a id="L2901" class="source_line" href="#L2901">2901</a>
<a id="L2902" class="source_line" href="#L2902">2902</a>
<a id="L2903" class="source_line" href="#L2903">2903</a>
<a id="L2904" class="source_line" href="#L2904">2904</a>
<a id="L2905" class="source_line" href="#L2905">2905</a>
<a id="L2906" class="source_line" href="#L2906">2906</a>
<a id="L2907" class="source_line" href="#L2907">2907</a>
<a id="L2908" class="source_line" href="#L2908">2908</a>
<a id="L2909" class="source_line" href="#L2909">2909</a>
<a id="L2910" class="source_line" href="#L2910">2910</a>
<a id="L2911" class="source_line" href="#L2911">2911</a>
<a id="L2912" class="source_line" href="#L2912">2912</a>
<a id="L2913" class="source_line" href="#L2913">2913</a>
<a id="L2914" class="source_line" href="#L2914">2914</a>
<a id="L2915" class="source_line" href="#L2915">2915</a>
<a id="L2916" class="source_line" href="#L2916">2916</a>
<a id="L2917" class="source_line" href="#L2917">2917</a>
<a id="L2918" class="source_line" href="#L2918">2918</a>
<a id="L2919" class="source_line" href="#L2919">2919</a>
<a id="L2920" class="source_line" href="#L2920">2920</a>
<a id="L2921" class="source_line" href="#L2921">2921</a>
<a id="L2922" class="source_line" href="#L2922">2922</a>
<a id="L2923" class="source_line" href="#L2923">2923</a>
<a id="L2924" class="source_line" href="#L2924">2924</a>
<a id="L2925" class="source_line" href="#L2925">2925</a>
<a id="L2926" class="source_line" href="#L2926">2926</a>
<a id="L2927" class="source_line" href="#L2927">2927</a>
<a id="L2928" class="source_line" href="#L2928">2928</a>
<a id="L2929" class="source_line" href="#L2929">2929</a>
<a id="L2930" class="source_line" href="#L2930">2930</a>
<a id="L2931" class="source_line" href="#L2931">2931</a>
<a id="L2932" class="source_line" href="#L2932">2932</a>
<a id="L2933" class="source_line" href="#L2933">2933</a>
<a id="L2934" class="source_line" href="#L2934">2934</a>
<a id="L2935" class="source_line" href="#L2935">2935</a>
<a id="L2936" class="source_line" href="#L2936">2936</a>
<a id="L2937" class="source_line" href="#L2937">2937</a>
<a id="L2938" class="source_line" href="#L2938">2938</a>
<a id="L2939" class="source_line" href="#L2939">2939</a>
<a id="L2940" class="source_line" href="#L2940">2940</a>
<a id="L2941" class="source_line" href="#L2941">2941</a>
<a id="L2942" class="source_line" href="#L2942">2942</a>
<a id="L2943" class="source_line" href="#L2943">2943</a>
<a id="L2944" class="source_line" href="#L2944">2944</a>
<a id="L2945" class="source_line" href="#L2945">2945</a>
<a id="L2946" class="source_line" href="#L2946">2946</a>
<a id="L2947" class="source_line" href="#L2947">2947</a>
<a id="L2948" class="source_line" href="#L2948">2948</a>
<a id="L2949" class="source_line" href="#L2949">2949</a>
<a id="L2950" class="source_line" href="#L2950">2950</a>
<a id="L2951" class="source_line" href="#L2951">2951</a>
<a id="L2952" class="source_line" href="#L2952">2952</a>
<a id="L2953" class="source_line" href="#L2953">2953</a>
<a id="L2954" class="source_line" href="#L2954">2954</a>
<a id="L2955" class="source_line" href="#L2955">2955</a>
<a id="L2956" class="source_line" href="#L2956">2956</a>
<a id="L2957" class="source_line" href="#L2957">2957</a>
<a id="L2958" class="source_line" href="#L2958">2958</a>
<a id="L2959" class="source_line" href="#L2959">2959</a>
<a id="L2960" class="source_line" href="#L2960">2960</a>
<a id="L2961" class="source_line" href="#L2961">2961</a>
<a id="L2962" class="source_line" href="#L2962">2962</a>
<a id="L2963" class="source_line" href="#L2963">2963</a>
<a id="L2964" class="source_line" href="#L2964">2964</a>
<a id="L2965" class="source_line" href="#L2965">2965</a>
<a id="L2966" class="source_line" href="#L2966">2966</a>
<a id="L2967" class="source_line" href="#L2967">2967</a>
<a id="L2968" class="source_line" href="#L2968">2968</a>
<a id="L2969" class="source_line" href="#L2969">2969</a>
<a id="L2970" class="source_line" href="#L2970">2970</a>
<a id="L2971" class="source_line" href="#L2971">2971</a>
<a id="L2972" class="source_line" href="#L2972">2972</a>
<a id="L2973" class="source_line" href="#L2973">2973</a>
<a id="L2974" class="source_line" href="#L2974">2974</a>
<a id="L2975" class="source_line" href="#L2975">2975</a>
<a id="L2976" class="source_line" href="#L2976">2976</a>
<a id="L2977" class="source_line" href="#L2977">2977</a>
<a id="L2978" class="source_line" href="#L2978">2978</a>
<a id="L2979" class="source_line" href="#L2979">2979</a>
<a id="L2980" class="source_line" href="#L2980">2980</a>
<a id="L2981" class="source_line" href="#L2981">2981</a>
<a id="L2982" class="source_line" href="#L2982">2982</a>
<a id="L2983" class="source_line" href="#L2983">2983</a>
<a id="L2984" class="source_line" href="#L2984">2984</a>
<a id="L2985" class="source_line" href="#L2985">2985</a>
<a id="L2986" class="source_line" href="#L2986">2986</a>
<a id="L2987" class="source_line" href="#L2987">2987</a>
<a id="L2988" class="source_line" href="#L2988">2988</a>
<a id="L2989" class="source_line" href="#L2989">2989</a>
<a id="L2990" class="source_line" href="#L2990">2990</a>
<a id="L2991" class="source_line" href="#L2991">2991</a>
<a id="L2992" class="source_line" href="#L2992">2992</a>
<a id="L2993" class="source_line" href="#L2993">2993</a>
<a id="L2994" class="source_line" href="#L2994">2994</a>
<a id="L2995" class="source_line" href="#L2995">2995</a>
<a id="L2996" class="source_line" href="#L2996">2996</a>
<a id="L2997" class="source_line" href="#L2997">2997</a>
<a id="L2998" class="source_line" href="#L2998">2998</a>
<a id="L2999" class="source_line" href="#L2999">2999</a>
<a id="L3000" class="source_line" href="#L3000">3000</a>
<a id="L3001" class="source_line" href="#L3001">3001</a>
<a id="L3002" class="source_line" href="#L3002">3002</a>
<a id="L3003" class="source_line" href="#L3003">3003</a>
<a id="L3004" class="source_line" href="#L3004">3004</a>
<a id="L3005" class="source_line" href="#L3005">3005</a>
<a id="L3006" class="source_line" href="#L3006">3006</a>
<a id="L3007" class="source_line" href="#L3007">3007</a>
<a id="L3008" class="source_line" href="#L3008">3008</a>
<a id="L3009" class="source_line" href="#L3009">3009</a>
<a id="L3010" class="source_line" href="#L3010">3010</a>
<a id="L3011" class="source_line" href="#L3011">3011</a>
<a id="L3012" class="source_line" href="#L3012">3012</a>
<a id="L3013" class="source_line" href="#L3013">3013</a>
<a id="L3014" class="source_line" href="#L3014">3014</a>
<a id="L3015" class="source_line" href="#L3015">3015</a>
<a id="L3016" class="source_line" href="#L3016">3016</a>
<a id="L3017" class="source_line" href="#L3017">3017</a>
<a id="L3018" class="source_line" href="#L3018">3018</a>
<a id="L3019" class="source_line" href="#L3019">3019</a>
<a id="L3020" class="source_line" href="#L3020">3020</a>
<a id="L3021" class="source_line" href="#L3021">3021</a>
<a id="L3022" class="source_line" href="#L3022">3022</a>
<a id="L3023" class="source_line" href="#L3023">3023</a>
<a id="L3024" class="source_line" href="#L3024">3024</a>
<a id="L3025" class="source_line" href="#L3025">3025</a>
<a id="L3026" class="source_line" href="#L3026">3026</a>
<a id="L3027" class="source_line" href="#L3027">3027</a>
<a id="L3028" class="source_line" href="#L3028">3028</a>
<a id="L3029" class="source_line" href="#L3029">3029</a>
<a id="L3030" class="source_line" href="#L3030">3030</a>
<a id="L3031" class="source_line" href="#L3031">3031</a>
<a id="L3032" class="source_line" href="#L3032">3032</a>
<a id="L3033" class="source_line" href="#L3033">3033</a>
<a id="L3034" class="source_line" href="#L3034">3034</a>
<a id="L3035" class="source_line" href="#L3035">3035</a>
<a id="L3036" class="source_line" href="#L3036">3036</a>
<a id="L3037" class="source_line" href="#L3037">3037</a>
<a id="L3038" class="source_line" href="#L3038">3038</a>
<a id="L3039" class="source_line" href="#L3039">3039</a>
<a id="L3040" class="source_line" href="#L3040">3040</a>
<a id="L3041" class="source_line" href="#L3041">3041</a>
<a id="L3042" class="source_line" href="#L3042">3042</a>
<a id="L3043" class="source_line" href="#L3043">3043</a>
<a id="L3044" class="source_line" href="#L3044">3044</a>
<a id="L3045" class="source_line" href="#L3045">3045</a>
<a id="L3046" class="source_line" href="#L3046">3046</a>
<a id="L3047" class="source_line" href="#L3047">3047</a>
<a id="L3048" class="source_line" href="#L3048">3048</a>
<a id="L3049" class="source_line" href="#L3049">3049</a>
<a id="L3050" class="source_line" href="#L3050">3050</a>
<a id="L3051" class="source_line" href="#L3051">3051</a>
<a id="L3052" class="source_line" href="#L3052">3052</a>
<a id="L3053" class="source_line" href="#L3053">3053</a>
<a id="L3054" class="source_line" href="#L3054">3054</a>
<a id="L3055" class="source_line" href="#L3055">3055</a>
<a id="L3056" class="source_line" href="#L3056">3056</a>
<a id="L3057" class="source_line" href="#L3057">3057</a>
<a id="L3058" class="source_line" href="#L3058">3058</a>
<a id="L3059" class="source_line" href="#L3059">3059</a>
<a id="L3060" class="source_line" href="#L3060">3060</a>
<a id="L3061" class="source_line" href="#L3061">3061</a>
<a id="L3062" class="source_line" href="#L3062">3062</a>
<a id="L3063" class="source_line" href="#L3063">3063</a>
<a id="L3064" class="source_line" href="#L3064">3064</a>
<a id="L3065" class="source_line" href="#L3065">3065</a>
<a id="L3066" class="source_line" href="#L3066">3066</a>
<a id="L3067" class="source_line" href="#L3067">3067</a>
<a id="L3068" class="source_line" href="#L3068">3068</a>
<a id="L3069" class="source_line" href="#L3069">3069</a>
<a id="L3070" class="source_line" href="#L3070">3070</a>
<a id="L3071" class="source_line" href="#L3071">3071</a>
<a id="L3072" class="source_line" href="#L3072">3072</a>
<a id="L3073" class="source_line" href="#L3073">3073</a>
<a id="L3074" class="source_line" href="#L3074">3074</a>
<a id="L3075" class="source_line" href="#L3075">3075</a>
<a id="L3076" class="source_line" href="#L3076">3076</a>
<a id="L3077" class="source_line" href="#L3077">3077</a>
<a id="L3078" class="source_line" href="#L3078">3078</a>
<a id="L3079" class="source_line" href="#L3079">3079</a>
<a id="L3080" class="source_line" href="#L3080">3080</a>
<a id="L3081" class="source_line" href="#L3081">3081</a>
<a id="L3082" class="source_line" href="#L3082">3082</a>
<a id="L3083" class="source_line" href="#L3083">3083</a>
<a id="L3084" class="source_line" href="#L3084">3084</a>
<a id="L3085" class="source_line" href="#L3085">3085</a>
<a id="L3086" class="source_line" href="#L3086">3086</a>
<a id="L3087" class="source_line" href="#L3087">3087</a>
<a id="L3088" class="source_line" href="#L3088">3088</a>
<a id="L3089" class="source_line" href="#L3089">3089</a>
<a id="L3090" class="source_line" href="#L3090">3090</a>
<a id="L3091" class="source_line" href="#L3091">3091</a>
<a id="L3092" class="source_line" href="#L3092">3092</a>
<a id="L3093" class="source_line" href="#L3093">3093</a>
<a id="L3094" class="source_line" href="#L3094">3094</a>
<a id="L3095" class="source_line" href="#L3095">3095</a>
<a id="L3096" class="source_line" href="#L3096">3096</a>
<a id="L3097" class="source_line" href="#L3097">3097</a>
<a id="L3098" class="source_line" href="#L3098">3098</a>
<a id="L3099" class="source_line" href="#L3099">3099</a>
<a id="L3100" class="source_line" href="#L3100">3100</a>
<a id="L3101" class="source_line" href="#L3101">3101</a>
<a id="L3102" class="source_line" href="#L3102">3102</a>
<a id="L3103" class="source_line" href="#L3103">3103</a>
<a id="L3104" class="source_line" href="#L3104">3104</a>
<a id="L3105" class="source_line" href="#L3105">3105</a>
<a id="L3106" class="source_line" href="#L3106">3106</a>
<a id="L3107" class="source_line" href="#L3107">3107</a>
<a id="L3108" class="source_line" href="#L3108">3108</a>
<a id="L3109" class="source_line" href="#L3109">3109</a>
<a id="L3110" class="source_line" href="#L3110">3110</a>
<a id="L3111" class="source_line" href="#L3111">3111</a>
<a id="L3112" class="source_line" href="#L3112">3112</a>
<a id="L3113" class="source_line" href="#L3113">3113</a>
<a id="L3114" class="source_line" href="#L3114">3114</a>
<a id="L3115" class="source_line" href="#L3115">3115</a>
<a id="L3116" class="source_line" href="#L3116">3116</a>
<a id="L3117" class="source_line" href="#L3117">3117</a>
<a id="L3118" class="source_line" href="#L3118">3118</a>
<a id="L3119" class="source_line" href="#L3119">3119</a>
<a id="L3120" class="source_line" href="#L3120">3120</a>
<a id="L3121" class="source_line" href="#L3121">3121</a>
<a id="L3122" class="source_line" href="#L3122">3122</a>
<a id="L3123" class="source_line" href="#L3123">3123</a>
<a id="L3124" class="source_line" href="#L3124">3124</a>
<a id="L3125" class="source_line" href="#L3125">3125</a>
<a id="L3126" class="source_line" href="#L3126">3126</a>
<a id="L3127" class="source_line" href="#L3127">3127</a>
<a id="L3128" class="source_line" href="#L3128">3128</a>
<a id="L3129" class="source_line" href="#L3129">3129</a>
<a id="L3130" class="source_line" href="#L3130">3130</a>
<a id="L3131" class="source_line" href="#L3131">3131</a>
<a id="L3132" class="source_line" href="#L3132">3132</a>
<a id="L3133" class="source_line" href="#L3133">3133</a>
<a id="L3134" class="source_line" href="#L3134">3134</a>
<a id="L3135" class="source_line" href="#L3135">3135</a>
<a id="L3136" class="source_line" href="#L3136">3136</a>
<a id="L3137" class="source_line" href="#L3137">3137</a>
<a id="L3138" class="source_line" href="#L3138">3138</a>
<a id="L3139" class="source_line" href="#L3139">3139</a>
<a id="L3140" class="source_line" href="#L3140">3140</a>
<a id="L3141" class="source_line" href="#L3141">3141</a>
<a id="L3142" class="source_line" href="#L3142">3142</a>
<a id="L3143" class="source_line" href="#L3143">3143</a>
<a id="L3144" class="source_line" href="#L3144">3144</a>
<a id="L3145" class="source_line" href="#L3145">3145</a>
<a id="L3146" class="source_line" href="#L3146">3146</a>
<a id="L3147" class="source_line" href="#L3147">3147</a>
<a id="L3148" class="source_line" href="#L3148">3148</a>
<a id="L3149" class="source_line" href="#L3149">3149</a>
<a id="L3150" class="source_line" href="#L3150">3150</a>
<a id="L3151" class="source_line" href="#L3151">3151</a>
<a id="L3152" class="source_line" href="#L3152">3152</a>
<a id="L3153" class="source_line" href="#L3153">3153</a>
<a id="L3154" class="source_line" href="#L3154">3154</a>
<a id="L3155" class="source_line" href="#L3155">3155</a>
<a id="L3156" class="source_line" href="#L3156">3156</a>
<a id="L3157" class="source_line" href="#L3157">3157</a>
<a id="L3158" class="source_line" href="#L3158">3158</a>
<a id="L3159" class="source_line" href="#L3159">3159</a>
<a id="L3160" class="source_line" href="#L3160">3160</a>
<a id="L3161" class="source_line" href="#L3161">3161</a>
<a id="L3162" class="source_line" href="#L3162">3162</a>
<a id="L3163" class="source_line" href="#L3163">3163</a>
<a id="L3164" class="source_line" href="#L3164">3164</a>
<a id="L3165" class="source_line" href="#L3165">3165</a>
<a id="L3166" class="source_line" href="#L3166">3166</a>
<a id="L3167" class="source_line" href="#L3167">3167</a>
<a id="L3168" class="source_line" href="#L3168">3168</a>
<a id="L3169" class="source_line" href="#L3169">3169</a>
<a id="L3170" class="source_line" href="#L3170">3170</a>
<a id="L3171" class="source_line" href="#L3171">3171</a>
<a id="L3172" class="source_line" href="#L3172">3172</a>
<a id="L3173" class="source_line" href="#L3173">3173</a>
<a id="L3174" class="source_line" href="#L3174">3174</a>
<a id="L3175" class="source_line" href="#L3175">3175</a>
<a id="L3176" class="source_line" href="#L3176">3176</a>
<a id="L3177" class="source_line" href="#L3177">3177</a>
<a id="L3178" class="source_line" href="#L3178">3178</a>
<a id="L3179" class="source_line" href="#L3179">3179</a>
<a id="L3180" class="source_line" href="#L3180">3180</a>
<a id="L3181" class="source_line" href="#L3181">3181</a>
<a id="L3182" class="source_line" href="#L3182">3182</a>
<a id="L3183" class="source_line" href="#L3183">3183</a>
<a id="L3184" class="source_line" href="#L3184">3184</a>
<a id="L3185" class="source_line" href="#L3185">3185</a>
<a id="L3186" class="source_line" href="#L3186">3186</a>
<a id="L3187" class="source_line" href="#L3187">3187</a>
<a id="L3188" class="source_line" href="#L3188">3188</a>
<a id="L3189" class="source_line" href="#L3189">3189</a>
<a id="L3190" class="source_line" href="#L3190">3190</a>
<a id="L3191" class="source_line" href="#L3191">3191</a>
<a id="L3192" class="source_line" href="#L3192">3192</a>
<a id="L3193" class="source_line" href="#L3193">3193</a>
<a id="L3194" class="source_line" href="#L3194">3194</a>
<a id="L3195" class="source_line" href="#L3195">3195</a>
<a id="L3196" class="source_line" href="#L3196">3196</a>
<a id="L3197" class="source_line" href="#L3197">3197</a>
<a id="L3198" class="source_line" href="#L3198">3198</a>
<a id="L3199" class="source_line" href="#L3199">3199</a>
<a id="L3200" class="source_line" href="#L3200">3200</a>
<a id="L3201" class="source_line" href="#L3201">3201</a>
<a id="L3202" class="source_line" href="#L3202">3202</a>
<a id="L3203" class="source_line" href="#L3203">3203</a>
<a id="L3204" class="source_line" href="#L3204">3204</a>
<a id="L3205" class="source_line" href="#L3205">3205</a>
<a id="L3206" class="source_line" href="#L3206">3206</a>
<a id="L3207" class="source_line" href="#L3207">3207</a>
<a id="L3208" class="source_line" href="#L3208">3208</a>
<a id="L3209" class="source_line" href="#L3209">3209</a>
<a id="L3210" class="source_line" href="#L3210">3210</a>
<a id="L3211" class="source_line" href="#L3211">3211</a>
<a id="L3212" class="source_line" href="#L3212">3212</a>
<a id="L3213" class="source_line" href="#L3213">3213</a>
<a id="L3214" class="source_line" href="#L3214">3214</a>
<a id="L3215" class="source_line" href="#L3215">3215</a>
<a id="L3216" class="source_line" href="#L3216">3216</a>
<a id="L3217" class="source_line" href="#L3217">3217</a>
<a id="L3218" class="source_line" href="#L3218">3218</a>
<a id="L3219" class="source_line" href="#L3219">3219</a>
<a id="L3220" class="source_line" href="#L3220">3220</a>
<a id="L3221" class="source_line" href="#L3221">3221</a>
<a id="L3222" class="source_line" href="#L3222">3222</a>
<a id="L3223" class="source_line" href="#L3223">3223</a>
<a id="L3224" class="source_line" href="#L3224">3224</a>
<a id="L3225" class="source_line" href="#L3225">3225</a>
<a id="L3226" class="source_line" href="#L3226">3226</a>
<a id="L3227" class="source_line" href="#L3227">3227</a>
<a id="L3228" class="source_line" href="#L3228">3228</a>
<a id="L3229" class="source_line" href="#L3229">3229</a>
<a id="L3230" class="source_line" href="#L3230">3230</a>
<a id="L3231" class="source_line" href="#L3231">3231</a>
<a id="L3232" class="source_line" href="#L3232">3232</a>
<a id="L3233" class="source_line" href="#L3233">3233</a>
<a id="L3234" class="source_line" href="#L3234">3234</a>
<a id="L3235" class="source_line" href="#L3235">3235</a>
<a id="L3236" class="source_line" href="#L3236">3236</a>
<a id="L3237" class="source_line" href="#L3237">3237</a>
<a id="L3238" class="source_line" href="#L3238">3238</a>
<a id="L3239" class="source_line" href="#L3239">3239</a>
<a id="L3240" class="source_line" href="#L3240">3240</a>
<a id="L3241" class="source_line" href="#L3241">3241</a>
<a id="L3242" class="source_line" href="#L3242">3242</a>
<a id="L3243" class="source_line" href="#L3243">3243</a>
<a id="L3244" class="source_line" href="#L3244">3244</a>
<a id="L3245" class="source_line" href="#L3245">3245</a>
<a id="L3246" class="source_line" href="#L3246">3246</a>
<a id="L3247" class="source_line" href="#L3247">3247</a>
<a id="L3248" class="source_line" href="#L3248">3248</a>
<a id="L3249" class="source_line" href="#L3249">3249</a>
<a id="L3250" class="source_line" href="#L3250">3250</a>
<a id="L3251" class="source_line" href="#L3251">3251</a>
<a id="L3252" class="source_line" href="#L3252">3252</a>
<a id="L3253" class="source_line" href="#L3253">3253</a>
<a id="L3254" class="source_line" href="#L3254">3254</a>
<a id="L3255" class="source_line" href="#L3255">3255</a>
<a id="L3256" class="source_line" href="#L3256">3256</a>
<a id="L3257" class="source_line" href="#L3257">3257</a>
<a id="L3258" class="source_line" href="#L3258">3258</a>
<a id="L3259" class="source_line" href="#L3259">3259</a>
<a id="L3260" class="source_line" href="#L3260">3260</a>
<a id="L3261" class="source_line" href="#L3261">3261</a>
<a id="L3262" class="source_line" href="#L3262">3262</a>
<a id="L3263" class="source_line" href="#L3263">3263</a>
<a id="L3264" class="source_line" href="#L3264">3264</a>
<a id="L3265" class="source_line" href="#L3265">3265</a>
<a id="L3266" class="source_line" href="#L3266">3266</a>
<a id="L3267" class="source_line" href="#L3267">3267</a>
<a id="L3268" class="source_line" href="#L3268">3268</a>
<a id="L3269" class="source_line" href="#L3269">3269</a>
<a id="L3270" class="source_line" href="#L3270">3270</a>
<a id="L3271" class="source_line" href="#L3271">3271</a>
<a id="L3272" class="source_line" href="#L3272">3272</a>
<a id="L3273" class="source_line" href="#L3273">3273</a>
<a id="L3274" class="source_line" href="#L3274">3274</a>
<a id="L3275" class="source_line" href="#L3275">3275</a>
<a id="L3276" class="source_line" href="#L3276">3276</a>
<a id="L3277" class="source_line" href="#L3277">3277</a>
<a id="L3278" class="source_line" href="#L3278">3278</a>
<a id="L3279" class="source_line" href="#L3279">3279</a>
<a id="L3280" class="source_line" href="#L3280">3280</a>
<a id="L3281" class="source_line" href="#L3281">3281</a>
<a id="L3282" class="source_line" href="#L3282">3282</a>
<a id="L3283" class="source_line" href="#L3283">3283</a>
<a id="L3284" class="source_line" href="#L3284">3284</a>
<a id="L3285" class="source_line" href="#L3285">3285</a>
<a id="L3286" class="source_line" href="#L3286">3286</a>
<a id="L3287" class="source_line" href="#L3287">3287</a>
<a id="L3288" class="source_line" href="#L3288">3288</a>
<a id="L3289" class="source_line" href="#L3289">3289</a>
<a id="L3290" class="source_line" href="#L3290">3290</a>
<a id="L3291" class="source_line" href="#L3291">3291</a>
<a id="L3292" class="source_line" href="#L3292">3292</a>
<a id="L3293" class="source_line" href="#L3293">3293</a>
<a id="L3294" class="source_line" href="#L3294">3294</a>
<a id="L3295" class="source_line" href="#L3295">3295</a>
<a id="L3296" class="source_line" href="#L3296">3296</a>
<a id="L3297" class="source_line" href="#L3297">3297</a>
<a id="L3298" class="source_line" href="#L3298">3298</a>
<a id="L3299" class="source_line" href="#L3299">3299</a>
<a id="L3300" class="source_line" href="#L3300">3300</a>
<a id="L3301" class="source_line" href="#L3301">3301</a>
<a id="L3302" class="source_line" href="#L3302">3302</a>
<a id="L3303" class="source_line" href="#L3303">3303</a>
<a id="L3304" class="source_line" href="#L3304">3304</a>
<a id="L3305" class="source_line" href="#L3305">3305</a>
<a id="L3306" class="source_line" href="#L3306">3306</a>
<a id="L3307" class="source_line" href="#L3307">3307</a>
<a id="L3308" class="source_line" href="#L3308">3308</a>
<a id="L3309" class="source_line" href="#L3309">3309</a>
<a id="L3310" class="source_line" href="#L3310">3310</a>
<a id="L3311" class="source_line" href="#L3311">3311</a>
<a id="L3312" class="source_line" href="#L3312">3312</a>
<a id="L3313" class="source_line" href="#L3313">3313</a>
<a id="L3314" class="source_line" href="#L3314">3314</a>
<a id="L3315" class="source_line" href="#L3315">3315</a>
<a id="L3316" class="source_line" href="#L3316">3316</a>
<a id="L3317" class="source_line" href="#L3317">3317</a>
<a id="L3318" class="source_line" href="#L3318">3318</a>
<a id="L3319" class="source_line" href="#L3319">3319</a>
<a id="L3320" class="source_line" href="#L3320">3320</a>
<a id="L3321" class="source_line" href="#L3321">3321</a>
<a id="L3322" class="source_line" href="#L3322">3322</a>
<a id="L3323" class="source_line" href="#L3323">3323</a>
<a id="L3324" class="source_line" href="#L3324">3324</a>
<a id="L3325" class="source_line" href="#L3325">3325</a>
<a id="L3326" class="source_line" href="#L3326">3326</a>
<a id="L3327" class="source_line" href="#L3327">3327</a>
<a id="L3328" class="source_line" href="#L3328">3328</a>
<a id="L3329" class="source_line" href="#L3329">3329</a>
<a id="L3330" class="source_line" href="#L3330">3330</a>
<a id="L3331" class="source_line" href="#L3331">3331</a>
<a id="L3332" class="source_line" href="#L3332">3332</a>
<a id="L3333" class="source_line" href="#L3333">3333</a>
<a id="L3334" class="source_line" href="#L3334">3334</a>
<a id="L3335" class="source_line" href="#L3335">3335</a>
<a id="L3336" class="source_line" href="#L3336">3336</a>
<a id="L3337" class="source_line" href="#L3337">3337</a>
<a id="L3338" class="source_line" href="#L3338">3338</a>
<a id="L3339" class="source_line" href="#L3339">3339</a>
<a id="L3340" class="source_line" href="#L3340">3340</a>
<a id="L3341" class="source_line" href="#L3341">3341</a>
<a id="L3342" class="source_line" href="#L3342">3342</a>
<a id="L3343" class="source_line" href="#L3343">3343</a>
<a id="L3344" class="source_line" href="#L3344">3344</a>
<a id="L3345" class="source_line" href="#L3345">3345</a>
<a id="L3346" class="source_line" href="#L3346">3346</a>
<a id="L3347" class="source_line" href="#L3347">3347</a>
<a id="L3348" class="source_line" href="#L3348">3348</a>
<a id="L3349" class="source_line" href="#L3349">3349</a>
<a id="L3350" class="source_line" href="#L3350">3350</a>
<a id="L3351" class="source_line" href="#L3351">3351</a>
<a id="L3352" class="source_line" href="#L3352">3352</a>
<a id="L3353" class="source_line" href="#L3353">3353</a>
<a id="L3354" class="source_line" href="#L3354">3354</a>
<a id="L3355" class="source_line" href="#L3355">3355</a>
<a id="L3356" class="source_line" href="#L3356">3356</a>
<a id="L3357" class="source_line" href="#L3357">3357</a>
<a id="L3358" class="source_line" href="#L3358">3358</a>
<a id="L3359" class="source_line" href="#L3359">3359</a>
<a id="L3360" class="source_line" href="#L3360">3360</a>
<a id="L3361" class="source_line" href="#L3361">3361</a>
<a id="L3362" class="source_line" href="#L3362">3362</a>
<a id="L3363" class="source_line" href="#L3363">3363</a>
<a id="L3364" class="source_line" href="#L3364">3364</a>
<a id="L3365" class="source_line" href="#L3365">3365</a>
<a id="L3366" class="source_line" href="#L3366">3366</a>
<a id="L3367" class="source_line" href="#L3367">3367</a>
<a id="L3368" class="source_line" href="#L3368">3368</a>
<a id="L3369" class="source_line" href="#L3369">3369</a>
<a id="L3370" class="source_line" href="#L3370">3370</a>
<a id="L3371" class="source_line" href="#L3371">3371</a>
<a id="L3372" class="source_line" href="#L3372">3372</a>
<a id="L3373" class="source_line" href="#L3373">3373</a>
<a id="L3374" class="source_line" href="#L3374">3374</a>
<a id="L3375" class="source_line" href="#L3375">3375</a>
<a id="L3376" class="source_line" href="#L3376">3376</a>
<a id="L3377" class="source_line" href="#L3377">3377</a>
<a id="L3378" class="source_line" href="#L3378">3378</a>
<a id="L3379" class="source_line" href="#L3379">3379</a>
<a id="L3380" class="source_line" href="#L3380">3380</a>
<a id="L3381" class="source_line" href="#L3381">3381</a>
<a id="L3382" class="source_line" href="#L3382">3382</a>
<a id="L3383" class="source_line" href="#L3383">3383</a>
<a id="L3384" class="source_line" href="#L3384">3384</a>
<a id="L3385" class="source_line" href="#L3385">3385</a>
<a id="L3386" class="source_line" href="#L3386">3386</a>
<a id="L3387" class="source_line" href="#L3387">3387</a>
<a id="L3388" class="source_line" href="#L3388">3388</a>
<a id="L3389" class="source_line" href="#L3389">3389</a>
<a id="L3390" class="source_line" href="#L3390">3390</a>
<a id="L3391" class="source_line" href="#L3391">3391</a>
<a id="L3392" class="source_line" href="#L3392">3392</a>
<a id="L3393" class="source_line" href="#L3393">3393</a>
<a id="L3394" class="source_line" href="#L3394">3394</a>
<a id="L3395" class="source_line" href="#L3395">3395</a>
<a id="L3396" class="source_line" href="#L3396">3396</a>
<a id="L3397" class="source_line" href="#L3397">3397</a>
<a id="L3398" class="source_line" href="#L3398">3398</a>
<a id="L3399" class="source_line" href="#L3399">3399</a>
<a id="L3400" class="source_line" href="#L3400">3400</a>
<a id="L3401" class="source_line" href="#L3401">3401</a>
<a id="L3402" class="source_line" href="#L3402">3402</a>
<a id="L3403" class="source_line" href="#L3403">3403</a>
<a id="L3404" class="source_line" href="#L3404">3404</a>
<a id="L3405" class="source_line" href="#L3405">3405</a>
<a id="L3406" class="source_line" href="#L3406">3406</a>
<a id="L3407" class="source_line" href="#L3407">3407</a>
<a id="L3408" class="source_line" href="#L3408">3408</a>
<a id="L3409" class="source_line" href="#L3409">3409</a>
<a id="L3410" class="source_line" href="#L3410">3410</a>
<a id="L3411" class="source_line" href="#L3411">3411</a>
<a id="L3412" class="source_line" href="#L3412">3412</a>
<a id="L3413" class="source_line" href="#L3413">3413</a>
<a id="L3414" class="source_line" href="#L3414">3414</a>
<a id="L3415" class="source_line" href="#L3415">3415</a>
<a id="L3416" class="source_line" href="#L3416">3416</a>
<a id="L3417" class="source_line" href="#L3417">3417</a>
<a id="L3418" class="source_line" href="#L3418">3418</a>
<a id="L3419" class="source_line" href="#L3419">3419</a>
<a id="L3420" class="source_line" href="#L3420">3420</a>
<a id="L3421" class="source_line" href="#L3421">3421</a>
<a id="L3422" class="source_line" href="#L3422">3422</a>
<a id="L3423" class="source_line" href="#L3423">3423</a>
<a id="L3424" class="source_line" href="#L3424">3424</a>
<a id="L3425" class="source_line" href="#L3425">3425</a>
<a id="L3426" class="source_line" href="#L3426">3426</a>
<a id="L3427" class="source_line" href="#L3427">3427</a>
<a id="L3428" class="source_line" href="#L3428">3428</a>
<a id="L3429" class="source_line" href="#L3429">3429</a>
<a id="L3430" class="source_line" href="#L3430">3430</a>
<a id="L3431" class="source_line" href="#L3431">3431</a>
<a id="L3432" class="source_line" href="#L3432">3432</a>
<a id="L3433" class="source_line" href="#L3433">3433</a>
<a id="L3434" class="source_line" href="#L3434">3434</a>
<a id="L3435" class="source_line" href="#L3435">3435</a>
<a id="L3436" class="source_line" href="#L3436">3436</a>
<a id="L3437" class="source_line" href="#L3437">3437</a>
<a id="L3438" class="source_line" href="#L3438">3438</a>
<a id="L3439" class="source_line" href="#L3439">3439</a>
<a id="L3440" class="source_line" href="#L3440">3440</a>
<a id="L3441" class="source_line" href="#L3441">3441</a>
<a id="L3442" class="source_line" href="#L3442">3442</a>
<a id="L3443" class="source_line" href="#L3443">3443</a>
<a id="L3444" class="source_line" href="#L3444">3444</a>
<a id="L3445" class="source_line" href="#L3445">3445</a>
<a id="L3446" class="source_line" href="#L3446">3446</a>
<a id="L3447" class="source_line" href="#L3447">3447</a>
<a id="L3448" class="source_line" href="#L3448">3448</a>
<a id="L3449" class="source_line" href="#L3449">3449</a>
<a id="L3450" class="source_line" href="#L3450">3450</a>
<a id="L3451" class="source_line" href="#L3451">3451</a>
<a id="L3452" class="source_line" href="#L3452">3452</a>
<a id="L3453" class="source_line" href="#L3453">3453</a>
<a id="L3454" class="source_line" href="#L3454">3454</a>
<a id="L3455" class="source_line" href="#L3455">3455</a>
<a id="L3456" class="source_line" href="#L3456">3456</a>
<a id="L3457" class="source_line" href="#L3457">3457</a>
<a id="L3458" class="source_line" href="#L3458">3458</a>
<a id="L3459" class="source_line" href="#L3459">3459</a>
<a id="L3460" class="source_line" href="#L3460">3460</a>
<a id="L3461" class="source_line" href="#L3461">3461</a>
<a id="L3462" class="source_line" href="#L3462">3462</a>
<a id="L3463" class="source_line" href="#L3463">3463</a>
<a id="L3464" class="source_line" href="#L3464">3464</a>
<a id="L3465" class="source_line" href="#L3465">3465</a>
<a id="L3466" class="source_line" href="#L3466">3466</a>
<a id="L3467" class="source_line" href="#L3467">3467</a>
<a id="L3468" class="source_line" href="#L3468">3468</a>
<a id="L3469" class="source_line" href="#L3469">3469</a>
<a id="L3470" class="source_line" href="#L3470">3470</a>
<a id="L3471" class="source_line" href="#L3471">3471</a>
<a id="L3472" class="source_line" href="#L3472">3472</a>
<a id="L3473" class="source_line" href="#L3473">3473</a>
<a id="L3474" class="source_line" href="#L3474">3474</a>
<a id="L3475" class="source_line" href="#L3475">3475</a>
<a id="L3476" class="source_line" href="#L3476">3476</a>
<a id="L3477" class="source_line" href="#L3477">3477</a>
<a id="L3478" class="source_line" href="#L3478">3478</a>
<a id="L3479" class="source_line" href="#L3479">3479</a>
<a id="L3480" class="source_line" href="#L3480">3480</a>
<a id="L3481" class="source_line" href="#L3481">3481</a>
<a id="L3482" class="source_line" href="#L3482">3482</a>
<a id="L3483" class="source_line" href="#L3483">3483</a>
<a id="L3484" class="source_line" href="#L3484">3484</a>
<a id="L3485" class="source_line" href="#L3485">3485</a>
<a id="L3486" class="source_line" href="#L3486">3486</a>
<a id="L3487" class="source_line" href="#L3487">3487</a>
<a id="L3488" class="source_line" href="#L3488">3488</a>
<a id="L3489" class="source_line" href="#L3489">3489</a>
<a id="L3490" class="source_line" href="#L3490">3490</a>
<a id="L3491" class="source_line" href="#L3491">3491</a>
<a id="L3492" class="source_line" href="#L3492">3492</a>
<a id="L3493" class="source_line" href="#L3493">3493</a>
<a id="L3494" class="source_line" href="#L3494">3494</a>
<a id="L3495" class="source_line" href="#L3495">3495</a>
<a id="L3496" class="source_line" href="#L3496">3496</a>
<a id="L3497" class="source_line" href="#L3497">3497</a>
<a id="L3498" class="source_line" href="#L3498">3498</a>
<a id="L3499" class="source_line" href="#L3499">3499</a>
<a id="L3500" class="source_line" href="#L3500">3500</a>
<a id="L3501" class="source_line" href="#L3501">3501</a>
<a id="L3502" class="source_line" href="#L3502">3502</a>
<a id="L3503" class="source_line" href="#L3503">3503</a>
<a id="L3504" class="source_line" href="#L3504">3504</a>
<a id="L3505" class="source_line" href="#L3505">3505</a>
<a id="L3506" class="source_line" href="#L3506">3506</a>
<a id="L3507" class="source_line" href="#L3507">3507</a>
<a id="L3508" class="source_line" href="#L3508">3508</a>
<a id="L3509" class="source_line" href="#L3509">3509</a>
<a id="L3510" class="source_line" href="#L3510">3510</a>
<a id="L3511" class="source_line" href="#L3511">3511</a>
<a id="L3512" class="source_line" href="#L3512">3512</a>
<a id="L3513" class="source_line" href="#L3513">3513</a>
<a id="L3514" class="source_line" href="#L3514">3514</a>
<a id="L3515" class="source_line" href="#L3515">3515</a>
<a id="L3516" class="source_line" href="#L3516">3516</a>
<a id="L3517" class="source_line" href="#L3517">3517</a>
<a id="L3518" class="source_line" href="#L3518">3518</a>
<a id="L3519" class="source_line" href="#L3519">3519</a>
<a id="L3520" class="source_line" href="#L3520">3520</a>
<a id="L3521" class="source_line" href="#L3521">3521</a>
<a id="L3522" class="source_line" href="#L3522">3522</a>
<a id="L3523" class="source_line" href="#L3523">3523</a>
<a id="L3524" class="source_line" href="#L3524">3524</a>
<a id="L3525" class="source_line" href="#L3525">3525</a>
<a id="L3526" class="source_line" href="#L3526">3526</a>
<a id="L3527" class="source_line" href="#L3527">3527</a>
<a id="L3528" class="source_line" href="#L3528">3528</a>
<a id="L3529" class="source_line" href="#L3529">3529</a>
<a id="L3530" class="source_line" href="#L3530">3530</a>
<a id="L3531" class="source_line" href="#L3531">3531</a>
<a id="L3532" class="source_line" href="#L3532">3532</a>
<a id="L3533" class="source_line" href="#L3533">3533</a>
<a id="L3534" class="source_line" href="#L3534">3534</a>
<a id="L3535" class="source_line" href="#L3535">3535</a>
<a id="L3536" class="source_line" href="#L3536">3536</a>
<a id="L3537" class="source_line" href="#L3537">3537</a>
<a id="L3538" class="source_line" href="#L3538">3538</a>
<a id="L3539" class="source_line" href="#L3539">3539</a>
<a id="L3540" class="source_line" href="#L3540">3540</a>
<a id="L3541" class="source_line" href="#L3541">3541</a>
<a id="L3542" class="source_line" href="#L3542">3542</a>
<a id="L3543" class="source_line" href="#L3543">3543</a>
<a id="L3544" class="source_line" href="#L3544">3544</a>
<a id="L3545" class="source_line" href="#L3545">3545</a>
<a id="L3546" class="source_line" href="#L3546">3546</a>
<a id="L3547" class="source_line" href="#L3547">3547</a>
<a id="L3548" class="source_line" href="#L3548">3548</a>
<a id="L3549" class="source_line" href="#L3549">3549</a>
<a id="L3550" class="source_line" href="#L3550">3550</a>
<a id="L3551" class="source_line" href="#L3551">3551</a>
<a id="L3552" class="source_line" href="#L3552">3552</a>
<a id="L3553" class="source_line" href="#L3553">3553</a>
<a id="L3554" class="source_line" href="#L3554">3554</a>
<a id="L3555" class="source_line" href="#L3555">3555</a>
<a id="L3556" class="source_line" href="#L3556">3556</a>
<a id="L3557" class="source_line" href="#L3557">3557</a>
<a id="L3558" class="source_line" href="#L3558">3558</a>
<a id="L3559" class="source_line" href="#L3559">3559</a>
<a id="L3560" class="source_line" href="#L3560">3560</a>
<a id="L3561" class="source_line" href="#L3561">3561</a>
<a id="L3562" class="source_line" href="#L3562">3562</a>
<a id="L3563" class="source_line" href="#L3563">3563</a>
<a id="L3564" class="source_line" href="#L3564">3564</a>
<a id="L3565" class="source_line" href="#L3565">3565</a>
<a id="L3566" class="source_line" href="#L3566">3566</a>
<a id="L3567" class="source_line" href="#L3567">3567</a>
<a id="L3568" class="source_line" href="#L3568">3568</a>
<a id="L3569" class="source_line" href="#L3569">3569</a>
<a id="L3570" class="source_line" href="#L3570">3570</a>
<a id="L3571" class="source_line" href="#L3571">3571</a>
<a id="L3572" class="source_line" href="#L3572">3572</a>
<a id="L3573" class="source_line" href="#L3573">3573</a>
<a id="L3574" class="source_line" href="#L3574">3574</a>
<a id="L3575" class="source_line" href="#L3575">3575</a>
<a id="L3576" class="source_line" href="#L3576">3576</a>
<a id="L3577" class="source_line" href="#L3577">3577</a>
<a id="L3578" class="source_line" href="#L3578">3578</a>
<a id="L3579" class="source_line" href="#L3579">3579</a>
<a id="L3580" class="source_line" href="#L3580">3580</a>
<a id="L3581" class="source_line" href="#L3581">3581</a>
<a id="L3582" class="source_line" href="#L3582">3582</a>
<a id="L3583" class="source_line" href="#L3583">3583</a>
<a id="L3584" class="source_line" href="#L3584">3584</a>
<a id="L3585" class="source_line" href="#L3585">3585</a>
<a id="L3586" class="source_line" href="#L3586">3586</a>
<a id="L3587" class="source_line" href="#L3587">3587</a>
<a id="L3588" class="source_line" href="#L3588">3588</a>
<a id="L3589" class="source_line" href="#L3589">3589</a>
<a id="L3590" class="source_line" href="#L3590">3590</a>
<a id="L3591" class="source_line" href="#L3591">3591</a>
<a id="L3592" class="source_line" href="#L3592">3592</a>
<a id="L3593" class="source_line" href="#L3593">3593</a>
<a id="L3594" class="source_line" href="#L3594">3594</a>
<a id="L3595" class="source_line" href="#L3595">3595</a>
<a id="L3596" class="source_line" href="#L3596">3596</a>
<a id="L3597" class="source_line" href="#L3597">3597</a>
<a id="L3598" class="source_line" href="#L3598">3598</a>
<a id="L3599" class="source_line" href="#L3599">3599</a>
<a id="L3600" class="source_line" href="#L3600">3600</a>
<a id="L3601" class="source_line" href="#L3601">3601</a>
<a id="L3602" class="source_line" href="#L3602">3602</a>
<a id="L3603" class="source_line" href="#L3603">3603</a>
<a id="L3604" class="source_line" href="#L3604">3604</a>
<a id="L3605" class="source_line" href="#L3605">3605</a>
<a id="L3606" class="source_line" href="#L3606">3606</a>
<a id="L3607" class="source_line" href="#L3607">3607</a>
<a id="L3608" class="source_line" href="#L3608">3608</a>
<a id="L3609" class="source_line" href="#L3609">3609</a>
<a id="L3610" class="source_line" href="#L3610">3610</a>
<a id="L3611" class="source_line" href="#L3611">3611</a>
<a id="L3612" class="source_line" href="#L3612">3612</a>
<a id="L3613" class="source_line" href="#L3613">3613</a>
<a id="L3614" class="source_line" href="#L3614">3614</a>
<a id="L3615" class="source_line" href="#L3615">3615</a>
<a id="L3616" class="source_line" href="#L3616">3616</a>
<a id="L3617" class="source_line" href="#L3617">3617</a>
<a id="L3618" class="source_line" href="#L3618">3618</a>
<a id="L3619" class="source_line" href="#L3619">3619</a>
<a id="L3620" class="source_line" href="#L3620">3620</a>
<a id="L3621" class="source_line" href="#L3621">3621</a>
<a id="L3622" class="source_line" href="#L3622">3622</a>
<a id="L3623" class="source_line" href="#L3623">3623</a>
<a id="L3624" class="source_line" href="#L3624">3624</a>
<a id="L3625" class="source_line" href="#L3625">3625</a>
<a id="L3626" class="source_line" href="#L3626">3626</a>
<a id="L3627" class="source_line" href="#L3627">3627</a>
<a id="L3628" class="source_line" href="#L3628">3628</a>
<a id="L3629" class="source_line" href="#L3629">3629</a>
<a id="L3630" class="source_line" href="#L3630">3630</a>
<a id="L3631" class="source_line" href="#L3631">3631</a>
<a id="L3632" class="source_line" href="#L3632">3632</a>
<a id="L3633" class="source_line" href="#L3633">3633</a>
<a id="L3634" class="source_line" href="#L3634">3634</a>
<a id="L3635" class="source_line" href="#L3635">3635</a>
<a id="L3636" class="source_line" href="#L3636">3636</a>
<a id="L3637" class="source_line" href="#L3637">3637</a>
<a id="L3638" class="source_line" href="#L3638">3638</a>
<a id="L3639" class="source_line" href="#L3639">3639</a>
<a id="L3640" class="source_line" href="#L3640">3640</a>
<a id="L3641" class="source_line" href="#L3641">3641</a>
<a id="L3642" class="source_line" href="#L3642">3642</a>
<a id="L3643" class="source_line" href="#L3643">3643</a>
<a id="L3644" class="source_line" href="#L3644">3644</a>
<a id="L3645" class="source_line" href="#L3645">3645</a>
<a id="L3646" class="source_line" href="#L3646">3646</a>
<a id="L3647" class="source_line" href="#L3647">3647</a>
<a id="L3648" class="source_line" href="#L3648">3648</a>
<a id="L3649" class="source_line" href="#L3649">3649</a>
<a id="L3650" class="source_line" href="#L3650">3650</a>
<a id="L3651" class="source_line" href="#L3651">3651</a>
<a id="L3652" class="source_line" href="#L3652">3652</a>
<a id="L3653" class="source_line" href="#L3653">3653</a>
<a id="L3654" class="source_line" href="#L3654">3654</a>
<a id="L3655" class="source_line" href="#L3655">3655</a>
<a id="L3656" class="source_line" href="#L3656">3656</a>
<a id="L3657" class="source_line" href="#L3657">3657</a>
<a id="L3658" class="source_line" href="#L3658">3658</a>
<a id="L3659" class="source_line" href="#L3659">3659</a>
<a id="L3660" class="source_line" href="#L3660">3660</a>
<a id="L3661" class="source_line" href="#L3661">3661</a>
<a id="L3662" class="source_line" href="#L3662">3662</a>
<a id="L3663" class="source_line" href="#L3663">3663</a>
<a id="L3664" class="source_line" href="#L3664">3664</a>
<a id="L3665" class="source_line" href="#L3665">3665</a>
<a id="L3666" class="source_line" href="#L3666">3666</a>
<a id="L3667" class="source_line" href="#L3667">3667</a>
<a id="L3668" class="source_line" href="#L3668">3668</a>
<a id="L3669" class="source_line" href="#L3669">3669</a>
<a id="L3670" class="source_line" href="#L3670">3670</a>
<a id="L3671" class="source_line" href="#L3671">3671</a>
<a id="L3672" class="source_line" href="#L3672">3672</a>
<a id="L3673" class="source_line" href="#L3673">3673</a>
<a id="L3674" class="source_line" href="#L3674">3674</a>
<a id="L3675" class="source_line" href="#L3675">3675</a>
<a id="L3676" class="source_line" href="#L3676">3676</a>
<a id="L3677" class="source_line" href="#L3677">3677</a>
<a id="L3678" class="source_line" href="#L3678">3678</a>
<a id="L3679" class="source_line" href="#L3679">3679</a>
<a id="L3680" class="source_line" href="#L3680">3680</a>
<a id="L3681" class="source_line" href="#L3681">3681</a>
<a id="L3682" class="source_line" href="#L3682">3682</a>
<a id="L3683" class="source_line" href="#L3683">3683</a>
<a id="L3684" class="source_line" href="#L3684">3684</a>
<a id="L3685" class="source_line" href="#L3685">3685</a>
<a id="L3686" class="source_line" href="#L3686">3686</a>
<a id="L3687" class="source_line" href="#L3687">3687</a>
<a id="L3688" class="source_line" href="#L3688">3688</a>
<a id="L3689" class="source_line" href="#L3689">3689</a>
<a id="L3690" class="source_line" href="#L3690">3690</a>
<a id="L3691" class="source_line" href="#L3691">3691</a>
<a id="L3692" class="source_line" href="#L3692">3692</a>
<a id="L3693" class="source_line" href="#L3693">3693</a>
<a id="L3694" class="source_line" href="#L3694">3694</a>
<a id="L3695" class="source_line" href="#L3695">3695</a>
<a id="L3696" class="source_line" href="#L3696">3696</a>
<a id="L3697" class="source_line" href="#L3697">3697</a>
<a id="L3698" class="source_line" href="#L3698">3698</a>
<a id="L3699" class="source_line" href="#L3699">3699</a>
<a id="L3700" class="source_line" href="#L3700">3700</a>
<a id="L3701" class="source_line" href="#L3701">3701</a>
<a id="L3702" class="source_line" href="#L3702">3702</a>
<a id="L3703" class="source_line" href="#L3703">3703</a>
<a id="L3704" class="source_line" href="#L3704">3704</a>
<a id="L3705" class="source_line" href="#L3705">3705</a>
<a id="L3706" class="source_line" href="#L3706">3706</a>
<a id="L3707" class="source_line" href="#L3707">3707</a>
<a id="L3708" class="source_line" href="#L3708">3708</a>
<a id="L3709" class="source_line" href="#L3709">3709</a>
<a id="L3710" class="source_line" href="#L3710">3710</a>
<a id="L3711" class="source_line" href="#L3711">3711</a>
<a id="L3712" class="source_line" href="#L3712">3712</a>
<a id="L3713" class="source_line" href="#L3713">3713</a>
<a id="L3714" class="source_line" href="#L3714">3714</a>
<a id="L3715" class="source_line" href="#L3715">3715</a>
<a id="L3716" class="source_line" href="#L3716">3716</a>
<a id="L3717" class="source_line" href="#L3717">3717</a>
<a id="L3718" class="source_line" href="#L3718">3718</a>
<a id="L3719" class="source_line" href="#L3719">3719</a>
<a id="L3720" class="source_line" href="#L3720">3720</a>
<a id="L3721" class="source_line" href="#L3721">3721</a>
<a id="L3722" class="source_line" href="#L3722">3722</a>
<a id="L3723" class="source_line" href="#L3723">3723</a>
<a id="L3724" class="source_line" href="#L3724">3724</a>
<a id="L3725" class="source_line" href="#L3725">3725</a>
<a id="L3726" class="source_line" href="#L3726">3726</a>
<a id="L3727" class="source_line" href="#L3727">3727</a>
<a id="L3728" class="source_line" href="#L3728">3728</a>
<a id="L3729" class="source_line" href="#L3729">3729</a>
<a id="L3730" class="source_line" href="#L3730">3730</a>
<a id="L3731" class="source_line" href="#L3731">3731</a>
<a id="L3732" class="source_line" href="#L3732">3732</a>
<a id="L3733" class="source_line" href="#L3733">3733</a>
<a id="L3734" class="source_line" href="#L3734">3734</a>
<a id="L3735" class="source_line" href="#L3735">3735</a>
<a id="L3736" class="source_line" href="#L3736">3736</a>
<a id="L3737" class="source_line" href="#L3737">3737</a>
<a id="L3738" class="source_line" href="#L3738">3738</a>
<a id="L3739" class="source_line" href="#L3739">3739</a>
<a id="L3740" class="source_line" href="#L3740">3740</a>
<a id="L3741" class="source_line" href="#L3741">3741</a>
<a id="L3742" class="source_line" href="#L3742">3742</a>
<a id="L3743" class="source_line" href="#L3743">3743</a>
<a id="L3744" class="source_line" href="#L3744">3744</a>
<a id="L3745" class="source_line" href="#L3745">3745</a>
<a id="L3746" class="source_line" href="#L3746">3746</a>
<a id="L3747" class="source_line" href="#L3747">3747</a>
<a id="L3748" class="source_line" href="#L3748">3748</a>
<a id="L3749" class="source_line" href="#L3749">3749</a>
<a id="L3750" class="source_line" href="#L3750">3750</a>
<a id="L3751" class="source_line" href="#L3751">3751</a>
<a id="L3752" class="source_line" href="#L3752">3752</a>
<a id="L3753" class="source_line" href="#L3753">3753</a>
<a id="L3754" class="source_line" href="#L3754">3754</a>
<a id="L3755" class="source_line" href="#L3755">3755</a>
<a id="L3756" class="source_line" href="#L3756">3756</a>
<a id="L3757" class="source_line" href="#L3757">3757</a>
<a id="L3758" class="source_line" href="#L3758">3758</a>
<a id="L3759" class="source_line" href="#L3759">3759</a>
<a id="L3760" class="source_line" href="#L3760">3760</a>
<a id="L3761" class="source_line" href="#L3761">3761</a>
<a id="L3762" class="source_line" href="#L3762">3762</a>
<a id="L3763" class="source_line" href="#L3763">3763</a>
<a id="L3764" class="source_line" href="#L3764">3764</a>
<a id="L3765" class="source_line" href="#L3765">3765</a>
<a id="L3766" class="source_line" href="#L3766">3766</a>
<a id="L3767" class="source_line" href="#L3767">3767</a>
<a id="L3768" class="source_line" href="#L3768">3768</a>
<a id="L3769" class="source_line" href="#L3769">3769</a>
<a id="L3770" class="source_line" href="#L3770">3770</a>
<a id="L3771" class="source_line" href="#L3771">3771</a>
<a id="L3772" class="source_line" href="#L3772">3772</a>
<a id="L3773" class="source_line" href="#L3773">3773</a>
<a id="L3774" class="source_line" href="#L3774">3774</a>
<a id="L3775" class="source_line" href="#L3775">3775</a>
<a id="L3776" class="source_line" href="#L3776">3776</a>
<a id="L3777" class="source_line" href="#L3777">3777</a>
<a id="L3778" class="source_line" href="#L3778">3778</a>
<a id="L3779" class="source_line" href="#L3779">3779</a>
<a id="L3780" class="source_line" href="#L3780">3780</a>
<a id="L3781" class="source_line" href="#L3781">3781</a>
<a id="L3782" class="source_line" href="#L3782">3782</a>
<a id="L3783" class="source_line" href="#L3783">3783</a>
<a id="L3784" class="source_line" href="#L3784">3784</a>
<a id="L3785" class="source_line" href="#L3785">3785</a>
<a id="L3786" class="source_line" href="#L3786">3786</a>
<a id="L3787" class="source_line" href="#L3787">3787</a>
<a id="L3788" class="source_line" href="#L3788">3788</a>
<a id="L3789" class="source_line" href="#L3789">3789</a>
<a id="L3790" class="source_line" href="#L3790">3790</a>
<a id="L3791" class="source_line" href="#L3791">3791</a>
<a id="L3792" class="source_line" href="#L3792">3792</a>
<a id="L3793" class="source_line" href="#L3793">3793</a>
<a id="L3794" class="source_line" href="#L3794">3794</a>
<a id="L3795" class="source_line" href="#L3795">3795</a>
<a id="L3796" class="source_line" href="#L3796">3796</a>
<a id="L3797" class="source_line" href="#L3797">3797</a>
<a id="L3798" class="source_line" href="#L3798">3798</a>
<a id="L3799" class="source_line" href="#L3799">3799</a>
<a id="L3800" class="source_line" href="#L3800">3800</a>
<a id="L3801" class="source_line" href="#L3801">3801</a>
<a id="L3802" class="source_line" href="#L3802">3802</a>
<a id="L3803" class="source_line" href="#L3803">3803</a>
<a id="L3804" class="source_line" href="#L3804">3804</a>
<a id="L3805" class="source_line" href="#L3805">3805</a>
<a id="L3806" class="source_line" href="#L3806">3806</a>
<a id="L3807" class="source_line" href="#L3807">3807</a>
<a id="L3808" class="source_line" href="#L3808">3808</a>
<a id="L3809" class="source_line" href="#L3809">3809</a>
<a id="L3810" class="source_line" href="#L3810">3810</a>
<a id="L3811" class="source_line" href="#L3811">3811</a>
<a id="L3812" class="source_line" href="#L3812">3812</a>
<a id="L3813" class="source_line" href="#L3813">3813</a>
<a id="L3814" class="source_line" href="#L3814">3814</a>
<a id="L3815" class="source_line" href="#L3815">3815</a>
<a id="L3816" class="source_line" href="#L3816">3816</a>
<a id="L3817" class="source_line" href="#L3817">3817</a>
<a id="L3818" class="source_line" href="#L3818">3818</a>
<a id="L3819" class="source_line" href="#L3819">3819</a>
<a id="L3820" class="source_line" href="#L3820">3820</a>
<a id="L3821" class="source_line" href="#L3821">3821</a>
<a id="L3822" class="source_line" href="#L3822">3822</a>
<a id="L3823" class="source_line" href="#L3823">3823</a>
<a id="L3824" class="source_line" href="#L3824">3824</a>
<a id="L3825" class="source_line" href="#L3825">3825</a>
<a id="L3826" class="source_line" href="#L3826">3826</a>
<a id="L3827" class="source_line" href="#L3827">3827</a>
<a id="L3828" class="source_line" href="#L3828">3828</a>
<a id="L3829" class="source_line" href="#L3829">3829</a>
<a id="L3830" class="source_line" href="#L3830">3830</a>
<a id="L3831" class="source_line" href="#L3831">3831</a>
<a id="L3832" class="source_line" href="#L3832">3832</a>
<a id="L3833" class="source_line" href="#L3833">3833</a>
<a id="L3834" class="source_line" href="#L3834">3834</a>
<a id="L3835" class="source_line" href="#L3835">3835</a>
<a id="L3836" class="source_line" href="#L3836">3836</a>
<a id="L3837" class="source_line" href="#L3837">3837</a>
<a id="L3838" class="source_line" href="#L3838">3838</a>
<a id="L3839" class="source_line" href="#L3839">3839</a>
<a id="L3840" class="source_line" href="#L3840">3840</a>
<a id="L3841" class="source_line" href="#L3841">3841</a>
<a id="L3842" class="source_line" href="#L3842">3842</a>
<a id="L3843" class="source_line" href="#L3843">3843</a>
<a id="L3844" class="source_line" href="#L3844">3844</a>
<a id="L3845" class="source_line" href="#L3845">3845</a>
<a id="L3846" class="source_line" href="#L3846">3846</a>
<a id="L3847" class="source_line" href="#L3847">3847</a>
<a id="L3848" class="source_line" href="#L3848">3848</a>
<a id="L3849" class="source_line" href="#L3849">3849</a>
<a id="L3850" class="source_line" href="#L3850">3850</a>
<a id="L3851" class="source_line" href="#L3851">3851</a>
<a id="L3852" class="source_line" href="#L3852">3852</a>
<a id="L3853" class="source_line" href="#L3853">3853</a>
<a id="L3854" class="source_line" href="#L3854">3854</a>
<a id="L3855" class="source_line" href="#L3855">3855</a>
<a id="L3856" class="source_line" href="#L3856">3856</a>
<a id="L3857" class="source_line" href="#L3857">3857</a>
<a id="L3858" class="source_line" href="#L3858">3858</a>
<a id="L3859" class="source_line" href="#L3859">3859</a>
<a id="L3860" class="source_line" href="#L3860">3860</a>
<a id="L3861" class="source_line" href="#L3861">3861</a>
<a id="L3862" class="source_line" href="#L3862">3862</a>
<a id="L3863" class="source_line" href="#L3863">3863</a>
<a id="L3864" class="source_line" href="#L3864">3864</a>
<a id="L3865" class="source_line" href="#L3865">3865</a>
<a id="L3866" class="source_line" href="#L3866">3866</a>
<a id="L3867" class="source_line" href="#L3867">3867</a>
<a id="L3868" class="source_line" href="#L3868">3868</a>
<a id="L3869" class="source_line" href="#L3869">3869</a>
<a id="L3870" class="source_line" href="#L3870">3870</a>
<a id="L3871" class="source_line" href="#L3871">3871</a>
<a id="L3872" class="source_line" href="#L3872">3872</a>
<a id="L3873" class="source_line" href="#L3873">3873</a>
<a id="L3874" class="source_line" href="#L3874">3874</a>
<a id="L3875" class="source_line" href="#L3875">3875</a>
<a id="L3876" class="source_line" href="#L3876">3876</a>
<a id="L3877" class="source_line" href="#L3877">3877</a>
<a id="L3878" class="source_line" href="#L3878">3878</a>
<a id="L3879" class="source_line" href="#L3879">3879</a>
<a id="L3880" class="source_line" href="#L3880">3880</a>
<a id="L3881" class="source_line" href="#L3881">3881</a>
<a id="L3882" class="source_line" href="#L3882">3882</a>
<a id="L3883" class="source_line" href="#L3883">3883</a>
<a id="L3884" class="source_line" href="#L3884">3884</a>
<a id="L3885" class="source_line" href="#L3885">3885</a>
<a id="L3886" class="source_line" href="#L3886">3886</a>
<a id="L3887" class="source_line" href="#L3887">3887</a>
<a id="L3888" class="source_line" href="#L3888">3888</a>
<a id="L3889" class="source_line" href="#L3889">3889</a>
<a id="L3890" class="source_line" href="#L3890">3890</a>
<a id="L3891" class="source_line" href="#L3891">3891</a>
<a id="L3892" class="source_line" href="#L3892">3892</a>
<a id="L3893" class="source_line" href="#L3893">3893</a>
<a id="L3894" class="source_line" href="#L3894">3894</a>
<a id="L3895" class="source_line" href="#L3895">3895</a>
<a id="L3896" class="source_line" href="#L3896">3896</a>
<a id="L3897" class="source_line" href="#L3897">3897</a>
<a id="L3898" class="source_line" href="#L3898">3898</a>
<a id="L3899" class="source_line" href="#L3899">3899</a>
<a id="L3900" class="source_line" href="#L3900">3900</a>
<a id="L3901" class="source_line" href="#L3901">3901</a>
<a id="L3902" class="source_line" href="#L3902">3902</a>
<a id="L3903" class="source_line" href="#L3903">3903</a>
<a id="L3904" class="source_line" href="#L3904">3904</a>
<a id="L3905" class="source_line" href="#L3905">3905</a>
<a id="L3906" class="source_line" href="#L3906">3906</a>
<a id="L3907" class="source_line" href="#L3907">3907</a>
<a id="L3908" class="source_line" href="#L3908">3908</a>
<a id="L3909" class="source_line" href="#L3909">3909</a>
<a id="L3910" class="source_line" href="#L3910">3910</a>
<a id="L3911" class="source_line" href="#L3911">3911</a>
<a id="L3912" class="source_line" href="#L3912">3912</a>
<a id="L3913" class="source_line" href="#L3913">3913</a>
<a id="L3914" class="source_line" href="#L3914">3914</a>
<a id="L3915" class="source_line" href="#L3915">3915</a>
<a id="L3916" class="source_line" href="#L3916">3916</a>
<a id="L3917" class="source_line" href="#L3917">3917</a>
<a id="L3918" class="source_line" href="#L3918">3918</a>
<a id="L3919" class="source_line" href="#L3919">3919</a>
<a id="L3920" class="source_line" href="#L3920">3920</a>
<a id="L3921" class="source_line" href="#L3921">3921</a>
<a id="L3922" class="source_line" href="#L3922">3922</a>
<a id="L3923" class="source_line" href="#L3923">3923</a>
<a id="L3924" class="source_line" href="#L3924">3924</a>
<a id="L3925" class="source_line" href="#L3925">3925</a>
<a id="L3926" class="source_line" href="#L3926">3926</a>
<a id="L3927" class="source_line" href="#L3927">3927</a>
<a id="L3928" class="source_line" href="#L3928">3928</a>
<a id="L3929" class="source_line" href="#L3929">3929</a>
<a id="L3930" class="source_line" href="#L3930">3930</a>
<a id="L3931" class="source_line" href="#L3931">3931</a>
<a id="L3932" class="source_line" href="#L3932">3932</a>
<a id="L3933" class="source_line" href="#L3933">3933</a>
<a id="L3934" class="source_line" href="#L3934">3934</a>
<a id="L3935" class="source_line" href="#L3935">3935</a>
<a id="L3936" class="source_line" href="#L3936">3936</a>
<a id="L3937" class="source_line" href="#L3937">3937</a>
<a id="L3938" class="source_line" href="#L3938">3938</a>
<a id="L3939" class="source_line" href="#L3939">3939</a>
<a id="L3940" class="source_line" href="#L3940">3940</a>
<a id="L3941" class="source_line" href="#L3941">3941</a>
<a id="L3942" class="source_line" href="#L3942">3942</a>
<a id="L3943" class="source_line" href="#L3943">3943</a>
<a id="L3944" class="source_line" href="#L3944">3944</a>
<a id="L3945" class="source_line" href="#L3945">3945</a>
<a id="L3946" class="source_line" href="#L3946">3946</a>
<a id="L3947" class="source_line" href="#L3947">3947</a>
<a id="L3948" class="source_line" href="#L3948">3948</a>
<a id="L3949" class="source_line" href="#L3949">3949</a>
<a id="L3950" class="source_line" href="#L3950">3950</a>
<a id="L3951" class="source_line" href="#L3951">3951</a>
<a id="L3952" class="source_line" href="#L3952">3952</a>
<a id="L3953" class="source_line" href="#L3953">3953</a>
<a id="L3954" class="source_line" href="#L3954">3954</a>
<a id="L3955" class="source_line" href="#L3955">3955</a>
<a id="L3956" class="source_line" href="#L3956">3956</a>
<a id="L3957" class="source_line" href="#L3957">3957</a>
<a id="L3958" class="source_line" href="#L3958">3958</a>
<a id="L3959" class="source_line" href="#L3959">3959</a>
<a id="L3960" class="source_line" href="#L3960">3960</a>
<a id="L3961" class="source_line" href="#L3961">3961</a>
<a id="L3962" class="source_line" href="#L3962">3962</a>
<a id="L3963" class="source_line" href="#L3963">3963</a>
<a id="L3964" class="source_line" href="#L3964">3964</a>
<a id="L3965" class="source_line" href="#L3965">3965</a>
<a id="L3966" class="source_line" href="#L3966">3966</a>
<a id="L3967" class="source_line" href="#L3967">3967</a>
<a id="L3968" class="source_line" href="#L3968">3968</a>
<a id="L3969" class="source_line" href="#L3969">3969</a>
<a id="L3970" class="source_line" href="#L3970">3970</a>
<a id="L3971" class="source_line" href="#L3971">3971</a>
<a id="L3972" class="source_line" href="#L3972">3972</a>
<a id="L3973" class="source_line" href="#L3973">3973</a>
<a id="L3974" class="source_line" href="#L3974">3974</a>
<a id="L3975" class="source_line" href="#L3975">3975</a>
<a id="L3976" class="source_line" href="#L3976">3976</a>
<a id="L3977" class="source_line" href="#L3977">3977</a>
<a id="L3978" class="source_line" href="#L3978">3978</a>
<a id="L3979" class="source_line" href="#L3979">3979</a>
<a id="L3980" class="source_line" href="#L3980">3980</a>
<a id="L3981" class="source_line" href="#L3981">3981</a>
<a id="L3982" class="source_line" href="#L3982">3982</a>
<a id="L3983" class="source_line" href="#L3983">3983</a>
<a id="L3984" class="source_line" href="#L3984">3984</a>
<a id="L3985" class="source_line" href="#L3985">3985</a>
<a id="L3986" class="source_line" href="#L3986">3986</a>
<a id="L3987" class="source_line" href="#L3987">3987</a>
<a id="L3988" class="source_line" href="#L3988">3988</a>
<a id="L3989" class="source_line" href="#L3989">3989</a>
<a id="L3990" class="source_line" href="#L3990">3990</a>
<a id="L3991" class="source_line" href="#L3991">3991</a>
<a id="L3992" class="source_line" href="#L3992">3992</a>
<a id="L3993" class="source_line" href="#L3993">3993</a>
<a id="L3994" class="source_line" href="#L3994">3994</a>
<a id="L3995" class="source_line" href="#L3995">3995</a>
<a id="L3996" class="source_line" href="#L3996">3996</a>
<a id="L3997" class="source_line" href="#L3997">3997</a>
<a id="L3998" class="source_line" href="#L3998">3998</a>
<a id="L3999" class="source_line" href="#L3999">3999</a>
<a id="L4000" class="source_line" href="#L4000">4000</a>
<a id="L4001" class="source_line" href="#L4001">4001</a>
<a id="L4002" class="source_line" href="#L4002">4002</a>
<a id="L4003" class="source_line" href="#L4003">4003</a>
<a id="L4004" class="source_line" href="#L4004">4004</a>
<a id="L4005" class="source_line" href="#L4005">4005</a>
<a id="L4006" class="source_line" href="#L4006">4006</a>
<a id="L4007" class="source_line" href="#L4007">4007</a>
<a id="L4008" class="source_line" href="#L4008">4008</a>
<a id="L4009" class="source_line" href="#L4009">4009</a>
<a id="L4010" class="source_line" href="#L4010">4010</a>
<a id="L4011" class="source_line" href="#L4011">4011</a>
<a id="L4012" class="source_line" href="#L4012">4012</a>
<a id="L4013" class="source_line" href="#L4013">4013</a>
<a id="L4014" class="source_line" href="#L4014">4014</a>
<a id="L4015" class="source_line" href="#L4015">4015</a>
<a id="L4016" class="source_line" href="#L4016">4016</a>
<a id="L4017" class="source_line" href="#L4017">4017</a>
<a id="L4018" class="source_line" href="#L4018">4018</a>
<a id="L4019" class="source_line" href="#L4019">4019</a>
<a id="L4020" class="source_line" href="#L4020">4020</a>
<a id="L4021" class="source_line" href="#L4021">4021</a>
<a id="L4022" class="source_line" href="#L4022">4022</a>
<a id="L4023" class="source_line" href="#L4023">4023</a>
<a id="L4024" class="source_line" href="#L4024">4024</a>
<a id="L4025" class="source_line" href="#L4025">4025</a>
<a id="L4026" class="source_line" href="#L4026">4026</a>
<a id="L4027" class="source_line" href="#L4027">4027</a>
<a id="L4028" class="source_line" href="#L4028">4028</a>
<a id="L4029" class="source_line" href="#L4029">4029</a>
<a id="L4030" class="source_line" href="#L4030">4030</a>
<a id="L4031" class="source_line" href="#L4031">4031</a>
<a id="L4032" class="source_line" href="#L4032">4032</a>
<a id="L4033" class="source_line" href="#L4033">4033</a>
<a id="L4034" class="source_line" href="#L4034">4034</a>
<a id="L4035" class="source_line" href="#L4035">4035</a>
<a id="L4036" class="source_line" href="#L4036">4036</a>
<a id="L4037" class="source_line" href="#L4037">4037</a>
<a id="L4038" class="source_line" href="#L4038">4038</a>
<a id="L4039" class="source_line" href="#L4039">4039</a>
<a id="L4040" class="source_line" href="#L4040">4040</a>
<a id="L4041" class="source_line" href="#L4041">4041</a>
<a id="L4042" class="source_line" href="#L4042">4042</a>
<a id="L4043" class="source_line" href="#L4043">4043</a>
<a id="L4044" class="source_line" href="#L4044">4044</a>
<a id="L4045" class="source_line" href="#L4045">4045</a>
<a id="L4046" class="source_line" href="#L4046">4046</a>
<a id="L4047" class="source_line" href="#L4047">4047</a>
<a id="L4048" class="source_line" href="#L4048">4048</a>
<a id="L4049" class="source_line" href="#L4049">4049</a>
<a id="L4050" class="source_line" href="#L4050">4050</a>
<a id="L4051" class="source_line" href="#L4051">4051</a>
<a id="L4052" class="source_line" href="#L4052">4052</a>
<a id="L4053" class="source_line" href="#L4053">4053</a>
<a id="L4054" class="source_line" href="#L4054">4054</a>
<a id="L4055" class="source_line" href="#L4055">4055</a>
<a id="L4056" class="source_line" href="#L4056">4056</a>
<a id="L4057" class="source_line" href="#L4057">4057</a>
<a id="L4058" class="source_line" href="#L4058">4058</a>
<a id="L4059" class="source_line" href="#L4059">4059</a>
<a id="L4060" class="source_line" href="#L4060">4060</a>
<a id="L4061" class="source_line" href="#L4061">4061</a>
<a id="L4062" class="source_line" href="#L4062">4062</a>
<a id="L4063" class="source_line" href="#L4063">4063</a>
<a id="L4064" class="source_line" href="#L4064">4064</a>
<a id="L4065" class="source_line" href="#L4065">4065</a>
<a id="L4066" class="source_line" href="#L4066">4066</a>
<a id="L4067" class="source_line" href="#L4067">4067</a>
<a id="L4068" class="source_line" href="#L4068">4068</a>
<a id="L4069" class="source_line" href="#L4069">4069</a>
<a id="L4070" class="source_line" href="#L4070">4070</a>
<a id="L4071" class="source_line" href="#L4071">4071</a>
<a id="L4072" class="source_line" href="#L4072">4072</a>
<a id="L4073" class="source_line" href="#L4073">4073</a>
<a id="L4074" class="source_line" href="#L4074">4074</a>
<a id="L4075" class="source_line" href="#L4075">4075</a>
<a id="L4076" class="source_line" href="#L4076">4076</a>
<a id="L4077" class="source_line" href="#L4077">4077</a>
<a id="L4078" class="source_line" href="#L4078">4078</a>
<a id="L4079" class="source_line" href="#L4079">4079</a>
<a id="L4080" class="source_line" href="#L4080">4080</a>
<a id="L4081" class="source_line" href="#L4081">4081</a>
<a id="L4082" class="source_line" href="#L4082">4082</a>
<a id="L4083" class="source_line" href="#L4083">4083</a>
<a id="L4084" class="source_line" href="#L4084">4084</a>
<a id="L4085" class="source_line" href="#L4085">4085</a>
<a id="L4086" class="source_line" href="#L4086">4086</a>
<a id="L4087" class="source_line" href="#L4087">4087</a>
<a id="L4088" class="source_line" href="#L4088">4088</a>
<a id="L4089" class="source_line" href="#L4089">4089</a>
<a id="L4090" class="source_line" href="#L4090">4090</a>
<a id="L4091" class="source_line" href="#L4091">4091</a>
<a id="L4092" class="source_line" href="#L4092">4092</a>
<a id="L4093" class="source_line" href="#L4093">4093</a>
<a id="L4094" class="source_line" href="#L4094">4094</a>
<a id="L4095" class="source_line" href="#L4095">4095</a>
<a id="L4096" class="source_line" href="#L4096">4096</a>
<a id="L4097" class="source_line" href="#L4097">4097</a>
<a id="L4098" class="source_line" href="#L4098">4098</a>
<a id="L4099" class="source_line" href="#L4099">4099</a>
<a id="L4100" class="source_line" href="#L4100">4100</a>
<a id="L4101" class="source_line" href="#L4101">4101</a>
<a id="L4102" class="source_line" href="#L4102">4102</a>
<a id="L4103" class="source_line" href="#L4103">4103</a>
<a id="L4104" class="source_line" href="#L4104">4104</a>
<a id="L4105" class="source_line" href="#L4105">4105</a>
<a id="L4106" class="source_line" href="#L4106">4106</a>
<a id="L4107" class="source_line" href="#L4107">4107</a>
<a id="L4108" class="source_line" href="#L4108">4108</a>
<a id="L4109" class="source_line" href="#L4109">4109</a>
<a id="L4110" class="source_line" href="#L4110">4110</a>
<a id="L4111" class="source_line" href="#L4111">4111</a>
<a id="L4112" class="source_line" href="#L4112">4112</a>
<a id="L4113" class="source_line" href="#L4113">4113</a>
<a id="L4114" class="source_line" href="#L4114">4114</a>
<a id="L4115" class="source_line" href="#L4115">4115</a>
<a id="L4116" class="source_line" href="#L4116">4116</a>
<a id="L4117" class="source_line" href="#L4117">4117</a>
<a id="L4118" class="source_line" href="#L4118">4118</a>
<a id="L4119" class="source_line" href="#L4119">4119</a>
<a id="L4120" class="source_line" href="#L4120">4120</a>
<a id="L4121" class="source_line" href="#L4121">4121</a>
<a id="L4122" class="source_line" href="#L4122">4122</a>
<a id="L4123" class="source_line" href="#L4123">4123</a>
<a id="L4124" class="source_line" href="#L4124">4124</a>
<a id="L4125" class="source_line" href="#L4125">4125</a>
<a id="L4126" class="source_line" href="#L4126">4126</a>
<a id="L4127" class="source_line" href="#L4127">4127</a>
<a id="L4128" class="source_line" href="#L4128">4128</a>
<a id="L4129" class="source_line" href="#L4129">4129</a>
<a id="L4130" class="source_line" href="#L4130">4130</a>
<a id="L4131" class="source_line" href="#L4131">4131</a>
<a id="L4132" class="source_line" href="#L4132">4132</a>
<a id="L4133" class="source_line" href="#L4133">4133</a>
<a id="L4134" class="source_line" href="#L4134">4134</a>
<a id="L4135" class="source_line" href="#L4135">4135</a>
<a id="L4136" class="source_line" href="#L4136">4136</a>
<a id="L4137" class="source_line" href="#L4137">4137</a>
<a id="L4138" class="source_line" href="#L4138">4138</a>
<a id="L4139" class="source_line" href="#L4139">4139</a>
<a id="L4140" class="source_line" href="#L4140">4140</a>
<a id="L4141" class="source_line" href="#L4141">4141</a>
<a id="L4142" class="source_line" href="#L4142">4142</a>
<a id="L4143" class="source_line" href="#L4143">4143</a>
<a id="L4144" class="source_line" href="#L4144">4144</a>
<a id="L4145" class="source_line" href="#L4145">4145</a>
<a id="L4146" class="source_line" href="#L4146">4146</a>
<a id="L4147" class="source_line" href="#L4147">4147</a>
<a id="L4148" class="source_line" href="#L4148">4148</a>
<a id="L4149" class="source_line" href="#L4149">4149</a>
<a id="L4150" class="source_line" href="#L4150">4150</a>
<a id="L4151" class="source_line" href="#L4151">4151</a>
<a id="L4152" class="source_line" href="#L4152">4152</a>
<a id="L4153" class="source_line" href="#L4153">4153</a>
<a id="L4154" class="source_line" href="#L4154">4154</a>
<a id="L4155" class="source_line" href="#L4155">4155</a>
<a id="L4156" class="source_line" href="#L4156">4156</a>
<a id="L4157" class="source_line" href="#L4157">4157</a>
<a id="L4158" class="source_line" href="#L4158">4158</a>
<a id="L4159" class="source_line" href="#L4159">4159</a>
<a id="L4160" class="source_line" href="#L4160">4160</a>
<a id="L4161" class="source_line" href="#L4161">4161</a>
<a id="L4162" class="source_line" href="#L4162">4162</a>
<a id="L4163" class="source_line" href="#L4163">4163</a>
<a id="L4164" class="source_line" href="#L4164">4164</a>
<a id="L4165" class="source_line" href="#L4165">4165</a>
<a id="L4166" class="source_line" href="#L4166">4166</a>
<a id="L4167" class="source_line" href="#L4167">4167</a>
<a id="L4168" class="source_line" href="#L4168">4168</a>
<a id="L4169" class="source_line" href="#L4169">4169</a>
<a id="L4170" class="source_line" href="#L4170">4170</a>
<a id="L4171" class="source_line" href="#L4171">4171</a>
<a id="L4172" class="source_line" href="#L4172">4172</a>
<a id="L4173" class="source_line" href="#L4173">4173</a>
<a id="L4174" class="source_line" href="#L4174">4174</a>
<a id="L4175" class="source_line" href="#L4175">4175</a>
<a id="L4176" class="source_line" href="#L4176">4176</a>
<a id="L4177" class="source_line" href="#L4177">4177</a>
<a id="L4178" class="source_line" href="#L4178">4178</a>
<a id="L4179" class="source_line" href="#L4179">4179</a>
<a id="L4180" class="source_line" href="#L4180">4180</a>
<a id="L4181" class="source_line" href="#L4181">4181</a>
<a id="L4182" class="source_line" href="#L4182">4182</a>
<a id="L4183" class="source_line" href="#L4183">4183</a>
<a id="L4184" class="source_line" href="#L4184">4184</a>
<a id="L4185" class="source_line" href="#L4185">4185</a>
<a id="L4186" class="source_line" href="#L4186">4186</a>
<a id="L4187" class="source_line" href="#L4187">4187</a>
<a id="L4188" class="source_line" href="#L4188">4188</a>
<a id="L4189" class="source_line" href="#L4189">4189</a>
<a id="L4190" class="source_line" href="#L4190">4190</a>
<a id="L4191" class="source_line" href="#L4191">4191</a>
<a id="L4192" class="source_line" href="#L4192">4192</a>
<a id="L4193" class="source_line" href="#L4193">4193</a>
<a id="L4194" class="source_line" href="#L4194">4194</a>
<a id="L4195" class="source_line" href="#L4195">4195</a>
<a id="L4196" class="source_line" href="#L4196">4196</a>
<a id="L4197" class="source_line" href="#L4197">4197</a>
<a id="L4198" class="source_line" href="#L4198">4198</a>
<a id="L4199" class="source_line" href="#L4199">4199</a>
<a id="L4200" class="source_line" href="#L4200">4200</a>
<a id="L4201" class="source_line" href="#L4201">4201</a>
<a id="L4202" class="source_line" href="#L4202">4202</a>
<a id="L4203" class="source_line" href="#L4203">4203</a>
<a id="L4204" class="source_line" href="#L4204">4204</a>
<a id="L4205" class="source_line" href="#L4205">4205</a>
<a id="L4206" class="source_line" href="#L4206">4206</a>
<a id="L4207" class="source_line" href="#L4207">4207</a>
<a id="L4208" class="source_line" href="#L4208">4208</a>
<a id="L4209" class="source_line" href="#L4209">4209</a>
<a id="L4210" class="source_line" href="#L4210">4210</a>
<a id="L4211" class="source_line" href="#L4211">4211</a>
<a id="L4212" class="source_line" href="#L4212">4212</a>
<a id="L4213" class="source_line" href="#L4213">4213</a>
<a id="L4214" class="source_line" href="#L4214">4214</a>
<a id="L4215" class="source_line" href="#L4215">4215</a>
<a id="L4216" class="source_line" href="#L4216">4216</a>
<a id="L4217" class="source_line" href="#L4217">4217</a>
<a id="L4218" class="source_line" href="#L4218">4218</a>
<a id="L4219" class="source_line" href="#L4219">4219</a>
<a id="L4220" class="source_line" href="#L4220">4220</a>
<a id="L4221" class="source_line" href="#L4221">4221</a>
<a id="L4222" class="source_line" href="#L4222">4222</a>
<a id="L4223" class="source_line" href="#L4223">4223</a>
<a id="L4224" class="source_line" href="#L4224">4224</a>
<a id="L4225" class="source_line" href="#L4225">4225</a>
<a id="L4226" class="source_line" href="#L4226">4226</a>
<a id="L4227" class="source_line" href="#L4227">4227</a>
<a id="L4228" class="source_line" href="#L4228">4228</a>
<a id="L4229" class="source_line" href="#L4229">4229</a>
<a id="L4230" class="source_line" href="#L4230">4230</a>
<a id="L4231" class="source_line" href="#L4231">4231</a>
<a id="L4232" class="source_line" href="#L4232">4232</a>
<a id="L4233" class="source_line" href="#L4233">4233</a>
<a id="L4234" class="source_line" href="#L4234">4234</a>
<a id="L4235" class="source_line" href="#L4235">4235</a>
<a id="L4236" class="source_line" href="#L4236">4236</a>
<a id="L4237" class="source_line" href="#L4237">4237</a>
<a id="L4238" class="source_line" href="#L4238">4238</a>
<a id="L4239" class="source_line" href="#L4239">4239</a>
<a id="L4240" class="source_line" href="#L4240">4240</a>
<a id="L4241" class="source_line" href="#L4241">4241</a>
<a id="L4242" class="source_line" href="#L4242">4242</a>
<a id="L4243" class="source_line" href="#L4243">4243</a>
<a id="L4244" class="source_line" href="#L4244">4244</a>
<a id="L4245" class="source_line" href="#L4245">4245</a>
<a id="L4246" class="source_line" href="#L4246">4246</a>
<a id="L4247" class="source_line" href="#L4247">4247</a>
<a id="L4248" class="source_line" href="#L4248">4248</a>
<a id="L4249" class="source_line" href="#L4249">4249</a>
<a id="L4250" class="source_line" href="#L4250">4250</a>
<a id="L4251" class="source_line" href="#L4251">4251</a>
<a id="L4252" class="source_line" href="#L4252">4252</a>
<a id="L4253" class="source_line" href="#L4253">4253</a>
<a id="L4254" class="source_line" href="#L4254">4254</a>
<a id="L4255" class="source_line" href="#L4255">4255</a>
<a id="L4256" class="source_line" href="#L4256">4256</a>
<a id="L4257" class="source_line" href="#L4257">4257</a>
<a id="L4258" class="source_line" href="#L4258">4258</a>
<a id="L4259" class="source_line" href="#L4259">4259</a>
<a id="L4260" class="source_line" href="#L4260">4260</a>
<a id="L4261" class="source_line" href="#L4261">4261</a>
<a id="L4262" class="source_line" href="#L4262">4262</a>
<a id="L4263" class="source_line" href="#L4263">4263</a>
<a id="L4264" class="source_line" href="#L4264">4264</a>
<a id="L4265" class="source_line" href="#L4265">4265</a>
<a id="L4266" class="source_line" href="#L4266">4266</a>
<a id="L4267" class="source_line" href="#L4267">4267</a>
<a id="L4268" class="source_line" href="#L4268">4268</a>
<a id="L4269" class="source_line" href="#L4269">4269</a>
<a id="L4270" class="source_line" href="#L4270">4270</a>
<a id="L4271" class="source_line" href="#L4271">4271</a>
<a id="L4272" class="source_line" href="#L4272">4272</a>
<a id="L4273" class="source_line" href="#L4273">4273</a>
<a id="L4274" class="source_line" href="#L4274">4274</a>
<a id="L4275" class="source_line" href="#L4275">4275</a>
<a id="L4276" class="source_line" href="#L4276">4276</a>
<a id="L4277" class="source_line" href="#L4277">4277</a>
<a id="L4278" class="source_line" href="#L4278">4278</a>
<a id="L4279" class="source_line" href="#L4279">4279</a>
<a id="L4280" class="source_line" href="#L4280">4280</a>
<a id="L4281" class="source_line" href="#L4281">4281</a>
<a id="L4282" class="source_line" href="#L4282">4282</a>
<a id="L4283" class="source_line" href="#L4283">4283</a>
<a id="L4284" class="source_line" href="#L4284">4284</a>
<a id="L4285" class="source_line" href="#L4285">4285</a>
<a id="L4286" class="source_line" href="#L4286">4286</a>
<a id="L4287" class="source_line" href="#L4287">4287</a>
<a id="L4288" class="source_line" href="#L4288">4288</a>
<a id="L4289" class="source_line" href="#L4289">4289</a>
<a id="L4290" class="source_line" href="#L4290">4290</a>
<a id="L4291" class="source_line" href="#L4291">4291</a>
<a id="L4292" class="source_line" href="#L4292">4292</a>
<a id="L4293" class="source_line" href="#L4293">4293</a>
<a id="L4294" class="source_line" href="#L4294">4294</a>
<a id="L4295" class="source_line" href="#L4295">4295</a>
<a id="L4296" class="source_line" href="#L4296">4296</a>
<a id="L4297" class="source_line" href="#L4297">4297</a>
<a id="L4298" class="source_line" href="#L4298">4298</a>
<a id="L4299" class="source_line" href="#L4299">4299</a>
<a id="L4300" class="source_line" href="#L4300">4300</a>
<a id="L4301" class="source_line" href="#L4301">4301</a>
<a id="L4302" class="source_line" href="#L4302">4302</a>
<a id="L4303" class="source_line" href="#L4303">4303</a>
<a id="L4304" class="source_line" href="#L4304">4304</a>
<a id="L4305" class="source_line" href="#L4305">4305</a>
<a id="L4306" class="source_line" href="#L4306">4306</a>
<a id="L4307" class="source_line" href="#L4307">4307</a>
<a id="L4308" class="source_line" href="#L4308">4308</a>
<a id="L4309" class="source_line" href="#L4309">4309</a>
<a id="L4310" class="source_line" href="#L4310">4310</a>
<a id="L4311" class="source_line" href="#L4311">4311</a>
<a id="L4312" class="source_line" href="#L4312">4312</a>
<a id="L4313" class="source_line" href="#L4313">4313</a>
<a id="L4314" class="source_line" href="#L4314">4314</a>
<a id="L4315" class="source_line" href="#L4315">4315</a>
<a id="L4316" class="source_line" href="#L4316">4316</a>
<a id="L4317" class="source_line" href="#L4317">4317</a>
<a id="L4318" class="source_line" href="#L4318">4318</a>
<a id="L4319" class="source_line" href="#L4319">4319</a>
<a id="L4320" class="source_line" href="#L4320">4320</a>
<a id="L4321" class="source_line" href="#L4321">4321</a>
<a id="L4322" class="source_line" href="#L4322">4322</a>
<a id="L4323" class="source_line" href="#L4323">4323</a>
<a id="L4324" class="source_line" href="#L4324">4324</a>
<a id="L4325" class="source_line" href="#L4325">4325</a>
<a id="L4326" class="source_line" href="#L4326">4326</a>
<a id="L4327" class="source_line" href="#L4327">4327</a>
<a id="L4328" class="source_line" href="#L4328">4328</a>
<a id="L4329" class="source_line" href="#L4329">4329</a>
<a id="L4330" class="source_line" href="#L4330">4330</a>
<a id="L4331" class="source_line" href="#L4331">4331</a>
<a id="L4332" class="source_line" href="#L4332">4332</a>
<a id="L4333" class="source_line" href="#L4333">4333</a>
<a id="L4334" class="source_line" href="#L4334">4334</a>
<a id="L4335" class="source_line" href="#L4335">4335</a>
<a id="L4336" class="source_line" href="#L4336">4336</a>
<a id="L4337" class="source_line" href="#L4337">4337</a>
<a id="L4338" class="source_line" href="#L4338">4338</a>
<a id="L4339" class="source_line" href="#L4339">4339</a>
<a id="L4340" class="source_line" href="#L4340">4340</a>
<a id="L4341" class="source_line" href="#L4341">4341</a>
<a id="L4342" class="source_line" href="#L4342">4342</a>
<a id="L4343" class="source_line" href="#L4343">4343</a>
<a id="L4344" class="source_line" href="#L4344">4344</a>
<a id="L4345" class="source_line" href="#L4345">4345</a>
<a id="L4346" class="source_line" href="#L4346">4346</a>
<a id="L4347" class="source_line" href="#L4347">4347</a>
<a id="L4348" class="source_line" href="#L4348">4348</a>
<a id="L4349" class="source_line" href="#L4349">4349</a>
<a id="L4350" class="source_line" href="#L4350">4350</a>
<a id="L4351" class="source_line" href="#L4351">4351</a>
<a id="L4352" class="source_line" href="#L4352">4352</a>
<a id="L4353" class="source_line" href="#L4353">4353</a>
<a id="L4354" class="source_line" href="#L4354">4354</a>
<a id="L4355" class="source_line" href="#L4355">4355</a>
<a id="L4356" class="source_line" href="#L4356">4356</a>
<a id="L4357" class="source_line" href="#L4357">4357</a>
<a id="L4358" class="source_line" href="#L4358">4358</a>
<a id="L4359" class="source_line" href="#L4359">4359</a>
<a id="L4360" class="source_line" href="#L4360">4360</a>
<a id="L4361" class="source_line" href="#L4361">4361</a>
<a id="L4362" class="source_line" href="#L4362">4362</a>
<a id="L4363" class="source_line" href="#L4363">4363</a>
<a id="L4364" class="source_line" href="#L4364">4364</a>
<a id="L4365" class="source_line" href="#L4365">4365</a>
<a id="L4366" class="source_line" href="#L4366">4366</a>
<a id="L4367" class="source_line" href="#L4367">4367</a>
<a id="L4368" class="source_line" href="#L4368">4368</a>
<a id="L4369" class="source_line" href="#L4369">4369</a>
<a id="L4370" class="source_line" href="#L4370">4370</a>
<a id="L4371" class="source_line" href="#L4371">4371</a>
<a id="L4372" class="source_line" href="#L4372">4372</a>
<a id="L4373" class="source_line" href="#L4373">4373</a>
<a id="L4374" class="source_line" href="#L4374">4374</a>
<a id="L4375" class="source_line" href="#L4375">4375</a>
<a id="L4376" class="source_line" href="#L4376">4376</a>
<a id="L4377" class="source_line" href="#L4377">4377</a>
<a id="L4378" class="source_line" href="#L4378">4378</a>
<a id="L4379" class="source_line" href="#L4379">4379</a>
<a id="L4380" class="source_line" href="#L4380">4380</a>
<a id="L4381" class="source_line" href="#L4381">4381</a>
<a id="L4382" class="source_line" href="#L4382">4382</a>
<a id="L4383" class="source_line" href="#L4383">4383</a>
<a id="L4384" class="source_line" href="#L4384">4384</a>
<a id="L4385" class="source_line" href="#L4385">4385</a>
<a id="L4386" class="source_line" href="#L4386">4386</a>
<a id="L4387" class="source_line" href="#L4387">4387</a>
<a id="L4388" class="source_line" href="#L4388">4388</a>
<a id="L4389" class="source_line" href="#L4389">4389</a>
<a id="L4390" class="source_line" href="#L4390">4390</a>
<a id="L4391" class="source_line" href="#L4391">4391</a>
<a id="L4392" class="source_line" href="#L4392">4392</a>
<a id="L4393" class="source_line" href="#L4393">4393</a>
<a id="L4394" class="source_line" href="#L4394">4394</a>
<a id="L4395" class="source_line" href="#L4395">4395</a>
<a id="L4396" class="source_line" href="#L4396">4396</a>
<a id="L4397" class="source_line" href="#L4397">4397</a>
<a id="L4398" class="source_line" href="#L4398">4398</a>
<a id="L4399" class="source_line" href="#L4399">4399</a>
<a id="L4400" class="source_line" href="#L4400">4400</a>
<a id="L4401" class="source_line" href="#L4401">4401</a>
<a id="L4402" class="source_line" href="#L4402">4402</a>
<a id="L4403" class="source_line" href="#L4403">4403</a>
<a id="L4404" class="source_line" href="#L4404">4404</a>
<a id="L4405" class="source_line" href="#L4405">4405</a>
<a id="L4406" class="source_line" href="#L4406">4406</a>
<a id="L4407" class="source_line" href="#L4407">4407</a>
<a id="L4408" class="source_line" href="#L4408">4408</a>
<a id="L4409" class="source_line" href="#L4409">4409</a>
<a id="L4410" class="source_line" href="#L4410">4410</a>
<a id="L4411" class="source_line" href="#L4411">4411</a>
<a id="L4412" class="source_line" href="#L4412">4412</a>
<a id="L4413" class="source_line" href="#L4413">4413</a>
<a id="L4414" class="source_line" href="#L4414">4414</a>
<a id="L4415" class="source_line" href="#L4415">4415</a>
<a id="L4416" class="source_line" href="#L4416">4416</a>
<a id="L4417" class="source_line" href="#L4417">4417</a>
<a id="L4418" class="source_line" href="#L4418">4418</a>
<a id="L4419" class="source_line" href="#L4419">4419</a>
<a id="L4420" class="source_line" href="#L4420">4420</a>
<a id="L4421" class="source_line" href="#L4421">4421</a>
<a id="L4422" class="source_line" href="#L4422">4422</a>
<a id="L4423" class="source_line" href="#L4423">4423</a>
<a id="L4424" class="source_line" href="#L4424">4424</a>
<a id="L4425" class="source_line" href="#L4425">4425</a>
<a id="L4426" class="source_line" href="#L4426">4426</a>
<a id="L4427" class="source_line" href="#L4427">4427</a>
<a id="L4428" class="source_line" href="#L4428">4428</a>
<a id="L4429" class="source_line" href="#L4429">4429</a>
<a id="L4430" class="source_line" href="#L4430">4430</a>
<a id="L4431" class="source_line" href="#L4431">4431</a>
<a id="L4432" class="source_line" href="#L4432">4432</a>
<a id="L4433" class="source_line" href="#L4433">4433</a>
<a id="L4434" class="source_line" href="#L4434">4434</a>
<a id="L4435" class="source_line" href="#L4435">4435</a>
<a id="L4436" class="source_line" href="#L4436">4436</a>
<a id="L4437" class="source_line" href="#L4437">4437</a>
<a id="L4438" class="source_line" href="#L4438">4438</a>
<a id="L4439" class="source_line" href="#L4439">4439</a>
<a id="L4440" class="source_line" href="#L4440">4440</a>
<a id="L4441" class="source_line" href="#L4441">4441</a>
<a id="L4442" class="source_line" href="#L4442">4442</a>
<a id="L4443" class="source_line" href="#L4443">4443</a>
<a id="L4444" class="source_line" href="#L4444">4444</a>
<a id="L4445" class="source_line" href="#L4445">4445</a>
<a id="L4446" class="source_line" href="#L4446">4446</a>
<a id="L4447" class="source_line" href="#L4447">4447</a>
<a id="L4448" class="source_line" href="#L4448">4448</a>
<a id="L4449" class="source_line" href="#L4449">4449</a>
<a id="L4450" class="source_line" href="#L4450">4450</a>
<a id="L4451" class="source_line" href="#L4451">4451</a>
<a id="L4452" class="source_line" href="#L4452">4452</a>
<a id="L4453" class="source_line" href="#L4453">4453</a>
<a id="L4454" class="source_line" href="#L4454">4454</a>
<a id="L4455" class="source_line" href="#L4455">4455</a>
<a id="L4456" class="source_line" href="#L4456">4456</a>
<a id="L4457" class="source_line" href="#L4457">4457</a>
<a id="L4458" class="source_line" href="#L4458">4458</a>
<a id="L4459" class="source_line" href="#L4459">4459</a>
<a id="L4460" class="source_line" href="#L4460">4460</a>
<a id="L4461" class="source_line" href="#L4461">4461</a>
<a id="L4462" class="source_line" href="#L4462">4462</a>
<a id="L4463" class="source_line" href="#L4463">4463</a>
<a id="L4464" class="source_line" href="#L4464">4464</a>
<a id="L4465" class="source_line" href="#L4465">4465</a>
<a id="L4466" class="source_line" href="#L4466">4466</a>
<a id="L4467" class="source_line" href="#L4467">4467</a>
<a id="L4468" class="source_line" href="#L4468">4468</a>
<a id="L4469" class="source_line" href="#L4469">4469</a>
<a id="L4470" class="source_line" href="#L4470">4470</a>
<a id="L4471" class="source_line" href="#L4471">4471</a>
<a id="L4472" class="source_line" href="#L4472">4472</a>
<a id="L4473" class="source_line" href="#L4473">4473</a>
<a id="L4474" class="source_line" href="#L4474">4474</a>
<a id="L4475" class="source_line" href="#L4475">4475</a>
<a id="L4476" class="source_line" href="#L4476">4476</a>
<a id="L4477" class="source_line" href="#L4477">4477</a>
<a id="L4478" class="source_line" href="#L4478">4478</a>
<a id="L4479" class="source_line" href="#L4479">4479</a>
<a id="L4480" class="source_line" href="#L4480">4480</a>
<a id="L4481" class="source_line" href="#L4481">4481</a>
<a id="L4482" class="source_line" href="#L4482">4482</a>
<a id="L4483" class="source_line" href="#L4483">4483</a>
<a id="L4484" class="source_line" href="#L4484">4484</a>
<a id="L4485" class="source_line" href="#L4485">4485</a>
<a id="L4486" class="source_line" href="#L4486">4486</a>
<a id="L4487" class="source_line" href="#L4487">4487</a>
<a id="L4488" class="source_line" href="#L4488">4488</a>
<a id="L4489" class="source_line" href="#L4489">4489</a>
<a id="L4490" class="source_line" href="#L4490">4490</a>
<a id="L4491" class="source_line" href="#L4491">4491</a>
<a id="L4492" class="source_line" href="#L4492">4492</a>
<a id="L4493" class="source_line" href="#L4493">4493</a>
<a id="L4494" class="source_line" href="#L4494">4494</a>
<a id="L4495" class="source_line" href="#L4495">4495</a>
<a id="L4496" class="source_line" href="#L4496">4496</a>
<a id="L4497" class="source_line" href="#L4497">4497</a>
<a id="L4498" class="source_line" href="#L4498">4498</a>
<a id="L4499" class="source_line" href="#L4499">4499</a>
<a id="L4500" class="source_line" href="#L4500">4500</a>
<a id="L4501" class="source_line" href="#L4501">4501</a>
<a id="L4502" class="source_line" href="#L4502">4502</a>
<a id="L4503" class="source_line" href="#L4503">4503</a>
<a id="L4504" class="source_line" href="#L4504">4504</a>
<a id="L4505" class="source_line" href="#L4505">4505</a>
<a id="L4506" class="source_line" href="#L4506">4506</a>
<a id="L4507" class="source_line" href="#L4507">4507</a>
<a id="L4508" class="source_line" href="#L4508">4508</a>
<a id="L4509" class="source_line" href="#L4509">4509</a>
<a id="L4510" class="source_line" href="#L4510">4510</a>
<a id="L4511" class="source_line" href="#L4511">4511</a>
<a id="L4512" class="source_line" href="#L4512">4512</a>
<a id="L4513" class="source_line" href="#L4513">4513</a>
<a id="L4514" class="source_line" href="#L4514">4514</a>
<a id="L4515" class="source_line" href="#L4515">4515</a>
<a id="L4516" class="source_line" href="#L4516">4516</a>
<a id="L4517" class="source_line" href="#L4517">4517</a>
<a id="L4518" class="source_line" href="#L4518">4518</a>
<a id="L4519" class="source_line" href="#L4519">4519</a>
<a id="L4520" class="source_line" href="#L4520">4520</a>
<a id="L4521" class="source_line" href="#L4521">4521</a>
<a id="L4522" class="source_line" href="#L4522">4522</a>
<a id="L4523" class="source_line" href="#L4523">4523</a>
<a id="L4524" class="source_line" href="#L4524">4524</a>
<a id="L4525" class="source_line" href="#L4525">4525</a>
<a id="L4526" class="source_line" href="#L4526">4526</a>
<a id="L4527" class="source_line" href="#L4527">4527</a>
<a id="L4528" class="source_line" href="#L4528">4528</a>
<a id="L4529" class="source_line" href="#L4529">4529</a>
<a id="L4530" class="source_line" href="#L4530">4530</a>
<a id="L4531" class="source_line" href="#L4531">4531</a>
<a id="L4532" class="source_line" href="#L4532">4532</a>
<a id="L4533" class="source_line" href="#L4533">4533</a>
<a id="L4534" class="source_line" href="#L4534">4534</a>
<a id="L4535" class="source_line" href="#L4535">4535</a>
<a id="L4536" class="source_line" href="#L4536">4536</a>
<a id="L4537" class="source_line" href="#L4537">4537</a>
<a id="L4538" class="source_line" href="#L4538">4538</a>
<a id="L4539" class="source_line" href="#L4539">4539</a>
<a id="L4540" class="source_line" href="#L4540">4540</a>
<a id="L4541" class="source_line" href="#L4541">4541</a>
<a id="L4542" class="source_line" href="#L4542">4542</a>
<a id="L4543" class="source_line" href="#L4543">4543</a>
<a id="L4544" class="source_line" href="#L4544">4544</a>
<a id="L4545" class="source_line" href="#L4545">4545</a>
</code><code class="source_code"><span><span class="LBRACKETATATAT">[@@@</span><span class="LIDENT">landmark</span> <span class="STRING">&quot;auto&quot;</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-bigstring"><span class="TYPE">type</span> <span class="LIDENT">bigstring</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.type-t"><span class="LPAREN">(</span><span class="LIDENT">char</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#type-int8_unsigned_elt"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">int8_unsigned_elt</span></a><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#type-c_layout"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">c_layout</span></a><span class="RPAREN">)</span> <span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): prelude. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-invalid_arg"><span class="LIDENT">invalid_arg</span></span> <span id="local_fmt_1"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-kasprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">kasprintf</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <a href="#local_fmt_1"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-kstrf"><span class="LIDENT">kstrf</span></span> <span id="local_k_2"><span class="LIDENT">k</span></span> <span id="local_fmt_3"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-kasprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">kasprintf</span></a> <a href="#local_k_2"><span class="LIDENT">k</span></a> <a href="#local_fmt_3"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-bigstring_empty"><span class="LIDENT">bigstring_empty</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-create"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-char"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">char</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-c_layout"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">c_layout</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bigstring_create"><span class="LIDENT">bigstring_create</span></span> <span id="local_l_4"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-create"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-char"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">char</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-c_layout"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">c_layout</span></a> <a href="#local_l_4"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bigstring_length"><span class="LIDENT">bigstring_length</span></span> <span id="local_x_5"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-dim"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">dim</span></a> <a href="#local_x_5"><span class="LIDENT">x</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-swap"><span class="EXTERNAL">external</span> <span class="LIDENT">swap</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap16&quot;</span></span><span class="EOL">
</span><span id="val-swap32"><span class="EXTERNAL">external</span> <span class="LIDENT">swap32</span> <span class="COLON">:</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap_int32&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_get_uint8"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get_uint8</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_ba_ref_1&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_get_char"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get_char</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_ba_ref_1&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_get_uint16"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get_uint16</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bigstring_get16&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_get_uint32"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get_uint32</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bigstring_get32&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-string_unsafe_get_uint32"><span class="EXTERNAL">external</span> <span class="LIDENT">string_unsafe_get_uint32</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_string_get32&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-string_unsafe_get_uint8"><span class="LIDENT">string_unsafe_get_uint8</span></span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_buf_6"><span class="LIDENT">buf</span></span> <span id="local_off_7"><span class="LIDENT">off</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_buf_6"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_off_7"><span class="LIDENT">off</span></a><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-bytes_unsafe_get_uint32"><span class="EXTERNAL">external</span> <span class="LIDENT">bytes_unsafe_get_uint32</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_get32&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bytes_unsafe_get_uint8"><span class="LIDENT">bytes_unsafe_get_uint8</span></span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_buf_8"><span class="LIDENT">buf</span></span> <span id="local_off_9"><span class="LIDENT">off</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_buf_8"><span class="LIDENT">buf</span></a> <a href="#local_off_9"><span class="LIDENT">off</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_set_uint8"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_uint8</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_ba_set_1&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_set_uint16"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_uint16</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bigstring_set16&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_set_uint32"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_uint32</span> <span class="COLON">:</span> <span class="LIDENT">bigstring</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bigstring_set32&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bytes_unsafe_set_uint8"><span class="LIDENT">bytes_unsafe_set_uint8</span></span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_buf_10"><span class="LIDENT">buf</span></span> <span id="local_off_11"><span class="LIDENT">off</span></span> <span id="local_v_12"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_buf_10"><span class="LIDENT">buf</span></a> <a href="#local_off_11"><span class="LIDENT">off</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-unsafe_chr"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">unsafe_chr</span></a> <span class="LPAREN">(</span><a href="#local_v_12"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-bytes_unsafe_set_uint32"><span class="EXTERNAL">external</span> <span class="LIDENT">bytes_unsafe_set_uint32</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set32&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): little-endian only *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_set_uint16_le"><span class="LIDENT">unsafe_set_uint16_le</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="FUN">fun</span> <span id="local_buf_13"><span class="LIDENT">buf</span></span> <span id="local_off_14"><span class="LIDENT">off</span></span> <span id="local_v_15"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set_uint16</span> <a href="#local_buf_13"><span class="LIDENT">buf</span></a> <a href="#local_off_14"><span class="LIDENT">off</span></a> <a href="#local_v_15"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="FUN">fun</span> <span id="local_buf_16"><span class="LIDENT">buf</span></span> <span id="local_off_17"><span class="LIDENT">off</span></span> <span id="local_v_18"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set_uint16</span> <a href="#local_buf_16"><span class="LIDENT">buf</span></a> <a href="#local_off_17"><span class="LIDENT">off</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap</span> <a href="#local_v_18"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_unsafe_set_uint16_be"><span class="LIDENT">_unsafe_set_uint16_be</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="FUN">fun</span> <span id="local_buf_19"><span class="LIDENT">buf</span></span> <span id="local_off_20"><span class="LIDENT">off</span></span> <span id="local_v_21"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set_uint16</span> <a href="#local_buf_19"><span class="LIDENT">buf</span></a> <a href="#local_off_20"><span class="LIDENT">off</span></a> <a href="#local_v_21"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="FUN">fun</span> <span id="local_buf_22"><span class="LIDENT">buf</span></span> <span id="local_off_23"><span class="LIDENT">off</span></span> <span id="local_v_24"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set_uint16</span> <a href="#local_buf_22"><span class="LIDENT">buf</span></a> <a href="#local_off_23"><span class="LIDENT">off</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap</span> <a href="#local_v_24"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_get_uint16_le"><span class="LIDENT">unsafe_get_uint16_le</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="FUN">fun</span> <span id="local_buf_25"><span class="LIDENT">buf</span></span> <span id="local_off_26"><span class="LIDENT">off</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_get_uint16</span> <a href="#local_buf_25"><span class="LIDENT">buf</span></a> <a href="#local_off_26"><span class="LIDENT">off</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="FUN">fun</span> <span id="local_buf_27"><span class="LIDENT">buf</span></span> <span id="local_off_28"><span class="LIDENT">off</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">swap</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint16</span> <a href="#local_buf_27"><span class="LIDENT">buf</span></a> <a href="#local_off_28"><span class="LIDENT">off</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_unsafe_get_uint16_be"><span class="LIDENT">_unsafe_get_uint16_be</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="FUN">fun</span> <span id="local_buf_29"><span class="LIDENT">buf</span></span> <span id="local_off_30"><span class="LIDENT">off</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_get_uint16</span> <a href="#local_buf_29"><span class="LIDENT">buf</span></a> <a href="#local_off_30"><span class="LIDENT">off</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="FUN">fun</span> <span id="local_buf_31"><span class="LIDENT">buf</span></span> <span id="local_off_32"><span class="LIDENT">off</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">swap</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint16</span> <a href="#local_buf_31"><span class="LIDENT">buf</span></a> <a href="#local_off_32"><span class="LIDENT">off</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_unsafe_set_uint32_le"><span class="LIDENT">_unsafe_set_uint32_le</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="FUN">fun</span> <span id="local_buf_33"><span class="LIDENT">buf</span></span> <span id="local_off_34"><span class="LIDENT">off</span></span> <span id="local_v_35"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_buf_33"><span class="LIDENT">buf</span></a> <a href="#local_off_34"><span class="LIDENT">off</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap32</span> <a href="#local_v_35"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="FUN">fun</span> <span id="local_buf_36"><span class="LIDENT">buf</span></span> <span id="local_off_37"><span class="LIDENT">off</span></span> <span id="local_v_38"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_buf_36"><span class="LIDENT">buf</span></a> <a href="#local_off_37"><span class="LIDENT">off</span></a> <a href="#local_v_38"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bigstring_to_string"><span class="LIDENT">bigstring_to_string</span></span> <span id="local_v_39"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_40"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_v_39"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_41"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_len_40"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len0_42"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_40"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len1_43"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_40"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_43"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_44"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_v_45"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_v_39"><span class="LIDENT">v</span></a> <a href="#local_i_44"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">bytes_unsafe_set_uint32</span> <a href="#local_res_41"><span class="LIDENT">res</span></a> <a href="#local_i_44"><span class="LIDENT">i</span></a> <a href="#local_v_45"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_42"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_46"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_43"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_47"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_v_39"><span class="LIDENT">v</span></a> <a href="#local_i_46"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">bytes_unsafe_set_uint8</span> <a href="#local_res_41"><span class="LIDENT">res</span></a> <a href="#local_i_46"><span class="LIDENT">i</span></a> <a href="#local_v_47"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_41"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bigstring_of_string"><span class="LIDENT">bigstring_of_string</span></span> <span id="local_v_48"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_49"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_v_48"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_50"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_create</span> <a href="#local_len_49"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len0_51"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_49"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len1_52"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_49"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_52"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_53"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_v_54"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">string_unsafe_get_uint32</span> <a href="#local_v_48"><span class="LIDENT">v</span></a> <a href="#local_i_53"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_res_50"><span class="LIDENT">res</span></a> <a href="#local_i_53"><span class="LIDENT">i</span></a> <a href="#local_v_54"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_51"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_55"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_52"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_56"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">string_unsafe_get_uint8</span> <a href="#local_v_48"><span class="LIDENT">v</span></a> <a href="#local_i_55"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_res_50"><span class="LIDENT">res</span></a> <a href="#local_i_55"><span class="LIDENT">i</span></a> <a href="#local_v_56"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_res_50"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-is_power_of_two"><span class="LIDENT">is_power_of_two</span></span> <span id="local_v_57"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_v_57"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_v_57"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <a href="#local_v_57"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_v_57"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-to_power_of_two"><span class="LIDENT">to_power_of_two</span></span> <span id="local_v_58"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_59"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <a href="#local_v_58"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_59"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_bigstring"><span class="LIDENT">output_bigstring</span></span> <span id="local_oc_60"><span class="LIDENT">oc</span></span> <span id="local_buf_61"><span class="LIDENT">buf</span></span> <span id="local_off_62"><span class="LIDENT">off</span></span> <span id="local_len_63"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* XXX(dinosaure): stupidly slow! *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_v_64"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-sub"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_buf_61"><span class="LIDENT">buf</span></a> <a href="#local_off_62"><span class="LIDENT">off</span></a> <a href="#local_len_63"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_v_65"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_to_string</span> <a href="#local_v_64"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-output_string"><span class="LIDENT">output_string</span></a> <a href="#local_oc_60"><span class="LIDENT">oc</span></a> <a href="#local_v_65"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-input_bigstring"><span class="LIDENT">input_bigstring</span></span> <span id="local_ic_66"><span class="LIDENT">ic</span></span> <span id="local_buf_67"><span class="LIDENT">buf</span></span> <span id="local_off_68"><span class="LIDENT">off</span></span> <span id="local_len_69"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_tmp_70"><span class="LIDENT">tmp</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_len_69"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_71"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_66"><span class="LIDENT">ic</span></a> <a href="#local_tmp_70"><span class="LIDENT">tmp</span></a> <span class="INT">0</span> <a href="#local_len_69"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len0_72"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_res_71"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len1_73"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_res_71"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_73"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_74"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_v_75"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bytes_unsafe_get_uint32</span> <a href="#local_tmp_70"><span class="LIDENT">tmp</span></a> <a href="#local_i_74"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_buf_67"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_off_68"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_74"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_75"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_72"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_76"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_73"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_77"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bytes_unsafe_get_uint8</span> <a href="#local_tmp_70"><span class="LIDENT">tmp</span></a> <a href="#local_i_76"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_buf_67"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_off_68"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_76"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_77"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_res_71"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-invalid_bounds"><span class="LIDENT">invalid_bounds</span></span> <span id="local_off_78"><span class="LIDENT">off</span></span> <span id="local_len_79"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;Out of bounds (off: %d, len: %d)&quot;</span> <a href="#local_off_78"><span class="LIDENT">off</span></a> <a href="#local_len_79"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_blit"><span class="LIDENT">unsafe_blit</span></span> <span id="local_src_80"><span class="LIDENT">src</span></span> <span id="local_src_off_81"><span class="LIDENT">src_off</span></span> <span id="local_dst_82"><span class="LIDENT">dst</span></span> <span id="local_dst_off_83"><span class="LIDENT">dst_off</span></span> <span id="local_len_84"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_84"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst_82"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_83"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_80"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_81"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-slow_blit2"><span class="LIDENT">slow_blit2</span></span> <span id="local_src_85"><span class="LIDENT">src</span></span> <span id="local_src_off_86"><span class="LIDENT">src_off</span></span> <span id="local_dst0_87"><span class="LIDENT">dst0</span></span> <span id="local_dst0_off_88"><span class="LIDENT">dst0_off</span></span> <span id="local_dst1_89"><span class="LIDENT">dst1</span></span> <span id="local_dst1_off_90"><span class="LIDENT">dst1_off</span></span> <span id="local_len_91"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_91"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_v_92"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_85"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_86"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst0_87"><span class="LIDENT">dst0</span></a> <span class="LPAREN">(</span><a href="#local_dst0_off_88"><span class="LIDENT">dst0_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="#local_v_92"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst1_89"><span class="LIDENT">dst1</span></a> <span class="LPAREN">(</span><a href="#local_dst1_off_90"><span class="LIDENT">dst1_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="#local_v_92"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): fast blit when it's possible. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-blit2"><span class="LIDENT">blit2</span></span> <span id="local_src_93"><span class="LIDENT">src</span></span> <span id="local_src_off_94"><span class="LIDENT">src_off</span></span> <span id="local_dst0_95"><span class="LIDENT">dst0</span></span> <span id="local_dst0_off_96"><span class="LIDENT">dst0_off</span></span> <span id="local_dst1_97"><span class="LIDENT">dst1</span></span> <span id="local_dst1_off_98"><span class="LIDENT">dst1_off</span></span> <span id="local_len_99"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_dst0_off_96"><span class="LIDENT">dst0_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_src_off_94"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">4</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">slow_blit2</span> <a href="#local_src_93"><span class="LIDENT">src</span></a> <a href="#local_src_off_94"><span class="LIDENT">src_off</span></a> <a href="#local_dst0_95"><span class="LIDENT">dst0</span></a> <a href="#local_dst0_off_96"><span class="LIDENT">dst0_off</span></a> <a href="#local_dst1_97"><span class="LIDENT">dst1</span></a> <a href="#local_dst1_off_98"><span class="LIDENT">dst1_off</span></a> <a href="#local_len_99"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len0_100"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_99"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len1_101"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_99"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_101"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_102"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_103"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_src_93"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_94"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_102"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst0_95"><span class="LIDENT">dst0</span></a> <span class="LPAREN">(</span><a href="#local_dst0_off_96"><span class="LIDENT">dst0_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_102"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_103"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst1_97"><span class="LIDENT">dst1</span></a> <span class="LPAREN">(</span><a href="#local_dst1_off_98"><span class="LIDENT">dst1_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_102"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_103"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_100"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_104"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_101"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_v_105"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_93"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_94"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_104"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst0_95"><span class="LIDENT">dst0</span></a> <span class="LPAREN">(</span><a href="#local_dst0_off_96"><span class="LIDENT">dst0_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_104"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_105"><span class="LIDENT">v</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst1_97"><span class="LIDENT">dst1</span></a> <span class="LPAREN">(</span><a href="#local_dst1_off_98"><span class="LIDENT">dst1_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_104"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_105"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): fast fill operation. (usually when [Match (len:?, dist:1)]) *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fill2"><span class="LIDENT">fill2</span></span> <span id="local_v_106"><span class="LIDENT">v</span></span> <span id="local_dst0_107"><span class="LIDENT">dst0</span></span> <span id="local_dst0_off_108"><span class="LIDENT">dst0_off</span></span> <span id="local_dst1_109"><span class="LIDENT">dst1</span></span> <span id="local_dst1_off_110"><span class="LIDENT">dst1_off</span></span> <span id="local_len_111"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len0_112"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_111"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len1_113"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_111"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_nv_114"><span class="LIDENT">nv</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">of_int</span></a> <a href="#local_v_106"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_vv_115"><span class="LIDENT">vv</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="LIDENT">logor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <a href="#local_nv_114"><span class="LIDENT">nv</span></a> <span class="INT">8</span><span class="RPAREN">)</span> <a href="#local_nv_114"><span class="LIDENT">nv</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_vvvv_116"><span class="LIDENT">vvvv</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="LIDENT">logor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <a href="#local_vv_115"><span class="LIDENT">vv</span></a> <span class="INT">16</span><span class="RPAREN">)</span> <a href="#local_vv_115"><span class="LIDENT">vv</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_vvvv_117"><span class="LIDENT">vvvv</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int32"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">to_int32</span></a> <a href="#local_vvvv_116"><span class="LIDENT">vvvv</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_113"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_118"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst0_107"><span class="LIDENT">dst0</span></a> <span class="LPAREN">(</span><a href="#local_dst0_off_108"><span class="LIDENT">dst0_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_118"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_vvvv_117"><span class="LIDENT">vvvv</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst1_109"><span class="LIDENT">dst1</span></a> <span class="LPAREN">(</span><a href="#local_dst1_off_110"><span class="LIDENT">dst1_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_118"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_vvvv_117"><span class="LIDENT">vvvv</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_112"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_119"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_113"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst0_107"><span class="LIDENT">dst0</span></a> <span class="LPAREN">(</span><a href="#local_dst0_off_108"><span class="LIDENT">dst0_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_119"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_106"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst1_109"><span class="LIDENT">dst1</span></a> <span class="LPAREN">(</span><a href="#local_dst1_off_110"><span class="LIDENT">dst1_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_119"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_106"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-io_buffer_size"><span class="LIDENT">io_buffer_size</span></span> <span class="EQUAL">=</span> <span class="INT">65536</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): Specialization. *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-{&lt;}1/shadowed/(decompress-src-decompress.de-de.ml)"><span class="EXTERNAL">external</span> <span class="LPAREN">(</span> <span class="LESS">&lt;</span> <span class="RPAREN">)</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%lessthan&quot;</span></span><span class="EOL">
</span><span id="val-{&lt;=}2/shadowed/(decompress-src-decompress.de-de.ml)"><span class="EXTERNAL">external</span> <span class="LPAREN">(</span> <span class="INFIXOP0">&lt;=</span> <span class="RPAREN">)</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%lessequal&quot;</span></span><span class="EOL">
</span><span id="val-{&gt;=}3/shadowed/(decompress-src-decompress.de-de.ml)"><span class="EXTERNAL">external</span> <span class="LPAREN">(</span> <span class="INFIXOP0">&gt;=</span> <span class="RPAREN">)</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%greaterequal&quot;</span></span><span class="EOL">
</span><span id="val-{&gt;}4/shadowed/(decompress-src-decompress.de-de.ml)"><span class="EXTERNAL">external</span> <span class="LPAREN">(</span> <span class="GREATER">&gt;</span> <span class="RPAREN">)</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%greaterthan&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(&gt;)"><span class="LPAREN">(</span> <span class="GREATER">&gt;</span> <span class="RPAREN">)</span></span> <span class="LPAREN">(</span><span id="local_x_120"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_y_121"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <a href="#local_x_120"><span class="LIDENT">x</span></a> <span class="GREATER">&gt;</span> <a href="#local_y_121"><span class="LIDENT">y</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(&lt;)"><span class="LPAREN">(</span> <span class="LESS">&lt;</span> <span class="RPAREN">)</span></span> <span class="LPAREN">(</span><span id="local_x_122"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_y_123"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <a href="#local_x_122"><span class="LIDENT">x</span></a> <span class="LESS">&lt;</span> <a href="#local_y_123"><span class="LIDENT">y</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(&lt;=)"><span class="LPAREN">(</span> <span class="INFIXOP0">&lt;=</span> <span class="RPAREN">)</span></span> <span class="LPAREN">(</span><span id="local_x_124"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_y_125"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <a href="#local_x_124"><span class="LIDENT">x</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_y_125"><span class="LIDENT">y</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(&gt;=)"><span class="LPAREN">(</span> <span class="INFIXOP0">&gt;=</span> <span class="RPAREN">)</span></span> <span class="LPAREN">(</span><span id="local_x_126"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_y_127"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <a href="#local_x_126"><span class="LIDENT">x</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_y_127"><span class="LIDENT">y</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-min"><span class="LIDENT">min</span></span> <span class="LPAREN">(</span><span id="local_a_128"><span class="LIDENT">a</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_b_129"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_a_128"><span class="LIDENT">a</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_b_129"><span class="LIDENT">b</span></a> <span class="THEN">then</span> <a href="#local_a_128"><span class="LIDENT">a</span></a> <span class="ELSE">else</span> <a href="#local_b_129"><span class="LIDENT">b</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-max"><span class="LIDENT">max</span></span> <span class="LPAREN">(</span><span id="local_a_130"><span class="LIDENT">a</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_b_131"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_a_130"><span class="LIDENT">a</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_b_131"><span class="LIDENT">b</span></a> <span class="THEN">then</span> <a href="#local_a_130"><span class="LIDENT">a</span></a> <span class="ELSE">else</span> <a href="#local_b_131"><span class="LIDENT">b</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): Constants. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_max_bits"><span class="LIDENT">_max_bits</span></span> <span class="EQUAL">=</span> <span class="INT">15</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_smallest"><span class="LIDENT">_smallest</span></span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_rep_3_6"><span class="LIDENT">_rep_3_6</span></span> <span class="EQUAL">=</span> <span class="INT">16</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_repz_3_10"><span class="LIDENT">_repz_3_10</span></span> <span class="EQUAL">=</span> <span class="INT">17</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_repz_11_138"><span class="LIDENT">_repz_11_138</span></span> <span class="EQUAL">=</span> <span class="INT">18</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_literals"><span class="LIDENT">_literals</span></span> <span class="EQUAL">=</span> <span class="INT">256</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_length_codes"><span class="LIDENT">_length_codes</span></span> <span class="EQUAL">=</span> <span class="INT">29</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_l_codes"><span class="LIDENT">_l_codes</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_literals</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length_codes</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_d_codes"><span class="LIDENT">_d_codes</span></span> <span class="EQUAL">=</span> <span class="INT">30</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_heap_size"><span class="LIDENT">_heap_size</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">_l_codes</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_bl_codes"><span class="LIDENT">_bl_codes</span></span> <span class="EQUAL">=</span> <span class="INT">19</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-zigzag"><span class="LIDENT">zigzag</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="INT">16</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">15</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_length"><span class="LIDENT">_length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">16</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">28</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-{_distance}5/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">_distance</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">12</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">15</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">15</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">17</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">18</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">19</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">21</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">22</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">23</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">25</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">26</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">27</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="SEMI">;</span> <span class="INT">29</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_distance"><span class="LIDENT">_distance</span></span> <span id="local_code_132"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_code_132"><span class="LIDENT">code</span></a> <span class="LESS">&lt;</span> <span class="INT">256</span> <span class="THEN">then</span> <span class="LIDENT">_distance</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_code_132"><span class="LIDENT">code</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="LIDENT">_distance</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_code_132"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">7</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_base_length"><span class="LIDENT">_base_length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">14</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">20</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">28</span><span class="SEMI">;</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="INT">40</span><span class="SEMI">;</span> <span class="INT">48</span><span class="SEMI">;</span> <span class="INT">56</span><span class="SEMI">;</span> <span class="INT">64</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">80</span><span class="SEMI">;</span> <span class="INT">96</span><span class="SEMI">;</span> <span class="INT">112</span><span class="SEMI">;</span> <span class="INT">128</span><span class="SEMI">;</span> <span class="INT">160</span><span class="SEMI">;</span> <span class="INT">192</span><span class="SEMI">;</span> <span class="INT">224</span><span class="SEMI">;</span> <span class="INT">255</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* assert (Array.length _base_length = 32) ;

   XXX(dinosaure): in [zlib], [base_length] has 29 elements - however, it uses
   the array only when it deflates something - it uses something else about
   the inflation. We added two last [0] to avoid an [index out of bounds] where,
   in some context, [_base_length] is used with input bits - finally, we can
   mask input bits with [0x1f]. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_extra_lbits"><span class="LIDENT">_extra_lbits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">5</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_extra_dbits"><span class="LIDENT">_extra_dbits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">10</span><span class="SEMI">;</span> <span class="INT">11</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">11</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">13</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* assert (Array.length _extra_dbits = 32) ; *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_base_dist"><span class="LIDENT">_base_dist</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">12</span><span class="SEMI">;</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="INT">24</span><span class="SEMI">;</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="INT">48</span><span class="SEMI">;</span> <span class="INT">64</span><span class="SEMI">;</span> <span class="INT">96</span><span class="SEMI">;</span> <span class="INT">128</span><span class="SEMI">;</span> <span class="INT">192</span><span class="SEMI">;</span> <span class="INT">256</span><span class="SEMI">;</span> <span class="INT">384</span><span class="SEMI">;</span> <span class="INT">512</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">768</span><span class="SEMI">;</span> <span class="INT">1024</span><span class="SEMI">;</span> <span class="INT">1536</span><span class="SEMI">;</span> <span class="INT">2048</span><span class="SEMI">;</span> <span class="INT">3072</span><span class="SEMI">;</span> <span class="INT">4096</span><span class="SEMI">;</span> <span class="INT">6144</span><span class="SEMI">;</span> <span class="INT">8192</span><span class="SEMI">;</span> <span class="INT">12288</span><span class="SEMI">;</span> <span class="INT">16384</span><span class="SEMI">;</span> <span class="INT">24576</span><span class="SEMI">;</span> <span class="MINUS">-</span><span class="INT">1</span><span class="SEMI">;</span> <span class="MINUS">-</span><span class="INT">1</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Window for end-user. *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-window"><span class="TYPE">type</span> <span class="LIDENT">window</span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_window"><span class="LIDENT">make_window</span></span> <span class="TILDE">~</span><span id="local_bits_133"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_bits_133"><span class="LIDENT">bits</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">8</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_bits_133"><span class="LIDENT">bits</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">15</span> <span class="THEN">then</span> <span class="LIDENT">bigstring_create</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;bits MUST be between 8 and 15 (%d)&quot;</span> <a href="#local_bits_133"><span class="LIDENT">bits</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ffs"><span class="LIDENT">ffs</span></span> <span id="local_n_134"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_134"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;ffs on 0&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t_135"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_136"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="#local_n_134"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_t_135"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>      <a href="#local_t_135"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_t_135"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_r_136"><span class="LIDENT">r</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_136"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-window_bits"><span class="LIDENT">window_bits</span></span> <span id="local_w_137"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ffs</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_w_137"><span class="LIDENT">w</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Lookup"><span class="MODULE">module</span> <span class="UIDENT">Lookup</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="COMMENT">(* Used as inflate to store lookup.[bit-sequence] = [len &lt;&lt; 15 | byte].
     Used as deflate to store lookup.[byte] = [len &lt;&lt; 15 | bit-sequence]. *)</span><span class="EOL">
</span>  <span id="module-Lookup.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1590"><span class="LIDENT">t</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="SEMI">;</span></span> <span id="def_1527"><span class="LIDENT">m</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1525"><span class="LIDENT">l</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lookup.val-mask"><span class="LIDENT">mask</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lookup.val-make"><span class="LIDENT">make</span></span> <span id="local_t_138"><span class="LIDENT">t</span></span> <span id="local_m_139"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_t_138"><span class="LIDENT">t</span></a><span class="SEMI">;</span> <span class="LIDENT">m</span><span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_m_139"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="SEMI">;</span> <span class="LIDENT">l</span><span class="EQUAL">=</span> <a href="#local_m_139"><span class="LIDENT">m</span></a><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lookup.val-get"><span class="LIDENT">get</span></span> <span id="local_t_140"><span class="LIDENT">t</span></span> <span id="local_i_141"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_v_142"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_t_140"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_141"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_v_142"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_max_bits</span><span class="COMMA">,</span> <a href="#local_v_142"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">mask</span><span class="EOL">
</span>    <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>    <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-{_static_ltree}6/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">_static_ltree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">12</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">140</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">76</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">204</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">44</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">172</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">108</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">236</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">28</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">156</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">92</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">220</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">60</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">188</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">124</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">252</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">2</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">130</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">66</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">194</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">34</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">162</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">98</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">226</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">18</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">146</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">82</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">210</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">50</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">178</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">114</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">242</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">10</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">138</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">74</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">202</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">42</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">170</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">106</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">234</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">26</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">154</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">90</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">218</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">58</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">186</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">122</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">250</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">6</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">134</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">70</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">198</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">38</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">166</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">102</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">230</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">22</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">150</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">86</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">214</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">54</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">182</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">118</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">246</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">14</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">142</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">78</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">206</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">46</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">174</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">110</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">238</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">30</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">158</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">94</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">222</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">62</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">190</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">126</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">254</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">129</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">65</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">193</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">33</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">161</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">97</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">225</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">17</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">145</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">81</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">209</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">49</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">177</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">113</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">241</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">9</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">137</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">73</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">201</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">41</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">169</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">105</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">233</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">25</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">153</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">89</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">217</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">57</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">185</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">121</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">249</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">5</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">133</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">69</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">197</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">37</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">165</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">101</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">229</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">21</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">149</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">85</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">213</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">53</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">181</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">117</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">245</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">13</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">141</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">77</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">205</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">45</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">173</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">109</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">237</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">29</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">157</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">93</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">221</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">61</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">189</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">125</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">253</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">19</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">275</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">147</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">403</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">83</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">339</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">211</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">467</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">51</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">307</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">179</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">435</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">115</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">371</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">243</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">499</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">11</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">267</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">139</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">395</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">75</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">331</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">203</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">459</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">43</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">299</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">171</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">427</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">107</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">363</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">235</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">491</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">27</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">283</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">155</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">411</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">91</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">347</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">219</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">475</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">59</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">315</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">187</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">443</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">123</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">379</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">251</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">507</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">7</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">263</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">135</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">391</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">71</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">327</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">199</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">455</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">39</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">295</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">167</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">423</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">103</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">359</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">231</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">487</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">23</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">279</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">151</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">407</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">87</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">343</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">215</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">471</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">55</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">311</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">183</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">439</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">119</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">375</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">247</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">503</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">15</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">271</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">143</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">399</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">79</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">335</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">207</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">463</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">47</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">303</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">175</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">431</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">111</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">367</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">239</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">495</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">31</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">287</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">159</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">415</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">95</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">351</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">223</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">479</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">63</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">319</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">191</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">447</span><span class="COMMA">,</span> <span class="INT">9</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">127</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">383</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">255</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">511</span><span class="COMMA">,</span> <span class="INT">9</span><span class="SEMI">;</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">64</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">32</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">96</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">16</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">80</span><span class="COMMA">,</span> <span class="INT">7</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">48</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">112</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">8</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">72</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">40</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">104</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">24</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">88</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">56</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">120</span><span class="COMMA">,</span> <span class="INT">7</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">4</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">68</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">36</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">100</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">20</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">84</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">52</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">116</span><span class="COMMA">,</span> <span class="INT">7</span><span class="SEMI">;</span> <span class="INT">3</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">131</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">67</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">195</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">35</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">163</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">99</span><span class="COMMA">,</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="INT">227</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_static_ltree"><span class="LIDENT">_static_ltree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t_143"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-map"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_v_144"><span class="LIDENT">v</span></span><span class="COMMA">,</span> <span id="local_l_145"><span class="LIDENT">l</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_l_145"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_v_144"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="LIDENT">_static_ltree</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_t_143"><span class="LIDENT">t</span></a> <span class="INT">9</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-{_static_dtree}7/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">_static_dtree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>     <span class="INT">0</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">16</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">8</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">24</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">4</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">20</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">12</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">28</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">2</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">18</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">10</span><span class="COMMA">,</span> <span class="INT">5</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">26</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">6</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">22</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">14</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">30</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">17</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">9</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">25</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">5</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">21</span><span class="COMMA">,</span> <span class="INT">5</span><span class="EOL">
</span>   <span class="SEMI">;</span> <span class="INT">13</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">29</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">3</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">19</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">11</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">27</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">7</span><span class="COMMA">,</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="INT">23</span><span class="COMMA">,</span> <span class="INT">5</span><span class="EOL">
</span>  <span class="BARRBRACKET">|]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-_static_dtree"><span class="LIDENT">_static_dtree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t_146"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-map"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_v_147"><span class="LIDENT">v</span></span><span class="COMMA">,</span> <span id="local_l_148"><span class="LIDENT">l</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_l_148"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_v_147"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="LIDENT">_static_dtree</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_t_146"><span class="LIDENT">t</span></a> <span class="INT">5</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): [zlib] raises &quot;Invalid distance code&quot; where it wants to
   access to [base_dist.(30|31)]. It uses a smart mask to catch this behavior.
   In this code, we did not raise an error nor /compromise/ output when we fall
   to [Match (len:?, dist:0)] (so, nothing to do).

   Case can be retrieved with &quot;\x02\x7e\xff\xff&quot;. NOTE: [miniz] has this silent
   behavior.

   XXX(dinosaure): It's not true anymore where we decide to raise an error to
   avoid an other error about access on window. It's explained below when we
   have a [Write] operation. *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-optint"><span class="TYPE">type</span> <span class="LIDENT">optint</span> <span class="EQUAL">=</span> <a href="../../../optint/src/optint/optint.ml.html#module-Immediate64.module-Make.type-t"><span class="UIDENT">Optint</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX(dinosaure): optimize [Heap]. TODO! *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Heap"><span class="MODULE">module</span> <span class="UIDENT">Heap</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Heap.type-priority"><span class="TYPE">type</span> <span class="LIDENT">priority</span> <span class="EQUAL">=</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span id="module-Heap.type-queue"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">queue</span> <span class="EQUAL">=</span> <span id="module-Heap.type-queue.constructor-None"><span class="UIDENT">None</span></span> <span id="module-Heap.type-queue.constructor-Node"><span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="OF">of</span> <span class="LIDENT">priority</span> <span class="STAR">*</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="STAR">*</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">queue</span> <span class="STAR">*</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">queue</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Heap.val-push"><span class="LIDENT">push</span></span> <span id="local_queue_149"><span class="LIDENT">queue</span></span> <span id="local_priority_150"><span class="LIDENT">priority</span></span> <span id="local_elt_151"><span class="LIDENT">elt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_queue_149"><span class="LIDENT">queue</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><a href="#local_priority_150"><span class="LIDENT">priority</span></a><span class="COMMA">,</span> <a href="#local_elt_151"><span class="LIDENT">elt</span></a><span class="COMMA">,</span> <span class="UIDENT">None</span><span class="COMMA">,</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span id="local_p_152"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_e_153"><span class="LIDENT">e</span></span><span class="COMMA">,</span> <span id="local_left_154"><span class="LIDENT">left</span></span><span class="COMMA">,</span> <span id="local_right_155"><span class="LIDENT">right</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_priority_150"><span class="LIDENT">priority</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_p_152"><span class="LIDENT">p</span></a> <span class="THEN">then</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><a href="#local_priority_150"><span class="LIDENT">priority</span></a><span class="COMMA">,</span> <a href="#local_elt_151"><span class="LIDENT">elt</span></a><span class="COMMA">,</span> <span class="LIDENT">push</span> <a href="#local_right_155"><span class="LIDENT">right</span></a> <a href="#local_p_152"><span class="LIDENT">p</span></a> <a href="#local_e_153"><span class="LIDENT">e</span></a><span class="COMMA">,</span> <a href="#local_left_154"><span class="LIDENT">left</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><a href="#local_p_152"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_e_153"><span class="LIDENT">e</span></a><span class="COMMA">,</span> <span class="LIDENT">push</span> <a href="#local_right_155"><span class="LIDENT">right</span></a> <a href="#local_priority_150"><span class="LIDENT">priority</span></a> <a href="#local_elt_151"><span class="LIDENT">elt</span></a><span class="COMMA">,</span> <a href="#local_left_154"><span class="LIDENT">left</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Heap.exception-Empty"><span class="EXCEPTION">exception</span> <span class="UIDENT">Empty</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Heap.val-remove"><span class="LIDENT">remove</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Empty</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_left_156"><span class="LIDENT">left</span></span><span class="COMMA">,</span> <span class="UIDENT">None</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_left_156"><span class="LIDENT">left</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">None</span><span class="COMMA">,</span> <span id="local_right_157"><span class="LIDENT">right</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_right_157"><span class="LIDENT">right</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Node</span> <span class="LPAREN">(</span><span id="local_lp_159"><span class="LIDENT">lp</span></span><span class="COMMA">,</span> <span id="local_le_160"><span class="LIDENT">le</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_left_158"><span class="LIDENT">left</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Node</span> <span class="LPAREN">(</span><span id="local_rp_162"><span class="LIDENT">rp</span></span><span class="COMMA">,</span> <span id="local_re_163"><span class="LIDENT">re</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_right_161"><span class="LIDENT">right</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_lp_159"><span class="LIDENT">lp</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_rp_162"><span class="LIDENT">rp</span></a> <span class="THEN">then</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><a href="#local_lp_159"><span class="LIDENT">lp</span></a><span class="COMMA">,</span> <a href="#local_le_160"><span class="LIDENT">le</span></a><span class="COMMA">,</span> <span class="LIDENT">remove</span> <a href="#local_left_158"><span class="LIDENT">left</span></a><span class="COMMA">,</span> <a href="#local_right_161"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><a href="#local_rp_162"><span class="LIDENT">rp</span></a><span class="COMMA">,</span> <a href="#local_re_163"><span class="LIDENT">re</span></a><span class="COMMA">,</span> <a href="#local_left_158"><span class="LIDENT">left</span></a><span class="COMMA">,</span> <span class="LIDENT">remove</span> <a href="#local_right_161"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Heap.val-take"><span class="LIDENT">take</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Empty</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span id="local_p_165"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_e_166"><span class="LIDENT">e</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_queue_164"><span class="LIDENT">queue</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_165"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_e_166"><span class="LIDENT">e</span></a><span class="COMMA">,</span> <span class="LIDENT">remove</span> <a href="#local_queue_164"><span class="LIDENT">queue</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-WInf"><span class="MODULE">module</span> <span class="UIDENT">WInf</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-WInf.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1468"><span class="LIDENT">raw</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="SEMI">;</span></span> <span id="def_1559"><span class="MUTABLE">mutable</span> <span class="LIDENT">w</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1512"><span class="MUTABLE">mutable</span> <span class="LIDENT">c</span><span class="COLON">:</span> <span class="LIDENT">optint</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-max"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-{mask}8/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">mask</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">warning</span> <span class="STRING">&quot;-32&quot;</span><span class="RBRACKET">]</span> <span id="module-WInf.val-make"><span class="LIDENT">make</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="LIDENT">raw</span><span class="EQUAL">=</span> <span class="LIDENT">bigstring_create</span> <span class="LIDENT">max</span><span class="SEMI">;</span> <span class="LIDENT">w</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">c</span><span class="EQUAL">=</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">default</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-from"><span class="LIDENT">from</span></span> <span id="local_raw_167"><span class="LIDENT">raw</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_raw_167"><span class="LIDENT">raw</span></a><span class="SEMI">;</span> <span class="LIDENT">w</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">c</span><span class="EQUAL">=</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">default</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-reset"><span class="LIDENT">reset</span></span> <span id="local_t_168"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_t_168"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_168"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">default</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-mask"><span class="LIDENT">mask</span></span> <span id="local_v_169"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_v_169"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">mask</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-update"><span class="LIDENT">update</span></span> <span id="local_w_170"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_171"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">unsafe_digest_bigstring</span> <a href="#local_w_170"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="INT">0</span> <span class="LIDENT">max</span> <a href="#local_w_170"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_w_170"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_171"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-add"><span class="LIDENT">add</span></span> <span id="local_t_172"><span class="LIDENT">t</span></span> <span id="local_v_173"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_t_172"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="LPAREN">(</span><span class="LIDENT">mask</span> <a href="#local_t_172"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="RPAREN">)</span> <a href="#local_v_173"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">mask</span> <span class="LPAREN">(</span><a href="#local_t_172"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">update</span> <a href="#local_t_172"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_172"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_172"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-sub"><span class="LIDENT">sub</span></span> <span id="local_a_174"><span class="LIDENT">a</span></span> <span id="local_b_175"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_a_174"><span class="LIDENT">a</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_b_175"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-compare"><span class="LIDENT">compare</span></span> <span id="local_a_176"><span class="LIDENT">a</span></span> <span id="local_b_177"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-compare"><span class="LIDENT">compare</span></a> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">sub</span> <a href="#local_a_176"><span class="LIDENT">a</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-min_int"><span class="LIDENT">min_int</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">sub</span> <a href="#local_b_177"><span class="LIDENT">b</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-min_int"><span class="LIDENT">min_int</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-have"><span class="LIDENT">have</span></span> <span id="local_t_178"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <span class="LIDENT">compare</span> <a href="#local_t_178"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LIDENT">max</span> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_t_178"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="ELSE">else</span> <span class="LIDENT">max</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* XXX(dinosaure): a dragoon here. overflow can appear on [t.w] which only
     increases. [compare] gives us a new chance to compare correctly [t.w] if it
     overflows __one-time__. Then, for the second time, this code is broken. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-blit"><span class="LIDENT">blit</span></span> <span id="local_t_179"><span class="LIDENT">t</span></span> <span id="local_w_180"><span class="LIDENT">w</span></span> <span id="local_w_off_181"><span class="LIDENT">w_off</span></span> <span id="local_o_182"><span class="LIDENT">o</span></span> <span id="local_o_off_183"><span class="LIDENT">o_off</span></span> <span id="local_len_184"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_msk_185"><span class="LIDENT">msk</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mask</span> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pre_186"><span class="LIDENT">pre</span></span> <span class="EQUAL">=</span> <span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_msk_185"><span class="LIDENT">msk</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rst_187"><span class="LIDENT">rst</span></span> <span class="EQUAL">=</span> <a href="#local_len_184"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pre_186"><span class="LIDENT">pre</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rst_187"><span class="LIDENT">rst</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">blit2</span> <a href="#local_w_180"><span class="LIDENT">w</span></a> <a href="#local_w_off_181"><span class="LIDENT">w_off</span></a> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_msk_185"><span class="LIDENT">msk</span></a> <a href="#local_o_182"><span class="LIDENT">o</span></a> <a href="#local_o_off_183"><span class="LIDENT">o_off</span></a> <a href="#local_pre_186"><span class="LIDENT">pre</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">update</span> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">blit2</span> <a href="#local_w_180"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><a href="#local_w_off_181"><span class="LIDENT">w_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_pre_186"><span class="LIDENT">pre</span></a><span class="RPAREN">)</span> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="INT">0</span> <a href="#local_o_182"><span class="LIDENT">o</span></a> <span class="LPAREN">(</span><a href="#local_o_off_183"><span class="LIDENT">o_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_pre_186"><span class="LIDENT">pre</span></a><span class="RPAREN">)</span> <a href="#local_rst_187"><span class="LIDENT">rst</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">blit2</span> <a href="#local_w_180"><span class="LIDENT">w</span></a> <a href="#local_w_off_181"><span class="LIDENT">w_off</span></a> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_msk_185"><span class="LIDENT">msk</span></a> <a href="#local_o_182"><span class="LIDENT">o</span></a> <a href="#local_o_off_183"><span class="LIDENT">o_off</span></a> <a href="#local_len_184"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">mask</span> <span class="LPAREN">(</span><a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_184"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_len_184"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">update</span> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_179"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_184"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-fill"><span class="LIDENT">fill</span></span> <span id="local_t_188"><span class="LIDENT">t</span></span> <span id="local_v_189"><span class="LIDENT">v</span></span> <span id="local_o_190"><span class="LIDENT">o</span></span> <span id="local_o_off_191"><span class="LIDENT">o_off</span></span> <span id="local_len_192"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_msk_193"><span class="LIDENT">msk</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mask</span> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pre_194"><span class="LIDENT">pre</span></span> <span class="EQUAL">=</span> <span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_msk_193"><span class="LIDENT">msk</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rst_195"><span class="LIDENT">rst</span></span> <span class="EQUAL">=</span> <a href="#local_len_192"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pre_194"><span class="LIDENT">pre</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rst_195"><span class="LIDENT">rst</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">fill2</span> <a href="#local_v_189"><span class="LIDENT">v</span></a> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_msk_193"><span class="LIDENT">msk</span></a> <a href="#local_o_190"><span class="LIDENT">o</span></a> <a href="#local_o_off_191"><span class="LIDENT">o_off</span></a> <a href="#local_pre_194"><span class="LIDENT">pre</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">update</span> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">fill2</span> <a href="#local_v_189"><span class="LIDENT">v</span></a> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="INT">0</span> <a href="#local_o_190"><span class="LIDENT">o</span></a> <span class="LPAREN">(</span><a href="#local_o_off_191"><span class="LIDENT">o_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_pre_194"><span class="LIDENT">pre</span></a><span class="RPAREN">)</span> <a href="#local_rst_195"><span class="LIDENT">rst</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">fill2</span> <a href="#local_v_189"><span class="LIDENT">v</span></a> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_msk_193"><span class="LIDENT">msk</span></a> <a href="#local_o_190"><span class="LIDENT">o</span></a> <a href="#local_o_off_191"><span class="LIDENT">o_off</span></a> <a href="#local_len_192"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">mask</span> <span class="LPAREN">(</span><a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_192"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_len_192"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">update</span> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_188"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_192"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-tail"><span class="LIDENT">tail</span></span> <span id="local_w_196"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_msk_197"><span class="LIDENT">msk</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mask</span> <a href="#local_w_196"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_msk_197"><span class="LIDENT">msk</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_198"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">unsafe_digest_bigstring</span> <a href="#local_w_196"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="INT">0</span> <a href="#local_msk_197"><span class="LIDENT">msk</span></a> <a href="#local_w_196"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_w_196"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): reset! *)</span><span class="EOL">
</span>        <a href="#local_w_196"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_198"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-WInf.val-checksum"><span class="LIDENT">checksum</span></span> <span id="local_w_199"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <a href="#local_w_199"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">c</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Inf"><span class="MODULE">module</span> <span class="UIDENT">Inf</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="COMMENT">(* Ã  la dbuenzli *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.type-src"><span class="TYPE">type</span> <span class="LIDENT">src</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="OF">of</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-in_channel"><span class="LIDENT">in_channel</span></a> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span class="OF">of</span> <span class="LIDENT">string</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span>  <span id="module-Inf.type-decode"><span class="TYPE">type</span> <span class="LIDENT">decode</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Malformed</span> <span class="OF">of</span> <span class="LIDENT">string</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.exception-Invalid_huffman"><span class="EXCEPTION">exception</span> <span class="UIDENT">Invalid_huffman</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-prefix"><span class="LIDENT">prefix</span></span> <span id="local_heap_200"><span class="LIDENT">heap</span></span> <span id="local_max_201"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_max_201"><span class="LIDENT">max</span></a> <span class="LESS">&lt;</span> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_tbl_202"><span class="LIDENT">tbl</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_max_201"><span class="LIDENT">max</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_backward_203"><span class="LIDENT">backward</span></span> <span id="local_huff_204"><span class="LIDENT">huff</span></span> <span id="local_incr_205"><span class="LIDENT">incr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_huff_204"><span class="LIDENT">huff</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_incr_205"><span class="LIDENT">incr</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_backward_203"><span class="LIDENT">backward</span></a> <a href="#local_huff_204"><span class="LIDENT">huff</span></a> <span class="LPAREN">(</span><a href="#local_incr_205"><span class="LIDENT">incr</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_incr_205"><span class="LIDENT">incr</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_206"><span class="LIDENT">aux</span></span> <span id="local_huff_207"><span class="LIDENT">huff</span></span> <span id="local_heap_208"><span class="LIDENT">heap</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">take</span> <a href="#local_heap_208"><span class="LIDENT">heap</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span id="local_len_209"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_value_210"><span class="LIDENT">value</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_heap_211"><span class="LIDENT">heap</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_212"><span class="LIDENT">loop</span></span> <span id="local_decr_213"><span class="LIDENT">decr</span></span> <span id="local_fill_214"><span class="LIDENT">fill</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <a href="#local_tbl_202"><span class="LIDENT">tbl</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_huff_207"><span class="LIDENT">huff</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_fill_214"><span class="LIDENT">fill</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><a href="#local_len_209"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_value_210"><span class="LIDENT">value</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_fill_214"><span class="LIDENT">fill</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_loop_212"><span class="LIDENT">loop</span></a> <a href="#local_decr_213"><span class="LIDENT">decr</span></a> <span class="LPAREN">(</span><a href="#local_fill_214"><span class="LIDENT">fill</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_decr_213"><span class="LIDENT">decr</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_decr_215"><span class="LIDENT">decr</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_len_209"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_loop_212"><span class="LIDENT">loop</span></a> <a href="#local_decr_215"><span class="LIDENT">decr</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_max_201"><span class="LIDENT">max</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_decr_215"><span class="LIDENT">decr</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_incr_216"><span class="LIDENT">incr</span></span> <span class="EQUAL">=</span> <a href="#local_backward_203"><span class="LIDENT">backward</span></a> <a href="#local_huff_207"><span class="LIDENT">huff</span></a> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="#local_len_209"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_aux_206"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_incr_216"><span class="LIDENT">incr</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><a href="#local_huff_207"><span class="LIDENT">huff</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><a href="#local_incr_216"><span class="LIDENT">incr</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_incr_216"><span class="LIDENT">incr</span></a> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span> <a href="#local_heap_211"><span class="LIDENT">heap</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_aux_206"><span class="LIDENT">aux</span></a> <span class="INT">0</span> <a href="#local_heap_200"><span class="LIDENT">heap</span></a> <span class="SEMI">;</span> <a href="#local_tbl_202"><span class="LIDENT">tbl</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.type-kind"><span class="TYPE">type</span> <span class="LIDENT">kind</span> <span class="EQUAL">=</span> <span id="module-Inf.type-kind.constructor-CODES"><span class="UIDENT">CODES</span></span> <span id="module-Inf.type-kind.constructor-LENS"><span class="BAR">|</span> <span class="UIDENT">LENS</span></span> <span id="module-Inf.type-kind.constructor-DISTS"><span class="BAR">|</span> <span class="UIDENT">DISTS</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-empty_table"><span class="LIDENT">empty_table</span></span> <span class="EQUAL">=</span> <span class="LBRACKETBAR">[|</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span> <span class="COMMENT">(* len: 1, val: 0 *)</span><span class="BARRBRACKET">|]</span><span class="COMMA">,</span> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-huffman"><span class="LIDENT">huffman</span></span> <span id="local_kind_217"><span class="LIDENT">kind</span></span> <span id="local_table_218"><span class="LIDENT">table</span></span> <span id="local_off_219"><span class="LIDENT">off</span></span> <span id="local_codes_220"><span class="LIDENT">codes</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bl_count_221"><span class="LIDENT">bl_count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">16</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_222"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_codes_220"><span class="LIDENT">codes</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p_223"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <a href="#local_table_218"><span class="LIDENT">table</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_off_219"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_bl_count_221"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_p_223"><span class="LIDENT">p</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_count_221"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_p_223"><span class="LIDENT">p</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): check if we have an incomplete set for [LENS] and [DIST].
         This code is ugly, TODO! *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1437"><span class="UIDENT">Break</span></span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="TRY">try</span><span class="EOL">
</span>         <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_222"><span class="LIDENT">max</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="#local_bl_count_221"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_222"><span class="LIDENT">max</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Break</span><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_max_222"><span class="LIDENT">max</span></a><span class="EOL">
</span>         <span class="DONE">done</span><span class="EOL">
</span>       <span class="WITH">with</span> <span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_222"><span class="LIDENT">max</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">empty_table</span><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_code_224"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_left_225"><span class="LIDENT">left</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_next_code_226"><span class="LIDENT">next_code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">16</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <span class="INT">15</span> <span class="DO">do</span><span class="EOL">
</span>            <a href="#local_left_225"><span class="LIDENT">left</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_225"><span class="LIDENT">left</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_left_225"><span class="LIDENT">left</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_225"><span class="LIDENT">left</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_bl_count_221"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_225"><span class="LIDENT">left</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Invalid_huffman</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_code_224"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_224"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_bl_count_221"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_next_code_226"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_224"><span class="LIDENT">code</span></a><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_225"><span class="LIDENT">left</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="#local_kind_217"><span class="LIDENT">kind</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">CODES</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_222"><span class="LIDENT">max</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Invalid_huffman</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_ordered_227"><span class="LIDENT">ordered</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="UIDENT">None</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_max_228"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_codes_220"><span class="LIDENT">codes</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_l_229"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="#local_table_218"><span class="LIDENT">table</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_off_219"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_l_229"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_n_230"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_next_code_226"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_l_229"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                <a href="#local_next_code_226"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_l_229"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_230"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_ordered_227"><span class="LIDENT">ordered</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">push</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_ordered_227"><span class="LIDENT">ordered</span></a> <a href="#local_n_230"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><a href="#local_l_229"><span class="LIDENT">l</span></a><span class="COMMA">,</span> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>                  <a href="#local_max_228"><span class="LIDENT">max</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="IF">if</span> <a href="#local_l_229"><span class="LIDENT">l</span></a> <span class="GREATER">&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_228"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <a href="#local_l_229"><span class="LIDENT">l</span></a> <span class="ELSE">else</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_228"><span class="LIDENT">max</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="DONE">done</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">prefix</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_ordered_227"><span class="LIDENT">ordered</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_228"><span class="LIDENT">max</span></a><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_228"><span class="LIDENT">max</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.type-decoder"><span class="TYPE">type</span> <span class="LIDENT">decoder</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>      <span id="def_1476"><span class="LIDENT">src</span><span class="COLON">:</span> <span class="LIDENT">src</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1457"><span class="MUTABLE">mutable</span> <span class="LIDENT">i</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1463"><span class="MUTABLE">mutable</span> <span class="LIDENT">i_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1580"><span class="MUTABLE">mutable</span> <span class="LIDENT">i_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1584"><span class="MUTABLE">mutable</span> <span class="LIDENT">hold</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1503"><span class="MUTABLE">mutable</span> <span class="LIDENT">bits</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1603"><span class="MUTABLE">mutable</span> <span class="LIDENT">last</span><span class="COLON">:</span> <span class="LIDENT">bool</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1453"><span class="LIDENT">o</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1511"><span class="LIDENT">t</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1567"><span class="MUTABLE">mutable</span> <span class="LIDENT">t_need</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1528"><span class="MUTABLE">mutable</span> <span class="LIDENT">t_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1554"><span class="MUTABLE">mutable</span> <span class="LIDENT">o_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1484"><span class="MUTABLE">mutable</span> <span class="LIDENT">l</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="COMMENT">(* literal / length *)</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1434"><span class="MUTABLE">mutable</span> <span class="LIDENT">d</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="COMMENT">(* distance *)</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1533"><span class="MUTABLE">mutable</span> <span class="LIDENT">literal</span><span class="COLON">:</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1600"><span class="MUTABLE">mutable</span> <span class="LIDENT">distance</span><span class="COLON">:</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1599"><span class="MUTABLE">mutable</span> <span class="LIDENT">jump</span><span class="COLON">:</span> <span class="LIDENT">jump</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1486"><span class="LIDENT">w</span><span class="COLON">:</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1464"><span class="MUTABLE">mutable</span> <span class="LIDENT">s</span><span class="COLON">:</span> <span class="LIDENT">state</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1611"><span class="MUTABLE">mutable</span> <span class="LIDENT">k</span><span class="COLON">:</span> <span class="LIDENT">decoder</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">ret</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.type-state"><span class="AND">and</span> <span class="LIDENT">state</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Header"><span class="BAR">|</span> <span class="UIDENT">Header</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Table"><span class="BAR">|</span> <span class="UIDENT">Table</span> <span class="OF">of</span> <span class="LBRACE">{</span><span id="def_1520"><span class="LIDENT">hlit</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1596"><span class="LIDENT">hdist</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1581"><span class="LIDENT">hclen</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Inflate_table"><span class="BAR">|</span> <span class="UIDENT">Inflate_table</span> <span class="OF">of</span> <span class="LBRACE">{</span><span id="def_1524"><span class="LIDENT">t</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="SEMI">;</span></span> <span id="def_1606"><span class="LIDENT">l</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1572"><span class="LIDENT">r</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="SEMI">;</span></span> <span id="def_1546"><span class="LIDENT">h</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Inflate"><span class="BAR">|</span> <span class="UIDENT">Inflate</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Slow"><span class="BAR">|</span> <span class="UIDENT">Slow</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Flat_header"><span class="BAR">|</span> <span class="UIDENT">Flat_header</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Dynamic_header"><span class="BAR">|</span> <span class="UIDENT">Dynamic_header</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-Flat"><span class="BAR">|</span> <span class="UIDENT">Flat</span></span><span class="EOL">
</span>    <span id="module-Inf.type-state.constructor-End_of_inflate"><span class="BAR">|</span> <span class="UIDENT">End_of_inflate</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.type-jump"><span class="AND">and</span> <span class="LIDENT">jump</span> <span class="EQUAL">=</span> <span id="module-Inf.type-jump.constructor-Length"><span class="UIDENT">Length</span></span> <span id="module-Inf.type-jump.constructor-Extra_length"><span class="BAR">|</span> <span class="UIDENT">Extra_length</span></span> <span id="module-Inf.type-jump.constructor-Distance"><span class="BAR">|</span> <span class="UIDENT">Distance</span></span> <span id="module-Inf.type-jump.constructor-Extra_distance"><span class="BAR">|</span> <span class="UIDENT">Extra_distance</span></span> <span id="module-Inf.type-jump.constructor-Write"><span class="BAR">|</span> <span class="UIDENT">Write</span></span></span><span class="EOL">
</span>  <span id="module-Inf.type-ret"><span class="AND">and</span> <span class="LIDENT">ret</span> <span class="EQUAL">=</span> <span id="module-Inf.type-ret.constructor-Await"><span class="UIDENT">Await</span></span> <span id="module-Inf.type-ret.constructor-Flush"><span class="BAR">|</span> <span class="UIDENT">Flush</span></span> <span id="module-Inf.type-ret.constructor-End"><span class="BAR">|</span> <span class="UIDENT">End</span></span> <span id="module-Inf.type-ret.constructor-K"><span class="BAR">|</span> <span class="UIDENT">K</span></span> <span id="module-Inf.type-ret.constructor-Malformed"><span class="BAR">|</span> <span class="UIDENT">Malformed</span> <span class="OF">of</span> <span class="LIDENT">string</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-malformedf"><span class="LIDENT">malformedf</span></span> <span id="local_fmt_231"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kstrf</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_s_232"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Malformed</span> <a href="#local_s_232"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_fmt_231"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* End of input [eoi] is signalled by [d.i_pos = 0] and [d.i_len = min_int]
     which implies [i_rem d &lt; 0] is [true]. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-eoi"><span class="LIDENT">eoi</span></span> <span id="local_d_233"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_d_233"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">bigstring_empty</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_233"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_233"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-min_int"><span class="LIDENT">min_int</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-final"><span class="LIDENT">final</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">End</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* errors. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-err_unexpected_end_of_input"><span class="LIDENT">err_unexpected_end_of_input</span></span> <span id="local_d_234"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">eoi</span> <a href="#local_d_234"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_234"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">final</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">malformedf</span> <span class="STRING">&quot;Unexpected end of input&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-err_invalid_kind_of_block"><span class="LIDENT">err_invalid_kind_of_block</span></span> <span id="local_d_235"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">eoi</span> <a href="#local_d_235"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_235"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">final</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">malformedf</span> <span class="STRING">&quot;Invalid kind of block&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-err_invalid_dictionary"><span class="LIDENT">err_invalid_dictionary</span></span> <span id="local_d_236"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">eoi</span> <a href="#local_d_236"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_236"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">final</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">malformedf</span> <span class="STRING">&quot;Invalid dictionary&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-err_invalid_complement_of_length"><span class="LIDENT">err_invalid_complement_of_length</span></span> <span id="local_d_237"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">eoi</span> <a href="#local_d_237"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_237"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">final</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">malformedf</span> <span class="STRING">&quot;Invalid complement of length&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-err_invalid_distance"><span class="LIDENT">err_invalid_distance</span></span> <span id="local_d_238"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">eoi</span> <a href="#local_d_238"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_238"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">final</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">malformedf</span> <span class="STRING">&quot;Invalid distance&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-err_invalid_distance_code"><span class="LIDENT">err_invalid_distance_code</span></span> <span id="local_d_239"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">eoi</span> <a href="#local_d_239"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_239"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">final</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">malformedf</span> <span class="STRING">&quot;Invalid distance code&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* remaining bytes to read [d.i]. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-i_rem"><span class="LIDENT">i_rem</span></span> <span id="local_d_240"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_d_240"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_240"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* set [d.i] with [s]. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-src"><span class="LIDENT">src</span></span> <span id="local_d_241"><span class="LIDENT">d</span></span> <span id="local_s_242"><span class="LIDENT">s</span></span> <span id="local_j_243"><span class="LIDENT">j</span></span> <span id="local_l_244"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_j_243"><span class="LIDENT">j</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_l_244"><span class="LIDENT">l</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_j_243"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_244"><span class="LIDENT">l</span></a> <span class="GREATER">&gt;</span> <span class="LIDENT">bigstring_length</span> <a href="#local_s_242"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <span class="LIDENT">invalid_bounds</span> <a href="#local_j_243"><span class="LIDENT">j</span></a> <a href="#local_l_244"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_l_244"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">eoi</span> <a href="#local_d_241"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_d_241"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_242"><span class="LIDENT">s</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_241"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_243"><span class="LIDENT">j</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_241"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_243"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_244"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* get new input in [d.i] and [k]ontinue. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-refill"><span class="LIDENT">refill</span></span> <span id="local_k_245"><span class="LIDENT">k</span></span> <span id="local_d_246"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">src</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">eoi</span> <a href="#local_d_246"><span class="LIDENT">d</span></a> <span class="SEMI">;</span> <a href="#local_k_245"><span class="LIDENT">k</span></a> <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span id="local_ic_247"><span class="LIDENT">ic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_res_248"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <span class="LIDENT">input_bigstring</span> <a href="#local_ic_247"><span class="LIDENT">ic</span></a> <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">src</span> <a href="#local_d_246"><span class="LIDENT">d</span></a> <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <a href="#local_res_248"><span class="LIDENT">res</span></a> <span class="SEMI">;</span> <a href="#local_k_245"><span class="LIDENT">k</span></a> <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_d_246"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_k_245"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="UIDENT">Await</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* ensure to call [k] with, at least, [n] bits available. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Inf.val-c_peek_bits"><span class="LIDENT">c_peek_bits</span></span> <span id="local_n_249"><span class="LIDENT">n</span></span> <span id="local_k_250"><span class="LIDENT">k</span></span> <span id="local_d_251"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_n_249"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <a href="#local_k_250"><span class="LIDENT">k</span></a> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_rem_252"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_251"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_rem_252"><span class="LIDENT">rem</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_rem_252"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="COMMENT">(* end of input *)</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_input</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LIDENT">refill</span> <span class="LPAREN">(</span><span class="LIDENT">c_peek_bits</span> <a href="#local_n_249"><span class="LIDENT">n</span></a> <a href="#local_k_250"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <a href="#local_d_251"><span class="LIDENT">d</span></a> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_byte_253"><span class="LIDENT">byte</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_byte_253"><span class="LIDENT">byte</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_n_249"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <a href="#local_k_250"><span class="LIDENT">k</span></a> <a href="#local_d_251"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <span class="LIDENT">c_peek_bits</span> <a href="#local_n_249"><span class="LIDENT">n</span></a> <a href="#local_k_250"><span class="LIDENT">k</span></a> <a href="#local_d_251"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-t_need"><span class="LIDENT">t_need</span></span> <span id="local_d_254"><span class="LIDENT">d</span></span> <span id="local_n_255"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_d_254"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_254"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_need</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_255"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Inf.val-t_fill"><span class="LIDENT">t_fill</span></span> <span id="local_k_256"><span class="LIDENT">k</span></span> <span id="local_d_257"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_blit_258"><span class="LIDENT">blit</span></span> <span id="local_d_259"><span class="LIDENT">d</span></span> <span id="local_len_260"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_blit</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <a href="#local_len_260"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_260"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_259"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_260"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rem_261"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_257"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rem_261"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_k_256"><span class="LIDENT">k</span></a> <a href="#local_d_257"><span class="LIDENT">d</span></a> <span class="COMMENT">(* TODO *)</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_need_262"><span class="LIDENT">need</span></span> <span class="EQUAL">=</span> <a href="#local_d_257"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_need</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_257"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_rem_261"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <a href="#local_need_262"><span class="LIDENT">need</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_blit_258"><span class="LIDENT">blit</span></a> <a href="#local_d_257"><span class="LIDENT">d</span></a> <a href="#local_rem_261"><span class="LIDENT">rem</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">refill</span> <span class="LPAREN">(</span><span class="LIDENT">t_fill</span> <a href="#local_k_256"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <a href="#local_d_257"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_blit_258"><span class="LIDENT">blit</span></a> <a href="#local_d_257"><span class="LIDENT">d</span></a> <a href="#local_need_262"><span class="LIDENT">need</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_257"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_need</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_k_256"><span class="LIDENT">k</span></a> <a href="#local_d_257"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-reverse_bits"><span class="LIDENT">reverse_bits</span></span> <span id="local_bits_263"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t_264"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LBRACKETBAR">[|</span><span class="EOL">
</span>         <span class="INT">0x00</span><span class="SEMI">;</span> <span class="INT">0x80</span><span class="SEMI">;</span> <span class="INT">0x40</span><span class="SEMI">;</span> <span class="INT">0xC0</span><span class="SEMI">;</span> <span class="INT">0x20</span><span class="SEMI">;</span> <span class="INT">0xA0</span><span class="SEMI">;</span> <span class="INT">0x60</span><span class="SEMI">;</span> <span class="INT">0xE0</span><span class="SEMI">;</span> <span class="INT">0x10</span><span class="SEMI">;</span> <span class="INT">0x90</span><span class="SEMI">;</span> <span class="INT">0x50</span><span class="SEMI">;</span> <span class="INT">0xD0</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x30</span><span class="SEMI">;</span> <span class="INT">0xB0</span><span class="SEMI">;</span> <span class="INT">0x70</span><span class="SEMI">;</span> <span class="INT">0xF0</span><span class="SEMI">;</span> <span class="INT">0x08</span><span class="SEMI">;</span> <span class="INT">0x88</span><span class="SEMI">;</span> <span class="INT">0x48</span><span class="SEMI">;</span> <span class="INT">0xC8</span><span class="SEMI">;</span> <span class="INT">0x28</span><span class="SEMI">;</span> <span class="INT">0xA8</span><span class="SEMI">;</span> <span class="INT">0x68</span><span class="SEMI">;</span> <span class="INT">0xE8</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x18</span><span class="SEMI">;</span> <span class="INT">0x98</span><span class="SEMI">;</span> <span class="INT">0x58</span><span class="SEMI">;</span> <span class="INT">0xD8</span><span class="SEMI">;</span> <span class="INT">0x38</span><span class="SEMI">;</span> <span class="INT">0xB8</span><span class="SEMI">;</span> <span class="INT">0x78</span><span class="SEMI">;</span> <span class="INT">0xF8</span><span class="SEMI">;</span> <span class="INT">0x04</span><span class="SEMI">;</span> <span class="INT">0x84</span><span class="SEMI">;</span> <span class="INT">0x44</span><span class="SEMI">;</span> <span class="INT">0xC4</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x24</span><span class="SEMI">;</span> <span class="INT">0xA4</span><span class="SEMI">;</span> <span class="INT">0x64</span><span class="SEMI">;</span> <span class="INT">0xE4</span><span class="SEMI">;</span> <span class="INT">0x14</span><span class="SEMI">;</span> <span class="INT">0x94</span><span class="SEMI">;</span> <span class="INT">0x54</span><span class="SEMI">;</span> <span class="INT">0xD4</span><span class="SEMI">;</span> <span class="INT">0x34</span><span class="SEMI">;</span> <span class="INT">0xB4</span><span class="SEMI">;</span> <span class="INT">0x74</span><span class="SEMI">;</span> <span class="INT">0xF4</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x0C</span><span class="SEMI">;</span> <span class="INT">0x8C</span><span class="SEMI">;</span> <span class="INT">0x4C</span><span class="SEMI">;</span> <span class="INT">0xCC</span><span class="SEMI">;</span> <span class="INT">0x2C</span><span class="SEMI">;</span> <span class="INT">0xAC</span><span class="SEMI">;</span> <span class="INT">0x6C</span><span class="SEMI">;</span> <span class="INT">0xEC</span><span class="SEMI">;</span> <span class="INT">0x1C</span><span class="SEMI">;</span> <span class="INT">0x9C</span><span class="SEMI">;</span> <span class="INT">0x5C</span><span class="SEMI">;</span> <span class="INT">0xDC</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x3C</span><span class="SEMI">;</span> <span class="INT">0xBC</span><span class="SEMI">;</span> <span class="INT">0x7C</span><span class="SEMI">;</span> <span class="INT">0xFC</span><span class="SEMI">;</span> <span class="INT">0x02</span><span class="SEMI">;</span> <span class="INT">0x82</span><span class="SEMI">;</span> <span class="INT">0x42</span><span class="SEMI">;</span> <span class="INT">0xC2</span><span class="SEMI">;</span> <span class="INT">0x22</span><span class="SEMI">;</span> <span class="INT">0xA2</span><span class="SEMI">;</span> <span class="INT">0x62</span><span class="SEMI">;</span> <span class="INT">0xE2</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x12</span><span class="SEMI">;</span> <span class="INT">0x92</span><span class="SEMI">;</span> <span class="INT">0x52</span><span class="SEMI">;</span> <span class="INT">0xD2</span><span class="SEMI">;</span> <span class="INT">0x32</span><span class="SEMI">;</span> <span class="INT">0xB2</span><span class="SEMI">;</span> <span class="INT">0x72</span><span class="SEMI">;</span> <span class="INT">0xF2</span><span class="SEMI">;</span> <span class="INT">0x0A</span><span class="SEMI">;</span> <span class="INT">0x8A</span><span class="SEMI">;</span> <span class="INT">0x4A</span><span class="SEMI">;</span> <span class="INT">0xCA</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x2A</span><span class="SEMI">;</span> <span class="INT">0xAA</span><span class="SEMI">;</span> <span class="INT">0x6A</span><span class="SEMI">;</span> <span class="INT">0xEA</span><span class="SEMI">;</span> <span class="INT">0x1A</span><span class="SEMI">;</span> <span class="INT">0x9A</span><span class="SEMI">;</span> <span class="INT">0x5A</span><span class="SEMI">;</span> <span class="INT">0xDA</span><span class="SEMI">;</span> <span class="INT">0x3A</span><span class="SEMI">;</span> <span class="INT">0xBA</span><span class="SEMI">;</span> <span class="INT">0x7A</span><span class="SEMI">;</span> <span class="INT">0xFA</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x06</span><span class="SEMI">;</span> <span class="INT">0x86</span><span class="SEMI">;</span> <span class="INT">0x46</span><span class="SEMI">;</span> <span class="INT">0xC6</span><span class="SEMI">;</span> <span class="INT">0x26</span><span class="SEMI">;</span> <span class="INT">0xA6</span><span class="SEMI">;</span> <span class="INT">0x66</span><span class="SEMI">;</span> <span class="INT">0xE6</span><span class="SEMI">;</span> <span class="INT">0x16</span><span class="SEMI">;</span> <span class="INT">0x96</span><span class="SEMI">;</span> <span class="INT">0x56</span><span class="SEMI">;</span> <span class="INT">0xD6</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x36</span><span class="SEMI">;</span> <span class="INT">0xB6</span><span class="SEMI">;</span> <span class="INT">0x76</span><span class="SEMI">;</span> <span class="INT">0xF6</span><span class="SEMI">;</span> <span class="INT">0x0E</span><span class="SEMI">;</span> <span class="INT">0x8E</span><span class="SEMI">;</span> <span class="INT">0x4E</span><span class="SEMI">;</span> <span class="INT">0xCE</span><span class="SEMI">;</span> <span class="INT">0x2E</span><span class="SEMI">;</span> <span class="INT">0xAE</span><span class="SEMI">;</span> <span class="INT">0x6E</span><span class="SEMI">;</span> <span class="INT">0xEE</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x1E</span><span class="SEMI">;</span> <span class="INT">0x9E</span><span class="SEMI">;</span> <span class="INT">0x5E</span><span class="SEMI">;</span> <span class="INT">0xDE</span><span class="SEMI">;</span> <span class="INT">0x3E</span><span class="SEMI">;</span> <span class="INT">0xBE</span><span class="SEMI">;</span> <span class="INT">0x7E</span><span class="SEMI">;</span> <span class="INT">0xFE</span><span class="SEMI">;</span> <span class="INT">0x01</span><span class="SEMI">;</span> <span class="INT">0x81</span><span class="SEMI">;</span> <span class="INT">0x41</span><span class="SEMI">;</span> <span class="INT">0xC1</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x21</span><span class="SEMI">;</span> <span class="INT">0xA1</span><span class="SEMI">;</span> <span class="INT">0x61</span><span class="SEMI">;</span> <span class="INT">0xE1</span><span class="SEMI">;</span> <span class="INT">0x11</span><span class="SEMI">;</span> <span class="INT">0x91</span><span class="SEMI">;</span> <span class="INT">0x51</span><span class="SEMI">;</span> <span class="INT">0xD1</span><span class="SEMI">;</span> <span class="INT">0x31</span><span class="SEMI">;</span> <span class="INT">0xB1</span><span class="SEMI">;</span> <span class="INT">0x71</span><span class="SEMI">;</span> <span class="INT">0xF1</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x09</span><span class="SEMI">;</span> <span class="INT">0x89</span><span class="SEMI">;</span> <span class="INT">0x49</span><span class="SEMI">;</span> <span class="INT">0xC9</span><span class="SEMI">;</span> <span class="INT">0x29</span><span class="SEMI">;</span> <span class="INT">0xA9</span><span class="SEMI">;</span> <span class="INT">0x69</span><span class="SEMI">;</span> <span class="INT">0xE9</span><span class="SEMI">;</span> <span class="INT">0x19</span><span class="SEMI">;</span> <span class="INT">0x99</span><span class="SEMI">;</span> <span class="INT">0x59</span><span class="SEMI">;</span> <span class="INT">0xD9</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x39</span><span class="SEMI">;</span> <span class="INT">0xB9</span><span class="SEMI">;</span> <span class="INT">0x79</span><span class="SEMI">;</span> <span class="INT">0xF9</span><span class="SEMI">;</span> <span class="INT">0x05</span><span class="SEMI">;</span> <span class="INT">0x85</span><span class="SEMI">;</span> <span class="INT">0x45</span><span class="SEMI">;</span> <span class="INT">0xC5</span><span class="SEMI">;</span> <span class="INT">0x25</span><span class="SEMI">;</span> <span class="INT">0xA5</span><span class="SEMI">;</span> <span class="INT">0x65</span><span class="SEMI">;</span> <span class="INT">0xE5</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x15</span><span class="SEMI">;</span> <span class="INT">0x95</span><span class="SEMI">;</span> <span class="INT">0x55</span><span class="SEMI">;</span> <span class="INT">0xD5</span><span class="SEMI">;</span> <span class="INT">0x35</span><span class="SEMI">;</span> <span class="INT">0xB5</span><span class="SEMI">;</span> <span class="INT">0x75</span><span class="SEMI">;</span> <span class="INT">0xF5</span><span class="SEMI">;</span> <span class="INT">0x0D</span><span class="SEMI">;</span> <span class="INT">0x8D</span><span class="SEMI">;</span> <span class="INT">0x4D</span><span class="SEMI">;</span> <span class="INT">0xCD</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x2D</span><span class="SEMI">;</span> <span class="INT">0xAD</span><span class="SEMI">;</span> <span class="INT">0x6D</span><span class="SEMI">;</span> <span class="INT">0xED</span><span class="SEMI">;</span> <span class="INT">0x1D</span><span class="SEMI">;</span> <span class="INT">0x9D</span><span class="SEMI">;</span> <span class="INT">0x5D</span><span class="SEMI">;</span> <span class="INT">0xDD</span><span class="SEMI">;</span> <span class="INT">0x3D</span><span class="SEMI">;</span> <span class="INT">0xBD</span><span class="SEMI">;</span> <span class="INT">0x7D</span><span class="SEMI">;</span> <span class="INT">0xFD</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x03</span><span class="SEMI">;</span> <span class="INT">0x83</span><span class="SEMI">;</span> <span class="INT">0x43</span><span class="SEMI">;</span> <span class="INT">0xC3</span><span class="SEMI">;</span> <span class="INT">0x23</span><span class="SEMI">;</span> <span class="INT">0xA3</span><span class="SEMI">;</span> <span class="INT">0x63</span><span class="SEMI">;</span> <span class="INT">0xE3</span><span class="SEMI">;</span> <span class="INT">0x13</span><span class="SEMI">;</span> <span class="INT">0x93</span><span class="SEMI">;</span> <span class="INT">0x53</span><span class="SEMI">;</span> <span class="INT">0xD3</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x33</span><span class="SEMI">;</span> <span class="INT">0xB3</span><span class="SEMI">;</span> <span class="INT">0x73</span><span class="SEMI">;</span> <span class="INT">0xF3</span><span class="SEMI">;</span> <span class="INT">0x0B</span><span class="SEMI">;</span> <span class="INT">0x8B</span><span class="SEMI">;</span> <span class="INT">0x4B</span><span class="SEMI">;</span> <span class="INT">0xCB</span><span class="SEMI">;</span> <span class="INT">0x2B</span><span class="SEMI">;</span> <span class="INT">0xAB</span><span class="SEMI">;</span> <span class="INT">0x6B</span><span class="SEMI">;</span> <span class="INT">0xEB</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x1B</span><span class="SEMI">;</span> <span class="INT">0x9B</span><span class="SEMI">;</span> <span class="INT">0x5B</span><span class="SEMI">;</span> <span class="INT">0xDB</span><span class="SEMI">;</span> <span class="INT">0x3B</span><span class="SEMI">;</span> <span class="INT">0xBB</span><span class="SEMI">;</span> <span class="INT">0x7B</span><span class="SEMI">;</span> <span class="INT">0xFB</span><span class="SEMI">;</span> <span class="INT">0x07</span><span class="SEMI">;</span> <span class="INT">0x87</span><span class="SEMI">;</span> <span class="INT">0x47</span><span class="SEMI">;</span> <span class="INT">0xC7</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x27</span><span class="SEMI">;</span> <span class="INT">0xA7</span><span class="SEMI">;</span> <span class="INT">0x67</span><span class="SEMI">;</span> <span class="INT">0xE7</span><span class="SEMI">;</span> <span class="INT">0x17</span><span class="SEMI">;</span> <span class="INT">0x97</span><span class="SEMI">;</span> <span class="INT">0x57</span><span class="SEMI">;</span> <span class="INT">0xD7</span><span class="SEMI">;</span> <span class="INT">0x37</span><span class="SEMI">;</span> <span class="INT">0xB7</span><span class="SEMI">;</span> <span class="INT">0x77</span><span class="SEMI">;</span> <span class="INT">0xF7</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x0F</span><span class="SEMI">;</span> <span class="INT">0x8F</span><span class="SEMI">;</span> <span class="INT">0x4F</span><span class="SEMI">;</span> <span class="INT">0xCF</span><span class="SEMI">;</span> <span class="INT">0x2F</span><span class="SEMI">;</span> <span class="INT">0xAF</span><span class="SEMI">;</span> <span class="INT">0x6F</span><span class="SEMI">;</span> <span class="INT">0xEF</span><span class="SEMI">;</span> <span class="INT">0x1F</span><span class="SEMI">;</span> <span class="INT">0x9F</span><span class="SEMI">;</span> <span class="INT">0x5F</span><span class="SEMI">;</span> <span class="INT">0xDF</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="INT">0x3F</span><span class="SEMI">;</span> <span class="INT">0xBF</span><span class="SEMI">;</span> <span class="INT">0x7F</span><span class="SEMI">;</span> <span class="INT">0xFF</span><span class="EOL">
</span>      <span class="BARRBRACKET">|]</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_t_264"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_bits_263"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_1545"><span id="module-Inf.val-fixed_lit"><span class="LIDENT">fixed_lit</span></span><span class="COMMA">,</span> <span id="module-Inf.val-fixed_dist"><span class="LIDENT">fixed_dist</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tbl_lit_265"><span class="LIDENT">tbl_lit</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-init"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">init</span></a> <span class="INT">288</span> <span class="INFIXOP1">@@</span> <span class="FUN">fun</span> <span id="local_n_266"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_n_266"><span class="LIDENT">n</span></a> <span class="LESS">&lt;</span> <span class="INT">144</span> <span class="THEN">then</span> <span class="INT">8</span> <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_n_266"><span class="LIDENT">n</span></a> <span class="LESS">&lt;</span> <span class="INT">256</span> <span class="THEN">then</span> <span class="INT">9</span> <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_n_266"><span class="LIDENT">n</span></a> <span class="LESS">&lt;</span> <span class="INT">280</span> <span class="THEN">then</span> <span class="INT">7</span> <span class="ELSE">else</span> <span class="INT">8</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tbl_dist_267"><span class="LIDENT">tbl_dist</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_res_268"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">5</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-iteri"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">iteri</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_269"><span class="LIDENT">i</span></span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_res_268"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_269"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LIDENT">reverse_bits</span> <span class="LPAREN">(</span><a href="#local_i_269"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_res_268"><span class="LIDENT">res</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_res_268"><span class="LIDENT">res</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1594"><span id="local_tbl_lit_270"><span class="LIDENT">tbl_lit</span></span><span class="COMMA">,</span> <span id="local_max_lit_271"><span class="LIDENT">max_lit</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">LENS</span> <a href="#local_tbl_lit_265"><span class="LIDENT">tbl_lit</span></a> <span class="INT">0</span> <span class="INT">288</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_tbl_lit_270"><span class="LIDENT">tbl_lit</span></a> <a href="#local_max_lit_271"><span class="LIDENT">max_lit</span></a><span class="COMMA">,</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_tbl_dist_267"><span class="LIDENT">tbl_dist</span></a> <span class="INT">5</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-checksum"><span class="LIDENT">checksum</span></span> <span id="local_d_272"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">checksum</span> <a href="#local_d_272"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Inf.val-flat"><span class="LIDENT">flat</span></span> <span id="local_d_273"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_274"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <span class="LPAREN">(</span><span class="LIDENT">min</span> <span class="LPAREN">(</span><span class="LIDENT">i_rem</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_len_274"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_274"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_274"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_274"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">End_of_inflate</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Header</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <span class="LIDENT">i_rem</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="COMMA">,</span> <span class="LIDENT">bigstring_length</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">src</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LIDENT">eoi</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">err_unexpected_end_of_input</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span id="local_ic_275"><span class="LIDENT">ic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_276"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">input_bigstring</span> <a href="#local_ic_275"><span class="LIDENT">ic</span></a> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">src</span> <a href="#local_d_273"><span class="LIDENT">d</span></a> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <a href="#local_len_276"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <span class="LIDENT">flat</span> <a href="#local_d_273"><span class="LIDENT">d</span></a><span class="EOL">
</span>            <span class="COMMENT">(* XXX(dinosaure): check this branch. TODO! *)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Await</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Flush</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-flat_header"><span class="LIDENT">flat_header</span></span> <span id="local_d_277"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_278"><span class="LIDENT">k</span></span> <span id="local_d_279"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_t_pos_280"><span class="LIDENT">t_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_hold_281"><span class="LIDENT">hold</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_bits_282"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len_283"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="AND">and</span> <span id="local_nlen_284"><span class="LIDENT">nlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0xffff</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_consume_285"><span class="LIDENT">consume</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a> <span class="LESS">&lt;</span> <span class="INT">8</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_t_pos_280"><span class="LIDENT">t_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_t_pos_280"><span class="LIDENT">t_pos</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <a href="#local_consume_285"><span class="LIDENT">consume</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_len_283"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_consume_285"><span class="LIDENT">consume</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_len_283"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">8</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_283"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_consume_285"><span class="LIDENT">consume</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_nlen_284"><span class="LIDENT">nlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_consume_285"><span class="LIDENT">consume</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_nlen_284"><span class="LIDENT">nlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">8</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nlen_284"><span class="LIDENT">nlen</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_281"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_282"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nlen_284"><span class="LIDENT">nlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0xffff</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_283"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <span class="LIDENT">err_invalid_complement_of_length</span> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_283"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Flat</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">flat</span> <a href="#local_d_279"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_d_277"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_277"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LPAREN">(</span><a href="#local_d_277"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">7</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="COMMENT">(* XXX(cfcs): diff between [d.bits] and [d.bits round down to nearest multiple of 8]. *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_truncated_bits_286"><span class="LIDENT">truncated_bits</span></span> <span class="EQUAL">=</span> <a href="#local_d_277"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <span class="INT">7</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="COMMENT">(* XXX(cfcs): round down to nearest multiple of 8, logical equivalents:
         d.bits land (lnot (8 - 1))
         d.bits land (lnot 7)

         For some reason saving this variable locally instead of accessing [d.bits] twice
         shaves off one instruction when compiling with [flambda]. *)</span><span class="EOL">
</span>      <a href="#local_d_277"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_truncated_bits_286"><span class="LIDENT">truncated_bits</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_required_287"><span class="LIDENT">required</span></span> <span class="EQUAL">=</span> <span class="INT">4</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_truncated_bits_286"><span class="LIDENT">truncated_bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_277"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Flat_header</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">t_need</span> <a href="#local_d_277"><span class="LIDENT">d</span></a> <a href="#local_required_287"><span class="LIDENT">required</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">t_fill</span> <a href="#local_k_278"><span class="LIDENT">k</span></a> <a href="#local_d_277"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Inf.val-c_put_byte"><span class="LIDENT">c_put_byte</span></span> <span id="local_byte_288"><span class="LIDENT">byte</span></span> <span id="local_k_289"><span class="LIDENT">k</span></span> <span id="local_d_290"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESS">&lt;</span> <span class="LIDENT">bigstring_length</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_byte_288"><span class="LIDENT">byte</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_byte_288"><span class="LIDENT">byte</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_289"><span class="LIDENT">k</span></a> <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_d_290"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">c_put_byte</span> <a href="#local_byte_288"><span class="LIDENT">byte</span></a> <a href="#local_k_289"><span class="LIDENT">k</span></a> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="UIDENT">Flush</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-slow_inflate"><span class="LIDENT">slow_inflate</span></span> <span id="local_lit_291"><span class="LIDENT">lit</span></span> <span id="local_dist_292"><span class="LIDENT">dist</span></span> <span id="local_jump_293"><span class="LIDENT">jump</span></span> <span id="local_d_294"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></span> <span id="local_n_296"><span class="LIDENT">n</span></span> <span id="local_k_297"><span class="LIDENT">k</span></span> <span id="local_d_298"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_n_296"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <a href="#local_k_297"><span class="LIDENT">k</span></a> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_rem_299"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_298"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_rem_299"><span class="LIDENT">rem</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_rem_299"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="COMMENT">(* end of input *)</span> <span class="THEN">then</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_is_end_of_block_300"><span class="LIDENT">is_end_of_block</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_is_end_of_block_300"><span class="LIDENT">is_end_of_block</span></a> <span class="THEN">then</span> <a href="#local_k_297"><span class="LIDENT">k</span></a> <a href="#local_d_298"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <span class="LIDENT">err_unexpected_end_of_input</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LIDENT">refill</span> <span class="LPAREN">(</span><a href="#local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></a> <a href="#local_n_296"><span class="LIDENT">n</span></a> <a href="#local_k_297"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <a href="#local_d_298"><span class="LIDENT">d</span></a> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_byte_301"><span class="LIDENT">byte</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_byte_301"><span class="LIDENT">byte</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_298"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_n_296"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">i_rem</span> <a href="#local_d_298"><span class="LIDENT">d</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_k_297"><span class="LIDENT">k</span></a> <a href="#local_d_298"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <a href="#local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></a> <a href="#local_n_296"><span class="LIDENT">n</span></a> <a href="#local_k_297"><span class="LIDENT">k</span></a> <a href="#local_d_298"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_jump_293"><span class="LIDENT">jump</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Length</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_302"><span class="LIDENT">k</span></span> <span id="local_d_303"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_value_304"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_305"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_305"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_305"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_value_304"><span class="LIDENT">value</span></a> <span class="LESS">&lt;</span> <span class="INT">256</span> <span class="THEN">then</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_k_306"><span class="LIDENT">k</span></span> <span id="local_d_307"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_d_307"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>                <span class="UIDENT">K</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">c_put_byte</span> <a href="#local_value_304"><span class="LIDENT">value</span></a> <a href="#local_k_306"><span class="LIDENT">k</span></a> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_value_304"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span> <span class="THEN">then</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">End_of_inflate</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="EOL">
</span>                <span class="COMMENT">(* XXX(dinosaure): [K] is needed here to save remaining byte(s) correctly
                   in [End_of_inflate] state. *)</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Header</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_value_304"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">257</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Extra_length</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_303"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="COMMENT">(* XXX(dinosaure): this is necessary where [EOB] is not necessary the
         longest code. So we can occur the case where we are at the end of the
         input and have the [EOB] code, but not enough to have [lit.Lookup.l]
         bits:

         - previously, we just ask more input
         - now, we check if [d.hold] is [EOB]: assumption, codes are prefix free
           AND we reach end of input.

         TODO: optimize this branch! *)</span><span class="EOL">
</span>      <a href="#local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></a> <a href="#local_lit_291"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">l</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Extra_length</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len_308"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_lbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_309"><span class="LIDENT">k</span></span> <span id="local_d_310"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_extra_311"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_len_308"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_308"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_308"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_base_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_311"><span class="LIDENT">extra</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Distance</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_310"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>          <span class="UIDENT">K</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></a> <a href="#local_len_308"><span class="LIDENT">len</span></a> <a href="#local_k_309"><span class="LIDENT">k</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Distance</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_312"><span class="LIDENT">k</span></span> <span id="local_d_313"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_value_314"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span> <a href="#local_dist_292"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_dist_292"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_315"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_dist_292"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_dist_292"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_315"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_315"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_value_314"><span class="LIDENT">value</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Extra_distance</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_313"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>          <span class="UIDENT">K</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></a> <a href="#local_dist_292"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">l</span> <a href="#local_k_312"><span class="LIDENT">k</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Extra_distance</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len_316"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_317"><span class="LIDENT">k</span></span> <span id="local_d_318"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_extra_319"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_len_316"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_316"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_316"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_base_dist</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_319"><span class="LIDENT">extra</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Write</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_318"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>          <span class="UIDENT">K</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_c_peek_bits_295"><span class="LIDENT">c_peek_bits</span></a> <a href="#local_len_316"><span class="LIDENT">len</span></a> <a href="#local_k_317"><span class="LIDENT">k</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Write</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">err_invalid_distance_code</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="GREATER">&gt;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">have</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="THEN">then</span> <span class="LIDENT">err_invalid_distance</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_320"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_off_321"><span class="LIDENT">off</span></span> <span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="LPAREN">(</span><a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_pre_322"><span class="LIDENT">pre</span></span> <span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_off_321"><span class="LIDENT">off</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_rst_323"><span class="LIDENT">rst</span></span> <span class="EQUAL">=</span> <a href="#local_len_320"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pre_322"><span class="LIDENT">pre</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_rst_323"><span class="LIDENT">rst</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_off_321"><span class="LIDENT">off</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_pre_322"><span class="LIDENT">pre</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="INT">0</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LPAREN">(</span><a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_pre_322"><span class="LIDENT">pre</span></a><span class="RPAREN">)</span> <a href="#local_rst_323"><span class="LIDENT">rst</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_off_321"><span class="LIDENT">off</span></a> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_len_320"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_320"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_320"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Length</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_320"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_294"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">Flush</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-inflate"><span class="LIDENT">inflate</span></span> <span id="local_lit_324"><span class="LIDENT">lit</span></span> <span id="local_dist_325"><span class="LIDENT">dist</span></span> <span id="local_jump_326"><span class="LIDENT">jump</span></span> <span id="local_d_327"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1519"><span class="UIDENT">End</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1563"><span class="UIDENT">Invalid_distance</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1454"><span class="UIDENT">Invalid_distance_code</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hold_328"><span class="LIDENT">hold</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">of_int</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bits_329"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_jump_330"><span class="LIDENT">jump</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_jump_326"><span class="LIDENT">jump</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_pos_331"><span class="LIDENT">i_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_o_pos_332"><span class="LIDENT">o_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_lit_mask_333"><span class="LIDENT">lit_mask</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">of_int</span></a> <a href="#local_lit_324"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dist_mask_334"><span class="LIDENT">dist_mask</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">of_int</span></a> <a href="#local_dist_325"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* XXX(dinosaure): 2 jumps were done in this hot-loop:
       1- [while],
       2- [match .. with]).

       A [let rec length = .. and extra_length = ..] can be optimized by
       [flambda]. We should replace [match .. with] by this design. TODO. *)</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <span class="LESS">&lt;</span> <span class="LIDENT">bigstring_length</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_jump_330"><span class="LIDENT">jump</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Length</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <span class="LESS">&lt;</span> <a href="#local_lit_324"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">l</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                    <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_value_335"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_lit_324"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_lit_mask_333"><span class="LIDENT">lit_mask</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_336"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_lit_324"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_lit_mask_333"><span class="LIDENT">lit_mask</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span><span class="EOL">
</span>            <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_right_logical"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">shift_right_logical</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_len_336"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_336"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_value_335"><span class="LIDENT">value</span></a> <span class="LESS">&lt;</span> <span class="INT">256</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="#local_value_335"><span class="LIDENT">value</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_value_335"><span class="LIDENT">value</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <span class="COMMENT">(* ; jump := Length *)</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_value_335"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">End</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_jump_330"><span class="LIDENT">jump</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Extra_length</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_value_335"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">257</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Extra_length</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_len_337"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_lbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <span class="LESS">&lt;</span> <a href="#local_len_337"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_extra_338"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-sub"><span class="LIDENT">sub</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="INT">1n</span> <a href="#local_len_337"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="INT">1n</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_right_logical"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">shift_right_logical</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_len_337"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_337"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_base_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_338"><span class="LIDENT">extra</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_jump_330"><span class="LIDENT">jump</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Distance</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Distance</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <span class="LESS">&lt;</span> <a href="#local_dist_325"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">l</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                    <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_value_339"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_dist_325"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_dist_mask_334"><span class="LIDENT">dist_mask</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_340"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_dist_325"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_dist_mask_334"><span class="LIDENT">dist_mask</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span><span class="EOL">
</span>            <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_right_logical"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">shift_right_logical</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_len_340"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_340"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_value_339"><span class="LIDENT">value</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_jump_330"><span class="LIDENT">jump</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Extra_distance</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Extra_distance</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_len_341"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <span class="LESS">&lt;</span> <a href="#local_len_341"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logor"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">logor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="EOL">
</span>                    <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_int"><span class="LIDENT">of_int</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_extra_342"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html"><span class="UIDENT">Nativeint</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-sub"><span class="LIDENT">sub</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <span class="INT">1n</span> <a href="#local_len_341"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="INT">1n</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-shift_right_logical"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">shift_right_logical</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a> <a href="#local_len_341"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_341"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_base_dist</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_342"><span class="LIDENT">extra</span></a><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_jump_330"><span class="LIDENT">jump</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Write</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Write</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Invalid_distance_code</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="GREATER">&gt;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">have</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Invalid_distance</span><span class="EOL">
</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="COMMENT">(* if d.d &gt; WInf.have d.w then raise Invalid_distance ;
               XXX(dinosaure): [WInf.have] does not tell me the truth where
               we need a read cursor in [WInf.t] for that. *)</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_343"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_off_344"><span class="LIDENT">off</span></span> <span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="LPAREN">(</span><a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">1</span> <span class="THEN">then</span><span class="EOL">
</span>             <span class="LET">let</span> <span id="local_v_345"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_off_344"><span class="LIDENT">off</span></a> <span class="IN">in</span><span class="EOL">
</span>             <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">fill</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_v_345"><span class="LIDENT">v</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="#local_len_343"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="ELSE">else</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_off_346"><span class="LIDENT">off</span></span> <span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="LPAREN">(</span><a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_pre_347"><span class="LIDENT">pre</span></span> <span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_off_346"><span class="LIDENT">off</span></a> <span class="IN">in</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_rst_348"><span class="LIDENT">rst</span></span> <span class="EQUAL">=</span> <a href="#local_len_343"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pre_347"><span class="LIDENT">pre</span></a> <span class="IN">in</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_rst_348"><span class="LIDENT">rst</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_off_346"><span class="LIDENT">off</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="#local_pre_347"><span class="LIDENT">pre</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <span class="INT">0</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_pre_347"><span class="LIDENT">pre</span></a><span class="RPAREN">)</span> <a href="#local_rst_348"><span class="LIDENT">rst</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">blit</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">raw</span> <a href="#local_off_346"><span class="LIDENT">off</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="#local_len_343"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_343"><span class="LIDENT">len</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_343"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_jump_330"><span class="LIDENT">jump</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Length</span> <span class="ELSE">else</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_343"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">to_int</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_jump_330"><span class="LIDENT">jump</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">slow_inflate</span> <a href="#local_lit_324"><span class="LIDENT">lit</span></a> <a href="#local_dist_325"><span class="LIDENT">dist</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_jump_330"><span class="LIDENT">jump</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>        <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Slow</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">i_rem</span> <a href="#local_d_327"><span class="LIDENT">d</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="IF">if</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="LIDENT">bigstring_length</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="THEN">then</span> <span class="UIDENT">Flush</span> <span class="ELSE">else</span> <span class="UIDENT">K</span><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">src</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">eoi</span> <a href="#local_d_327"><span class="LIDENT">d</span></a> <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="EOL">
</span>          <span class="COMMENT">(* XXX(dinosaure): [K] is required here mostly because the semantic
             of the hot-loop. If we reach end of input, we may have some
             trailing bits in [d.hold] and we need to process them.

             [slow_inflate] is more precise (but... slow) and will consume
             them to reach [End_of_inflate] then correctly. *)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span id="local_ic_349"><span class="LIDENT">ic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_350"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">input_bigstring</span> <a href="#local_ic_349"><span class="LIDENT">ic</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">src</span> <a href="#local_d_327"><span class="LIDENT">d</span></a> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <a href="#local_len_350"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="EOL">
</span>            <span class="COMMENT">(* XXX(dinosaure): should work fine! But it
               needs check. *)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">K</span><span class="EOL">
</span>    <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_int"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">to_int</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_328"><span class="LIDENT">hold</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_329"><span class="LIDENT">bits</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_pos_331"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_332"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">End_of_inflate</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="EOL">
</span>            <span class="COMMENT">(* XXX(dinosaure): [K] is needed here to save remaining byte(s) correctly
               in [End_of_inflate] state. *)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Header</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="UIDENT">K</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Invalid_distance</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_distance</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Invalid_distance_code</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_distance_code</span> <a href="#local_d_327"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-fixed"><span class="LIDENT">fixed</span></span> <span id="local_d_351"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1462"><span id="local_lit_352"><span class="LIDENT">lit</span></span><span class="COMMA">,</span> <span id="local_dist_353"><span class="LIDENT">dist</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fixed_lit</span><span class="COMMA">,</span> <span class="LIDENT">fixed_dist</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_d_351"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">literal</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_lit_352"><span class="LIDENT">lit</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_351"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">distance</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_dist_353"><span class="LIDENT">dist</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_351"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Length</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_351"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>      <span class="LIDENT">inflate</span> <a href="#local_lit_352"><span class="LIDENT">lit</span></a> <a href="#local_dist_353"><span class="LIDENT">dist</span></a> <span class="UIDENT">Length</span> <a href="#local_d_351"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* XXX(dinosaure): [huffman] can raise an exception. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-make_table"><span class="LIDENT">make_table</span></span> <span id="local_t_354"><span class="LIDENT">t</span></span> <span id="local_hlit_355"><span class="LIDENT">hlit</span></span> <span id="local_hdist_356"><span class="LIDENT">hdist</span></span> <span id="local_d_357"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_t_354"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Invalid_huffman</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): an huffman tree MUST have at least an End-Of-Block
           symbol. *)</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1555"><span id="local_t_lit_358"><span class="LIDENT">t_lit</span></span><span class="COMMA">,</span> <span id="local_l_lit_359"><span class="LIDENT">l_lit</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">LENS</span> <a href="#local_t_354"><span class="LIDENT">t</span></a> <span class="INT">0</span> <a href="#local_hlit_355"><span class="LIDENT">hlit</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1458"><span id="local_t_dist_360"><span class="LIDENT">t_dist</span></span><span class="COMMA">,</span> <span id="local_l_dist_361"><span class="LIDENT">l_dist</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">DISTS</span> <a href="#local_t_354"><span class="LIDENT">t</span></a> <a href="#local_hlit_355"><span class="LIDENT">hlit</span></a> <a href="#local_hdist_356"><span class="LIDENT">hdist</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_lit_362"><span class="LIDENT">lit</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_t_lit_358"><span class="LIDENT">t_lit</span></a> <a href="#local_l_lit_359"><span class="LIDENT">l_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_dist_363"><span class="LIDENT">dist</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_t_dist_360"><span class="LIDENT">t_dist</span></a> <a href="#local_l_dist_361"><span class="LIDENT">l_dist</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <a href="#local_d_357"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">literal</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_lit_362"><span class="LIDENT">lit</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_357"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">distance</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_dist_363"><span class="LIDENT">dist</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_357"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Length</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_357"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Inflate</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>          <span class="LIDENT">inflate</span> <a href="#local_lit_362"><span class="LIDENT">lit</span></a> <a href="#local_dist_363"><span class="LIDENT">dist</span></a> <span class="UIDENT">Length</span> <a href="#local_d_357"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Invalid_huffman</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_dictionary</span> <a href="#local_d_357"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-inflate_table"><span class="LIDENT">inflate_table</span></span> <span id="local_d_364"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">warning</span> <span class="STRING">&quot;-8&quot;</span><span class="RBRACKET">]</span> <span id="def_1461"><span class="LPAREN">(</span><span class="UIDENT">Inflate_table</span><span class="EOL">
</span>                         <span class="LBRACE">{</span><span id="local_t_365"><span class="LIDENT">t</span></span><span class="SEMI">;</span> <span class="LIDENT">l</span><span class="EQUAL">=</span> <span id="local_max_bits_366"><span class="LIDENT">max_bits</span></span><span class="SEMI">;</span> <span class="LIDENT">r</span><span class="EQUAL">=</span> <span id="local_res_367"><span class="LIDENT">res</span></span><span class="SEMI">;</span> <span class="LIDENT">h</span><span class="EQUAL">=</span> <span id="local_hlit_368"><span class="LIDENT">hlit</span></span><span class="COMMA">,</span> <span id="local_hdist_369"><span class="LIDENT">hdist</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_d_364"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_res_370"><span class="LIDENT">max_res</span></span> <span class="EQUAL">=</span> <a href="#local_hlit_368"><span class="LIDENT">hlit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_hdist_369"><span class="LIDENT">hdist</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_mask_371"><span class="LIDENT">mask</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_max_bits_366"><span class="LIDENT">max_bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_372"><span class="LIDENT">get</span></span> <span id="local_k_373"><span class="LIDENT">k</span></span> <span id="local_d_374"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1574"><span id="local_len_375"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_376"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_t_365"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_374"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_mask_371"><span class="LIDENT">mask</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span><span class="COMMA">,</span> <a href="#local_t_365"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_374"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_mask_371"><span class="LIDENT">mask</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_d_374"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_374"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_375"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_374"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_374"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_375"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_373"><span class="LIDENT">k</span></a> <a href="#local_v_376"><span class="LIDENT">v</span></a> <a href="#local_d_374"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_377"><span class="LIDENT">get</span></span> <span id="local_k_378"><span class="LIDENT">k</span></span> <span id="local_d_379"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_peek_bits</span> <a href="#local_max_bits_366"><span class="LIDENT">max_bits</span></a> <span class="LPAREN">(</span><a href="#local_get_372"><span class="LIDENT">get</span></a> <a href="#local_k_378"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <a href="#local_d_379"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_bits_380"><span class="LIDENT">get_bits</span></span> <span id="local_n_381"><span class="LIDENT">n</span></span> <span id="local_k_382"><span class="LIDENT">k</span></span> <span id="local_d_383"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_384"><span class="LIDENT">k</span></span> <span id="local_d_385"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_v_386"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_d_385"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_n_381"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_385"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_385"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_n_381"><span class="LIDENT">n</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_385"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_385"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_n_381"><span class="LIDENT">n</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_k_382"><span class="LIDENT">k</span></a> <a href="#local_v_386"><span class="LIDENT">v</span></a> <a href="#local_d_385"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">c_peek_bits</span> <a href="#local_n_381"><span class="LIDENT">n</span></a> <a href="#local_k_384"><span class="LIDENT">k</span></a> <a href="#local_d_383"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ret_387"><span class="LIDENT">ret</span></span> <span id="local_r_388"><span class="LIDENT">r</span></span> <span id="local_d_389"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">make_table</span> <a href="#local_r_388"><span class="LIDENT">r</span></a> <a href="#local_hlit_368"><span class="LIDENT">hlit</span></a> <a href="#local_hdist_369"><span class="LIDENT">hdist</span></a> <a href="#local_d_389"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* XXX(dinosaure): [prv] and [i] are stored as associated env of [go]. We
       can not retake them from [d.s]. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_record_390"><span class="LIDENT">record</span></span> <span id="local_i_391"><span class="LIDENT">i</span></span> <span id="local_copy_392"><span class="LIDENT">copy</span></span> <span id="local_len_393"><span class="LIDENT">len</span></span> <span id="local_d_394"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_i_391"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_copy_392"><span class="LIDENT">copy</span></a> <span class="GREATER">&gt;</span> <a href="#local_max_res_370"><span class="LIDENT">max_res</span></a> <span class="THEN">then</span> <span class="LIDENT">err_invalid_dictionary</span> <a href="#local_d_394"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">x</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_copy_392"><span class="LIDENT">copy</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_res_367"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_391"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_393"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_i_391"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_copy_392"><span class="LIDENT">copy</span></a> <span class="LESS">&lt;</span> <a href="#local_max_res_370"><span class="LIDENT">max_res</span></a> <span class="THEN">then</span> <a href="#local_get_377"><span class="LIDENT">get</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_d_395"><span class="LIDENT">d</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_go_396"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><a href="#local_i_391"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_copy_392"><span class="LIDENT">copy</span></a><span class="RPAREN">)</span> <a href="#local_d_395"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <a href="#local_d_394"><span class="LIDENT">d</span></a><span class="EOL">
</span>          <span class="ELSE">else</span> <a href="#local_ret_387"><span class="LIDENT">ret</span></a> <a href="#local_res_367"><span class="LIDENT">res</span></a> <a href="#local_d_394"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_go_396"><span class="LIDENT">go</span></span> <span id="local_i_397"><span class="LIDENT">i</span></span> <span id="local_v_398"><span class="LIDENT">v</span></span> <span id="local_d_399"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_v_398"><span class="LIDENT">v</span></a> <span class="LESS">&lt;</span> <span class="INT">16</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_res_367"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_397"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_v_398"><span class="LIDENT">v</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_i_397"><span class="LIDENT">i</span></a> <span class="LESS">&lt;</span> <a href="#local_max_res_370"><span class="LIDENT">max_res</span></a> <span class="THEN">then</span> <a href="#local_get_377"><span class="LIDENT">get</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_d_400"><span class="LIDENT">d</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_go_396"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_i_397"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_d_400"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <a href="#local_d_399"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <a href="#local_ret_387"><span class="LIDENT">ret</span></a> <a href="#local_res_367"><span class="LIDENT">res</span></a> <a href="#local_d_399"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_v_398"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">16</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_401"><span class="LIDENT">k</span></span> <span id="local_v_402"><span class="LIDENT">v</span></span> <span id="local_d_403"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_record_390"><span class="LIDENT">record</span></a> <a href="#local_i_397"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_v_402"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="#local_res_367"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_397"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_d_403"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_i_397"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">err_invalid_dictionary</span> <a href="#local_d_399"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <a href="#local_get_bits_380"><span class="LIDENT">get_bits</span></a> <span class="INT">2</span> <a href="#local_k_401"><span class="LIDENT">k</span></a> <a href="#local_d_399"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_v_398"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">17</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_404"><span class="LIDENT">k</span></span> <span id="local_v_405"><span class="LIDENT">v</span></span> <span id="local_d_406"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_record_390"><span class="LIDENT">record</span></a> <a href="#local_i_397"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_v_405"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_d_406"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_get_bits_380"><span class="LIDENT">get_bits</span></a> <span class="INT">3</span> <a href="#local_k_404"><span class="LIDENT">k</span></a> <a href="#local_d_399"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_v_398"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">18</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_407"><span class="LIDENT">k</span></span> <span id="local_v_408"><span class="LIDENT">v</span></span> <span id="local_d_409"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_record_390"><span class="LIDENT">record</span></a> <a href="#local_i_397"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_v_408"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">11</span><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_d_409"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_get_bits_380"><span class="LIDENT">get_bits</span></a> <span class="INT">7</span> <a href="#local_k_407"><span class="LIDENT">k</span></a> <a href="#local_d_399"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="COMMENT">(* TODO: really never occur? *)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_410"><span class="LIDENT">k</span></span> <span id="local_v_411"><span class="LIDENT">v</span></span> <span id="local_d_412"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_go_396"><span class="LIDENT">go</span></a> <span class="INT">0</span> <a href="#local_v_411"><span class="LIDENT">v</span></a> <a href="#local_d_412"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_get_377"><span class="LIDENT">get</span></a> <a href="#local_k_410"><span class="LIDENT">k</span></a> <a href="#local_d_364"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* XXX(dinosaure): previous design asks to load [hclen * 3] bits, however, in
     a specific context, it can oveflow [hold]. So new design is to ensure to
     have enough bytes to inflate huffman tree. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-table"><span class="LIDENT">table</span></span> <span id="local_d_413"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">warning</span> <span class="STRING">&quot;-8&quot;</span><span class="RBRACKET">]</span> <span id="def_1531"><span class="LPAREN">(</span><span class="UIDENT">Table</span> <span class="LBRACE">{</span><span id="local_hlit_414"><span class="LIDENT">hlit</span></span><span class="SEMI">;</span> <span id="local_hdist_415"><span class="LIDENT">hdist</span></span><span class="SEMI">;</span> <span id="local_hclen_416"><span class="LIDENT">hclen</span></span><span class="RBRACE">}</span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hold_417"><span class="LIDENT">hold</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bits_418"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t_pos_419"><span class="LIDENT">t_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_420"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_421"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">19</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_420"><span class="LIDENT">i</span></a> <span class="LESS">&lt;</span> <a href="#local_hclen_416"><span class="LIDENT">hclen</span></a> <span class="DO">do</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_418"><span class="LIDENT">bits</span></a> <span class="LESS">&lt;</span> <span class="INT">3</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_hold_417"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_417"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_t_pos_419"><span class="LIDENT">t_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_418"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_418"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_418"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_t_pos_419"><span class="LIDENT">t_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_code_422"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_417"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x7</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_res_421"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">zigzag</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_420"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_code_422"><span class="LIDENT">code</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_hold_417"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_417"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">3</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_418"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_418"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_420"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1481"><span id="local_t_423"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_l_424"><span class="LIDENT">l</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">CODES</span> <a href="#local_res_421"><span class="LIDENT">res</span></a> <span class="INT">0</span> <span class="INT">19</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_417"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_418"><span class="LIDENT">bits</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* assert (!t_pos == d.t_len) ; *)</span><span class="EOL">
</span>          <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_need</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>            <span class="UIDENT">Inflate_table</span><span class="EOL">
</span>              <span class="LBRACE">{</span><a href="#local_t_423"><span class="LIDENT">t</span></a><span class="SEMI">;</span> <a href="#local_l_424"><span class="LIDENT">l</span></a><span class="SEMI">;</span> <span class="LIDENT">r</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="#local_hlit_414"><span class="LIDENT">hlit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_hdist_415"><span class="LIDENT">hdist</span></a><span class="RPAREN">)</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">h</span><span class="EQUAL">=</span> <a href="#local_hlit_414"><span class="LIDENT">hlit</span></a><span class="COMMA">,</span> <a href="#local_hdist_415"><span class="LIDENT">hdist</span></a><span class="COMMA">,</span> <a href="#local_hclen_416"><span class="LIDENT">hclen</span></a><span class="RBRACE">}</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">inflate_table</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalid_huffman</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_dictionary</span> <a href="#local_d_413"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-(//)"><span class="LPAREN">(</span> <span class="INFIXOP3">//</span> <span class="RPAREN">)</span></span> <span id="local_x_425"><span class="LIDENT">x</span></span> <span id="local_y_426"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_y_426"><span class="LIDENT">y</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Division_by_zero</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_x_425"><span class="LIDENT">x</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_x_425"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <a href="#local_y_426"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-dynamic"><span class="LIDENT">dynamic</span></span> <span id="local_d_427"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_l_header_428"><span class="LIDENT">l_header</span></span> <span id="local_d_429"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_t_pos_430"><span class="LIDENT">t_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_t_pos_430"><span class="LIDENT">t_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_t_pos_430"><span class="LIDENT">t_pos</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">t_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_hlit_431"><span class="LIDENT">hlit</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">257</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_hdist_432"><span class="LIDENT">hdist</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3e0</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">5</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_hclen_433"><span class="LIDENT">hclen</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3c00</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">10</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Table</span> <span class="LBRACE">{</span><a href="#local_hlit_431"><span class="LIDENT">hlit</span></a><span class="SEMI">;</span> <a href="#local_hdist_432"><span class="LIDENT">hdist</span></a><span class="SEMI">;</span> <a href="#local_hclen_433"><span class="LIDENT">hclen</span></a><span class="RBRACE">}</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">14</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_429"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">14</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): we ensure to have enough bytes to start to inflate
             huffman tree. *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_k_434"><span class="LIDENT">k</span></span> <span id="local_d_435"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_rem_436"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_435"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_rem_436"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_input</span> <a href="#local_d_435"><span class="LIDENT">d</span></a><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <span class="LIDENT">t_need</span> <a href="#local_d_435"><span class="LIDENT">d</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_hclen_433"><span class="LIDENT">hclen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_435"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <span class="INFIXOP3">//</span> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LIDENT">t_fill</span> <span class="LIDENT">table</span> <a href="#local_d_435"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_k_434"><span class="LIDENT">k</span></a> <a href="#local_d_429"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_required_437"><span class="LIDENT">required</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">14</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_427"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <span class="INFIXOP3">//</span> <span class="INT">8</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_d_427"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Dynamic_header</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">t_need</span> <a href="#local_d_427"><span class="LIDENT">d</span></a> <a href="#local_required_437"><span class="LIDENT">required</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">t_fill</span> <a href="#local_l_header_428"><span class="LIDENT">l_header</span></a> <a href="#local_d_427"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-decode_k"><span class="LIDENT">decode_k</span></span> <span id="local_d_438"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Header</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="COMMENT">(* XXX(dinosaure): check this code, we should need a [k]ontinuation. *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_l_header_439"><span class="LIDENT">l_header</span></span> <span id="local_d_440"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* allocation *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_last_441"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_k_442"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="MATCH">match</span> <span class="LPAREN">(</span><a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x6</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">1</span> <span class="WITH">with</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">flat_header</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="INT">1</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fixed</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="INT">2</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dynamic</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="INT">3</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_kind_of_block</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_last_441"><span class="LIDENT">last</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">3</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_440"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_k_442"><span class="LIDENT">k</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_442"><span class="LIDENT">k</span></a> <a href="#local_d_440"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">c_peek_bits</span> <span class="INT">3</span> <a href="#local_l_header_439"><span class="LIDENT">l_header</span></a> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Table</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t_fill</span> <span class="LIDENT">table</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Inflate_table</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Inflate</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="LIDENT">i_rem</span> <a href="#local_d_438"><span class="LIDENT">d</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <span class="LIDENT">inflate</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">literal</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">distance</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Slow</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">slow_inflate</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">literal</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">distance</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Slow</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Dynamic_header</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Flat_header</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Flat</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">flat</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End_of_inflate</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">tail</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">8</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_438"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span> <span class="COMMENT">(* XXX(dinosaure): keep? *)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="UIDENT">End</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Inf.val-decode"><span class="LIDENT">decode</span></span> <span id="local_d_443"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">decode_k</span> <a href="#local_d_443"><span class="LIDENT">d</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Malformed</span> <span id="local_err_444"><span class="LIDENT">err</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Malformed</span> <a href="#local_err_444"><span class="LIDENT">err</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">K</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">decode</span> <a href="#local_d_443"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-dst_rem"><span class="LIDENT">dst_rem</span></span> <span id="local_d_445"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_d_445"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_445"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* TODO: why [+1] disappears? *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-src_rem"><span class="LIDENT">src_rem</span></span> <span id="local_d_446"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_446"><span class="LIDENT">d</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-flush"><span class="LIDENT">flush</span></span> <span id="local_d_447"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_d_447"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-decoder"><span class="LIDENT">decoder</span></span> <span id="local_src_448"><span class="LIDENT">src</span></span> <span class="TILDE">~</span><span id="local_o_449"><span class="LIDENT">o</span></span> <span class="TILDE">~</span><span id="local_w_450"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1449"><span id="local_i_451"><span class="LIDENT">i</span></span><span class="COMMA">,</span> <span id="local_i_pos_452"><span class="LIDENT">i_pos</span></span><span class="COMMA">,</span> <span id="local_i_len_453"><span class="LIDENT">i_len</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_src_448"><span class="LIDENT">src</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_empty</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span id="local_x_454"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_of_string</span> <a href="#local_x_454"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_x_454"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_create</span> <span class="LIDENT">io_buffer_size</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <a href="#local_src_448"><span class="LIDENT">src</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_i_451"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_i_pos_452"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_i_len_453"><span class="LIDENT">i_len</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_o_449"><span class="LIDENT">o</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">o_pos</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">t</span><span class="EQUAL">=</span> <span class="LIDENT">bigstring_create</span> <span class="INT">10</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">t_need</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">t_len</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">bits</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">l</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">d</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">literal</span><span class="EQUAL">=</span> <span class="LIDENT">fixed_lit</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">distance</span><span class="EQUAL">=</span> <span class="LIDENT">fixed_dist</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">jump</span><span class="EQUAL">=</span> <span class="UIDENT">Length</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">w</span><span class="EQUAL">=</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">from</span> <a href="#local_w_450"><span class="LIDENT">w</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">s</span><span class="EQUAL">=</span> <span class="UIDENT">Header</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">k</span><span class="EQUAL">=</span> <span class="LIDENT">decode_k</span><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Inf.val-reset"><span class="LIDENT">reset</span></span> <span id="local_d_455"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1448"><span id="local_i_456"><span class="LIDENT">i</span></span><span class="COMMA">,</span> <span id="local_i_pos_457"><span class="LIDENT">i_pos</span></span><span class="COMMA">,</span> <span id="local_i_len_458"><span class="LIDENT">i_len</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">src</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_empty</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span id="local_x_459"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_of_string</span> <a href="#local_x_459"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_x_459"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_create</span> <span class="LIDENT">io_buffer_size</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_i_456"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_i_pos_457"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_i_len_458"><span class="LIDENT">i_len</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <span class="LESSMINUS">&lt;-</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">literal</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">fixed_lit</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">distance</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">fixed_dist</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">jump</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Length</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">s</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Header</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">decode_k</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">reset</span> <a href="#local_d_455"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Inf.module-Ns"><span class="MODULE">module</span> <span class="UIDENT">Ns</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Inf.module-Ns.type-decoder"><span class="TYPE">type</span> <span class="LIDENT">decoder</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span id="def_1592"><span class="LIDENT">i</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1542"><span class="MUTABLE">mutable</span> <span class="LIDENT">i_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1557"><span class="LIDENT">i_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1451"><span class="MUTABLE">mutable</span> <span class="LIDENT">hold</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1467"><span class="MUTABLE">mutable</span> <span class="LIDENT">bits</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1430"><span class="LIDENT">o</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1495"><span class="MUTABLE">mutable</span> <span class="LIDENT">o_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1540"><span class="LIDENT">o_len</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* errors. *)</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Inf.module-Ns.type-error"><span class="TYPE">type</span> <span class="LIDENT">error</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_input</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_output</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_kind_of_block</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_dictionary</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_complement_of_length</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_distance</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_distance_code</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-pp_error"><span class="LIDENT">pp_error</span></span> <span id="local_ppf_460"><span class="LIDENT">ppf</span></span> <span id="local_e_461"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_462"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_e_461"><span class="LIDENT">e</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_input</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Unexpected end of input&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_output</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Unexpected end of output&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_kind_of_block</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Invalid kind of block&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_dictionary</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Invalid dictionary&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_complement_of_length</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Invalid complement of length&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_distance</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Invalid distance&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_distance_code</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Invalid distance code&quot;</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_ppf_460"><span class="LIDENT">ppf</span></a> <span class="STRING">&quot;%s&quot;</span> <a href="#local_s_462"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Inf.module-Ns.exception-Malformed"><span class="EXCEPTION">exception</span> <span class="UIDENT">Malformed</span> <span class="OF">of</span> <span class="LIDENT">error</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_unexpected_end_of_input"><span class="LIDENT">err_unexpected_end_of_input</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_input</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_unexpected_end_of_output"><span class="LIDENT">err_unexpected_end_of_output</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_output</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_invalid_kind_of_block"><span class="LIDENT">err_invalid_kind_of_block</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_kind_of_block</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_invalid_dictionary"><span class="LIDENT">err_invalid_dictionary</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_dictionary</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_invalid_complement_of_length"><span class="LIDENT">err_invalid_complement_of_length</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_complement_of_length</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_invalid_distance"><span class="LIDENT">err_invalid_distance</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_distance</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-err_invalid_distance_code"><span class="LIDENT">err_invalid_distance_code</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_distance_code</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* remaining bytes to read [d.i]. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-i_rem"><span class="LIDENT">i_rem</span></span> <span id="local_d_463"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_d_463"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_463"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-_slow_blit"><span class="LIDENT">_slow_blit</span></span> <span id="local_src_464"><span class="LIDENT">src</span></span> <span id="local_src_off_465"><span class="LIDENT">src_off</span></span> <span id="local_dst_466"><span class="LIDENT">dst</span></span> <span id="local_dst_off_467"><span class="LIDENT">dst_off</span></span> <span id="local_len_468"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_468"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_v_469"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_464"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_465"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst_466"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_467"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="#local_v_469"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-_blit"><span class="LIDENT">_blit</span></span> <span id="local_src_470"><span class="LIDENT">src</span></span> <span id="local_src_off_471"><span class="LIDENT">src_off</span></span> <span id="local_dst_472"><span class="LIDENT">dst</span></span> <span id="local_dst_off_473"><span class="LIDENT">dst_off</span></span> <span id="local_len_474"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_dst_off_473"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_src_off_471"><span class="LIDENT">src_off</span></a> <span class="LESS">&lt;</span> <span class="INT">4</span> <span class="THEN">then</span> <span class="LIDENT">_slow_blit</span> <a href="#local_src_470"><span class="LIDENT">src</span></a> <a href="#local_src_off_471"><span class="LIDENT">src_off</span></a> <a href="#local_dst_472"><span class="LIDENT">dst</span></a> <a href="#local_dst_off_473"><span class="LIDENT">dst_off</span></a> <a href="#local_len_474"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len0_475"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_474"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len1_476"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_474"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_476"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_i_477"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_v_478"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_src_470"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_471"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_477"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst_472"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_473"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_477"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_478"><span class="LIDENT">v</span></a><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_475"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_i_479"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_476"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_v_480"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_470"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_471"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_479"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst_472"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_473"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_479"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_480"><span class="LIDENT">v</span></a><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-flat"><span class="LIDENT">flat</span></span> <span id="local_d_481"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">i_rem</span> <a href="#local_d_481"><span class="LIDENT">d</span></a> <span class="LESS">&lt;</span> <span class="INT">4</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_input</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_len_482"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16_le</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_nlen_483"><span class="LIDENT">nlen</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16_le</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_nlen_483"><span class="LIDENT">nlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0xffff</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_482"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <span class="LIDENT">err_invalid_complement_of_length</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_len_482"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="LIDENT">i_rem</span> <a href="#local_d_481"><span class="LIDENT">d</span></a> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_input</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_len_482"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">_blit</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_len_482"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_482"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_481"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_482"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-_fill_bits"><span class="LIDENT">_fill_bits</span></span> <span id="local_d_484"><span class="LIDENT">d</span></span> <span id="local_n_485"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESS">&lt;</span> <a href="#local_n_485"><span class="LIDENT">n</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_rem_486"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_484"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_rem_486"><span class="LIDENT">rem</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint16_le</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_rem_486"><span class="LIDENT">rem</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_484"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LIDENT">err_unexpected_end_of_input</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-__fill_bits"><span class="LIDENT">__fill_bits</span></span> <span id="local_d_487"><span class="LIDENT">d</span></span> <span id="local_n_488"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESS">&lt;</span> <a href="#local_n_488"><span class="LIDENT">n</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_rem_489"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_d_487"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_rem_489"><span class="LIDENT">rem</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint16_le</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_rem_489"><span class="LIDENT">rem</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_487"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-pop_bits"><span class="LIDENT">pop_bits</span></span> <span id="local_d_490"><span class="LIDENT">d</span></span> <span id="local_n_491"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_492"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_d_490"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_n_491"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_d_490"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_490"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_n_491"><span class="LIDENT">n</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_d_490"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_490"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_n_491"><span class="LIDENT">n</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_v_492"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Inf.module-Ns.exception-End"><span class="EXCEPTION">exception</span> <span class="UIDENT">End</span></span><span class="EOL">
</span>    <span id="module-Inf.module-Ns.exception-Invalid_distance"><span class="EXCEPTION">exception</span> <span class="UIDENT">Invalid_distance</span></span><span class="EOL">
</span>    <span id="module-Inf.module-Ns.exception-Invalid_distance_code"><span class="EXCEPTION">exception</span> <span class="UIDENT">Invalid_distance_code</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-{inflate}9/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">inflate</span></span> <span id="local_lit_493"><span class="LIDENT">lit</span></span> <span id="local_dist_494"><span class="LIDENT">dist</span></span> <span id="local_d_495"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="REC">rec</span> <span id="local_inflate_loop_496"><span class="LIDENT">inflate_loop</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">__fill_bits</span> <a href="#local_d_495"><span class="LIDENT">d</span></a> <a href="#local_lit_493"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">l</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_value_497"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="#local_lit_493"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_lit_493"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_498"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_lit_493"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_lit_493"><span class="LIDENT">lit</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_498"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_498"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_value_497"><span class="LIDENT">value</span></a> <span class="LESS">&lt;</span> <span class="INT">256</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <span class="IF">if</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_value_497"><span class="LIDENT">value</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_inflate_loop_496"><span class="LIDENT">inflate_loop</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_value_497"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">End</span><span class="EOL">
</span>              <span class="ELSE">else</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_l_499"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="#local_value_497"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">257</span> <span class="IN">in</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_len_500"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_lbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_l_499"><span class="LIDENT">l</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                <span class="LIDENT">__fill_bits</span> <a href="#local_d_495"><span class="LIDENT">d</span></a> <a href="#local_len_500"><span class="LIDENT">len</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_extra_501"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_495"><span class="LIDENT">d</span></a> <a href="#local_len_500"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>                  <span class="LET">let</span> <span id="local_l_502"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_base_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_l_499"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_501"><span class="LIDENT">extra</span></a> <span class="IN">in</span><span class="EOL">
</span>                  <span class="LIDENT">__fill_bits</span> <a href="#local_d_495"><span class="LIDENT">d</span></a> <a href="#local_dist_494"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">l</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_value_503"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>                      <a href="#local_dist_494"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_dist_494"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span><span class="EOL">
</span>                    <span class="IN">in</span><span class="EOL">
</span>                    <span class="LET">let</span> <span id="local_len_504"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_dist_494"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_dist_494"><span class="LIDENT">dist</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">m</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span>                    <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_504"><span class="LIDENT">len</span></a><span class="EOL">
</span>                    <span class="SEMI">;</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_504"><span class="LIDENT">len</span></a><span class="EOL">
</span>                    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_d__505"><span class="LIDENT">d_</span></span> <span class="EQUAL">=</span> <a href="#local_value_503"><span class="LIDENT">value</span></a> <span class="IN">in</span><span class="EOL">
</span>                      <span class="LET">let</span> <span id="local_len_506"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d__505"><span class="LIDENT">d_</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                      <span class="LIDENT">__fill_bits</span> <a href="#local_d_495"><span class="LIDENT">d</span></a> <a href="#local_len_506"><span class="LIDENT">len</span></a><span class="EOL">
</span>                      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_extra_507"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_495"><span class="LIDENT">d</span></a> <a href="#local_len_506"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>                        <span class="LET">let</span> <span id="local_d__508"><span class="LIDENT">d_</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_base_dist</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d__505"><span class="LIDENT">d_</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_507"><span class="LIDENT">extra</span></a> <span class="IN">in</span><span class="EOL">
</span>                        <span class="IF">if</span> <a href="#local_d__508"><span class="LIDENT">d_</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Invalid_distance_code</span><span class="EOL">
</span>                        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_d__508"><span class="LIDENT">d_</span></a> <span class="GREATER">&gt;</span> <span class="LIDENT">min</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>                            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Invalid_distance</span><span class="EOL">
</span>                        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_off_509"><span class="LIDENT">off</span></span> <span class="EQUAL">=</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d__508"><span class="LIDENT">d_</span></a> <span class="IN">in</span><span class="EOL">
</span>                          <span class="IF">if</span> <a href="#local_l_502"><span class="LIDENT">l</span></a> <span class="GREATER">&gt;</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="THEN">then</span><span class="EOL">
</span>                            <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>                          <span class="SEMI">;</span> <span class="LIDENT">_blit</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_off_509"><span class="LIDENT">off</span></a> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_l_502"><span class="LIDENT">l</span></a><span class="EOL">
</span>                          <span class="SEMI">;</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_495"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_502"><span class="LIDENT">l</span></a><span class="EOL">
</span>                          <span class="SEMI">;</span> <a href="#local_inflate_loop_496"><span class="LIDENT">inflate_loop</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_inflate_loop_496"><span class="LIDENT">inflate_loop</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Invalid_distance</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_distance</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Invalid_distance_code</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_distance_code</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-fixed"><span class="LIDENT">fixed</span></span> <span id="local_d_510"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">inflate</span> <span class="LIDENT">fixed_lit</span> <span class="LIDENT">fixed_dist</span> <a href="#local_d_510"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* XXX(clecat): The table functions are almost a copy of the stream implementation, by
       adapting their code, they should be easily merged *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-make_table"><span class="LIDENT">make_table</span></span> <span id="local_t_511"><span class="LIDENT">t</span></span> <span id="local_hlit_512"><span class="LIDENT">hlit</span></span> <span id="local_hdist_513"><span class="LIDENT">hdist</span></span> <span id="local_d_514"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_t_511"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Invalid_huffman</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): an huffman tree MUST have at least an End-Of-Block
             symbol. *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_1548"><span id="local_t_lit_515"><span class="LIDENT">t_lit</span></span><span class="COMMA">,</span> <span id="local_l_lit_516"><span class="LIDENT">l_lit</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">LENS</span> <a href="#local_t_511"><span class="LIDENT">t</span></a> <span class="INT">0</span> <a href="#local_hlit_512"><span class="LIDENT">hlit</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_1470"><span id="local_t_dist_517"><span class="LIDENT">t_dist</span></span><span class="COMMA">,</span> <span id="local_l_dist_518"><span class="LIDENT">l_dist</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">DISTS</span> <a href="#local_t_511"><span class="LIDENT">t</span></a> <a href="#local_hlit_512"><span class="LIDENT">hlit</span></a> <a href="#local_hdist_513"><span class="LIDENT">hdist</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_lit_519"><span class="LIDENT">lit</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_t_lit_515"><span class="LIDENT">t_lit</span></a> <a href="#local_l_lit_516"><span class="LIDENT">l_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_dist_520"><span class="LIDENT">dist</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">make</span> <a href="#local_t_dist_517"><span class="LIDENT">t_dist</span></a> <a href="#local_l_dist_518"><span class="LIDENT">l_dist</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>          <span class="LIDENT">inflate</span> <a href="#local_lit_519"><span class="LIDENT">lit</span></a> <a href="#local_dist_520"><span class="LIDENT">dist</span></a> <a href="#local_d_514"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalid_huffman</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_dictionary</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-inflate_table"><span class="LIDENT">inflate_table</span></span> <span id="local_d_521"><span class="LIDENT">d</span></span> <span id="local_t_522"><span class="LIDENT">t</span></span> <span id="local_max_bits_523"><span class="LIDENT">max_bits</span></span> <span id="local_res_524"><span class="LIDENT">res</span></span> <span class="LPAREN">(</span><span id="local_hlit_525"><span class="LIDENT">hlit</span></span><span class="COMMA">,</span> <span id="local_hdist_526"><span class="LIDENT">hdist</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_max_res_527"><span class="LIDENT">max_res</span></span> <span class="EQUAL">=</span> <a href="#local_hlit_525"><span class="LIDENT">hlit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_hdist_526"><span class="LIDENT">hdist</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_mask_528"><span class="LIDENT">mask</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_max_bits_523"><span class="LIDENT">max_bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_get_529"><span class="LIDENT">get</span></span> <span id="local_d_530"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LIDENT">_fill_bits</span> <a href="#local_d_530"><span class="LIDENT">d</span></a> <a href="#local_max_bits_523"><span class="LIDENT">max_bits</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_v_531"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_t_522"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_530"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_mask_528"><span class="LIDENT">mask</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">mask</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_len_532"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_t_522"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_d_530"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_mask_528"><span class="LIDENT">mask</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_d_530"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_530"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_532"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_d_530"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_530"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_532"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_v_531"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_get_bits_533"><span class="LIDENT">get_bits</span></span> <span id="local_d_534"><span class="LIDENT">d</span></span> <span id="local_n_535"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_fill_bits</span> <a href="#local_d_534"><span class="LIDENT">d</span></a> <a href="#local_n_535"><span class="LIDENT">n</span></a> <span class="SEMI">;</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_534"><span class="LIDENT">d</span></a> <a href="#local_n_535"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_ret_536"><span class="LIDENT">ret</span></span> <span id="local_r_537"><span class="LIDENT">r</span></span> <span id="local_d_538"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">make_table</span> <a href="#local_r_537"><span class="LIDENT">r</span></a> <a href="#local_hlit_525"><span class="LIDENT">hlit</span></a> <a href="#local_hdist_526"><span class="LIDENT">hdist</span></a> <a href="#local_d_538"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_record_539"><span class="LIDENT">record</span></span> <span id="local_i_540"><span class="LIDENT">i</span></span> <span id="local_copy_541"><span class="LIDENT">copy</span></span> <span id="local_len_542"><span class="LIDENT">len</span></span> <span id="local_d_543"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_i_540"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_copy_541"><span class="LIDENT">copy</span></a> <span class="GREATER">&gt;</span> <a href="#local_max_res_527"><span class="LIDENT">max_res</span></a> <span class="THEN">then</span> <span class="LIDENT">err_invalid_dictionary</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="FOR">for</span> <span class="LIDENT">x</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_copy_541"><span class="LIDENT">copy</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>            <a href="#local_res_524"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_540"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_542"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_i_540"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_copy_541"><span class="LIDENT">copy</span></a> <span class="LESS">&lt;</span> <a href="#local_max_res_527"><span class="LIDENT">max_res</span></a> <span class="THEN">then</span> <a href="#local_go_544"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><a href="#local_i_540"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_copy_541"><span class="LIDENT">copy</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_529"><span class="LIDENT">get</span></a> <a href="#local_d_543"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <a href="#local_d_543"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <a href="#local_ret_536"><span class="LIDENT">ret</span></a> <a href="#local_res_524"><span class="LIDENT">res</span></a> <a href="#local_d_543"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="AND">and</span> <span id="local_go_544"><span class="LIDENT">go</span></span> <span id="local_i_545"><span class="LIDENT">i</span></span> <span id="local_v_546"><span class="LIDENT">v</span></span> <span id="local_d_547"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_v_546"><span class="LIDENT">v</span></a> <span class="LESS">&lt;</span> <span class="INT">16</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_res_524"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_545"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_v_546"><span class="LIDENT">v</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_i_545"><span class="LIDENT">i</span></a> <span class="LESS">&lt;</span> <a href="#local_max_res_527"><span class="LIDENT">max_res</span></a> <span class="THEN">then</span> <a href="#local_go_544"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_i_545"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_529"><span class="LIDENT">get</span></a> <a href="#local_d_547"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <a href="#local_d_547"><span class="LIDENT">d</span></a> <span class="ELSE">else</span> <a href="#local_ret_536"><span class="LIDENT">ret</span></a> <a href="#local_res_524"><span class="LIDENT">res</span></a> <a href="#local_d_547"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_v_546"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">16</span> <span class="THEN">then</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_i_545"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">err_invalid_dictionary</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_v_548"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_get_bits_533"><span class="LIDENT">get_bits</span></a> <a href="#local_d_547"><span class="LIDENT">d</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_record_539"><span class="LIDENT">record</span></a> <a href="#local_i_545"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_v_548"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="#local_res_524"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_545"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_d_547"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_v_546"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">17</span> <span class="THEN">then</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_v_549"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_get_bits_533"><span class="LIDENT">get_bits</span></a> <a href="#local_d_547"><span class="LIDENT">d</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_record_539"><span class="LIDENT">record</span></a> <a href="#local_i_545"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_v_549"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_d_547"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_v_546"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">18</span> <span class="THEN">then</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_v_550"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_get_bits_533"><span class="LIDENT">get_bits</span></a> <a href="#local_d_547"><span class="LIDENT">d</span></a> <span class="INT">7</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_record_539"><span class="LIDENT">record</span></a> <a href="#local_i_545"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_v_550"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">11</span><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_d_547"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="COMMENT">(* TODO: really never occur? *)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_go_544"><span class="LIDENT">go</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="#local_get_529"><span class="LIDENT">get</span></a> <a href="#local_d_521"><span class="LIDENT">d</span></a><span class="RPAREN">)</span> <a href="#local_d_521"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-table"><span class="LIDENT">table</span></span> <span id="local_d_551"><span class="LIDENT">d</span></span> <span id="local_hlit_552"><span class="LIDENT">hlit</span></span> <span id="local_hdist_553"><span class="LIDENT">hdist</span></span> <span id="local_hclen_554"><span class="LIDENT">hclen</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_555"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_res_556"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">19</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_555"><span class="LIDENT">i</span></a> <span class="LESS">&lt;</span> <a href="#local_hclen_554"><span class="LIDENT">hclen</span></a> <span class="DO">do</span><span class="EOL">
</span>        <span class="LIDENT">_fill_bits</span> <a href="#local_d_551"><span class="LIDENT">d</span></a> <span class="INT">3</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_code_557"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_551"><span class="LIDENT">d</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_res_556"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">zigzag</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_555"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_code_557"><span class="LIDENT">code</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_555"><span class="LIDENT">i</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="TRY">try</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_1445"><span id="local_t_558"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_l_559"><span class="LIDENT">l</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">huffman</span> <span class="UIDENT">CODES</span> <a href="#local_res_556"><span class="LIDENT">res</span></a> <span class="INT">0</span> <span class="INT">19</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_r_560"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="#local_hlit_552"><span class="LIDENT">hlit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_hdist_553"><span class="LIDENT">hdist</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_h_561"><span class="LIDENT">h</span></span> <span class="EQUAL">=</span> <a href="#local_hlit_552"><span class="LIDENT">hlit</span></a><span class="COMMA">,</span> <a href="#local_hdist_553"><span class="LIDENT">hdist</span></a><span class="COMMA">,</span> <a href="#local_hclen_554"><span class="LIDENT">hclen</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">inflate_table</span> <a href="#local_d_551"><span class="LIDENT">d</span></a> <a href="#local_t_558"><span class="LIDENT">t</span></a> <a href="#local_l_559"><span class="LIDENT">l</span></a> <a href="#local_r_560"><span class="LIDENT">r</span></a> <a href="#local_h_561"><span class="LIDENT">h</span></a><span class="EOL">
</span>        <span class="WITH">with</span> <span class="UIDENT">Invalid_huffman</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_dictionary</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-dynamic"><span class="LIDENT">dynamic</span></span> <span id="local_d_562"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">_fill_bits</span> <a href="#local_d_562"><span class="LIDENT">d</span></a> <span class="INT">14</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_hlit_563"><span class="LIDENT">hlit</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_562"><span class="LIDENT">d</span></a> <span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">257</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_hdist_564"><span class="LIDENT">hdist</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_562"><span class="LIDENT">d</span></a> <span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_hclen_565"><span class="LIDENT">hclen</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_562"><span class="LIDENT">d</span></a> <span class="INT">4</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">table</span> <a href="#local_d_562"><span class="LIDENT">d</span></a> <a href="#local_hlit_563"><span class="LIDENT">hlit</span></a> <a href="#local_hdist_564"><span class="LIDENT">hdist</span></a> <a href="#local_hclen_565"><span class="LIDENT">hclen</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Inf.module-Ns.val-decode"><span class="LIDENT">decode</span></span> <span id="local_d_566"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">_fill_bits</span> <a href="#local_d_566"><span class="LIDENT">d</span></a> <span class="INT">3</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_last_567"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_566"><span class="LIDENT">d</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_block_type_568"><span class="LIDENT">block_type</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pop_bits</span> <a href="#local_d_566"><span class="LIDENT">d</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_block_type_568"><span class="LIDENT">block_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">flat</span> <a href="#local_d_566"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="INT">1</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fixed</span> <a href="#local_d_566"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="INT">2</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dynamic</span> <a href="#local_d_566"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="INT">3</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">err_invalid_kind_of_block</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_last_567"><span class="LIDENT">last</span></a> <span class="THEN">then</span> <a href="#local_d_566"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_d_566"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_d_566"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="LIDENT">decode</span> <a href="#local_d_566"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Inf.module-Ns.val-inflate"><span class="LIDENT">inflate</span></span> <span id="local_src_569"><span class="LIDENT">src</span></span> <span id="local_dst_570"><span class="LIDENT">dst</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_d_571"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LBRACE">{</span><span class="EOL">
</span>          <span class="LIDENT">i</span><span class="EQUAL">=</span> <a href="#local_src_569"><span class="LIDENT">src</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">i_pos</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">i_len</span><span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_src_569"><span class="LIDENT">src</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">o</span><span class="EQUAL">=</span> <a href="#local_dst_570"><span class="LIDENT">dst</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">o_pos</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">o_len</span><span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_dst_570"><span class="LIDENT">dst</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">bits</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LIDENT">decode</span> <a href="#local_d_571"><span class="LIDENT">d</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><a href="#local_d_571"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="COMMA">,</span> <a href="#local_d_571"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Malformed</span> <span id="local_e_572"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><a href="#local_e_572"><span class="LIDENT">e</span></a> <span class="COLON">:</span> <span class="LIDENT">error</span> <span class="COLONGREATER">:&gt;</span> <span class="LBRACKETGREATER">[&gt;</span> <span class="LIDENT">error</span> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_set_cursor"><span class="LIDENT">unsafe_set_cursor</span></span> <span id="local_d_573"><span class="LIDENT">d</span></span> <span id="local_c_574"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_d_573"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOT">.</span><span class="UIDENT">WInf</span><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_574"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-T"><span class="MODULE">module</span> <span class="UIDENT">T</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-T.module-Heap"><span class="MODULE">module</span> <span class="UIDENT">Heap</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-T.module-Heap.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1507"><span class="LIDENT">heap</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="SEMI">;</span></span> <span id="def_1499"><span class="MUTABLE">mutable</span> <span class="LIDENT">len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1488"><span class="MUTABLE">mutable</span> <span class="LIDENT">max</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-T.module-Heap.val-make"><span class="LIDENT">make</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="LIDENT">heap</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_heap_size</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">len</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">max</span><span class="EQUAL">=</span> <span class="LIDENT">_heap_size</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-T.module-Heap.val-populate"><span class="LIDENT">populate</span></span> <span class="TILDE">~</span><span id="local_length_575"><span class="LIDENT">length</span></span> <span class="TILDE">~</span><span id="local_freqs_576"><span class="LIDENT">freqs</span></span> <span id="local_tree_lengths_577"><span class="LIDENT">tree_lengths</span></span> <span class="TILDE">~</span><span id="local_depth_578"><span class="LIDENT">depth</span></span> <span id="local_heap_579"><span class="LIDENT">heap</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* assert (Array.length tree_lengths = Array.length freqs) ;
         assert (Array.length depth = heap.max) ;
         assert (Array.length heap.heap = heap.max) ;
         assert (heap.max = _heap_size) ;
      *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_max_code_580"><span class="LIDENT">max_code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="MINUS">-</span><span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="COMMENT">(* Construct the initial heap, with least frequent element in
         heap[SMALLEST]. The sons of heap[n] are heap[2*n] and heap[2*n+1].
         heap[0] is not used. *)</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">n</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_length_575"><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_freqs_576"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_heap_579"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_579"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_heap_579"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_579"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">n</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_max_code_580"><span class="LIDENT">max_code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">n</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_depth_578"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_tree_lengths_577"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="COMMENT">(* XXX(dinosaure): we consider that [tree_lengths] can have bad
             informations, so we clean it. However, it was initialized with [0] in
             [T.make] builder. *)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_code_580"><span class="LIDENT">max_code</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* The pkzip format requires that at least one distance code exists,
       and that at least one bit should be sent even if there is only one
       possible code. So to avoid special checks later on we force at least
       two codes of non zero frequency. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-T.module-Heap.val-pkzip"><span class="LIDENT">pkzip</span></span> <span id="local_max_code_581"><span class="LIDENT">max_code</span></span> <span class="TILDE">~</span><span id="local_freqs_582"><span class="LIDENT">freqs</span></span> <span class="TILDE">~</span><span id="local_depth_583"><span class="LIDENT">depth</span></span> <span id="local_heap_584"><span class="LIDENT">heap</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_max_code_585"><span class="LIDENT">max_code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_max_code_581"><span class="LIDENT">max_code</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_heap_584"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <span class="LESS">&lt;</span> <span class="INT">2</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_node_586"><span class="LIDENT">node</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_code_585"><span class="LIDENT">max_code</span></a> <span class="LESS">&lt;</span> <span class="INT">2</span> <span class="THEN">then</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_max_code_585"><span class="LIDENT">max_code</span></a> <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_code_585"><span class="LIDENT">max_code</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_freqs_582"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_node_586"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_heap_584"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_584"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_heap_584"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_584"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_node_586"><span class="LIDENT">node</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_depth_583"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_node_586"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_code_585"><span class="LIDENT">max_code</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="module-T.module-Heap.val-smaller"><span class="LIDENT">smaller</span></span> <span id="local_freqs_587"><span class="LIDENT">freqs</span></span> <span id="local_n_588"><span class="LIDENT">n</span></span> <span id="local_m_589"><span class="LIDENT">m</span></span> <span id="local_depth_590"><span class="LIDENT">depth</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_freqs_587"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_588"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="LESS">&lt;</span> <a href="#local_freqs_587"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_589"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LPAREN">(</span><a href="#local_freqs_587"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_588"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_freqs_587"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_589"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_depth_590"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_588"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_depth_590"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_589"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-T.module-Heap.val-pqdownheap"><span class="LIDENT">pqdownheap</span></span> <span class="TILDE">~</span><span id="local_freqs_591"><span class="LIDENT">freqs</span></span> <span class="TILDE">~</span><span id="local_depth_592"><span class="LIDENT">depth</span></span> <span id="local_heap_593"><span class="LIDENT">heap</span></span> <span id="local_k_594"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1485"><span class="UIDENT">Break</span></span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_595"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_k_594"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_j_596"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_k_594"><span class="LIDENT">k</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_597"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_k_594"><span class="LIDENT">k</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="TRY">try</span><span class="EOL">
</span>         <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <span class="DO">do</span><span class="EOL">
</span>           <span class="IF">if</span><span class="EOL">
</span>             <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a> <span class="LESS">&lt;</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span><span class="EOL">
</span>             <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">smaller</span> <a href="#local_freqs_591"><span class="LIDENT">freqs</span></a> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a><span class="RPAREN">)</span> <a href="#local_depth_592"><span class="LIDENT">depth</span></a><span class="EOL">
</span>           <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_j_596"><span class="LIDENT">j</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">smaller</span> <a href="#local_freqs_591"><span class="LIDENT">freqs</span></a> <a href="#local_v_595"><span class="LIDENT">v</span></a> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a><span class="RPAREN">)</span> <a href="#local_depth_592"><span class="LIDENT">depth</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Break</span><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_597"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a><span class="RPAREN">)</span><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="#local_k_597"><span class="LIDENT">k</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="#local_j_596"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_596"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>         <span class="DONE">done</span><span class="EOL">
</span>       <span class="WITH">with</span> <span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_heap_593"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_k_597"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_v_595"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-T.module-Heap.val-pqremove"><span class="LIDENT">pqremove</span></span> <span class="TILDE">~</span><span id="local_freqs_598"><span class="LIDENT">freqs</span></span> <span class="TILDE">~</span><span id="local_depth_599"><span class="LIDENT">depth</span></span> <span id="local_heap_600"><span class="LIDENT">heap</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_top_601"><span class="LIDENT">top</span></span> <span class="EQUAL">=</span> <a href="#local_heap_600"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_smallest</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_heap_600"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_smallest</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_600"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_600"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_heap_600"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_600"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">pqdownheap</span> <span class="TILDE">~</span><a href="#local_freqs_598"><span class="LIDENT">freqs</span></a> <span class="TILDE">~</span><a href="#local_depth_599"><span class="LIDENT">depth</span></a> <a href="#local_heap_600"><span class="LIDENT">heap</span></a> <span class="LIDENT">_smallest</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_top_601"><span class="LIDENT">top</span></a><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Reverse the first len bits of a code, using a straightforward code
     (a faster method would use a table). *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-reverse_code"><span class="LIDENT">reverse_code</span></span> <span id="local_code_602"><span class="LIDENT">code</span></span> <span id="local_len_603"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* assert (1 &lt;= len &amp;&amp; len &lt;= 15); *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_604"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_605"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_len_603"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_code_606"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_code_602"><span class="LIDENT">code</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span><span class="EOL">
</span>      <a href="#local_res_604"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_604"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_606"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_code_606"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_606"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_res_604"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_604"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_len_605"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_605"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="DO">do</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_604"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-generate_codes"><span class="LIDENT">generate_codes</span></span> <span class="TILDE">~</span><span id="local_tree_lengths_607"><span class="LIDENT">tree_lengths</span></span> <span class="TILDE">~</span><span id="local_max_code_608"><span class="LIDENT">max_code</span></span> <span class="TILDE">~</span><span id="local_bl_count_609"><span class="LIDENT">bl_count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tree_codes_610"><span class="LIDENT">tree_codes</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_tree_lengths_607"><span class="LIDENT">tree_lengths</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_next_code_611"><span class="LIDENT">next_code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_code_612"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* The distribution counts are fist used to generate the code values without
       bit reversal. *)</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">bits</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <span class="LIDENT">_max_bits</span> <span class="DO">do</span><span class="EOL">
</span>      <a href="#local_code_612"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_612"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_bl_count_609"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_next_code_611"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_612"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="COMMENT">(* check that the bit counts in [bl_count] are consistent. The last code
         must be all ones. *)</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_code_612"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_bl_count_609"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">n</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max_code_608"><span class="LIDENT">max_code</span></a> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_613"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_tree_lengths_607"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_len_613"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="COMMENT">(* Now reverse the bits. *)</span><span class="EOL">
</span>          <a href="#local_tree_codes_610"><span class="LIDENT">tree_codes</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">reverse_code</span> <a href="#local_next_code_611"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_613"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="#local_len_613"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_next_code_611"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_613"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_next_code_611"><span class="LIDENT">next_code</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_613"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_tree_codes_610"><span class="LIDENT">tree_codes</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-generate_lengths"><span class="LIDENT">generate_lengths</span></span><span class="EOL">
</span>      <span class="TILDE">~</span><span id="local_tree_dads_614"><span class="LIDENT">tree_dads</span></span> <span class="TILDE">~</span><span id="local_tree_lengths_615"><span class="LIDENT">tree_lengths</span></span> <span class="TILDE">~</span><span id="local_max_code_616"><span class="LIDENT">max_code</span></span> <span class="TILDE">~</span><span id="local_max_length_617"><span class="LIDENT">max_length</span></span> <span id="local_heap_618"><span class="LIDENT">heap</span></span> <span class="TILDE">~</span><span id="local_bl_count_619"><span class="LIDENT">bl_count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* assert (Array.length bl_count = _max_bits + 1) ;
       assert (Array.for_all ((=) 0) bl_count) ;
    *)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* In a first pass, compute the optimal bit lengths (which may overflow in
       the case of the bit length tree). *)</span><span class="EOL">
</span>    <a href="#local_tree_lengths_615"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_618"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_618"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="COMMENT">(* root of the heap. *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_overflow_620"><span class="LIDENT">overflow</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-fill"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">fill</span></a> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="RPAREN">)</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">h</span> <span class="EQUAL">=</span> <a href="#local_heap_618"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="TO">to</span> <span class="LIDENT">_heap_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_n_621"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_heap_618"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">h</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_bits_622"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="#local_tree_lengths_615"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_tree_dads_614"><span class="LIDENT">tree_dads</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_621"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_bits_623"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_bits_622"><span class="LIDENT">bits</span></a> <span class="GREATER">&gt;</span> <a href="#local_max_length_617"><span class="LIDENT">max_length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_overflow_620"><span class="LIDENT">overflow</span></a> <span class="SEMI">;</span> <a href="#local_max_length_617"><span class="LIDENT">max_length</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_bits_622"><span class="LIDENT">bits</span></a><span class="EOL">
</span>          <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_tree_lengths_615"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_621"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bits_623"><span class="LIDENT">bits</span></a><span class="EOL">
</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_n_621"><span class="LIDENT">n</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_max_code_616"><span class="LIDENT">max_code</span></a> <span class="COMMENT">(* XXX(dinosaure): it's a leaf. *)</span> <span class="THEN">then</span><span class="EOL">
</span>              <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_bits_623"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_bits_623"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_overflow_620"><span class="LIDENT">overflow</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>          <span class="COMMENT">(* This happends for example on obj2 and pic of the
             Calgary corpus. *)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LET">let</span> <span class="REC">rec</span> <span id="local_go_624"><span class="LIDENT">go</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_bits_625"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_max_length_617"><span class="LIDENT">max_length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="WHILE">while</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_625"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_bits_625"><span class="LIDENT">bits</span></a><span class="EOL">
</span>            <span class="DONE">done</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_625"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_625"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_625"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_625"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_max_length_617"><span class="LIDENT">max_length</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_max_length_617"><span class="LIDENT">max_length</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_overflow_620"><span class="LIDENT">overflow</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_overflow_620"><span class="LIDENT">overflow</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_overflow_620"><span class="LIDENT">overflow</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_go_624"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>          <a href="#local_go_624"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_h_626"><span class="LIDENT">h</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LIDENT">_heap_size</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="FOR">for</span> <span class="LIDENT">bits</span> <span class="EQUAL">=</span> <a href="#local_max_length_617"><span class="LIDENT">max_length</span></a> <span class="DOWNTO">downto</span> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_n_627"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_bl_count_619"><span class="LIDENT">bl_count</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>              <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_627"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_h_626"><span class="LIDENT">h</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_m_628"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span> <a href="#local_heap_618"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_h_626"><span class="LIDENT">h</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                  <span class="IF">if</span> <a href="#local_m_628"><span class="LIDENT">m</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_max_code_616"><span class="LIDENT">max_code</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                    <span class="IF">if</span> <a href="#local_tree_lengths_615"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_628"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">bits</span> <span class="THEN">then</span> <a href="#local_tree_lengths_615"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_628"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">bits</span><span class="EOL">
</span>                    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_n_627"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="DONE">done</span><span class="EOL">
</span>            <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-T.type-tree"><span class="TYPE">type</span> <span class="LIDENT">tree</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1539"><span class="LIDENT">lengths</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="SEMI">;</span></span> <span id="def_1607"><span class="LIDENT">max_code</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1502"><span class="LIDENT">tree</span><span class="COLON">:</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-make"><span class="LIDENT">make</span></span> <span class="TILDE">~</span><span id="local_length_629"><span class="LIDENT">length</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_max_length_630"><span class="LIDENT">max_length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <span id="local_freqs_631"><span class="LIDENT">freqs</span></span> <span class="TILDE">~</span><span id="local_bl_count_632"><span class="LIDENT">bl_count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_heap_633"><span class="LIDENT">heap</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">make</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_depth_634"><span class="LIDENT">depth</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">_l_codes</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tree_dads_635"><span class="LIDENT">tree_dads</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_heap_size</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tree_lengths_636"><span class="LIDENT">tree_lengths</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_heap_size</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_code_637"><span class="LIDENT">max_code</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">populate</span> <span class="TILDE">~</span><a href="#local_length_629"><span class="LIDENT">length</span></a> <span class="TILDE">~</span><a href="#local_freqs_631"><span class="LIDENT">freqs</span></a> <span class="TILDE">~</span><a href="#local_depth_634"><span class="LIDENT">depth</span></a> <a href="#local_tree_lengths_636"><span class="LIDENT">tree_lengths</span></a> <a href="#local_heap_633"><span class="LIDENT">heap</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_code_638"><span class="LIDENT">max_code</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">pkzip</span> <a href="#local_max_code_637"><span class="LIDENT">max_code</span></a> <span class="TILDE">~</span><a href="#local_freqs_631"><span class="LIDENT">freqs</span></a> <span class="TILDE">~</span><a href="#local_depth_634"><span class="LIDENT">depth</span></a> <a href="#local_heap_633"><span class="LIDENT">heap</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">n</span> <span class="EQUAL">=</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">2</span> <span class="DOWNTO">downto</span> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">pqdownheap</span> <span class="TILDE">~</span><a href="#local_freqs_631"><span class="LIDENT">freqs</span></a> <span class="TILDE">~</span><a href="#local_depth_634"><span class="LIDENT">depth</span></a> <a href="#local_heap_633"><span class="LIDENT">heap</span></a> <span class="LIDENT">n</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_node_639"><span class="LIDENT">node</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_length_629"><span class="LIDENT">length</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_go_640"><span class="LIDENT">go</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_n_641"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">pqremove</span> <span class="TILDE">~</span><a href="#local_freqs_631"><span class="LIDENT">freqs</span></a> <span class="TILDE">~</span><a href="#local_depth_634"><span class="LIDENT">depth</span></a> <a href="#local_heap_633"><span class="LIDENT">heap</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_m_642"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_smallest</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_641"><span class="LIDENT">n</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_m_642"><span class="LIDENT">m</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_freqs_631"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_node_639"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_freqs_631"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_641"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_freqs_631"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_642"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_depth_634"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_node_639"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_depth_634"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_641"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_depth_634"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_642"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_depth_634"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_641"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_depth_634"><span class="LIDENT">depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_642"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_tree_dads_635"><span class="LIDENT">tree_dads</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_n_641"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_node_639"><span class="LIDENT">node</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_tree_dads_635"><span class="LIDENT">tree_dads</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_m_642"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_node_639"><span class="LIDENT">node</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_smallest</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_node_639"><span class="LIDENT">node</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_node_639"><span class="LIDENT">node</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Heap</span><span class="DOT">.</span><span class="LIDENT">pqdownheap</span> <span class="TILDE">~</span><a href="#local_freqs_631"><span class="LIDENT">freqs</span></a> <span class="TILDE">~</span><a href="#local_depth_634"><span class="LIDENT">depth</span></a> <a href="#local_heap_633"><span class="LIDENT">heap</span></a> <span class="LIDENT">_smallest</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">len</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">2</span> <span class="THEN">then</span> <a href="#local_go_640"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">max</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="DOT">.</span><span class="LIDENT">heap</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_smallest</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <a href="#local_go_640"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">generate_lengths</span> <span class="TILDE">~</span><a href="#local_tree_dads_635"><span class="LIDENT">tree_dads</span></a> <span class="TILDE">~</span><a href="#local_tree_lengths_636"><span class="LIDENT">tree_lengths</span></a> <span class="TILDE">~</span><a href="#local_max_code_638"><span class="LIDENT">max_code</span></a> <span class="TILDE">~</span><a href="#local_max_length_630"><span class="LIDENT">max_length</span></a> <a href="#local_heap_633"><span class="LIDENT">heap</span></a><span class="EOL">
</span>          <span class="TILDE">~</span><a href="#local_bl_count_632"><span class="LIDENT">bl_count</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_tree_codes_643"><span class="LIDENT">tree_codes</span></span> <span class="EQUAL">=</span> <span class="LIDENT">generate_codes</span> <span class="TILDE">~</span><a href="#local_tree_lengths_636"><span class="LIDENT">tree_lengths</span></a> <span class="TILDE">~</span><a href="#local_max_code_638"><span class="LIDENT">max_code</span></a> <span class="TILDE">~</span><a href="#local_bl_count_632"><span class="LIDENT">bl_count</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_length_644"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_tree_645"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-map2"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">map2</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_len_646"><span class="LIDENT">len</span></span> <span id="local_code_647"><span class="LIDENT">code</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <a href="#local_length_644"><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_length_644"><span class="LIDENT">length</span></a> <a href="#local_len_646"><span class="LIDENT">len</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LPAREN">(</span><a href="#local_len_646"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_code_647"><span class="LIDENT">code</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="#local_tree_lengths_636"><span class="LIDENT">tree_lengths</span></a> <a href="#local_tree_codes_643"><span class="LIDENT">tree_codes</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LBRACE">{</span><span class="EOL">
</span>          <span class="LIDENT">lengths</span><span class="EQUAL">=</span> <a href="#local_tree_lengths_636"><span class="LIDENT">tree_lengths</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_max_code_638"><span class="LIDENT">max_code</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">tree</span><span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EQUAL">=</span> <a href="#local_tree_645"><span class="LIDENT">tree</span></a><span class="SEMI">;</span> <span class="LIDENT">m</span><span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_length_644"><span class="LIDENT">length</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="SEMI">;</span> <span class="LIDENT">l</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_length_644"><span class="LIDENT">length</span></a><span class="RBRACE">}</span><span class="EOL">
</span>        <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-scan"><span class="LIDENT">scan</span></span> <span id="local_tree_lengths_648"><span class="LIDENT">tree_lengths</span></span> <span id="local_max_code_649"><span class="LIDENT">max_code</span></span> <span class="TILDE">~</span><span id="local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prevlen_651"><span class="LIDENT">prevlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="MINUS">-</span><span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nextlen_652"><span class="LIDENT">nextlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_tree_lengths_648"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_curlen_653"><span class="LIDENT">curlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_count_654"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_count_655"><span class="LIDENT">max_count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">7</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_min_count_656"><span class="LIDENT">min_count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1493"><span class="UIDENT">Continue</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_max_count_655"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">138</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_min_count_656"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_tree_lengths_648"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_max_code_649"><span class="LIDENT">max_code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0xffff</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">n</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max_code_649"><span class="LIDENT">max_code</span></a> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_curlen_653"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_tree_lengths_648"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_count_654"><span class="LIDENT">count</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="TRY">try</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_654"><span class="LIDENT">count</span></a> <span class="LESS">&lt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_count_655"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a> <span class="THEN">then</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Continue</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_654"><span class="LIDENT">count</span></a> <span class="LESS">&lt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_min_count_656"><span class="LIDENT">min_count</span></a> <span class="THEN">then</span><span class="EOL">
</span>              <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_654"><span class="LIDENT">count</span></a><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_prevlen_651"><span class="LIDENT">prevlen</span></a> <span class="THEN">then</span><span class="EOL">
</span>                <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_rep_3_6</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_rep_3_6</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_654"><span class="LIDENT">count</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">10</span> <span class="THEN">then</span><span class="EOL">
</span>              <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_repz_3_10</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_repz_3_10</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="ELSE">else</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_repz_11_138</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_bl_freqs_650"><span class="LIDENT">bl_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_repz_11_138</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_count_654"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">0</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_prevlen_651"><span class="LIDENT">prevlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_max_count_655"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">138</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_min_count_656"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_653"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_652"><span class="LIDENT">nextlen</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_max_count_655"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">6</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_min_count_656"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_max_count_655"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">7</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_min_count_656"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="WITH">with</span> <span class="UIDENT">Continue</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-code"><span class="LIDENT">code</span></span> <span id="local_code_657"><span class="LIDENT">code</span></span> <span id="local_lookup_658"><span class="LIDENT">lookup</span></span> <span class="EQUAL">=</span> <a href="#local_lookup_658"><span class="LIDENT">lookup</span></a><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_code_657"><span class="LIDENT">code</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-bits"><span class="LIDENT">bits</span></span> <span id="local_code_659"><span class="LIDENT">code</span></span> <span id="local_len_660"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len_660"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_code_659"><span class="LIDENT">code</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-symbols"><span class="LIDENT">symbols</span></span> <span id="local_i_661"><span class="LIDENT">i</span></span> <span id="local_tree_lengths_662"><span class="LIDENT">tree_lengths</span></span> <span id="local_max_code_663"><span class="LIDENT">max_code</span></span> <span class="TILDE">~</span><span id="local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></span> <span class="TILDE">~</span><span id="local_bltree_665"><span class="LIDENT">bltree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_666"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_i_661"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prevlen_667"><span class="LIDENT">prevlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="MINUS">-</span><span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nextlen_668"><span class="LIDENT">nextlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_tree_lengths_662"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_curlen_669"><span class="LIDENT">curlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_count_670"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_count_671"><span class="LIDENT">max_count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">7</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_min_count_672"><span class="LIDENT">min_count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1530"><span class="UIDENT">Continue</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_max_count_671"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">138</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_min_count_672"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">n</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max_code_663"><span class="LIDENT">max_code</span></a> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_tree_lengths_662"><span class="LIDENT">tree_lengths</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">n</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_count_670"><span class="LIDENT">count</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="TRY">try</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <span class="LESS">&lt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_count_671"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a> <span class="THEN">then</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Continue</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <span class="LESS">&lt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_min_count_672"><span class="LIDENT">min_count</span></a> <span class="THEN">then</span><span class="EOL">
</span>              <span class="WHILE">while</span><span class="EOL">
</span>                <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">code</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="#local_bltree_665"><span class="LIDENT">bltree</span></a><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_count_670"><span class="LIDENT">count</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>              <span class="DO">do</span><span class="EOL">
</span>                <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="DONE">done</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_prevlen_667"><span class="LIDENT">prevlen</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">code</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="#local_bltree_665"><span class="LIDENT">bltree</span></a><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_count_670"><span class="LIDENT">count</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">code</span> <span class="LIDENT">_rep_3_6</span> <a href="#local_bltree_665"><span class="LIDENT">bltree</span></a><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">bits</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="INT">2</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">10</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">code</span> <span class="LIDENT">_repz_3_10</span> <a href="#local_bltree_665"><span class="LIDENT">bltree</span></a><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">bits</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="INT">3</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">code</span> <span class="LIDENT">_repz_11_138</span> <a href="#local_bltree_665"><span class="LIDENT">bltree</span></a><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_bl_symbols_664"><span class="LIDENT">bl_symbols</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">bits</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_670"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">11</span><span class="RPAREN">)</span> <span class="INT">7</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_666"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_count_670"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">0</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_prevlen_667"><span class="LIDENT">prevlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_max_count_671"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">138</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_min_count_672"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_curlen_669"><span class="LIDENT">curlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nextlen_668"><span class="LIDENT">nextlen</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_max_count_671"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">6</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_min_count_672"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_max_count_671"><span class="LIDENT">max_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">7</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_min_count_672"><span class="LIDENT">min_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="WITH">with</span> <span class="UIDENT">Continue</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_666"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Queue"><span class="MODULE">module</span> <span class="UIDENT">Queue</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Queue.type-cmd"><span class="TYPE">type</span> <span class="LIDENT">cmd</span> <span class="EQUAL">=</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span id="module-Queue.type-buf"><span class="TYPE">type</span> <span class="LIDENT">buf</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.type-t"><span class="LPAREN">(</span><span class="LIDENT">cmd</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#type-int_elt"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">int_elt</span></a><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#type-c_layout"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">c_layout</span></a><span class="RPAREN">)</span> <span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span>  <span id="module-Queue.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1585"><span class="LIDENT">buf</span><span class="COLON">:</span> <span class="LIDENT">buf</span><span class="SEMI">;</span></span> <span id="def_1610"><span class="MUTABLE">mutable</span> <span class="LIDENT">w</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1568"><span class="MUTABLE">mutable</span> <span class="LIDENT">r</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1429"><span class="MUTABLE">mutable</span> <span class="LIDENT">c</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-mask"><span class="LIDENT">mask</span></span> <span id="local_t_673"><span class="LIDENT">t</span></span> <span id="local_v_674"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_v_674"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><a href="#local_t_673"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-empty"><span class="LIDENT">empty</span></span> <span id="local_t_675"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_675"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_t_675"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-size"><span class="LIDENT">size</span></span> <span id="local_t_676"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_676"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_t_676"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-available"><span class="LIDENT">available</span></span> <span id="local_t_677"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_677"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_t_677"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_t_677"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-full"><span class="LIDENT">full</span></span> <span id="local_t_678"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">size</span> <a href="#local_t_678"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_t_678"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">c</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-length"><span class="LIDENT">length</span></span> <span id="local_t_679"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">size</span> <a href="#local_t_679"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-is_empty"><span class="LIDENT">is_empty</span></span> <span id="local_t_680"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">empty</span> <a href="#local_t_680"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-is_full"><span class="LIDENT">is_full</span></span> <span id="local_t_681"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LIDENT">full</span> <a href="#local_t_681"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Queue.val-unsafe_get"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get</span> <span class="COLON">:</span> <span class="LIDENT">buf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_ba_ref_1&quot;</span></span><span class="EOL">
</span>  <span id="module-Queue.val-unsafe_set"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set</span> <span class="COLON">:</span> <span class="LIDENT">buf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_ba_set_1&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Queue.exception-Full"><span class="EXCEPTION">exception</span> <span class="UIDENT">Full</span></span><span class="EOL">
</span>  <span id="module-Queue.exception-Empty"><span class="EXCEPTION">exception</span> <span class="UIDENT">Empty</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-push_exn"><span class="LIDENT">push_exn</span></span> <span id="local_t_682"><span class="LIDENT">t</span></span> <span id="local_v_683"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LPAREN">(</span><span class="LIDENT">full</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_682"><span class="LIDENT">t</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Full</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_t_682"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">mask</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_682"><span class="LIDENT">t</span></a> <a href="#local_t_682"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="RPAREN">)</span> <a href="#local_v_683"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_682"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_682"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-end_with_eob"><span class="LIDENT">end_with_eob</span></span> <span id="local_t_684"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">empty</span> <a href="#local_t_684"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_get</span> <a href="#local_t_684"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">mask</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_684"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="#local_t_684"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-rem_exn"><span class="LIDENT">rem_exn</span></span> <span id="local_t_685"><span class="LIDENT">t</span></span> <span id="local_n_686"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">size</span> <a href="#local_t_685"><span class="LIDENT">t</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_n_686"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <a href="#local_t_685"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_685"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_n_686"><span class="LIDENT">n</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;You requested too many commands to delete&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-pop_exn"><span class="LIDENT">pop_exn</span></span> <span id="local_t_687"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LPAREN">(</span><span class="LIDENT">empty</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_687"><span class="LIDENT">t</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Empty</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_r_688"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_687"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">mask</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_687"><span class="LIDENT">t</span></a> <a href="#local_t_687"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_t_687"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_687"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_r_688"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-peek_exn"><span class="LIDENT">peek_exn</span></span> <span id="local_t_689"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LPAREN">(</span><span class="LIDENT">empty</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_689"><span class="LIDENT">t</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Empty</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">unsafe_get</span> <a href="#local_t_689"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">mask</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_689"><span class="LIDENT">t</span></a> <a href="#local_t_689"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-unsafe_junk"><span class="LIDENT">unsafe_junk</span></span> <span id="local_t_690"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_690"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_690"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-junk_exn"><span class="LIDENT">junk_exn</span></span> <span id="local_t_691"><span class="LIDENT">t</span></span> <span id="local_n_692"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LPAREN">(</span><span class="LIDENT">size</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">inlined</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_691"><span class="LIDENT">t</span></a> <span class="LESS">&lt;</span> <a href="#local_n_692"><span class="LIDENT">n</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;You want to junk more than what we have&quot;</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_691"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_691"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_n_692"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-copy"><span class="LIDENT">copy</span></span> <span class="TILDE">~</span><span id="local_off_693"><span class="LIDENT">off</span></span> <span class="TILDE">~</span><span id="local_len_694"><span class="LIDENT">len</span></span> <span class="COLON">:</span> <span class="LIDENT">cmd</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_len_694"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_len_694"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">255</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_off_693"><span class="LIDENT">off</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_off_693"><span class="LIDENT">off</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">32767</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_len_694"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">16</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_off_693"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="INT">0x2000000</span><span class="EOL">
</span>    <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-literal"><span class="LIDENT">literal</span></span> <span id="local_chr_695"><span class="LIDENT">chr</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_chr_695"><span class="LIDENT">chr</span></a> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-eob"><span class="LIDENT">eob</span></span> <span class="EQUAL">=</span> <span class="INT">256</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-cmd"><span class="LIDENT">cmd</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Literal</span> <span id="local_chr_696"><span class="LIDENT">chr</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">literal</span> <a href="#local_chr_696"><span class="LIDENT">chr</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="LPAREN">(</span><span id="local_off_697"><span class="LIDENT">off</span></span><span class="COMMA">,</span> <span id="local_len_698"><span class="LIDENT">len</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">copy</span> <span class="TILDE">~</span><a href="#local_off_697"><span class="LIDENT">off</span></a> <span class="TILDE">~</span><a href="#local_len_698"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">256</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-code"><span class="LIDENT">code</span></span> <span id="local_cmd_699"><span class="LIDENT">cmd</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_cmd_699"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x2000000</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_cmd_699"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span> <span class="THEN">then</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="ELSE">else</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Literal</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-chr"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">chr</span></a> <span class="LPAREN">(</span><a href="#local_cmd_699"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_off_700"><span class="LIDENT">off</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_cmd_699"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len_701"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_cmd_699"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1ff</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* XXX(dinosaure): ((1 lsl 9) - 1) - 0xff *)</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="LPAREN">(</span><a href="#local_off_700"><span class="LIDENT">off</span></a><span class="COMMA">,</span> <a href="#local_len_701"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-blit"><span class="LIDENT">blit</span></span> <span id="local_t_702"><span class="LIDENT">t</span></span> <span id="local_buf_703"><span class="LIDENT">buf</span></span> <span id="local_off_704"><span class="LIDENT">off</span></span> <span id="local_len_705"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">available</span> <a href="#local_t_702"><span class="LIDENT">t</span></a> <span class="LESS">&lt;</span> <a href="#local_len_705"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Full</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_msk_706"><span class="LIDENT">msk</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mask</span> <a href="#local_t_702"><span class="LIDENT">t</span></a> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_pre_707"><span class="LIDENT">pre</span></span> <span class="EQUAL">=</span> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_msk_706"><span class="LIDENT">msk</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_rst_708"><span class="LIDENT">rst</span></span> <span class="EQUAL">=</span> <a href="#local_len_705"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pre_707"><span class="LIDENT">pre</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_rst_708"><span class="LIDENT">rst</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_pre_707"><span class="LIDENT">pre</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LPAREN">(</span><a href="#local_msk_706"><span class="LIDENT">msk</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_buf_703"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_off_704"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_rst_708"><span class="LIDENT">rst</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>            <span class="LIDENT">unsafe_set</span> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LIDENT">i</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_buf_703"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_off_704"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_pre_707"><span class="LIDENT">pre</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_705"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LPAREN">(</span><a href="#local_msk_706"><span class="LIDENT">msk</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_buf_703"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_off_704"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_t_702"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_705"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-create"><span class="LIDENT">create</span></span> <span id="local_length_709"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_power_of_two</span> <a href="#local_length_709"><span class="LIDENT">length</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;Length of queue MUST be a power of two&quot;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span class="LIDENT">buf</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-create"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-int"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">int</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-c_layout"><span class="UIDENT">Bigarray</span><span class="DOT">.</span><span class="LIDENT">c_layout</span></a> <a href="#local_length_709"><span class="LIDENT">length</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">w</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">r</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">c</span><span class="EQUAL">=</span> <a href="#local_length_709"><span class="LIDENT">length</span></a><span class="EOL">
</span>      <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-reset"><span class="LIDENT">reset</span></span> <span id="local_t_710"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_t_710"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_t_710"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-to_list"><span class="LIDENT">to_list</span></span> <span id="local_t_711"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_712"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_713"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">size</span> <a href="#local_t_711"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_msk_714"><span class="LIDENT">msk</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mask</span> <a href="#local_t_711"><span class="LIDENT">t</span></a> <a href="#local_t_711"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">r</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pre_715"><span class="LIDENT">pre</span></span> <span class="EQUAL">=</span> <a href="#local_t_711"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">c</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_msk_714"><span class="LIDENT">msk</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rst_716"><span class="LIDENT">rst</span></span> <span class="EQUAL">=</span> <a href="#local_len_713"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pre_715"><span class="LIDENT">pre</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rst_716"><span class="LIDENT">rst</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_pre_715"><span class="LIDENT">pre</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_res_712"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">code</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_711"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_712"><span class="LIDENT">res</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_rst_716"><span class="LIDENT">rst</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_res_712"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">code</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_711"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_712"><span class="LIDENT">res</span></a><span class="EOL">
</span>        <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_713"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_res_712"><span class="LIDENT">res</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">code</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_t_711"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">buf</span> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_712"><span class="LIDENT">res</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_res_712"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-(&lt;.&gt;)"><span class="LPAREN">(</span> <span class="INFIXOP0">&lt;.&gt;</span> <span class="RPAREN">)</span></span> <span id="local_f_717"><span class="LIDENT">f</span></span> <span id="local_g_718"><span class="LIDENT">g</span></span> <span id="local_x_719"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_f_717"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><a href="#local_g_718"><span class="LIDENT">g</span></a> <a href="#local_x_719"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Queue.val-of_list"><span class="LIDENT">of_list</span></span> <span id="local_lst_720"><span class="LIDENT">lst</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_q_721"><span class="LIDENT">q</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="LIDENT">to_power_of_two</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-length"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_lst_720"><span class="LIDENT">lst</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">push_exn</span> <a href="#local_q_721"><span class="LIDENT">q</span></a> <span class="INFIXOP0">&lt;.&gt;</span> <span class="LIDENT">cmd</span><span class="RPAREN">)</span> <a href="#local_lst_720"><span class="LIDENT">lst</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_q_721"><span class="LIDENT">q</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-literals"><span class="TYPE">type</span> <span class="LIDENT">literals</span> <span class="EQUAL">=</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span></span><span class="EOL">
</span><span id="type-distances"><span class="TYPE">type</span> <span class="LIDENT">distances</span> <span class="EQUAL">=</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_literals"><span class="LIDENT">make_literals</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_722"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">_l_codes</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_res_722"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span> <span class="SEMI">;</span> <a href="#local_res_722"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-succ_literal"><span class="LIDENT">succ_literal</span></span> <span id="local_literals_723"><span class="LIDENT">literals</span></span> <span id="local_chr_724"><span class="LIDENT">chr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_literals_723"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_chr_724"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_literals_723"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_chr_724"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-succ_length"><span class="LIDENT">succ_length</span></span> <span id="local_literals_725"><span class="LIDENT">literals</span></span> <span id="local_length_726"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_length_726"><span class="LIDENT">length</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_length_726"><span class="LIDENT">length</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">255</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_literals_725"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_726"><span class="LIDENT">length</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>      <a href="#local_literals_725"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_726"><span class="LIDENT">length</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_distances"><span class="LIDENT">make_distances</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">_d_codes</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-succ_distance"><span class="LIDENT">succ_distance</span></span> <span id="local_distances_727"><span class="LIDENT">distances</span></span> <span id="local_distance_728"><span class="LIDENT">distance</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_distance_728"><span class="LIDENT">distance</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_distance_728"><span class="LIDENT">distance</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">32767</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMI">;</span> <a href="#local_distances_727"><span class="LIDENT">distances</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_distance</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <a href="#local_distance_728"><span class="LIDENT">distance</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>      <a href="#local_distances_727"><span class="LIDENT">distances</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_distance</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <a href="#local_distance_728"><span class="LIDENT">distance</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* XXX placeholder for me to find myself XXX*)</span><span class="EOL">
</span><span id="module-Def"><span class="MODULE">module</span> <span class="UIDENT">Def</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Def.type-dst"><span class="TYPE">type</span> <span class="LIDENT">dst</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="OF">of</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-out_channel"><span class="LIDENT">out_channel</span></a> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Buffer</span> <span class="OF">of</span> <a href="../../../ocaml-base-compiler/src/stdlib/buffer.ml.html#type-t"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Def.type-dynamic"><span class="TYPE">type</span> <span class="LIDENT">dynamic</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>      <span id="def_1582"><span class="LIDENT">ltree</span><span class="COLON">:</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1587"><span class="LIDENT">dtree</span><span class="COLON">:</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1576"><span class="LIDENT">bltree</span><span class="COLON">:</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1604"><span class="LIDENT">h_lit</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1514"><span class="LIDENT">h_dst</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1431"><span class="LIDENT">h_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1605"><span class="LIDENT">symbols</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-bl_tree"><span class="LIDENT">bl_tree</span></span> <span id="local_ltree_729"><span class="LIDENT">ltree</span></span> <span id="local_dtree_730"><span class="LIDENT">dtree</span></span> <span class="TILDE">~</span><span id="local_bl_count_731"><span class="LIDENT">bl_count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bl_freqs_732"><span class="LIDENT">bl_freqs</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">_bl_codes</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">scan</span> <a href="#local_ltree_729"><span class="LIDENT">ltree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">lengths</span> <a href="#local_ltree_729"><span class="LIDENT">ltree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">max_code</span> <span class="TILDE">~</span><a href="#local_bl_freqs_732"><span class="LIDENT">bl_freqs</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">scan</span> <a href="#local_dtree_730"><span class="LIDENT">dtree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">lengths</span> <a href="#local_dtree_730"><span class="LIDENT">dtree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">max_code</span> <span class="TILDE">~</span><a href="#local_bl_freqs_732"><span class="LIDENT">bl_freqs</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_bltree_733"><span class="LIDENT">bltree</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">make</span> <span class="LABEL">~length:</span><span class="LIDENT">_bl_codes</span> <span class="LABEL">~max_length:</span><span class="INT">7</span> <a href="#local_bl_freqs_732"><span class="LIDENT">bl_freqs</span></a> <span class="TILDE">~</span><a href="#local_bl_count_731"><span class="LIDENT">bl_count</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* XXX(dinosaure): [T.make] needs [max_length] to avoid generation of a bad
         bltree (limited to 7 bits with extra). *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_max_blindex_734"><span class="LIDENT">max_blindex</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">_bl_codes</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1577"><span class="UIDENT">Break</span></span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="TRY">try</span><span class="EOL">
</span>         <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_blindex_734"><span class="LIDENT">max_blindex</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">3</span> <span class="DO">do</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="#local_bltree_733"><span class="LIDENT">bltree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">lengths</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">zigzag</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_blindex_734"><span class="LIDENT">max_blindex</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>             <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Break</span><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_max_blindex_734"><span class="LIDENT">max_blindex</span></a><span class="EOL">
</span>         <span class="DONE">done</span><span class="EOL">
</span>       <span class="WITH">with</span> <span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_max_blindex_734"><span class="LIDENT">max_blindex</span></a><span class="COMMA">,</span> <a href="#local_bltree_733"><span class="LIDENT">bltree</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-dynamic_of_frequencies"><span class="LIDENT">dynamic_of_frequencies</span></span> <span class="COLON">:</span><span class="EOL">
</span>      <span class="LIDENT">literals</span><span class="COLON">:</span><span class="LIDENT">int</span> <span class="LIDENT">array</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">distances</span><span class="COLON">:</span><span class="LIDENT">int</span> <span class="LIDENT">array</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dynamic</span> <span class="EQUAL">=</span><span class="EOL">
</span>   <span class="FUN">fun</span> <span class="LABEL">~literals:</span><span id="local_lit_freqs_735"><span class="LIDENT">lit_freqs</span></span> <span class="LABEL">~distances:</span><span id="local_dst_freqs_736"><span class="LIDENT">dst_freqs</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bl_count_737"><span class="LIDENT">bl_count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ltree_738"><span class="LIDENT">ltree</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">make</span> <span class="LABEL">~length:</span><span class="LIDENT">_l_codes</span> <a href="#local_lit_freqs_735"><span class="LIDENT">lit_freqs</span></a> <span class="TILDE">~</span><a href="#local_bl_count_737"><span class="LIDENT">bl_count</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dtree_739"><span class="LIDENT">dtree</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">make</span> <span class="LABEL">~length:</span><span class="LIDENT">_d_codes</span> <a href="#local_dst_freqs_736"><span class="LIDENT">dst_freqs</span></a> <span class="TILDE">~</span><a href="#local_bl_count_737"><span class="LIDENT">bl_count</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1510"><span id="local_max_blindex_740"><span class="LIDENT">max_blindex</span></span><span class="COMMA">,</span> <span id="local_bltree_741"><span class="LIDENT">bltree</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">bl_tree</span> <a href="#local_ltree_738"><span class="LIDENT">ltree</span></a> <a href="#local_dtree_739"><span class="LIDENT">dtree</span></a> <span class="TILDE">~</span><a href="#local_bl_count_737"><span class="LIDENT">bl_count</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bl_symbols_742"><span class="LIDENT">bl_symbols</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_l_codes</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_d_codes</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_743"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">symbols</span> <span class="INT">0</span> <a href="#local_ltree_738"><span class="LIDENT">ltree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">lengths</span> <a href="#local_ltree_738"><span class="LIDENT">ltree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">max_code</span> <span class="TILDE">~</span><a href="#local_bltree_741"><span class="LIDENT">bltree</span></a> <span class="TILDE">~</span><a href="#local_bl_symbols_742"><span class="LIDENT">bl_symbols</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_744"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">symbols</span> <a href="#local_i_743"><span class="LIDENT">i</span></a> <a href="#local_dtree_739"><span class="LIDENT">dtree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">lengths</span> <a href="#local_dtree_739"><span class="LIDENT">dtree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">max_code</span> <span class="TILDE">~</span><a href="#local_bltree_741"><span class="LIDENT">bltree</span></a> <span class="TILDE">~</span><a href="#local_bl_symbols_742"><span class="LIDENT">bl_symbols</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bl_symbols_745"><span class="LIDENT">bl_symbols</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-sub"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_bl_symbols_742"><span class="LIDENT">bl_symbols</span></a> <span class="INT">0</span> <a href="#local_i_744"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <span class="LIDENT">h_lit</span><span class="EQUAL">=</span> <a href="#local_ltree_738"><span class="LIDENT">ltree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">max_code</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">h_dst</span><span class="EQUAL">=</span> <a href="#local_dtree_739"><span class="LIDENT">dtree</span></a><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">max_code</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">h_len</span><span class="EQUAL">=</span> <a href="#local_max_blindex_740"><span class="LIDENT">max_blindex</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_bltree_741"><span class="LIDENT">bltree</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_ltree_738"><span class="LIDENT">ltree</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_dtree_739"><span class="LIDENT">dtree</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">symbols</span><span class="EQUAL">=</span> <a href="#local_bl_symbols_745"><span class="LIDENT">bl_symbols</span></a><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-invalid_encode"><span class="LIDENT">invalid_encode</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;expected `Await encode&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Def.type-kind"><span class="TYPE">type</span> <span class="LIDENT">kind</span> <span class="EQUAL">=</span> <span id="module-Def.type-kind.constructor-Flat"><span class="UIDENT">Flat</span></span> <span id="module-Def.type-kind.constructor-Fixed"><span class="BAR">|</span> <span class="UIDENT">Fixed</span></span> <span id="module-Def.type-kind.constructor-Dynamic"><span class="BAR">|</span> <span class="UIDENT">Dynamic</span> <span class="OF">of</span> <span class="LIDENT">dynamic</span></span></span><span class="EOL">
</span>  <span id="module-Def.type-block"><span class="TYPE">type</span> <span class="LIDENT">block</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1595"><span class="LIDENT">kind</span><span class="COLON">:</span> <span class="LIDENT">kind</span><span class="SEMI">;</span></span> <span id="def_1443"><span class="LIDENT">last</span><span class="COLON">:</span> <span class="LIDENT">bool</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span>  <span id="module-Def.type-encode"><span class="TYPE">type</span> <span class="LIDENT">encode</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="OF">of</span> <span class="LIDENT">block</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-exists"><span class="LIDENT">exists</span></span> <span id="local_v_746"><span class="LIDENT">v</span></span> <span id="local_block_747"><span class="LIDENT">block</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_v_746"><span class="LIDENT">v</span></a><span class="COMMA">,</span> <a href="#local_block_747"><span class="LIDENT">block</span></a><span class="DOT">.</span><span class="LIDENT">kind</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Flat</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;copy code in flat block can not exist&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Literal</span> <span id="local_chr_748"><span class="LIDENT">chr</span></span><span class="COMMA">,</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_749"><span class="LIDENT">dynamic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_dynamic_749"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">ltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_chr_748"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_max_bits</span> <span class="GREATER">&gt;</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="LPAREN">(</span><span id="local_off_750"><span class="LIDENT">off</span></span><span class="COMMA">,</span> <span id="local_len_751"><span class="LIDENT">len</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_752"><span class="LIDENT">dynamic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="COMMENT">(* assert (len &gt;= 3 &amp;&amp; len &lt;= 255 + 3) ; *)</span><span class="EOL">
</span>      <span class="COMMENT">(* assert (off &gt;= 1 &amp;&amp; off &lt;= 32767 + 1) ; *)</span><span class="EOL">
</span>      <a href="#local_dynamic_752"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">ltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_751"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_max_bits</span> <span class="GREATER">&gt;</span> <span class="INT">0</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_dynamic_752"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">dtree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="DOT">.</span><span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_distance</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <a href="#local_off_750"><span class="LIDENT">off</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_max_bits</span> <span class="GREATER">&gt;</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Fixed</span> <span class="BAR">|</span> <span class="UIDENT">Dynamic</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Literal</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Flat</span> <span class="BAR">|</span> <span class="UIDENT">Fixed</span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Fixed</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="TRUE">true</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Def.type-encoder"><span class="TYPE">type</span> <span class="LIDENT">encoder</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>      <span id="def_1535"><span class="LIDENT">dst</span><span class="COLON">:</span> <span class="LIDENT">dst</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1509"><span class="MUTABLE">mutable</span> <span class="LIDENT">blk</span><span class="COLON">:</span> <span class="LIDENT">block</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1578"><span class="MUTABLE">mutable</span> <span class="LIDENT">hold</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1478"><span class="MUTABLE">mutable</span> <span class="LIDENT">bits</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1450"><span class="MUTABLE">mutable</span> <span class="LIDENT">bits_rem</span><span class="COLON">:</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Rem</span> <span class="OF">of</span> <span class="LIDENT">int</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Pending</span> <span class="RBRACKET">]</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1558"><span class="MUTABLE">mutable</span> <span class="LIDENT">flat</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1565"><span class="MUTABLE">mutable</span> <span class="LIDENT">fmax</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1609"><span class="MUTABLE">mutable</span> <span class="LIDENT">o</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1513"><span class="MUTABLE">mutable</span> <span class="LIDENT">o_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1452"><span class="MUTABLE">mutable</span> <span class="LIDENT">o_max</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1466"><span class="LIDENT">b</span><span class="COLON">:</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1556"><span class="MUTABLE">mutable</span> <span class="LIDENT">k</span><span class="COLON">:</span> <span class="LIDENT">encoder</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">encode</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Partial</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* remaining bytes to write in [e.o]. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-o_rem"><span class="LIDENT">o_rem</span></span> <span id="local_e_753"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <a href="#local_e_753"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_e_753"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* set [e.o] with [s]. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-dst"><span class="LIDENT">dst</span></span> <span id="local_e_754"><span class="LIDENT">e</span></span> <span id="local_s_755"><span class="LIDENT">s</span></span> <span id="local_j_756"><span class="LIDENT">j</span></span> <span id="local_l_757"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_j_756"><span class="LIDENT">j</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_l_757"><span class="LIDENT">l</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_j_756"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_757"><span class="LIDENT">l</span></a> <span class="GREATER">&gt;</span> <span class="LIDENT">bigstring_length</span> <a href="#local_s_755"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <span class="LIDENT">invalid_bounds</span> <a href="#local_j_756"><span class="LIDENT">j</span></a> <a href="#local_l_757"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_e_754"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_755"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_e_754"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_756"><span class="LIDENT">j</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_e_754"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_756"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_757"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-partial"><span class="LIDENT">partial</span></span> <span id="local_k_758"><span class="LIDENT">k</span></span> <span id="local_e_759"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_k_758"><span class="LIDENT">k</span></a> <a href="#local_e_759"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="COMMENT">(* if [encode] returns [`Partial], end-user must call [encode] with
       [`Await] value. Otherwise, it's a bad logic. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Literal</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">invalid_encode</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-flush"><span class="LIDENT">flush</span></span> <span id="local_k_760"><span class="LIDENT">k</span></span> <span id="local_e_761"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">dst</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">partial</span> <a href="#local_k_760"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Partial</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span id="local_oc_762"><span class="LIDENT">oc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">output_bigstring</span> <a href="#local_oc_762"><span class="LIDENT">oc</span></a> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="INT">0</span> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_760"><span class="LIDENT">k</span></a> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Buffer</span> <span id="local_b_763"><span class="LIDENT">b</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/buffer.ml.html#val-add_char"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_char</span></a> <a href="#local_b_763"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-unsafe_chr"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">unsafe_chr</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="COMMENT">(* TODO: check why we need [unsafe_chr]. *)</span><span class="EOL">
</span>        <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_760"><span class="LIDENT">k</span></a> <a href="#local_e_761"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.val-c_byte"><span class="LIDENT">c_byte</span></span> <span id="local_byte_764"><span class="LIDENT">byte</span></span> <span id="local_k_765"><span class="LIDENT">k</span></span> <span id="local_e_766"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rem_767"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">o_rem</span> <a href="#local_e_766"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rem_767"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">1</span> <span class="THEN">then</span> <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_768"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">c_byte</span> <a href="#local_byte_764"><span class="LIDENT">byte</span></a> <a href="#local_k_765"><span class="LIDENT">k</span></a> <a href="#local_e_768"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="#local_e_766"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_e_766"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_e_766"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_byte_764"><span class="LIDENT">byte</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_766"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_766"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_765"><span class="LIDENT">k</span></a> <a href="#local_e_766"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.val-c_short"><span class="LIDENT">c_short</span></span> <span id="local_short_769"><span class="LIDENT">short</span></span> <span id="local_k_770"><span class="LIDENT">k</span></span> <span id="local_e_771"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rem_772"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">o_rem</span> <a href="#local_e_771"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rem_772"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">2</span> <span class="THEN">then</span> <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_773"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">c_short</span> <a href="#local_short_769"><span class="LIDENT">short</span></a> <a href="#local_k_770"><span class="LIDENT">k</span></a> <a href="#local_e_773"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="#local_e_771"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_e_771"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_e_771"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_short_769"><span class="LIDENT">short</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_771"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_771"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_770"><span class="LIDENT">k</span></a> <a href="#local_e_771"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-c_bits"><span class="LIDENT">c_bits</span></span> <span id="local_bits_774"><span class="LIDENT">bits</span></span> <span id="local_long_775"><span class="LIDENT">long</span></span> <span id="local_k_776"><span class="LIDENT">k</span></span> <span id="local_e_777"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_long_775"><span class="LIDENT">long</span></a> <span class="LESS">&lt;</span> <span class="INT">16</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><a href="#local_bits_774"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_long_775"><span class="LIDENT">long</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_776"><span class="LIDENT">k</span></a> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_778"><span class="LIDENT">k</span></span> <span id="local_e_779"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_e_779"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_779"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_779"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_779"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_k_776"><span class="LIDENT">k</span></a> <a href="#local_e_779"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><a href="#local_bits_774"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_long_775"><span class="LIDENT">long</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">c_short</span> <span class="LPAREN">(</span><a href="#local_e_777"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span> <a href="#local_k_778"><span class="LIDENT">k</span></a> <a href="#local_e_777"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* encode flat *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.val-ensure"><span class="LIDENT">ensure</span></span> <span id="local_n_780"><span class="LIDENT">n</span></span> <span id="local_k_781"><span class="LIDENT">k</span></span> <span id="local_e_782"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rem_783"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">o_rem</span> <a href="#local_e_782"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rem_783"><span class="LIDENT">rem</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_n_780"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <a href="#local_k_781"><span class="LIDENT">k</span></a> <a href="#local_e_782"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="LIDENT">ensure</span> <a href="#local_n_780"><span class="LIDENT">n</span></a> <a href="#local_k_781"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <a href="#local_e_782"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-{flush_bits}10/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">flush_bits</span></span> <span id="local_k_784"><span class="LIDENT">k</span></span> <span id="local_e_785"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_e_785"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&lt;=</span> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_785"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="GREATER">&gt;</span> <span class="INT">8</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_786"><span class="LIDENT">k</span></span> <span id="local_e_787"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="#local_e_787"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_787"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_784"><span class="LIDENT">k</span></a> <a href="#local_e_787"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_short</span> <span class="LPAREN">(</span><a href="#local_e_785"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span> <a href="#local_k_786"><span class="LIDENT">k</span></a> <a href="#local_e_785"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_e_785"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_788"><span class="LIDENT">k</span></span> <span id="local_e_789"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="#local_e_789"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_789"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_784"><span class="LIDENT">k</span></a> <a href="#local_e_789"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_byte</span> <span class="LPAREN">(</span><a href="#local_e_785"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span> <a href="#local_k_788"><span class="LIDENT">k</span></a> <a href="#local_e_785"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_k_784"><span class="LIDENT">k</span></a> <a href="#local_e_785"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encode_flat_header"><span class="LIDENT">encode_flat_header</span></span> <span id="local_last_790"><span class="LIDENT">last</span></span> <span id="local_k_791"><span class="LIDENT">k</span></span> <span id="local_e_792"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k3_793"><span class="LIDENT">k3</span></span> <span id="local_e_794"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="LIDENT">o_rem</span> <a href="#local_e_794"><span class="LIDENT">e</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LPAREN">(</span><a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LPAREN">(</span><a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_794"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">flat</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): clean! *)</span><span class="EOL">
</span>        <a href="#local_k_791"><span class="LIDENT">k</span></a> <a href="#local_e_794"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k2_795"><span class="LIDENT">k2</span></span> <span id="local_e_796"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">flush_bits</span> <span class="LPAREN">(</span><span class="LIDENT">ensure</span> <span class="INT">4</span> <a href="#local_k3_793"><span class="LIDENT">k3</span></a><span class="RPAREN">)</span> <a href="#local_e_796"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k1_797"><span class="LIDENT">k1</span></span> <span id="local_e_798"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="INT">0x0</span> <span class="INT">2</span> <a href="#local_k2_795"><span class="LIDENT">k2</span></a> <a href="#local_e_798"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k0_799"><span class="LIDENT">k0</span></span> <span id="local_e_800"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_last_790"><span class="LIDENT">last</span></a> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="INT">1</span> <a href="#local_k1_797"><span class="LIDENT">k1</span></a> <a href="#local_e_800"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <a href="#local_k0_799"><span class="LIDENT">k0</span></a> <a href="#local_e_792"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* encode dynamic huffman tree *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encode_huffman"><span class="LIDENT">encode_huffman</span></span> <span id="local_dynamic_801"><span class="LIDENT">dynamic</span></span> <span id="local_k_802"><span class="LIDENT">k</span></span> <span id="local_e_803"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_flush_804"><span class="LIDENT">flush</span></span> <span id="local_e_805"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_e_805"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">16</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_806"><span class="LIDENT">k</span></span> <span id="local_e_807"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="#local_e_807"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_807"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_807"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_807"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_802"><span class="LIDENT">k</span></a> <a href="#local_e_807"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_short</span> <span class="LPAREN">(</span><a href="#local_e_805"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span> <a href="#local_k_806"><span class="LIDENT">k</span></a> <a href="#local_e_805"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_e_805"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">8</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_808"><span class="LIDENT">k</span></span> <span id="local_e_809"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="#local_e_809"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_809"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_809"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_809"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_802"><span class="LIDENT">k</span></a> <a href="#local_e_809"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_byte</span> <span class="LPAREN">(</span><a href="#local_e_805"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span> <a href="#local_k_808"><span class="LIDENT">k</span></a> <a href="#local_e_805"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_k_802"><span class="LIDENT">k</span></a> <a href="#local_e_805"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_go_810"><span class="LIDENT">go</span></span> <span id="local_rank_811"><span class="LIDENT">rank</span></span> <span id="local_e_812"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_rank_811"><span class="LIDENT">rank</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_dynamic_801"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">symbols</span> <span class="THEN">then</span> <a href="#local_flush_804"><span class="LIDENT">flush</span></a> <a href="#local_e_812"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1508"><span id="local_len_813"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_code_814"><span class="LIDENT">code</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LPAREN">(</span> <a href="#local_dynamic_801"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">symbols</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_rank_811"><span class="LIDENT">rank</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_max_bits</span><span class="EOL">
</span>          <span class="COMMA">,</span> <a href="#local_dynamic_801"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">symbols</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_rank_811"><span class="LIDENT">rank</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_max_bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="COMMENT">(* max_len: 7 *)</span><span class="EOL">
</span>        <span class="LIDENT">c_bits</span> <a href="#local_code_814"><span class="LIDENT">code</span></a> <a href="#local_len_813"><span class="LIDENT">len</span></a> <span class="LPAREN">(</span><a href="#local_go_810"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_rank_811"><span class="LIDENT">rank</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_e_812"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_go_810"><span class="LIDENT">go</span></a> <span class="INT">0</span> <a href="#local_e_803"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encode_zigzag"><span class="LIDENT">encode_zigzag</span></span> <span id="local_dynamic_815"><span class="LIDENT">dynamic</span></span> <span id="local_k_816"><span class="LIDENT">k</span></span> <span id="local_e_817"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_go_818"><span class="LIDENT">go</span></span> <span id="local_rank_819"><span class="LIDENT">rank</span></span> <span id="local_e_820"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_rank_819"><span class="LIDENT">rank</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_dynamic_815"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">h_len</span> <span class="THEN">then</span> <span class="LIDENT">encode_huffman</span> <a href="#local_dynamic_815"><span class="LIDENT">dynamic</span></a> <a href="#local_k_816"><span class="LIDENT">k</span></a> <a href="#local_e_820"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_821"><span class="LIDENT">k</span></span> <span id="local_e_822"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <a href="#local_go_818"><span class="LIDENT">go</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_rank_819"><span class="LIDENT">rank</span></a><span class="RPAREN">)</span> <a href="#local_e_822"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_bits</span> <a href="#local_dynamic_815"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">bltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">lengths</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">zigzag</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_rank_819"><span class="LIDENT">rank</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="INT">3</span> <a href="#local_k_821"><span class="LIDENT">k</span></a> <a href="#local_e_820"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_go_818"><span class="LIDENT">go</span></a> <span class="INT">0</span> <a href="#local_e_817"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encode_dynamic_header"><span class="LIDENT">encode_dynamic_header</span></span> <span id="local_last_823"><span class="LIDENT">last</span></span> <span id="local_dynamic_824"><span class="LIDENT">dynamic</span></span> <span id="local_k_825"><span class="LIDENT">k</span></span> <span id="local_e_826"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* More readable but should be optimized. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k5_827"><span class="LIDENT">k5</span></span> <span id="local_e_828"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">encode_zigzag</span> <a href="#local_dynamic_824"><span class="LIDENT">dynamic</span></a> <a href="#local_k_825"><span class="LIDENT">k</span></a> <a href="#local_e_828"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k4_829"><span class="LIDENT">k4</span></span> <span id="local_e_830"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="LPAREN">(</span><a href="#local_dynamic_824"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">h_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <span class="INT">4</span> <a href="#local_k5_827"><span class="LIDENT">k5</span></a> <a href="#local_e_830"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k3_831"><span class="LIDENT">k3</span></span> <span id="local_e_832"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="LPAREN">(</span><a href="#local_dynamic_824"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">h_dst</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">5</span> <a href="#local_k4_829"><span class="LIDENT">k4</span></a> <a href="#local_e_832"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k2_833"><span class="LIDENT">k2</span></span> <span id="local_e_834"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="LPAREN">(</span><a href="#local_dynamic_824"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">h_lit</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">257</span><span class="RPAREN">)</span> <span class="INT">5</span> <a href="#local_k3_831"><span class="LIDENT">k3</span></a> <a href="#local_e_834"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k1_835"><span class="LIDENT">k1</span></span> <span id="local_e_836"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="INT">0x2</span> <span class="INT">2</span> <a href="#local_k2_833"><span class="LIDENT">k2</span></a> <a href="#local_e_836"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k0_837"><span class="LIDENT">k0</span></span> <span id="local_e_838"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_last_823"><span class="LIDENT">last</span></a> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="INT">1</span> <a href="#local_k1_835"><span class="LIDENT">k1</span></a> <a href="#local_e_838"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <a href="#local_k0_837"><span class="LIDENT">k0</span></a> <a href="#local_e_826"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encode_fixed_header"><span class="LIDENT">encode_fixed_header</span></span> <span id="local_last_839"><span class="LIDENT">last</span></span> <span id="local_k_840"><span class="LIDENT">k</span></span> <span id="local_e_841"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k1_842"><span class="LIDENT">k1</span></span> <span id="local_e_843"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="INT">0x1</span> <span class="INT">2</span> <a href="#local_k_840"><span class="LIDENT">k</span></a> <a href="#local_e_843"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k0_844"><span class="LIDENT">k0</span></span> <span id="local_e_845"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">c_bits</span> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_last_839"><span class="LIDENT">last</span></a> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="INT">1</span> <a href="#local_k1_842"><span class="LIDENT">k1</span></a> <a href="#local_e_845"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <a href="#local_k0_844"><span class="LIDENT">k0</span></a> <a href="#local_e_841"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-pending_bits"><span class="LIDENT">pending_bits</span></span> <span id="local_k_846"><span class="LIDENT">k</span></span> <span id="local_e_847"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_e_847"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&lt;=</span> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_k_848"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <span class="LIDENT">flush</span> <a href="#local_k_846"><span class="LIDENT">k</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_e_847"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="GREATER">&gt;</span> <span class="INT">8</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_849"><span class="LIDENT">k</span></span> <span id="local_e_850"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="#local_e_850"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_850"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits_rem</span> <span class="LESSMINUS">&lt;-</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Rem</span> <span class="LPAREN">(</span><span class="INT">16</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_e_850"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_850"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_848"><span class="LIDENT">k</span></a> <a href="#local_e_850"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_short</span> <span class="LPAREN">(</span><a href="#local_e_847"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span> <a href="#local_k_849"><span class="LIDENT">k</span></a> <a href="#local_e_847"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_e_847"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_k_851"><span class="LIDENT">k</span></span> <span id="local_e_852"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="#local_e_852"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_852"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits_rem</span> <span class="LESSMINUS">&lt;-</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Rem</span> <span class="LPAREN">(</span><span class="INT">8</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_e_852"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_e_852"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_k_848"><span class="LIDENT">k</span></a> <a href="#local_e_852"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">c_byte</span> <span class="LPAREN">(</span><a href="#local_e_847"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span> <a href="#local_k_851"><span class="LIDENT">k</span></a> <a href="#local_e_847"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_k_848"><span class="LIDENT">k</span></a> <a href="#local_e_847"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Def.exception-Flush_bits"><span class="EXCEPTION">exception</span> <span class="UIDENT">Flush_bits</span> <span class="OF">of</span> <span class="LBRACE">{</span><span id="def_1537"><span class="LIDENT">hold</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1465"><span class="LIDENT">bits</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.val-block"><span class="LIDENT">block</span></span> <span id="local_e_853"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span id="local_block_854"><span class="LIDENT">block</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_k_855"><span class="LIDENT">k</span></span> <span id="local_e_856"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_block_854"><span class="LIDENT">block</span></a><span class="DOT">.</span><span class="LIDENT">kind</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_857"><span class="LIDENT">dynamic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">encode_dynamic_header</span> <a href="#local_block_854"><span class="LIDENT">block</span></a><span class="DOT">.</span><span class="LIDENT">last</span> <a href="#local_dynamic_857"><span class="LIDENT">dynamic</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_858"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <a href="#local_e_858"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LIDENT">write</span> <a href="#local_e_858"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="#local_e_856"><span class="LIDENT">e</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Fixed</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">encode_fixed_header</span> <a href="#local_block_854"><span class="LIDENT">block</span></a><span class="DOT">.</span><span class="LIDENT">last</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_859"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <a href="#local_e_859"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LIDENT">write</span> <a href="#local_e_859"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="#local_e_856"><span class="LIDENT">e</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Flat</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="IF">if</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">end_with_eob</span> <a href="#local_e_856"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span> <span class="THEN">then</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">rem_exn</span> <a href="#local_e_856"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_len_860"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_e_856"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="INT">0xffff</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_e_856"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_860"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">encode_flat_header</span> <a href="#local_block_854"><span class="LIDENT">block</span></a><span class="DOT">.</span><span class="LIDENT">last</span><span class="EOL">
</span>                <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_861"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                  <a href="#local_e_861"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <span class="LIDENT">write_flat</span> <a href="#local_e_861"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                <a href="#local_e_856"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_e_853"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_block_854"><span class="LIDENT">block</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_855"><span class="LIDENT">k</span></a> <a href="#local_e_853"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_v_862"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">encode</span> <a href="#local_e_853"><span class="LIDENT">e</span></a> <a href="#local_v_862"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* TODO: not really clear. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Def.val-flush_bits"><span class="LIDENT">flush_bits</span></span> <span class="TILDE">~</span><span id="local_bits_863"><span class="LIDENT">bits</span></span> <span class="TILDE">~</span><span id="local_hold_864"><span class="LIDENT">hold</span></span> <span id="local_k_865"><span class="LIDENT">k</span></span> <span id="local_e_866"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">16</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">o_rem</span> <a href="#local_e_866"><span class="LIDENT">e</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LPAREN">(</span><a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">8</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">o_rem</span> <a href="#local_e_866"><span class="LIDENT">e</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LPAREN">(</span><a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_bits_863"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="GREATER">&gt;</span> <span class="INT">31</span> <span class="THEN">then</span> <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="LIDENT">flush_bits</span> <span class="TILDE">~</span><a href="#local_bits_863"><span class="LIDENT">bits</span></a> <span class="TILDE">~</span><a href="#local_hold_864"><span class="LIDENT">hold</span></a> <a href="#local_k_865"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_bits_863"><span class="LIDENT">bits</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_hold_864"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>         <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_len_867"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_bits_863"><span class="LIDENT">bits</span></a> <span class="INT">16</span> <span class="IN">in</span><span class="EOL">
</span>           <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_867"><span class="LIDENT">len</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">flush_bits</span> <span class="LABEL">~bits:</span><span class="LPAREN">(</span><a href="#local_bits_863"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_867"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="LABEL">~hold:</span><span class="LPAREN">(</span><a href="#local_hold_864"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <a href="#local_len_867"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="#local_k_865"><span class="LIDENT">k</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_k_865"><span class="LIDENT">k</span></a> <a href="#local_e_866"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Def.val-write"><span class="LIDENT">write</span></span> <span id="local_e_868"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_o_pos_869"><span class="LIDENT">o_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hold_870"><span class="LIDENT">hold</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bits_871"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1608"><span class="UIDENT">Leave</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="EXCEPTION">exception</span> <span id="def_1505"><span class="UIDENT">End</span></span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_ok_872"><span class="LIDENT">k_ok</span></span> <span id="local_e_873"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_e_873"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_nw_874"><span class="LIDENT">k_nw</span></span> <span id="local_e_875"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_e_875"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">block</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_continue_876"><span class="LIDENT">k_continue</span></span> <span id="local_e_877"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">write</span> <a href="#local_e_877"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* XXX(dinosaure): [k_continue] is used by [flush_bits]. When [flush_bits]
       is done, it's only to prevent an integer overflow of [hold] and it does
       not mean that we finish to encode the queue. [flush_bits] still continue
       to recall [write] then and we ensure that we have enough space to flush
       [hold] by [flush] and when the assumption of the given output has, at
       least, 2 free bytes.

       A bug appears when we compress with GZip layer [paper2] and when we reach
       [flush_bits] but we don't have enough spaces. User give to us a new
       output but:

       1) in the old implementation of [flush_bits], we wrote nothing (at least
       we want to write 16 bits)
       2) [flush_bits] finish with [`Ok] which tells to the user that we encoded
       all the queue *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_flush_bits_878"><span class="LIDENT">k_flush_bits</span></span> <span class="TILDE">~</span><span id="local_bits_879"><span class="LIDENT">bits</span></span> <span class="TILDE">~</span><span id="local_hold_880"><span class="LIDENT">hold</span></span> <span id="local_e_881"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="LIDENT">flush_bits</span> <span class="TILDE">~</span><a href="#local_bits_879"><span class="LIDENT">bits</span></a> <span class="TILDE">~</span><a href="#local_hold_880"><span class="LIDENT">hold</span></a> <a href="#local_k_continue_876"><span class="LIDENT">k_continue</span></a><span class="RPAREN">)</span> <a href="#local_e_881"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_emit_882"><span class="LIDENT">emit</span></span> <span id="local_e_883"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">16</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_e_883"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_883"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_883"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* [emit] is recursive to consume until [!bits] &gt;= 16. Otherwise, process
       can overflow [!hold]. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1494"><span id="local_ltree_884"><span class="LIDENT">ltree</span></span><span class="COMMA">,</span> <span id="local_dtree_885"><span class="LIDENT">dtree</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_886"><span class="LIDENT">dynamic</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_dynamic_886"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">ltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="COMMA">,</span> <a href="#local_dynamic_886"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">dtree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_static_ltree</span><span class="COMMA">,</span> <span class="LIDENT">_static_dtree</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">is_empty</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_cmd_887"><span class="LIDENT">cmd</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">peek_exn</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">exists</span> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">code</span> <a href="#local_cmd_887"><span class="LIDENT">cmd</span></a><span class="RPAREN">)</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">Leave</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">unsafe_junk</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_cmd_887"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="UIDENT">End</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="MATCH">match</span> <a href="#local_cmd_887"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x2000000</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="def_1573"><span id="local_len_888"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_889"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_ltree_884"><span class="LIDENT">ltree</span></a> <a href="#local_cmd_887"><span class="LIDENT">cmd</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v_889"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_888"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="COMMENT">(* XXX(dinosaure): explanation is needed here.

               At the beginning, encode was made on a 64-bit processor. [int] is
               63-bit in this architecture. By this way, in ANY context, any
               _op-code_ can fit into [hold] (bigger _op-code_ is 48 bits).

               However, in 32-bit processor, this assertion is false. We reach
               sometimes the limit (31 bits) and must emit [short] to avoid
               overflow. However, in some cases, we can not:
               - store more bits into [hold]
               - emit [short] into output

               In this REAL bad case, we raise [Flush_bits] with delayed bits.
               Then, we ask the client to flush output and store current [hold]
               and delayed bits into new output. An final assertion is to have an
               output bigger than 2 bytes in any case which is fair enough, I
               think ...

               [flush_bits] can be reached with [news] Calgary file. *)</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="def_1477"><span id="local_off_890"><span class="LIDENT">off</span></span><span class="COMMA">,</span> <span id="local_len_891"><span class="LIDENT">len</span></span></span> <span class="EQUAL">=</span> <a href="#local_cmd_887"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xffff</span><span class="COMMA">,</span> <span class="LPAREN">(</span><a href="#local_cmd_887"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1ff</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_code_892"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_891"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="def_1460"><span id="local_len0_893"><span class="LIDENT">len0</span></span><span class="COMMA">,</span> <span id="local_v0_894"><span class="LIDENT">v0</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_ltree_884"><span class="LIDENT">ltree</span></a> <span class="LPAREN">(</span><a href="#local_code_892"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="def_1532"><span id="local_len1_895"><span class="LIDENT">len1</span></span><span class="COMMA">,</span> <span id="local_v1_896"><span class="LIDENT">v1</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <span class="LIDENT">_extra_lbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_code_892"><span class="LIDENT">code</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_len_891"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_base_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_code_892"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_code_897"><span class="LIDENT">code</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_distance</span> <a href="#local_off_890"><span class="LIDENT">off</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="def_1435"><span id="local_len2_898"><span class="LIDENT">len2</span></span><span class="COMMA">,</span> <span id="local_v2_899"><span class="LIDENT">v2</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_dtree_885"><span class="LIDENT">dtree</span></a> <a href="#local_code_897"><span class="LIDENT">code</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="def_1427"><span id="local_len3_900"><span class="LIDENT">len3</span></span><span class="COMMA">,</span> <span id="local_v3_901"><span class="LIDENT">v3</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_code_897"><span class="LIDENT">code</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1f</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_off_890"><span class="LIDENT">off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_base_dist</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_code_897"><span class="LIDENT">code</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="COMMENT">(* len0_max: 15, 15 + 15 = 30. *)</span><span class="EOL">
</span>            <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v0_894"><span class="LIDENT">v0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len0_893"><span class="LIDENT">len0</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="COMMENT">(* len1_max: 5, 15 + 5 = 20 *)</span><span class="EOL">
</span>              <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v1_896"><span class="LIDENT">v1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len1_895"><span class="LIDENT">len1</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>              <span class="ELSE">else</span><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a><span class="EOL">
</span>                  <span class="LPAREN">(</span><span class="UIDENT">Flush_bits</span> <span class="LBRACE">{</span><span class="LIDENT">bits</span><span class="EQUAL">=</span> <a href="#local_len2_898"><span class="LIDENT">len2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len3_900"><span class="LIDENT">len3</span></a><span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_v3_901"><span class="LIDENT">v3</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_len2_898"><span class="LIDENT">len2</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_v2_899"><span class="LIDENT">v2</span></a><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="COMMENT">(* len2_max: 15, 15 + 15 = 30 *)</span><span class="EOL">
</span>              <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v2_899"><span class="LIDENT">v2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len2_898"><span class="LIDENT">len2</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len3_900"><span class="LIDENT">len3</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">15</span> <span class="GREATER">&gt;</span> <span class="INT">31</span> <span class="THEN">then</span><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="LPAREN">(</span><span class="UIDENT">Flush_bits</span> <span class="LBRACE">{</span><span class="LIDENT">bits</span><span class="EQUAL">=</span> <a href="#local_len3_900"><span class="LIDENT">len3</span></a><span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <a href="#local_v3_901"><span class="LIDENT">v3</span></a><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="COMMENT">(* len3_max: 13, 15 + 13 = 28 *)</span><span class="EOL">
</span>              <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v3_901"><span class="LIDENT">v3</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len3_900"><span class="LIDENT">len3</span></a><span class="EOL">
</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">15</span> <span class="GREATER">&gt;</span> <span class="INT">31</span> <span class="THEN">then</span><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="LPAREN">(</span><span class="UIDENT">Flush_bits</span> <span class="LBRACE">{</span><span class="LIDENT">bits</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): at least we need 2 bytes in any case. *)</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="LIDENT">o_rem</span> <a href="#local_e_868"><span class="LIDENT">e</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_k_ok_872"><span class="LIDENT">k_ok</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <span class="LIDENT">flush</span> <span class="LIDENT">write</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Flush_bits</span> <span class="LBRACE">{</span><span class="LIDENT">bits</span><span class="EQUAL">=</span> <span id="local_bits'_903"><span class="LIDENT">bits'</span></span><span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span id="local_hold'_902"><span class="LIDENT">hold'</span></span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_k_flush_bits_878"><span class="LIDENT">k_flush_bits</span></a> <span class="LABEL">~bits:</span><a href="#local_bits'_903"><span class="LIDENT">bits'</span></a> <span class="LABEL">~hold:</span><a href="#local_hold'_902"><span class="LIDENT">hold'</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leave</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_904"><span class="LIDENT">dynamic</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1500"><span id="local_len_905"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_906"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_dynamic_904"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">ltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v_906"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_905"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_k_nw_874"><span class="LIDENT">k_nw</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1504"><span id="local_len_907"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_908"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">_static_ltree</span> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v_908"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_907"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_k_nw_874"><span class="LIDENT">k_nw</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_909"><span class="LIDENT">dynamic</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1433"><span id="local_len_910"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_911"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_dynamic_909"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">ltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v_911"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_910"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span> <span class="LIDENT">pending_bits</span> <a href="#local_k_ok_872"><span class="LIDENT">k_ok</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <a href="#local_k_nw_874"><span class="LIDENT">k_nw</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1496"><span id="local_len_912"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_913"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">_static_ltree</span> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_hold_870"><span class="LIDENT">hold</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_v_913"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_912"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_emit_882"><span class="LIDENT">emit</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hold_870"><span class="LIDENT">hold</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bits_871"><span class="LIDENT">bits</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_869"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span> <span class="LIDENT">pending_bits</span> <a href="#local_k_ok_872"><span class="LIDENT">k_ok</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <a href="#local_k_nw_874"><span class="LIDENT">k_nw</span></a> <a href="#local_e_868"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Def.val-force"><span class="LIDENT">force</span></span> <span id="local_blk_914"><span class="LIDENT">blk</span></span> <span id="local_e_915"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_emit_916"><span class="LIDENT">emit</span></span> <span id="local_e_917"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">16</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_917"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_918"><span class="LIDENT">dynamic</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1439"><span id="local_len_919"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_920"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_dynamic_918"><span class="LIDENT">dynamic</span></a><span class="DOT">.</span><span class="LIDENT">ltree</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">tree</span> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><a href="#local_v_920"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_919"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_emit_916"><span class="LIDENT">emit</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">block</span> <a href="#local_e_915"><span class="LIDENT">e</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <a href="#local_blk_914"><span class="LIDENT">blk</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1489"><span id="local_len_921"><span class="LIDENT">len</span></span><span class="COMMA">,</span> <span id="local_v_922"><span class="LIDENT">v</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lookup</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">_static_ltree</span> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><a href="#local_v_922"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_921"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_emit_916"><span class="LIDENT">emit</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">block</span> <a href="#local_e_915"><span class="LIDENT">e</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <a href="#local_blk_914"><span class="LIDENT">blk</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Flat</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_emit_916"><span class="LIDENT">emit</span></a> <a href="#local_e_915"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">block</span> <a href="#local_e_915"><span class="LIDENT">e</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <a href="#local_blk_914"><span class="LIDENT">blk</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* XXX(dinosaure): should never occur! *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Def.val-write_flat"><span class="LIDENT">write_flat</span></span> <span id="local_e_923"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_o_pos_924"><span class="LIDENT">o_pos</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_flat_925"><span class="LIDENT">flat</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">flat</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="WHILE">while</span><span class="EOL">
</span>      <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_max</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_924"><span class="LIDENT">o_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">is_empty</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flat_925"><span class="LIDENT">flat</span></a> <span class="LESS">&lt;</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span><span class="EOL">
</span>    <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_cmd_926"><span class="LIDENT">cmd</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">pop_exn</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_cmd_926"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x2000000</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;Impossible to emit a copy code in a Flat block (%08x)&quot;</span> <a href="#local_cmd_926"><span class="LIDENT">cmd</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_cmd_926"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">256</span><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_924"><span class="LIDENT">o_pos</span></a> <span class="LPAREN">(</span><a href="#local_cmd_926"><span class="LIDENT">cmd</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_o_pos_924"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_flat_925"><span class="LIDENT">flat</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">flat</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flat_925"><span class="LIDENT">flat</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_o_pos_924"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flat_925"><span class="LIDENT">flat</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(* XXX(dinosaure): clean it! *)</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span> <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span><span class="RPAREN">)</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>              <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_927"><span class="LIDENT">e</span></span> <span id="local_v_928"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                <span class="MATCH">match</span> <a href="#local_v_928"><span class="LIDENT">v</span></a> <span class="WITH">with</span><span class="EOL">
</span>                <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">block</span> <a href="#local_e_927"><span class="LIDENT">e</span></a> <a href="#local_v_928"><span class="LIDENT">v</span></a><span class="EOL">
</span>                <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                  <a href="#local_e_927"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">block</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <span class="LIDENT">o_rem</span> <a href="#local_e_923"><span class="LIDENT">e</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">flush</span> <span class="LIDENT">write_flat</span> <a href="#local_e_923"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* assert (Queue.is_empty e.b ) *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Def.val-{encode}11/shadowed/(decompress-src-decompress.de-de.ml)"><span class="LIDENT">encode</span></span> <span id="local_e_929"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_e_929"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="COMMENT">(* XXX(dinosaure): do nothing. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_e_929"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">kind</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Flat</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">write_flat</span> <a href="#local_e_929"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Dynamic</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Fixed</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">write</span> <a href="#local_e_929"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span id="local_blk_930"><span class="LIDENT">blk</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_e_929"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LIDENT">invalid_arg</span><span class="EOL">
</span>          <span class="STRING">&quot;Impossible to make a new block when the current block is the last \
           one&quot;</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <span class="LIDENT">o_rem</span> <a href="#local_e_929"><span class="LIDENT">e</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="THEN">then</span> <span class="LIDENT">force</span> <a href="#local_blk_930"><span class="LIDENT">blk</span></a> <a href="#local_e_929"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <span class="LIDENT">flush</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_931"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">force</span> <a href="#local_blk_930"><span class="LIDENT">blk</span></a> <a href="#local_e_931"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="#local_e_929"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-first_entry"><span class="LIDENT">first_entry</span></span> <span id="local_e_932"><span class="LIDENT">e</span></span> <span id="local_v_933"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_v_933"><span class="LIDENT">v</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span id="local_blk_934"><span class="LIDENT">blk</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">block</span> <a href="#local_e_932"><span class="LIDENT">e</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <a href="#local_blk_934"><span class="LIDENT">blk</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_v_935"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">kind</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Dynamic</span> <span id="local_dynamic_936"><span class="LIDENT">dynamic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">encode_dynamic_header</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span> <a href="#local_dynamic_936"><span class="LIDENT">dynamic</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_937"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="#local_e_937"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">encode</span> <a href="#local_e_937"><span class="LIDENT">e</span></a> <a href="#local_v_935"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Fixed</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">encode_fixed_header</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_938"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="#local_e_938"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">encode</span> <a href="#local_e_938"><span class="LIDENT">e</span></a> <a href="#local_v_935"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Flat</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">end_with_eob</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span> <span class="THEN">then</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">rem_exn</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_len_939"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="INT">0xffff</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">fmax</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_939"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">encode_flat_header</span> <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">blk</span><span class="DOT">.</span><span class="LIDENT">last</span><span class="EOL">
</span>              <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_940"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                <a href="#local_e_940"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">encode</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LIDENT">encode</span> <a href="#local_e_940"><span class="LIDENT">e</span></a> <a href="#local_v_935"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <a href="#local_e_932"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-dst_rem"><span class="LIDENT">dst_rem</span></span> <span id="local_d_941"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="LIDENT">o_rem</span> <a href="#local_d_941"><span class="LIDENT">d</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-bits_rem"><span class="LIDENT">bits_rem</span></span> <span id="local_t_942"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_t_942"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">bits_rem</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Rem</span> <span id="local_rem_943"><span class="LIDENT">rem</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_rem_943"><span class="LIDENT">rem</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Pending</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;Encoder does not reach EOB of last block&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encoder"><span class="LIDENT">encoder</span></span> <span id="local_dst_944"><span class="LIDENT">dst</span></span> <span class="TILDE">~</span><span id="local_q_945"><span class="LIDENT">q</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1442"><span id="local_o_946"><span class="LIDENT">o</span></span><span class="COMMA">,</span> <span id="local_o_pos_947"><span class="LIDENT">o_pos</span></span><span class="COMMA">,</span> <span id="local_o_max_948"><span class="LIDENT">o_max</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_dst_944"><span class="LIDENT">dst</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_empty</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Buffer</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">bigstring_create</span> <span class="LIDENT">io_buffer_size</span><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="LIDENT">io_buffer_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <a href="#local_dst_944"><span class="LIDENT">dst</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">blk</span><span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RBRACE">}</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">bits</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">bits_rem</span><span class="EQUAL">=</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Pending</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">flat</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">fmax</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_o_946"><span class="LIDENT">o</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_o_pos_947"><span class="LIDENT">o_pos</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_o_max_948"><span class="LIDENT">o_max</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">b</span><span class="EQUAL">=</span> <a href="#local_q_945"><span class="LIDENT">q</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">k</span><span class="EQUAL">=</span> <span class="LIDENT">first_entry</span><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Def.val-encode"><span class="LIDENT">encode</span></span> <span id="local_e_949"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <a href="#local_e_949"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <a href="#local_e_949"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Def.module-Ns"><span class="MODULE">module</span> <span class="UIDENT">Ns</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_min_block_length"><span class="LIDENT">_min_block_length</span></span> <span class="EQUAL">=</span> <span class="INT">10000</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_end_padding"><span class="LIDENT">_end_padding</span></span> <span class="EQUAL">=</span> <span class="INT">8</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_match_offset"><span class="LIDENT">_max_match_offset</span></span> <span class="EQUAL">=</span> <span class="INT">32768</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_max_codeword_len"><span class="LIDENT">_max_max_codeword_len</span></span> <span class="EQUAL">=</span> <span class="INT">15</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_num_litlen_syms"><span class="LIDENT">_num_litlen_syms</span></span> <span class="EQUAL">=</span> <span class="INT">288</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_litlen_codeword_len"><span class="LIDENT">_max_litlen_codeword_len</span></span> <span class="EQUAL">=</span> <span class="INT">14</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_num_offset_syms"><span class="LIDENT">_num_offset_syms</span></span> <span class="EQUAL">=</span> <span class="INT">32</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_offset_codeword_len"><span class="LIDENT">_max_offset_codeword_len</span></span> <span class="EQUAL">=</span> <span class="INT">15</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_num_syms"><span class="LIDENT">_max_num_syms</span></span> <span class="EQUAL">=</span> <span class="INT">288</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_num_symbol_bits"><span class="LIDENT">_num_symbol_bits</span></span> <span class="EQUAL">=</span> <span class="INT">10</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_symbol_mask"><span class="LIDENT">_symbol_mask</span></span> <span class="EQUAL">=</span> <span class="INT">0b1111111111</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_min_match_len"><span class="LIDENT">_min_match_len</span></span> <span class="EQUAL">=</span> <span class="INT">3</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_match_len"><span class="LIDENT">_max_match_len</span></span> <span class="EQUAL">=</span> <span class="INT">258</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_soft_max_block_length"><span class="LIDENT">_soft_max_block_length</span></span> <span class="EQUAL">=</span> <span class="INT">300000</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_num_precode_syms"><span class="LIDENT">_num_precode_syms</span></span> <span class="EQUAL">=</span> <span class="INT">19</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_end_of_block"><span class="LIDENT">_end_of_block</span></span> <span class="EQUAL">=</span> <span class="INT">256</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_pre_codeword_len"><span class="LIDENT">_max_pre_codeword_len</span></span> <span class="EQUAL">=</span> <span class="INT">7</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_extra_length_bits"><span class="LIDENT">_max_extra_length_bits</span></span> <span class="EQUAL">=</span> <span class="INT">5</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-_max_extra_offset_bits"><span class="LIDENT">_max_extra_offset_bits</span></span> <span class="EQUAL">=</span> <span class="INT">14</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-error"><span class="TYPE">type</span> <span class="LIDENT">error</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_compression_level</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_output</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-pp_error"><span class="LIDENT">pp_error</span></span> <span id="local_ppf_950"><span class="LIDENT">ppf</span></span> <span id="local_e_951"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_952"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_e_951"><span class="LIDENT">e</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_compression_level</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Invalid compression level&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_output</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;Unexpected end of output&quot;</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_ppf_950"><span class="LIDENT">ppf</span></a> <span class="STRING">&quot;%s&quot;</span> <a href="#local_s_952"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.exception-Malformed"><span class="EXCEPTION">exception</span> <span class="UIDENT">Malformed</span> <span class="OF">of</span> <span class="LIDENT">error</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-err_invalid_compression_level"><span class="LIDENT">err_invalid_compression_level</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Invalid_compression_level</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-err_unexpected_end_of_output"><span class="LIDENT">err_unexpected_end_of_output</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Malformed</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Unexpected_end_of_output</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-lit_off"><span class="TYPE">type</span> <span class="LIDENT">lit_off</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1612"><span class="LIDENT">litlen</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="SEMI">;</span></span> <span id="def_1469"><span class="LIDENT">offset</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-codes"><span class="TYPE">type</span> <span class="LIDENT">codes</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1492"><span class="LIDENT">codewords</span><span class="COLON">:</span> <span class="LIDENT">lit_off</span><span class="SEMI">;</span></span> <span id="def_1483"><span class="LIDENT">lens</span><span class="COLON">:</span> <span class="LIDENT">lit_off</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-encoder"><span class="TYPE">type</span> <span class="LIDENT">encoder</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span id="def_1544"><span class="LIDENT">level</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1491"><span class="LIDENT">min_size_to_compress</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1426"><span class="LIDENT">max_search_depth</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1536"><span class="LIDENT">nice_match_length</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1471"><span class="LIDENT">offset_slot_fast</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1516"><span class="LIDENT">freqs</span><span class="COLON">:</span> <span class="LIDENT">lit_off</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1534"><span class="LIDENT">codes</span><span class="COLON">:</span> <span class="LIDENT">codes</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1473"><span class="LIDENT">static_codes</span><span class="COLON">:</span> <span class="LIDENT">codes</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1579"><span class="LIDENT">precode_freqs</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1529"><span class="LIDENT">precode_lens</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1487"><span class="LIDENT">precode_codewords</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1455"><span class="LIDENT">precode_items</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1506"><span class="MUTABLE">mutable</span> <span class="LIDENT">num_litlen_syms</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1561"><span class="MUTABLE">mutable</span> <span class="LIDENT">num_offset_syms</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1586"><span class="MUTABLE">mutable</span> <span class="LIDENT">num_explicit_lens</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1543"><span class="MUTABLE">mutable</span> <span class="LIDENT">num_precode_items</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-output_bitstream"><span class="TYPE">type</span> <span class="LIDENT">output_bitstream</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span id="def_1482"><span class="LIDENT">i</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1550"><span class="MUTABLE">mutable</span> <span class="LIDENT">i_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1456"><span class="LIDENT">i_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1569"><span class="LIDENT">o</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1601"><span class="MUTABLE">mutable</span> <span class="LIDENT">o_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1541"><span class="LIDENT">o_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1518"><span class="MUTABLE">mutable</span> <span class="LIDENT">hold</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1497"><span class="MUTABLE">mutable</span> <span class="LIDENT">bits</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-hc_matchfinder"><span class="TYPE">type</span> <span class="LIDENT">hc_matchfinder</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span id="def_1575"><span class="LIDENT">hash4_tab</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1598"><span class="MUTABLE">mutable</span> <span class="LIDENT">next_hash4</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1588"><span class="LIDENT">next_tab</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-hc_matchfinder_hash4_order"><span class="LIDENT">hc_matchfinder_hash4_order</span></span> <span class="EQUAL">=</span> <span class="INT">16</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-window_size"><span class="LIDENT">window_size</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-hc_matchfinder_init"><span class="LIDENT">hc_matchfinder_init</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_hash4_tab_953"><span class="LIDENT">hash4_tab</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">hc_matchfinder_hash4_order</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a><span class="LIDENT">window_size</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_next_tab_954"><span class="LIDENT">next_tab</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">window_size</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LBRACE">{</span><a href="#local_hash4_tab_953"><span class="LIDENT">hash4_tab</span></a><span class="SEMI">;</span> <span class="LIDENT">next_hash4</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <a href="#local_next_tab_954"><span class="LIDENT">next_tab</span></a><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-sequence"><span class="TYPE">type</span> <span class="LIDENT">sequence</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span id="def_1597"><span class="MUTABLE">mutable</span> <span class="LIDENT">litrunlen_and_length</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1564"><span class="MUTABLE">mutable</span> <span class="LIDENT">offset</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1566"><span class="MUTABLE">mutable</span> <span class="LIDENT">offset_symbol</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1425"><span class="MUTABLE">mutable</span> <span class="LIDENT">length_slot</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-num_literal_observation_types"><span class="LIDENT">num_literal_observation_types</span></span> <span class="EQUAL">=</span> <span class="INT">8</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-num_match_observation_types"><span class="LIDENT">num_match_observation_types</span></span> <span class="EQUAL">=</span> <span class="INT">2</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-num_observation_types"><span class="LIDENT">num_observation_types</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">num_literal_observation_types</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">num_match_observation_types</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-block_split_stats"><span class="TYPE">type</span> <span class="LIDENT">block_split_stats</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>        <span id="def_1475"><span class="LIDENT">new_observations</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1480"><span class="LIDENT">observations</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1589"><span class="MUTABLE">mutable</span> <span class="LIDENT">num_new_observations</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_1591"><span class="MUTABLE">mutable</span> <span class="LIDENT">num_observations</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-split_stats"><span class="LIDENT">split_stats</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LBRACE">{</span><span class="EOL">
</span>        <span class="LIDENT">new_observations</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">num_observation_types</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">observations</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">num_observation_types</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">num_new_observations</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">num_observations</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Def.module-Ns.type-lens"><span class="TYPE">type</span> <span class="LIDENT">lens</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span id="def_1552"><span class="MUTABLE">mutable</span> <span class="LIDENT">best</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1474"><span class="MUTABLE">mutable</span> <span class="LIDENT">nice</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_1562"><span class="MUTABLE">mutable</span> <span class="LIDENT">max</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-blocktype_uncompressed"><span class="LIDENT">blocktype_uncompressed</span></span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-blocktype_static_huffman"><span class="LIDENT">blocktype_static_huffman</span></span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-blocktype_dynamic_huffman"><span class="LIDENT">blocktype_dynamic_huffman</span></span> <span class="EQUAL">=</span> <span class="INT">2</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-init_output"><span class="LIDENT">init_output</span></span> <span id="local_i_955"><span class="LIDENT">i</span></span> <span id="local_o_956"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LBRACE">{</span><span class="EOL">
</span>        <a href="#local_i_955"><span class="LIDENT">i</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">i_pos</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">i_len</span><span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_i_955"><span class="LIDENT">i</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_o_956"><span class="LIDENT">o</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">o_pos</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">o_len</span><span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_956"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_end_padding</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">hold</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">bits</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-get_num_counter"><span class="LIDENT">get_num_counter</span></span> <span id="local_num_syms_957"><span class="LIDENT">num_syms</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_num_syms_957"><span class="LIDENT">num_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <span class="INT">3</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-sort_symbols"><span class="LIDENT">sort_symbols</span></span> <span id="local_num_syms_958"><span class="LIDENT">num_syms</span></span> <span id="local_freqs_959"><span class="LIDENT">freqs</span></span> <span id="local_lens_960"><span class="LIDENT">lens</span></span> <span id="local_symout_961"><span class="LIDENT">symout</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_counters_962"><span class="LIDENT">counters</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">get_num_counter</span> <span class="LIDENT">_max_num_syms</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_num_counters_963"><span class="LIDENT">num_counters</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_num_counter</span> <a href="#local_num_syms_958"><span class="LIDENT">num_syms</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_num_syms_958"><span class="LIDENT">num_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_964"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_freqs_959"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_num_counters_963"><span class="LIDENT">num_counters</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_964"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_964"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_num_used_syms_965"><span class="LIDENT">num_used_syms</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <a href="#local_num_counters_963"><span class="LIDENT">num_counters</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_count_966"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span> <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_num_used_syms_965"><span class="LIDENT">num_used_syms</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_num_used_syms_965"><span class="LIDENT">num_used_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_num_used_syms_965"><span class="LIDENT">num_used_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_count_966"><span class="LIDENT">count</span></a><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_num_syms_958"><span class="LIDENT">num_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_freq_967"><span class="LIDENT">freq</span></span> <span class="EQUAL">=</span> <a href="#local_freqs_959"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_freq_967"><span class="LIDENT">freq</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_i_968"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_freq_967"><span class="LIDENT">freq</span></a> <span class="LPAREN">(</span><a href="#local_num_counters_963"><span class="LIDENT">num_counters</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>              <a href="#local_symout_961"><span class="LIDENT">symout</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_968"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">sym</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_freq_967"><span class="LIDENT">freq</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_num_symbol_bits</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_968"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_968"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="ELSE">else</span> <a href="#local_lens_960"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_counters_pos_969"><span class="LIDENT">counters_pos</span></span> <span class="EQUAL">=</span> <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_num_counters_963"><span class="LIDENT">num_counters</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_counters_len_970"><span class="LIDENT">counters_len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_num_counters_963"><span class="LIDENT">num_counters</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_counters_962"><span class="LIDENT">counters</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_num_counters_963"><span class="LIDENT">num_counters</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_to_sort_971"><span class="LIDENT">to_sort</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-sub"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_symout_961"><span class="LIDENT">symout</span></a> <a href="#local_counters_pos_969"><span class="LIDENT">counters_pos</span></a> <a href="#local_counters_len_970"><span class="LIDENT">counters_len</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-sort"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">sort</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_972"><span class="LIDENT">i</span></span> <span id="local_j_973"><span class="LIDENT">j</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_i_972"><span class="LIDENT">i</span></a><span class="COMMA">,</span> <a href="#local_j_973"><span class="LIDENT">j</span></a> <span class="WITH">with</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">1</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="MINUS">-</span><span class="INT">1</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_i_972"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_j_973"><span class="LIDENT">j</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="#local_to_sort_971"><span class="LIDENT">to_sort</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-blit"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_to_sort_971"><span class="LIDENT">to_sort</span></a> <span class="INT">0</span> <a href="#local_symout_961"><span class="LIDENT">symout</span></a> <a href="#local_counters_pos_969"><span class="LIDENT">counters_pos</span></a> <a href="#local_counters_len_970"><span class="LIDENT">counters_len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_num_used_syms_965"><span class="LIDENT">num_used_syms</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-build_tree"><span class="LIDENT">build_tree</span></span> <span id="local_a_974"><span class="LIDENT">a</span></span> <span id="local_sym_count_975"><span class="LIDENT">sym_count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_976"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b_977"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_e_978"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_sym_count_975"><span class="LIDENT">sym_count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_e_978"><span class="LIDENT">e</span></a> <span class="GREATER">&gt;</span> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1551"><span id="local_m_979"><span class="LIDENT">m</span></span><span class="COMMA">,</span> <span id="local_n_980"><span class="LIDENT">n</span></span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_976"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_sym_count_975"><span class="LIDENT">sym_count</span></a><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="#local_b_977"><span class="LIDENT">b</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_e_978"><span class="LIDENT">e</span></a><span class="EOL">
</span>             <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_976"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_num_symbol_bits</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_b_977"><span class="LIDENT">b</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_num_symbol_bits</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_m_979"><span class="LIDENT">m</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_976"><span class="LIDENT">i</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_976"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_m_979"><span class="LIDENT">m</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_b_977"><span class="LIDENT">b</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_b_977"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_976"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_sym_count_975"><span class="LIDENT">sym_count</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="#local_b_977"><span class="LIDENT">b</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_e_978"><span class="LIDENT">e</span></a><span class="EOL">
</span>               <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_976"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_num_symbol_bits</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_b_977"><span class="LIDENT">b</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_num_symbol_bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_n_980"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_976"><span class="LIDENT">i</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_976"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_n_980"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_b_977"><span class="LIDENT">b</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_b_977"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_freq_shifted_981"><span class="LIDENT">freq_shifted</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_979"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <span class="LIDENT">_symbol_mask</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_980"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <span class="LIDENT">_symbol_mask</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_979"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_979"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_e_978"><span class="LIDENT">e</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_num_symbol_bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_980"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_980"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_e_978"><span class="LIDENT">e</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_num_symbol_bits</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_e_978"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a_974"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_e_978"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_freq_shifted_981"><span class="LIDENT">freq_shifted</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_e_978"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-compute_length_counts"><span class="LIDENT">compute_length_counts</span></span> <span id="local_a_982"><span class="LIDENT">a</span></span> <span id="local_root_idx_983"><span class="LIDENT">root_idx</span></span> <span id="local_len_counts_984"><span class="LIDENT">len_counts</span></span> <span id="local_max_codeword_985"><span class="LIDENT">max_codeword</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_len_counts_984"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">1</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">2</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_a_982"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_root_idx_983"><span class="LIDENT">root_idx</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a_982"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_root_idx_983"><span class="LIDENT">root_idx</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span class="REC">rec</span> <span id="local_f_986"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="MINUS">-</span><span class="INT">1</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span id="local_node_987"><span class="LIDENT">node</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_parent_988"><span class="LIDENT">parent</span></span> <span class="EQUAL">=</span> <a href="#local_a_982"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_node_987"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_num_symbol_bits</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_parent_depth_989"><span class="LIDENT">parent_depth</span></span> <span class="EQUAL">=</span> <a href="#local_a_982"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_parent_988"><span class="LIDENT">parent</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LIDENT">_num_symbol_bits</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_depth_990"><span class="LIDENT">depth</span></span> <span class="EQUAL">=</span> <a href="#local_parent_depth_989"><span class="LIDENT">parent_depth</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_991"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_depth_990"><span class="LIDENT">depth</span></a> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_a_982"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_node_987"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>              <a href="#local_a_982"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_node_987"><span class="LIDENT">node</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_depth_990"><span class="LIDENT">depth</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_num_symbol_bits</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_991"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_max_codeword_985"><span class="LIDENT">max_codeword</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_len_991"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_max_codeword_985"><span class="LIDENT">max_codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="#local_len_counts_984"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_991"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>                    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_len_991"><span class="LIDENT">len</span></a><span class="EOL">
</span>                  <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_len_counts_984"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_991"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_counts_984"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_991"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_len_counts_984"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_991"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_counts_984"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_991"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_f_986"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><a href="#local_node_987"><span class="LIDENT">node</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_f_986"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><a href="#local_root_idx_983"><span class="LIDENT">root_idx</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-gen_codewords"><span class="LIDENT">gen_codewords</span></span> <span id="local_a_992"><span class="LIDENT">a</span></span> <span id="local_lens_993"><span class="LIDENT">lens</span></span> <span id="local_len_counts_994"><span class="LIDENT">len_counts</span></span> <span id="local_max_codeword_len_995"><span class="LIDENT">max_codeword_len</span></span> <span id="local_num_syms_996"><span class="LIDENT">num_syms</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_next_codewords_997"><span class="LIDENT">next_codewords</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_max_codeword_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_998"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len_999"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_max_codeword_len_995"><span class="LIDENT">max_codeword_len</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_999"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_count_1000"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_len_counts_994"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_999"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_count_1000"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_lens_993"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_a_992"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_998"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_len_999"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_998"><span class="LIDENT">i</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_count_1000"><span class="LIDENT">count</span></a><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_len_999"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">1</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">len</span> <span class="EQUAL">=</span> <span class="INT">2</span> <span class="TO">to</span> <a href="#local_max_codeword_len_995"><span class="LIDENT">max_codeword_len</span></a> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">len</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_counts_994"><span class="LIDENT">len_counts</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_num_syms_996"><span class="LIDENT">num_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_i_1001"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_lens_993"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_a_992"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1001"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1001"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_next_codewords_997"><span class="LIDENT">next_codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1001"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-make_canonical_huffman_code"><span class="LIDENT">make_canonical_huffman_code</span></span><span class="EOL">
</span>        <span id="local_num_syms_1002"><span class="LIDENT">num_syms</span></span> <span id="local_max_codeword_len_1003"><span class="LIDENT">max_codeword_len</span></span> <span id="local_freqs_1004"><span class="LIDENT">freqs</span></span> <span id="local_lens_1005"><span class="LIDENT">lens</span></span> <span id="local_codewords_1006"><span class="LIDENT">codewords</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_num_used_syms_1007"><span class="LIDENT">num_used_syms</span></span> <span class="EQUAL">=</span> <span class="LIDENT">sort_symbols</span> <a href="#local_num_syms_1002"><span class="LIDENT">num_syms</span></a> <a href="#local_freqs_1004"><span class="LIDENT">freqs</span></a> <a href="#local_lens_1005"><span class="LIDENT">lens</span></a> <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_num_used_syms_1007"><span class="LIDENT">num_used_syms</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">1</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_sym_1008"><span class="LIDENT">sym</span></span> <span class="EQUAL">=</span> <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_symbol_mask</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_nonzero_idx_1009"><span class="LIDENT">nonzero_idx</span></span> <span class="EQUAL">=</span> <span class="LIDENT">max</span> <a href="#local_sym_1008"><span class="LIDENT">sym</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_lens_1005"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">0</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_nonzero_idx_1009"><span class="LIDENT">nonzero_idx</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_lens_1005"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_nonzero_idx_1009"><span class="LIDENT">nonzero_idx</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">build_tree</span> <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a> <a href="#local_num_used_syms_1007"><span class="LIDENT">num_used_syms</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_len_counts_1010"><span class="LIDENT">len_counts</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_max_codeword_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">compute_length_counts</span> <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a> <span class="LPAREN">(</span><a href="#local_num_used_syms_1007"><span class="LIDENT">num_used_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_len_counts_1010"><span class="LIDENT">len_counts</span></a><span class="EOL">
</span>            <a href="#local_max_codeword_len_1003"><span class="LIDENT">max_codeword_len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">gen_codewords</span> <a href="#local_codewords_1006"><span class="LIDENT">codewords</span></a> <a href="#local_lens_1005"><span class="LIDENT">lens</span></a> <a href="#local_len_counts_1010"><span class="LIDENT">len_counts</span></a> <a href="#local_max_codeword_len_1003"><span class="LIDENT">max_codeword_len</span></a> <a href="#local_num_syms_1002"><span class="LIDENT">num_syms</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-reverse_codeword"><span class="LIDENT">reverse_codeword</span></span> <span id="local_codeword_1011"><span class="LIDENT">codeword</span></span> <span id="local_len_1012"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_codeword_1013"><span class="LIDENT">codeword</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1011"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x5555</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1011"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xAAAA</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_codeword_1014"><span class="LIDENT">codeword</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1013"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3333</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1013"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xCCCC</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_codeword_1015"><span class="LIDENT">codeword</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1014"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x0F0F</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1014"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xF0F0</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_codeword_1016"><span class="LIDENT">codeword</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1015"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x00FF</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">8</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_codeword_1015"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xFF00</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_codeword_1016"><span class="LIDENT">codeword</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="LPAREN">(</span><span class="INT">16</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_1012"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-make_huffman_code"><span class="LIDENT">make_huffman_code</span></span> <span id="local_num_syms_1017"><span class="LIDENT">num_syms</span></span> <span id="local_max_codeword_len_1018"><span class="LIDENT">max_codeword_len</span></span> <span id="local_freqs_1019"><span class="LIDENT">freqs</span></span> <span id="local_lens_1020"><span class="LIDENT">lens</span></span> <span id="local_codewords_1021"><span class="LIDENT">codewords</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">make_canonical_huffman_code</span> <a href="#local_num_syms_1017"><span class="LIDENT">num_syms</span></a> <a href="#local_max_codeword_len_1018"><span class="LIDENT">max_codeword_len</span></a> <a href="#local_freqs_1019"><span class="LIDENT">freqs</span></a> <a href="#local_lens_1020"><span class="LIDENT">lens</span></a> <a href="#local_codewords_1021"><span class="LIDENT">codewords</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_num_syms_1017"><span class="LIDENT">num_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_codewords_1021"><span class="LIDENT">codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">reverse_codeword</span> <a href="#local_codewords_1021"><span class="LIDENT">codewords</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="#local_lens_1020"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-make_huffman_codes"><span class="LIDENT">make_huffman_codes</span></span> <span id="local_freqs_1022"><span class="LIDENT">freqs</span></span> <span id="local_codes_1023"><span class="LIDENT">codes</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">make_huffman_code</span> <span class="LIDENT">_num_litlen_syms</span> <span class="LIDENT">_max_litlen_codeword_len</span> <a href="#local_freqs_1022"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="EOL">
</span>        <a href="#local_codes_1023"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span> <a href="#local_codes_1023"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">make_huffman_code</span> <span class="LIDENT">_num_offset_syms</span> <span class="LIDENT">_max_offset_codeword_len</span> <a href="#local_freqs_1022"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">offset</span><span class="EOL">
</span>          <a href="#local_codes_1023"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span> <a href="#local_codes_1023"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-init_static_codes"><span class="LIDENT">init_static_codes</span></span> <span id="local_freqs_1024"><span class="LIDENT">freqs</span></span> <span id="local_static_codes_1025"><span class="LIDENT">static_codes</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="INT">143</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_freqs_1024"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><span class="INT">9</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">144</span> <span class="TO">to</span> <span class="INT">255</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_freqs_1024"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><span class="INT">9</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">9</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">256</span> <span class="TO">to</span> <span class="INT">279</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_freqs_1024"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><span class="INT">9</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">7</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">280</span> <span class="TO">to</span> <span class="INT">287</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_freqs_1024"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><span class="INT">9</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="INT">31</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_freqs_1024"><span class="LIDENT">freqs</span></a><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">5</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">make_huffman_codes</span> <a href="#local_freqs_1024"><span class="LIDENT">freqs</span></a> <a href="#local_static_codes_1025"><span class="LIDENT">static_codes</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-init_offset_slot_fast"><span class="LIDENT">init_offset_slot_fast</span></span> <span id="local_offset_slot_fast_1026"><span class="LIDENT">offset_slot_fast</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">offset_slot</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <span class="LIDENT">_base_dist</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_offset_1027"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_base_dist</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">offset_slot</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_offset_end_1028"><span class="LIDENT">offset_end</span></span> <span class="EQUAL">=</span> <a href="#local_offset_1027"><span class="LIDENT">offset</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">offset_slot</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <a href="#local_offset_1027"><span class="LIDENT">offset</span></a> <span class="TO">to</span> <a href="#local_offset_end_1028"><span class="LIDENT">offset_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_offset_slot_fast_1026"><span class="LIDENT">offset_slot_fast</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">offset_slot</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-add_bits"><span class="LIDENT">add_bits</span></span> <span id="local_os_1029"><span class="LIDENT">os</span></span> <span id="local_bits_1030"><span class="LIDENT">bits</span></span> <span id="local_num_bits_1031"><span class="LIDENT">num_bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_bits_1030"><span class="LIDENT">bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_num_bits_1031"><span class="LIDENT">num_bits</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">16</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint16_le</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1029"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-flush_bits"><span class="LIDENT">flush_bits</span></span> <span id="local_os_1032"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="INFIXOP0">&gt;=</span> <span class="INT">8</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1032"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-write_block_header"><span class="LIDENT">write_block_header</span></span> <span id="local_os_1033"><span class="LIDENT">os</span></span> <span id="local_is_final_block_1034"><span class="LIDENT">is_final_block</span></span> <span id="local_block_type_1035"><span class="LIDENT">block_type</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">add_bits</span> <a href="#local_os_1033"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_is_final_block_1034"><span class="LIDENT">is_final_block</span></a> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1033"><span class="LIDENT">os</span></a> <a href="#local_block_type_1035"><span class="LIDENT">block_type</span></a> <span class="INT">2</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-align_bitstream"><span class="LIDENT">align_bitstream</span></span> <span id="local_os_1036"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_os_1036"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1036"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a><a href="#local_os_1036"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">7</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">flush_bits</span> <a href="#local_os_1036"><span class="LIDENT">os</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-put_unaligned_le16"><span class="LIDENT">put_unaligned_le16</span></span> <span id="local_os_1037"><span class="LIDENT">os</span></span> <span id="local_v_1038"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_os_1037"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_os_1037"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LPAREN">(</span><a href="#local_v_1038"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_os_1037"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LPAREN">(</span><a href="#local_os_1037"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_v_1038"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xff</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_os_1037"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1037"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-memcpy"><span class="LIDENT">memcpy</span></span> <span id="local_src_1039"><span class="LIDENT">src</span></span> <span class="TILDE">~</span><span id="local_src_off_1040"><span class="LIDENT">src_off</span></span> <span id="local_dst_1041"><span class="LIDENT">dst</span></span> <span class="TILDE">~</span><span id="local_dst_off_1042"><span class="LIDENT">dst_off</span></span> <span class="TILDE">~</span><span id="local_len_1043"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len0_1044"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_1043"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_len1_1045"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_1043"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_1045"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_1046"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_v_1047"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_src_1039"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_1040"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1046"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst_1041"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_1042"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1046"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_1047"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_1044"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_i_1048"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_1045"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_v_1049"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_1039"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_1040"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1048"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst_1041"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_1042"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1048"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_1049"><span class="LIDENT">v</span></a><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-write_uncompressed_block"><span class="LIDENT">write_uncompressed_block</span></span> <span id="local_os_1050"><span class="LIDENT">os</span></span> <span id="local_len_1051"><span class="LIDENT">len</span></span> <span id="local_is_final_block_1052"><span class="LIDENT">is_final_block</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">write_block_header</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a> <a href="#local_is_final_block_1052"><span class="LIDENT">is_final_block</span></a> <span class="LIDENT">blocktype_uncompressed</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">align_bitstream</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <span class="INT">4</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1051"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">put_unaligned_le16</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a> <a href="#local_len_1051"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">put_unaligned_le16</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <a href="#local_len_1051"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">memcpy</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LABEL">~src_off:</span><a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <span class="LABEL">~dst_off:</span><a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="TILDE">~</span><a href="#local_len_1051"><span class="LIDENT">len</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1050"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1051"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.module-Ns.val-write_uncompressed_blocks"><span class="LIDENT">write_uncompressed_blocks</span></span> <span id="local_os_1053"><span class="LIDENT">os</span></span> <span id="local_block_length_1054"><span class="LIDENT">block_length</span></span> <span id="local_is_final_block_1055"><span class="LIDENT">is_final_block</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_os_1053"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1053"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1056"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_block_length_1054"><span class="LIDENT">block_length</span></a> <span class="INT">65535</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">write_uncompressed_block</span> <a href="#local_os_1053"><span class="LIDENT">os</span></a> <a href="#local_len_1056"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="#local_is_final_block_1055"><span class="LIDENT">is_final_block</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_os_1053"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1056"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_os_1053"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">write_uncompressed_blocks</span> <a href="#local_os_1053"><span class="LIDENT">os</span></a> <a href="#local_block_length_1054"><span class="LIDENT">block_length</span></a> <a href="#local_is_final_block_1055"><span class="LIDENT">is_final_block</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-flush_output"><span class="LIDENT">flush_output</span></span> <span id="local_os_1057"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <span class="THEN">then</span> <span class="LIDENT">err_unexpected_end_of_output</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">hold</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">8</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_os_1057"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_pos</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-compress_none"><span class="LIDENT">compress_none</span></span> <span id="local__c_1058"><span class="LIDENT">_c</span></span> <span id="local_i_1059"><span class="LIDENT">i</span></span> <span id="local_o_1060"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_os_1061"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span> <span class="LIDENT">init_output</span> <a href="#local_i_1059"><span class="LIDENT">i</span></a> <a href="#local_o_1060"><span class="LIDENT">o</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">write_uncompressed_blocks</span> <a href="#local_os_1061"><span class="LIDENT">os</span></a> <a href="#local_os_1061"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">o_len</span> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">flush_output</span> <a href="#local_os_1061"><span class="LIDENT">os</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-compute_precode_items"><span class="LIDENT">compute_precode_items</span></span> <span id="local_lens_1062"><span class="LIDENT">lens</span></span> <span id="local_num_lens_1063"><span class="LIDENT">num_lens</span></span> <span id="local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></span> <span id="local_precode_items_1065"><span class="LIDENT">precode_items</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-fill"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">fill</span></a> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="RPAREN">)</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_itemptr_1066"><span class="LIDENT">itemptr</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_run_start_1067"><span class="LIDENT">run_start</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_num_lens_1063"><span class="LIDENT">num_lens</span></a> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_len_1068"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_lens_1062"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_run_end_1069"><span class="LIDENT">run_end</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_num_lens_1063"><span class="LIDENT">num_lens</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_len_1068"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_lens_1062"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_len_1068"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>              <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">11</span> <span class="DO">do</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_extra_bits_1070"><span class="LIDENT">extra_bits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">11</span><span class="RPAREN">)</span> <span class="INT">0x7F</span> <span class="IN">in</span><span class="EOL">
</span>                <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">18</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">18</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_precode_items_1065"><span class="LIDENT">precode_items</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">18</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_extra_bits_1070"><span class="LIDENT">extra_bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">5</span><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">11</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_bits_1070"><span class="LIDENT">extra_bits</span></a><span class="EOL">
</span>              <span class="DONE">done</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">3</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                  <span class="LET">let</span> <span id="local_extra_bits_1071"><span class="LIDENT">extra_bits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="INT">0x7</span> <span class="IN">in</span><span class="EOL">
</span>                  <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">17</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">17</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="#local_precode_items_1065"><span class="LIDENT">precode_items</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">17</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_extra_bits_1071"><span class="LIDENT">extra_bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">5</span><span class="RPAREN">)</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_bits_1071"><span class="LIDENT">extra_bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="END">end</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">4</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_1068"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_1068"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_precode_items_1065"><span class="LIDENT">precode_items</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_1068"><span class="LIDENT">len</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">3</span> <span class="DO">do</span><span class="EOL">
</span>                  <span class="LET">let</span> <span id="local_extra_bits_1072"><span class="LIDENT">extra_bits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="INT">0x3</span> <span class="IN">in</span><span class="EOL">
</span>                  <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">16</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">16</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="#local_precode_items_1065"><span class="LIDENT">precode_items</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">16</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_extra_bits_1072"><span class="LIDENT">extra_bits</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">5</span><span class="RPAREN">)</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_extra_bits_1072"><span class="LIDENT">extra_bits</span></a><span class="EOL">
</span>                <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_run_end_1069"><span class="LIDENT">run_end</span></a> <span class="DO">do</span><span class="EOL">
</span>              <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_1068"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_precode_freqs_1064"><span class="LIDENT">precode_freqs</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_len_1068"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_precode_items_1065"><span class="LIDENT">precode_items</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_1068"><span class="LIDENT">len</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_run_start_1067"><span class="LIDENT">run_start</span></a><span class="EOL">
</span>            <span class="DONE">done</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_itemptr_1066"><span class="LIDENT">itemptr</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-precompute_huffman_header"><span class="LIDENT">precompute_huffman_header</span></span> <span id="local_c_1073"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_f_1074"><span class="LIDENT">f</span></span> <span id="local_num_litlen_syms_1075"><span class="LIDENT">num_litlen_syms</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span><span class="EOL">
</span>          <a href="#local_num_litlen_syms_1075"><span class="LIDENT">num_litlen_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">257</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_num_litlen_syms_1075"><span class="LIDENT">num_litlen_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_num_litlen_syms_1075"><span class="LIDENT">num_litlen_syms</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_f_1074"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><a href="#local_num_litlen_syms_1075"><span class="LIDENT">num_litlen_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_f_1074"><span class="LIDENT">f</span></a> <span class="LIDENT">_num_litlen_syms</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span class="REC">rec</span> <span id="local_g_1076"><span class="LIDENT">g</span></span> <span id="local_num_offset_syms_1077"><span class="LIDENT">num_offset_syms</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="IF">if</span><span class="EOL">
</span>            <a href="#local_num_offset_syms_1077"><span class="LIDENT">num_offset_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">1</span><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_num_offset_syms_1077"><span class="LIDENT">num_offset_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>          <span class="THEN">then</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_num_offset_syms_1077"><span class="LIDENT">num_offset_syms</span></a><span class="EOL">
</span>          <span class="ELSE">else</span> <a href="#local_g_1076"><span class="LIDENT">g</span></a> <span class="LPAREN">(</span><a href="#local_num_offset_syms_1077"><span class="LIDENT">num_offset_syms</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_g_1076"><span class="LIDENT">g</span></a> <span class="LIDENT">_num_offset_syms</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_max1_1078"><span class="LIDENT">max1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <span class="LIDENT">min</span> <span class="LPAREN">(</span><a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span><span class="RPAREN">)</span> <span class="LIDENT">_num_litlen_syms</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_max2_1079"><span class="LIDENT">max2</span></span> <span class="EQUAL">=</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_max1_1078"><span class="LIDENT">max1</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max1_1078"><span class="LIDENT">max1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>              <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>                <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="DONE">done</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max2_1079"><span class="LIDENT">max2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>                <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_max1_1078"><span class="LIDENT">max1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_precode_items</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>            <span class="LIDENT">compute_precode_items</span><span class="EOL">
</span>              <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-append"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">append</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="LPAREN">(</span><a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span><span class="RPAREN">)</span><span class="EOL">
</span>              <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_freqs</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_items</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">make_huffman_code</span> <span class="LIDENT">_num_precode_syms</span> <span class="LIDENT">_max_pre_codeword_len</span><span class="EOL">
</span>            <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_freqs</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_lens</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_codewords</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span class="REC">rec</span> <span id="local_h_1080"><span class="LIDENT">h</span></span> <span id="local_num_explicit_lens_1081"><span class="LIDENT">num_explicit_lens</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="IF">if</span><span class="EOL">
</span>              <span class="LIDENT">_num_precode_syms</span> <span class="LESS">&lt;</span> <span class="INT">5</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_lens</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">zigzag</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_num_explicit_lens_1081"><span class="LIDENT">num_explicit_lens</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>            <span class="THEN">then</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_explicit_lens</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_num_explicit_lens_1081"><span class="LIDENT">num_explicit_lens</span></a><span class="EOL">
</span>            <span class="ELSE">else</span> <a href="#local_h_1080"><span class="LIDENT">h</span></a> <span class="LPAREN">(</span><a href="#local_num_explicit_lens_1081"><span class="LIDENT">num_explicit_lens</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_h_1080"><span class="LIDENT">h</span></a> <span class="LIDENT">_num_precode_syms</span><span class="EOL">
</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_max1_1082"><span class="LIDENT">max1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>                <span class="LIDENT">min</span> <span class="LPAREN">(</span><span class="LIDENT">_num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span><span class="RPAREN">)</span> <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span><span class="EOL">
</span>              <span class="IN">in</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_max2_1083"><span class="LIDENT">max2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">max</span> <span class="LPAREN">(</span><a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_max1_1082"><span class="LIDENT">max1</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>              <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max2_1083"><span class="LIDENT">max2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>                <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_max1_1082"><span class="LIDENT">max1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_max2_1083"><span class="LIDENT">max2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>                  <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_max2_1083"><span class="LIDENT">max2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="DONE">done</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_max1_1082"><span class="LIDENT">max1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>                  <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>                    <a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_c_1073"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="DONE">done</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-write_huffman_header"><span class="LIDENT">write_huffman_header</span></span> <span id="local_c_1084"><span class="LIDENT">c</span></span> <span id="local_os_1085"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">257</span><span class="RPAREN">)</span> <span class="INT">5</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_offset_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">5</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_explicit_lens</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <span class="INT">4</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_explicit_lens</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_lens</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">zigzag</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="INT">3</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_precode_items</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_precode_item_1086"><span class="LIDENT">precode_item</span></span> <span class="EQUAL">=</span> <a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_items</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_precode_sym_1087"><span class="LIDENT">precode_sym</span></span> <span class="EQUAL">=</span> <a href="#local_precode_item_1086"><span class="LIDENT">precode_item</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1F</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a><span class="EOL">
</span>            <a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_codewords</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_precode_sym_1087"><span class="LIDENT">precode_sym</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="#local_c_1084"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_lens</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_precode_sym_1087"><span class="LIDENT">precode_sym</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_precode_sym_1087"><span class="LIDENT">precode_sym</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">16</span> <span class="THEN">then</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_precode_sym_1087"><span class="LIDENT">precode_sym</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">16</span> <span class="THEN">then</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_precode_item_1086"><span class="LIDENT">precode_item</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">5</span><span class="RPAREN">)</span> <span class="INT">2</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_precode_sym_1087"><span class="LIDENT">precode_sym</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">17</span> <span class="THEN">then</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_precode_item_1086"><span class="LIDENT">precode_item</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">5</span><span class="RPAREN">)</span> <span class="INT">3</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1085"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_precode_item_1086"><span class="LIDENT">precode_item</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">5</span><span class="RPAREN">)</span> <span class="INT">7</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-write_sequences"><span class="LIDENT">write_sequences</span></span> <span id="local_os_1088"><span class="LIDENT">os</span></span> <span id="local_codes_1089"><span class="LIDENT">codes</span></span> <span id="local_sequences_1090"><span class="LIDENT">sequences</span></span> <span id="local_in_next_1091"><span class="LIDENT">in_next</span></span> <span id="local_in_next_i_1092"><span class="LIDENT">in_next_i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_f_1093"><span class="LIDENT">f</span></span> <span id="local_seq_1094"><span class="LIDENT">seq</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_litrunlen_1095"><span class="LIDENT">litrunlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_seq_1094"><span class="LIDENT">seq</span></a><span class="DOT">.</span><span class="LIDENT">litrunlen_and_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x7FFF</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_length_1096"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="#local_seq_1094"><span class="LIDENT">seq</span></a><span class="DOT">.</span><span class="LIDENT">litrunlen_and_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">15</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">4</span> <span class="DO">do</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_lit0_1097"><span class="LIDENT">lit0</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_lit1_1098"><span class="LIDENT">lit1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_lit2_1099"><span class="LIDENT">lit2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_lit3_1100"><span class="LIDENT">lit3</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit0_1097"><span class="LIDENT">lit0</span></a><span class="RPAREN">)</span> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit0_1097"><span class="LIDENT">lit0</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit1_1098"><span class="LIDENT">lit1</span></a><span class="RPAREN">)</span> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit1_1098"><span class="LIDENT">lit1</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit2_1099"><span class="LIDENT">lit2</span></a><span class="RPAREN">)</span> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit2_1099"><span class="LIDENT">lit2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit3_1100"><span class="LIDENT">lit3</span></a><span class="RPAREN">)</span> <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_lit3_1100"><span class="LIDENT">lit3</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">4</span><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                  <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                  <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                  <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span>                  <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                      <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a><span class="EOL">
</span>                                                <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                      <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                  <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="EOL">
</span>                  <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_litrunlen_1095"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span>                      <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                          <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a><span class="EOL">
</span>                                                    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                          <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_in_next_1091"><span class="LIDENT">in_next</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_length_1096"><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_next_i_1092"><span class="LIDENT">in_next_i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_length_1096"><span class="LIDENT">length</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_length_slot_1101"><span class="LIDENT">length_slot</span></span> <span class="EQUAL">=</span> <a href="#local_seq_1094"><span class="LIDENT">seq</span></a><span class="DOT">.</span><span class="LIDENT">length_slot</span> <span class="IN">in</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_litlen_symbol_1102"><span class="LIDENT">litlen_symbol</span></span> <span class="EQUAL">=</span> <span class="INT">257</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_length_slot_1101"><span class="LIDENT">length_slot</span></a> <span class="IN">in</span><span class="EOL">
</span>              <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_litlen_symbol_1102"><span class="LIDENT">litlen_symbol</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_litlen_symbol_1102"><span class="LIDENT">litlen_symbol</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                  <span class="LPAREN">(</span><a href="#local_length_1096"><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_base_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_slot_1101"><span class="LIDENT">length_slot</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>                  <span class="LIDENT">_extra_lbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_slot_1101"><span class="LIDENT">length_slot</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_offset_symbol_1103"><span class="LIDENT">offset_symbol</span></span> <span class="EQUAL">=</span> <a href="#local_seq_1094"><span class="LIDENT">seq</span></a><span class="DOT">.</span><span class="LIDENT">offset_symbol</span> <span class="IN">in</span><span class="EOL">
</span>                <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                  <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_symbol_1103"><span class="LIDENT">offset_symbol</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                  <a href="#local_codes_1089"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_symbol_1103"><span class="LIDENT">offset_symbol</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LIDENT">add_bits</span> <a href="#local_os_1088"><span class="LIDENT">os</span></a><span class="EOL">
</span>                    <span class="LPAREN">(</span><a href="#local_seq_1094"><span class="LIDENT">seq</span></a><span class="DOT">.</span><span class="LIDENT">offset</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_base_dist</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_symbol_1103"><span class="LIDENT">offset_symbol</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>                    <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_symbol_1103"><span class="LIDENT">offset_symbol</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_f_1093"><span class="LIDENT">f</span></a> <a href="#local_sequences_1090"><span class="LIDENT">sequences</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-write_end_of_block"><span class="LIDENT">write_end_of_block</span></span> <span id="local_os_1104"><span class="LIDENT">os</span></span> <span id="local_codes_1105"><span class="LIDENT">codes</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">add_bits</span> <a href="#local_os_1104"><span class="LIDENT">os</span></a><span class="EOL">
</span>        <a href="#local_codes_1105"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">codewords</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_end_of_block</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_codes_1105"><span class="LIDENT">codes</span></a><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_end_of_block</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">flush_bits</span> <a href="#local_os_1104"><span class="LIDENT">os</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-flush_block"><span class="LIDENT">flush_block</span></span> <span id="local_c_1106"><span class="LIDENT">c</span></span> <span id="local_os_1107"><span class="LIDENT">os</span></span> <span id="local_block_1108"><span class="LIDENT">block</span></span> <span id="local_block_begin_1109"><span class="LIDENT">block_begin</span></span> <span id="local_block_length_1110"><span class="LIDENT">block_length</span></span> <span id="local_is_final_block_1111"><span class="LIDENT">is_final_block</span></span> <span id="local_sequences_1112"><span class="LIDENT">sequences</span></span><span class="EOL">
</span>        <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_extra_precode_bits_1113"><span class="LIDENT">extra_precode_bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LBRACKETBAR">[|</span><span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="INT">3</span><span class="SEMI">;</span> <span class="INT">7</span><span class="BARRBRACKET">|]</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_static_cost_1115"><span class="LIDENT">static_cost</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_uncompressed_cost_1116"><span class="LIDENT">uncompressed_cost</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_end_of_block</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_end_of_block</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">make_huffman_codes</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">precompute_huffman_header</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="INT">3</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">num_explicit_lens</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">_num_precode_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_extra_1117"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <a href="#local_extra_precode_bits_1113"><span class="LIDENT">extra_precode_bits</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_freqs</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LPAREN">(</span><a href="#local_extra_1117"><span class="LIDENT">extra</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">precode_lens</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="INT">255</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="INT">143</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">144</span> <span class="TO">to</span> <span class="INT">255</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">9</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">7</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">257</span> <span class="TO">to</span> <span class="INT">257</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <span class="LIDENT">_extra_lbits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_extra_1118"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_lbits</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">257</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LPAREN">(</span><a href="#local_extra_1118"><span class="LIDENT">extra</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="EOL">
</span>                <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LPAREN">(</span><a href="#local_extra_1118"><span class="LIDENT">extra</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">static_codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">sym</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <span class="LIDENT">_extra_dbits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">3</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_extra_1119"><span class="LIDENT">extra</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_extra_dbits</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LPAREN">(</span><a href="#local_extra_1119"><span class="LIDENT">extra</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="DOT">.</span><span class="LIDENT">lens</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">sym</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LPAREN">(</span><a href="#local_extra_1119"><span class="LIDENT">extra</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">5</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_uncompressed_cost_1116"><span class="LIDENT">uncompressed_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_uncompressed_cost_1116"><span class="LIDENT">uncompressed_cost</span></a><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a><span class="LPAREN">(</span><a href="#local_os_1107"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">7</span><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">32</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="INT">40</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_block_length_1110"><span class="LIDENT">block_length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">65535</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">65535</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="INT">8</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_block_length_1110"><span class="LIDENT">block_length</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_block_type_1120"><span class="LIDENT">block_type</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_dynamic_cost_1114"><span class="LIDENT">dynamic_cost</span></a> <span class="LESS">&lt;</span> <span class="LIDENT">min</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_uncompressed_cost_1116"><span class="LIDENT">uncompressed_cost</span></a> <span class="THEN">then</span><span class="EOL">
</span>            <span class="LIDENT">blocktype_dynamic_huffman</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_static_cost_1115"><span class="LIDENT">static_cost</span></a> <span class="LESS">&lt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_uncompressed_cost_1116"><span class="LIDENT">uncompressed_cost</span></a> <span class="THEN">then</span><span class="EOL">
</span>            <span class="LIDENT">blocktype_static_huffman</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LIDENT">blocktype_uncompressed</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_block_type_1120"><span class="LIDENT">block_type</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">blocktype_uncompressed</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <a href="#local_os_1107"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_block_begin_1109"><span class="LIDENT">block_begin</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">write_uncompressed_blocks</span> <a href="#local_os_1107"><span class="LIDENT">os</span></a> <a href="#local_block_length_1110"><span class="LIDENT">block_length</span></a> <a href="#local_is_final_block_1111"><span class="LIDENT">is_final_block</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <span class="LIDENT">write_block_header</span> <a href="#local_os_1107"><span class="LIDENT">os</span></a> <a href="#local_is_final_block_1111"><span class="LIDENT">is_final_block</span></a> <a href="#local_block_type_1120"><span class="LIDENT">block_type</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_codes_1121"><span class="LIDENT">codes</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_block_type_1120"><span class="LIDENT">block_type</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">blocktype_dynamic_huffman</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <span class="LIDENT">write_huffman_header</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a> <a href="#local_os_1107"><span class="LIDENT">os</span></a> <span class="SEMI">;</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">codes</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <a href="#local_c_1106"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">static_codes</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">write_sequences</span> <a href="#local_os_1107"><span class="LIDENT">os</span></a> <a href="#local_codes_1121"><span class="LIDENT">codes</span></a> <a href="#local_sequences_1112"><span class="LIDENT">sequences</span></a> <a href="#local_block_1108"><span class="LIDENT">block</span></a> <a href="#local_block_begin_1109"><span class="LIDENT">block_begin</span></a><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">write_end_of_block</span> <a href="#local_os_1107"><span class="LIDENT">os</span></a> <a href="#local_codes_1121"><span class="LIDENT">codes</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-init_block_split_stats"><span class="LIDENT">init_block_split_stats</span></span> <span id="local_stats_1122"><span class="LIDENT">stats</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-fill"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">fill</span></a> <a href="#local_stats_1122"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span> <span class="INT">0</span> <span class="LIDENT">num_observation_types</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-fill"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">fill</span></a> <a href="#local_stats_1122"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">observations</span> <span class="INT">0</span> <span class="LIDENT">num_observation_types</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_stats_1122"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_stats_1122"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-reset_symbol_frequencies"><span class="LIDENT">reset_symbol_frequencies</span></span> <span id="local_c_1123"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-fill"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">fill</span></a> <a href="#local_c_1123"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span> <span class="INT">0</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_c_1123"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="RPAREN">)</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-fill"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">fill</span></a> <a href="#local_c_1123"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">offset</span> <span class="INT">0</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_c_1123"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="RPAREN">)</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-num_observations_per_block_check"><span class="LIDENT">num_observations_per_block_check</span></span> <span class="EQUAL">=</span> <span class="INT">512</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-do_end_block_check"><span class="LIDENT">do_end_block_check</span></span> <span id="local_stats_1124"><span class="LIDENT">stats</span></span> <span id="local_block_length_1125"><span class="LIDENT">block_length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_f_1126"><span class="LIDENT">f</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_total_delta_1127"><span class="LIDENT">total_delta</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">num_observation_types</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_expected_1128"><span class="LIDENT">expected</span></span> <span class="EQUAL">=</span> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_actual_1129"><span class="LIDENT">actual</span></span> <span class="EQUAL">=</span> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_delta_1130"><span class="LIDENT">delta</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_actual_1129"><span class="LIDENT">actual</span></a> <span class="GREATER">&gt;</span> <a href="#local_expected_1128"><span class="LIDENT">expected</span></a> <span class="THEN">then</span> <a href="#local_actual_1129"><span class="LIDENT">actual</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_expected_1128"><span class="LIDENT">expected</span></a> <span class="ELSE">else</span> <a href="#local_expected_1128"><span class="LIDENT">expected</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_actual_1129"><span class="LIDENT">actual</span></a><span class="EOL">
</span>            <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_total_delta_1127"><span class="LIDENT">total_delta</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_total_delta_1127"><span class="LIDENT">total_delta</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_delta_1130"><span class="LIDENT">delta</span></a><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_total_delta_1127"><span class="LIDENT">total_delta</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_block_length_1125"><span class="LIDENT">block_length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">4096</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">num_observations_per_block_check</span><span class="EOL">
</span>                 <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">200</span><span class="EOL">
</span>                 <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">512</span><span class="EOL">
</span>                 <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span><span class="EOL">
</span>            <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_f_1126"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">num_observation_types</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>            <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_observations</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>              <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_stats_1124"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-should_end_block"><span class="LIDENT">should_end_block</span></span> <span id="local_stats_1131"><span class="LIDENT">stats</span></span> <span id="local_in_block_begin_1132"><span class="LIDENT">in_block_begin</span></span> <span id="local_in_next_1133"><span class="LIDENT">in_next</span></span> <span id="local_in_end_1134"><span class="LIDENT">in_end</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span><span class="EOL">
</span>        <a href="#local_stats_1131"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span> <span class="LESS">&lt;</span> <span class="LIDENT">num_observations_per_block_check</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_in_next_1133"><span class="LIDENT">in_next</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_in_block_begin_1132"><span class="LIDENT">in_block_begin</span></a> <span class="LESS">&lt;</span> <span class="LIDENT">_min_block_length</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_in_end_1134"><span class="LIDENT">in_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_in_next_1133"><span class="LIDENT">in_next</span></a> <span class="LESS">&lt;</span> <span class="LIDENT">_min_block_length</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">do_end_block_check</span> <a href="#local_stats_1131"><span class="LIDENT">stats</span></a> <span class="LPAREN">(</span><a href="#local_in_next_1133"><span class="LIDENT">in_next</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_in_block_begin_1132"><span class="LIDENT">in_block_begin</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.module-Ns.val-_lz_extend"><span class="LIDENT">_lz_extend</span></span> <span id="local_i_1135"><span class="LIDENT">i</span></span> <span id="local_start_pos_1136"><span class="LIDENT">start_pos</span></span> <span id="local_match_pos_1137"><span class="LIDENT">match_pos</span></span> <span id="local_len_1138"><span class="LIDENT">len</span></span> <span id="local_max_len_1139"><span class="LIDENT">max_len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span><span class="EOL">
</span>        <a href="#local_len_1138"><span class="LIDENT">len</span></a> <span class="LESS">&lt;</span> <a href="#local_max_len_1139"><span class="LIDENT">max_len</span></a><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_i_1135"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_match_pos_1137"><span class="LIDENT">match_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1138"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>           <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_i_1135"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_start_pos_1136"><span class="LIDENT">start_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1138"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LIDENT">_lz_extend</span> <a href="#local_i_1135"><span class="LIDENT">i</span></a> <a href="#local_start_pos_1136"><span class="LIDENT">start_pos</span></a> <a href="#local_match_pos_1137"><span class="LIDENT">match_pos</span></a> <span class="LPAREN">(</span><a href="#local_len_1138"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_max_len_1139"><span class="LIDENT">max_len</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_len_1138"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.module-Ns.val-lz_extend"><span class="LIDENT">lz_extend</span></span> <span id="local_i_1140"><span class="LIDENT">i</span></span> <span id="local_start_pos_1141"><span class="LIDENT">start_pos</span></span> <span id="local_match_pos_1142"><span class="LIDENT">match_pos</span></span> <span id="local_len_1143"><span class="LIDENT">len</span></span> <span id="local_max_len_1144"><span class="LIDENT">max_len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span><span class="EOL">
</span>        <a href="#local_max_len_1144"><span class="LIDENT">max_len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_1143"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">4</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_i_1140"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_match_pos_1142"><span class="LIDENT">match_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1143"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>           <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_i_1140"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_start_pos_1141"><span class="LIDENT">start_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1143"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LIDENT">lz_extend</span> <a href="#local_i_1140"><span class="LIDENT">i</span></a> <a href="#local_start_pos_1141"><span class="LIDENT">start_pos</span></a> <a href="#local_match_pos_1142"><span class="LIDENT">match_pos</span></a> <span class="LPAREN">(</span><a href="#local_len_1143"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="#local_max_len_1144"><span class="LIDENT">max_len</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">_lz_extend</span> <a href="#local_i_1140"><span class="LIDENT">i</span></a> <a href="#local_start_pos_1141"><span class="LIDENT">start_pos</span></a> <a href="#local_match_pos_1142"><span class="LIDENT">match_pos</span></a> <a href="#local_len_1143"><span class="LIDENT">len</span></a> <a href="#local_max_len_1144"><span class="LIDENT">max_len</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-hc_matchfinder_slide_window"><span class="LIDENT">hc_matchfinder_slide_window</span></span> <span id="local_mf_1145"><span class="LIDENT">mf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_mf_1145"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <a href="#local_mf_1145"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_mf_1145"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">window_size</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_mf_1145"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>          <a href="#local_mf_1145"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_mf_1145"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">window_size</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-lz_hash"><span class="LIDENT">lz_hash</span></span> <span id="local_i_1146"><span class="LIDENT">i</span></span> <span id="local_pos_1147"><span class="LIDENT">pos</span></span> <span id="local_num_bits_1148"><span class="LIDENT">num_bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_1149"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_i_1146"><span class="LIDENT">i</span></a> <a href="#local_pos_1147"><span class="LIDENT">pos</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/int32.ml.html"><span class="UIDENT">Int32</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int32.ml.html#val-to_int"><span class="LIDENT">to_int</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int32.ml.html#val-shift_right_logical"><span class="LIDENT">shift_right_logical</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int32.ml.html#val-mul"><span class="LIDENT">mul</span></a> <a href="#local_v_1149"><span class="LIDENT">v</span></a> <span class="INT">0x1E35A7BDl</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="INT">32</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_num_bits_1148"><span class="LIDENT">num_bits</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.module-Ns.val-_matchfinder_longest_rec"><span class="LIDENT">_matchfinder_longest_rec</span></span><span class="EOL">
</span>        <span id="local_cur_node_1150"><span class="LIDENT">cur_node</span></span> <span id="local_best_matchptr_1151"><span class="LIDENT">best_matchptr</span></span> <span id="local_os_1152"><span class="LIDENT">os</span></span> <span id="local_lens_1153"><span class="LIDENT">lens</span></span> <span id="local_mf_1154"><span class="LIDENT">mf</span></span> <span id="local_depth_remaining_1155"><span class="LIDENT">depth_remaining</span></span> <span id="local_cutoff_1156"><span class="LIDENT">cutoff</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_matchptr_1157"><span class="LIDENT">matchptr</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_os_1152"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-lnot"><span class="LIDENT">lnot</span></a> <span class="LPAREN">(</span><span class="LIDENT">window_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_cur_node_1150"><span class="LIDENT">cur_node</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_os_1152"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_matchptr_1157"><span class="LIDENT">matchptr</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_os_1152"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_os_1152"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_cur_node_1158"><span class="LIDENT">cur_node</span></span> <span class="EQUAL">=</span> <a href="#local_mf_1154"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_cur_node_1150"><span class="LIDENT">cur_node</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LIDENT">window_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_depth_remaining_1159"><span class="LIDENT">depth_remaining</span></span> <span class="EQUAL">=</span> <a href="#local_depth_remaining_1155"><span class="LIDENT">depth_remaining</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_cur_node_1158"><span class="LIDENT">cur_node</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_cutoff_1156"><span class="LIDENT">cutoff</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_depth_remaining_1159"><span class="LIDENT">depth_remaining</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_best_matchptr_1151"><span class="LIDENT">best_matchptr</span></a><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="LIDENT">_matchfinder_longest_rec</span> <a href="#local_cur_node_1158"><span class="LIDENT">cur_node</span></a> <a href="#local_best_matchptr_1151"><span class="LIDENT">best_matchptr</span></a> <a href="#local_os_1152"><span class="LIDENT">os</span></a> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a> <a href="#local_mf_1154"><span class="LIDENT">mf</span></a><span class="EOL">
</span>            <a href="#local_depth_remaining_1159"><span class="LIDENT">depth_remaining</span></a> <a href="#local_cutoff_1156"><span class="LIDENT">cutoff</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1160"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">lz_extend</span> <a href="#local_os_1152"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_os_1152"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_matchptr_1157"><span class="LIDENT">matchptr</span></a> <span class="INT">0</span> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_len_1160"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">nice</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_1160"><span class="LIDENT">len</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_matchptr_1157"><span class="LIDENT">matchptr</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_best_matchptr_1161"><span class="LIDENT">best_matchptr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_len_1160"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>              <a href="#local_lens_1153"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_1160"><span class="LIDENT">len</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_matchptr_1157"><span class="LIDENT">matchptr</span></a><span class="EOL">
</span>            <span class="END">end</span><span class="EOL">
</span>            <span class="ELSE">else</span> <a href="#local_best_matchptr_1151"><span class="LIDENT">best_matchptr</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_cur_node_1162"><span class="LIDENT">cur_node</span></span> <span class="EQUAL">=</span> <a href="#local_mf_1154"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_cur_node_1150"><span class="LIDENT">cur_node</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LIDENT">window_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_depth_remaining_1163"><span class="LIDENT">depth_remaining</span></span> <span class="EQUAL">=</span> <a href="#local_depth_remaining_1155"><span class="LIDENT">depth_remaining</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_cur_node_1162"><span class="LIDENT">cur_node</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_cutoff_1156"><span class="LIDENT">cutoff</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_depth_remaining_1163"><span class="LIDENT">depth_remaining</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_best_matchptr_1161"><span class="LIDENT">best_matchptr</span></a><span class="EOL">
</span>          <span class="ELSE">else</span><span class="EOL">
</span>            <span class="LIDENT">_matchfinder_longest_rec</span> <a href="#local_cur_node_1162"><span class="LIDENT">cur_node</span></a> <a href="#local_best_matchptr_1161"><span class="LIDENT">best_matchptr</span></a> <a href="#local_os_1152"><span class="LIDENT">os</span></a> <a href="#local_lens_1153"><span class="LIDENT">lens</span></a> <a href="#local_mf_1154"><span class="LIDENT">mf</span></a><span class="EOL">
</span>              <a href="#local_depth_remaining_1163"><span class="LIDENT">depth_remaining</span></a> <a href="#local_cutoff_1156"><span class="LIDENT">cutoff</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-hc_matchfinder_longest_match"><span class="LIDENT">hc_matchfinder_longest_match</span></span> <span id="local_mf_1164"><span class="LIDENT">mf</span></span> <span id="local_os_1165"><span class="LIDENT">os</span></span> <span id="local_lens_1166"><span class="LIDENT">lens</span></span> <span id="local_max_search_depth_1167"><span class="LIDENT">max_search_depth</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_best_matchptr_1168"><span class="LIDENT">best_matchptr</span></span> <span class="EQUAL">=</span> <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_cur_pos_1169"><span class="LIDENT">cur_pos</span></span> <span class="EQUAL">=</span> <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LIDENT">window_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_cur_pos_1169"><span class="LIDENT">cur_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">hc_matchfinder_slide_window</span> <a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_cutoff_1170"><span class="LIDENT">cutoff</span></span> <span class="EQUAL">=</span> <a href="#local_cur_pos_1169"><span class="LIDENT">cur_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">window_size</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_lens_1166"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LESS">&lt;</span> <span class="INT">5</span> <span class="THEN">then</span> <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_best_matchptr_1168"><span class="LIDENT">best_matchptr</span></a><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_cur_node4_1171"><span class="LIDENT">cur_node4</span></span> <span class="EQUAL">=</span> <a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_hash4</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_hash4</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_cur_pos_1169"><span class="LIDENT">cur_pos</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_cur_pos_1169"><span class="LIDENT">cur_pos</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_cur_node4_1171"><span class="LIDENT">cur_node4</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_hash4</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>              <span class="LIDENT">lz_hash</span> <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LIDENT">hc_matchfinder_hash4_order</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_cur_node4_1171"><span class="LIDENT">cur_node4</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_cutoff_1170"><span class="LIDENT">cutoff</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_lens_1166"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_lens_1166"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">nice</span> <span class="THEN">then</span><span class="EOL">
</span>              <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_best_matchptr_1168"><span class="LIDENT">best_matchptr</span></a><span class="EOL">
</span>            <span class="ELSE">else</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_best_matchptr_1172"><span class="LIDENT">best_matchptr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>                <span class="LIDENT">_matchfinder_longest_rec</span> <a href="#local_cur_node4_1171"><span class="LIDENT">cur_node4</span></a> <a href="#local_best_matchptr_1168"><span class="LIDENT">best_matchptr</span></a> <a href="#local_os_1165"><span class="LIDENT">os</span></a> <a href="#local_lens_1166"><span class="LIDENT">lens</span></a> <a href="#local_mf_1164"><span class="LIDENT">mf</span></a><span class="EOL">
</span>                  <a href="#local_max_search_depth_1167"><span class="LIDENT">max_search_depth</span></a> <a href="#local_cutoff_1170"><span class="LIDENT">cutoff</span></a> <span class="IN">in</span><span class="EOL">
</span>              <a href="#local_os_1165"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_best_matchptr_1172"><span class="LIDENT">best_matchptr</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Def.module-Ns.val-_matchfinder_skip_rec"><span class="LIDENT">_matchfinder_skip_rec</span></span> <span id="local_os_1173"><span class="LIDENT">os</span></span> <span id="local_mf_1174"><span class="LIDENT">mf</span></span> <span id="local_remaining_1175"><span class="LIDENT">remaining</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_remaining_1175"><span class="LIDENT">remaining</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_remaining_1176"><span class="LIDENT">remaining</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_cur_pos_1177"><span class="LIDENT">cur_pos</span></span> <span class="EQUAL">=</span> <a href="#local_os_1173"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LPAREN">(</span><span class="LIDENT">window_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_cur_pos_1177"><span class="LIDENT">cur_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_os_1173"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">hc_matchfinder_slide_window</span> <a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_cur_pos_1177"><span class="LIDENT">cur_pos</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_hash4</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">hash4_tab</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_hash4</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_cur_pos_1177"><span class="LIDENT">cur_pos</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_os_1173"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1173"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_mf_1174"><span class="LIDENT">mf</span></a><span class="DOT">.</span><span class="LIDENT">next_hash4</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">lz_hash</span> <a href="#local_os_1173"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_os_1173"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LIDENT">hc_matchfinder_hash4_order</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">_matchfinder_skip_rec</span> <a href="#local_os_1173"><span class="LIDENT">os</span></a> <a href="#local_mf_1174"><span class="LIDENT">mf</span></a> <span class="LPAREN">(</span><a href="#local_remaining_1176"><span class="LIDENT">remaining</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-hc_matchfinder_skip_positions"><span class="LIDENT">hc_matchfinder_skip_positions</span></span> <span id="local_mf_1178"><span class="LIDENT">mf</span></span> <span id="local_os_1179"><span class="LIDENT">os</span></span> <span id="local_count_1180"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_count_1180"><span class="LIDENT">count</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">5</span> <span class="GREATER">&gt;</span> <a href="#local_os_1179"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1179"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="THEN">then</span> <a href="#local_os_1179"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1179"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_count_1180"><span class="LIDENT">count</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">_matchfinder_skip_rec</span> <a href="#local_os_1179"><span class="LIDENT">os</span></a> <a href="#local_mf_1178"><span class="LIDENT">mf</span></a> <a href="#local_count_1180"><span class="LIDENT">count</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-choose_literal"><span class="LIDENT">choose_literal</span></span> <span id="local_c_1181"><span class="LIDENT">c</span></span> <span id="local_literal_1182"><span class="LIDENT">literal</span></span> <span id="local_litrunlen_1183"><span class="LIDENT">litrunlen</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_c_1181"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_literal_1182"><span class="LIDENT">literal</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_c_1181"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_literal_1182"><span class="LIDENT">literal</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_litrunlen_1183"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-choose_match"><span class="LIDENT">choose_match</span></span> <span id="local_c_1184"><span class="LIDENT">c</span></span> <span id="local_length_1185"><span class="LIDENT">length</span></span> <span id="local_offset_1186"><span class="LIDENT">offset</span></span> <span id="local_litrunlen_1187"><span class="LIDENT">litrunlen</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_length_slot_1188"><span class="LIDENT">length_slot</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_1185"><span class="LIDENT">length</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_offset_slot_1189"><span class="LIDENT">offset_slot</span></span> <span class="EQUAL">=</span> <a href="#local_c_1184"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">offset_slot_fast</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_1186"><span class="LIDENT">offset</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_c_1184"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">257</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_length_slot_1188"><span class="LIDENT">length_slot</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_c_1184"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">litlen</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">257</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_length_slot_1188"><span class="LIDENT">length_slot</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_c_1184"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_slot_1189"><span class="LIDENT">offset_slot</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_c_1184"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">freqs</span><span class="DOT">.</span><span class="LIDENT">offset</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_offset_slot_1189"><span class="LIDENT">offset_slot</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LBRACE">{</span><span class="EOL">
</span>          <span class="LIDENT">litrunlen_and_length</span><span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_length_1185"><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">15</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_litrunlen_1187"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_offset_1186"><span class="LIDENT">offset</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_length_slot_1188"><span class="LIDENT">length_slot</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">offset_symbol</span><span class="EQUAL">=</span> <a href="#local_offset_slot_1189"><span class="LIDENT">offset_slot</span></a><span class="EOL">
</span>        <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-observe_match"><span class="LIDENT">observe_match</span></span> <span id="local_stats_1190"><span class="LIDENT">stats</span></span> <span id="local_length_1191"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_1192"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">num_literal_observation_types</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="IF">if</span> <a href="#local_length_1191"><span class="LIDENT">length</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">9</span> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_stats_1190"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1192"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_stats_1190"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1192"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_stats_1190"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_stats_1190"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-observe_literal"><span class="LIDENT">observe_literal</span></span> <span id="local_stats_1193"><span class="LIDENT">stats</span></span> <span id="local_lit_1194"><span class="LIDENT">lit</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_1195"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_lit_1194"><span class="LIDENT">lit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">5</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x6</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_lit_1194"><span class="LIDENT">lit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_stats_1193"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1195"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_stats_1193"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">new_observations</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_1195"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_stats_1193"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_stats_1193"><span class="LIDENT">stats</span></a><span class="DOT">.</span><span class="LIDENT">num_new_observations</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-compress_greedy"><span class="LIDENT">compress_greedy</span></span> <span id="local_c_1196"><span class="LIDENT">c</span></span> <span id="local_i_1197"><span class="LIDENT">i</span></span> <span id="local_o_1198"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_os_1199"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span> <span class="LIDENT">init_output</span> <a href="#local_i_1197"><span class="LIDENT">i</span></a> <a href="#local_o_1198"><span class="LIDENT">o</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_lens_1200"><span class="LIDENT">lens</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LBRACE">{</span><span class="EOL">
</span>          <span class="LIDENT">best</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">nice</span><span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_c_1196"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">nice_match_length</span> <span class="LIDENT">_max_match_len</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">max</span><span class="EQUAL">=</span> <span class="LIDENT">_max_match_len</span><span class="EOL">
</span>        <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_hc_mf_1201"><span class="LIDENT">hc_mf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">hc_matchfinder_init</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_in_block_begin_1202"><span class="LIDENT">in_block_begin</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_in_max_block_end_1203"><span class="LIDENT">in_max_block_end</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">min</span> <span class="LPAREN">(</span><a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="RPAREN">)</span> <span class="LIDENT">_soft_max_block_length</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_litrunlen_1204"><span class="LIDENT">litrunlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_seqs_1205"><span class="LIDENT">seqs</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">init_block_split_stats</span> <span class="LIDENT">split_stats</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">reset_symbol_frequencies</span> <a href="#local_c_1196"><span class="LIDENT">c</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="WHILE">while</span><span class="EOL">
</span>            <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESS">&lt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_max_block_end_1203"><span class="LIDENT">in_max_block_end</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a><span class="EOL">
</span>                 <span class="LPAREN">(</span><span class="LIDENT">should_end_block</span> <span class="LIDENT">split_stats</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_block_begin_1202"><span class="LIDENT">in_block_begin</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="DO">do</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="GREATER">&gt;</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>              <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">nice</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">min</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">nice</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">max</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_min_match_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_offset_1206"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>                <span class="LIDENT">hc_matchfinder_longest_match</span> <a href="#local_hc_mf_1201"><span class="LIDENT">hc_mf</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a> <a href="#local_c_1196"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">max_search_depth</span><span class="EOL">
</span>              <span class="IN">in</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match_len</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <a href="#local_seqs_1205"><span class="LIDENT">seqs</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">choose_match</span> <a href="#local_c_1196"><span class="LIDENT">c</span></a> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <a href="#local_offset_1206"><span class="LIDENT">offset</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1204"><span class="LIDENT">litrunlen</span></a> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_seqs_1205"><span class="LIDENT">seqs</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_litrunlen_1204"><span class="LIDENT">litrunlen</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">0</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LIDENT">observe_match</span> <span class="LIDENT">split_stats</span> <a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LIDENT">hc_matchfinder_skip_positions</span> <a href="#local_hc_mf_1201"><span class="LIDENT">hc_mf</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_lens_1200"><span class="LIDENT">lens</span></a><span class="DOT">.</span><span class="LIDENT">best</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>                <span class="LIDENT">choose_literal</span> <a href="#local_c_1196"><span class="LIDENT">c</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint8</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="RPAREN">)</span> <a href="#local_litrunlen_1204"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="LIDENT">observe_literal</span> <span class="LIDENT">split_stats</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_seqs_1205"><span class="LIDENT">seqs</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a><span class="EOL">
</span>            <span class="INFIXOP1">@@</span> <span class="LBRACE">{</span><span class="EOL">
</span>                 <span class="LIDENT">litrunlen_and_length</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_litrunlen_1204"><span class="LIDENT">litrunlen</span></a><span class="EOL">
</span>               <span class="SEMI">;</span> <span class="LIDENT">offset</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>               <span class="SEMI">;</span> <span class="LIDENT">offset_symbol</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>               <span class="SEMI">;</span> <span class="LIDENT">length_slot</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>               <span class="RBRACE">}</span><span class="EOL">
</span>               <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_seqs_1205"><span class="LIDENT">seqs</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">flush_block</span> <a href="#local_c_1196"><span class="LIDENT">c</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a> <a href="#local_i_1197"><span class="LIDENT">i</span></a> <a href="#local_in_block_begin_1202"><span class="LIDENT">in_block_begin</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_block_begin_1202"><span class="LIDENT">in_block_begin</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_seqs_1205"><span class="LIDENT">seqs</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">flush_output</span> <a href="#local_os_1199"><span class="LIDENT">os</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-compress_lazy"><span class="LIDENT">compress_lazy</span></span> <span class="UNDERSCORE">_</span> <span class="UNDERSCORE">_</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="COMMENT">(* clecat: TO DO *)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-encoder"><span class="LIDENT">encoder</span></span> <span id="local_level_1207"><span class="LIDENT">level</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_level_1207"><span class="LIDENT">level</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_level_1207"><span class="LIDENT">level</span></a> <span class="GREATER">&gt;</span> <span class="INT">12</span> <span class="THEN">then</span> <span class="LIDENT">err_invalid_compression_level</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_min_size_to_compress_1208"><span class="LIDENT">min_size_to_compress</span></span> <span class="EQUAL">=</span> <span class="INT">56</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_level_1207"><span class="LIDENT">level</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1440"><span id="local_impl_1209"><span class="LIDENT">impl</span></span><span class="COMMA">,</span> <span id="local_max_search_depth_1210"><span class="LIDENT">max_search_depth</span></span><span class="COMMA">,</span> <span id="local_nice_match_length_1211"><span class="LIDENT">nice_match_length</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_level_1207"><span class="LIDENT">level</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_none</span><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">1</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_greedy</span><span class="COMMA">,</span> <span class="INT">2</span><span class="COMMA">,</span> <span class="INT">8</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">2</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_greedy</span><span class="COMMA">,</span> <span class="INT">6</span><span class="COMMA">,</span> <span class="INT">10</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">3</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_greedy</span><span class="COMMA">,</span> <span class="INT">12</span><span class="COMMA">,</span> <span class="INT">14</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">4</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_greedy</span><span class="COMMA">,</span> <span class="INT">24</span><span class="COMMA">,</span> <span class="INT">24</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">5</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_lazy</span><span class="COMMA">,</span> <span class="INT">20</span><span class="COMMA">,</span> <span class="INT">30</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">6</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_lazy</span><span class="COMMA">,</span> <span class="INT">40</span><span class="COMMA">,</span> <span class="INT">65</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">7</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_lazy</span><span class="COMMA">,</span> <span class="INT">100</span><span class="COMMA">,</span> <span class="INT">130</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">8</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_lazy</span><span class="COMMA">,</span> <span class="INT">150</span><span class="COMMA">,</span> <span class="INT">200</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compress_lazy</span><span class="COMMA">,</span> <span class="INT">200</span><span class="COMMA">,</span> <span class="INT">258</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_offset_slot_fast_1212"><span class="LIDENT">offset_slot_fast</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_match_offset</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">init_offset_slot_fast</span> <a href="#local_offset_slot_fast_1212"><span class="LIDENT">offset_slot_fast</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_litlen_1213"><span class="LIDENT">litlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_offset_1214"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_offset_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_freqs_1215"><span class="LIDENT">freqs</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_litlen_1213"><span class="LIDENT">litlen</span></a><span class="SEMI">;</span> <a href="#local_offset_1214"><span class="LIDENT">offset</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_litlen_1216"><span class="LIDENT">litlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_offset_1217"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_offset_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_lens_1218"><span class="LIDENT">lens</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_litlen_1216"><span class="LIDENT">litlen</span></a><span class="SEMI">;</span> <a href="#local_offset_1217"><span class="LIDENT">offset</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_litlen_1219"><span class="LIDENT">litlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_offset_1220"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_offset_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_codewords_1221"><span class="LIDENT">codewords</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_litlen_1219"><span class="LIDENT">litlen</span></a><span class="SEMI">;</span> <a href="#local_offset_1220"><span class="LIDENT">offset</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_codes_1222"><span class="LIDENT">codes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_lens_1218"><span class="LIDENT">lens</span></a><span class="SEMI">;</span> <a href="#local_codewords_1221"><span class="LIDENT">codewords</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_litlen_1223"><span class="LIDENT">litlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_offset_1224"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_offset_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_lens_1225"><span class="LIDENT">lens</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_litlen_1223"><span class="LIDENT">litlen</span></a><span class="SEMI">;</span> <a href="#local_offset_1224"><span class="LIDENT">offset</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_litlen_1226"><span class="LIDENT">litlen</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_litlen_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_offset_1227"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_offset_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_codewords_1228"><span class="LIDENT">codewords</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_litlen_1226"><span class="LIDENT">litlen</span></a><span class="SEMI">;</span> <a href="#local_offset_1227"><span class="LIDENT">offset</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_static_codes_1229"><span class="LIDENT">static_codes</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><a href="#local_lens_1225"><span class="LIDENT">lens</span></a><span class="SEMI">;</span> <a href="#local_codewords_1228"><span class="LIDENT">codewords</span></a><span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">init_static_codes</span> <a href="#local_freqs_1215"><span class="LIDENT">freqs</span></a> <a href="#local_static_codes_1229"><span class="LIDENT">static_codes</span></a><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_precode_freqs_1230"><span class="LIDENT">precode_freqs</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_precode_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_precode_lens_1231"><span class="LIDENT">precode_lens</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_precode_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_precode_codewords_1232"><span class="LIDENT">precode_codewords</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_num_precode_syms</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_precode_items_1233"><span class="LIDENT">precode_items</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="LIDENT">_num_litlen_syms</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_num_offset_syms</span><span class="RPAREN">)</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_num_litlen_syms_1234"><span class="LIDENT">num_litlen_syms</span></span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_num_offset_syms_1235"><span class="LIDENT">num_offset_syms</span></span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_num_explicit_lens_1236"><span class="LIDENT">num_explicit_lens</span></span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_num_precode_items_1237"><span class="LIDENT">num_precode_items</span></span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LPAREN">(</span> <a href="#local_impl_1209"><span class="LIDENT">impl</span></a><span class="EOL">
</span>            <span class="COMMA">,</span> <span class="LBRACE">{</span><span class="EOL">
</span>                <a href="#local_level_1207"><span class="LIDENT">level</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_min_size_to_compress_1208"><span class="LIDENT">min_size_to_compress</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_max_search_depth_1210"><span class="LIDENT">max_search_depth</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_nice_match_length_1211"><span class="LIDENT">nice_match_length</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_offset_slot_fast_1212"><span class="LIDENT">offset_slot_fast</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_freqs_1215"><span class="LIDENT">freqs</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_codes_1222"><span class="LIDENT">codes</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_static_codes_1229"><span class="LIDENT">static_codes</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_precode_freqs_1230"><span class="LIDENT">precode_freqs</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_precode_lens_1231"><span class="LIDENT">precode_lens</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_precode_codewords_1232"><span class="LIDENT">precode_codewords</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_precode_items_1233"><span class="LIDENT">precode_items</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_num_litlen_syms_1234"><span class="LIDENT">num_litlen_syms</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_num_offset_syms_1235"><span class="LIDENT">num_offset_syms</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_num_explicit_lens_1236"><span class="LIDENT">num_explicit_lens</span></a><span class="EOL">
</span>              <span class="SEMI">;</span> <a href="#local_num_precode_items_1237"><span class="LIDENT">num_precode_items</span></a><span class="EOL">
</span>              <span class="RBRACE">}</span> <span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-compress_bound"><span class="LIDENT">compress_bound</span></span> <span id="local_len_1238"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_max_blocks_1239"><span class="LIDENT">max_blocks</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LIDENT">max</span> <span class="INT">1</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_len_1238"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_min_block_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="LIDENT">_min_block_length</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="INT">5</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_max_blocks_1239"><span class="LIDENT">max_blocks</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1238"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_end_padding</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Def.module-Ns.val-deflate"><span class="LIDENT">deflate</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_level_1240"><span class="LIDENT">level</span></span> <span class="EQUAL">=</span> <span class="INT">4</span><span class="RPAREN">)</span> <span id="local_src_1241"><span class="LIDENT">src</span></span> <span id="local_dst_1242"><span class="LIDENT">dst</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1501"><span id="local_impl_1243"><span class="LIDENT">impl</span></span><span class="COMMA">,</span> <span id="local_c_1244"><span class="LIDENT">c</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">encoder</span> <a href="#local_level_1240"><span class="LIDENT">level</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_res_1245"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="IF">if</span> <span class="LIDENT">bigstring_length</span> <a href="#local_dst_1242"><span class="LIDENT">dst</span></a> <span class="LESS">&lt;</span> <span class="LIDENT">_end_padding</span> <span class="THEN">then</span> <span class="INT">0</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="IF">if</span> <span class="LIDENT">bigstring_length</span> <a href="#local_src_1241"><span class="LIDENT">src</span></a> <span class="LESS">&lt;</span> <a href="#local_c_1244"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">min_size_to_compress</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_os_1246"><span class="LIDENT">os</span></span> <span class="EQUAL">=</span> <span class="LIDENT">init_output</span> <a href="#local_src_1241"><span class="LIDENT">src</span></a> <a href="#local_dst_1242"><span class="LIDENT">dst</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="LIDENT">write_uncompressed_block</span> <a href="#local_os_1246"><span class="LIDENT">os</span></a> <span class="LPAREN">(</span><a href="#local_os_1246"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_os_1246"><span class="LIDENT">os</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span><span class="RPAREN">)</span> <span class="TRUE">true</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="LIDENT">flush_output</span> <a href="#local_os_1246"><span class="LIDENT">os</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <a href="#local_impl_1243"><span class="LIDENT">impl</span></a> <a href="#local_c_1244"><span class="LIDENT">c</span></a> <a href="#local_src_1241"><span class="LIDENT">src</span></a> <a href="#local_dst_1242"><span class="LIDENT">dst</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Ok</span> <a href="#local_res_1245"><span class="LIDENT">res</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Malformed</span> <span id="local_e_1247"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><a href="#local_e_1247"><span class="LIDENT">e</span></a> <span class="COLON">:</span> <span class="LIDENT">error</span> <span class="COLONGREATER">:&gt;</span> <span class="LBRACKETGREATER">[&gt;</span> <span class="LIDENT">error</span> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Lz77"><span class="MODULE">module</span> <span class="UIDENT">Lz77</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_max_match"><span class="LIDENT">_max_match</span></span> <span class="EQUAL">=</span> <span class="INT">258</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_min_match"><span class="LIDENT">_min_match</span></span> <span class="EQUAL">=</span> <span class="INT">3</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_min_lookahead"><span class="LIDENT">_min_lookahead</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_max_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-(.!())"><span class="LPAREN">(</span> <span class="DOTOP">.!</span><span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="RPAREN">)</span></span> <span id="local_buf_1248"><span class="LIDENT">buf</span></span> <span id="local_pos_1249"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_buf_1248"><span class="LIDENT">buf</span></a> <a href="#local_pos_1249"><span class="LIDENT">pos</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-(.![])"><span class="LPAREN">(</span> <span class="DOTOP">.!</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RPAREN">)</span></span> <span id="local_buf_1250"><span class="LIDENT">buf</span></span> <span id="local_pos_1251"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16</span> <a href="#local_buf_1250"><span class="LIDENT">buf</span></a> <a href="#local_pos_1251"><span class="LIDENT">pos</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-(.!{})"><span class="LPAREN">(</span> <span class="DOTOP">.!</span><span class="LBRACE">{</span><span class="RBRACE">}</span> <span class="RPAREN">)</span></span> <span id="local_buf_1252"><span class="LIDENT">buf</span></span> <span id="local_pos_1253"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_buf_1252"><span class="LIDENT">buf</span></a> <a href="#local_pos_1253"><span class="LIDENT">pos</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Lz77.type-deflate_configuration"><span class="TYPE">type</span> <span class="LIDENT">deflate_configuration</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>      <span id="def_1446"><span class="LIDENT">max_chain</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1593"><span class="LIDENT">max_lazy</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1570"><span class="LIDENT">good_length</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1553"><span class="LIDENT">nice_length</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Lz77.type-configuration"><span class="TYPE">type</span> <span class="LIDENT">configuration</span> <span class="EQUAL">=</span> <span id="module-Lz77.type-configuration.constructor-Copy"><span class="UIDENT">Copy</span></span> <span id="module-Lz77.type-configuration.constructor-Deflate"><span class="BAR">|</span> <span class="UIDENT">Deflate</span> <span class="OF">of</span> <span class="LIDENT">deflate_configuration</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_0"><span class="LIDENT">_0</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Copy</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_1"><span class="LIDENT">_1</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_2"><span class="LIDENT">_2</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">5</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">8</span><span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_3"><span class="LIDENT">_3</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">6</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_4"><span class="LIDENT">_4</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">4</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">16</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_5"><span class="LIDENT">_5</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_6"><span class="LIDENT">_6</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">16</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">128</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">128</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_7"><span class="LIDENT">_7</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">8</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">128</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">256</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_8"><span class="LIDENT">_8</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">128</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">258</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">1024</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_9"><span class="LIDENT">_9</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Deflate</span> <span class="LBRACE">{</span><span class="LIDENT">good_length</span><span class="EQUAL">=</span> <span class="INT">32</span><span class="SEMI">;</span> <span class="LIDENT">max_lazy</span><span class="EQUAL">=</span> <span class="INT">258</span><span class="SEMI">;</span> <span class="LIDENT">nice_length</span><span class="EQUAL">=</span> <span class="INT">258</span><span class="SEMI">;</span> <span class="LIDENT">max_chain</span><span class="EQUAL">=</span> <span class="INT">4096</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_mem_level"><span class="LIDENT">_mem_level</span></span> <span class="EQUAL">=</span> <span class="INT">8</span> <span class="COMMENT">(* default *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_hash_bits"><span class="LIDENT">_hash_bits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_mem_level</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">7</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_hash_size"><span class="LIDENT">_hash_size</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_hash_bits</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_hash_mask"><span class="LIDENT">_hash_mask</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_hash_size</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_hash_shift"><span class="LIDENT">_hash_shift</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">_hash_bits</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="LIDENT">_min_match</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_too_far"><span class="LIDENT">_too_far</span></span> <span class="EQUAL">=</span> <span class="INT">4096</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-update_hash"><span class="LIDENT">update_hash</span></span> <span id="local_hash_1254"><span class="LIDENT">hash</span></span> <span id="local_chr_1255"><span class="LIDENT">chr</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_hash_1254"><span class="LIDENT">hash</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LIDENT">_hash_shift</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lxor)"><span class="INFIXOP3">lxor</span></a> <a href="#local_chr_1255"><span class="LIDENT">chr</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="LIDENT">_hash_mask</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Lz77.type-src"><span class="TYPE">type</span> <span class="LIDENT">src</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="OF">of</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-in_channel"><span class="LIDENT">in_channel</span></a> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span class="OF">of</span> <span class="LIDENT">string</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span>  <span id="module-Lz77.type-decode"><span class="TYPE">type</span> <span class="LIDENT">decode</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Lz77.type-state"><span class="TYPE">type</span> <span class="LIDENT">state</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>      <span id="def_1560"><span class="LIDENT">src</span><span class="COLON">:</span> <span class="LIDENT">src</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1444"><span class="LIDENT">cfg</span><span class="COLON">:</span> <span class="LIDENT">configuration</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1436"><span class="LIDENT">level</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1490"><span class="MUTABLE">mutable</span> <span class="LIDENT">i</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1602"><span class="MUTABLE">mutable</span> <span class="LIDENT">i_pos</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1517"><span class="MUTABLE">mutable</span> <span class="LIDENT">i_len</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1515"><span class="LIDENT">l</span><span class="COLON">:</span> <span class="LIDENT">literals</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1547"><span class="LIDENT">d</span><span class="COLON">:</span> <span class="LIDENT">distances</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1549"><span class="LIDENT">w</span><span class="COLON">:</span> <span class="LIDENT">bigstring</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1522"><span class="LIDENT">wbits</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1441"><span class="MUTABLE">mutable</span> <span class="LIDENT">lookahead</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1438"><span class="MUTABLE">mutable</span> <span class="LIDENT">strstart</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1571"><span class="LIDENT">prev</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1472"><span class="LIDENT">head</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1459"><span class="MUTABLE">mutable</span> <span class="LIDENT">hash</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1538"><span class="MUTABLE">mutable</span> <span class="LIDENT">match_start</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1526"><span class="MUTABLE">mutable</span> <span class="LIDENT">match_length</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1432"><span class="MUTABLE">mutable</span> <span class="LIDENT">match_available</span><span class="COLON">:</span> <span class="LIDENT">bool</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1583"><span class="MUTABLE">mutable</span> <span class="LIDENT">insert</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1498"><span class="MUTABLE">mutable</span> <span class="LIDENT">prev_length</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1523"><span class="MUTABLE">mutable</span> <span class="LIDENT">prev_match</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1447"><span class="LIDENT">q</span><span class="COLON">:</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1521"><span class="MUTABLE">mutable</span> <span class="LIDENT">crc</span><span class="COLON">:</span> <span class="LIDENT">optint</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_1479"><span class="MUTABLE">mutable</span> <span class="LIDENT">k</span><span class="COLON">:</span> <span class="LIDENT">configuration</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">decode</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-max_dist"><span class="LIDENT">max_dist</span></span> <span id="local_s_1256"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_s_1256"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">wbits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_min_lookahead</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Lz77.exception-Break"><span class="EXCEPTION">exception</span> <span class="UIDENT">Break</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* cur is the head of the hash chain for the current string
   * and its distance is &lt;= _max_dist
   * prev_length &gt;= 1
   * len &gt;= _min_lookahead *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-longest_match"><span class="LIDENT">longest_match</span></span> <span class="LPAREN">(</span><span id="local_cfg_1257"><span class="LIDENT">cfg</span></span> <span class="COLON">:</span> <span class="LIDENT">deflate_configuration</span><span class="RPAREN">)</span> <span id="local_s_1258"><span class="LIDENT">s</span></span> <span id="local_cur_match_1259"><span class="LIDENT">cur_match</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wmask_1260"><span class="LIDENT">wmask</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">wbits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_end_1261"><span class="LIDENT">str_end</span></span> <span class="EQUAL">=</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_limit_1262"><span class="LIDENT">limit</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="GREATER">&gt;</span> <span class="LIDENT">max_dist</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">max_dist</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a> <span class="ELSE">else</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Stop when !cur becomes &lt;= limit. To somplify the code,
     * we prevent matches with the string of window index 0. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_cur_match_1263"><span class="LIDENT">cur_match</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_cur_match_1259"><span class="LIDENT">cur_match</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* current match *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_chain_length_1264"><span class="LIDENT">chain_length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_cfg_1257"><span class="LIDENT">cfg</span></a><span class="DOT">.</span><span class="LIDENT">good_length</span> <span class="THEN">then</span> <a href="#local_cfg_1257"><span class="LIDENT">cfg</span></a><span class="DOT">.</span><span class="LIDENT">max_chain</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_cfg_1257"><span class="LIDENT">cfg</span></a><span class="DOT">.</span><span class="LIDENT">max_chain</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* max hash chain length *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_1265"><span class="LIDENT">scan</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* current string *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_start_1266"><span class="LIDENT">scan_start</span></span> <span class="EQUAL">=</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_end_1267"><span class="LIDENT">scan_end</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_best_len_1268"><span class="LIDENT">best_len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* best match length so far *)</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="TRY">try</span><span class="EOL">
</span>       <span class="WHILE">while</span><span class="EOL">
</span>         <span class="LET">let</span> <span id="local_match'_1269"><span class="LIDENT">match'</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <span class="IN">in</span><span class="EOL">
</span>         <span class="IF">if</span><span class="EOL">
</span>           <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_best_len_1268"><span class="LIDENT">best_len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_end_1267"><span class="LIDENT">scan_end</span></a><span class="EOL">
</span>           <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a><span class="RBRACKET">]</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_scan_start_1266"><span class="LIDENT">scan_start</span></a><span class="EOL">
</span>         <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>           <a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_wmask_1260"><span class="LIDENT">wmask</span></a><span class="RPAREN">)</span><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_chain_length_1264"><span class="LIDENT">chain_length</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <span class="GREATER">&gt;</span> <a href="#local_limit_1262"><span class="LIDENT">limit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_chain_length_1264"><span class="LIDENT">chain_length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>         <span class="END">end</span><span class="EOL">
</span>         <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>           <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_match'_1269"><span class="LIDENT">match'</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <span class="LESS">&lt;</span> <a href="#local_str_end_1261"><span class="LIDENT">str_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>               <a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="EOL">
</span>               <span class="SEMI">;</span> <a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="EOL">
</span>             <span class="DONE">done</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <span class="LESS">&lt;</span> <a href="#local_str_end_1261"><span class="LIDENT">str_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="RBRACKET">]</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a><span class="RBRACKET">]</span> <span class="DO">do</span><span class="EOL">
</span>               <a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>               <span class="SEMI">;</span> <a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>             <span class="DONE">done</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <span class="LESS">&lt;</span> <a href="#local_str_end_1261"><span class="LIDENT">str_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="RBRACE">}</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a><span class="RBRACE">}</span> <span class="DO">do</span><span class="EOL">
</span>               <a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>               <span class="SEMI">;</span> <a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>             <span class="DONE">done</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="RBRACE">}</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_match'_1269"><span class="LIDENT">match'</span></a><span class="RBRACE">}</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_len_1270"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_max_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_str_end_1261"><span class="LIDENT">str_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>             <a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_str_end_1261"><span class="LIDENT">str_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><span class="LIDENT">_max_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_len_1270"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_best_len_1268"><span class="LIDENT">best_len</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>                 <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_start</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a><span class="EOL">
</span>                 <span class="SEMI">;</span> <a href="#local_best_len_1268"><span class="LIDENT">best_len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_len_1270"><span class="LIDENT">len</span></a><span class="EOL">
</span>                 <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_len_1270"><span class="LIDENT">len</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_cfg_1257"><span class="LIDENT">cfg</span></a><span class="DOT">.</span><span class="LIDENT">nice_length</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Break</span><span class="EOL">
</span>                 <span class="SEMI">;</span> <a href="#local_scan_end_1267"><span class="LIDENT">scan_end</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACKET">[</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_scan_1265"><span class="LIDENT">scan</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_best_len_1268"><span class="LIDENT">best_len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RBRACKET">]</span><span class="EOL">
</span>               <span class="END">end</span><span class="EOL">
</span>             <span class="SEMI">;</span> <a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_wmask_1260"><span class="LIDENT">wmask</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_chain_length_1264"><span class="LIDENT">chain_length</span></a><span class="EOL">
</span>             <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_cur_match_1263"><span class="LIDENT">cur_match</span></a> <span class="GREATER">&gt;</span> <a href="#local_limit_1262"><span class="LIDENT">limit</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_chain_length_1264"><span class="LIDENT">chain_length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>         <span class="END">end</span><span class="EOL">
</span>       <span class="DO">do</span><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="DONE">done</span><span class="EOL">
</span>     <span class="WITH">with</span> <span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_best_len_1268"><span class="LIDENT">best_len</span></a> <span class="INFIXOP0">&lt;=</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_best_len_1268"><span class="LIDENT">best_len</span></a> <span class="ELSE">else</span> <a href="#local_s_1258"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-eoi"><span class="LIDENT">eoi</span></span> <span id="local_s_1271"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_s_1271"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">bigstring_empty</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_s_1271"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_s_1271"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-min_int"><span class="LIDENT">min_int</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-src"><span class="LIDENT">src</span></span> <span id="local_d_1272"><span class="LIDENT">d</span></span> <span id="local_s_1273"><span class="LIDENT">s</span></span> <span id="local_j_1274"><span class="LIDENT">j</span></span> <span id="local_l_1275"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_j_1274"><span class="LIDENT">j</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_l_1275"><span class="LIDENT">l</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_j_1274"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_1275"><span class="LIDENT">l</span></a> <span class="GREATER">&gt;</span> <span class="LIDENT">bigstring_length</span> <a href="#local_s_1273"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <span class="LIDENT">invalid_bounds</span> <a href="#local_j_1274"><span class="LIDENT">j</span></a> <a href="#local_l_1275"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_l_1275"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">eoi</span> <a href="#local_d_1272"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_d_1272"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1273"><span class="LIDENT">s</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_1272"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_1274"><span class="LIDENT">j</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_d_1272"><span class="LIDENT">d</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_1274"><span class="LIDENT">j</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l_1275"><span class="LIDENT">l</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-i_rem"><span class="LIDENT">i_rem</span></span> <span id="local_s_1276"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_s_1276"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_len</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1276"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-src_rem"><span class="LIDENT">src_rem</span></span> <span id="local_s_1277"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_s_1277"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-io_buffer_size"><span class="LIDENT">io_buffer_size</span></span> <span class="EQUAL">=</span> <span class="INT">16384</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-refill"><span class="LIDENT">refill</span></span> <span id="local_k_1278"><span class="LIDENT">k</span></span> <span id="local_s_1279"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">src</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">eoi</span> <a href="#local_s_1279"><span class="LIDENT">s</span></a> <span class="SEMI">;</span> <a href="#local_k_1278"><span class="LIDENT">k</span></a> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">cfg</span> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span id="local_ic_1280"><span class="LIDENT">ic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_res_1281"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <span class="LIDENT">input_bigstring</span> <a href="#local_ic_1280"><span class="LIDENT">ic</span></a> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">src</span> <a href="#local_s_1279"><span class="LIDENT">s</span></a> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="INT">0</span> <a href="#local_res_1281"><span class="LIDENT">res</span></a> <span class="SEMI">;</span> <a href="#local_k_1278"><span class="LIDENT">k</span></a> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">cfg</span> <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_s_1279"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_k_1278"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-memcpy"><span class="LIDENT">memcpy</span></span> <span id="local_src_1282"><span class="LIDENT">src</span></span> <span class="TILDE">~</span><span id="local_src_off_1283"><span class="LIDENT">src_off</span></span> <span id="local_dst_1284"><span class="LIDENT">dst</span></span> <span class="TILDE">~</span><span id="local_dst_off_1285"><span class="LIDENT">dst_off</span></span> <span class="TILDE">~</span><span id="local_len_1286"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len0_1287"><span class="LIDENT">len0</span></span> <span class="EQUAL">=</span> <a href="#local_len_1286"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len1_1288"><span class="LIDENT">len1</span></span> <span class="EQUAL">=</span> <a href="#local_len_1286"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len1_1288"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_1289"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_1290"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint32</span> <a href="#local_src_1282"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_1283"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1289"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">unsafe_set_uint32</span> <a href="#local_dst_1284"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_1285"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1289"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_1290"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len0_1287"><span class="LIDENT">len0</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_1291"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_len1_1288"><span class="LIDENT">len1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_v_1292"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <a href="#local_src_1282"><span class="LIDENT">src</span></a> <span class="LPAREN">(</span><a href="#local_src_off_1283"><span class="LIDENT">src_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1291"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">unsafe_set_uint8</span> <a href="#local_dst_1284"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_dst_off_1285"><span class="LIDENT">dst_off</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_1291"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_v_1292"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-update_crc"><span class="LIDENT">update_crc</span></span> <span id="local_s_1293"><span class="LIDENT">s</span></span> <span id="local_len_1294"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_s_1293"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">crc</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">digest_bigstring</span> <a href="#local_s_1293"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <a href="#local_s_1293"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_len_1294"><span class="LIDENT">len</span></a> <a href="#local_s_1293"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">crc</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-insert_string"><span class="LIDENT">insert_string</span></span> <span id="local_s_1295"><span class="LIDENT">s</span></span> <span id="local_str_1296"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wmask_1297"><span class="LIDENT">wmask</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">wbits</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">update_hash</span> <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="#local_str_1296"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RBRACE">}</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LET">let</span> <span id="local_res_1298"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">head</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_str_1296"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_wmask_1297"><span class="LIDENT">wmask</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_res_1298"><span class="LIDENT">res</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">head</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_s_1295"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_str_1296"><span class="LIDENT">str</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_res_1298"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-succ_length"><span class="LIDENT">succ_length</span></span> <span id="local_literals_1299"><span class="LIDENT">literals</span></span> <span id="local_length_1300"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_literals_1299"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_1300"><span class="LIDENT">length</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>      <a href="#local_literals_1299"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="INT">256</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_length_1300"><span class="LIDENT">length</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-succ_distance"><span class="LIDENT">succ_distance</span></span> <span id="local_distances_1301"><span class="LIDENT">distances</span></span> <span id="local_distance_1302"><span class="LIDENT">distance</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_distances_1301"><span class="LIDENT">distances</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_distance</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <a href="#local_distance_1302"><span class="LIDENT">distance</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>      <a href="#local_distances_1301"><span class="LIDENT">distances</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">_distance</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <a href="#local_distance_1302"><span class="LIDENT">distance</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-emit_match"><span class="LIDENT">emit_match</span></span> <span id="local_s_1303"><span class="LIDENT">s</span></span> <span class="TILDE">~</span><span id="local_off_1304"><span class="LIDENT">off</span></span> <span class="TILDE">~</span><span id="local_len_1305"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">push_exn</span> <a href="#local_s_1303"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">cmd</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Copy</span> <span class="LPAREN">(</span><a href="#local_off_1304"><span class="LIDENT">off</span></a><span class="COMMA">,</span> <a href="#local_len_1305"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">succ_length</span> <span class="LPAREN">(</span><a href="#local_s_1303"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="COLONGREATER">:&gt;</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="RPAREN">)</span> <a href="#local_len_1305"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">succ_distance</span> <span class="LPAREN">(</span><a href="#local_s_1303"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">d</span> <span class="COLONGREATER">:&gt;</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="RPAREN">)</span> <a href="#local_off_1304"><span class="LIDENT">off</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">available</span> <a href="#local_s_1303"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">push_exn</span> <a href="#local_s_1303"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">eob</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="TRUE">true</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-succ_literal"><span class="LIDENT">succ_literal</span></span> <span id="local_literals_1306"><span class="LIDENT">literals</span></span> <span id="local_chr_1307"><span class="LIDENT">chr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_literals_1306"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_chr_1307"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_literals_1306"><span class="LIDENT">literals</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/char.ml.html#val-code"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">code</span></a> <a href="#local_chr_1307"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-emit_literal"><span class="LIDENT">emit_literal</span></span> <span id="local_s_1308"><span class="LIDENT">s</span></span> <span id="local_chr_1309"><span class="LIDENT">chr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">push_exn</span> <a href="#local_s_1308"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">cmd</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Literal</span> <a href="#local_chr_1309"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">succ_literal</span> <span class="LPAREN">(</span><a href="#local_s_1308"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">l</span> <span class="COLONGREATER">:&gt;</span> <span class="LIDENT">int</span> <span class="LIDENT">array</span><span class="RPAREN">)</span> <a href="#local_chr_1309"><span class="LIDENT">chr</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">available</span> <a href="#local_s_1308"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">1</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">push_exn</span> <a href="#local_s_1308"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">eob</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="TRUE">true</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* XXX(dinosaure): it's possible that it remains one literal. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-trailing"><span class="LIDENT">trailing</span></span> <span id="local_s_1310"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_available</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_flush_1311"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span> <span class="LIDENT">emit_literal</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_char</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LPAREN">(</span><a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">insert</span> <span class="LESSMINUS">&lt;-</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESS">&lt;</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="ELSE">else</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_flush_1311"><span class="LIDENT">flush</span></a> <span class="THEN">then</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">push_exn</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">eob</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">push_exn</span> <a href="#local_s_1310"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">eob</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-slide_hash"><span class="LIDENT">slide_hash</span></span> <span id="local_s_1312"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wsize_1313"><span class="LIDENT">wsize</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_s_1312"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">wbits</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_m_1314"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n_1315"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LIDENT">_hash_size</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_p_1316"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1315"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_p_1316"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_m_1314"><span class="LIDENT">m</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_s_1312"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">head</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_p_1316"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_s_1312"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">head</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_p_1316"><span class="LIDENT">p</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_1314"><span class="LIDENT">m</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_wsize_1313"><span class="LIDENT">wsize</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_1314"><span class="LIDENT">m</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_wsize_1313"><span class="LIDENT">wsize</span></a> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_n_1315"><span class="LIDENT">n</span></a><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1315"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="DO">do</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_n_1315"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_wsize_1313"><span class="LIDENT">wsize</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_p_1316"><span class="LIDENT">p</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1315"><span class="LIDENT">n</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="WHILE">while</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_p_1316"><span class="LIDENT">p</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_m_1314"><span class="LIDENT">m</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_s_1312"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_p_1316"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1312"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_p_1316"><span class="LIDENT">p</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_1314"><span class="LIDENT">m</span></a> <span class="INFIXOP0">&gt;=</span> <a href="#local_wsize_1313"><span class="LIDENT">wsize</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_m_1314"><span class="LIDENT">m</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_wsize_1313"><span class="LIDENT">wsize</span></a> <span class="ELSE">else</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_n_1315"><span class="LIDENT">n</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1315"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="DO">do</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Lz77.val-fill_window"><span class="LIDENT">fill_window</span></span> <span class="LPAREN">(</span><span id="local_cfg_1317"><span class="LIDENT">cfg</span></span> <span class="COLON">:</span> <span class="LIDENT">configuration</span><span class="RPAREN">)</span> <span id="local_s_1318"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wsize_1319"><span class="LIDENT">wsize</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">wbits</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wmask_1320"><span class="LIDENT">wmask</span></span> <span class="EQUAL">=</span> <a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_more_1321"><span class="LIDENT">more</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_deflate_1322"><span class="LIDENT">deflate</span></span> <span id="local_cfg_1323"><span class="LIDENT">cfg</span></span> <span id="local_s_1324"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_cfg_1323"><span class="LIDENT">cfg</span></a><span class="COMMA">,</span> <a href="#local_s_1324"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">level</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Copy</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">copy</span> <a href="#local_s_1324"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Deflate</span> <span id="local_deflate_cfg_1325"><span class="LIDENT">deflate_cfg</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="INT">1</span> <span class="BAR">|</span> <span class="INT">2</span> <span class="BAR">|</span> <span class="INT">3</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">deflate_fast</span> <a href="#local_deflate_cfg_1325"><span class="LIDENT">deflate_cfg</span></a> <a href="#local_s_1324"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Deflate</span> <span id="local_deflate_cfg_1326"><span class="LIDENT">deflate_cfg</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">deflate_slow</span> <a href="#local_deflate_cfg_1326"><span class="LIDENT">deflate_cfg</span></a> <a href="#local_s_1324"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* max *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_more_1327"><span class="LIDENT">more</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="INFIXOP0">&gt;=</span> <a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">max_dist</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <span class="LIDENT">memcpy</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LABEL">~src_off:</span><a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LABEL">~dst_off:</span><span class="INT">0</span> <span class="LABEL">~len:</span><span class="LPAREN">(</span><a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_more_1321"><span class="LIDENT">more</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_start</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_start</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">slide_hash</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_more_1321"><span class="LIDENT">more</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_wsize_1319"><span class="LIDENT">wsize</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_more_1321"><span class="LIDENT">more</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rem_1328"><span class="LIDENT">rem</span></span> <span class="EQUAL">=</span> <span class="LIDENT">i_rem</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_rem_1328"><span class="LIDENT">rem</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">0</span> <span class="COMMENT">(* if (s-&gt;strm-&gt;avail_in == 0) break; *)</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_rem_1328"><span class="LIDENT">rem</span></a> <span class="LESS">&lt;</span> <span class="INT">0</span> <span class="THEN">then</span> <span class="IF">if</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_deflate_1322"><span class="LIDENT">deflate</span></a> <a href="#local_cfg_1317"><span class="LIDENT">cfg</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a> <span class="ELSE">else</span> <span class="LIDENT">trailing</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">refill</span> <span class="LIDENT">fill_window</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1329"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min</span> <a href="#local_more_1327"><span class="LIDENT">more</span></a> <a href="#local_rem_1328"><span class="LIDENT">rem</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">memcpy</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i</span> <span class="LABEL">~src_off:</span><a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LABEL">~dst_off:</span><span class="LPAREN">(</span><a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_len_1329"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(*d*)</span> <span class="LIDENT">update_crc</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a> <a href="#local_len_1329"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1329"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="COMMENT">(*d*)</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">i_pos</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_1329"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">insert</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_str_1330"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">insert</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_insert_1331"><span class="LIDENT">insert</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">insert</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_str_1330"><span class="LIDENT">str</span></a><span class="RBRACE">}</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">update_hash</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_str_1330"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACE">}</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="WHILE">while</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_insert_1331"><span class="LIDENT">insert</span></a> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_insert_1331"><span class="LIDENT">insert</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>                <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">update_hash</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_str_1330"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RBRACE">}</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_str_1330"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_wmask_1320"><span class="LIDENT">wmask</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">head</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">head</span><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_str_1330"><span class="LIDENT">str</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_str_1330"><span class="LIDENT">str</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_insert_1331"><span class="LIDENT">insert</span></a><span class="EOL">
</span>                <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_insert_1331"><span class="LIDENT">insert</span></a> <span class="LESS">&lt;</span> <span class="LIDENT">_min_match</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>                    <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">insert</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_insert_1331"><span class="LIDENT">insert</span></a><span class="EOL">
</span>                    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Break</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="DONE">done</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">insert</span> <span class="LESSMINUS">&lt;-</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_insert_1331"><span class="LIDENT">insert</span></a><span class="EOL">
</span>          <span class="END">end</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESS">&lt;</span> <span class="LIDENT">_min_lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">i_rem</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a> <span class="INFIXOP0">&gt;=</span> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>            <span class="LIDENT">refill</span> <span class="LIDENT">fill_window</span> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="EOL">
</span>          <span class="ELSE">else</span> <a href="#local_deflate_1322"><span class="LIDENT">deflate</span></a> <a href="#local_cfg_1317"><span class="LIDENT">cfg</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_deflate_1322"><span class="LIDENT">deflate</span></a> <a href="#local_cfg_1317"><span class="LIDENT">cfg</span></a> <a href="#local_s_1318"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Lz77.val-enough"><span class="LIDENT">enough</span></span> <span class="LPAREN">(</span><span id="local_cfg_1332"><span class="LIDENT">cfg</span></span> <span class="COLON">:</span> <span class="LIDENT">configuration</span><span class="RPAREN">)</span> <span id="local_s_1333"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_s_1333"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESS">&lt;</span> <span class="LIDENT">_min_lookahead</span> <span class="THEN">then</span> <span class="LIDENT">fill_window</span> <a href="#local_cfg_1332"><span class="LIDENT">cfg</span></a> <a href="#local_s_1333"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_cfg_1332"><span class="LIDENT">cfg</span></a><span class="COMMA">,</span> <a href="#local_s_1333"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">level</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Copy</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">copy</span> <a href="#local_s_1333"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Deflate</span> <span id="local_deflate_cfg_1334"><span class="LIDENT">deflate_cfg</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="INT">1</span> <span class="BAR">|</span> <span class="INT">2</span> <span class="BAR">|</span> <span class="INT">3</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">deflate_fast</span> <a href="#local_deflate_cfg_1334"><span class="LIDENT">deflate_cfg</span></a> <a href="#local_s_1333"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Deflate</span> <span id="local_deflate_cfg_1335"><span class="LIDENT">deflate_cfg</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">deflate_slow</span> <a href="#local_deflate_cfg_1335"><span class="LIDENT">deflate_cfg</span></a> <a href="#local_s_1333"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Lz77.val-deflate_fast"><span class="LIDENT">deflate_fast</span></span> <span class="LPAREN">(</span><span id="local_cfg_1336"><span class="LIDENT">cfg</span></span> <span class="COLON">:</span> <span class="LIDENT">deflate_configuration</span><span class="RPAREN">)</span> <span id="local_s_1337"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hash_head_1338"><span class="LIDENT">hash_head</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_flush_1339"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <span class="THEN">then</span> <a href="#local_hash_head_1338"><span class="LIDENT">hash_head</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">insert_string</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_head_1338"><span class="LIDENT">hash_head</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_head_1338"><span class="LIDENT">hash_head</span></a> <span class="INFIXOP0">&lt;=</span> <span class="LIDENT">max_dist</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">longest_match</span> <a href="#local_cfg_1336"><span class="LIDENT">cfg</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_head_1338"><span class="LIDENT">hash_head</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <a href="#local_flush_1339"><span class="LIDENT">flush</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a><span class="EOL">
</span>          <span class="LIDENT">emit_match</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a> <span class="LABEL">~off:</span><span class="LPAREN">(</span><a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_start</span><span class="RPAREN">)</span> <span class="LABEL">~len:</span><a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_cfg_1336"><span class="LIDENT">cfg</span></a><span class="DOT">.</span><span class="LIDENT">max_lazy</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>            <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="WHILE">while</span><span class="EOL">
</span>                <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_hash_head_1338"><span class="LIDENT">hash_head</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">insert_string</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>                <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>              <span class="DO">do</span><span class="EOL">
</span>                <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="DONE">done</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="END">end</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>            <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="RBRACE">}</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">update_hash</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">hash</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span><span class="DOTOP">.!</span><span class="LBRACE">{</span><a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACE">}</span><span class="EOL">
</span>          <span class="END">end</span><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <a href="#local_flush_1339"><span class="LIDENT">flush</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">emit_literal</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_char</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flush_1339"><span class="LIDENT">flush</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">enough</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">enough</span> <span class="LPAREN">(</span><span class="UIDENT">Deflate</span> <a href="#local_cfg_1336"><span class="LIDENT">cfg</span></a><span class="RPAREN">)</span> <a href="#local_s_1337"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Lz77.val-deflate_slow"><span class="LIDENT">deflate_slow</span></span> <span class="LPAREN">(</span><span id="local_cfg_1340"><span class="LIDENT">cfg</span></span> <span class="COLON">:</span> <span class="LIDENT">deflate_configuration</span><span class="RPAREN">)</span> <span id="local_s_1341"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hash_head_1342"><span class="LIDENT">hash_head</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <span class="THEN">then</span> <a href="#local_hash_head_1342"><span class="LIDENT">hash_head</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">insert_string</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_match</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_start</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span><span class="IF">if</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_head_1342"><span class="LIDENT">hash_head</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="LESS">&lt;</span> <a href="#local_cfg_1340"><span class="LIDENT">cfg</span></a><span class="DOT">.</span><span class="LIDENT">max_lazy</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_head_1342"><span class="LIDENT">hash_head</span></a> <span class="INFIXOP0">&lt;=</span> <span class="LIDENT">max_dist</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="THEN">then</span><span class="EOL">
</span>       <span class="LET">let</span> <span id="local_match_length_1343"><span class="LIDENT">match_length</span></span> <span class="EQUAL">=</span> <span class="LIDENT">longest_match</span> <a href="#local_cfg_1340"><span class="LIDENT">cfg</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_head_1342"><span class="LIDENT">hash_head</span></a> <span class="IN">in</span><span class="EOL">
</span>       <span class="IF">if</span><span class="EOL">
</span>         <a href="#local_match_length_1343"><span class="LIDENT">match_length</span></a> <span class="INFIXOP0">&lt;=</span> <span class="INT">5</span><span class="EOL">
</span>         <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_match_length_1343"><span class="LIDENT">match_length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <span class="LIDENT">_min_match</span><span class="EOL">
</span>         <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_start</span> <span class="GREATER">&gt;</span> <span class="LIDENT">_too_far</span><span class="EOL">
</span>       <span class="THEN">then</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>       <span class="ELSE">else</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_match_length_1343"><span class="LIDENT">match_length</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="INFIXOP0">&gt;=</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_max_insert_1344"><span class="LIDENT">max_insert</span></span> <span class="EQUAL">=</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">_min_match</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_flush_1345"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">emit_match</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a> <span class="LABEL">~off:</span><span class="LPAREN">(</span><a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_match</span><span class="RPAREN">)</span> <span class="LABEL">~len:</span><a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="WHILE">while</span><span class="EOL">
</span>            <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="INFIXOP0">&lt;=</span> <a href="#local_max_insert_1344"><span class="LIDENT">max_insert</span></a> <span class="THEN">then</span><span class="EOL">
</span>                <a href="#local_hash_head_1342"><span class="LIDENT">hash_head</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">insert_string</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>            <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">prev_length</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>          <span class="DO">do</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="DONE">done</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_available</span> <span class="LESSMINUS">&lt;-</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_length</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">_min_match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="IF">if</span> <a href="#local_flush_1345"><span class="LIDENT">flush</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">enough</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <span class="LIDENT">enough</span> <span class="LPAREN">(</span><span class="UIDENT">Deflate</span> <a href="#local_cfg_1340"><span class="LIDENT">cfg</span></a><span class="RPAREN">)</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_available</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <span class="MATCH">match</span> <span class="LIDENT">emit_literal</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_char</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <span class="LPAREN">(</span><a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">enough</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">enough</span> <span class="LPAREN">(</span><span class="UIDENT">Deflate</span> <a href="#local_cfg_1340"><span class="LIDENT">cfg</span></a><span class="RPAREN">)</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">match_available</span> <span class="LESSMINUS">&lt;-</span> <span class="TRUE">true</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="LIDENT">enough</span> <span class="LPAREN">(</span><span class="UIDENT">Deflate</span> <a href="#local_cfg_1340"><span class="LIDENT">cfg</span></a><span class="RPAREN">)</span> <a href="#local_s_1341"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Lz77.val-copy"><span class="LIDENT">copy</span></span> <span id="local_s_1346"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_flush_1347"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">available</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">q</span> <span class="INFIXOP0">&lt;=</span> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flush_1347"><span class="LIDENT">flush</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>      <a href="#local_flush_1347"><span class="LIDENT">flush</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">emit_literal</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_char</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">w</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">strstart</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">lookahead</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flush_1347"><span class="LIDENT">flush</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">enough</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">enough</span> <span class="UIDENT">Copy</span> <a href="#local_s_1346"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_literals"><span class="LIDENT">_literals</span></span> <span class="EQUAL">=</span> <span class="INT">256</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_length_codes"><span class="LIDENT">_length_codes</span></span> <span class="EQUAL">=</span> <span class="INT">29</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_l_codes"><span class="LIDENT">_l_codes</span></span> <span class="EQUAL">=</span> <span class="LIDENT">_literals</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">_length_codes</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-_d_codes"><span class="LIDENT">_d_codes</span></span> <span class="EQUAL">=</span> <span class="INT">30</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-checksum"><span class="LIDENT">checksum</span></span> <span class="LBRACE">{</span><span id="local_crc_1348"><span class="LIDENT">crc</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="EQUAL">=</span> <a href="#local_crc_1348"><span class="LIDENT">crc</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-distances"><span class="LIDENT">distances</span></span> <span class="LBRACE">{</span><span id="local_d_1349"><span class="LIDENT">d</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="EQUAL">=</span> <a href="#local_d_1349"><span class="LIDENT">d</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-literals"><span class="LIDENT">literals</span></span> <span class="LBRACE">{</span><span id="local_l_1350"><span class="LIDENT">l</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="EQUAL">=</span> <a href="#local_l_1350"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-ctz"><span class="LIDENT">ctz</span></span> <span id="local_x_1351"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n_1352"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="AND">and</span> <span id="local_x_1353"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_x_1351"><span class="LIDENT">x</span></a> <span class="AND">and</span> <span id="local_y_1354"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-word_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">word_size</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">64</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">63</span><span class="EOL">
</span>      <span class="SEMI">;</span> <a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">32</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">32</span><span class="EOL">
</span>          <span class="SEMI">;</span> <a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">31</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">16</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">8</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">4</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">4</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">2</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_1353"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_y_1354"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_1352"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-state"><span class="LIDENT">state</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_level_1355"><span class="LIDENT">level</span></span> <span class="EQUAL">=</span> <span class="INT">4</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_q_1356"><span class="LIDENT">q</span></span> <span class="TILDE">~</span><span id="local_w_1357"><span class="LIDENT">w</span></span> <span id="local_src_1358"><span class="LIDENT">src</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wbits_1359"><span class="LIDENT">wbits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ctz</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_w_1357"><span class="LIDENT">w</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wsize_1360"><span class="LIDENT">wsize</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_wbits_1359"><span class="LIDENT">wbits</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_cfg_1361"><span class="LIDENT">cfg</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_level_1355"><span class="LIDENT">level</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_0</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">1</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">2</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_2</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">3</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_3</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">4</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_4</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">5</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_5</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">6</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_6</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">7</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_7</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">8</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_8</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">9</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">_9</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">invalid_arg</span> <span class="STRING">&quot;Invalid level of compression: %d&quot;</span> <a href="#local_level_1355"><span class="LIDENT">level</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1428"><span id="local_i_1362"><span class="LIDENT">i</span></span><span class="COMMA">,</span> <span id="local_i_pos_1363"><span class="LIDENT">i_pos</span></span><span class="COMMA">,</span> <span id="local_i_len_1364"><span class="LIDENT">i_len</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_src_1358"><span class="LIDENT">src</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_empty</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <span id="local_x_1365"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_of_string</span> <a href="#local_x_1365"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_x_1365"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Channel</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bigstring_create</span> <span class="LIDENT">io_buffer_size</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <a href="#local_src_1358"><span class="LIDENT">src</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_i_1362"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_i_pos_1363"><span class="LIDENT">i_pos</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_i_len_1364"><span class="LIDENT">i_len</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_cfg_1361"><span class="LIDENT">cfg</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_level_1355"><span class="LIDENT">level</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">l</span><span class="EQUAL">=</span> <span class="LIDENT">make_literals</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">d</span><span class="EQUAL">=</span> <span class="LIDENT">make_distances</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_w_1357"><span class="LIDENT">w</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_wbits_1359"><span class="LIDENT">wbits</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">lookahead</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">strstart</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">prev</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_wsize_1360"><span class="LIDENT">wsize</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">head</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LIDENT">_hash_size</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">hash</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">match_start</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">match_length</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">match_available</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">insert</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">prev_length</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">prev_match</span><span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_q_1356"><span class="LIDENT">q</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">crc</span><span class="EQUAL">=</span> <span class="UIDENT">Checkseum</span><span class="DOT">.</span><span class="UIDENT">Adler32</span><span class="DOT">.</span><span class="LIDENT">default</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LIDENT">k</span><span class="EQUAL">=</span> <span class="LIDENT">enough</span><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-compress"><span class="LIDENT">compress</span></span> <span id="local_s_1366"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_s_1366"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">k</span> <a href="#local_s_1366"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">cfg</span> <a href="#local_s_1366"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Lz77.type-window"><span class="TYPE">type</span> <span class="LIDENT">window</span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-make_window"><span class="LIDENT">make_window</span></span> <span class="TILDE">~</span><span id="local_bits_1367"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_create</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="INT">1</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <a href="#local_bits_1367"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Lz77.val-no_compression"><span class="LIDENT">no_compression</span></span> <span id="local_s_1368"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_s_1368"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">cfg</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">Copy</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Higher"><span class="MODULE">module</span> <span class="UIDENT">Higher</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Higher.val-compress"><span class="LIDENT">compress</span></span> <span class="TILDE">~</span><span id="local_w_1369"><span class="LIDENT">w</span></span> <span class="TILDE">~</span><span id="local_q_1370"><span class="LIDENT">q</span></span> <span class="TILDE">~</span><span id="local_refill_1371"><span class="LIDENT">refill</span></span> <span class="TILDE">~</span><span id="local_flush_1372"><span class="LIDENT">flush</span></span> <span id="local_i_1373"><span class="LIDENT">i</span></span> <span id="local_o_1374"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_state_1375"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">state</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="TILDE">~</span><a href="#local_w_1369"><span class="LIDENT">w</span></a> <span class="TILDE">~</span><a href="#local_q_1370"><span class="LIDENT">q</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_encoder_1376"><span class="LIDENT">encoder</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encoder</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="TILDE">~</span><a href="#local_q_1370"><span class="LIDENT">q</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_kind_1377"><span class="LIDENT">kind</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Fixed</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_compress_1378"><span class="LIDENT">compress</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">compress</span> <a href="#local_state_1375"><span class="LIDENT">state</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1379"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_refill_1371"><span class="LIDENT">refill</span></a> <a href="#local_i_1373"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_state_1375"><span class="LIDENT">state</span></a> <a href="#local_i_1373"><span class="LIDENT">i</span></a> <span class="INT">0</span> <a href="#local_len_1379"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <a href="#local_compress_1378"><span class="LIDENT">compress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_literals_1380"><span class="LIDENT">literals</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">literals</span> <a href="#local_state_1375"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_distances_1381"><span class="LIDENT">distances</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">distances</span> <a href="#local_state_1375"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_kind_1377"><span class="LIDENT">kind</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Dynamic</span> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dynamic_of_frequencies</span> <span class="TILDE">~</span><a href="#local_literals_1380"><span class="LIDENT">literals</span></a> <span class="TILDE">~</span><a href="#local_distances_1381"><span class="LIDENT">distances</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_encode_1382"><span class="LIDENT">encode</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="LBRACE">{</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_kind_1377"><span class="LIDENT">kind</span></a><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_pending_1386"><span class="LIDENT">pending</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="LBRACE">{</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="TRUE">true</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_encode_1382"><span class="LIDENT">encode</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Partial</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1383"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dst_rem</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_flush_1372"><span class="LIDENT">flush</span></a> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <a href="#local_len_1383"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_o_1374"><span class="LIDENT">o</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_encode_1382"><span class="LIDENT">encode</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_compress_1378"><span class="LIDENT">compress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_literals_1384"><span class="LIDENT">literals</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">literals</span> <a href="#local_state_1375"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_distances_1385"><span class="LIDENT">distances</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">distances</span> <a href="#local_state_1375"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_kind_1377"><span class="LIDENT">kind</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Dynamic</span> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dynamic_of_frequencies</span> <span class="TILDE">~</span><a href="#local_literals_1384"><span class="LIDENT">literals</span></a> <span class="TILDE">~</span><a href="#local_distances_1385"><span class="LIDENT">distances</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_encode_1382"><span class="LIDENT">encode</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="LBRACE">{</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_kind_1377"><span class="LIDENT">kind</span></a><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_pending_1386"><span class="LIDENT">pending</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="COMMENT">(* XXX(dinosaure): should never appear. *)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Partial</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1387"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dst_rem</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_flush_1372"><span class="LIDENT">flush</span></a> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <a href="#local_len_1387"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_o_1374"><span class="LIDENT">o</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_pending_1386"><span class="LIDENT">pending</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">reset</span> <a href="#local_q_1370"><span class="LIDENT">q</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_encoder_1376"><span class="LIDENT">encoder</span></a> <a href="#local_o_1374"><span class="LIDENT">o</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><span class="LIDENT">bigstring_length</span> <a href="#local_o_1374"><span class="LIDENT">o</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_compress_1378"><span class="LIDENT">compress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Higher.val-uncompress"><span class="LIDENT">uncompress</span></span> <span class="TILDE">~</span><span id="local_w_1388"><span class="LIDENT">w</span></span> <span class="TILDE">~</span><span id="local_refill_1389"><span class="LIDENT">refill</span></span> <span class="TILDE">~</span><span id="local_flush_1390"><span class="LIDENT">flush</span></span> <span id="local_i_1391"><span class="LIDENT">i</span></span> <span id="local_o_1392"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_decoder_1393"><span class="LIDENT">decoder</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">decoder</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="TILDE">~</span><a href="#local_o_1392"><span class="LIDENT">o</span></a> <span class="TILDE">~</span><a href="#local_w_1388"><span class="LIDENT">w</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_decompress_1394"><span class="LIDENT">decompress</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">decode</span> <a href="#local_decoder_1393"><span class="LIDENT">decoder</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1395"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_refill_1389"><span class="LIDENT">refill</span></a> <a href="#local_i_1391"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_decoder_1393"><span class="LIDENT">decoder</span></a> <a href="#local_i_1391"><span class="LIDENT">i</span></a> <span class="INT">0</span> <a href="#local_len_1395"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <a href="#local_decompress_1394"><span class="LIDENT">decompress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1396"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_1392"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">dst_rem</span> <a href="#local_decoder_1393"><span class="LIDENT">decoder</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_len_1396"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_flush_1390"><span class="LIDENT">flush</span></a> <a href="#local_o_1392"><span class="LIDENT">o</span></a> <a href="#local_len_1396"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1397"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_1392"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">dst_rem</span> <a href="#local_decoder_1393"><span class="LIDENT">decoder</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_flush_1390"><span class="LIDENT">flush</span></a> <a href="#local_o_1392"><span class="LIDENT">o</span></a> <a href="#local_len_1397"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">flush</span> <a href="#local_decoder_1393"><span class="LIDENT">decoder</span></a> <span class="SEMI">;</span> <a href="#local_decompress_1394"><span class="LIDENT">decompress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Malformed</span> <span id="local_err_1398"><span class="LIDENT">err</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Msg</span> <a href="#local_err_1398"><span class="LIDENT">err</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_decompress_1394"><span class="LIDENT">decompress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Higher.val-of_string"><span class="LIDENT">of_string</span></span> <span class="TILDE">~</span><span id="local_o_1399"><span class="LIDENT">o</span></span> <span class="TILDE">~</span><span id="local_w_1400"><span class="LIDENT">w</span></span> <span id="local_input_1401"><span class="LIDENT">input</span></span> <span class="TILDE">~</span><span id="local_flush_1402"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_decoder_1403"><span class="LIDENT">decoder</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">decoder</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">String</span> <a href="#local_input_1401"><span class="LIDENT">input</span></a><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_o_1399"><span class="LIDENT">o</span></a> <span class="TILDE">~</span><a href="#local_w_1400"><span class="LIDENT">w</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_decompress_1404"><span class="LIDENT">decompress</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">decode</span> <a href="#local_decoder_1403"><span class="LIDENT">decoder</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1405"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_1399"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">dst_rem</span> <a href="#local_decoder_1403"><span class="LIDENT">decoder</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_len_1405"><span class="LIDENT">len</span></a> <span class="GREATER">&gt;</span> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_flush_1402"><span class="LIDENT">flush</span></a> <a href="#local_o_1399"><span class="LIDENT">o</span></a> <a href="#local_len_1405"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1406"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring_length</span> <a href="#local_o_1399"><span class="LIDENT">o</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">dst_rem</span> <a href="#local_decoder_1403"><span class="LIDENT">decoder</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_flush_1402"><span class="LIDENT">flush</span></a> <a href="#local_o_1399"><span class="LIDENT">o</span></a> <a href="#local_len_1406"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <span class="UIDENT">Inf</span><span class="DOT">.</span><span class="LIDENT">flush</span> <a href="#local_decoder_1403"><span class="LIDENT">decoder</span></a> <span class="SEMI">;</span> <a href="#local_decompress_1404"><span class="LIDENT">decompress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Malformed</span> <span id="local_err_1407"><span class="LIDENT">err</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Msg</span> <a href="#local_err_1407"><span class="LIDENT">err</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_decompress_1404"><span class="LIDENT">decompress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Higher.val-to_string"><span class="LIDENT">to_string</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buffer_1408"><span class="LIDENT">buffer</span></span> <span class="EQUAL">=</span> <span class="INT">4096</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_w_1409"><span class="LIDENT">w</span></span> <span class="TILDE">~</span><span id="local_q_1410"><span class="LIDENT">q</span></span> <span class="TILDE">~</span><span id="local_refill_1411"><span class="LIDENT">refill</span></span> <span id="local_i_1412"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_buf_1413"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_buffer_1408"><span class="LIDENT">buffer</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_state_1414"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">state</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Manual</span> <span class="TILDE">~</span><a href="#local_q_1410"><span class="LIDENT">q</span></a> <span class="TILDE">~</span><a href="#local_w_1409"><span class="LIDENT">w</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_encoder_1415"><span class="LIDENT">encoder</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encoder</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Buffer</span> <a href="#local_buf_1413"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_q_1410"><span class="LIDENT">q</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_kind_1416"><span class="LIDENT">kind</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Fixed</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_compress_1417"><span class="LIDENT">compress</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">compress</span> <a href="#local_state_1414"><span class="LIDENT">state</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Await</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_len_1418"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="#local_refill_1411"><span class="LIDENT">refill</span></a> <a href="#local_i_1412"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_state_1414"><span class="LIDENT">state</span></a> <a href="#local_i_1412"><span class="LIDENT">i</span></a> <span class="INT">0</span> <a href="#local_len_1418"><span class="LIDENT">len</span></a> <span class="SEMI">;</span> <a href="#local_compress_1417"><span class="LIDENT">compress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Flush</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_literals_1419"><span class="LIDENT">literals</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">literals</span> <a href="#local_state_1414"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_distances_1420"><span class="LIDENT">distances</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">distances</span> <a href="#local_state_1414"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_kind_1416"><span class="LIDENT">kind</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Dynamic</span> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dynamic_of_frequencies</span> <span class="TILDE">~</span><a href="#local_literals_1419"><span class="LIDENT">literals</span></a> <span class="TILDE">~</span><a href="#local_distances_1420"><span class="LIDENT">distances</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_encode_1421"><span class="LIDENT">encode</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1415"><span class="LIDENT">encoder</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="LBRACE">{</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_kind_1416"><span class="LIDENT">kind</span></a><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">End</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_pending_1424"><span class="LIDENT">pending</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1415"><span class="LIDENT">encoder</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="LBRACE">{</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Fixed</span><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="TRUE">true</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_encode_1421"><span class="LIDENT">encode</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Partial</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_compress_1417"><span class="LIDENT">compress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_literals_1422"><span class="LIDENT">literals</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">literals</span> <a href="#local_state_1414"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_distances_1423"><span class="LIDENT">distances</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Lz77</span><span class="DOT">.</span><span class="LIDENT">distances</span> <a href="#local_state_1414"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_kind_1416"><span class="LIDENT">kind</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Def</span><span class="DOT">.</span><span class="UIDENT">Dynamic</span> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">dynamic_of_frequencies</span> <span class="TILDE">~</span><a href="#local_literals_1422"><span class="LIDENT">literals</span></a> <span class="TILDE">~</span><a href="#local_distances_1423"><span class="LIDENT">distances</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="SEMI">;</span> <a href="#local_encode_1421"><span class="LIDENT">encode</span></a> <span class="LPAREN">(</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">encode</span> <a href="#local_encoder_1415"><span class="LIDENT">encoder</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="LBRACE">{</span><span class="UIDENT">Def</span><span class="DOT">.</span><span class="LIDENT">kind</span><span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_kind_1416"><span class="LIDENT">kind</span></a><span class="SEMI">;</span> <span class="LIDENT">last</span><span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RBRACE">}</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_pending_1424"><span class="LIDENT">pending</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Partial</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Block</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Ok</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">reset</span> <a href="#local_q_1410"><span class="LIDENT">q</span></a> <span class="SEMI">;</span> <a href="#local_compress_1417"><span class="LIDENT">compress</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_buf_1413"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span></span></code></pre></body></html>
