<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamPp (opam-format.opam-format.OpamPp)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../sherlodoc_db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../../index.html">Up</a> ‚Äì <a href="../../../index.html">üè†</a> &#x00BB; <a href="../../index.html">opam-format</a> &#x00BB; Library <code>opam-format</code> &#x00BB; OpamPp</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>OpamPp</span></code><a href="../../src/opam-format/opamPp.ml.html" class="source_link">Source</a></h1><p>Generic bidirectional transformation toolbox for parsing/printing</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#parsing-positions-and-error-reporting-helpers">Parsing positions and error reporting helpers</a></li><li><a href="#parser/printers">Parser/printers</a><ul><li><a href="#various-pp-constructors">Various pp constructors</a></li><li><a href="#combinators-to-parse-to-a-record-from-a-list-of-(field-name,-field-setter,-field-getter)">Combinators to parse to a record from a list of (field name, field setter, field getter)</a></li></ul></li></ul></nav><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">opam-format</a><ul><li>Library <code>opam-format</code><ul><li><a href="../OpamFile/index.html">OpamFile</a></li><li><a href="../OpamFilter/index.html">OpamFilter</a></li><li><a href="../OpamFormat/index.html">OpamFormat</a></li><li><a href="../OpamFormatConfig/index.html">OpamFormatConfig</a></li><li><a href="../OpamFormula/index.html">OpamFormula</a></li><li><a href="../OpamInterpLexer/index.html">OpamInterpLexer</a></li><li><a href="../OpamLineLexer/index.html">OpamLineLexer</a></li><li><a href="../OpamPackage/index.html">OpamPackage</a></li><li><a href="../OpamPath/index.html">OpamPath</a></li><li><a href="#" class="current_unit">OpamPp</a><ul><li><a href="Op/index.html">Op</a></li><li><a href="module-type-STR/index.html">STR</a></li></ul></li><li><a href="../OpamRepositoryName/index.html">OpamRepositoryName</a></li><li><a href="../OpamSwitch/index.html">OpamSwitch</a></li><li><a href="../OpamSysPkg/index.html">OpamSysPkg</a></li><li><a href="../OpamTypes/index.html">OpamTypes</a></li><li><a href="../OpamTypesBase/index.html">OpamTypesBase</a></li><li><a href="../OpamVariable/index.html">OpamVariable</a></li></ul></li><li><a href="../../src/index.html">Sources</a></li></ul></li></ul></nav></div><div class="odoc-content"><h3 id="parsing-positions-and-error-reporting-helpers"><a href="#parsing-positions-and-error-reporting-helpers" class="anchor"></a>Parsing positions and error reporting helpers</h3><div class="odoc-spec"><div class="spec type anchored" id="type-bad_format"><a href="#type-bad_format" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#type-bad_format" class="source_link">Source</a><code><span><span class="keyword">type</span> bad_format</span><span> = <span><a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> option</span> * string</span></code></div><div class="spec-doc"><p>Format error reporting: position and message</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Bad_format"><a href="#exception-Bad_format" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#exception-Bad_format" class="source_link">Source</a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Bad_format</span> <span class="keyword">of</span> <a href="#type-bad_format">bad_format</a></span></code></div><div class="spec-doc"><p>All the following parsing function raise <code>Bad_format</code> in case the input does not have the right format.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Bad_format_list"><a href="#exception-Bad_format_list" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#exception-Bad_format_list" class="source_link">Source</a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Bad_format_list</span> <span class="keyword">of</span> <span><a href="#type-bad_format">bad_format</a> list</span></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Bad_version"><a href="#exception-Bad_version" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#exception-Bad_version" class="source_link">Source</a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Bad_version</span> <span class="keyword">of</span> <a href="#type-bad_format">bad_format</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bad_format"><a href="#val-bad_format" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-bad_format" class="source_link">Source</a><code><span><span class="keyword">val</span> bad_format : 
  <span><span class="optlabel">?pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, unit, string, <span class="type-var">'b</span>)</span> <a href="../../../ocaml-base-compiler/stdlib/Stdlib/index.html#type-format4">format4</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Raise <code>Bad_format</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bad_version"><a href="#val-bad_version" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-bad_version" class="source_link">Source</a><code><span><span class="keyword">val</span> bad_version : 
  <span><span class="optlabel">?pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, unit, string, <span class="type-var">'b</span>)</span> <a href="../../../ocaml-base-compiler/stdlib/Stdlib/index.html#type-format4">format4</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Raise <code>Bad_version</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_bad_format"><a href="#val-string_of_bad_format" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-string_of_bad_format" class="source_link">Source</a><code><span><span class="keyword">val</span> string_of_bad_format : <span><span class="optlabel">?file</span>:string <span class="arrow">&#45;&gt;</span></span> <span>exn <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_pos"><a href="#val-add_pos" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-add_pos" class="source_link">Source</a><code><span><span class="keyword">val</span> add_pos : <span><a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span>exn <span class="arrow">&#45;&gt;</span></span> exn</span></code></div><div class="spec-doc"><p>Adds a position to a Bad_format exception if it doesn't have one yet</p></div></div><h3 id="parser/printers"><a href="#parser/printers" class="anchor"></a>Parser/printers</h3><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#type-t" class="source_link">Source</a><code><span><span class="keyword">type</span> <span>('a, 'b) t</span></span><span> = <span class="keyword">private</span> </span><span>{</span></code><ol><li id="type-t.parse" class="def record field anchored"><a href="#type-t.parse" class="anchor"></a><code><span>parse : <span><span class="label">pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>;</span></code></li><li id="type-t.print" class="def record field anchored"><a href="#type-t.print" class="anchor"></a><code><span>print : <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code></li><li id="type-t.ppname" class="def record field anchored"><a href="#type-t.ppname" class="anchor"></a><code><span>ppname : string;</span></code></li><li id="type-t.name_constr" class="def record field anchored"><a href="#type-t.name_constr" class="anchor"></a><code><span>name_constr : <span>string <span class="arrow">&#45;&gt;</span></span> string;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type of bidirectional parsers from <code>'a</code> to <code>'b</code>. We abuse the terms and describe going from <code>'a</code> to <code>'b</code> as &quot;parsing&quot;, and going from <code>'b</code> to <code>'a</code> as &quot;printing&quot;. Parsing is generally error-prone, while printing is not expected to fail, so the handling isn't really symmetrical.</p><p><code>parse (print x)</code> should always be the identity, while no guarantee is given regarding <code>print (parse x)</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-pp" class="source_link">Source</a><code><span><span class="keyword">val</span> pp : 
  <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?name_constr</span>:<span>(<span>string <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="label">pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Base constructor for Pp.t, from a parser function and a printer function. <code>name_constr</code> is used to construct the resulting name when on the left of a pipe. Names are for tracing errors.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_pair"><a href="#val-of_pair" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-of_pair" class="source_link">Source</a><code><span><span class="keyword">val</span> of_pair : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> * <span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Constructor of Pp.t from a name and a pair</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parse"><a href="#val-parse" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-parse" class="source_link">Source</a><code><span><span class="keyword">val</span> parse : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p>Base call for parsing with a pp</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print"><a href="#val-print" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-print" class="source_link">Source</a><code><span><span class="keyword">val</span> print : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Base call for printing with a pp</p></div></div><p>Error handling</p><div class="odoc-spec"><div class="spec value anchored" id="val-unexpected"><a href="#val-unexpected" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-unexpected" class="source_link">Source</a><code><span><span class="keyword">val</span> unexpected : <span><span class="optlabel">?pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Raises an exception handled by parser calls</p></div></div><h4 id="various-pp-constructors"><a href="#various-pp-constructors" class="anchor"></a>Various pp constructors</h4><div class="odoc-spec"><div class="spec module anchored" id="module-Op"><a href="#module-Op" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#module-Op" class="source_link">Source</a><code><span><span class="keyword">module</span> <a href="Op/index.html">Op</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-identity"><a href="#val-identity" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-identity" class="source_link">Source</a><code><span><span class="keyword">val</span> identity : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ignore"><a href="#val-ignore" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-ignore" class="source_link">Source</a><code><span><span class="keyword">val</span> ignore : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'b</span> option</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Always parses to <code>None</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check"><a href="#val-check" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-check" class="source_link">Source</a><code><span><span class="keyword">val</span> check : 
  <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?raise</span>:
    <span>(<span><span class="optlabel">?pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span>
      <span><span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, unit, string, <span class="type-var">'a</span>)</span> <a href="../../../ocaml-base-compiler/stdlib/Stdlib/index.html#type-format4">format4</a></span> <span class="arrow">&#45;&gt;</span></span>
      <span>string <span class="arrow">&#45;&gt;</span></span>
      <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?errmsg</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Identity pp, unless the check fails. The check is turned into an assertion when printing. If no <code>errmsg</code> is given, raises <code>Unexpected</code>, otherwise call <code>raise</code> with the given <code>errmsg</code>. By default <code>raise</code> raises <code>Bad_format</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map_pair"><a href="#val-map_pair" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-map_pair" class="source_link">Source</a><code><span><span class="keyword">val</span> map_pair : 
  <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?posf1</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?posf2</span>:<span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'d</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>, <span class="type-var">'c</span> * <span class="type-var">'d</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map_fst"><a href="#val-map_fst" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-map_fst" class="source_link">Source</a><code><span><span class="keyword">val</span> map_fst : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'c</span>, <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Builds a pp of pairs by passing the second term along</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map_snd"><a href="#val-map_snd" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-map_snd" class="source_link">Source</a><code><span><span class="keyword">val</span> map_snd : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'c</span> * <span class="type-var">'a</span>, <span class="type-var">'c</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Builds a pp of pairs by passing the first term along</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map_list"><a href="#val-map_list" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-map_list" class="source_link">Source</a><code><span><span class="keyword">val</span> map_list : 
  <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?posf</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'a</span> list</span>, <span><span class="type-var">'b</span> list</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map_option"><a href="#val-map_option" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-map_option" class="source_link">Source</a><code><span><span class="keyword">val</span> map_option : <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> option</span>, <span><span class="type-var">'b</span> option</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-singleton"><a href="#val-singleton" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-singleton" class="source_link">Source</a><code><span><span class="keyword">val</span> singleton : <span><span>(<span><span class="type-var">'a</span> list</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Parsing fails on non-singleton lists</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last"><a href="#val-last" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-last" class="source_link">Source</a><code><span><span class="keyword">val</span> last : <span><span>(<span><span class="type-var">'a</span> list</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Use for the rightmost element to close a <code>^+</code> sequence, e.g. <code>pp1 ^+ pp2 ^+ last -| pp3</code></p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-STR"><a href="#module-type-STR" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#module-type-STR" class="source_link">Source</a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-STR/index.html">STR</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_module"><a href="#val-of_module" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-of_module" class="source_link">Source</a><code><span><span class="keyword">val</span> of_module : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="keyword">module</span> <a href="module-type-STR/index.html">STR</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-STR/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Generates a string pp from a module with of/to string functions</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-opt"><a href="#val-opt" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-opt" class="source_link">Source</a><code><span><span class="keyword">val</span> opt : <span><span><span>(<span><span class="type-var">'a</span> list</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> list</span>, <span><span class="type-var">'b</span> option</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Parses to None on the empty list. Often combined with singleton (<code>opt (singleton _)</code>)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default"><a href="#val-default" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-default" class="source_link">Source</a><code><span><span class="keyword">val</span> default : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> option</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fallback"><a href="#val-fallback" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-fallback" class="source_link">Source</a><code><span><span class="keyword">val</span> fallback : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>fallback p1 p2</code> is <code>p1</code>, except that parsing is allowed to fail and will in that case try to parse through <code>p2</code>. Can be useful for backwards compatibility, but use with care</p></div></div><h4 id="combinators-to-parse-to-a-record-from-a-list-of-(field-name,-field-setter,-field-getter)"><a href="#combinators-to-parse-to-a-record-from-a-list-of-(field-name,-field-setter,-field-getter)" class="anchor"></a>Combinators to parse to a record from a list of (field name, field setter, field getter)</h4><div class="odoc-spec"><div class="spec type anchored" id="type-field_parser"><a href="#type-field_parser" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#type-field_parser" class="source_link">Source</a><code><span><span class="keyword">type</span> <span>('a, 'value) field_parser</span></span><span> = <span><span>(<span class="type-var">'a</span> * <span><span class="type-var">'value</span> option</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Used to parse a single field of a record: <code>'a</code> on the left is the accumulator, or value of the record parsed so far. (in lens terms, <code>get</code> would be the print operation that extracts the field for the record, while <code>set</code> would be the parse operation that takes the input and record, and updates a given field in the record)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ppacc"><a href="#val-ppacc" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-ppacc" class="source_link">Source</a><code><span><span class="keyword">val</span> ppacc : 
  <span><span class="optlabel">?cleanup</span>:<span>(<span><span class="label">pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'value</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'acc</span>, <span class="type-var">'value</span>)</span> <a href="#type-field_parser">field_parser</a></span></span></code></div><div class="spec-doc"><p>Make a field parser from setter, getter and base pp. <code>cleanup</code> is an optional sanitisation function that is called on parsed elements before calling the setter.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ppacc_opt"><a href="#val-ppacc_opt" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-ppacc_opt" class="source_link">Source</a><code><span><span class="keyword">val</span> ppacc_opt : 
  <span><span class="optlabel">?cleanup</span>:<span>(<span><span class="label">pos</span>:<a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-pos">OpamParserTypes.FullPos.pos</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'value</span>, <span class="type-var">'a</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'acc</span>, <span class="type-var">'value</span>)</span> <a href="#type-field_parser">field_parser</a></span></span></code></div><div class="spec-doc"><p>Same as <code>ppacc</code>, but when the field may be unset in the record, i.e. the getter returns an option</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ppacc_ignore"><a href="#val-ppacc_ignore" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-ppacc_ignore" class="source_link">Source</a><code><span><span class="keyword">val</span> ppacc_ignore : <span><span>(<span class="type-var">'a</span>, <a href="../../../opam-file-format/opam-file-format/OpamParserTypes/FullPos/index.html#type-value">OpamParserTypes.FullPos.value</a>)</span> <a href="#type-field_parser">field_parser</a></span></span></code></div><div class="spec-doc"><p>A field parser that ignores its argument</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-embed"><a href="#val-embed" class="anchor"></a><a href="../../src/opam-format/opamPp.ml.html#val-embed" class="source_link">Source</a><code><span><span class="keyword">val</span> embed : 
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'value</span>)</span> <a href="#type-field_parser">field_parser</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'acc</span>, <span class="type-var">'value</span>)</span> <a href="#type-field_parser">field_parser</a></span></span></code></div></div></div></body></html>
