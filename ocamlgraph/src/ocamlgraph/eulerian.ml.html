<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: eulerian.ml (ocamlgraph.src.ocamlgraph)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocamlgraph</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; ocamlgraph &#x00BB; eulerian.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>eulerian.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocamlgraph</a><ul><li>Library <code>ocamlgraph</code><ul><li><a href="../../ocamlgraph/Graph/index.html">Graph</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>ocamlgraph<ul><li><a href="blocks.ml.html">blocks.ml</a></li><li><a href="builder.ml.html">builder.ml</a></li><li><a href="chaoticIteration.ml.html">chaoticIteration.ml</a></li><li><a href="classic.ml.html">classic.ml</a></li><li><a href="clique.ml.html">clique.ml</a></li><li><a href="cliquetree.ml.html">cliquetree.ml</a></li><li><a href="coloring.ml.html">coloring.ml</a></li><li><a href="components.ml.html">components.ml</a></li><li><a href="contraction.ml.html">contraction.ml</a></li><li><a href="cycles.ml.html">cycles.ml</a></li><li><a href="dGraphModel.ml.html">dGraphModel.ml</a></li><li><a href="dGraphRandModel.ml.html">dGraphRandModel.ml</a></li><li><a href="dGraphSubTree.ml.html">dGraphSubTree.ml</a></li><li><a href="dGraphTreeLayout.ml.html">dGraphTreeLayout.ml</a></li><li><a href="dGraphTreeModel.ml.html">dGraphTreeModel.ml</a></li><li><a href="delaunay.ml.html">delaunay.ml</a></li><li><a href="dominator.ml.html">dominator.ml</a></li><li><a href="dot.ml.html">dot.ml</a></li><li><a href="dot_lexer.ml.html">dot_lexer.ml</a></li><li><a href="dot_parser.ml.html">dot_parser.ml</a></li><li><a href="#" class="current_unit">eulerian.ml</a></li><li><a href="fixpoint.ml.html">fixpoint.ml</a></li><li><a href="flow.ml.html">flow.ml</a></li><li><a href="gmap.ml.html">gmap.ml</a></li><li><a href="gml.ml.html">gml.ml</a></li><li><a href="graph.ml.html">graph.ml</a></li><li><a href="graph__.ml.html">graph__.ml</a></li><li><a href="graphml.ml.html">graphml.ml</a></li><li><a href="graphviz.ml.html">graphviz.ml</a></li><li><a href="imperative.ml.html">imperative.ml</a></li><li><a href="kruskal.ml.html">kruskal.ml</a></li><li><a href="leaderlist.ml.html">leaderlist.ml</a></li><li><a href="mcs_m.ml.html">mcs_m.ml</a></li><li><a href="md.ml.html">md.ml</a></li><li><a href="merge.ml.html">merge.ml</a></li><li><a href="mincut.ml.html">mincut.ml</a></li><li><a href="minsep.ml.html">minsep.ml</a></li><li><a href="nonnegative.ml.html">nonnegative.ml</a></li><li><a href="oper.ml.html">oper.ml</a></li><li><a href="pack.ml.html">pack.ml</a></li><li><a href="path.ml.html">path.ml</a></li><li><a href="persistent.ml.html">persistent.ml</a></li><li><a href="prim.ml.html">prim.ml</a></li><li><a href="rand.ml.html">rand.ml</a></li><li><a href="strat.ml.html">strat.ml</a></li><li><a href="topological.ml.html">topological.ml</a></li><li><a href="traverse.ml.html">traverse.ml</a></li><li><a href="util.ml.html">util.ml</a></li><li><a href="weakTopological.ml.html">weakTopological.ml</a></li><li><a href="xDot.ml.html">xDot.ml</a></li><li><a href="xDotDraw.ml.html">xDotDraw.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  Ocamlgraph: a generic graph library for OCaml                         *)</span><span class="EOL">
</span><span class="COMMENT">(*  Copyright (C) 2004-2010                                               *)</span><span class="EOL">
</span><span class="COMMENT">(*  Sylvain Conchon, Jean-Christophe Filliatre and Julien Signoles        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This software is free software; you can redistribute it and/or        *)</span><span class="EOL">
</span><span class="COMMENT">(*  modify it under the terms of the GNU Library General Public           *)</span><span class="EOL">
</span><span class="COMMENT">(*  License version 2.1, with the special exception on linking            *)</span><span class="EOL">
</span><span class="COMMENT">(*  described in file LICENSE.                                            *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This software is distributed in the hope that it will be useful,      *)</span><span class="EOL">
</span><span class="COMMENT">(*  but WITHOUT ANY WARRANTY; without even the implied warranty of        *)</span><span class="EOL">
</span><span class="COMMENT">(*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-G"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">G</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-G.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-G.val-is_directed"><span class="VAL">val</span> <span class="LIDENT">is_directed</span> <span class="COLON">:</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-G.module-V"><span class="MODULE">module</span> <span class="UIDENT">V</span> <span class="COLON">:</span> <span class="UIDENT">Sig</span><span class="DOT">.</span><span class="UIDENT">COMPARABLE</span></span><span class="EOL">
</span>  <span id="module-type-G.module-E"><span class="MODULE">module</span> <span class="UIDENT">E</span> <span class="COLON">:</span> <span class="UIDENT">Sig</span><span class="DOT">.</span><span class="UIDENT">EDGE</span> <span class="WITH">with</span> <span id="def_133"><span class="TYPE">type</span> <span class="LIDENT">vertex</span> <span class="EQUAL">=</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span></span><span class="EOL">
</span>  <span id="module-type-G.val-iter_edges_e"><span class="VAL">val</span> <span class="LIDENT">iter_edges_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** The following implements Hierholzer's algorithm.

    It is sketched as follows:

    1. make a round trip from a random vertex, by following random
       edges until we get back to the starting point (it will, as we
       first check that all vertices have even degrees).

    2. if any vertex along this cycle still has outgoing edges, pick one
       and make another round trip from it, and then join the two cycles
       into a single one. Repeat step 2 until all edges are exhausted.

    The implementation makes use of the following:

    - A table, called `out` in the following, that maps each vertex to
      outgoing edges not yet used in the Eulerian path.

    - In order to achieve optimal complexity, paths are built as
      doubly-linked lists, so that we can merge two cycles with a common
      vertex in constant time. This is type `dll` below.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Make"><span class="MODULE">module</span> <span class="UIDENT">Make</span><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="COLON">:</span> <span class="UIDENT">G</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="OPEN">open</span> <span class="UIDENT">G</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-rev"><span class="LIDENT">rev</span></span> <span id="local_e_1"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_1"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_1"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_1"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.module-H"><span class="MODULE">module</span> <span class="UIDENT">H</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#module-Make"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">V</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.type-out"><span class="TYPE">type</span> <span class="LIDENT">out</span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-add_out_edge"><span class="LIDENT">add_out_edge</span></span> <span id="local_out_2"><span class="LIDENT">out</span></span> <span id="local_x_3"><span class="LIDENT">x</span></span> <span id="local_y_4"><span class="LIDENT">y</span></span> <span id="local_e_5"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_6"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="TRY">try</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_2"><span class="LIDENT">out</span></a> <a href="#local_x_3"><span class="LIDENT">x</span></a><span class="EOL">
</span>            <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span id="local_s_7"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">4</span> <span class="IN">in</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_out_2"><span class="LIDENT">out</span></a> <a href="#local_x_3"><span class="LIDENT">x</span></a> <a href="#local_s_7"><span class="LIDENT">s</span></a><span class="SEMI">;</span> <a href="#local_s_7"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_s_6"><span class="LIDENT">s</span></a> <a href="#local_y_4"><span class="LIDENT">y</span></a> <a href="#local_e_5"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** compute the table of outgoing edges *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-setup"><span class="LIDENT">setup</span></span> <span id="local_g_8"><span class="LIDENT">g</span></span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">out</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nbe_9"><span class="LIDENT">nbe</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_out_10"><span class="LIDENT">out</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">16</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_add_11"><span class="LIDENT">add</span></span> <span id="local_e_12"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_nbe_9"><span class="LIDENT">nbe</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_x_13"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_12"><span class="LIDENT">e</span></a> <span class="AND">and</span> <span id="local_y_14"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_12"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">add_out_edge</span> <a href="#local_out_10"><span class="LIDENT">out</span></a> <a href="#local_x_13"><span class="LIDENT">x</span></a> <a href="#local_y_14"><span class="LIDENT">y</span></a> <a href="#local_e_12"><span class="LIDENT">e</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LIDENT">is_directed</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_x_13"><span class="LIDENT">x</span></a> <a href="#local_y_14"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LIDENT">add_out_edge</span> <a href="#local_out_10"><span class="LIDENT">out</span></a> <a href="#local_y_14"><span class="LIDENT">y</span></a> <a href="#local_x_13"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><span class="LIDENT">rev</span> <a href="#local_e_12"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">iter_edges_e</span> <a href="#local_add_11"><span class="LIDENT">add</span></a> <a href="#local_g_8"><span class="LIDENT">g</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nbe_9"><span class="LIDENT">nbe</span></a><span class="COMMA">,</span> <a href="#local_out_10"><span class="LIDENT">out</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.exception-Found"><span class="EXCEPTION">exception</span> <span class="UIDENT">Found</span> <span class="OF">of</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-any"><span class="LIDENT">any</span></span> <span id="local_h_15"><span class="LIDENT">h</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">iter</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_v_16"><span class="LIDENT">v</span></span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Found</span> <a href="#local_v_16"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_h_15"><span class="LIDENT">h</span></a><span class="SEMI">;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Found</span> <span id="local_v_17"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_v_17"><span class="LIDENT">v</span></a><span class="COMMA">,</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_h_15"><span class="LIDENT">h</span></a> <a href="#local_v_17"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.type-dll"><span class="TYPE">type</span> <span class="LIDENT">dll</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span id="def_128"><span class="MUTABLE">mutable</span> <span class="LIDENT">prev</span><span class="COLON">:</span> <span class="LIDENT">dll</span><span class="SEMI">;</span></span> <span id="def_132"><span class="LIDENT">edge</span><span class="COLON">:</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="SEMI">;</span></span> <span id="def_124"><span class="MUTABLE">mutable</span> <span class="LIDENT">next</span><span class="COLON">:</span> <span class="LIDENT">dll</span></span> <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-{remove_edge}1/shadowed/(ocamlgraph-src-ocamlgraph-eulerian.ml)"><span class="LIDENT">remove_edge</span></span> <span id="local_out_18"><span class="LIDENT">out</span></span> <span id="local_e_19"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_remove_20"><span class="LIDENT">remove</span></span> <span id="local_h_21"><span class="LIDENT">h</span></span> <span id="local_x_22"><span class="LIDENT">x</span></span> <span id="local_y_23"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_24"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_h_21"><span class="LIDENT">h</span></a> <a href="#local_x_22"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_s_24"><span class="LIDENT">s</span></a> <a href="#local_y_23"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_s_24"><span class="LIDENT">s</span></a> <a href="#local_y_23"><span class="LIDENT">y</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_s_24"><span class="LIDENT">s</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_h_21"><span class="LIDENT">h</span></a> <a href="#local_x_22"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_v_25"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_19"><span class="LIDENT">e</span></a> <span class="AND">and</span> <span id="local_w_26"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_19"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_remove_20"><span class="LIDENT">remove</span></a> <a href="#local_out_18"><span class="LIDENT">out</span></a> <a href="#local_v_25"><span class="LIDENT">v</span></a> <a href="#local_w_26"><span class="LIDENT">w</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-self"><span class="LIDENT">self</span></span> <span id="local_e_27"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_27"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_27"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-remove_edge"><span class="LIDENT">remove_edge</span></span> <span id="local_edges_28"><span class="LIDENT">edges</span></span> <span id="local_e_29"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">remove_edge</span> <a href="#local_edges_28"><span class="LIDENT">edges</span></a> <a href="#local_e_29"><span class="LIDENT">e</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LIDENT">is_directed</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">self</span> <a href="#local_e_29"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="LIDENT">remove_edge</span> <a href="#local_edges_28"><span class="LIDENT">edges</span></a> <span class="LPAREN">(</span><span class="LIDENT">rev</span> <a href="#local_e_29"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-any_out_edge"><span class="LIDENT">any_out_edge</span></span> <span id="local_out_30"><span class="LIDENT">out</span></span> <span id="local_v_31"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_out_30"><span class="LIDENT">out</span></a> <a href="#local_v_31"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_32"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_30"><span class="LIDENT">out</span></a> <a href="#local_v_31"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_s_32"><span class="LIDENT">s</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_126"><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_e_33"><span class="LIDENT">e</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">any</span> <a href="#local_s_32"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">remove_edge</span> <a href="#local_out_30"><span class="LIDENT">out</span></a> <a href="#local_e_33"><span class="LIDENT">e</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_e_33"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** build an arbitrary cycle from vertex [start] *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-round_trip"><span class="LIDENT">round_trip</span></span> <span id="local_edges_34"><span class="LIDENT">edges</span></span> <span id="local_start_35"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_e_36"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="LIDENT">any_out_edge</span> <a href="#local_edges_34"><span class="LIDENT">edges</span></a> <a href="#local_start_35"><span class="LIDENT">start</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_path_37"><span class="LIDENT">path</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">prev</span> <span class="EQUAL">=</span> <a href="#local_path_37"><span class="LIDENT">path</span></a><span class="SEMI">;</span> <span class="LIDENT">edge</span> <span class="EQUAL">=</span> <a href="#local_e_36"><span class="LIDENT">e</span></a><span class="SEMI">;</span> <span class="LIDENT">next</span> <span class="EQUAL">=</span> <a href="#local_path_37"><span class="LIDENT">path</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_tour_38"><span class="LIDENT">tour</span></span> <span id="local_e_39"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_40"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_39"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_v_40"><span class="LIDENT">v</span></a> <a href="#local_start_35"><span class="LIDENT">start</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_path_37"><span class="LIDENT">path</span></a><span class="DOT">.</span><span class="LIDENT">prev</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_39"><span class="LIDENT">e</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_path_37"><span class="LIDENT">path</span></a><span class="EOL">
</span>      <span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_e'_41"><span class="LIDENT">e'</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">prev</span> <span class="EQUAL">=</span> <a href="#local_e_39"><span class="LIDENT">e</span></a><span class="SEMI">;</span> <span class="LIDENT">edge</span> <span class="EQUAL">=</span> <span class="LIDENT">any_out_edge</span> <a href="#local_edges_34"><span class="LIDENT">edges</span></a> <a href="#local_v_40"><span class="LIDENT">v</span></a><span class="SEMI">;</span> <span class="LIDENT">next</span> <span class="EQUAL">=</span> <a href="#local_path_37"><span class="LIDENT">path</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_e_39"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e'_41"><span class="LIDENT">e'</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_tour_38"><span class="LIDENT">tour</span></a> <a href="#local_e'_41"><span class="LIDENT">e'</span></a><span class="EOL">
</span>      <span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_tour_38"><span class="LIDENT">tour</span></a> <a href="#local_path_37"><span class="LIDENT">path</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-connect"><span class="LIDENT">connect</span></span> <span id="local_e_42"><span class="LIDENT">e</span></span> <span id="local_e'_43"><span class="LIDENT">e'</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_e_42"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e'_43"><span class="LIDENT">e'</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_e'_43"><span class="LIDENT">e'</span></a><span class="DOT">.</span><span class="LIDENT">prev</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_e_42"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** build an Eulerian cycle from vertex [start] *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-eulerian_cycle"><span class="LIDENT">eulerian_cycle</span></span> <span id="local_out_44"><span class="LIDENT">out</span></span> <span id="local_start_45"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_todos_46"><span class="LIDENT">todos</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">8</span> <span class="IN">in</span> <span class="COMMENT">(* vertex on cycle with out edges -&gt; cycle edge *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_todo_47"><span class="LIDENT">todo</span></span> <span id="local_e_48"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_v_49"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_48"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_out_44"><span class="LIDENT">out</span></a> <a href="#local_v_49"><span class="LIDENT">v</span></a> <span class="THEN">then</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_todos_46"><span class="LIDENT">todos</span></a> <a href="#local_v_49"><span class="LIDENT">v</span></a> <a href="#local_e_48"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_todos_46"><span class="LIDENT">todos</span></a> <a href="#local_v_49"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_update_50"><span class="LIDENT">update</span></span> <span id="local_start_51"><span class="LIDENT">start</span></span> <span id="local_e_52"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_todo_47"><span class="LIDENT">todo</span></a> <a href="#local_e_52"><span class="LIDENT">e</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_52"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span><span class="RPAREN">)</span> <a href="#local_start_51"><span class="LIDENT">start</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_update_50"><span class="LIDENT">update</span></a> <a href="#local_start_51"><span class="LIDENT">start</span></a> <a href="#local_e_52"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_path_53"><span class="LIDENT">path</span></span> <span class="EQUAL">=</span> <span class="LIDENT">round_trip</span> <a href="#local_out_44"><span class="LIDENT">out</span></a> <a href="#local_start_45"><span class="LIDENT">start</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_update_50"><span class="LIDENT">update</span></a> <a href="#local_start_45"><span class="LIDENT">start</span></a> <a href="#local_path_53"><span class="LIDENT">path</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="WHILE">while</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_todos_46"><span class="LIDENT">todos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_125"><span id="local_v_54"><span class="LIDENT">v</span></span><span class="COMMA">,</span> <span id="local_e_55"><span class="LIDENT">e</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">any</span> <a href="#local_todos_46"><span class="LIDENT">todos</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_todos_46"><span class="LIDENT">todos</span></a> <a href="#local_v_54"><span class="LIDENT">v</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_out_44"><span class="LIDENT">out</span></a> <a href="#local_v_54"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_e'_56"><span class="LIDENT">e'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">round_trip</span> <a href="#local_out_44"><span class="LIDENT">out</span></a> <a href="#local_v_54"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_update_50"><span class="LIDENT">update</span></a> <a href="#local_v_54"><span class="LIDENT">v</span></a> <a href="#local_e'_56"><span class="LIDENT">e'</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p_57"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <a href="#local_e_55"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">prev</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_p_57"><span class="LIDENT">p</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_e_55"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p'_58"><span class="LIDENT">p'</span></span> <span class="EQUAL">=</span> <a href="#local_e'_56"><span class="LIDENT">e'</span></a><span class="DOT">.</span><span class="LIDENT">prev</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_p'_58"><span class="LIDENT">p'</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_e'_56"><span class="LIDENT">e'</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">connect</span> <a href="#local_p_57"><span class="LIDENT">p</span></a> <a href="#local_e'_56"><span class="LIDENT">e'</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">connect</span> <a href="#local_p'_58"><span class="LIDENT">p'</span></a> <a href="#local_e_55"><span class="LIDENT">e</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_path_53"><span class="LIDENT">path</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-list_of"><span class="LIDENT">list_of</span></span> <span id="local_path_59"><span class="LIDENT">path</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_convert_60"><span class="LIDENT">convert</span></span> <span id="local_acc_61"><span class="LIDENT">acc</span></span> <span id="local_e_62"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_e_62"><span class="LIDENT">e</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_path_59"><span class="LIDENT">path</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_acc_61"><span class="LIDENT">acc</span></a> <span class="ELSE">else</span> <a href="#local_convert_60"><span class="LIDENT">convert</span></a> <span class="LPAREN">(</span><a href="#local_e_62"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span> <span class="COLONCOLON">::</span> <a href="#local_acc_61"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span> <a href="#local_e_62"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_convert_60"><span class="LIDENT">convert</span></a> <span class="LBRACKET">[</span><a href="#local_path_59"><span class="LIDENT">path</span></a><span class="DOT">.</span><span class="LIDENT">edge</span><span class="RBRACKET">]</span> <a href="#local_path_59"><span class="LIDENT">path</span></a><span class="DOT">.</span><span class="LIDENT">next</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-mem_edge"><span class="LIDENT">mem_edge</span></span> <span id="local_out_63"><span class="LIDENT">out</span></span> <span id="local_x_64"><span class="LIDENT">x</span></span> <span id="local_y_65"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_63"><span class="LIDENT">out</span></a> <a href="#local_x_64"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_y_65"><span class="LIDENT">y</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-out_degree"><span class="LIDENT">out_degree</span></span> <span id="local_out_66"><span class="LIDENT">out</span></span> <span id="local_x_67"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_66"><span class="LIDENT">out</span></a> <a href="#local_x_67"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-undirected"><span class="LIDENT">undirected</span></span> <span id="local_g_68"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_121"><span id="local_nbe_69"><span class="LIDENT">nbe</span></span><span class="COMMA">,</span> <span id="local_out_70"><span class="LIDENT">out</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">setup</span> <a href="#local_g_68"><span class="LIDENT">g</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_odds_71"><span class="LIDENT">odds</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_check_72"><span class="LIDENT">check</span></span> <span id="local_v_73"><span class="LIDENT">v</span></span> <span id="local_s_74"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_d_75"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_d_76"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <a href="#local_v_73"><span class="LIDENT">v</span></a> <span class="THEN">then</span> <a href="#local_d_75"><span class="LIDENT">d</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="ELSE">else</span> <a href="#local_d_75"><span class="LIDENT">d</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_d_76"><span class="LIDENT">d</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">1</span> <span class="THEN">then</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_odds_71"><span class="LIDENT">odds</span></a> <a href="#local_v_73"><span class="LIDENT">v</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">iter</span> <a href="#local_check_72"><span class="LIDENT">check</span></a> <a href="#local_out_70"><span class="LIDENT">out</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n_77"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_odds_71"><span class="LIDENT">odds</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_n_77"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_n_77"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">2</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Eulerian.path (bad degrees)&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_cycle_78"><span class="LIDENT">cycle</span></span> <span class="EQUAL">=</span> <a href="#local_n_77"><span class="LIDENT">n</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_path_79"><span class="LIDENT">path</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_cycle_78"><span class="LIDENT">cycle</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_nbe_69"><span class="LIDENT">nbe</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LET">let</span> <span id="def_123"><span id="local_v_80"><span class="LIDENT">v</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span></span> <span class="EQUAL">=</span> <span class="LIDENT">any</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <span class="IN">in</span> <span class="LIDENT">list_of</span> <span class="LPAREN">(</span><span class="LIDENT">eulerian_cycle</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_v_80"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="COMMENT">(* we have two vertices x and y with odd degrees *)</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_127"><span id="local_x_81"><span class="LIDENT">x</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span></span> <span class="EQUAL">=</span> <span class="LIDENT">any</span> <a href="#local_odds_71"><span class="LIDENT">odds</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_odds_71"><span class="LIDENT">odds</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_130"><span id="local_y_82"><span class="LIDENT">y</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span></span> <span class="EQUAL">=</span> <span class="LIDENT">any</span> <a href="#local_odds_71"><span class="LIDENT">odds</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="LIDENT">mem_edge</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="COMMENT">(* there is an edge x--y =&gt; it connects 1 or 2 Eulerian cycles *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_xy_83"><span class="LIDENT">xy</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_y_82"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">remove_edge</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_xy_83"><span class="LIDENT">xy</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="MATCH">match</span> <span class="LIDENT">out_degree</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="LIDENT">out_degree</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span><a href="#local_xy_83"><span class="LIDENT">xy</span></a><span class="RBRACKET">]</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">rev</span> <a href="#local_xy_83"><span class="LIDENT">xy</span></a> <span class="COLONCOLON">::</span> <span class="LIDENT">list_of</span> <span class="LPAREN">(</span><span class="LIDENT">eulerian_cycle</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_xy_83"><span class="LIDENT">xy</span></a> <span class="COLONCOLON">::</span> <span class="LIDENT">list_of</span> <span class="LPAREN">(</span><span class="LIDENT">eulerian_cycle</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_py_84"><span class="LIDENT">py</span></span> <span class="EQUAL">=</span> <span class="LIDENT">eulerian_cycle</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>              <span class="COMMENT">(* caveat: the cycle from y may exhaust edges from x *)</span><span class="EOL">
</span>              <span class="IF">if</span> <span class="LIDENT">out_degree</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_xy_83"><span class="LIDENT">xy</span></a> <span class="COLONCOLON">::</span> <span class="LIDENT">list_of</span> <a href="#local_py_84"><span class="LIDENT">py</span></a><span class="EOL">
</span>              <span class="ELSE">else</span> <span class="LIDENT">list_of</span> <span class="LPAREN">(</span><span class="LIDENT">eulerian_cycle</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(@)"><span class="INFIXOP1">@</span></a> <a href="#local_xy_83"><span class="LIDENT">xy</span></a> <span class="COLONCOLON">::</span> <span class="LIDENT">list_of</span> <a href="#local_py_84"><span class="LIDENT">py</span></a><span class="EOL">
</span>                <span class="COMMENT">(* a bit of a pity to use list concatenation here,
                   but this does not change the complexity *)</span><span class="EOL">
</span>        <span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="COMMENT">(* no edge x--y =&gt; add one, build a cycle, then remove it *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_dummy_85"><span class="LIDENT">dummy</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a> <span class="LPAREN">(</span><span class="LIDENT">any</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_xy_86"><span class="LIDENT">xy</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_x_81"><span class="LIDENT">x</span></a> <a href="#local_dummy_85"><span class="LIDENT">dummy</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_y_82"><span class="LIDENT">y</span></a> <a href="#local_xy_86"><span class="LIDENT">xy</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <a href="#local_x_81"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><span class="LIDENT">rev</span> <a href="#local_xy_86"><span class="LIDENT">xy</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_p_87"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <span class="LIDENT">eulerian_cycle</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span class="REC">rec</span> <span id="local_find_88"><span class="LIDENT">find</span></span> <span id="local_e_89"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="COMMENT">(* lookup for x--y, to break the cycle there *)</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_v_90"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_89"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span> <span class="AND">and</span> <span id="local_w_91"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_89"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span> <span class="IN">in</span><span class="EOL">
</span>            <span class="IF">if</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_v_90"><span class="LIDENT">v</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_w_91"><span class="LIDENT">w</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a><span class="EOL">
</span>               <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_v_90"><span class="LIDENT">v</span></a> <a href="#local_y_82"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_w_91"><span class="LIDENT">w</span></a> <a href="#local_x_81"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_e_89"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <a href="#local_find_88"><span class="LIDENT">find</span></a> <a href="#local_e_89"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_start_92"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span> <a href="#local_find_88"><span class="LIDENT">find</span></a> <a href="#local_p_87"><span class="LIDENT">p</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-tl"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">tl</span></a> <span class="LPAREN">(</span><span class="LIDENT">list_of</span> <a href="#local_start_92"><span class="LIDENT">start</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>      <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* check that all edges have been consumed *)</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_out_70"><span class="LIDENT">out</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Eulerian.path (not connected)&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_path_79"><span class="LIDENT">path</span></a><span class="COMMA">,</span> <a href="#local_cycle_78"><span class="LIDENT">cycle</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-directed"><span class="LIDENT">directed</span></span> <span id="local_g_93"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_delta_94"><span class="LIDENT">delta</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">16</span> <span class="IN">in</span> <span class="COMMENT">(* out - in *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_add_95"><span class="LIDENT">add</span></span> <span id="local_v_96"><span class="LIDENT">v</span></span> <span id="local_d_97"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_delta_94"><span class="LIDENT">delta</span></a> <a href="#local_v_96"><span class="LIDENT">v</span></a> <span class="LPAREN">(</span><a href="#local_d_97"><span class="LIDENT">d</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="TRY">try</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_delta_94"><span class="LIDENT">delta</span></a> <a href="#local_v_96"><span class="LIDENT">v</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_add_98"><span class="LIDENT">add</span></span> <span id="local_e_99"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_add_95"><span class="LIDENT">add</span></a> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_99"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="INT">1</span><span class="SEMI">;</span> <a href="#local_add_95"><span class="LIDENT">add</span></a> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_99"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="MINUS">-</span><span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">iter_edges_e</span> <a href="#local_add_98"><span class="LIDENT">add</span></a> <a href="#local_g_93"><span class="LIDENT">g</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_start_100"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">None</span> <span class="AND">and</span> <span id="local_finish_101"><span class="LIDENT">finish</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">None</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_check_102"><span class="LIDENT">check</span></span> <span id="local_v_103"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">1</span> <span class="WHEN">when</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_start_100"><span class="LIDENT">start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_start_100"><span class="LIDENT">start</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Some</span> <a href="#local_v_103"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="MINUS">-</span><span class="INT">1</span> <span class="WHEN">when</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_finish_101"><span class="LIDENT">finish</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_finish_101"><span class="LIDENT">finish</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Some</span> <a href="#local_v_103"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Eulerian.path (bad degrees)&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">iter</span> <a href="#local_check_102"><span class="LIDENT">check</span></a> <a href="#local_delta_94"><span class="LIDENT">delta</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_129"><span id="local_nbe_104"><span class="LIDENT">nbe</span></span><span class="COMMA">,</span> <span id="local_out_105"><span class="LIDENT">out</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">setup</span> <a href="#local_g_93"><span class="LIDENT">g</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_120"><span id="local_path_106"><span class="LIDENT">path</span></span><span class="COMMA">,</span> <span id="local_cycle_107"><span class="LIDENT">cycle</span></span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_start_100"><span class="LIDENT">start</span></a><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_finish_101"><span class="LIDENT">finish</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span><span class="COMMA">,</span> <span class="UIDENT">None</span> <span class="WHEN">when</span> <a href="#local_nbe_104"><span class="LIDENT">nbe</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span><span class="COMMA">,</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_131"><span id="local_v_108"><span class="LIDENT">v</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span></span> <span class="EQUAL">=</span> <span class="LIDENT">any</span> <a href="#local_out_105"><span class="LIDENT">out</span></a> <span class="IN">in</span> <span class="LIDENT">list_of</span> <span class="LPAREN">(</span><span class="LIDENT">eulerian_cycle</span> <a href="#local_out_105"><span class="LIDENT">out</span></a> <a href="#local_v_108"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_s_109"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span class="UIDENT">Some</span> <span id="local_f_110"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* add one edge f-&gt;s, build a cycle, then remove it
             note: there may be already an edge f-&gt;s
                   if so, we are adding *a second one* and we are careful
                   about removing this one, not the other *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_dummy_111"><span class="LIDENT">dummy</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a> <span class="LPAREN">(</span><span class="LIDENT">any</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_out_105"><span class="LIDENT">out</span></a> <a href="#local_s_109"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_fs_112"><span class="LIDENT">fs</span></span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_f_110"><span class="LIDENT">f</span></a> <a href="#local_dummy_111"><span class="LIDENT">dummy</span></a> <a href="#local_s_109"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">add_out_edge</span> <a href="#local_out_105"><span class="LIDENT">out</span></a> <a href="#local_f_110"><span class="LIDENT">f</span></a> <a href="#local_s_109"><span class="LIDENT">s</span></a> <a href="#local_fs_112"><span class="LIDENT">fs</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_p_113"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <span class="LIDENT">eulerian_cycle</span> <a href="#local_out_105"><span class="LIDENT">out</span></a> <a href="#local_s_109"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span class="REC">rec</span> <span id="local_find_114"><span class="LIDENT">find</span></span> <span id="local_e_115"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="COMMENT">(* lookup for f-&gt;s, to break the cycle there *)</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_e_115"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">edge</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_fs_112"><span class="LIDENT">fs</span></a> <span class="THEN">then</span> <a href="#local_e_115"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <a href="#local_find_114"><span class="LIDENT">find</span></a> <a href="#local_e_115"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">next</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_start_116"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span> <a href="#local_find_114"><span class="LIDENT">find</span></a> <a href="#local_p_113"><span class="LIDENT">p</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-tl"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">tl</span></a> <span class="LPAREN">(</span><span class="LIDENT">list_of</span> <a href="#local_start_116"><span class="LIDENT">start</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span><span class="COMMA">,</span> <span class="UIDENT">Some</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="COMMENT">(* since the sum of all deltas is zero *)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* check that all edges have been consumed *)</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_out_105"><span class="LIDENT">out</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Eulerian.path (not connected)&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_path_106"><span class="LIDENT">path</span></a><span class="COMMA">,</span> <a href="#local_cycle_107"><span class="LIDENT">cycle</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-path"><span class="LIDENT">path</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">is_directed</span> <span class="THEN">then</span> <span class="LIDENT">directed</span> <span class="ELSE">else</span> <span class="LIDENT">undirected</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-cycle"><span class="LIDENT">cycle</span></span> <span id="local_g_117"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_122"><span id="local_p_118"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_119"><span class="LIDENT">c</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">path</span> <a href="#local_g_117"><span class="LIDENT">g</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_c_119"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Eulerian.cycle&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_p_118"><span class="LIDENT">p</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span></span></code></pre></body></html>
