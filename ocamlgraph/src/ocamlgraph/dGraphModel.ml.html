<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: dGraphModel.ml (ocamlgraph.src.ocamlgraph)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">ocamlgraph</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; ocamlgraph &#x00BB; dGraphModel.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>dGraphModel.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocamlgraph</a><ul><li>Library <code>ocamlgraph</code><ul><li><a href="../../ocamlgraph/Graph/index.html">Graph</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>ocamlgraph<ul><li><a href="blocks.ml.html">blocks.ml</a></li><li><a href="builder.ml.html">builder.ml</a></li><li><a href="chaoticIteration.ml.html">chaoticIteration.ml</a></li><li><a href="classic.ml.html">classic.ml</a></li><li><a href="clique.ml.html">clique.ml</a></li><li><a href="cliquetree.ml.html">cliquetree.ml</a></li><li><a href="coloring.ml.html">coloring.ml</a></li><li><a href="components.ml.html">components.ml</a></li><li><a href="contraction.ml.html">contraction.ml</a></li><li><a href="cycles.ml.html">cycles.ml</a></li><li><a href="#" class="current_unit">dGraphModel.ml</a></li><li><a href="dGraphRandModel.ml.html">dGraphRandModel.ml</a></li><li><a href="dGraphSubTree.ml.html">dGraphSubTree.ml</a></li><li><a href="dGraphTreeLayout.ml.html">dGraphTreeLayout.ml</a></li><li><a href="dGraphTreeModel.ml.html">dGraphTreeModel.ml</a></li><li><a href="delaunay.ml.html">delaunay.ml</a></li><li><a href="dominator.ml.html">dominator.ml</a></li><li><a href="dot.ml.html">dot.ml</a></li><li><a href="dot_lexer.ml.html">dot_lexer.ml</a></li><li><a href="dot_parser.ml.html">dot_parser.ml</a></li><li><a href="eulerian.ml.html">eulerian.ml</a></li><li><a href="fixpoint.ml.html">fixpoint.ml</a></li><li><a href="flow.ml.html">flow.ml</a></li><li><a href="gmap.ml.html">gmap.ml</a></li><li><a href="gml.ml.html">gml.ml</a></li><li><a href="graph.ml.html">graph.ml</a></li><li><a href="graph__.ml.html">graph__.ml</a></li><li><a href="graphml.ml.html">graphml.ml</a></li><li><a href="graphviz.ml.html">graphviz.ml</a></li><li><a href="imperative.ml.html">imperative.ml</a></li><li><a href="kruskal.ml.html">kruskal.ml</a></li><li><a href="leaderlist.ml.html">leaderlist.ml</a></li><li><a href="mcs_m.ml.html">mcs_m.ml</a></li><li><a href="md.ml.html">md.ml</a></li><li><a href="merge.ml.html">merge.ml</a></li><li><a href="mincut.ml.html">mincut.ml</a></li><li><a href="minsep.ml.html">minsep.ml</a></li><li><a href="nonnegative.ml.html">nonnegative.ml</a></li><li><a href="oper.ml.html">oper.ml</a></li><li><a href="pack.ml.html">pack.ml</a></li><li><a href="path.ml.html">path.ml</a></li><li><a href="persistent.ml.html">persistent.ml</a></li><li><a href="prim.ml.html">prim.ml</a></li><li><a href="rand.ml.html">rand.ml</a></li><li><a href="strat.ml.html">strat.ml</a></li><li><a href="topological.ml.html">topological.ml</a></li><li><a href="traverse.ml.html">traverse.ml</a></li><li><a href="util.ml.html">util.ml</a></li><li><a href="weakTopological.ml.html">weakTopological.ml</a></li><li><a href="xDot.ml.html">xDot.ml</a></li><li><a href="xDotDraw.ml.html">xDotDraw.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This file is part of OcamlGraph.                                      *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  Copyright (C) 2009-2010                                               *)</span><span class="EOL">
</span><span class="COMMENT">(*    CEA (Commissariat � l'�nergie Atomique)                             *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  you can redistribute it and/or modify it under the terms of the GNU   *)</span><span class="EOL">
</span><span class="COMMENT">(*  Lesser General Public License as published by the Free Software       *)</span><span class="EOL">
</span><span class="COMMENT">(*  Foundation, version 2.1, with a linking exception.                    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  It is distributed in the hope that it will be useful,                 *)</span><span class="EOL">
</span><span class="COMMENT">(*  but WITHOUT ANY WARRANTY; without even the implied warranty of        *)</span><span class="EOL">
</span><span class="COMMENT">(*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *)</span><span class="EOL">
</span><span class="COMMENT">(*  GNU Lesser General Public License for more details.                   *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  See the file ../LICENSE for more details.                             *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  Authors:                                                              *)</span><span class="EOL">
</span><span class="COMMENT">(*    - Julien Signoles  (Julien.Signoles@cea.fr)                         *)</span><span class="EOL">
</span><span class="COMMENT">(*    - Jean-Denis Koeck (jdkoeck@gmail.com)                              *)</span><span class="EOL">
</span><span class="COMMENT">(*    - Benoit Bataille  (benoit.bataille@gmail.com)                      *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* This graph model is for now immutable, no adding or removing nodes. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="xDot.ml.html"><span class="UIDENT">XDot</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="exception-DotError"><span class="EXCEPTION">exception</span> <span class="UIDENT">DotError</span> <span class="OF">of</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* ABSTRACT CLASS *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="CLASS">class</span> <span class="TYPE">type</span> <span class="LBRACKET">[</span><span class="QUOTE">'</span><span class="LIDENT">vertex</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">edge</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">cluster</span><span class="RBRACKET">]</span> <span id="class-type-abstract_model"><span class="LIDENT">abstract_model</span></span> <span class="EQUAL">=</span> <span class="OBJECT">object</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_edges</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_edges_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_pred</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_pred_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_succ</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_succ_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_vertex</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_clusters</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">cluster</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">iter_associated_vertex</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Membership functions *)</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">find_edge</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">edge</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">mem_edge</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">mem_edge_e</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">mem_vertex</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">src</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">dst</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Dot layout *)</span><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">bounding_box</span> <span class="COLON">:</span> <a href="xDot.ml.html#type-bounding_box"><span class="LIDENT">bounding_box</span></a><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">get_edge_layout</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">edge</span> <span class="MINUSGREATER">-&gt;</span> <a href="xDot.ml.html#type-edge_layout"><span class="LIDENT">edge_layout</span></a><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">get_vertex_layout</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <a href="xDot.ml.html#type-node_layout"><span class="LIDENT">node_layout</span></a><span class="EOL">
</span>  <span class="METHOD">method</span> <span class="LIDENT">get_cluster_layout</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">cluster</span> <span class="MINUSGREATER">-&gt;</span> <a href="xDot.ml.html#type-cluster_layout"><span class="LIDENT">cluster_layout</span></a><span class="EOL">
</span><span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* BUILDING A MODEL WITH AN OCAML GRAPH *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Make"><span class="MODULE">module</span> <span class="UIDENT">Make</span><span class="LPAREN">(</span><span class="UIDENT">G</span> <span class="COLON">:</span> <a href="graphviz.ml.html#module-type-GraphWithDotAttrs"><span class="UIDENT">Graphviz</span><span class="DOT">.</span><span class="UIDENT">GraphWithDotAttrs</span></a><span class="RPAREN">)</span><span class="EOL">
</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>   <span id="module-Make.exception-Multiple_layouts"><span class="EXCEPTION">exception</span> <span class="UIDENT">Multiple_layouts</span> <span class="OF">of</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <a href="xDot.ml.html#type-edge_layout"><span class="LIDENT">edge_layout</span></a><span class="RPAREN">)</span> <span class="LIDENT">list</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.type-cluster"><span class="TYPE">type</span> <span class="LIDENT">cluster</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span id="module-Make.module-X"><span class="MODULE">module</span> <span class="UIDENT">X</span> <span class="EQUAL">=</span> <a href="xDot.ml.html#module-Make"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="CLASS">class</span> <span id="module-Make.class-model"><span class="LIDENT">model</span></span> <span id="local_layout_1"><span class="LIDENT">layout</span></span> <span id="local_g_2"><span class="LIDENT">g</span></span> <span class="COLON">:</span> <span class="LBRACKET">[</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">vertex</span><span class="COMMA">,</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">edge</span><span class="COMMA">,</span> <span class="LIDENT">cluster</span><span class="RBRACKET">]</span> <span class="LIDENT">abstract_model</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="OBJECT">object</span> <span class="LPAREN">(</span><span id="local_self_3"><span class="LIDENT">self</span></span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Iterators *)</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_edges</span> <span id="local_f_4"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_edges</span> <a href="#local_f_4"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_edges_e</span> <span id="local_f_5"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_edges_e</span> <a href="#local_f_5"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_pred</span> <span id="local_f_6"><span class="LIDENT">f</span></span> <span id="local_v_7"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_pred</span> <a href="#local_f_6"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span> <a href="#local_v_7"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_pred_e</span> <span id="local_f_8"><span class="LIDENT">f</span></span> <span id="local_v_9"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_pred_e</span> <a href="#local_f_8"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span> <a href="#local_v_9"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_succ</span> <span id="local_f_10"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_succ</span> <a href="#local_f_10"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_succ_e</span> <span id="local_f_11"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_succ_e</span> <a href="#local_f_11"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_vertex</span> <span id="local_f_12"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_vertex</span> <a href="#local_f_12"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_associated_vertex</span> <span id="local_f_13"><span class="LIDENT">f</span></span> <span id="local_v_14"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_f_13"><span class="LIDENT">f</span></a> <a href="#local_v_14"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">iter_clusters</span> <span id="local_f_15"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-iter"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_k_16"><span class="LIDENT">k</span></span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_15"><span class="LIDENT">f</span></a> <a href="#local_k_16"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <span class="LIDENT">layout</span><span class="DOT">.</span><span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">cluster_layouts</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Membership functions *)</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">find_edge</span> <span class="EQUAL">=</span> <span class="TRY">try</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">find_edge</span> <span class="LIDENT">g</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">mem_edge</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">mem_edge</span> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">mem_edge_e</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">mem_edge_e</span> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">mem_vertex</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">mem_vertex</span> <span class="LIDENT">g</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">src</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">dst</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Layout *)</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">bounding_box</span> <span class="EQUAL">=</span> <span class="LIDENT">layout</span><span class="DOT">.</span><span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">bbox</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">get_vertex_layout</span> <span id="local_v_17"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="UIDENT">X</span><span class="DOT">.</span><span class="UIDENT">HV</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LIDENT">layout</span><span class="DOT">.</span><span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">vertex_layouts</span> <a href="#local_v_17"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">get_edge_layout</span> <span id="local_e_18"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="UIDENT">X</span><span class="DOT">.</span><span class="UIDENT">HE</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_e_18"><span class="LIDENT">e</span></a> <span class="LIDENT">layout</span><span class="DOT">.</span><span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">edge_layouts</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="COMMENT">(* if there are several edges from a vertex [v1] to a vertex [v2], they
           can share the same layout. In that case, one these edges is
           unfortunately not in the layout table because of key sharing. Try to
           recover it when possible by creating a list of all possible layouts
           for the given edge. If there is only one, easy win, otherwise return
           them all in an exception and let the caller decide what to do *)</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_layouts_19"><span class="LIDENT">layouts</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">self</span><span class="HASH">#</span><span class="LIDENT">iter_succ_e</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e'_20"><span class="LIDENT">e'</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="IF">if</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <span class="LPAREN">(</span><span class="LIDENT">self</span><span class="HASH">#</span><span class="LIDENT">dst</span> <a href="#local_e_18"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">self</span><span class="HASH">#</span><span class="LIDENT">dst</span> <a href="#local_e'_20"><span class="LIDENT">e'</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>              <span class="TRY">try</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_layout_21"><span class="LIDENT">layout</span></span> <span class="EQUAL">=</span> <span class="UIDENT">X</span><span class="DOT">.</span><span class="UIDENT">HE</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_e'_20"><span class="LIDENT">e'</span></a> <span class="LIDENT">layout</span><span class="DOT">.</span><span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">edge_layouts</span> <span class="IN">in</span><span class="EOL">
</span>                <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-exists"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">exists</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_l_22"><span class="LIDENT">l</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_layout_21"><span class="LIDENT">layout</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_l_22"><span class="LIDENT">l</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_layouts_19"><span class="LIDENT">layouts</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>                  <a href="#local_layouts_19"><span class="LIDENT">layouts</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LPAREN">(</span><a href="#local_e'_20"><span class="LIDENT">e'</span></a><span class="COMMA">,</span> <a href="#local_layout_21"><span class="LIDENT">layout</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_layouts_19"><span class="LIDENT">layouts</span></a><span class="EOL">
</span>              <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="LIDENT">self</span><span class="HASH">#</span><span class="LIDENT">src</span> <a href="#local_e_18"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_layouts_19"><span class="LIDENT">layouts</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="LBRACKET">[</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_x_23"><span class="LIDENT">x</span></span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_23"><span class="LIDENT">x</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Multiple_layouts</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_layouts_19"><span class="LIDENT">layouts</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">get_cluster_layout</span> <span id="local_c_24"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-find"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">find</span></a> <span class="LIDENT">layout</span><span class="DOT">.</span><span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">cluster_layouts</span> <a href="#local_c_24"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-from_graph"><span class="LIDENT">from_graph</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_cmd_25"><span class="LIDENT">cmd</span></span><span class="EQUAL">=</span><span class="STRING">&quot;dot&quot;</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_tmp_name_26"><span class="LIDENT">tmp_name</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;dgraph&quot;</span><span class="RPAREN">)</span> <span id="local_g_27"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* Output dot file *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="MODULE">module</span> <span class="UIDENT">DumpDot</span> <span class="EQUAL">=</span> <a href="graphviz.ml.html#module-Dot"><span class="UIDENT">Graphviz</span><span class="DOT">.</span><span class="UIDENT">Dot</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_66"><span id="local_dot_file_28"><span class="LIDENT">dot_file</span></span><span class="COMMA">,</span> <span id="local_out_29"><span class="LIDENT">out</span></span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/filename.ml.html#val-open_temp_file"><span class="UIDENT">Filename</span><span class="DOT">.</span><span class="LIDENT">open_temp_file</span></a> <a href="#local_tmp_name_26"><span class="LIDENT">tmp_name</span></a> <span class="STRING">&quot;.dot&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">DumpDot</span><span class="DOT">.</span><span class="LIDENT">output_graph</span> <a href="#local_out_29"><span class="LIDENT">out</span></a> <a href="#local_g_27"><span class="LIDENT">g</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_out"><span class="LIDENT">close_out</span></a> <a href="#local_out_29"><span class="LIDENT">out</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="COMMENT">(* Get layout from dot file *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_layout_30"><span class="LIDENT">layout</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="UIDENT">X</span><span class="DOT">.</span><span class="LIDENT">layout_of_dot</span> <span class="TILDE">~</span><a href="#local_cmd_25"><span class="LIDENT">cmd</span></a> <span class="TILDE">~</span><a href="#local_dot_file_28"><span class="LIDENT">dot_file</span></a> <a href="#local_g_27"><span class="LIDENT">g</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">X</span><span class="DOT">.</span><span class="UIDENT">DotError</span> <span id="local_err_31"><span class="LIDENT">err</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">DotError</span> <a href="#local_err_31"><span class="LIDENT">err</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_model_32"><span class="LIDENT">model</span></span> <span class="EQUAL">=</span> <span class="NEW">new</span> <span class="LIDENT">model</span> <a href="#local_layout_30"><span class="LIDENT">layout</span></a> <a href="#local_g_27"><span class="LIDENT">g</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-remove"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">remove</span></a> <a href="#local_dot_file_28"><span class="LIDENT">dot_file</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_model_32"><span class="LIDENT">model</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* BUILDING A MODEL WITH A DOT FILE *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Here we build a model from a graph where vertices and edges
   are labeled with xdot layouts *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Vertex"><span class="MODULE">module</span> <span class="UIDENT">Vertex</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Vertex.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <a href="xDot.ml.html#type-node_layout"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">node_layout</span></a></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Edge"><span class="MODULE">module</span> <span class="UIDENT">Edge</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Edge.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <a href="xDot.ml.html#type-edge_layout"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">edge_layout</span></a></span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Edge.val-default"><span class="LIDENT">default</span></span> <span class="EQUAL">=</span> <a href="xDot.ml.html#val-mk_edge_layout"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">mk_edge_layout</span></a><span class="EOL">
</span>      <span class="LABEL">~draw:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LABEL">~ldraw:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LABEL">~hdraw:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LABEL">~tdraw:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LABEL">~hldraw:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LABEL">~tldraw:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Edge.val-compare"><span class="LIDENT">compare</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-compare"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">compare</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-DotG"><span class="MODULE">module</span> <span class="UIDENT">DotG</span> <span class="EQUAL">=</span> <a href="imperative.ml.html#module-Digraph.module-AbstractLabeled"><span class="UIDENT">Imperative</span><span class="DOT">.</span><span class="UIDENT">Digraph</span><span class="DOT">.</span><span class="UIDENT">AbstractLabeled</span></a><span class="LPAREN">(</span><span class="UIDENT">Vertex</span><span class="RPAREN">)</span><span class="LPAREN">(</span><span class="UIDENT">Edge</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span id="module-DotB"><span class="MODULE">module</span> <span class="UIDENT">DotB</span> <span class="EQUAL">=</span> <a href="builder.ml.html#module-I"><span class="UIDENT">Builder</span><span class="DOT">.</span><span class="UIDENT">I</span></a><span class="LPAREN">(</span><span class="UIDENT">DotG</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-cluster"><span class="TYPE">type</span> <span class="LIDENT">cluster</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span id="type-dotg_model"><span class="TYPE">type</span> <span class="LIDENT">dotg_model</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">vertex</span><span class="COMMA">,</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">edge</span><span class="COMMA">,</span> <span class="LIDENT">cluster</span><span class="RPAREN">)</span> <span class="LIDENT">abstract_model</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-DotParser"><span class="MODULE">module</span> <span class="UIDENT">DotParser</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="dot.ml.html#module-Parse"><span class="UIDENT">Dot</span><span class="DOT">.</span><span class="UIDENT">Parse</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">DotB</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>      <span class="COMMENT">(* Read the attributes of a node *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_node_33"><span class="LIDENT">node</span></span> <span class="EQUAL">=</span> <a href="xDot.ml.html#val-read_node_layout"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">read_node_layout</span></a><span class="EOL">
</span><span class="EOL">
</span>      <span class="COMMENT">(* Read edge attributes *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_edge_34"><span class="LIDENT">edge</span></span> <span class="EQUAL">=</span> <a href="xDot.ml.html#val-read_edge_layout"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">read_edge_layout</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-DotModel"><span class="MODULE">module</span> <span class="UIDENT">DotModel</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-DotModel.type-cluster"><span class="TYPE">type</span> <span class="LIDENT">cluster</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span class="CLASS">class</span> <span id="module-DotModel.class-model"><span class="LIDENT">model</span></span> <span id="local_g_35"><span class="LIDENT">g</span></span> <span id="local_clusters_hash_36"><span class="LIDENT">clusters_hash</span></span> <span id="local_bounding_box_37"><span class="LIDENT">bounding_box</span></span><span class="EOL">
</span>    <span class="COLON">:</span> <span class="LBRACKET">[</span><span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">vertex</span><span class="COMMA">,</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">edge</span><span class="COMMA">,</span> <span class="LIDENT">cluster</span><span class="RBRACKET">]</span> <span class="LIDENT">abstract_model</span><span class="EOL">
</span>    <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="OBJECT">object</span><span class="EOL">
</span>      <span class="COMMENT">(* Iterators *)</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_edges</span> <span id="local_f_38"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_edges</span> <a href="#local_f_38"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_edges_e</span> <span id="local_f_39"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_edges_e</span> <a href="#local_f_39"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_pred</span> <span id="local_f_40"><span class="LIDENT">f</span></span> <span id="local_v_41"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_pred</span> <a href="#local_f_40"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span> <a href="#local_v_41"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_pred_e</span> <span id="local_f_42"><span class="LIDENT">f</span></span> <span id="local_v_43"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_pred_e</span> <a href="#local_f_42"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span> <a href="#local_v_43"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_succ</span> <span id="local_f_44"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_succ</span> <a href="#local_f_44"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_succ_e</span> <span id="local_f_45"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_succ_e</span> <a href="#local_f_45"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_vertex</span> <span id="local_f_46"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">iter_vertex</span> <a href="#local_f_46"><span class="LIDENT">f</span></a> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_associated_vertex</span> <span id="local_f_47"><span class="LIDENT">f</span></span> <span id="local_v_48"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <a href="#local_f_47"><span class="LIDENT">f</span></a> <a href="#local_v_48"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">iter_clusters</span> <span id="local_f_49"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-iter"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_k_50"><span class="LIDENT">k</span></span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_49"><span class="LIDENT">f</span></a> <a href="#local_k_50"><span class="LIDENT">k</span></a><span class="RPAREN">)</span> <span class="LIDENT">clusters_hash</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="COMMENT">(* Membership functions *)</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">find_edge</span> <span class="EQUAL">=</span> <span class="TRY">try</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">find_edge</span> <span class="LIDENT">g</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">mem_edge</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">mem_edge</span> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">mem_edge_e</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">mem_edge_e</span> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">mem_vertex</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="LIDENT">mem_vertex</span> <span class="LIDENT">g</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">src</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">dst</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span><span class="EOL">
</span><span class="EOL">
</span>      <span class="COMMENT">(* Layout *)</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">bounding_box</span> <span class="EQUAL">=</span> <span class="LIDENT">bounding_box</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">get_vertex_layout</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">label</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">get_edge_layout</span> <span class="EQUAL">=</span> <span class="UIDENT">DotG</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span><span class="EOL">
</span>      <span class="METHOD">method</span> <span class="LIDENT">get_cluster_layout</span> <span id="local_c_51"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_attrs_52"><span class="LIDENT">attrs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-find"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">find</span></a> <span class="LIDENT">clusters_hash</span> <a href="#local_c_51"><span class="LIDENT">c</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <a href="xDot.ml.html#val-read_cluster_layout"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">read_cluster_layout</span></a> <a href="#local_attrs_52"><span class="LIDENT">attrs</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-DotModel.val-model"><span class="LIDENT">model</span></span> <span class="EQUAL">=</span> <span class="NEW">new</span> <span class="LIDENT">model</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Runs graphviz, parses the graph and instantiates the model *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-read_dot"><span class="LIDENT">read_dot</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_cmd_53"><span class="LIDENT">cmd</span></span><span class="EQUAL">=</span><span class="STRING">&quot;dot&quot;</span><span class="RPAREN">)</span> <span id="local_dot_file_54"><span class="LIDENT">dot_file</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_basename_55"><span class="LIDENT">basename</span></span> <span class="EQUAL">=</span> <span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/filename.ml.html#val-chop_extension"><span class="UIDENT">Filename</span><span class="DOT">.</span><span class="LIDENT">chop_extension</span></a> <a href="#local_dot_file_54"><span class="LIDENT">dot_file</span></a><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Invalid_argument</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_dot_file_54"><span class="LIDENT">dot_file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_xdot_file_56"><span class="LIDENT">xdot_file</span></span> <span class="EQUAL">=</span> <a href="#local_basename_55"><span class="LIDENT">basename</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;.xdot&quot;</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_dot_cmd_57"><span class="LIDENT">dot_cmd</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s -Txdot %s &gt; %s&quot;</span> <a href="#local_cmd_53"><span class="LIDENT">cmd</span></a> <a href="#local_dot_file_54"><span class="LIDENT">dot_file</span></a> <a href="#local_xdot_file_56"><span class="LIDENT">xdot_file</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Run graphviz *)</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-command"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">command</span></a> <a href="#local_dot_cmd_57"><span class="LIDENT">dot_cmd</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_67"><span id="local_graph_58"><span class="LIDENT">graph</span></span><span class="COMMA">,</span> <span id="local_bb_59"><span class="LIDENT">bb</span></span><span class="COMMA">,</span> <span id="local_clusters_hash_60"><span class="LIDENT">clusters_hash</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="UIDENT">DotParser</span><span class="DOT">.</span><span class="LIDENT">parse_bounding_box_and_clusters</span> <a href="#local_xdot_file_56"><span class="LIDENT">xdot_file</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">DotModel</span><span class="DOT">.</span><span class="LIDENT">model</span> <a href="#local_graph_58"><span class="LIDENT">graph</span></a> <a href="#local_clusters_hash_60"><span class="LIDENT">clusters_hash</span></a> <span class="LPAREN">(</span><a href="xDot.ml.html#val-read_bounding_box"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">read_bounding_box</span></a> <a href="#local_bb_59"><span class="LIDENT">bb</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">DotError</span> <span class="STRING">&quot;Error during dot execution&quot;</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Does not run graphviz.
   Parses a graph from an xdot file and instantiates the model. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-read_xdot"><span class="LIDENT">read_xdot</span></span> <span id="local_xdot_file_61"><span class="LIDENT">xdot_file</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_65"><span id="local_graph_62"><span class="LIDENT">graph</span></span><span class="COMMA">,</span> <span id="local_bb_63"><span class="LIDENT">bb</span></span><span class="COMMA">,</span> <span id="local_clusters_hash_64"><span class="LIDENT">clusters_hash</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">DotParser</span><span class="DOT">.</span><span class="LIDENT">parse_bounding_box_and_clusters</span> <a href="#local_xdot_file_61"><span class="LIDENT">xdot_file</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">DotModel</span><span class="DOT">.</span><span class="LIDENT">model</span> <a href="#local_graph_62"><span class="LIDENT">graph</span></a> <a href="#local_clusters_hash_64"><span class="LIDENT">clusters_hash</span></a> <span class="LPAREN">(</span><a href="xDot.ml.html#val-read_bounding_box"><span class="UIDENT">XDot</span><span class="DOT">.</span><span class="LIDENT">read_bounding_box</span></a> <a href="#local_bb_63"><span class="LIDENT">bb</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span></span></code></pre></body></html>
