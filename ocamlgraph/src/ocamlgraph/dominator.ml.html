<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: dominator.ml (ocamlgraph.src.ocamlgraph)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocamlgraph</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; ocamlgraph &#x00BB; dominator.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>dominator.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocamlgraph</a><ul><li>Library <code>ocamlgraph</code><ul><li><a href="../../ocamlgraph/Graph/index.html">Graph</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>ocamlgraph<ul><li><a href="blocks.ml.html">blocks.ml</a></li><li><a href="builder.ml.html">builder.ml</a></li><li><a href="chaoticIteration.ml.html">chaoticIteration.ml</a></li><li><a href="classic.ml.html">classic.ml</a></li><li><a href="clique.ml.html">clique.ml</a></li><li><a href="cliquetree.ml.html">cliquetree.ml</a></li><li><a href="coloring.ml.html">coloring.ml</a></li><li><a href="components.ml.html">components.ml</a></li><li><a href="contraction.ml.html">contraction.ml</a></li><li><a href="cycles.ml.html">cycles.ml</a></li><li><a href="dGraphModel.ml.html">dGraphModel.ml</a></li><li><a href="dGraphRandModel.ml.html">dGraphRandModel.ml</a></li><li><a href="dGraphSubTree.ml.html">dGraphSubTree.ml</a></li><li><a href="dGraphTreeLayout.ml.html">dGraphTreeLayout.ml</a></li><li><a href="dGraphTreeModel.ml.html">dGraphTreeModel.ml</a></li><li><a href="delaunay.ml.html">delaunay.ml</a></li><li><a href="#" class="current_unit">dominator.ml</a></li><li><a href="dot.ml.html">dot.ml</a></li><li><a href="dot_lexer.ml.html">dot_lexer.ml</a></li><li><a href="dot_parser.ml.html">dot_parser.ml</a></li><li><a href="eulerian.ml.html">eulerian.ml</a></li><li><a href="fixpoint.ml.html">fixpoint.ml</a></li><li><a href="flow.ml.html">flow.ml</a></li><li><a href="gmap.ml.html">gmap.ml</a></li><li><a href="gml.ml.html">gml.ml</a></li><li><a href="graph.ml.html">graph.ml</a></li><li><a href="graph__.ml.html">graph__.ml</a></li><li><a href="graphml.ml.html">graphml.ml</a></li><li><a href="graphviz.ml.html">graphviz.ml</a></li><li><a href="imperative.ml.html">imperative.ml</a></li><li><a href="kruskal.ml.html">kruskal.ml</a></li><li><a href="leaderlist.ml.html">leaderlist.ml</a></li><li><a href="mcs_m.ml.html">mcs_m.ml</a></li><li><a href="md.ml.html">md.ml</a></li><li><a href="merge.ml.html">merge.ml</a></li><li><a href="mincut.ml.html">mincut.ml</a></li><li><a href="minsep.ml.html">minsep.ml</a></li><li><a href="nonnegative.ml.html">nonnegative.ml</a></li><li><a href="oper.ml.html">oper.ml</a></li><li><a href="pack.ml.html">pack.ml</a></li><li><a href="path.ml.html">path.ml</a></li><li><a href="persistent.ml.html">persistent.ml</a></li><li><a href="prim.ml.html">prim.ml</a></li><li><a href="rand.ml.html">rand.ml</a></li><li><a href="strat.ml.html">strat.ml</a></li><li><a href="topological.ml.html">topological.ml</a></li><li><a href="traverse.ml.html">traverse.ml</a></li><li><a href="util.ml.html">util.ml</a></li><li><a href="weakTopological.ml.html">weakTopological.ml</a></li><li><a href="xDot.ml.html">xDot.ml</a></li><li><a href="xDotDraw.ml.html">xDotDraw.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  Ocamlgraph: a generic graph library for OCaml                         *)</span><span class="EOL">
</span><span class="COMMENT">(*  Copyright (C) 2004-2010                                               *)</span><span class="EOL">
</span><span class="COMMENT">(*  Sylvain Conchon, Jean-Christophe Filliatre and Julien Signoles        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This software is free software; you can redistribute it and/or        *)</span><span class="EOL">
</span><span class="COMMENT">(*  modify it under the terms of the GNU Library General Public           *)</span><span class="EOL">
</span><span class="COMMENT">(*  License version 2.1, with the special exception on linking            *)</span><span class="EOL">
</span><span class="COMMENT">(*  described in file LICENSE.                                            *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This software is distributed in the hope that it will be useful,      *)</span><span class="EOL">
</span><span class="COMMENT">(*  but WITHOUT ANY WARRANTY; without even the implied warranty of        *)</span><span class="EOL">
</span><span class="COMMENT">(*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*
  Copyright Â© 2009 Carnegie-Mellon University, David Brumley, and Ivan Jager.
  From the BAP library; see http://bap.ece.cmu.edu
  Modified by OCamlGraph's authors.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* stuff to read:
   http://www.hipersoft.rice.edu/grads/publications/dom14.pdf
   Modern Compiler Implementation in ML, by Appel
   Introduction to Algorithms, Cormen et al
*)</span><span class="EOL">
</span><span class="EOL">
</span><span id="exception-Unreachable"><span class="EXCEPTION">exception</span> <span class="UIDENT">Unreachable</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-G"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">G</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-G.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-G.module-V"><span class="MODULE">module</span> <span class="UIDENT">V</span> <span class="COLON">:</span> <span class="UIDENT">Sig</span><span class="DOT">.</span><span class="UIDENT">COMPARABLE</span></span><span class="EOL">
</span>  <span id="module-type-G.val-pred"><span class="VAL">val</span> <span class="LIDENT">pred</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-G.val-succ"><span class="VAL">val</span> <span class="LIDENT">succ</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-G.val-fold_vertex"><span class="VAL">val</span> <span class="LIDENT">fold_vertex</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span></span><span class="EOL">
</span>  <span id="module-type-G.val-iter_vertex"><span class="VAL">val</span> <span class="LIDENT">iter_vertex</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span id="module-type-G.val-iter_succ"><span class="VAL">val</span> <span class="LIDENT">iter_succ</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span id="module-type-G.val-nb_vertex"><span class="VAL">val</span> <span class="LIDENT">nb_vertex</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-I"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">I</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">G</span><span class="EOL">
</span>  <span id="module-type-I.val-empty"><span class="VAL">val</span> <span class="LIDENT">empty</span><span class="COLON">:</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-I.val-add_edge"><span class="VAL">val</span> <span class="LIDENT">add_edge</span><span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-S"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">S</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-S.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-S.type-vertex"><span class="TYPE">type</span> <span class="LIDENT">vertex</span></span><span class="EOL">
</span>  <span id="module-type-S.module-S"><span class="MODULE">module</span> <span class="UIDENT">S</span> <span class="COLON">:</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-type-S"><span class="UIDENT">Set</span><span class="DOT">.</span><span class="UIDENT">S</span></a> <span class="WITH">with</span> <span id="def_155"><span class="TYPE">type</span> <span class="LIDENT">elt</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span></span></span><span class="EOL">
</span>  <span id="module-type-S.type-idom"><span class="TYPE">type</span> <span class="LIDENT">idom</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span></span><span class="EOL">
</span>  <span id="module-type-S.type-idoms"><span class="TYPE">type</span> <span class="LIDENT">idoms</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.type-dom_tree"><span class="TYPE">type</span> <span class="LIDENT">dom_tree</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.type-dominators"><span class="TYPE">type</span> <span class="LIDENT">dominators</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.type-dom"><span class="TYPE">type</span> <span class="LIDENT">dom</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.type-sdom"><span class="TYPE">type</span> <span class="LIDENT">sdom</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.type-dom_frontier"><span class="TYPE">type</span> <span class="LIDENT">dom_frontier</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.val-compute_idom"><span class="VAL">val</span> <span class="LIDENT">compute_idom</span><span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dominators_to_dom"><span class="VAL">val</span> <span class="LIDENT">dominators_to_dom</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dominators_to_sdom"><span class="VAL">val</span> <span class="LIDENT">dominators_to_sdom</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dom_to_sdom"><span class="VAL">val</span> <span class="LIDENT">dom_to_sdom</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dominators_to_sdominators"><span class="VAL">val</span> <span class="LIDENT">dominators_to_sdominators</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dominators_to_idoms"><span class="VAL">val</span> <span class="LIDENT">dominators_to_idoms</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dominators_to_dom_tree"><span class="VAL">val</span> <span class="LIDENT">dominators_to_dom_tree</span><span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="OPTLABEL">?pred:</span><span class="LPAREN">(</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-S.val-idom_to_dom_tree"><span class="VAL">val</span> <span class="LIDENT">idom_to_dom_tree</span><span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.val-idom_to_idoms"><span class="VAL">val</span> <span class="LIDENT">idom_to_idoms</span><span class="COLON">:</span> <span class="LIDENT">idom</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.val-compute_dom_frontier"><span class="VAL">val</span> <span class="LIDENT">compute_dom_frontier</span><span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dom_tree</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">idom</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.val-idom_to_dominators"><span class="VAL">val</span> <span class="LIDENT">idom_to_dominators</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.val-idom_to_dom"><span class="VAL">val</span> <span class="LIDENT">idom_to_dom</span><span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dom_tree_to_nontrivial_dom"><span class="VAL">val</span> <span class="LIDENT">dom_tree_to_nontrivial_dom</span> <span class="COLON">:</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dom_tree</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>  <span id="module-type-S.val-dom_tree_to_snontrivial_dom"><span class="VAL">val</span> <span class="LIDENT">dom_tree_to_snontrivial_dom</span> <span class="COLON">:</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dom_tree</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Make"><span class="MODULE">module</span> <span class="UIDENT">Make</span><span class="LPAREN">(</span><span class="UIDENT">G</span> <span class="COLON">:</span> <span class="UIDENT">G</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-Make.type-vertex"><span class="TYPE">type</span> <span class="LIDENT">vertex</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make.module-H"><span class="MODULE">module</span> <span class="UIDENT">H</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#module-Make"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="RPAREN">)</span></span><span class="EOL">
</span>  <span id="module-Make.module-S"><span class="MODULE">module</span> <span class="UIDENT">S</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make"><span class="UIDENT">Set</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** function from [n] to [n]'s immediate dominator *)</span><span class="EOL">
</span>  <span id="module-Make.type-idom"><span class="TYPE">type</span> <span class="LIDENT">idom</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** [idoms x y] is true when [x] is [y]'s immediate dominator *)</span><span class="EOL">
</span>  <span id="module-Make.type-idoms"><span class="TYPE">type</span> <span class="LIDENT">idoms</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** function from [x] to a list of nodes immediately dominated by [x] *)</span><span class="EOL">
</span>  <span id="module-Make.type-dom_tree"><span class="TYPE">type</span> <span class="LIDENT">dom_tree</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** function from node to a list of nodes that dominate it. *)</span><span class="EOL">
</span>  <span id="module-Make.type-dominators"><span class="TYPE">type</span> <span class="LIDENT">dominators</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** [dom x y] returns true iff [x] dominates [y] *)</span><span class="EOL">
</span>  <span id="module-Make.type-dom"><span class="TYPE">type</span> <span class="LIDENT">dom</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** [sdom x y] returns true iff [x] strictly dominates [y]. *)</span><span class="EOL">
</span>  <span id="module-Make.type-sdom"><span class="TYPE">type</span> <span class="LIDENT">sdom</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** function from [x] to a list of nodes not dominated by [x], but with
      predecessors which are dominated by [x] *)</span><span class="EOL">
</span>  <span id="module-Make.type-dom_frontier"><span class="TYPE">type</span> <span class="LIDENT">dom_frontier</span> <span class="EQUAL">=</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="LIDENT">list</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-set_of_list"><span class="LIDENT">set_of_list</span></span> <span id="local_x_1"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_set_2"><span class="LIDENT">set</span></span> <span id="local_v_3"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_v_3"><span class="LIDENT">v</span></a> <a href="#local_set_2"><span class="LIDENT">set</span></a><span class="RPAREN">)</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">empty</span> <a href="#local_x_1"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Computes the dominator tree, using the Lengauer-Tarjan algorithm.
      [compute_idom cfg s0] returns a function [idom : V.t -&gt; V.t] s.t.
      [idom x] returns the immediate dominator of [x]
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-compute_idom"><span class="LIDENT">compute_idom</span></span> <span id="local_cfg_4"><span class="LIDENT">cfg</span></span> <span id="local_s0_5"><span class="LIDENT">s0</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* based on the Tiger book, section 19.2.
       This uses path compression, but doesn't yet do balanced path
       compression, so the runtime is O(N log(N)) rather than
       O(N inverseackerman(N))
    *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_size_6"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">nb_vertex</span> <a href="#local_cfg_4"><span class="LIDENT">cfg</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bucket_7"><span class="LIDENT">bucket</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node n -&gt; *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_dfnum_h_8"><span class="LIDENT">dfnum_h</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node -&gt; DFS number *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_parent_9"><span class="LIDENT">parent</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node -&gt; parent in DFS tree*)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_semi_h_10"><span class="LIDENT">semi_h</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node -&gt; semidominator *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_ancestor_11"><span class="LIDENT">ancestor</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node -&gt; *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_best_12"><span class="LIDENT">best</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node -&gt; *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_samedom_13"><span class="LIDENT">samedom</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node -&gt; node with same idom *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_idom_14"><span class="LIDENT">idom</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_size_6"><span class="LIDENT">size</span></a> <span class="COMMENT">(* node n -&gt; idom n *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_vertex_15"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_size_6"><span class="LIDENT">size</span></a> <a href="#local_s0_5"><span class="LIDENT">s0</span></a> <span class="COMMENT">(* DFS number -&gt; node *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_nn_16"><span class="LIDENT">nn</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dfnum_17"><span class="LIDENT">dfnum</span></span> <span id="local_x_18"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="TRY">try</span>  <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_dfnum_h_8"><span class="LIDENT">dfnum_h</span></a> <a href="#local_x_18"><span class="LIDENT">x</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Unreachable</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_semi_19"><span class="LIDENT">semi</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_semi_h_10"><span class="LIDENT">semi_h</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dfs_20"><span class="LIDENT">dfs</span></span> <span id="local_n0_21"><span class="LIDENT">n0</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_stack_22"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stack.ml.html#val-create"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_loop_23"><span class="LIDENT">loop</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stack.ml.html#val-is_empty"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">is_empty</span></a> <a href="#local_stack_22"><span class="LIDENT">stack</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_153"><span id="local_n_24"><span class="LIDENT">n</span></span><span class="COMMA">,</span><span id="local_p_25"><span class="LIDENT">p</span></span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stack.ml.html#val-pop"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop</span></a> <a href="#local_stack_22"><span class="LIDENT">stack</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_dfnum_h_8"><span class="LIDENT">dfnum_h</span></a> <a href="#local_n_24"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_enn_26"><span class="LIDENT">enn</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nn_16"><span class="LIDENT">nn</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_dfnum_h_8"><span class="LIDENT">dfnum_h</span></a> <a href="#local_n_24"><span class="LIDENT">n</span></a> <a href="#local_enn_26"><span class="LIDENT">enn</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_vertex_15"><span class="LIDENT">vertex</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_enn_26"><span class="LIDENT">enn</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_24"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_p_25"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_p_27"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_parent_9"><span class="LIDENT">parent</span></a> <a href="#local_n_24"><span class="LIDENT">n</span></a> <a href="#local_p_27"><span class="LIDENT">p</span></a><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_nn_16"><span class="LIDENT">nn</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_enn_26"><span class="LIDENT">enn</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>            <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_succ</span><span class="EOL">
</span>              <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_m_28"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                 <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_dfnum_h_8"><span class="LIDENT">dfnum_h</span></a> <a href="#local_m_28"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <span class="LPAREN">(</span><a href="#local_m_28"><span class="LIDENT">m</span></a><span class="COMMA">,</span> <span class="UIDENT">Some</span> <a href="#local_n_24"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <a href="#local_stack_22"><span class="LIDENT">stack</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <a href="#local_cfg_4"><span class="LIDENT">cfg</span></a> <a href="#local_n_24"><span class="LIDENT">n</span></a><span class="EOL">
</span>          <span class="END">end</span><span class="EOL">
</span>        <span class="DONE">done</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <span class="LPAREN">(</span><a href="#local_n0_21"><span class="LIDENT">n0</span></a><span class="COMMA">,</span><span class="UIDENT">None</span><span class="RPAREN">)</span> <a href="#local_stack_22"><span class="LIDENT">stack</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_loop_23"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_ancestor_with_lowest_semi_29"><span class="LIDENT">ancestor_with_lowest_semi</span></span> <span id="local_v_30"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_a_31"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_ancestor_11"><span class="LIDENT">ancestor</span></a> <a href="#local_v_30"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_b_32"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_ancestor_with_lowest_semi_29"><span class="LIDENT">ancestor_with_lowest_semi</span></a> <a href="#local_a_31"><span class="LIDENT">a</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_ancestor_11"><span class="LIDENT">ancestor</span></a> <a href="#local_v_30"><span class="LIDENT">v</span></a> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_ancestor_11"><span class="LIDENT">ancestor</span></a> <a href="#local_a_31"><span class="LIDENT">a</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_best_v_33"><span class="LIDENT">best_v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_best_12"><span class="LIDENT">best</span></a> <a href="#local_v_30"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_dfnum_17"><span class="LIDENT">dfnum</span></a><span class="LPAREN">(</span><a href="#local_semi_19"><span class="LIDENT">semi</span></a> <a href="#local_b_32"><span class="LIDENT">b</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_dfnum_17"><span class="LIDENT">dfnum</span></a><span class="LPAREN">(</span><a href="#local_semi_19"><span class="LIDENT">semi</span></a> <a href="#local_best_v_33"><span class="LIDENT">best_v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_best_12"><span class="LIDENT">best</span></a> <a href="#local_v_30"><span class="LIDENT">v</span></a> <a href="#local_b_32"><span class="LIDENT">b</span></a><span class="SEMI">;</span> <a href="#local_b_32"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_best_v_33"><span class="LIDENT">best_v</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_best_12"><span class="LIDENT">best</span></a> <a href="#local_v_30"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_link_34"><span class="LIDENT">link</span></span> <span id="local_p_35"><span class="LIDENT">p</span></span> <span id="local_n_36"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_ancestor_11"><span class="LIDENT">ancestor</span></a> <a href="#local_n_36"><span class="LIDENT">n</span></a> <a href="#local_p_35"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_best_12"><span class="LIDENT">best</span></a> <a href="#local_n_36"><span class="LIDENT">n</span></a> <a href="#local_n_36"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_semidominator_37"><span class="LIDENT">semidominator</span></span> <span id="local_n_38"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_39"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_parent_9"><span class="LIDENT">parent</span></a> <a href="#local_n_38"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_s_40"><span class="LIDENT">s</span></span> <span id="local_v_41"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="TRY">try</span> <span class="COMMENT">(* FIXME: do we want to allow unreachable nodes? *)</span><span class="EOL">
</span>             <span class="LET">let</span> <span id="local_s'_42"><span class="LIDENT">s'</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>               <span class="IF">if</span> <a href="#local_dfnum_17"><span class="LIDENT">dfnum</span></a> <a href="#local_v_41"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_dfnum_17"><span class="LIDENT">dfnum</span></a> <a href="#local_n_38"><span class="LIDENT">n</span></a><span class="EOL">
</span>               <span class="THEN">then</span> <a href="#local_v_41"><span class="LIDENT">v</span></a><span class="EOL">
</span>               <span class="ELSE">else</span> <a href="#local_semi_19"><span class="LIDENT">semi</span></a><span class="LPAREN">(</span><a href="#local_ancestor_with_lowest_semi_29"><span class="LIDENT">ancestor_with_lowest_semi</span></a> <a href="#local_v_41"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="IN">in</span><span class="EOL">
</span>             <span class="IF">if</span> <a href="#local_dfnum_17"><span class="LIDENT">dfnum</span></a> <a href="#local_s'_42"><span class="LIDENT">s'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_dfnum_17"><span class="LIDENT">dfnum</span></a> <a href="#local_s_40"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <a href="#local_s'_42"><span class="LIDENT">s'</span></a> <span class="ELSE">else</span> <a href="#local_s_40"><span class="LIDENT">s</span></a><span class="EOL">
</span>           <span class="WITH">with</span> <span class="UIDENT">Unreachable</span> <span class="MINUSGREATER">-&gt;</span> <span class="COMMENT">(* maybe switch to Not_found later *)</span><span class="EOL">
</span>             <a href="#local_s_40"><span class="LIDENT">s</span></a> <span class="COMMENT">(* v is unreachable from s0 *)</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_s_39"><span class="LIDENT">s</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">pred</span> <a href="#local_cfg_4"><span class="LIDENT">cfg</span></a> <a href="#local_n_38"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_dfs_20"><span class="LIDENT">dfs</span></a> <a href="#local_s0_5"><span class="LIDENT">s0</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_lastn_43"><span class="LIDENT">lastn</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nn_16"><span class="LIDENT">nn</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_nn_16"><span class="LIDENT">nn</span></a><span class="SEMI">;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nn_16"><span class="LIDENT">nn</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="DO">do</span> <span class="COMMENT">(* skip over the root node *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_44"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nn_16"><span class="LIDENT">nn</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_n_45"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_vertex_15"><span class="LIDENT">vertex</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_44"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p_46"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_parent_9"><span class="LIDENT">parent</span></a> <a href="#local_n_45"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_47"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_semidominator_37"><span class="LIDENT">semidominator</span></a> <a href="#local_n_45"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_semi_h_10"><span class="LIDENT">semi_h</span></a> <a href="#local_n_45"><span class="LIDENT">n</span></a> <a href="#local_s_47"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_bucket_7"><span class="LIDENT">bucket</span></a> <a href="#local_s_47"><span class="LIDENT">s</span></a>  <a href="#local_n_45"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_link_34"><span class="LIDENT">link</span></a> <a href="#local_p_46"><span class="LIDENT">p</span></a> <a href="#local_n_45"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="COMMENT">(* now that the path from p to v is in the forest,
         calculate the dominator of v based on the first clause of the
         Dominator Theorem, otherwise defer until y's dominator is known *)</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_v_48"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="LET">let</span> <span id="local_y_49"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <a href="#local_ancestor_with_lowest_semi_29"><span class="LIDENT">ancestor_with_lowest_semi</span></a> <a href="#local_v_48"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>           <span class="IF">if</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <span class="LPAREN">(</span><a href="#local_semi_19"><span class="LIDENT">semi</span></a> <a href="#local_y_49"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_semi_19"><span class="LIDENT">semi</span></a> <a href="#local_v_48"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>           <span class="THEN">then</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_idom_14"><span class="LIDENT">idom</span></a> <a href="#local_v_48"><span class="LIDENT">v</span></a> <a href="#local_p_46"><span class="LIDENT">p</span></a><span class="EOL">
</span>           <span class="ELSE">else</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_samedom_13"><span class="LIDENT">samedom</span></a> <a href="#local_v_48"><span class="LIDENT">v</span></a> <a href="#local_y_49"><span class="LIDENT">y</span></a><span class="SEMI">;</span><span class="EOL">
</span>           <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_bucket_7"><span class="LIDENT">bucket</span></a> <a href="#local_p_46"><span class="LIDENT">p</span></a> <span class="COMMENT">(*could use H.remove_all if we used extlib*)</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find_all</span> <a href="#local_bucket_7"><span class="LIDENT">bucket</span></a> <a href="#local_p_46"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="COMMENT">(* now all the defered calculations can be done *)</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <a href="#local_lastn_43"><span class="LIDENT">lastn</span></a> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_n_50"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_vertex_15"><span class="LIDENT">vertex</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_idom_14"><span class="LIDENT">idom</span></a> <a href="#local_n_50"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_idom_14"><span class="LIDENT">idom</span></a> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_samedom_13"><span class="LIDENT">samedom</span></a> <a href="#local_n_50"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_idom_14"><span class="LIDENT">idom</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given a function from a node to it's dominators, returns a function
      [dom : V.t -&gt; V.t -&gt; bool] s.t. [dom x y] returns true when
      [x] dominates [y]
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dominators_to_dom"><span class="LIDENT">dominators_to_dom</span></span> <span id="local_dominators_51"><span class="LIDENT">dominators</span></span> <span id="local_x_52"><span class="LIDENT">x</span></span> <span id="local_y_53"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_x_52"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><a href="#local_dominators_51"><span class="LIDENT">dominators</span></a> <a href="#local_y_53"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given a function from a node to it's dominators, returns a function
      [sdom : V.t -&gt; V.t -&gt; bool] s.t. [sdom x y] returns true when
      [x] strictly dominates [y] *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dominators_to_sdom"><span class="LIDENT">dominators_to_sdom</span></span> <span id="local_dominators_54"><span class="LIDENT">dominators</span></span> <span id="local_x_55"><span class="LIDENT">x</span></span> <span id="local_y_56"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_x_55"><span class="LIDENT">x</span></a> <a href="#local_y_56"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">dominators_to_dom</span> <a href="#local_dominators_54"><span class="LIDENT">dominators</span></a> <a href="#local_x_55"><span class="LIDENT">x</span></a> <a href="#local_y_56"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dom_to_sdom"><span class="LIDENT">dom_to_sdom</span></span> <span id="local_dom_57"><span class="LIDENT">dom</span></span> <span id="local_x_58"><span class="LIDENT">x</span></span> <span id="local_y_59"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_x_58"><span class="LIDENT">x</span></a> <a href="#local_y_59"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_dom_57"><span class="LIDENT">dom</span></a> <a href="#local_x_58"><span class="LIDENT">x</span></a> <a href="#local_y_59"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given a a function from a node to it's dominators, returns a function
      from a node to it's strict dominators. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dominators_to_sdominators"><span class="LIDENT">dominators_to_sdominators</span></span> <span id="local_dominators_60"><span class="LIDENT">dominators</span></span> <span id="local_x_61"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_x_61"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><a href="#local_dominators_60"><span class="LIDENT">dominators</span></a> <a href="#local_x_61"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Given a function from a node to it's dominators, returns a function
      [idoms : G.V.t -&gt; G.V.t -&gt; bool] s.t. [idoms x y] returns true when
      [x] is the immediate dominator of [y].
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dominators_to_idoms"><span class="LIDENT">dominators_to_idoms</span></span> <span id="local_dominators_62"><span class="LIDENT">dominators</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sdom_63"><span class="LIDENT">sdom</span></span> <span class="EQUAL">=</span> <span class="LIDENT">dominators_to_sdom</span> <a href="#local_dominators_62"><span class="LIDENT">dominators</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_64"><span class="LIDENT">x</span></span> <span id="local_y_65"><span class="LIDENT">y</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="#local_sdom_63"><span class="LIDENT">sdom</span></a> <a href="#local_x_64"><span class="LIDENT">x</span></a> <a href="#local_y_65"><span class="LIDENT">y</span></a><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LET">let</span> <span id="local_sdoms_66"><span class="LIDENT">sdoms</span></span> <span class="EQUAL">=</span> <span class="LIDENT">dominators_to_sdominators</span> <a href="#local_dominators_62"><span class="LIDENT">dominators</span></a> <a href="#local_y_65"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>       <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">for_all</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_w_67"><span class="LIDENT">w</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_x_64"><span class="LIDENT">x</span></a> <a href="#local_w_67"><span class="LIDENT">w</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a><span class="LPAREN">(</span><a href="#local_sdom_63"><span class="LIDENT">sdom</span></a> <a href="#local_x_64"><span class="LIDENT">x</span></a> <a href="#local_w_67"><span class="LIDENT">w</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_sdoms_66"><span class="LIDENT">sdoms</span></a><span class="EOL">
</span>    <span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Computes a dominator tree (function from x to a list of nodes immediately
      dominated by x) for the given CFG and dominator function.
      Note: The dominator tree is also called [IDom] by Muchnick.
      Note: If you are computing a post-dominator tree, then the
      optional argument pred should be G.succ.
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dominators_to_dom_tree"><span class="LIDENT">dominators_to_dom_tree</span></span> <span id="local_cfg_68"><span class="LIDENT">cfg</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_pred_69"><span class="LIDENT">pred</span></span><span class="EQUAL">=</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">pred</span><span class="RPAREN">)</span> <span id="local_dominators_70"><span class="LIDENT">dominators</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_idoms_71"><span class="LIDENT">idoms</span></span> <span class="EQUAL">=</span> <span class="LIDENT">dominators_to_idoms</span> <a href="#local_dominators_70"><span class="LIDENT">dominators</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tree_72"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">97</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_vertex</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_y_73"><span class="LIDENT">y</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="MATCH">match</span> <a href="#local_pred_69"><span class="LIDENT">pred</span></a> <a href="#local_cfg_68"><span class="LIDENT">cfg</span></a> <a href="#local_y_73"><span class="LIDENT">y</span></a> <span class="WITH">with</span><span class="EOL">
</span>             <span class="LBRACKET">[</span><span id="local_x_74"><span class="LIDENT">x</span></span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>               <span class="COMMENT">(* a node that is not reachable from start has no
                  idom *)</span><span class="EOL">
</span>               <span class="IF">if</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">is_empty</span> <span class="LPAREN">(</span><a href="#local_dominators_70"><span class="LIDENT">dominators</span></a> <a href="#local_x_74"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>                 <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_tree_72"><span class="LIDENT">tree</span></a> <a href="#local_x_74"><span class="LIDENT">x</span></a> <a href="#local_y_73"><span class="LIDENT">y</span></a><span class="EOL">
</span>             <span class="RPAREN">)</span><span class="EOL">
</span>           <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>               <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">iter</span><span class="EOL">
</span>                 <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_75"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_idoms_71"><span class="LIDENT">idoms</span></a> <a href="#local_x_75"><span class="LIDENT">x</span></a> <a href="#local_y_73"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_tree_72"><span class="LIDENT">tree</span></a> <a href="#local_x_75"><span class="LIDENT">x</span></a> <a href="#local_y_73"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                 <span class="LPAREN">(</span><a href="#local_dominators_70"><span class="LIDENT">dominators</span></a> <a href="#local_y_73"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="RPAREN">)</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_cfg_68"><span class="LIDENT">cfg</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* FIXME: maybe faster to convert eagerly *)</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_76"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">set_of_list</span><span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find_all</span> <a href="#local_tree_72"><span class="LIDENT">tree</span></a> <a href="#local_x_76"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Computes a dominator tree (function from x to a list of nodes immediately
      dominated by x) for the given CFG and idom function. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-idom_to_dom_tree"><span class="LIDENT">idom_to_dom_tree</span></span> <span id="local_cfg_77"><span class="LIDENT">cfg</span></span> <span id="local_idom_78"><span class="LIDENT">idom</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tree_79"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">nb_vertex</span> <a href="#local_cfg_77"><span class="LIDENT">cfg</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_vertex</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_v_80"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="TRY">try</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_tree_79"><span class="LIDENT">tree</span></a> <span class="LPAREN">(</span><a href="#local_idom_78"><span class="LIDENT">idom</span></a> <a href="#local_v_80"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <a href="#local_v_80"><span class="LIDENT">v</span></a><span class="EOL">
</span>           <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* s0 doesn't have an idom *)</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_cfg_77"><span class="LIDENT">cfg</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find_all</span> <a href="#local_tree_79"><span class="LIDENT">tree</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-idom_to_idoms"><span class="LIDENT">idom_to_idoms</span></span> <span class="LPAREN">(</span><span id="local_idom_81"><span class="LIDENT">idom</span></span><span class="COLON">:</span><span class="LIDENT">idom</span><span class="RPAREN">)</span> <span id="local_x_82"><span class="LIDENT">x</span></span> <span id="local_y_83"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_x_82"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><a href="#local_idom_81"><span class="LIDENT">idom</span></a> <a href="#local_y_83"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span> <span class="COMMENT">(* s0 doesn't have an idom *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Computes the dominance frontier.
      As specified in section 19.1 of Modern Compiler Implementation in ML
      by Andrew Appel.
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-compute_dom_frontier"><span class="LIDENT">compute_dom_frontier</span></span> <span id="local_cfg_84"><span class="LIDENT">cfg</span></span> <span class="LPAREN">(</span><span id="local_dom_tree_85"><span class="LIDENT">dom_tree</span></span><span class="COLON">:</span> <span class="LIDENT">dom_tree</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_idom_86"><span class="LIDENT">idom</span></span><span class="COLON">:</span> <span class="LIDENT">idom</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_children_87"><span class="LIDENT">children</span></span> <span class="EQUAL">=</span> <a href="#local_dom_tree_85"><span class="LIDENT">dom_tree</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_idoms_88"><span class="LIDENT">idoms</span></span> <span class="EQUAL">=</span> <span class="LIDENT">idom_to_idoms</span> <a href="#local_idom_86"><span class="LIDENT">idom</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_df_cache_89"><span class="LIDENT">df_cache</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">57</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_df_local_90"><span class="LIDENT">df_local</span></span> <span id="local_n_91"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* the successors of n that are not strictly dominated by n *)</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_y_92"><span class="LIDENT">y</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_idoms_88"><span class="LIDENT">idoms</span></a> <a href="#local_n_91"><span class="LIDENT">n</span></a> <a href="#local_y_92"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">succ</span> <a href="#local_cfg_84"><span class="LIDENT">cfg</span></a> <a href="#local_n_91"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* written in CPS to prevent stack overflow *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_df_93"><span class="LIDENT">df</span></span> <span id="local_n_94"><span class="LIDENT">n</span></span> <span id="local_k_95"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_df_cache_89"><span class="LIDENT">df_cache</span></a> <a href="#local_n_94"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_r_96"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_k_95"><span class="LIDENT">k</span></a> <a href="#local_r_96"><span class="LIDENT">r</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_s_97"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_df_local_90"><span class="LIDENT">df_local</span></a> <a href="#local_n_94"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_add_df_ups_99"><span class="LIDENT">add_df_ups</span></a> <a href="#local_s_97"><span class="LIDENT">s</span></a> <a href="#local_n_94"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_res_98"><span class="LIDENT">res</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_df_cache_89"><span class="LIDENT">df_cache</span></a> <a href="#local_n_94"><span class="LIDENT">n</span></a> <a href="#local_res_98"><span class="LIDENT">res</span></a><span class="SEMI">;</span> <a href="#local_k_95"><span class="LIDENT">k</span></a> <a href="#local_res_98"><span class="LIDENT">res</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_children_87"><span class="LIDENT">children</span></a> <a href="#local_n_94"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_add_df_ups_99"><span class="LIDENT">add_df_ups</span></span> <span id="local_s_100"><span class="LIDENT">s</span></span> <span id="local_n_101"><span class="LIDENT">n</span></span> <span id="local_k_102"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_k_102"><span class="LIDENT">k</span></a> <a href="#local_s_100"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_103"><span class="LIDENT">c</span></span> <span class="COLONCOLON">::</span> <span id="local_chl_104"><span class="LIDENT">chl</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_df_93"><span class="LIDENT">df</span></a> <a href="#local_c_103"><span class="LIDENT">c</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_dfc_105"><span class="LIDENT">dfc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="#local_add_df_ups_99"><span class="LIDENT">add_df_ups</span></a><span class="EOL">
</span>              <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>                 <span class="COMMENT">(* the appel errata uses sdom, but Muchnick uses idoms, which
                    should be a bit faster and is the same *)</span><span class="EOL">
</span>                 <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_s_106"><span class="LIDENT">s</span></span> <span id="local_w_107"><span class="LIDENT">w</span></span>  <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_idoms_88"><span class="LIDENT">idoms</span></a> <a href="#local_n_101"><span class="LIDENT">n</span></a> <a href="#local_w_107"><span class="LIDENT">w</span></a> <span class="THEN">then</span> <a href="#local_s_106"><span class="LIDENT">s</span></a> <span class="ELSE">else</span> <a href="#local_w_107"><span class="LIDENT">w</span></a> <span class="COLONCOLON">::</span> <a href="#local_s_106"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_s_100"><span class="LIDENT">s</span></a> <a href="#local_dfc_105"><span class="LIDENT">dfc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <a href="#local_n_101"><span class="LIDENT">n</span></a> <a href="#local_k_102"><span class="LIDENT">k</span></a> <a href="#local_chl_104"><span class="LIDENT">chl</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_n_108"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_df_93"><span class="LIDENT">df</span></a> <a href="#local_n_108"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_109"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_109"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-idom_to_dominators"><span class="LIDENT">idom_to_dominators</span></span> <span id="local_idom_110"><span class="LIDENT">idom</span></span> <span id="local_x_111"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_d_112"><span class="LIDENT">d</span></span> <span id="local_y_113"><span class="LIDENT">y</span></span> <span id="local_list_114"><span class="LIDENT">list</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_115"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_idom_110"><span class="LIDENT">idom</span></a> <a href="#local_y_113"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_d_112"><span class="LIDENT">d</span></a> <a href="#local_i_115"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_i_115"><span class="LIDENT">i</span></a><span class="COLONCOLON">::</span><a href="#local_list_114"><span class="LIDENT">list</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_list_114"><span class="LIDENT">list</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_d_112"><span class="LIDENT">d</span></a> <a href="#local_x_111"><span class="LIDENT">x</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Make.val-idom_to_dom"><span class="LIDENT">idom_to_dom</span></span> <span id="local_idom_116"><span class="LIDENT">idom</span></span> <span id="local_x_117"><span class="LIDENT">x</span></span> <span id="local_y_118"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_d_119"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="#local_idom_116"><span class="LIDENT">idom</span></a> <a href="#local_y_118"><span class="LIDENT">y</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_x_117"><span class="LIDENT">x</span></a> <a href="#local_d_119"><span class="LIDENT">d</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">idom_to_dom</span> <a href="#local_idom_116"><span class="LIDENT">idom</span></a> <a href="#local_x_117"><span class="LIDENT">x</span></a> <a href="#local_d_119"><span class="LIDENT">d</span></a><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* There is a nice description of non-trivial dominators with an example
     in Section 2 and Figure 2 of Jaberi 2016, &quot;On computing the
     2-vertex-connected components of directed graphs&quot;. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dom_tree_to_nontrivial_dom"><span class="LIDENT">dom_tree_to_nontrivial_dom</span></span> <span id="local_v_120"><span class="LIDENT">v</span></span> <span id="local_dt_121"><span class="LIDENT">dt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_f_122"><span class="LIDENT">f</span></span> <span id="local_rs_123"><span class="LIDENT">rs</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_rs_123"><span class="LIDENT">rs</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_x_124"><span class="LIDENT">x</span></span><span class="COLONCOLON">::</span><span id="local_xs_125"><span class="LIDENT">xs</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_dt_121"><span class="LIDENT">dt</span></a> <a href="#local_x_124"><span class="LIDENT">x</span></a> <span class="WITH">with</span><span class="EOL">
</span>           <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_122"><span class="LIDENT">f</span></a> <a href="#local_rs_123"><span class="LIDENT">rs</span></a> <a href="#local_xs_125"><span class="LIDENT">xs</span></a><span class="EOL">
</span>           <span class="BAR">|</span> <span id="local_ys_126"><span class="LIDENT">ys</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_122"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><a href="#local_x_124"><span class="LIDENT">x</span></a><span class="COLONCOLON">::</span><a href="#local_rs_123"><span class="LIDENT">rs</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_append"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_append</span></a> <a href="#local_ys_126"><span class="LIDENT">ys</span></a> <a href="#local_xs_125"><span class="LIDENT">xs</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_f_122"><span class="LIDENT">f</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LPAREN">(</span><a href="#local_dt_121"><span class="LIDENT">dt</span></a> <a href="#local_v_120"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make.val-dom_tree_to_snontrivial_dom"><span class="LIDENT">dom_tree_to_snontrivial_dom</span></span> <span id="local_v_127"><span class="LIDENT">v</span></span> <span id="local_dt_128"><span class="LIDENT">dt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_f_129"><span class="LIDENT">f</span></span> <span id="local_rs_130"><span class="LIDENT">rs</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_rs_130"><span class="LIDENT">rs</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_x_131"><span class="LIDENT">x</span></span><span class="COLONCOLON">::</span><span id="local_xs_132"><span class="LIDENT">xs</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_dt_128"><span class="LIDENT">dt</span></a> <a href="#local_x_131"><span class="LIDENT">x</span></a> <span class="WITH">with</span><span class="EOL">
</span>           <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_129"><span class="LIDENT">f</span></a> <a href="#local_rs_130"><span class="LIDENT">rs</span></a> <a href="#local_xs_132"><span class="LIDENT">xs</span></a><span class="EOL">
</span>           <span class="BAR">|</span> <span id="local_ys_133"><span class="LIDENT">ys</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_129"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_x_131"><span class="LIDENT">x</span></a> <a href="#local_rs_130"><span class="LIDENT">rs</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_append"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_append</span></a> <a href="#local_ys_133"><span class="LIDENT">ys</span></a> <a href="#local_xs_132"><span class="LIDENT">xs</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_f_129"><span class="LIDENT">f</span></a> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">empty</span> <span class="LPAREN">(</span><a href="#local_dt_128"><span class="LIDENT">dt</span></a> <a href="#local_v_127"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Make_graph"><span class="MODULE">module</span> <span class="UIDENT">Make_graph</span><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="COLON">:</span> <span class="UIDENT">I</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">Make</span><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make_graph.type-dom_graph"><span class="TYPE">type</span> <span class="LIDENT">dom_graph</span> <span class="EQUAL">=</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Make_graph.type-dom_functions"><span class="TYPE">type</span> <span class="LIDENT">dom_functions</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>    <span id="def_158"><span class="LIDENT">idom</span> <span class="COLON">:</span> <span class="LIDENT">idom</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_159"><span class="LIDENT">idoms</span><span class="COLON">:</span> <span class="LIDENT">idoms</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_152"><span class="LIDENT">dom_tree</span><span class="COLON">:</span> <span class="LIDENT">dom_tree</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_154"><span class="LIDENT">dominators</span><span class="COLON">:</span> <span class="LIDENT">dominators</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_157"><span class="LIDENT">dom</span><span class="COLON">:</span> <span class="LIDENT">dom</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_160"><span class="LIDENT">sdom</span><span class="COLON">:</span> <span class="LIDENT">sdom</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_151"><span class="LIDENT">dom_frontier</span><span class="COLON">:</span> <span class="LIDENT">dom_frontier</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_156"><span class="LIDENT">dom_graph</span> <span class="COLON">:</span> <span class="LIDENT">dom_graph</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_graph.val-compute_dom_graph"><span class="LIDENT">compute_dom_graph</span></span> <span id="local_cfg_134"><span class="LIDENT">cfg</span></span> <span id="local_dom_tree_135"><span class="LIDENT">dom_tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">fold_vertex</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_p_136"><span class="LIDENT">p</span></span> <span id="local_g_137"><span class="LIDENT">g</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="TRY">try</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_g_138"><span class="LIDENT">g</span></span> <span id="local_u_139"><span class="LIDENT">u</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">add_edge</span> <a href="#local_g_138"><span class="LIDENT">g</span></a> <a href="#local_p_136"><span class="LIDENT">p</span></a> <a href="#local_u_139"><span class="LIDENT">u</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_g_137"><span class="LIDENT">g</span></a> <span class="LPAREN">(</span><a href="#local_dom_tree_135"><span class="LIDENT">dom_tree</span></a> <a href="#local_p_136"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_g_137"><span class="LIDENT">g</span></a><span class="EOL">
</span>      <span class="RPAREN">)</span> <a href="#local_cfg_134"><span class="LIDENT">cfg</span></a> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">empty</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="DOCSTRING">(** Computes all dominance functions.
      This function computes some things eagerly and some lazily, so don't
      worry about it doing extra work to compute functions you don't need,
      but also don't call it if you aren't going to use anything it returns.
      @return a record containing all dominance functions for the given graph
      and entry node.
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_graph.val-compute_all"><span class="LIDENT">compute_all</span></span> <span id="local_cfg_140"><span class="LIDENT">cfg</span></span> <span id="local_s0_141"><span class="LIDENT">s0</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_idom_142"><span class="LIDENT">idom</span></span> <span class="EQUAL">=</span> <span class="LIDENT">compute_idom</span> <a href="#local_cfg_140"><span class="LIDENT">cfg</span></a> <a href="#local_s0_141"><span class="LIDENT">s0</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_idoms_143"><span class="LIDENT">idoms</span></span> <span class="EQUAL">=</span> <span class="LIDENT">idom_to_idoms</span> <a href="#local_idom_142"><span class="LIDENT">idom</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dom_tree_144"><span class="LIDENT">dom_tree</span></span> <span class="EQUAL">=</span> <span class="LAZY">lazy</span><span class="LPAREN">(</span><span class="LIDENT">idom_to_dom_tree</span> <a href="#local_cfg_140"><span class="LIDENT">cfg</span></a> <a href="#local_idom_142"><span class="LIDENT">idom</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dominators_145"><span class="LIDENT">dominators</span></span> <span class="EQUAL">=</span> <span class="LIDENT">idom_to_dominators</span> <a href="#local_idom_142"><span class="LIDENT">idom</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dom_146"><span class="LIDENT">dom</span></span> <span class="EQUAL">=</span> <span class="LIDENT">idom_to_dom</span> <a href="#local_idom_142"><span class="LIDENT">idom</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sdom_147"><span class="LIDENT">sdom</span></span> <span class="EQUAL">=</span> <span class="LIDENT">dom_to_sdom</span> <a href="#local_dom_146"><span class="LIDENT">dom</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_dom_frontier_148"><span class="LIDENT">dom_frontier</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LAZY">lazy</span><span class="LPAREN">(</span><span class="LIDENT">compute_dom_frontier</span> <a href="#local_cfg_140"><span class="LIDENT">cfg</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/lazy.ml.html#val-force"><span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="LIDENT">force</span></a> <a href="#local_dom_tree_144"><span class="LIDENT">dom_tree</span></a><span class="RPAREN">)</span> <a href="#local_idom_142"><span class="LIDENT">idom</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <span class="LIDENT">idom</span><span class="EQUAL">=</span><a href="#local_idom_142"><span class="LIDENT">idom</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">idoms</span><span class="EQUAL">=</span><a href="#local_idoms_143"><span class="LIDENT">idoms</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">dom_tree</span><span class="EQUAL">=</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_149"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/lazy.ml.html#val-force"><span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="LIDENT">force</span></a> <a href="#local_dom_tree_144"><span class="LIDENT">dom_tree</span></a> <a href="#local_x_149"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">dominators</span><span class="EQUAL">=</span><a href="#local_dominators_145"><span class="LIDENT">dominators</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">dom</span><span class="EQUAL">=</span><a href="#local_dom_146"><span class="LIDENT">dom</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">sdom</span><span class="EQUAL">=</span><a href="#local_sdom_147"><span class="LIDENT">sdom</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">dom_frontier</span><span class="EQUAL">=</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_150"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/lazy.ml.html#val-force"><span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="LIDENT">force</span></a> <a href="#local_dom_frontier_148"><span class="LIDENT">dom_frontier</span></a> <a href="#local_x_150"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">dom_graph</span><span class="EQUAL">=</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">compute_dom_graph</span> <a href="#local_cfg_140"><span class="LIDENT">cfg</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/lazy.ml.html#val-force"><span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="LIDENT">force</span></a> <a href="#local_dom_tree_144"><span class="LIDENT">dom_tree</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span></span></code></pre></body></html>
