<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: avltree.ml (base.src.base)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Base</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; base &#x00BB; avltree.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>avltree.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">Base</a><ul><li>Library <code>base</code><ul><li><a href="../../base/Base/index.html">Base</a></li></ul></li><li>Library <code>base.base_internalhash_types</code><ul><li><a href="../../base.base_internalhash_types/Base_internalhash_types/index.html">Base_internalhash_types</a></li></ul></li><li>Library <code>base.caml</code><ul><li><a href="../../base.caml/Caml/index.html">Caml</a></li></ul></li><li>Library <code>base.md5</code><ul><li><a href="../../base.md5/Md5_lib/index.html">Md5_lib</a></li></ul></li><li>Library <code>base.shadow_stdlib</code><ul><li><a href="../../base.shadow_stdlib/Shadow_stdlib/index.html">Shadow_stdlib</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>base<ul><li><a href="applicative.ml.html">applicative.ml</a></li><li><a href="applicative_intf.ml.html">applicative_intf.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="array0.ml.html">array0.ml</a></li><li><a href="array_permute.ml.html">array_permute.ml</a></li><li><a href="#" class="current_unit">avltree.ml</a></li><li><a href="backtrace.ml.html">backtrace.ml</a></li><li><a href="base.ml.html">base.ml</a></li><li><a href="base__.ml.html">base__.ml</a></li><li><a href="binary_search.ml.html">binary_search.ml</a></li><li><a href="binary_searchable.ml.html">binary_searchable.ml</a></li><li><a href="binary_searchable_intf.ml.html">binary_searchable_intf.ml</a></li><li><a href="blit.ml.html">blit.ml</a></li><li><a href="blit_intf.ml.html">blit_intf.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="bool0.ml.html">bool0.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="buffer_intf.ml.html">buffer_intf.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytes0.ml.html">bytes0.ml</a></li><li><a href="bytes_tr.ml.html">bytes_tr.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="char0.ml.html">char0.ml</a></li><li><a href="comparable.ml.html">comparable.ml</a></li><li><a href="comparable_intf.ml.html">comparable_intf.ml</a></li><li><a href="comparator.ml.html">comparator.ml</a></li><li><a href="comparisons.ml.html">comparisons.ml</a></li><li><a href="container.ml.html">container.ml</a></li><li><a href="container_intf.ml.html">container_intf.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="either0.ml.html">either0.ml</a></li><li><a href="either_intf.ml.html">either_intf.ml</a></li><li><a href="equal.ml.html">equal.ml</a></li><li><a href="error.ml.html">error.ml</a></li><li><a href="exn.ml.html">exn.ml</a></li><li><a href="field.ml.html">field.ml</a></li><li><a href="fieldslib.ml.html">fieldslib.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="float0.ml.html">float0.ml</a></li><li><a href="floatable.ml.html">floatable.ml</a></li><li><a href="fn.ml.html">fn.ml</a></li><li><a href="formatter.ml.html">formatter.ml</a></li><li><a href="globalize.ml.html">globalize.ml</a></li><li><a href="hash.ml.html">hash.ml</a></li><li><a href="hash_intf.ml.html">hash_intf.ml</a></li><li><a href="hash_set.ml.html">hash_set.ml</a></li><li><a href="hash_set_intf.ml.html">hash_set_intf.ml</a></li><li><a href="hashable.ml.html">hashable.ml</a></li><li><a href="hashable_intf.ml.html">hashable_intf.ml</a></li><li><a href="hasher.ml.html">hasher.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="hashtbl_intf.ml.html">hashtbl_intf.ml</a></li><li><a href="hex_lexer.ml.html">hex_lexer.ml</a></li><li><a href="identifiable.ml.html">identifiable.ml</a></li><li><a href="identifiable_intf.ml.html">identifiable_intf.ml</a></li><li><a href="import.ml.html">import.ml</a></li><li><a href="import0.ml.html">import0.ml</a></li><li><a href="indexed_container.ml.html">indexed_container.ml</a></li><li><a href="indexed_container_intf.ml.html">indexed_container_intf.ml</a></li><li><a href="info.ml.html">info.ml</a></li><li><a href="info_intf.ml.html">info_intf.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int0.ml.html">int0.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int63.ml.html">int63.ml</a></li><li><a href="int63_emul.ml.html">int63_emul.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="int_conversions.ml.html">int_conversions.ml</a></li><li><a href="int_intf.ml.html">int_intf.ml</a></li><li><a href="int_math.ml.html">int_math.ml</a></li><li><a href="intable.ml.html">intable.ml</a></li><li><a href="invariant.ml.html">invariant.ml</a></li><li><a href="invariant_intf.ml.html">invariant_intf.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="linked_queue.ml.html">linked_queue.ml</a></li><li><a href="linked_queue0.ml.html">linked_queue0.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="list0.ml.html">list0.ml</a></li><li><a href="list1.ml.html">list1.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="map_intf.ml.html">map_intf.ml</a></li><li><a href="maybe_bound.ml.html">maybe_bound.ml</a></li><li><a href="monad.ml.html">monad.ml</a></li><li><a href="monad_intf.ml.html">monad_intf.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="nothing.ml.html">nothing.ml</a></li><li><a href="obj_array.ml.html">obj_array.ml</a></li><li><a href="obj_local.ml.html">obj_local.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="option_array.ml.html">option_array.ml</a></li><li><a href="or_error.ml.html">or_error.ml</a></li><li><a href="ordered_collection_common.ml.html">ordered_collection_common.ml</a></li><li><a href="ordered_collection_common0.ml.html">ordered_collection_common0.ml</a></li><li><a href="ordering.ml.html">ordering.ml</a></li><li><a href="poly0.ml.html">poly0.ml</a></li><li><a href="popcount.ml.html">popcount.ml</a></li><li><a href="pow_overflow_bounds.ml.html">pow_overflow_bounds.ml</a></li><li><a href="ppx_compare_lib.ml.html">ppx_compare_lib.ml</a></li><li><a href="ppx_enumerate_lib.ml.html">ppx_enumerate_lib.ml</a></li><li><a href="ppx_hash_lib.ml.html">ppx_hash_lib.ml</a></li><li><a href="pretty_printer.ml.html">pretty_printer.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="queue_intf.ml.html">queue_intf.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="random_repr.ml.html">random_repr.ml</a></li><li><a href="ref.ml.html">ref.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="sequence.ml.html">sequence.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="set_intf.ml.html">set_intf.ml</a></li><li><a href="sexp.ml.html">sexp.ml</a></li><li><a href="sexp_with_comparable.ml.html">sexp_with_comparable.ml</a></li><li><a href="sexpable.ml.html">sexpable.ml</a></li><li><a href="sign.ml.html">sign.ml</a></li><li><a href="sign0.ml.html">sign0.ml</a></li><li><a href="sign_or_nan.ml.html">sign_or_nan.ml</a></li><li><a href="source_code_position.ml.html">source_code_position.ml</a></li><li><a href="source_code_position0.ml.html">source_code_position0.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stack_intf.ml.html">stack_intf.ml</a></li><li><a href="staged.ml.html">staged.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="string0.ml.html">string0.ml</a></li><li><a href="stringable.ml.html">stringable.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="sys0.ml.html">sys0.ml</a></li><li><a href="t.ml.html">t.ml</a></li><li><a href="type_equal.ml.html">type_equal.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="uchar0.ml.html">uchar0.ml</a></li><li><a href="uniform_array.ml.html">uniform_array.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="variant.ml.html">variant.ml</a></li><li><a href="variantslib.ml.html">variantslib.ml</a></li><li><a href="with_return.ml.html">with_return.ml</a></li><li><a href="word_size.ml.html">word_size.ml</a></li></ul></li><li>base.base_internalhash_types<ul><li><a href="../base.base_internalhash_types/base_internalhash_types.ml.html">base_internalhash_types.ml</a></li></ul></li><li>base.caml<ul><li><a href="../base.caml/caml.ml.html">caml.ml</a></li></ul></li><li>base.md5<ul><li><a href="../base.md5/md5_lib.ml.html">md5_lib.ml</a></li></ul></li><li>base.shadow_stdlib<ul><li><a href="../base.shadow_stdlib/shadow_stdlib.ml.html">shadow_stdlib.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
</code><code class="source_code"><span><span class="COMMENT">(* A few small things copied from other parts of Base because they depend on us, so we
   can't use them. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span><span class="BANG">!</span> <a href="import.ml.html"><span class="UIDENT">Import</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-raise_s"><span class="LIDENT">raise_s</span></span> <span class="EQUAL">=</span> <a href="error.ml.html#val-raise_s"><span class="UIDENT">Error</span><span class="DOT">.</span><span class="LIDENT">raise_s</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-Int"><span class="MODULE">module</span> <span class="UIDENT">Int</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Int.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">int</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Int.val-max"><span class="LIDENT">max</span></span> <span class="LPAREN">(</span><span id="local_x_1"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span id="local_y_2"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_x_1"><span class="LIDENT">x</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_y_2"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <a href="#local_x_1"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_y_2"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Its important that Empty have no args. It's tempting to make this type a record
   (e.g. to hold the compare function), but a lot of memory is saved by Empty being an
   immediate, since all unused buckets in the hashtbl don't use any memory (besides the
   array cell) *)</span><span class="EOL">
</span><span id="type-t"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">k</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-t.constructor-Empty"><span class="BAR">|</span> <span class="UIDENT">Empty</span></span><span class="EOL">
</span>  <span id="type-t.constructor-Node"><span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="OF">of</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span id="def_294"><span class="MUTABLE">mutable</span> <span class="LIDENT">left</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">k</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LIDENT">t</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_293"><span class="LIDENT">key</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">k</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_295"><span class="MUTABLE">mutable</span> <span class="LIDENT">value</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">v</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_298"><span class="MUTABLE">mutable</span> <span class="LIDENT">height</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_299"><span class="MUTABLE">mutable</span> <span class="LIDENT">right</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">k</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>      <span class="RBRACE">}</span></span><span class="EOL">
</span>  <span id="type-t.constructor-Leaf"><span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="OF">of</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span id="def_297"><span class="LIDENT">key</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">k</span><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span id="def_300"><span class="MUTABLE">mutable</span> <span class="LIDENT">value</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">v</span></span><span class="EOL">
</span>      <span class="RBRACE">}</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-empty"><span class="LIDENT">empty</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_empty"><span class="LIDENT">is_empty</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-height"><span class="LIDENT">height</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">1</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_height_3"><span class="LIDENT">height</span></span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_height_3"><span class="LIDENT">height</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-{invariant}1/shadowed/(base-src-base-avltree.ml)"><span class="LIDENT">invariant</span></span> <span id="local_compare_4"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_legal_left_key_5"><span class="LIDENT">legal_left_key</span></span> <span id="local_key_6"><span class="LIDENT">key</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_left_key_7"><span class="LIDENT">left_key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_left_key_8"><span class="LIDENT">left_key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_compare_4"><span class="LIDENT">compare</span></a> <a href="#local_left_key_8"><span class="LIDENT">left_key</span></a> <a href="#local_key_6"><span class="LIDENT">key</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_legal_right_key_9"><span class="LIDENT">legal_right_key</span></span> <span id="local_key_10"><span class="LIDENT">key</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_right_key_11"><span class="LIDENT">right_key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_right_key_12"><span class="LIDENT">right_key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_compare_4"><span class="LIDENT">compare</span></a> <a href="#local_right_key_12"><span class="LIDENT">right_key</span></a> <a href="#local_key_10"><span class="LIDENT">key</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_inv_13"><span class="LIDENT">inv</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_14"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_15"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span id="local_h_16"><span class="LIDENT">h</span></span><span class="SEMI">;</span> <span id="local_right_17"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_296"><span id="local_hl_18"><span class="LIDENT">hl</span></span><span class="COMMA">,</span> <span id="local_hr_19"><span class="LIDENT">hr</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">height</span> <a href="#local_left_14"><span class="LIDENT">left</span></a><span class="COMMA">,</span> <span class="LIDENT">height</span> <a href="#local_right_17"><span class="LIDENT">right</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_inv_13"><span class="LIDENT">inv</span></a> <a href="#local_left_14"><span class="LIDENT">left</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_inv_13"><span class="LIDENT">inv</span></a> <a href="#local_right_17"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_legal_left_key_5"><span class="LIDENT">legal_left_key</span></a> <a href="#local_k_15"><span class="LIDENT">k</span></a> <a href="#local_left_14"><span class="LIDENT">left</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_legal_right_key_9"><span class="LIDENT">legal_right_key</span></a> <a href="#local_k_15"><span class="LIDENT">k</span></a> <a href="#local_right_17"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_h_16"><span class="LIDENT">h</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">max</span> <a href="#local_hl_18"><span class="LIDENT">hl</span></a> <a href="#local_hr_19"><span class="LIDENT">hr</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="import0.ml.html#val-abs"><span class="LIDENT">abs</span></a> <span class="LPAREN">(</span><a href="#local_hl_18"><span class="LIDENT">hl</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_hr_19"><span class="LIDENT">hr</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_inv_13"><span class="LIDENT">inv</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-invariant"><span class="LIDENT">invariant</span></span> <span id="local_t_20"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_21"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span> <span class="LIDENT">invariant</span> <a href="#local_compare_21"><span class="LIDENT">compare</span></a> <a href="#local_t_20"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* In the following comments,
   't is balanced' means that 'invariant t' does not
   raise an exception.  This implies of course that each node's height field is
   correct.
   't is balanceable' means that height of the left and right subtrees of t
   differ by at most 3. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* @pre: left and right subtrees have correct heights
   @post: output has the correct height *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-update_height"><span class="LIDENT">update_height</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_left_23"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span id="local_old_height_24"><span class="LIDENT">old_height</span></span><span class="SEMI">;</span> <span id="local_right_25"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_x_22"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_height_26"><span class="LIDENT">new_height</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LPAREN">(</span><span class="LIDENT">height</span> <a href="#local_left_23"><span class="LIDENT">left</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">height</span> <a href="#local_right_25"><span class="LIDENT">right</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_new_height_26"><span class="LIDENT">new_height</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_old_height_24"><span class="LIDENT">old_height</span></a> <span class="THEN">then</span> <a href="#local_x_22"><span class="LIDENT">x</span></a><span class="DOT">.</span><span class="LIDENT">height</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_height_26"><span class="LIDENT">new_height</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* @pre: left and right subtrees are balanced
   @pre: tree is balanceable
   @post: output is balanced (in particular, height is correct) *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-balance"><span class="LIDENT">balance</span></span> <span id="local_tree_27"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_left_29"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_30"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_root_node_28"><span class="LIDENT">root_node</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hl_31"><span class="LIDENT">hl</span></span> <span class="EQUAL">=</span> <span class="LIDENT">height</span> <a href="#local_left_29"><span class="LIDENT">left</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_hr_32"><span class="LIDENT">hr</span></span> <span class="EQUAL">=</span> <span class="LIDENT">height</span> <a href="#local_right_30"><span class="LIDENT">right</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* + 2 is critically important, lowering it to 1 will break the Leaf
       assumptions in the code below, and will force us to promote leaf nodes in
       the balance routine. It's also faster, since it will balance less often.
       Note that the following code is delicate.  The update_height calls must
       occur in the correct order, since update_height assumes its children have
       the correct heights.  *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_hl_31"><span class="LIDENT">hl</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_hr_32"><span class="LIDENT">hr</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_left_29"><span class="LIDENT">left</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="COMMENT">(* It cannot be a leaf, because even if right is empty, a leaf
         is only height 1 *)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span id="local_left_node_left_34"><span class="LIDENT">left_node_left</span></span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span id="local_left_node_right_35"><span class="LIDENT">left_node_right</span></span><span class="EOL">
</span>           <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_left_node_33"><span class="LIDENT">left_node</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="LIDENT">height</span> <a href="#local_left_node_left_34"><span class="LIDENT">left_node_left</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">height</span> <a href="#local_left_node_right_35"><span class="LIDENT">left_node_right</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_root_node_28"><span class="LIDENT">root_node</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_left_node_right_35"><span class="LIDENT">left_node_right</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_left_node_33"><span class="LIDENT">left_node</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">update_height</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">update_height</span> <a href="#local_left_29"><span class="LIDENT">left</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_left_29"><span class="LIDENT">left</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="COMMENT">(* if right is a leaf, then left must be empty. That means
             height is 2. Even if hr is empty we still can't get here. *)</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_left_node_right_35"><span class="LIDENT">left_node_right</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>              <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span id="local_lr_left_37"><span class="LIDENT">lr_left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span id="local_lr_right_38"><span class="LIDENT">lr_right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span><span class="EOL">
</span>               <span id="local_lr_node_36"><span class="LIDENT">lr_node</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="#local_left_node_33"><span class="LIDENT">left_node</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_lr_left_37"><span class="LIDENT">lr_left</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_root_node_28"><span class="LIDENT">root_node</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_lr_right_38"><span class="LIDENT">lr_right</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_lr_node_36"><span class="LIDENT">lr_node</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_lr_node_36"><span class="LIDENT">lr_node</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_left_29"><span class="LIDENT">left</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">update_height</span> <a href="#local_left_29"><span class="LIDENT">left</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">update_height</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">update_height</span> <a href="#local_left_node_right_35"><span class="LIDENT">left_node_right</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_left_node_right_35"><span class="LIDENT">left_node_right</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_hr_32"><span class="LIDENT">hr</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_hl_31"><span class="LIDENT">hl</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="COMMENT">(* see above for an explanation of why right cannot be a leaf *)</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_right_30"><span class="LIDENT">right</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span id="local_right_node_left_40"><span class="LIDENT">right_node_left</span></span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span id="local_right_node_right_41"><span class="LIDENT">right_node_right</span></span><span class="EOL">
</span>           <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_right_node_39"><span class="LIDENT">right_node</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="LIDENT">height</span> <a href="#local_right_node_right_41"><span class="LIDENT">right_node_right</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">height</span> <a href="#local_right_node_left_40"><span class="LIDENT">right_node_left</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_root_node_28"><span class="LIDENT">root_node</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_right_node_left_40"><span class="LIDENT">right_node_left</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_right_node_39"><span class="LIDENT">right_node</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">update_height</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">update_height</span> <a href="#local_right_30"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_right_30"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="COMMENT">(* see above for an explanation of why this cannot be a leaf *)</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_right_node_left_40"><span class="LIDENT">right_node_left</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>              <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span id="local_rl_left_43"><span class="LIDENT">rl_left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span id="local_rl_right_44"><span class="LIDENT">rl_right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span><span class="EOL">
</span>               <span id="local_rl_node_42"><span class="LIDENT">rl_node</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="#local_right_node_39"><span class="LIDENT">right_node</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_rl_right_44"><span class="LIDENT">rl_right</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_root_node_28"><span class="LIDENT">root_node</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_rl_left_43"><span class="LIDENT">rl_left</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_rl_node_42"><span class="LIDENT">rl_node</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_rl_node_42"><span class="LIDENT">rl_node</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_right_30"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">update_height</span> <a href="#local_right_30"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">update_height</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">update_height</span> <a href="#local_right_node_left_40"><span class="LIDENT">right_node_left</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_right_node_left_40"><span class="LIDENT">right_node_left</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LIDENT">update_height</span> <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_tree_27"><span class="LIDENT">tree</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* @pre: tree is balanceable
   @pre: abs (height (right node) - height (balance tree)) &lt;= 3
   @post: result is balanceable *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* @pre: tree is balanceable
   @pre: abs (height (right node) - height (balance tree)) &lt;= 3
   @post: result is balanceable *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_left"><span class="LIDENT">set_left</span></span> <span id="local_node_45"><span class="LIDENT">node</span></span> <span id="local_tree_46"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_tree_47"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span> <span class="LIDENT">balance</span> <a href="#local_tree_46"><span class="LIDENT">tree</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_node_45"><span class="LIDENT">node</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_left_49"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_r_48"><span class="LIDENT">r</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-phys_equal"><span class="LIDENT">phys_equal</span></a> <a href="#local_left_49"><span class="LIDENT">left</span></a> <a href="#local_tree_47"><span class="LIDENT">tree</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_r_48"><span class="LIDENT">r</span></a><span class="DOT">.</span><span class="LIDENT">left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_tree_47"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">update_height</span> <a href="#local_node_45"><span class="LIDENT">node</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* @pre: tree is balanceable
   @pre: abs (height (left node) - height (balance tree)) &lt;= 3
   @post: result is balanceable *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_right"><span class="LIDENT">set_right</span></span> <span id="local_node_50"><span class="LIDENT">node</span></span> <span id="local_tree_51"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_tree_52"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span> <span class="LIDENT">balance</span> <a href="#local_tree_51"><span class="LIDENT">tree</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_node_50"><span class="LIDENT">node</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_54"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_r_53"><span class="LIDENT">r</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-phys_equal"><span class="LIDENT">phys_equal</span></a> <a href="#local_right_54"><span class="LIDENT">right</span></a> <a href="#local_tree_52"><span class="LIDENT">tree</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_r_53"><span class="LIDENT">r</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_tree_52"><span class="LIDENT">tree</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">update_height</span> <a href="#local_node_50"><span class="LIDENT">node</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* @pre: t is balanced.
   @post: result is balanced, with new node inserted
   @post: !added = true iff the shape of the input tree changed.  *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add"><span class="LIDENT">add</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_add_55"><span class="LIDENT">add</span></span> <span id="local_t_56"><span class="LIDENT">t</span></span> <span id="local_replace_57"><span class="LIDENT">replace</span></span> <span id="local_added_58"><span class="LIDENT">added</span></span> <span id="local_compare_59"><span class="LIDENT">compare</span></span> <span id="local_k_60"><span class="LIDENT">k</span></span> <span id="local_v_61"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_added_58"><span class="LIDENT">added</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <a href="#local_k_60"><span class="LIDENT">k</span></a><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <a href="#local_v_61"><span class="LIDENT">v</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k'_63"><span class="LIDENT">k'</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_r_62"><span class="LIDENT">r</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_64"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_compare_59"><span class="LIDENT">compare</span></a> <a href="#local_k'_63"><span class="LIDENT">k'</span></a> <a href="#local_k_60"><span class="LIDENT">k</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* This compare is reversed on purpose, we are pretending
         that the leaf was just inserted instead of the other way
         round, that way we only allocate one node. *)</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_c_64"><span class="LIDENT">c</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_added_58"><span class="LIDENT">added</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_replace_57"><span class="LIDENT">replace</span></a> <span class="THEN">then</span> <a href="#local_r_62"><span class="LIDENT">r</span></a><span class="DOT">.</span><span class="LIDENT">value</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_t_56"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_added_58"><span class="LIDENT">added</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_c_64"><span class="LIDENT">c</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <a href="#local_t_56"><span class="LIDENT">t</span></a><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <a href="#local_k_60"><span class="LIDENT">k</span></a><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span> <span class="RBRACE">}</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <a href="#local_k_60"><span class="LIDENT">k</span></a><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="INT">2</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_left_66"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k'_67"><span class="LIDENT">k'</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_68"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_r_65"><span class="LIDENT">r</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_69"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_compare_59"><span class="LIDENT">compare</span></a> <a href="#local_k_60"><span class="LIDENT">k</span></a> <a href="#local_k'_67"><span class="LIDENT">k'</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_c_69"><span class="LIDENT">c</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_added_58"><span class="LIDENT">added</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_replace_57"><span class="LIDENT">replace</span></a> <span class="THEN">then</span> <a href="#local_r_65"><span class="LIDENT">r</span></a><span class="DOT">.</span><span class="LIDENT">value</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_c_69"><span class="LIDENT">c</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LIDENT">set_left</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="#local_add_55"><span class="LIDENT">add</span></a> <a href="#local_left_66"><span class="LIDENT">left</span></a> <a href="#local_replace_57"><span class="LIDENT">replace</span></a> <a href="#local_added_58"><span class="LIDENT">added</span></a> <a href="#local_compare_59"><span class="LIDENT">compare</span></a> <a href="#local_k_60"><span class="LIDENT">k</span></a> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">set_right</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="#local_add_55"><span class="LIDENT">add</span></a> <a href="#local_right_68"><span class="LIDENT">right</span></a> <a href="#local_replace_57"><span class="LIDENT">replace</span></a> <a href="#local_added_58"><span class="LIDENT">added</span></a> <a href="#local_compare_59"><span class="LIDENT">compare</span></a> <a href="#local_k_60"><span class="LIDENT">k</span></a> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_t_56"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_70"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_replace_71"><span class="LIDENT">replace</span></span> <span class="TILDE">~</span><span id="local_compare_72"><span class="LIDENT">compare</span></span> <span class="TILDE">~</span><span id="local_added_73"><span class="LIDENT">added</span></span> <span class="TILDE">~</span><span id="local_key_74"><span class="LIDENT">key</span></span> <span class="TILDE">~</span><span id="local_data_75"><span class="LIDENT">data</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t_76"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_add_55"><span class="LIDENT">add</span></a> <a href="#local_t_70"><span class="LIDENT">t</span></a> <a href="#local_replace_71"><span class="LIDENT">replace</span></a> <a href="#local_added_73"><span class="LIDENT">added</span></a> <a href="#local_compare_72"><span class="LIDENT">compare</span></a> <a href="#local_key_74"><span class="LIDENT">key</span></a> <a href="#local_data_75"><span class="LIDENT">data</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_added_73"><span class="LIDENT">added</span></a> <span class="THEN">then</span> <span class="LIDENT">balance</span> <a href="#local_t_76"><span class="LIDENT">t</span></a> <span class="ELSE">else</span> <a href="#local_t_76"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-first"><span class="LIDENT">first</span></span> <span id="local_t_77"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_77"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_78"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_79"><span class="LIDENT">v</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_80"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_81"><span class="LIDENT">v</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_k_80"><span class="LIDENT">k</span></a><span class="COMMA">,</span> <a href="#local_v_81"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span id="local_l_82"><span class="LIDENT">l</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">first</span> <a href="#local_l_82"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-last"><span class="LIDENT">last</span></span> <span id="local_t_83"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_83"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_84"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_85"><span class="LIDENT">v</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_86"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_87"><span class="LIDENT">v</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_k_86"><span class="LIDENT">k</span></a><span class="COMMA">,</span> <a href="#local_v_87"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span id="local_r_88"><span class="LIDENT">r</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">last</span> <a href="#local_r_88"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span class="REC">rec</span> <span id="val-findi_and_call_impl"><span class="LIDENT">findi_and_call_impl</span></span><span class="EOL">
</span>                          <span id="local_t_89"><span class="LIDENT">t</span></span><span class="EOL">
</span>                          <span class="TILDE">~</span><span id="local_compare_90"><span class="LIDENT">compare</span></span><span class="EOL">
</span>                          <span id="local_k_91"><span class="LIDENT">k</span></span><span class="EOL">
</span>                          <span id="local_arg1_92"><span class="LIDENT">arg1</span></span><span class="EOL">
</span>                          <span id="local_arg2_93"><span class="LIDENT">arg2</span></span><span class="EOL">
</span>                          <span class="TILDE">~</span><span id="local_call_if_found_94"><span class="LIDENT">call_if_found</span></span><span class="EOL">
</span>                          <span class="TILDE">~</span><span id="local_call_if_not_found_95"><span class="LIDENT">call_if_not_found</span></span><span class="EOL">
</span>                          <span class="TILDE">~</span><span id="local_if_found_96"><span class="LIDENT">if_found</span></span><span class="EOL">
</span>                          <span class="TILDE">~</span><span id="local_if_not_found_97"><span class="LIDENT">if_not_found</span></span><span class="EOL">
</span>  <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_89"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_call_if_not_found_95"><span class="LIDENT">call_if_not_found</span></a> <span class="TILDE">~</span><a href="#local_if_not_found_97"><span class="LIDENT">if_not_found</span></a> <a href="#local_k_91"><span class="LIDENT">k</span></a> <a href="#local_arg1_92"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_93"><span class="LIDENT">arg2</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k'_98"><span class="LIDENT">k'</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_99"><span class="LIDENT">v</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_compare_90"><span class="LIDENT">compare</span></a> <a href="#local_k_91"><span class="LIDENT">k</span></a> <a href="#local_k'_98"><span class="LIDENT">k'</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_call_if_found_94"><span class="LIDENT">call_if_found</span></a> <span class="TILDE">~</span><a href="#local_if_found_96"><span class="LIDENT">if_found</span></a> <span class="LABEL">~key:</span><a href="#local_k'_98"><span class="LIDENT">k'</span></a> <span class="LABEL">~data:</span><a href="#local_v_99"><span class="LIDENT">v</span></a> <a href="#local_arg1_92"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_93"><span class="LIDENT">arg2</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_call_if_not_found_95"><span class="LIDENT">call_if_not_found</span></a> <span class="TILDE">~</span><a href="#local_if_not_found_97"><span class="LIDENT">if_not_found</span></a> <a href="#local_k_91"><span class="LIDENT">k</span></a> <a href="#local_arg1_92"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_93"><span class="LIDENT">arg2</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_100"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k'_101"><span class="LIDENT">k'</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_102"><span class="LIDENT">v</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_103"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_104"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_compare_90"><span class="LIDENT">compare</span></a> <a href="#local_k_91"><span class="LIDENT">k</span></a> <a href="#local_k'_101"><span class="LIDENT">k'</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_c_104"><span class="LIDENT">c</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_call_if_found_94"><span class="LIDENT">call_if_found</span></a> <span class="TILDE">~</span><a href="#local_if_found_96"><span class="LIDENT">if_found</span></a> <span class="LABEL">~key:</span><a href="#local_k'_101"><span class="LIDENT">k'</span></a> <span class="LABEL">~data:</span><a href="#local_v_102"><span class="LIDENT">v</span></a> <a href="#local_arg1_92"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_93"><span class="LIDENT">arg2</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_c_104"><span class="LIDENT">c</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_left_100"><span class="LIDENT">left</span></a> <span class="ELSE">else</span> <a href="#local_right_103"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="TILDE">~</span><a href="#local_compare_90"><span class="LIDENT">compare</span></a><span class="EOL">
</span>        <a href="#local_k_91"><span class="LIDENT">k</span></a><span class="EOL">
</span>        <a href="#local_arg1_92"><span class="LIDENT">arg1</span></a><span class="EOL">
</span>        <a href="#local_arg2_93"><span class="LIDENT">arg2</span></a><span class="EOL">
</span>        <span class="TILDE">~</span><a href="#local_call_if_found_94"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>        <span class="TILDE">~</span><a href="#local_call_if_not_found_95"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>        <span class="TILDE">~</span><a href="#local_if_found_96"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>        <span class="TILDE">~</span><a href="#local_if_not_found_97"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_and_call"><span class="LIDENT">find_and_call</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_found_105"><span class="LIDENT">call_if_found</span></span> <span class="TILDE">~</span><span id="local_if_found_106"><span class="LIDENT">if_found</span></span> <span class="LABEL">~key:</span><span class="UNDERSCORE">_</span> <span class="TILDE">~</span><span id="local_data_107"><span class="LIDENT">data</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_found_106"><span class="LIDENT">if_found</span></a> <a href="#local_data_107"><span class="LIDENT">data</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_not_found_108"><span class="LIDENT">call_if_not_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_109"><span class="LIDENT">if_not_found</span></span> <span id="local_key_110"><span class="LIDENT">key</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_not_found_109"><span class="LIDENT">if_not_found</span></a> <a href="#local_key_110"><span class="LIDENT">key</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_111"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_112"><span class="LIDENT">compare</span></span> <span id="local_k_113"><span class="LIDENT">k</span></span> <span class="TILDE">~</span><span id="local_if_found_114"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_115"><span class="LIDENT">if_not_found</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>      <a href="#local_t_111"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_compare_112"><span class="LIDENT">compare</span></a><span class="EOL">
</span>      <a href="#local_k_113"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_found_105"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_not_found_108"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_found_114"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_not_found_115"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-findi_and_call"><span class="LIDENT">findi_and_call</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_found_116"><span class="LIDENT">call_if_found</span></span> <span class="TILDE">~</span><span id="local_if_found_117"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_key_118"><span class="LIDENT">key</span></span> <span class="TILDE">~</span><span id="local_data_119"><span class="LIDENT">data</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_found_117"><span class="LIDENT">if_found</span></a> <span class="TILDE">~</span><a href="#local_key_118"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_119"><span class="LIDENT">data</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_not_found_120"><span class="LIDENT">call_if_not_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_121"><span class="LIDENT">if_not_found</span></span> <span id="local_key_122"><span class="LIDENT">key</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_not_found_121"><span class="LIDENT">if_not_found</span></a> <a href="#local_key_122"><span class="LIDENT">key</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_123"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_124"><span class="LIDENT">compare</span></span> <span id="local_k_125"><span class="LIDENT">k</span></span> <span class="TILDE">~</span><span id="local_if_found_126"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_127"><span class="LIDENT">if_not_found</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>      <a href="#local_t_123"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_compare_124"><span class="LIDENT">compare</span></a><span class="EOL">
</span>      <a href="#local_k_125"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_found_116"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_not_found_120"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_found_126"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_not_found_127"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_and_call1"><span class="LIDENT">find_and_call1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_found_128"><span class="LIDENT">call_if_found</span></span> <span class="TILDE">~</span><span id="local_if_found_129"><span class="LIDENT">if_found</span></span> <span class="LABEL">~key:</span><span class="UNDERSCORE">_</span> <span class="TILDE">~</span><span id="local_data_130"><span class="LIDENT">data</span></span> <span id="local_arg_131"><span class="LIDENT">arg</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_found_129"><span class="LIDENT">if_found</span></a> <a href="#local_data_130"><span class="LIDENT">data</span></a> <a href="#local_arg_131"><span class="LIDENT">arg</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_not_found_132"><span class="LIDENT">call_if_not_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_133"><span class="LIDENT">if_not_found</span></span> <span id="local_key_134"><span class="LIDENT">key</span></span> <span id="local_arg_135"><span class="LIDENT">arg</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_not_found_133"><span class="LIDENT">if_not_found</span></a> <a href="#local_key_134"><span class="LIDENT">key</span></a> <a href="#local_arg_135"><span class="LIDENT">arg</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_136"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_137"><span class="LIDENT">compare</span></span> <span id="local_k_138"><span class="LIDENT">k</span></span> <span class="TILDE">~</span><span id="local_a_139"><span class="LIDENT">a</span></span> <span class="TILDE">~</span><span id="local_if_found_140"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_141"><span class="LIDENT">if_not_found</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>      <a href="#local_t_136"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_compare_137"><span class="LIDENT">compare</span></a><span class="EOL">
</span>      <a href="#local_k_138"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <a href="#local_a_139"><span class="LIDENT">a</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_found_128"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_not_found_132"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_found_140"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_not_found_141"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-findi_and_call1"><span class="LIDENT">findi_and_call1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_found_142"><span class="LIDENT">call_if_found</span></span> <span class="TILDE">~</span><span id="local_if_found_143"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_key_144"><span class="LIDENT">key</span></span> <span class="TILDE">~</span><span id="local_data_145"><span class="LIDENT">data</span></span> <span id="local_arg_146"><span class="LIDENT">arg</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_found_143"><span class="LIDENT">if_found</span></a> <span class="TILDE">~</span><a href="#local_key_144"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_145"><span class="LIDENT">data</span></a> <a href="#local_arg_146"><span class="LIDENT">arg</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_not_found_147"><span class="LIDENT">call_if_not_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_148"><span class="LIDENT">if_not_found</span></span> <span id="local_key_149"><span class="LIDENT">key</span></span> <span id="local_arg_150"><span class="LIDENT">arg</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_if_not_found_148"><span class="LIDENT">if_not_found</span></a> <a href="#local_key_149"><span class="LIDENT">key</span></a> <a href="#local_arg_150"><span class="LIDENT">arg</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_151"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_152"><span class="LIDENT">compare</span></span> <span id="local_k_153"><span class="LIDENT">k</span></span> <span class="TILDE">~</span><span id="local_a_154"><span class="LIDENT">a</span></span> <span class="TILDE">~</span><span id="local_if_found_155"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_156"><span class="LIDENT">if_not_found</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>      <a href="#local_t_151"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_compare_152"><span class="LIDENT">compare</span></a><span class="EOL">
</span>      <a href="#local_k_153"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <a href="#local_a_154"><span class="LIDENT">a</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_found_142"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_not_found_147"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_found_155"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_not_found_156"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_and_call2"><span class="LIDENT">find_and_call2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_found_157"><span class="LIDENT">call_if_found</span></span> <span class="TILDE">~</span><span id="local_if_found_158"><span class="LIDENT">if_found</span></span> <span class="LABEL">~key:</span><span class="UNDERSCORE">_</span> <span class="TILDE">~</span><span id="local_data_159"><span class="LIDENT">data</span></span> <span id="local_arg1_160"><span class="LIDENT">arg1</span></span> <span id="local_arg2_161"><span class="LIDENT">arg2</span></span> <span class="EQUAL">=</span> <a href="#local_if_found_158"><span class="LIDENT">if_found</span></a> <a href="#local_data_159"><span class="LIDENT">data</span></a> <a href="#local_arg1_160"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_161"><span class="LIDENT">arg2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_not_found_162"><span class="LIDENT">call_if_not_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_163"><span class="LIDENT">if_not_found</span></span> <span id="local_key_164"><span class="LIDENT">key</span></span> <span id="local_arg1_165"><span class="LIDENT">arg1</span></span> <span id="local_arg2_166"><span class="LIDENT">arg2</span></span> <span class="EQUAL">=</span> <a href="#local_if_not_found_163"><span class="LIDENT">if_not_found</span></a> <a href="#local_key_164"><span class="LIDENT">key</span></a> <a href="#local_arg1_165"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_166"><span class="LIDENT">arg2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_167"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_168"><span class="LIDENT">compare</span></span> <span id="local_k_169"><span class="LIDENT">k</span></span> <span class="TILDE">~</span><span id="local_a_170"><span class="LIDENT">a</span></span> <span class="TILDE">~</span><span id="local_b_171"><span class="LIDENT">b</span></span> <span class="TILDE">~</span><span id="local_if_found_172"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_173"><span class="LIDENT">if_not_found</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>      <a href="#local_t_167"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_compare_168"><span class="LIDENT">compare</span></a><span class="EOL">
</span>      <a href="#local_k_169"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <a href="#local_a_170"><span class="LIDENT">a</span></a><span class="EOL">
</span>      <a href="#local_b_171"><span class="LIDENT">b</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_found_157"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_not_found_162"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_found_172"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_not_found_173"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-findi_and_call2"><span class="LIDENT">findi_and_call2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_found_174"><span class="LIDENT">call_if_found</span></span> <span class="TILDE">~</span><span id="local_if_found_175"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_key_176"><span class="LIDENT">key</span></span> <span class="TILDE">~</span><span id="local_data_177"><span class="LIDENT">data</span></span> <span id="local_arg1_178"><span class="LIDENT">arg1</span></span> <span id="local_arg2_179"><span class="LIDENT">arg2</span></span> <span class="EQUAL">=</span> <a href="#local_if_found_175"><span class="LIDENT">if_found</span></a> <span class="TILDE">~</span><a href="#local_key_176"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_177"><span class="LIDENT">data</span></a> <a href="#local_arg1_178"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_179"><span class="LIDENT">arg2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_call_if_not_found_180"><span class="LIDENT">call_if_not_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_181"><span class="LIDENT">if_not_found</span></span> <span id="local_key_182"><span class="LIDENT">key</span></span> <span id="local_arg1_183"><span class="LIDENT">arg1</span></span> <span id="local_arg2_184"><span class="LIDENT">arg2</span></span> <span class="EQUAL">=</span> <a href="#local_if_not_found_181"><span class="LIDENT">if_not_found</span></a> <a href="#local_key_182"><span class="LIDENT">key</span></a> <a href="#local_arg1_183"><span class="LIDENT">arg1</span></a> <a href="#local_arg2_184"><span class="LIDENT">arg2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_185"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_186"><span class="LIDENT">compare</span></span> <span id="local_k_187"><span class="LIDENT">k</span></span> <span class="TILDE">~</span><span id="local_a_188"><span class="LIDENT">a</span></span> <span class="TILDE">~</span><span id="local_b_189"><span class="LIDENT">b</span></span> <span class="TILDE">~</span><span id="local_if_found_190"><span class="LIDENT">if_found</span></span> <span class="TILDE">~</span><span id="local_if_not_found_191"><span class="LIDENT">if_not_found</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">findi_and_call_impl</span><span class="EOL">
</span>      <a href="#local_t_185"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_compare_186"><span class="LIDENT">compare</span></a><span class="EOL">
</span>      <a href="#local_k_187"><span class="LIDENT">k</span></a><span class="EOL">
</span>      <a href="#local_a_188"><span class="LIDENT">a</span></a><span class="EOL">
</span>      <a href="#local_b_189"><span class="LIDENT">b</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_found_174"><span class="LIDENT">call_if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_call_if_not_found_180"><span class="LIDENT">call_if_not_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_found_190"><span class="LIDENT">if_found</span></a><span class="EOL">
</span>      <span class="TILDE">~</span><a href="#local_if_not_found_191"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find"><span class="LIDENT">find</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_if_found_192"><span class="LIDENT">if_found</span></span> <span id="local_v_193"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Some</span> <a href="#local_v_193"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_if_not_found_194"><span class="LIDENT">if_not_found</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">None</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_195"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_196"><span class="LIDENT">compare</span></span> <span id="local_k_197"><span class="LIDENT">k</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">find_and_call</span> <a href="#local_t_195"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_compare_196"><span class="LIDENT">compare</span></a> <a href="#local_k_197"><span class="LIDENT">k</span></a> <span class="TILDE">~</span><a href="#local_if_found_192"><span class="LIDENT">if_found</span></a> <span class="TILDE">~</span><a href="#local_if_not_found_194"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mem"><span class="LIDENT">mem</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_if_found_198"><span class="LIDENT">if_found</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_if_not_found_199"><span class="LIDENT">if_not_found</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_200"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_compare_201"><span class="LIDENT">compare</span></span> <span id="local_k_202"><span class="LIDENT">k</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">find_and_call</span> <a href="#local_t_200"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_compare_201"><span class="LIDENT">compare</span></a> <a href="#local_k_202"><span class="LIDENT">k</span></a> <span class="TILDE">~</span><a href="#local_if_found_198"><span class="LIDENT">if_found</span></a> <span class="TILDE">~</span><a href="#local_if_not_found_199"><span class="LIDENT">if_not_found</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-remove"><span class="LIDENT">remove</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_min_elt_203"><span class="LIDENT">min_elt</span></span> <span id="local_tree_204"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_tree_204"><span class="LIDENT">tree</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Empty</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_tree_204"><span class="LIDENT">tree</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_tree_204"><span class="LIDENT">tree</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_205"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_min_elt_203"><span class="LIDENT">min_elt</span></a> <a href="#local_left_205"><span class="LIDENT">left</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_remove_min_elt_206"><span class="LIDENT">remove_min_elt</span></span> <span id="local_tree_207"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_tree_207"><span class="LIDENT">tree</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Empty</span> <span class="COMMENT">(* This must be the root *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_208"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_right_208"><span class="LIDENT">right</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_209"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_210"><span class="LIDENT">v</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <a href="#local_k_209"><span class="LIDENT">k</span></a><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <a href="#local_v_210"><span class="LIDENT">v</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_node_211"><span class="LIDENT">node</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">set_left</span> <a href="#local_node_211"><span class="LIDENT">node</span></a> <span class="UIDENT">Empty</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_tree_207"><span class="LIDENT">tree</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_213"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_node_212"><span class="LIDENT">node</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">set_left</span> <a href="#local_node_212"><span class="LIDENT">node</span></a> <span class="LPAREN">(</span><a href="#local_remove_min_elt_206"><span class="LIDENT">remove_min_elt</span></a> <a href="#local_left_213"><span class="LIDENT">left</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_tree_207"><span class="LIDENT">tree</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_merge_214"><span class="LIDENT">merge</span></span> <span id="local_t1_215"><span class="LIDENT">t1</span></span> <span id="local_t2_216"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_t1_215"><span class="LIDENT">t1</span></a><span class="COMMA">,</span> <a href="#local_t2_216"><span class="LIDENT">t2</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span><span class="COMMA">,</span> <span id="local_t_217"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_t_217"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_t_218"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_t_218"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_tree_219"><span class="LIDENT">tree</span></span> <span class="EQUAL">=</span> <a href="#local_min_elt_203"><span class="LIDENT">min_elt</span></a> <a href="#local_t2_216"><span class="LIDENT">t2</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_tree_219"><span class="LIDENT">tree</span></a> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k_220"><span class="LIDENT">k</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_v_221"><span class="LIDENT">v</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LET">let</span> <span id="local_t2_222"><span class="LIDENT">t2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">balance</span> <span class="LPAREN">(</span><a href="#local_remove_min_elt_206"><span class="LIDENT">remove_min_elt</span></a> <a href="#local_t2_216"><span class="LIDENT">t2</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>         <span class="UIDENT">Node</span><span class="EOL">
</span>           <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <a href="#local_t1_215"><span class="LIDENT">t1</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <a href="#local_k_220"><span class="LIDENT">k</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <a href="#local_v_221"><span class="LIDENT">v</span></a><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">max</span> <span class="LPAREN">(</span><span class="LIDENT">height</span> <a href="#local_t1_215"><span class="LIDENT">t1</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">height</span> <a href="#local_t2_222"><span class="LIDENT">t2</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>           <span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <a href="#local_t2_222"><span class="LIDENT">t2</span></a><span class="EOL">
</span>           <span class="RBRACE">}</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_node_223"><span class="LIDENT">node</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LIDENT">set_right</span> <a href="#local_node_223"><span class="LIDENT">node</span></a> <span class="LPAREN">(</span><a href="#local_remove_min_elt_206"><span class="LIDENT">remove_min_elt</span></a> <a href="#local_t2_216"><span class="LIDENT">t2</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>         <span class="LIDENT">set_left</span> <a href="#local_node_223"><span class="LIDENT">node</span></a> <a href="#local_t1_215"><span class="LIDENT">t1</span></a><span class="SEMI">;</span><span class="EOL">
</span>         <a href="#local_node_223"><span class="LIDENT">node</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_remove_224"><span class="LIDENT">remove</span></span> <span id="local_t_225"><span class="LIDENT">t</span></span> <span id="local_removed_226"><span class="LIDENT">removed</span></span> <span id="local_compare_227"><span class="LIDENT">compare</span></span> <span id="local_k_228"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_t_225"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_removed_226"><span class="LIDENT">removed</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">Empty</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k'_229"><span class="LIDENT">k'</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_compare_227"><span class="LIDENT">compare</span></a> <a href="#local_k_228"><span class="LIDENT">k</span></a> <a href="#local_k'_229"><span class="LIDENT">k'</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_removed_226"><span class="LIDENT">removed</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="UIDENT">Empty</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_removed_226"><span class="LIDENT">removed</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_t_225"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_230"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_k'_231"><span class="LIDENT">k'</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_232"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_233"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_compare_227"><span class="LIDENT">compare</span></a> <a href="#local_k_228"><span class="LIDENT">k</span></a> <a href="#local_k'_231"><span class="LIDENT">k'</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_c_233"><span class="LIDENT">c</span></a> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="#local_removed_226"><span class="LIDENT">removed</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_merge_214"><span class="LIDENT">merge</span></a> <a href="#local_left_230"><span class="LIDENT">left</span></a> <a href="#local_right_232"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_c_233"><span class="LIDENT">c</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">set_left</span> <a href="#local_t_225"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="#local_remove_224"><span class="LIDENT">remove</span></a> <a href="#local_left_230"><span class="LIDENT">left</span></a> <a href="#local_removed_226"><span class="LIDENT">removed</span></a> <a href="#local_compare_227"><span class="LIDENT">compare</span></a> <a href="#local_k_228"><span class="LIDENT">k</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_t_225"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LIDENT">set_right</span> <a href="#local_t_225"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><a href="#local_remove_224"><span class="LIDENT">remove</span></a> <a href="#local_right_232"><span class="LIDENT">right</span></a> <a href="#local_removed_226"><span class="LIDENT">removed</span></a> <a href="#local_compare_227"><span class="LIDENT">compare</span></a> <a href="#local_k_228"><span class="LIDENT">k</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_t_225"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_t_234"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_removed_235"><span class="LIDENT">removed</span></span> <span class="TILDE">~</span><span id="local_compare_236"><span class="LIDENT">compare</span></span> <span id="local_k_237"><span class="LIDENT">k</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">balance</span> <span class="LPAREN">(</span><a href="#local_remove_224"><span class="LIDENT">remove</span></a> <a href="#local_t_234"><span class="LIDENT">t</span></a> <a href="#local_removed_235"><span class="LIDENT">removed</span></a> <a href="#local_compare_236"><span class="LIDENT">compare</span></a> <a href="#local_k_237"><span class="LIDENT">k</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-fold"><span class="LIDENT">fold</span></span> <span id="local_t_238"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_init_239"><span class="LIDENT">init</span></span> <span class="TILDE">~</span><span id="local_f_240"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_238"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_init_239"><span class="LIDENT">init</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span id="local_key_241"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_242"><span class="LIDENT">data</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_241"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_242"><span class="LIDENT">data</span></a> <a href="#local_init_239"><span class="LIDENT">init</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_lkey_243"><span class="LIDENT">lkey</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_ldata_244"><span class="LIDENT">ldata</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span id="local_key_245"><span class="LIDENT">key</span></span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_246"><span class="LIDENT">data</span></span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_rkey_247"><span class="LIDENT">rkey</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_rdata_248"><span class="LIDENT">rdata</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="LABEL">~key:</span><a href="#local_rkey_247"><span class="LIDENT">rkey</span></a> <span class="LABEL">~data:</span><a href="#local_rdata_248"><span class="LIDENT">rdata</span></a> <span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_245"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_246"><span class="LIDENT">data</span></a> <span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="LABEL">~key:</span><a href="#local_lkey_243"><span class="LIDENT">lkey</span></a> <span class="LABEL">~data:</span><a href="#local_ldata_244"><span class="LIDENT">ldata</span></a> <a href="#local_init_239"><span class="LIDENT">init</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_lkey_249"><span class="LIDENT">lkey</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_ldata_250"><span class="LIDENT">ldata</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span id="local_key_251"><span class="LIDENT">key</span></span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_252"><span class="LIDENT">data</span></span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="EOL">
</span>      <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_251"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_252"><span class="LIDENT">data</span></a> <span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="LABEL">~key:</span><a href="#local_lkey_249"><span class="LIDENT">lkey</span></a> <span class="LABEL">~data:</span><a href="#local_ldata_250"><span class="LIDENT">ldata</span></a> <a href="#local_init_239"><span class="LIDENT">init</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Empty</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span id="local_key_253"><span class="LIDENT">key</span></span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_254"><span class="LIDENT">data</span></span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="EOL">
</span>      <span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_rkey_255"><span class="LIDENT">rkey</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_rdata_256"><span class="LIDENT">rdata</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="LABEL">~key:</span><a href="#local_rkey_255"><span class="LIDENT">rkey</span></a> <span class="LABEL">~data:</span><a href="#local_rdata_256"><span class="LIDENT">rdata</span></a> <span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_253"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_254"><span class="LIDENT">data</span></a> <a href="#local_init_239"><span class="LIDENT">init</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span id="local_left_257"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span id="local_key_258"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_259"><span class="LIDENT">data</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_rkey_260"><span class="LIDENT">rkey</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_rdata_261"><span class="LIDENT">rdata</span></span> <span class="RBRACE">}</span> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="LABEL">~key:</span><a href="#local_rkey_260"><span class="LIDENT">rkey</span></a> <span class="LABEL">~data:</span><a href="#local_rdata_261"><span class="LIDENT">rdata</span></a> <span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_258"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_259"><span class="LIDENT">data</span></a> <span class="LPAREN">(</span><span class="LIDENT">fold</span> <a href="#local_left_257"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_init_239"><span class="LIDENT">init</span></a> <span class="TILDE">~</span><a href="#local_f_240"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span class="LIDENT">key</span> <span class="EQUAL">=</span> <span id="local_lkey_262"><span class="LIDENT">lkey</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_ldata_263"><span class="LIDENT">ldata</span></span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span id="local_key_264"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_265"><span class="LIDENT">data</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_266"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fold</span> <a href="#local_right_266"><span class="LIDENT">right</span></a> <span class="LABEL">~init:</span><span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_264"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_265"><span class="LIDENT">data</span></a> <span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="LABEL">~key:</span><a href="#local_lkey_262"><span class="LIDENT">lkey</span></a> <span class="LABEL">~data:</span><a href="#local_ldata_263"><span class="LIDENT">ldata</span></a> <a href="#local_init_239"><span class="LIDENT">init</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_f_240"><span class="LIDENT">f</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_267"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span id="local_key_268"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_269"><span class="LIDENT">data</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_270"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">fold</span> <a href="#local_right_270"><span class="LIDENT">right</span></a> <span class="LABEL">~init:</span><span class="LPAREN">(</span><a href="#local_f_240"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_268"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_269"><span class="LIDENT">data</span></a> <span class="LPAREN">(</span><span class="LIDENT">fold</span> <a href="#local_left_267"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_init_239"><span class="LIDENT">init</span></a> <span class="TILDE">~</span><a href="#local_f_240"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_f_240"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-iter"><span class="LIDENT">iter</span></span> <span id="local_t_271"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_272"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_271"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span id="local_key_273"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_274"><span class="LIDENT">data</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_272"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_273"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_274"><span class="LIDENT">data</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_left_275"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span id="local_key_276"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span class="LIDENT">value</span> <span class="EQUAL">=</span> <span id="local_data_277"><span class="LIDENT">data</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_278"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">iter</span> <a href="#local_left_275"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_f_272"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_f_272"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_276"><span class="LIDENT">key</span></a> <span class="TILDE">~</span><a href="#local_data_277"><span class="LIDENT">data</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">iter</span> <a href="#local_right_278"><span class="LIDENT">right</span></a> <span class="TILDE">~</span><a href="#local_f_272"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-mapi_inplace"><span class="LIDENT">mapi_inplace</span></span> <span id="local_t_279"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_f_280"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_279"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_key_282"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span id="local_value_283"><span class="LIDENT">value</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_t_281"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_t_281"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">value</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_f_280"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_282"><span class="LIDENT">key</span></a> <span class="LABEL">~data:</span><a href="#local_value_283"><span class="LIDENT">value</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_left_285"><span class="LIDENT">left</span></span><span class="SEMI">;</span> <span id="local_key_286"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span id="local_value_287"><span class="LIDENT">value</span></span><span class="SEMI">;</span> <span class="LIDENT">height</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span><span class="SEMI">;</span> <span id="local_right_288"><span class="LIDENT">right</span></span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_t_284"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">mapi_inplace</span> <span class="TILDE">~</span><a href="#local_f_280"><span class="LIDENT">f</span></a> <a href="#local_left_285"><span class="LIDENT">left</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_t_284"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">value</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_f_280"><span class="LIDENT">f</span></a> <span class="TILDE">~</span><a href="#local_key_286"><span class="LIDENT">key</span></a> <span class="LABEL">~data:</span><a href="#local_value_287"><span class="LIDENT">value</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">mapi_inplace</span> <span class="TILDE">~</span><a href="#local_f_280"><span class="LIDENT">f</span></a> <a href="#local_right_288"><span class="LIDENT">right</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-choose_exn"><span class="LIDENT">choose_exn</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">raise_s</span> <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp.ml.html#val-message"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">message</span></a> <span class="STRING">&quot;[Avltree.choose_exn] of empty hashtbl&quot;</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Leaf</span> <span class="LBRACE">{</span> <span id="local_key_289"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span id="local_value_290"><span class="LIDENT">value</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="BAR">|</span> <span class="UIDENT">Node</span> <span class="LBRACE">{</span> <span id="local_key_291"><span class="LIDENT">key</span></span><span class="SEMI">;</span> <span id="local_value_292"><span class="LIDENT">value</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_key_291"><span class="LIDENT">key</span></a><span class="COMMA">,</span> <a href="#local_value_292"><span class="LIDENT">value</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span></span></code></pre></body></html>
