<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: float.ml (base.src.base)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">Base</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; base &#x00BB; float.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>float.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">Base</a><ul><li>Library <code>base</code><ul><li><a href="../../base/Base/index.html">Base</a></li></ul></li><li>Library <code>base.base_internalhash_types</code><ul><li><a href="../../base.base_internalhash_types/Base_internalhash_types/index.html">Base_internalhash_types</a></li></ul></li><li>Library <code>base.caml</code><ul><li><a href="../../base.caml/Caml/index.html">Caml</a></li></ul></li><li>Library <code>base.md5</code><ul><li><a href="../../base.md5/Md5_lib/index.html">Md5_lib</a></li></ul></li><li>Library <code>base.shadow_stdlib</code><ul><li><a href="../../base.shadow_stdlib/Shadow_stdlib/index.html">Shadow_stdlib</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>base<ul><li><a href="applicative.ml.html">applicative.ml</a></li><li><a href="applicative_intf.ml.html">applicative_intf.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="array0.ml.html">array0.ml</a></li><li><a href="array_permute.ml.html">array_permute.ml</a></li><li><a href="avltree.ml.html">avltree.ml</a></li><li><a href="backtrace.ml.html">backtrace.ml</a></li><li><a href="base.ml.html">base.ml</a></li><li><a href="base__.ml.html">base__.ml</a></li><li><a href="binary_search.ml.html">binary_search.ml</a></li><li><a href="binary_searchable.ml.html">binary_searchable.ml</a></li><li><a href="binary_searchable_intf.ml.html">binary_searchable_intf.ml</a></li><li><a href="blit.ml.html">blit.ml</a></li><li><a href="blit_intf.ml.html">blit_intf.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="bool0.ml.html">bool0.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="buffer_intf.ml.html">buffer_intf.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytes0.ml.html">bytes0.ml</a></li><li><a href="bytes_tr.ml.html">bytes_tr.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="char0.ml.html">char0.ml</a></li><li><a href="comparable.ml.html">comparable.ml</a></li><li><a href="comparable_intf.ml.html">comparable_intf.ml</a></li><li><a href="comparator.ml.html">comparator.ml</a></li><li><a href="comparisons.ml.html">comparisons.ml</a></li><li><a href="container.ml.html">container.ml</a></li><li><a href="container_intf.ml.html">container_intf.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="either0.ml.html">either0.ml</a></li><li><a href="either_intf.ml.html">either_intf.ml</a></li><li><a href="equal.ml.html">equal.ml</a></li><li><a href="error.ml.html">error.ml</a></li><li><a href="exn.ml.html">exn.ml</a></li><li><a href="field.ml.html">field.ml</a></li><li><a href="fieldslib.ml.html">fieldslib.ml</a></li><li><a href="#" class="current_unit">float.ml</a></li><li><a href="float0.ml.html">float0.ml</a></li><li><a href="floatable.ml.html">floatable.ml</a></li><li><a href="fn.ml.html">fn.ml</a></li><li><a href="formatter.ml.html">formatter.ml</a></li><li><a href="globalize.ml.html">globalize.ml</a></li><li><a href="hash.ml.html">hash.ml</a></li><li><a href="hash_intf.ml.html">hash_intf.ml</a></li><li><a href="hash_set.ml.html">hash_set.ml</a></li><li><a href="hash_set_intf.ml.html">hash_set_intf.ml</a></li><li><a href="hashable.ml.html">hashable.ml</a></li><li><a href="hashable_intf.ml.html">hashable_intf.ml</a></li><li><a href="hasher.ml.html">hasher.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="hashtbl_intf.ml.html">hashtbl_intf.ml</a></li><li><a href="hex_lexer.ml.html">hex_lexer.ml</a></li><li><a href="identifiable.ml.html">identifiable.ml</a></li><li><a href="identifiable_intf.ml.html">identifiable_intf.ml</a></li><li><a href="import.ml.html">import.ml</a></li><li><a href="import0.ml.html">import0.ml</a></li><li><a href="indexed_container.ml.html">indexed_container.ml</a></li><li><a href="indexed_container_intf.ml.html">indexed_container_intf.ml</a></li><li><a href="info.ml.html">info.ml</a></li><li><a href="info_intf.ml.html">info_intf.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int0.ml.html">int0.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int63.ml.html">int63.ml</a></li><li><a href="int63_emul.ml.html">int63_emul.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="int_conversions.ml.html">int_conversions.ml</a></li><li><a href="int_intf.ml.html">int_intf.ml</a></li><li><a href="int_math.ml.html">int_math.ml</a></li><li><a href="intable.ml.html">intable.ml</a></li><li><a href="invariant.ml.html">invariant.ml</a></li><li><a href="invariant_intf.ml.html">invariant_intf.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="linked_queue.ml.html">linked_queue.ml</a></li><li><a href="linked_queue0.ml.html">linked_queue0.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="list0.ml.html">list0.ml</a></li><li><a href="list1.ml.html">list1.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="map_intf.ml.html">map_intf.ml</a></li><li><a href="maybe_bound.ml.html">maybe_bound.ml</a></li><li><a href="monad.ml.html">monad.ml</a></li><li><a href="monad_intf.ml.html">monad_intf.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="nothing.ml.html">nothing.ml</a></li><li><a href="obj_array.ml.html">obj_array.ml</a></li><li><a href="obj_local.ml.html">obj_local.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="option_array.ml.html">option_array.ml</a></li><li><a href="or_error.ml.html">or_error.ml</a></li><li><a href="ordered_collection_common.ml.html">ordered_collection_common.ml</a></li><li><a href="ordered_collection_common0.ml.html">ordered_collection_common0.ml</a></li><li><a href="ordering.ml.html">ordering.ml</a></li><li><a href="poly0.ml.html">poly0.ml</a></li><li><a href="popcount.ml.html">popcount.ml</a></li><li><a href="pow_overflow_bounds.ml.html">pow_overflow_bounds.ml</a></li><li><a href="ppx_compare_lib.ml.html">ppx_compare_lib.ml</a></li><li><a href="ppx_enumerate_lib.ml.html">ppx_enumerate_lib.ml</a></li><li><a href="ppx_hash_lib.ml.html">ppx_hash_lib.ml</a></li><li><a href="pretty_printer.ml.html">pretty_printer.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="queue_intf.ml.html">queue_intf.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="random_repr.ml.html">random_repr.ml</a></li><li><a href="ref.ml.html">ref.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="sequence.ml.html">sequence.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="set_intf.ml.html">set_intf.ml</a></li><li><a href="sexp.ml.html">sexp.ml</a></li><li><a href="sexp_with_comparable.ml.html">sexp_with_comparable.ml</a></li><li><a href="sexpable.ml.html">sexpable.ml</a></li><li><a href="sign.ml.html">sign.ml</a></li><li><a href="sign0.ml.html">sign0.ml</a></li><li><a href="sign_or_nan.ml.html">sign_or_nan.ml</a></li><li><a href="source_code_position.ml.html">source_code_position.ml</a></li><li><a href="source_code_position0.ml.html">source_code_position0.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stack_intf.ml.html">stack_intf.ml</a></li><li><a href="staged.ml.html">staged.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="string0.ml.html">string0.ml</a></li><li><a href="stringable.ml.html">stringable.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="sys0.ml.html">sys0.ml</a></li><li><a href="t.ml.html">t.ml</a></li><li><a href="type_equal.ml.html">type_equal.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="uchar0.ml.html">uchar0.ml</a></li><li><a href="uniform_array.ml.html">uniform_array.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="variant.ml.html">variant.ml</a></li><li><a href="variantslib.ml.html">variantslib.ml</a></li><li><a href="with_return.ml.html">with_return.ml</a></li><li><a href="word_size.ml.html">word_size.ml</a></li></ul></li><li>base.base_internalhash_types<ul><li><a href="../base.base_internalhash_types/base_internalhash_types.ml.html">base_internalhash_types.ml</a></li></ul></li><li>base.caml<ul><li><a href="../base.caml/caml.ml.html">caml.ml</a></li></ul></li><li>base.md5<ul><li><a href="../base.md5/md5_lib.ml.html">md5_lib.ml</a></li></ul></li><li>base.shadow_stdlib<ul><li><a href="../base.shadow_stdlib/shadow_stdlib.ml.html">shadow_stdlib.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
<a id="L948" class="source_line" href="#L948">948</a>
<a id="L949" class="source_line" href="#L949">949</a>
<a id="L950" class="source_line" href="#L950">950</a>
<a id="L951" class="source_line" href="#L951">951</a>
<a id="L952" class="source_line" href="#L952">952</a>
<a id="L953" class="source_line" href="#L953">953</a>
<a id="L954" class="source_line" href="#L954">954</a>
<a id="L955" class="source_line" href="#L955">955</a>
<a id="L956" class="source_line" href="#L956">956</a>
<a id="L957" class="source_line" href="#L957">957</a>
<a id="L958" class="source_line" href="#L958">958</a>
<a id="L959" class="source_line" href="#L959">959</a>
<a id="L960" class="source_line" href="#L960">960</a>
<a id="L961" class="source_line" href="#L961">961</a>
<a id="L962" class="source_line" href="#L962">962</a>
<a id="L963" class="source_line" href="#L963">963</a>
<a id="L964" class="source_line" href="#L964">964</a>
<a id="L965" class="source_line" href="#L965">965</a>
<a id="L966" class="source_line" href="#L966">966</a>
<a id="L967" class="source_line" href="#L967">967</a>
<a id="L968" class="source_line" href="#L968">968</a>
<a id="L969" class="source_line" href="#L969">969</a>
<a id="L970" class="source_line" href="#L970">970</a>
<a id="L971" class="source_line" href="#L971">971</a>
<a id="L972" class="source_line" href="#L972">972</a>
<a id="L973" class="source_line" href="#L973">973</a>
<a id="L974" class="source_line" href="#L974">974</a>
<a id="L975" class="source_line" href="#L975">975</a>
<a id="L976" class="source_line" href="#L976">976</a>
<a id="L977" class="source_line" href="#L977">977</a>
<a id="L978" class="source_line" href="#L978">978</a>
<a id="L979" class="source_line" href="#L979">979</a>
<a id="L980" class="source_line" href="#L980">980</a>
<a id="L981" class="source_line" href="#L981">981</a>
<a id="L982" class="source_line" href="#L982">982</a>
<a id="L983" class="source_line" href="#L983">983</a>
<a id="L984" class="source_line" href="#L984">984</a>
<a id="L985" class="source_line" href="#L985">985</a>
<a id="L986" class="source_line" href="#L986">986</a>
<a id="L987" class="source_line" href="#L987">987</a>
<a id="L988" class="source_line" href="#L988">988</a>
<a id="L989" class="source_line" href="#L989">989</a>
<a id="L990" class="source_line" href="#L990">990</a>
<a id="L991" class="source_line" href="#L991">991</a>
<a id="L992" class="source_line" href="#L992">992</a>
<a id="L993" class="source_line" href="#L993">993</a>
<a id="L994" class="source_line" href="#L994">994</a>
<a id="L995" class="source_line" href="#L995">995</a>
<a id="L996" class="source_line" href="#L996">996</a>
<a id="L997" class="source_line" href="#L997">997</a>
<a id="L998" class="source_line" href="#L998">998</a>
<a id="L999" class="source_line" href="#L999">999</a>
<a id="L1000" class="source_line" href="#L1000">1000</a>
<a id="L1001" class="source_line" href="#L1001">1001</a>
<a id="L1002" class="source_line" href="#L1002">1002</a>
<a id="L1003" class="source_line" href="#L1003">1003</a>
<a id="L1004" class="source_line" href="#L1004">1004</a>
<a id="L1005" class="source_line" href="#L1005">1005</a>
<a id="L1006" class="source_line" href="#L1006">1006</a>
<a id="L1007" class="source_line" href="#L1007">1007</a>
<a id="L1008" class="source_line" href="#L1008">1008</a>
<a id="L1009" class="source_line" href="#L1009">1009</a>
<a id="L1010" class="source_line" href="#L1010">1010</a>
<a id="L1011" class="source_line" href="#L1011">1011</a>
<a id="L1012" class="source_line" href="#L1012">1012</a>
<a id="L1013" class="source_line" href="#L1013">1013</a>
<a id="L1014" class="source_line" href="#L1014">1014</a>
<a id="L1015" class="source_line" href="#L1015">1015</a>
<a id="L1016" class="source_line" href="#L1016">1016</a>
<a id="L1017" class="source_line" href="#L1017">1017</a>
<a id="L1018" class="source_line" href="#L1018">1018</a>
<a id="L1019" class="source_line" href="#L1019">1019</a>
<a id="L1020" class="source_line" href="#L1020">1020</a>
<a id="L1021" class="source_line" href="#L1021">1021</a>
<a id="L1022" class="source_line" href="#L1022">1022</a>
<a id="L1023" class="source_line" href="#L1023">1023</a>
<a id="L1024" class="source_line" href="#L1024">1024</a>
<a id="L1025" class="source_line" href="#L1025">1025</a>
<a id="L1026" class="source_line" href="#L1026">1026</a>
<a id="L1027" class="source_line" href="#L1027">1027</a>
<a id="L1028" class="source_line" href="#L1028">1028</a>
<a id="L1029" class="source_line" href="#L1029">1029</a>
<a id="L1030" class="source_line" href="#L1030">1030</a>
<a id="L1031" class="source_line" href="#L1031">1031</a>
<a id="L1032" class="source_line" href="#L1032">1032</a>
<a id="L1033" class="source_line" href="#L1033">1033</a>
<a id="L1034" class="source_line" href="#L1034">1034</a>
<a id="L1035" class="source_line" href="#L1035">1035</a>
<a id="L1036" class="source_line" href="#L1036">1036</a>
<a id="L1037" class="source_line" href="#L1037">1037</a>
<a id="L1038" class="source_line" href="#L1038">1038</a>
<a id="L1039" class="source_line" href="#L1039">1039</a>
<a id="L1040" class="source_line" href="#L1040">1040</a>
<a id="L1041" class="source_line" href="#L1041">1041</a>
<a id="L1042" class="source_line" href="#L1042">1042</a>
<a id="L1043" class="source_line" href="#L1043">1043</a>
<a id="L1044" class="source_line" href="#L1044">1044</a>
<a id="L1045" class="source_line" href="#L1045">1045</a>
<a id="L1046" class="source_line" href="#L1046">1046</a>
<a id="L1047" class="source_line" href="#L1047">1047</a>
<a id="L1048" class="source_line" href="#L1048">1048</a>
<a id="L1049" class="source_line" href="#L1049">1049</a>
<a id="L1050" class="source_line" href="#L1050">1050</a>
<a id="L1051" class="source_line" href="#L1051">1051</a>
<a id="L1052" class="source_line" href="#L1052">1052</a>
<a id="L1053" class="source_line" href="#L1053">1053</a>
<a id="L1054" class="source_line" href="#L1054">1054</a>
<a id="L1055" class="source_line" href="#L1055">1055</a>
<a id="L1056" class="source_line" href="#L1056">1056</a>
</code><code class="source_code"><span><span class="OPEN">open</span><span class="BANG">!</span> <a href="import.ml.html"><span class="UIDENT">Import</span></a><span class="EOL">
</span><span class="OPEN">open</span><span class="BANG">!</span> <a href="printf.ml.html"><span class="UIDENT">Printf</span></a><span class="EOL">
</span><span id="module-Bytes"><span class="MODULE">module</span> <span class="UIDENT">Bytes</span> <span class="EQUAL">=</span> <a href="bytes0.ml.html"><span class="UIDENT">Bytes0</span></a></span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="float0.ml.html"><span class="UIDENT">Float0</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-raise_s"><span class="LIDENT">raise_s</span></span> <span class="EQUAL">=</span> <a href="error.ml.html#val-raise_s"><span class="UIDENT">Error</span><span class="DOT">.</span><span class="LIDENT">raise_s</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-T"><span class="MODULE">module</span> <span class="UIDENT">T</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-T.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">float</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">deriving_inline</span> <span class="LIDENT">hash</span><span class="COMMA">,</span> <span class="LIDENT">globalize</span><span class="COMMA">,</span> <span class="LIDENT">sexp</span><span class="COMMA">,</span> <span class="LIDENT">sexp_grammar</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span id="module-T.val-hash_fold_t"><span class="LIDENT">hash_fold_t</span></span> <span class="COLON">:</span> <a href="../base.base_internalhash_types/base_internalhash_types.ml.html#type-state"><span class="UIDENT">Ppx_hash_lib</span><span class="DOT">.</span><span class="UIDENT">Std</span><span class="DOT">.</span><span class="UIDENT">Hash</span><span class="DOT">.</span><span class="LIDENT">state</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <a href="../base.base_internalhash_types/base_internalhash_types.ml.html#type-state"><span class="UIDENT">Ppx_hash_lib</span><span class="DOT">.</span><span class="UIDENT">Std</span><span class="DOT">.</span><span class="UIDENT">Hash</span><span class="DOT">.</span><span class="LIDENT">state</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="hash.ml.html#module-Folding.val-hash_fold_float"><span class="LIDENT">hash_fold_float</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span class="LPAREN">(</span><span id="module-T.val-hash"><span class="LIDENT">hash</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <a href="../base.base_internalhash_types/base_internalhash_types.ml.html#type-hash_value"><span class="UIDENT">Ppx_hash_lib</span><span class="DOT">.</span><span class="UIDENT">Std</span><span class="DOT">.</span><span class="UIDENT">Hash</span><span class="DOT">.</span><span class="LIDENT">hash_value</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_func_1"><span class="LIDENT">func</span></span> <span class="EQUAL">=</span> <a href="hash.ml.html#module-T.module-Builtin.val-hash_float"><span class="LIDENT">hash_float</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_2"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_func_1"><span class="LIDENT">func</span></a> <a href="#local_x_2"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span id="module-T.val-globalize"><span class="LIDENT">globalize</span></span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">t</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="globalize.ml.html#val-globalize_float"><span class="LIDENT">globalize_float</span></a> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">t</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">local</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-t_of_sexp"><span class="LIDENT">t_of_sexp</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-float_of_sexp"><span class="LIDENT">float_of_sexp</span></a> <span class="COLON">:</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-sexp_of_t"><span class="LIDENT">sexp_of_t</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-sexp_of_float"><span class="LIDENT">sexp_of_float</span></a> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span id="module-T.val-t_sexp_grammar"><span class="LIDENT">t_sexp_grammar</span></span> <span class="COLON">:</span> <a href="../../../sexplib0/src/sexplib0/sexp_grammar.ml.html#type-t"><span class="LIDENT">t</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_grammar</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv_grammar.ml.html#val-float_sexp_grammar"><span class="LIDENT">float_sexp_grammar</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LBRACKETATATAT">[@@@</span><span class="END">end</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-hashable"><span class="LIDENT">hashable</span></span> <span class="COLON">:</span> <a href="hashable_intf.ml.html#module-Hashable.type-t"><span class="LIDENT">t</span> <span class="UIDENT">Hashable</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">hash</span><span class="SEMI">;</span> <span class="LIDENT">compare</span><span class="SEMI">;</span> <span class="LIDENT">sexp_of_t</span> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-T.val-compare"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-compare"><span class="UIDENT">Float_replace_polymorphic_compare</span><span class="DOT">.</span><span class="LIDENT">compare</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <span class="UIDENT">T</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="comparator.ml.html#module-Make"><span class="UIDENT">Comparator</span><span class="DOT">.</span><span class="UIDENT">Make</span></a> <span class="LPAREN">(</span><span class="UIDENT">T</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Open replace_polymorphic_compare after including functor instantiations so they do not
   shadow its definitions. This is here so that efficient versions of the comparison
   functions are available within this module. *)</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="import0.ml.html#module-Float_replace_polymorphic_compare"><span class="UIDENT">Float_replace_polymorphic_compare</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-invariant"><span class="LIDENT">invariant</span></span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span> <span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_float"><span class="LIDENT">to_float</span></span> <span id="local_x_3"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_x_3"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_float"><span class="LIDENT">of_float</span></span> <span id="local_x_4"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_x_4"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_s_5"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="LIDENT">float_of_string</span> <a href="#local_s_5"><span class="LIDENT">s</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.of_string %s&quot;</span> <a href="#local_s_5"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string_opt"><span class="LIDENT">of_string_opt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">float_of_string_opt</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-format_float"><span class="EXTERNAL">external</span> <span class="LIDENT">format_float</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">float</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="EQUAL">=</span> <span class="STRING">&quot;caml_format_float&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Stolen from [pervasives.ml].  Adds a &quot;.&quot; at the end if needed.  It is in
   [pervasives.mli], but it also says not to use it directly, so we copy and paste the
   code. It makes the assumption on the string passed in argument that it was returned by
   [format_float]. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-valid_float_lexem"><span class="LIDENT">valid_float_lexem</span></span> <span id="local_s_6"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_7"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="string0.ml.html#module-String.val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_6"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_8"><span class="LIDENT">loop</span></span> <span id="local_i_9"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="UIDENT">Int_replace_polymorphic_compare</span><span class="DOT">.</span><span class="LPAREN">(</span> <span class="INFIXOP0">&gt;=</span> <span class="RPAREN">)</span></a> <a href="#local_i_9"><span class="LIDENT">i</span></a> <a href="#local_l_7"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_s_6"><span class="LIDENT">s</span></a> <a href="import0.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;.&quot;</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_s_6"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_9"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_8"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="#local_i_9"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_s_6"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_8"><span class="LIDENT">loop</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Let [y] be a power of 2.  Then the next representable float is:
   [z = y * (1 + 2 ** -52)]
   and the previous one is
   [x = y * (1 - 2 ** -53)]

   In general, every two adjacent floats are within a factor of between [1 + 2**-53]
   and [1 + 2**-52] from each other, that is within [1 + 1.1e-16] and [1 + 2.3e-16].

   So if the decimal representation of a float starts with &quot;1&quot;, then its adjacent floats
   will usually differ from it by 1, and sometimes by 2, at the 17th significant digit
   (counting from 1).

   On the other hand, if the decimal representation starts with &quot;9&quot;, then the adjacent
   floats will be off by no more than 23 at the 16th and 17th significant digits.

   E.g.:

   {v
     # sprintf &quot;%.17g&quot; (1024. *. (1. -. 2.** (-53.)));;
                             11111111
                   1234 5678901234567
     - : string = &quot;1023.9999999999999&quot;
   v}
   Printing a couple of extra digits reveals that the difference indeed is roughly 11 at
   digits 17th and 18th (that is, 13th and 14th after &quot;.&quot;):

   {v
     # sprintf &quot;%.19g&quot; (1024. *. (1. -. 2.** (-53.)));;
                             1111111111
                   1234 567890123456789
     - : string = &quot;1023.999999999999886&quot;
   v}

   The ulp (the difference between adjacent floats) is twice as big on the other side of
   1024.:

   {v
     # sprintf &quot;%.19g&quot; (1024. *. (1. +. 2.** (-52.)));;
                             1111111111
                   1234 567890123456789
     - : string = &quot;1024.000000000000227&quot;
   v}

   Now take a power of 2 which starts with 99:

   {v
     # 2.**93. ;;
                          1111111111
                 1 23456789012345678
     - : float = 9.9035203142830422e+27

     # 2.**93. *. (1. +. 2.** (-52.));;
     - : float = 9.9035203142830444e+27

     # 2.**93. *. (1. -. 2.** (-53.));;
     - : float = 9.9035203142830411e+27
   v}

   The difference between 2**93 and its two neighbors is slightly more than, respectively,
   1 and 2 at significant digit 16.

   Those examples show that:
   - 17 significant digits is always sufficient to represent a float without ambiguity
   - 15th significant digit can always be represented accurately
   - converting a decimal number with 16 significant digits to its nearest float and back
     can change the last decimal digit by no more than 1

   To make sure that floats obtained by conversion from decimal fractions (e.g. &quot;3.14&quot;)
   are printed without trailing non-zero digits, one should choose the first among the
   '%.15g', '%.16g', and '%.17g' representations which does round-trip:

   {v
     # sprintf &quot;%.15g&quot; 3.14;;
     - : string = &quot;3.14&quot;                     (* pick this one *)
     # sprintf &quot;%.16g&quot; 3.14;;
     - : string = &quot;3.14&quot;
     # sprintf &quot;%.17g&quot; 3.14;;
     - : string = &quot;3.1400000000000001&quot;       (* do not pick this one *)

     # sprintf &quot;%.15g&quot; 8.000000000000002;;
     - : string = &quot;8&quot;                        (* do not pick this one--does not round-trip *)
     # sprintf &quot;%.16g&quot; 8.000000000000002;;
     - : string = &quot;8.000000000000002&quot;        (* prefer this one *)
     # sprintf &quot;%.17g&quot; 8.000000000000002;;
     - : string = &quot;8.0000000000000018&quot;       (* this one has one digit of junk at the end *)
   v}

   Skipping the '%.16g' in the above procedure saves us some time, but it means that, as
   seen in the second example above, occasionally numbers with exactly 16 significant
   digits will have an error introduced at the 17th digit.  That is probably OK for
   typical use, because a number with 16 significant digits is &quot;ugly&quot; already.  Adding one
   more doesn't make it much worse for a human reader.

   On the other hand, we cannot skip '%.15g' and only look at '%.16g' and '%.17g', since
   the inaccuracy at the 16th digit might introduce the noise we want to avoid:

   {v
     # sprintf &quot;%.15g&quot; 9.992;;
     - : string = &quot;9.992&quot;                    (* pick this one *)
     # sprintf &quot;%.16g&quot; 9.992;;
     - : string = &quot;9.992000000000001&quot;        (* do not pick this one--junk at the end *)
     # sprintf &quot;%.17g&quot; 9.992;;
     - : string = &quot;9.9920000000000009&quot;
   v}
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_string"><span class="LIDENT">to_string</span></span> <span id="local_x_10"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">valid_float_lexem</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LET">let</span> <span id="local_y_11"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="LIDENT">format_float</span> <span class="STRING">&quot;%.15g&quot;</span> <a href="#local_x_10"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>     <span class="IF">if</span> <span class="LIDENT">float_of_string</span> <a href="#local_y_11"><span class="LIDENT">y</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <a href="#local_x_10"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_y_11"><span class="LIDENT">y</span></a> <span class="ELSE">else</span> <span class="LIDENT">format_float</span> <span class="STRING">&quot;%.17g&quot;</span> <a href="#local_x_10"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-max_value"><span class="LIDENT">max_value</span></span> <span class="EQUAL">=</span> <span class="LIDENT">infinity</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-min_value"><span class="LIDENT">min_value</span></span> <span class="EQUAL">=</span> <span class="LIDENT">neg_infinity</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-min_positive_subnormal_value"><span class="LIDENT">min_positive_subnormal_value</span></span> <span class="EQUAL">=</span> <span class="FLOAT">2.</span> <span class="INFIXOP4">**</span> <span class="MINUS">-</span><span class="FLOAT">1074.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-min_positive_normal_value"><span class="LIDENT">min_positive_normal_value</span></span> <span class="EQUAL">=</span> <span class="FLOAT">2.</span> <span class="INFIXOP4">**</span> <span class="MINUS">-</span><span class="FLOAT">1022.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-zero"><span class="LIDENT">zero</span></span> <span class="EQUAL">=</span> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-one"><span class="LIDENT">one</span></span> <span class="EQUAL">=</span> <span class="FLOAT">1.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-minus_one"><span class="LIDENT">minus_one</span></span> <span class="EQUAL">=</span> <span class="MINUS">-</span><span class="FLOAT">1.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pi"><span class="LIDENT">pi</span></span> <span class="EQUAL">=</span> <span class="FLOAT">0x3.243F6A8885A308D313198A2E037073</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sqrt_pi"><span class="LIDENT">sqrt_pi</span></span> <span class="EQUAL">=</span> <span class="FLOAT">0x1.C5BF891B4EF6AA79C3B0520D5DB938</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sqrt_2pi"><span class="LIDENT">sqrt_2pi</span></span> <span class="EQUAL">=</span> <span class="FLOAT">0x2.81B263FEC4E0B2CAF9483F5CE459DC</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-euler"><span class="LIDENT">euler</span></span> <span class="EQUAL">=</span> <span class="FLOAT">0x0.93C467E37DB0C7A4D1BE3F810152CB</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_int"><span class="LIDENT">of_int</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-to_float"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">to_float</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_int"><span class="LIDENT">to_int</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-of_float"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_int63"><span class="LIDENT">of_int63</span></span> <span id="local_i_12"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">to_float</span> <a href="#local_i_12"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_int64"><span class="LIDENT">of_int64</span></span> <span id="local_i_13"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-to_float"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">to_float</span></a> <a href="#local_i_13"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_int64"><span class="LIDENT">to_int64</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-of_float"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">of_float</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_lbound"><span class="LIDENT">iround_lbound</span></span> <span class="EQUAL">=</span> <span class="LIDENT">lower_bound_for_int</span> <a href="int.ml.html#val-num_bits"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">num_bits</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_ubound"><span class="LIDENT">iround_ubound</span></span> <span class="EQUAL">=</span> <span class="LIDENT">upper_bound_for_int</span> <a href="int.ml.html#val-num_bits"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">num_bits</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The performance of the &quot;exn&quot; rounding functions is important, so they are written
   out separately, and tuned individually.  (We could have the option versions call
   the &quot;exn&quot; versions, but that imposes arguably gratuitous overhead---especially
   in the case where the capture of backtraces is enabled upon &quot;with&quot;---and that seems
   not worth it when compared to the relatively small amount of code duplication.) *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Error reporting below is very carefully arranged so that, e.g., [iround_nearest_exn]
   itself can be inlined into callers such that they don't need to allocate a box for the
   [float] argument.  This is done with a box [box] function carefully chosen to allow the
   compiler to create a separate box for the float only in error cases.  See, e.g.,
   [../../zero/test/price_test.ml] for a mechanical test of this property when building
   with [X_LIBRARY_INLINING=true]. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_up"><span class="LIDENT">iround_up</span></span> <span id="local_t_14"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_14"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_15"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ceil</span> <a href="#local_t_14"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_15"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span> <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_15"><span class="LIDENT">t'</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_14"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_14"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-iround_up_exn"><span class="LIDENT">iround_up_exn</span></span> <span id="local_t_16"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_16"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_17"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ceil</span> <a href="#local_t_16"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_17"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_17"><span class="LIDENT">t'</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_up_exn: argument (%f) is too large&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_16"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_16"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_16"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_up_exn: argument (%f) is too small or NaN&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_16"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_down"><span class="LIDENT">iround_down</span></span> <span id="local_t_18"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_18"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="IF">if</span> <a href="#local_t_18"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span> <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_18"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_19"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <a href="#local_t_18"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_19"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span> <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_19"><span class="LIDENT">t'</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-iround_down_exn"><span class="LIDENT">iround_down_exn</span></span> <span id="local_t_20"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_20"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.0</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t_20"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_20"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_down_exn: argument (%f) is too large&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_20"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_21"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <a href="#local_t_20"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_21"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_21"><span class="LIDENT">t'</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_down_exn: argument (%f) is too small or NaN&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_20"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_towards_zero"><span class="LIDENT">iround_towards_zero</span></span> <span id="local_t_22"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_22"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_22"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_22"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-iround_towards_zero_exn"><span class="LIDENT">iround_towards_zero_exn</span></span> <span id="local_t_23"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_23"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_23"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_23"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>      <span class="STRING">&quot;Float.iround_towards_zero_exn: argument (%f) is out of range or NaN&quot;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_23"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Outside of the range (round_nearest_lb..round_nearest_ub), all representable doubles
   are integers in the mathematical sense, and [round_nearest] should be identity.

   However, for odd numbers with the absolute value between 2**52 and 2**53, the formula
   [round_nearest x = floor (x + 0.5)] does not hold:

   {v
     # let naive_round_nearest x = floor (x +. 0.5);;
     # let x = 2. ** 52. +. 1.;;
     val x : float = 4503599627370497.
     # naive_round_nearest x;;
     - :     float = 4503599627370498.
   v}
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_nearest_lb"><span class="LIDENT">round_nearest_lb</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(~-.)"><span class="MINUSDOT">-.</span></a><span class="LPAREN">(</span><span class="FLOAT">2.</span> <span class="INFIXOP4">**</span> <span class="FLOAT">52.</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_nearest_ub"><span class="LIDENT">round_nearest_ub</span></span> <span class="EQUAL">=</span> <span class="FLOAT">2.</span> <span class="INFIXOP4">**</span> <span class="FLOAT">52.</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* For [x = one_ulp `Down 0.5], the formula [floor (x +. 0.5)] for rounding to nearest
   does not work, because the exact result is halfway between [one_ulp `Down 1.] and [1.],
   and it gets rounded up to [1.] due to the round-ties-to-even rule. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-one_ulp_less_than_half"><span class="LIDENT">one_ulp_less_than_half</span></span> <span class="EQUAL">=</span> <span class="LIDENT">one_ulp</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Down</span> <span class="FLOAT">0.5</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-add_half_for_round_nearest"><span class="LIDENT">add_half_for_round_nearest</span></span> <span id="local_t_24"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_t_24"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_24"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">one_ulp_less_than_half</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">one_ulp_less_than_half</span> <span class="COMMENT">(* since t &lt; 0.5, make sure the result is &lt; 1.0 *)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="FLOAT">0.5</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_nearest_32"><span class="LIDENT">iround_nearest_32</span></span> <span id="local_t_25"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_25"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_26"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_half_for_round_nearest</span> <a href="#local_t_25"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_26"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span> <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_26"><span class="LIDENT">t'</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_27"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <span class="LPAREN">(</span><a href="#local_t_25"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">0.5</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_27"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span> <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_27"><span class="LIDENT">t'</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_nearest_64"><span class="LIDENT">iround_nearest_64</span></span> <span id="local_t_28"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_28"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t_28"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="LIDENT">round_nearest_ub</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <span class="LPAREN">(</span><span class="LIDENT">add_half_for_round_nearest</span> <a href="#local_t_28"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_28"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_28"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_28"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">round_nearest_lb</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <span class="LPAREN">(</span><span class="LIDENT">floor</span> <span class="LPAREN">(</span><a href="#local_t_28"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">0.5</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_28"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_28"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_nearest"><span class="LIDENT">iround_nearest</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="word_size.ml.html#val-word_size"><span class="UIDENT">Word_size</span><span class="DOT">.</span><span class="LIDENT">word_size</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">W64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_nearest_64</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">W32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_nearest_32</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_nearest_exn_32"><span class="LIDENT">iround_nearest_exn_32</span></span> <span id="local_t_29"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_29"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_30"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_half_for_round_nearest</span> <a href="#local_t_29"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_30"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_30"><span class="LIDENT">t'</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_nearest_exn: argument (%f) is too large&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_29"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_31"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <span class="LPAREN">(</span><a href="#local_t_29"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">0.5</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_31"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t'_31"><span class="LIDENT">t'</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_nearest_exn: argument (%f) is too small&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_29"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span> <span id="val-iround_nearest_exn_64"><span class="LIDENT">iround_nearest_exn_64</span></span> <span id="local_t_32"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_32"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t_32"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="LIDENT">round_nearest_ub</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <span class="LPAREN">(</span><span class="LIDENT">add_half_for_round_nearest</span> <a href="#local_t_32"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_32"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">iround_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_32"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_nearest_exn: argument (%f) is too large&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_32"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_32"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">round_nearest_lb</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <span class="LPAREN">(</span><span class="LIDENT">floor</span> <span class="LPAREN">(</span><a href="#local_t_32"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">0.5</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_32"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">iround_lbound</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="int.ml.html#val-of_float_unchecked"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span></a> <a href="#local_t_32"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;Float.iround_nearest_exn: argument (%f) is too small or NaN&quot;</span> <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t_32"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround_nearest_exn"><span class="LIDENT">iround_nearest_exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="word_size.ml.html#val-word_size"><span class="UIDENT">Word_size</span><span class="DOT">.</span><span class="LIDENT">word_size</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">W64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_nearest_exn_64</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">W32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_nearest_exn_32</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The following [iround_exn] and [iround] functions are slower than the ones above.
   Their equivalence to those functions is tested in the unit tests below. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-iround_exn"><span class="LIDENT">iround_exn</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_dir_33"><span class="LIDENT">dir</span></span> <span class="EQUAL">=</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Nearest</span><span class="RPAREN">)</span> <span id="local_t_34"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_dir_33"><span class="LIDENT">dir</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Zero</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_towards_zero_exn</span> <a href="#local_t_34"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Nearest</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_nearest_exn</span> <a href="#local_t_34"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Up</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_up_exn</span> <a href="#local_t_34"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Down</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">iround_down_exn</span> <a href="#local_t_34"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iround"><span class="LIDENT">iround</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_dir_35"><span class="LIDENT">dir</span></span> <span class="EQUAL">=</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Nearest</span><span class="RPAREN">)</span> <span id="local_t_36"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">iround_exn</span> <span class="TILDE">~</span><a href="#local_dir_35"><span class="LIDENT">dir</span></a> <a href="#local_t_36"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_inf"><span class="LIDENT">is_inf</span></span> <span id="local_t_37"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="FLOAT">1.</span> <a href="import0.ml.html#val-(/.)"><span class="INFIXOP3">/.</span></a> <a href="#local_t_37"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_finite"><span class="LIDENT">is_finite</span></span> <span id="local_t_38"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_38"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-.)"><span class="MINUSDOT">-.</span></a> <a href="#local_t_38"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-min_inan"><span class="LIDENT">min_inan</span></span> <span class="LPAREN">(</span><span id="local_x_39"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span id="local_y_40"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">is_nan</span> <a href="#local_y_40"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <a href="#local_x_39"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="IF">if</span> <span class="LIDENT">is_nan</span> <a href="#local_x_39"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_y_40"><span class="LIDENT">y</span></a> <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_x_39"><span class="LIDENT">x</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_y_40"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <a href="#local_x_39"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_y_40"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-max_inan"><span class="LIDENT">max_inan</span></span> <span class="LPAREN">(</span><span id="local_x_41"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span id="local_y_42"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">is_nan</span> <a href="#local_y_42"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <a href="#local_x_41"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="IF">if</span> <span class="LIDENT">is_nan</span> <a href="#local_x_41"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_y_42"><span class="LIDENT">y</span></a> <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_x_41"><span class="LIDENT">x</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_y_42"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <a href="#local_x_41"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_y_42"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add"><span class="LIDENT">add</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(+.)"><span class="LPAREN">(</span> <span class="PLUSDOT">+.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sub"><span class="LIDENT">sub</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(-.)"><span class="LPAREN">(</span> <span class="MINUSDOT">-.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-neg"><span class="LIDENT">neg</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(~-.)"><span class="LPAREN">(</span> <span class="PREFIXOP">~-.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-abs"><span class="LIDENT">abs</span></span> <span class="EQUAL">=</span> <span class="LIDENT">abs_float</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scale"><span class="LIDENT">scale</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(*.)"><span class="LPAREN">(</span> <span class="INFIXOP3">*.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-square"><span class="LIDENT">square</span></span> <span id="local_x_43"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_x_43"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="#local_x_43"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-Parts"><span class="MODULE">module</span> <span class="UIDENT">Parts</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-Parts.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Parts.val-fractional"><span class="VAL">val</span> <span class="LIDENT">fractional</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">float</span></span><span class="EOL">
</span>  <span id="module-Parts.val-integral"><span class="VAL">val</span> <span class="LIDENT">integral</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">float</span></span><span class="EOL">
</span>  <span id="module-Parts.val-modf"><span class="VAL">val</span> <span class="LIDENT">modf</span> <span class="COLON">:</span> <span class="LIDENT">float</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="END">end</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Parts.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">float</span> <span class="STAR">*</span> <span class="LIDENT">float</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Parts.val-fractional"><span class="LIDENT">fractional</span></span> <span id="local_t_44"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-fst"><span class="LIDENT">fst</span></a> <a href="#local_t_44"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Parts.val-integral"><span class="LIDENT">integral</span></span> <span id="local_t_45"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-snd"><span class="LIDENT">snd</span></a> <a href="#local_t_45"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Parts.val-modf"><span class="LIDENT">modf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">modf</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-modf"><span class="LIDENT">modf</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Parts</span><span class="DOT">.</span><span class="LIDENT">modf</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_down"><span class="LIDENT">round_down</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_up"><span class="LIDENT">round_up</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ceil</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_towards_zero"><span class="LIDENT">round_towards_zero</span></span> <span id="local_t_46"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_t_46"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span> <span class="THEN">then</span> <span class="LIDENT">round_down</span> <a href="#local_t_46"><span class="LIDENT">t</span></a> <span class="ELSE">else</span> <span class="LIDENT">round_up</span> <a href="#local_t_46"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* see the comment above [round_nearest_lb] and [round_nearest_ub] for an explanation *)</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-round_nearest_inline"><span class="LIDENT">round_nearest_inline</span></span> <span id="local_t_47"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_47"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">round_nearest_lb</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_47"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="LIDENT">round_nearest_ub</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">floor</span> <span class="LPAREN">(</span><span class="LIDENT">add_half_for_round_nearest</span> <a href="#local_t_47"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="#local_t_47"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_nearest"><span class="LIDENT">round_nearest</span></span> <span id="local_t_48"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">round_nearest_inline</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inlined</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t_48"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_nearest_half_to_even"><span class="LIDENT">round_nearest_half_to_even</span></span> <span id="local_t_49"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_49"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">round_nearest_lb</span> <a href="import0.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_t_49"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">round_nearest_ub</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="#local_t_49"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_floor_50"><span class="LIDENT">floor</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <a href="#local_t_49"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* [ceil_or_succ = if t is an integer then t +. 1. else ceil t].  Faster than [ceil]. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ceil_or_succ_51"><span class="LIDENT">ceil_or_succ</span></span> <span class="EQUAL">=</span> <a href="#local_floor_50"><span class="LIDENT">floor</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">1.</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_diff_floor_52"><span class="LIDENT">diff_floor</span></span> <span class="EQUAL">=</span> <a href="#local_t_49"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(-.)"><span class="MINUSDOT">-.</span></a> <a href="#local_floor_50"><span class="LIDENT">floor</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_diff_ceil_53"><span class="LIDENT">diff_ceil</span></span> <span class="EQUAL">=</span> <a href="#local_ceil_or_succ_51"><span class="LIDENT">ceil_or_succ</span></a> <a href="import0.ml.html#val-(-.)"><span class="MINUSDOT">-.</span></a> <a href="#local_t_49"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_diff_floor_52"><span class="LIDENT">diff_floor</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_diff_ceil_53"><span class="LIDENT">diff_ceil</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_floor_50"><span class="LIDENT">floor</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_diff_floor_52"><span class="LIDENT">diff_floor</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_diff_ceil_53"><span class="LIDENT">diff_ceil</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_ceil_or_succ_51"><span class="LIDENT">ceil_or_succ</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <span class="COMMENT">(* exact tie, pick the even *)</span><span class="EOL">
</span>      <span class="LIDENT">mod_float</span> <a href="#local_floor_50"><span class="LIDENT">floor</span></a> <span class="FLOAT">2.</span> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_floor_50"><span class="LIDENT">floor</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_ceil_or_succ_51"><span class="LIDENT">ceil_or_succ</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_lbound"><span class="LIDENT">int63_round_lbound</span></span> <span class="EQUAL">=</span> <span class="LIDENT">lower_bound_for_int</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">num_bits</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_ubound"><span class="LIDENT">int63_round_ubound</span></span> <span class="EQUAL">=</span> <span class="LIDENT">upper_bound_for_int</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">num_bits</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_up_exn"><span class="LIDENT">int63_round_up_exn</span></span> <span id="local_t_54"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_54"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_55"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ceil</span> <a href="#local_t_54"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_55"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">int63_round_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span> <a href="#local_t'_55"><span class="LIDENT">t'</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>        <span class="STRING">&quot;Float.int63_round_up_exn: argument (%f) is too large&quot;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="float0.ml.html#val-box"><span class="UIDENT">Float0</span><span class="DOT">.</span><span class="LIDENT">box</span></a> <a href="#local_t_54"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_54"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">int63_round_lbound</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span> <a href="#local_t_54"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>      <span class="STRING">&quot;Float.int63_round_up_exn: argument (%f) is too small or NaN&quot;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="float0.ml.html#val-box"><span class="UIDENT">Float0</span><span class="DOT">.</span><span class="LIDENT">box</span></a> <a href="#local_t_54"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_down_exn"><span class="LIDENT">int63_round_down_exn</span></span> <span id="local_t_56"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.0</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">int63_round_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span> <a href="#local_t_56"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>        <span class="STRING">&quot;Float.int63_round_down_exn: argument (%f) is too large&quot;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="float0.ml.html#val-box"><span class="UIDENT">Float0</span><span class="DOT">.</span><span class="LIDENT">box</span></a> <a href="#local_t_56"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_t'_57"><span class="LIDENT">t'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <a href="#local_t_56"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t'_57"><span class="LIDENT">t'</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">int63_round_lbound</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span> <a href="#local_t'_57"><span class="LIDENT">t'</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>        <span class="STRING">&quot;Float.int63_round_down_exn: argument (%f) is too small or NaN&quot;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="float0.ml.html#val-box"><span class="UIDENT">Float0</span><span class="DOT">.</span><span class="LIDENT">box</span></a> <a href="#local_t_56"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_nearest_portable_alloc_exn"><span class="LIDENT">int63_round_nearest_portable_alloc_exn</span></span> <span id="local_t0_58"><span class="LIDENT">t0</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_t_59"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">round_nearest_inline</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">ocaml</span><span class="DOT">.</span><span class="LIDENT">inlined</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_t0_58"><span class="LIDENT">t0</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_59"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t_59"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="LIDENT">int63_round_ubound</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span> <a href="#local_t_59"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>        <span class="STRING">&quot;Float.int63_round_nearest_portable_alloc_exn: argument (%f) is too large&quot;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t0_58"><span class="LIDENT">t0</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_59"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">int63_round_lbound</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_float_unchecked</span> <a href="#local_t_59"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>      <span class="STRING">&quot;Float.int63_round_nearest_portable_alloc_exn: argument (%f) is too small or NaN&quot;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">box</span> <a href="#local_t0_58"><span class="LIDENT">t0</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_nearest_arch64_noalloc_exn"><span class="LIDENT">int63_round_nearest_arch64_noalloc_exn</span></span> <span id="local_f_60"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><span class="LIDENT">iround_nearest_exn</span> <a href="#local_f_60"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int63_round_nearest_exn"><span class="LIDENT">int63_round_nearest_exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="word_size.ml.html#val-word_size"><span class="UIDENT">Word_size</span><span class="DOT">.</span><span class="LIDENT">word_size</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">W64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int63_round_nearest_arch64_noalloc_exn</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">W32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int63_round_nearest_portable_alloc_exn</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round"><span class="LIDENT">round</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_dir_61"><span class="LIDENT">dir</span></span> <span class="EQUAL">=</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Nearest</span><span class="RPAREN">)</span> <span id="local_t_62"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_dir_61"><span class="LIDENT">dir</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Nearest</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">round_nearest</span> <a href="#local_t_62"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Down</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">round_down</span> <a href="#local_t_62"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Up</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">round_up</span> <a href="#local_t_62"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Zero</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">round_towards_zero</span> <a href="#local_t_62"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Class"><span class="MODULE">module</span> <span class="UIDENT">Class</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Class.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Class.type-t.constructor-Infinite"><span class="BAR">|</span> <span class="UIDENT">Infinite</span></span><span class="EOL">
</span>    <span id="module-Class.type-t.constructor-Nan"><span class="BAR">|</span> <span class="UIDENT">Nan</span></span><span class="EOL">
</span>    <span id="module-Class.type-t.constructor-Normal"><span class="BAR">|</span> <span class="UIDENT">Normal</span></span><span class="EOL">
</span>    <span id="module-Class.type-t.constructor-Subnormal"><span class="BAR">|</span> <span class="UIDENT">Subnormal</span></span><span class="EOL">
</span>    <span id="module-Class.type-t.constructor-Zero"><span class="BAR">|</span> <span class="UIDENT">Zero</span></span><span class="EOL">
</span>  <span class="LBRACKETATAT">[@@</span><span class="LIDENT">deriving_inline</span> <span class="LIDENT">compare</span><span class="COMMA">,</span> <span class="LIDENT">enumerate</span><span class="COMMA">,</span> <span class="LIDENT">sexp</span><span class="COMMA">,</span> <span class="LIDENT">sexp_grammar</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Class.val-compare"><span class="LIDENT">compare</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-compare"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">compare</span></a> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Class.val-all"><span class="LIDENT">all</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LBRACKET">[</span> <span class="UIDENT">Infinite</span><span class="SEMI">;</span> <span class="UIDENT">Nan</span><span class="SEMI">;</span> <span class="UIDENT">Normal</span><span class="SEMI">;</span> <span class="UIDENT">Subnormal</span><span class="SEMI">;</span> <span class="UIDENT">Zero</span> <span class="RBRACKET">]</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="LIDENT">list</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Class.val-t_of_sexp"><span class="LIDENT">t_of_sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LET">let</span> <span id="local_error_source__007__63"><span class="LIDENT">error_source__007_</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;float.ml.Class.t&quot;</span> <span class="IN">in</span><span class="EOL">
</span>     <span class="FUNCTION">function</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;infinite&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Infinite&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Infinite</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;nan&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Nan&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Nan</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;normal&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Normal&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Normal</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;subnormal&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Subnormal&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Subnormal</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;zero&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Zero&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Zero</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;infinite&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Infinite&quot;</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span><span class="EOL">
</span>       <span id="local_sexp__008__64"><span class="LIDENT">sexp__008_</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-stag_no_args"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">stag_no_args</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__008__64"><span class="LIDENT">sexp__008_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;nan&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Nan&quot;</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_sexp__008__65"><span class="LIDENT">sexp__008_</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-stag_no_args"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">stag_no_args</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__008__65"><span class="LIDENT">sexp__008_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;normal&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Normal&quot;</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_sexp__008__66"><span class="LIDENT">sexp__008_</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-stag_no_args"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">stag_no_args</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__008__66"><span class="LIDENT">sexp__008_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;subnormal&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Subnormal&quot;</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span><span class="EOL">
</span>       <span id="local_sexp__008__67"><span class="LIDENT">sexp__008_</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-stag_no_args"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">stag_no_args</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__008__67"><span class="LIDENT">sexp__008_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;zero&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Zero&quot;</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_sexp__008__68"><span class="LIDENT">sexp__008_</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-stag_no_args"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">stag_no_args</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__008__68"><span class="LIDENT">sexp__008_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_sexp__006__69"><span class="LIDENT">sexp__006_</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-nested_list_invalid_sum"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">nested_list_invalid_sum</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__006__69"><span class="LIDENT">sexp__006_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="AS">as</span> <span id="local_sexp__006__70"><span class="LIDENT">sexp__006_</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-empty_list_invalid_sum"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">empty_list_invalid_sum</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__006__70"><span class="LIDENT">sexp__006_</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_sexp__006__71"><span class="LIDENT">sexp__006_</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../sexplib0/src/sexplib0/sexp_conv_error.ml.html#val-unexpected_stag"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv_error</span><span class="DOT">.</span><span class="LIDENT">unexpected_stag</span></a> <a href="#local_error_source__007__63"><span class="LIDENT">error_source__007_</span></a> <a href="#local_sexp__006__71"><span class="LIDENT">sexp__006_</span></a><span class="EOL">
</span>       <span class="COLON">:</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Class.val-sexp_of_t"><span class="LIDENT">sexp_of_t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Infinite</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Infinite&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Nan</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Nan&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Normal</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Normal&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Subnormal</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Subnormal&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Zero</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="STRING">&quot;Zero&quot;</span><span class="EOL">
</span>                <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#type-t"><span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span id="module-Class.val-t_sexp_grammar"><span class="LIDENT">t_sexp_grammar</span></span> <span class="COLON">:</span> <a href="../../../sexplib0/src/sexplib0/sexp_grammar.ml.html#type-t"><span class="LIDENT">t</span> <span class="UIDENT">Sexplib0</span><span class="DOT">.</span><span class="UIDENT">Sexp_grammar</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span class="LIDENT">untyped</span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="UIDENT">Variant</span><span class="EOL">
</span>          <span class="LBRACE">{</span> <span class="LIDENT">case_sensitivity</span> <span class="EQUAL">=</span> <span class="UIDENT">Case_sensitive_except_first_character</span><span class="EOL">
</span>          <span class="SEMI">;</span> <span class="LIDENT">clauses</span> <span class="EQUAL">=</span><span class="EOL">
</span>              <span class="LBRACKET">[</span> <span class="UIDENT">No_tag</span> <span class="LBRACE">{</span> <span class="LIDENT">name</span> <span class="EQUAL">=</span> <span class="STRING">&quot;Infinite&quot;</span><span class="SEMI">;</span> <span class="LIDENT">clause_kind</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom_clause</span> <span class="RBRACE">}</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="UIDENT">No_tag</span> <span class="LBRACE">{</span> <span class="LIDENT">name</span> <span class="EQUAL">=</span> <span class="STRING">&quot;Nan&quot;</span><span class="SEMI">;</span> <span class="LIDENT">clause_kind</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom_clause</span> <span class="RBRACE">}</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="UIDENT">No_tag</span> <span class="LBRACE">{</span> <span class="LIDENT">name</span> <span class="EQUAL">=</span> <span class="STRING">&quot;Normal&quot;</span><span class="SEMI">;</span> <span class="LIDENT">clause_kind</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom_clause</span> <span class="RBRACE">}</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="UIDENT">No_tag</span> <span class="LBRACE">{</span> <span class="LIDENT">name</span> <span class="EQUAL">=</span> <span class="STRING">&quot;Subnormal&quot;</span><span class="SEMI">;</span> <span class="LIDENT">clause_kind</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom_clause</span> <span class="RBRACE">}</span><span class="EOL">
</span>              <span class="SEMI">;</span> <span class="UIDENT">No_tag</span> <span class="LBRACE">{</span> <span class="LIDENT">name</span> <span class="EQUAL">=</span> <span class="STRING">&quot;Zero&quot;</span><span class="SEMI">;</span> <span class="LIDENT">clause_kind</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom_clause</span> <span class="RBRACE">}</span><span class="EOL">
</span>              <span class="RBRACKET">]</span><span class="EOL">
</span>          <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LBRACKETATATAT">[@@@</span><span class="END">end</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Class.val-to_string"><span class="LIDENT">to_string</span></span> <span id="local_t_72"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-string_of_sexp"><span class="LIDENT">string_of_sexp</span></a> <span class="LPAREN">(</span><span class="LIDENT">sexp_of_t</span> <a href="#local_t_72"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Class.val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_s_73"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">t_of_sexp</span> <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp_conv.ml.html#val-sexp_of_string"><span class="LIDENT">sexp_of_string</span></a> <a href="#local_s_73"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-classify"><span class="LIDENT">classify</span></span> <span id="local_t_74"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="MODULE">module</span> <span class="UIDENT">C</span> <span class="EQUAL">=</span> <span class="UIDENT">Class</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">classify_float</span> <a href="#local_t_74"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FP_normal</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">C</span><span class="DOT">.</span><span class="UIDENT">Normal</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FP_subnormal</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">C</span><span class="DOT">.</span><span class="UIDENT">Subnormal</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FP_zero</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">C</span><span class="DOT">.</span><span class="UIDENT">Zero</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FP_infinite</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">C</span><span class="DOT">.</span><span class="UIDENT">Infinite</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FP_nan</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">C</span><span class="DOT">.</span><span class="UIDENT">Nan</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-insert_underscores"><span class="LIDENT">insert_underscores</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_delimiter_75"><span class="LIDENT">delimiter</span></span> <span class="EQUAL">=</span> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_strip_zero_76"><span class="LIDENT">strip_zero</span></span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RPAREN">)</span> <span id="local_string_77"><span class="LIDENT">string</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="string.ml.html#val-lsplit2"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">lsplit2</span></a> <a href="#local_string_77"><span class="LIDENT">string</span></a> <span class="LABEL">~on:</span><span class="CHAR">'.'</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="int_conversions.ml.html#val-insert_delimiter"><span class="UIDENT">Int_conversions</span><span class="DOT">.</span><span class="LIDENT">insert_delimiter</span></a> <a href="#local_string_77"><span class="LIDENT">string</span></a> <span class="TILDE">~</span><a href="#local_delimiter_75"><span class="LIDENT">delimiter</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span id="local_left_78"><span class="LIDENT">left</span></span><span class="COMMA">,</span> <span id="local_right_79"><span class="LIDENT">right</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_left_80"><span class="LIDENT">left</span></span> <span class="EQUAL">=</span> <a href="int_conversions.ml.html#val-insert_delimiter"><span class="UIDENT">Int_conversions</span><span class="DOT">.</span><span class="LIDENT">insert_delimiter</span></a> <a href="#local_left_78"><span class="LIDENT">left</span></a> <span class="TILDE">~</span><a href="#local_delimiter_75"><span class="LIDENT">delimiter</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_right_81"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_strip_zero_76"><span class="LIDENT">strip_zero</span></a> <span class="THEN">then</span> <a href="string.ml.html#val-rstrip"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">rstrip</span></a> <a href="#local_right_79"><span class="LIDENT">right</span></a> <span class="LABEL">~drop:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_c_82"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="import0.ml.html#module-Char_replace_polymorphic_compare.val-(=)"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LPAREN">(</span> <span class="EQUAL">=</span> <span class="RPAREN">)</span></a> <a href="#local_c_82"><span class="LIDENT">c</span></a> <span class="CHAR">'0'</span><span class="RPAREN">)</span> <span class="ELSE">else</span> <a href="#local_right_79"><span class="LIDENT">right</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_right_81"><span class="LIDENT">right</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="STRING">&quot;&quot;</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_left_80"><span class="LIDENT">left</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_left_80"><span class="LIDENT">left</span></a> <a href="import0.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;.&quot;</span> <a href="import0.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_right_81"><span class="LIDENT">right</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_string_hum"><span class="LIDENT">to_string_hum</span></span> <span class="QUESTION">?</span><span id="local_delimiter_83"><span class="LIDENT">delimiter</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_decimals_84"><span class="LIDENT">decimals</span></span> <span class="EQUAL">=</span> <span class="INT">3</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span id="local_strip_zero_85"><span class="LIDENT">strip_zero</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_explicit_plus_86"><span class="LIDENT">explicit_plus</span></span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="RPAREN">)</span> <span id="local_f_87"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="UIDENT">Int_replace_polymorphic_compare</span><span class="DOT">.</span><span class="LPAREN">(</span> <span class="LESS">&lt;</span> <span class="RPAREN">)</span></a> <a href="#local_decimals_84"><span class="LIDENT">decimals</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a> <span class="STRING">&quot;to_string_hum: invalid argument ~decimals=%d&quot;</span> <a href="#local_decimals_84"><span class="LIDENT">decimals</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">classify</span> <a href="#local_f_87"><span class="LIDENT">f</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Infinite</span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_f_87"><span class="LIDENT">f</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.</span> <span class="THEN">then</span> <span class="STRING">&quot;inf&quot;</span> <span class="ELSE">else</span> <span class="STRING">&quot;-inf&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Nan</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;nan&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Normal</span> <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Subnormal</span> <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Zero</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_88"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_explicit_plus_86"><span class="LIDENT">explicit_plus</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%+.*f&quot;</span> <a href="#local_decimals_84"><span class="LIDENT">decimals</span></a> <a href="#local_f_87"><span class="LIDENT">f</span></a> <span class="ELSE">else</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%.*f&quot;</span> <a href="#local_decimals_84"><span class="LIDENT">decimals</span></a> <a href="#local_f_87"><span class="LIDENT">f</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">insert_underscores</span> <a href="#local_s_88"><span class="LIDENT">s</span></a> <span class="QUESTION">?</span><a href="#local_delimiter_83"><span class="LIDENT">delimiter</span></a> <span class="QUESTION">?</span><a href="#local_strip_zero_85"><span class="LIDENT">strip_zero</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_t"><span class="LIDENT">sexp_of_t</span></span> <span id="local_t_89"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sexp_90"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">sexp_of_t</span> <a href="#local_t_89"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="../../../sexplib0/src/sexplib0/sexp.ml.html#val-of_float_style"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">of_float_style</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">No_underscores</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_90"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Underscores</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_sexp_90"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="LIDENT">raise_s</span><span class="EOL">
</span>         <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp.ml.html#val-message"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">message</span></a><span class="EOL">
</span>            <span class="STRING">&quot;[sexp_of_float] produced strange sexp&quot;</span><span class="EOL">
</span>            <span class="LBRACKET">[</span> <span class="STRING">&quot;sexp&quot;</span><span class="COMMA">,</span> <a href="../../../sexplib0/src/sexplib0/sexp.ml.html#val-sexp_of_t"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">sexp_of_t</span></a> <a href="#local_sexp_90"><span class="LIDENT">sexp</span></a> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_string_91"><span class="LIDENT">string</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="IF">if</span> <a href="string.ml.html#val-contains"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">contains</span></a> <a href="#local_string_91"><span class="LIDENT">string</span></a> <span class="CHAR">'E'</span> <span class="THEN">then</span> <a href="#local_sexp_90"><span class="LIDENT">sexp</span></a> <span class="ELSE">else</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="LIDENT">insert_underscores</span> <a href="#local_string_91"><span class="LIDENT">string</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_padded_compact_string_custom"><span class="LIDENT">to_padded_compact_string_custom</span></span> <span id="local_t_92"><span class="LIDENT">t</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_prefix_93"><span class="LIDENT">prefix</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_kilo_94"><span class="LIDENT">kilo</span></span> <span class="TILDE">~</span><span id="local_mega_95"><span class="LIDENT">mega</span></span> <span class="TILDE">~</span><span id="local_giga_96"><span class="LIDENT">giga</span></span> <span class="TILDE">~</span><span id="local_tera_97"><span class="LIDENT">tera</span></span> <span class="QUESTION">?</span><span id="local_peta_98"><span class="LIDENT">peta</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* Round a ratio toward the nearest integer, resolving ties toward the nearest even
     number.  For sane inputs (in particular, when [denominator] is an integer and
     [abs numerator &lt; 2e52]) this should be accurate.  Otherwise, the result might be a
     little bit off, but we don't really use that case. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_iround_ratio_exn_99"><span class="LIDENT">iround_ratio_exn</span></span> <span class="TILDE">~</span><span id="local_numerator_100"><span class="LIDENT">numerator</span></span> <span class="TILDE">~</span><span id="local_denominator_101"><span class="LIDENT">denominator</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_102"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <span class="LIDENT">floor</span> <span class="LPAREN">(</span><a href="#local_numerator_100"><span class="LIDENT">numerator</span></a> <a href="import0.ml.html#val-(/.)"><span class="INFIXOP3">/.</span></a> <a href="#local_denominator_101"><span class="LIDENT">denominator</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* if [abs k &lt; 2e53], then both [k] and [k +. 1.] are accurately represented, and in
       particular [k +. 1. &gt; k].  If [denominator] is also an integer, and
       [abs (denominator *. (k +. 1)) &lt; 2e53] (and in some other cases, too), then [lower]
       and [higher] are actually both accurate.  Since (roughly)
       [numerator = denominator *. k] then for [abs numerator &lt; 2e52] we should be
       fine. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_lower_103"><span class="LIDENT">lower</span></span> <span class="EQUAL">=</span> <a href="#local_denominator_101"><span class="LIDENT">denominator</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="#local_k_102"><span class="LIDENT">k</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_higher_104"><span class="LIDENT">higher</span></span> <span class="EQUAL">=</span> <a href="#local_denominator_101"><span class="LIDENT">denominator</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <span class="LPAREN">(</span><a href="#local_k_102"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="FLOAT">1.</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* Subtracting numbers within a factor of two from each other is accurate.
       So either the two subtractions below are accurate, or k = 0, or k = -1.
       In case of a tie, round to even. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_diff_right_105"><span class="LIDENT">diff_right</span></span> <span class="EQUAL">=</span> <a href="#local_higher_104"><span class="LIDENT">higher</span></a> <a href="import0.ml.html#val-(-.)"><span class="MINUSDOT">-.</span></a> <a href="#local_numerator_100"><span class="LIDENT">numerator</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_diff_left_106"><span class="LIDENT">diff_left</span></span> <span class="EQUAL">=</span> <a href="#local_numerator_100"><span class="LIDENT">numerator</span></a> <a href="import0.ml.html#val-(-.)"><span class="MINUSDOT">-.</span></a> <a href="#local_lower_103"><span class="LIDENT">lower</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k_107"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <span class="LIDENT">iround_nearest_exn</span> <a href="#local_k_102"><span class="LIDENT">k</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_diff_right_105"><span class="LIDENT">diff_right</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_diff_left_106"><span class="LIDENT">diff_left</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_k_107"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_diff_right_105"><span class="LIDENT">diff_right</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_diff_left_106"><span class="LIDENT">diff_left</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_k_107"><span class="LIDENT">k</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <span class="COMMENT">(* a tie *)</span><span class="EOL">
</span>      <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="UIDENT">Int_replace_polymorphic_compare</span><span class="DOT">.</span><span class="LPAREN">(</span> <span class="EQUAL">=</span> <span class="RPAREN">)</span></a> <span class="LPAREN">(</span><a href="#local_k_107"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_k_107"><span class="LIDENT">k</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_k_107"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">classify</span> <a href="#local_t_92"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Infinite</span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_t_92"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">0.0</span> <span class="THEN">then</span> <span class="STRING">&quot;-inf  &quot;</span> <span class="ELSE">else</span> <span class="STRING">&quot;inf  &quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Nan</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;nan  &quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Subnormal</span> <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Normal</span> <span class="BAR">|</span> <span class="UIDENT">Class</span><span class="DOT">.</span><span class="UIDENT">Zero</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_go_108"><span class="LIDENT">go</span></span> <span id="local_t_109"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_conv_one_110"><span class="LIDENT">conv_one</span></span> <span id="local_t_111"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="FLOAT">0.</span> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_t_111"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_111"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_x_112"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_prefix_93"><span class="LIDENT">prefix</span></a> <a href="import0.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LIDENT">format_float</span> <span class="STRING">&quot;%.1f&quot;</span> <a href="#local_t_111"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="COMMENT">(* Fix the &quot;.0&quot; suffix *)</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="string.ml.html#val-is_suffix"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">is_suffix</span></a> <a href="#local_x_112"><span class="LIDENT">x</span></a> <span class="LABEL">~suffix:</span><span class="STRING">&quot;.0&quot;</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_x_113"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">of_string</span> <a href="#local_x_112"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_n_114"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_x_113"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span> <a href="#local_x_113"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><a href="#local_n_114"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="CHAR">' '</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span> <a href="#local_x_113"><span class="LIDENT">x</span></a> <span class="LPAREN">(</span><a href="#local_n_114"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="CHAR">' '</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span> <span class="LABEL">~no_mutation_while_string_reachable:</span><a href="#local_x_113"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_x_112"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_conv_115"><span class="LIDENT">conv</span></span> <span id="local_mag_116"><span class="LIDENT">mag</span></span> <span id="local_t_117"><span class="LIDENT">t</span></span> <span id="local_denominator_118"><span class="LIDENT">denominator</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="#local_denominator_118"><span class="LIDENT">denominator</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">100.</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_117"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">999.95</span><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="import0.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LPAREN">(</span><a href="#local_denominator_118"><span class="LIDENT">denominator</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">100_000.</span> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_117"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">round_nearest</span> <span class="LPAREN">(</span><a href="#local_denominator_118"><span class="LIDENT">denominator</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <span class="FLOAT">9.999_5</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_t_117"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="LIDENT">round_nearest</span> <span class="LPAREN">(</span><a href="#local_denominator_118"><span class="LIDENT">denominator</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <span class="FLOAT">9_999.5</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_186"><span id="local_i_119"><span class="LIDENT">i</span></span><span class="COMMA">,</span> <span id="local_d_120"><span class="LIDENT">d</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_k_121"><span class="LIDENT">k</span></span> <span class="EQUAL">=</span> <a href="#local_iround_ratio_exn_99"><span class="LIDENT">iround_ratio_exn</span></a> <span class="LABEL">~numerator:</span><a href="#local_t_117"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_denominator_118"><span class="LIDENT">denominator</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="COMMENT">(* [mod] is okay here because we know i &gt;= 0. *)</span><span class="EOL">
</span>          <a href="#local_k_121"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">10</span><span class="COMMA">,</span> <a href="#local_k_121"><span class="LIDENT">k</span></a> <a href="import0.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <span class="INT">10</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="OPEN">open</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare"><span class="UIDENT">Int_replace_polymorphic_compare</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="INT">0</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_i_119"><span class="LIDENT">i</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_i_119"><span class="LIDENT">i</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">1000</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="INT">0</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_d_120"><span class="LIDENT">d</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_d_120"><span class="LIDENT">d</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">10</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_d_120"><span class="LIDENT">d</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s%d%s &quot;</span> <a href="#local_prefix_93"><span class="LIDENT">prefix</span></a> <a href="#local_i_119"><span class="LIDENT">i</span></a> <a href="#local_mag_116"><span class="LIDENT">mag</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s%d%s%d&quot;</span> <a href="#local_prefix_93"><span class="LIDENT">prefix</span></a> <a href="#local_i_119"><span class="LIDENT">i</span></a> <a href="#local_mag_116"><span class="LIDENT">mag</span></a> <a href="#local_d_120"><span class="LIDENT">d</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="COMMENT">(* While the standard metric prefixes (e.g. capital &quot;M&quot; rather than &quot;m&quot;, [1]) are
         nominally more correct, this hinders readability in our case.  E.g., 10G6 and
         1066 look too similar.  That's an extreme example, but in general k,m,g,t,p
         probably stand out better than K,M,G,T,P when interspersed with digits.

         [1] http://en.wikipedia.org/wiki/Metric_prefix *)</span><span class="EOL">
</span>      <span class="COMMENT">(* The trick here is that:
         - the first boundary (999.95) as a float is slightly over-represented (so it is
           better approximated as &quot;1k&quot; than as &quot;999.9&quot;),
         - the other boundaries are accurately represented, because they are integers.
           That's why the strict equalities below do exactly what we want. *)</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_t_109"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95E0</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_conv_one_110"><span class="LIDENT">conv_one</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_109"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95E3</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_conv_115"><span class="LIDENT">conv</span></a> <a href="#local_kilo_94"><span class="LIDENT">kilo</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a> <span class="FLOAT">100.</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_109"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95E6</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_conv_115"><span class="LIDENT">conv</span></a> <a href="#local_mega_95"><span class="LIDENT">mega</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a> <span class="FLOAT">100_000.</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_109"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95E9</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_conv_115"><span class="LIDENT">conv</span></a> <a href="#local_giga_96"><span class="LIDENT">giga</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a> <span class="FLOAT">100_000_000.</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_109"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95E12</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_conv_115"><span class="LIDENT">conv</span></a> <a href="#local_tera_97"><span class="LIDENT">tera</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a> <span class="FLOAT">100_000_000_000.</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_peta_98"><span class="LIDENT">peta</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s%.1e&quot;</span> <a href="#local_prefix_93"><span class="LIDENT">prefix</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_peta_122"><span class="LIDENT">peta</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_t_109"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">999.95E15</span><span class="EOL">
</span>          <span class="THEN">then</span> <a href="#local_conv_115"><span class="LIDENT">conv</span></a> <a href="#local_peta_122"><span class="LIDENT">peta</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a> <span class="FLOAT">100_000_000_000_000.</span><span class="EOL">
</span>          <span class="ELSE">else</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s%.1e&quot;</span> <a href="#local_prefix_93"><span class="LIDENT">prefix</span></a> <a href="#local_t_109"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_t_92"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span> <span class="THEN">then</span> <a href="#local_go_108"><span class="LIDENT">go</span></a> <a href="#local_t_92"><span class="LIDENT">t</span></a> <span class="ELSE">else</span> <span class="STRING">&quot;-&quot;</span> <a href="import0.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_go_108"><span class="LIDENT">go</span></a> <a href="import0.ml.html#val-(~-.)"><span class="PREFIXOP">~-.</span></a><a href="#local_t_92"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_padded_compact_string"><span class="LIDENT">to_padded_compact_string</span></span> <span id="local_t_123"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">to_padded_compact_string_custom</span> <a href="#local_t_123"><span class="LIDENT">t</span></a> <span class="LABEL">~kilo:</span><span class="STRING">&quot;k&quot;</span> <span class="LABEL">~mega:</span><span class="STRING">&quot;m&quot;</span> <span class="LABEL">~giga:</span><span class="STRING">&quot;g&quot;</span> <span class="LABEL">~tera:</span><span class="STRING">&quot;t&quot;</span> <span class="LABEL">~peta:</span><span class="STRING">&quot;p&quot;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Performance note: Initializing the accumulator to 1 results in one extra
   multiply; e.g., to compute x ** 4, we in principle only need 2 multiplies,
   but this function will have 3 multiplies.  However, attempts to avoid this
   (like decrementing n and initializing accum to be x, or handling small
   exponents as a special case) have not yielded anything that is a net
   improvement.
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int_pow"><span class="LIDENT">int_pow</span></span> <span id="local_x_124"><span class="LIDENT">x</span></span> <span id="local_n_125"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare"><span class="UIDENT">Int_replace_polymorphic_compare</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_125"><span class="LIDENT">n</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="FLOAT">1.</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="COMMENT">(* Using [x +. (-0.)] on the following line convinces the compiler to avoid a certain
       boxing (that would result in allocation in each iteration).  Soon, the compiler
       shouldn't need this &quot;hint&quot; to avoid the boxing.  The reason we add -0 rather than 0
       is that [x +. (-0.)] is apparently always the same as [x], whereas [x +. 0.] is
       not, in that it sends [-0.] to [0.].  This makes a difference because we want
       [int_pow (-0.) (-1)] to return neg_infinity just like [-0. ** -1.] would.  *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_x_126"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_x_124"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(+.)"><span class="PLUSDOT">+.</span></a> <span class="MINUS">-</span><span class="FLOAT">0.</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n_127"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_n_125"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_accum_128"><span class="LIDENT">accum</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FLOAT">1.</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="COMMENT">(* x ** n = (1/x) ** -n *)</span><span class="EOL">
</span>      <a href="#local_x_126"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FLOAT">1.</span> <a href="import0.ml.html#val-(/.)"><span class="INFIXOP3">/.</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_126"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(~-)"><span class="PREFIXOP">~-</span></a> <span class="LPAREN">(</span><a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_127"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="COMMENT">(* n must have been min_int, so it is now so big that it has wrapped around.
           We decrement it so that it looks positive again, but accordingly have
           to put an extra factor of x in the accumulator.
        *)</span><span class="EOL">
</span>        <a href="#local_accum_128"><span class="LIDENT">accum</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_126"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="import0.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_n_127"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="COMMENT">(* Letting [a] denote (the original value of) [x ** n], we maintain
       the invariant that [(x ** n) *. accum = a]. *)</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">1</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_accum_128"><span class="LIDENT">accum</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_126"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_accum_128"><span class="LIDENT">accum</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_x_126"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_126"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_126"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_127"><span class="LIDENT">n</span></a> <a href="import0.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="COMMENT">(* n is necessarily 1 at this point, so there is one additional
       multiplication by x. *)</span><span class="EOL">
</span>    <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_x_126"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="import0.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_accum_128"><span class="LIDENT">accum</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_gen"><span class="LIDENT">round_gen</span></span> <span id="local_x_129"><span class="LIDENT">x</span></span> <span class="TILDE">~</span><span id="local_how_130"><span class="LIDENT">how</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_x_129"><span class="LIDENT">x</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="import0.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_finite</span> <a href="#local_x_129"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="#local_x_129"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="COMMENT">(* Significant digits and decimal digits. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_185"><span id="local_sd_131"><span class="LIDENT">sd</span></span><span class="COMMA">,</span> <span id="local_dd_132"><span class="LIDENT">dd</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_how_130"><span class="LIDENT">how</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="LIDENT">significant_digits</span> <span id="local_sd_133"><span class="LIDENT">sd</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_dd_134"><span class="LIDENT">dd</span></span> <span class="EQUAL">=</span> <a href="#local_sd_133"><span class="LIDENT">sd</span></a> <a href="import0.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">to_int</span> <span class="LPAREN">(</span><span class="LIDENT">round_up</span> <span class="LPAREN">(</span><span class="LIDENT">log10</span> <span class="LPAREN">(</span><span class="LIDENT">abs</span> <a href="#local_x_129"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_sd_133"><span class="LIDENT">sd</span></a><span class="COMMA">,</span> <a href="#local_dd_134"><span class="LIDENT">dd</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="LIDENT">decimal_digits</span> <span id="local_dd_135"><span class="LIDENT">dd</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_sd_136"><span class="LIDENT">sd</span></span> <span class="EQUAL">=</span> <a href="#local_dd_135"><span class="LIDENT">dd</span></a> <a href="import0.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">to_int</span> <span class="LPAREN">(</span><span class="LIDENT">round_up</span> <span class="LPAREN">(</span><span class="LIDENT">log10</span> <span class="LPAREN">(</span><span class="LIDENT">abs</span> <a href="#local_x_129"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_sd_136"><span class="LIDENT">sd</span></a><span class="COMMA">,</span> <a href="#local_dd_135"><span class="LIDENT">dd</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="OPEN">open</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare"><span class="UIDENT">Int_replace_polymorphic_compare</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_sd_131"><span class="LIDENT">sd</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="FLOAT">0.</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_sd_131"><span class="LIDENT">sd</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">17</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_x_129"><span class="LIDENT">x</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="COMMENT">(* Choose the order that is exactly representable as a float. Small positive
         integers are, but their inverses in most cases are not. *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_abs_dd_137"><span class="LIDENT">abs_dd</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#module-Pre_O.val-abs"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">abs</span></a> <a href="#local_dd_132"><span class="LIDENT">dd</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_abs_dd_137"><span class="LIDENT">abs_dd</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">22</span> <a href="import0.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_sd_131"><span class="LIDENT">sd</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">16</span><span class="EOL">
</span>      <span class="COMMENT">(* 10**22 is exactly representable as a float, but 10**23 is not, so use the slow
         path.  Similarly, if we need 16 significant digits in the result, then the integer
         [round_nearest (x &lt;op&gt; order)] might not be exactly representable as a float, since
         for some ranges we only have 15 digits of precision guaranteed.

         That said, we are still rounding twice here:

         1) first time when rounding [x *. order] or [x /. order] to the nearest float
         (just the normal way floating-point multiplication or division works),

         2) second time when applying [round_nearest_half_to_even] to the result of the
         above operation

         So for arguments within an ulp from a tie we might still produce an off-by-one
         result. *)</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LIDENT">of_string</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%.*g&quot;</span> <a href="#local_sd_131"><span class="LIDENT">sd</span></a> <a href="#local_x_129"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_order_138"><span class="LIDENT">order</span></span> <span class="EQUAL">=</span> <span class="LIDENT">int_pow</span> <span class="FLOAT">10.</span> <a href="#local_abs_dd_137"><span class="LIDENT">abs_dd</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_dd_132"><span class="LIDENT">dd</span></a> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LIDENT">round_nearest_half_to_even</span> <span class="LPAREN">(</span><a href="#local_x_129"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="#local_order_138"><span class="LIDENT">order</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(/.)"><span class="INFIXOP3">/.</span></a> <a href="#local_order_138"><span class="LIDENT">order</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LIDENT">round_nearest_half_to_even</span> <span class="LPAREN">(</span><a href="#local_x_129"><span class="LIDENT">x</span></a> <a href="import0.ml.html#val-(/.)"><span class="INFIXOP3">/.</span></a> <a href="#local_order_138"><span class="LIDENT">order</span></a><span class="RPAREN">)</span> <a href="import0.ml.html#val-(*.)"><span class="INFIXOP3">*.</span></a> <a href="#local_order_138"><span class="LIDENT">order</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_significant"><span class="LIDENT">round_significant</span></span> <span id="local_x_139"><span class="LIDENT">x</span></span> <span class="TILDE">~</span><span id="local_significant_digits_140"><span class="LIDENT">significant_digits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;=)"><span class="UIDENT">Int_replace_polymorphic_compare</span><span class="DOT">.</span><span class="LPAREN">(</span> <span class="INFIXOP0">&lt;=</span> <span class="RPAREN">)</span></a> <a href="#local_significant_digits_140"><span class="LIDENT">significant_digits</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <a href="printf.ml.html#val-invalid_argf"><span class="LIDENT">invalid_argf</span></a><span class="EOL">
</span>      <span class="STRING">&quot;Float.round_significant: invalid argument significant_digits:%d&quot;</span><span class="EOL">
</span>      <a href="#local_significant_digits_140"><span class="LIDENT">significant_digits</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">round_gen</span> <a href="#local_x_139"><span class="LIDENT">x</span></a> <span class="LABEL">~how:</span><span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="LIDENT">significant_digits</span> <a href="#local_significant_digits_140"><span class="LIDENT">significant_digits</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-round_decimal"><span class="LIDENT">round_decimal</span></span> <span id="local_x_141"><span class="LIDENT">x</span></span> <span class="TILDE">~</span><span id="local_decimal_digits_142"><span class="LIDENT">decimal_digits</span></span> <span class="EQUAL">=</span> <span class="LIDENT">round_gen</span> <a href="#local_x_141"><span class="LIDENT">x</span></a> <span class="LABEL">~how:</span><span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="LIDENT">decimal_digits</span> <a href="#local_decimal_digits_142"><span class="LIDENT">decimal_digits</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-between"><span class="LIDENT">between</span></span> <span id="local_t_143"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_low_144"><span class="LIDENT">low</span></span> <span class="TILDE">~</span><span id="local_high_145"><span class="LIDENT">high</span></span> <span class="EQUAL">=</span> <a href="#local_low_144"><span class="LIDENT">low</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_t_143"><span class="LIDENT">t</span></a> <a href="import0.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_t_143"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_high_145"><span class="LIDENT">high</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-clamp_exn"><span class="LIDENT">clamp_exn</span></span> <span id="local_t_146"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_min_147"><span class="LIDENT">min</span></span> <span class="TILDE">~</span><span id="local_max_148"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* Also fails if [min] or [max] is nan *)</span><span class="EOL">
</span>  <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_min_147"><span class="LIDENT">min</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_148"><span class="LIDENT">max</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="COMMENT">(* clamp_unchecked is in float0.ml *)</span><span class="EOL">
</span>  <span class="LIDENT">clamp_unchecked</span> <a href="#local_t_146"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_min_147"><span class="LIDENT">min</span></a> <span class="TILDE">~</span><a href="#local_max_148"><span class="LIDENT">max</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-clamp"><span class="LIDENT">clamp</span></span> <span id="local_t_149"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_min_150"><span class="LIDENT">min</span></span> <span class="TILDE">~</span><span id="local_max_151"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* Also fails if [min] or [max] is nan *)</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_min_150"><span class="LIDENT">min</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_151"><span class="LIDENT">max</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="LIDENT">clamp_unchecked</span> <a href="#local_t_149"><span class="LIDENT">t</span></a> <span class="TILDE">~</span><a href="#local_min_150"><span class="LIDENT">min</span></a> <span class="TILDE">~</span><a href="#local_max_151"><span class="LIDENT">max</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <a href="or_error.ml.html#val-error_s"><span class="UIDENT">Or_error</span><span class="DOT">.</span><span class="LIDENT">error_s</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp.ml.html#val-message"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">message</span></a><span class="EOL">
</span>         <span class="STRING">&quot;clamp requires [min &lt;= max]&quot;</span><span class="EOL">
</span>         <span class="LBRACKET">[</span> <span class="STRING">&quot;min&quot;</span><span class="COMMA">,</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">sexp_of_t</span> <a href="#local_min_150"><span class="LIDENT">min</span></a><span class="SEMI">;</span> <span class="STRING">&quot;max&quot;</span><span class="COMMA">,</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">sexp_of_t</span> <a href="#local_max_151"><span class="LIDENT">max</span></a> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(+)"><span class="LPAREN">(</span> <span class="PLUS">+</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(+.)"><span class="LPAREN">(</span> <span class="PLUSDOT">+.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-(-)"><span class="LPAREN">(</span> <span class="MINUS">-</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(-.)"><span class="LPAREN">(</span> <span class="MINUSDOT">-.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-(*)"><span class="LPAREN">(</span> <span class="STAR">*</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(*.)"><span class="LPAREN">(</span> <span class="INFIXOP3">*.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-(**)"><span class="LPAREN">(</span> <span class="INFIXOP4">**</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="INFIXOP4">**</span> <span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(/)"><span class="LPAREN">(</span> <span class="INFIXOP3">/</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(/.)"><span class="LPAREN">(</span> <span class="INFIXOP3">/.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-(%)"><span class="LPAREN">(</span> <span class="PERCENT">%</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="INFIXOP3">%.</span> <span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(~-)"><span class="LPAREN">(</span> <span class="PREFIXOP">~-</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="import0.ml.html#val-(~-.)"><span class="LPAREN">(</span> <span class="PREFIXOP">~-.</span> <span class="RPAREN">)</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sign_exn"><span class="LIDENT">sign_exn</span></span> <span id="local_t_152"><span class="LIDENT">t</span></span> <span class="COLON">:</span> <a href="sign0.ml.html#type-t"><span class="UIDENT">Sign</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_152"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Pos</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_152"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Neg</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_152"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="UIDENT">Zero</span><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="error.ml.html#val-raise_s"><span class="UIDENT">Error</span><span class="DOT">.</span><span class="LIDENT">raise_s</span></a> <span class="LPAREN">(</span><a href="../../../sexplib0/src/sexplib0/sexp.ml.html#val-message"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">message</span></a> <span class="STRING">&quot;Float.sign_exn of NAN&quot;</span> <span class="LBRACKET">[</span> <span class="STRING">&quot;&quot;</span><span class="COMMA">,</span> <span class="LIDENT">sexp_of_t</span> <a href="#local_t_152"><span class="LIDENT">t</span></a> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sign_or_nan"><span class="LIDENT">sign_or_nan</span></span> <span id="local_t_153"><span class="LIDENT">t</span></span> <span class="COLON">:</span> <a href="sign_or_nan.ml.html#module-T.type-t"><span class="UIDENT">Sign_or_nan</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_t_153"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.</span> <span class="THEN">then</span> <span class="UIDENT">Pos</span> <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_153"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">0.</span> <span class="THEN">then</span> <span class="UIDENT">Neg</span> <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_t_153"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="FLOAT">0.</span> <span class="THEN">then</span> <span class="UIDENT">Zero</span> <span class="ELSE">else</span> <span class="UIDENT">Nan</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ieee_negative"><span class="LIDENT">ieee_negative</span></span> <span id="local_t_154"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_bits_155"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-bits_of_float"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">bits_of_float</span></a> <a href="#local_t_154"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="poly0.ml.html"><span class="UIDENT">Poly</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_bits_155"><span class="LIDENT">bits</span></a> <a href="poly0.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-zero"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">zero</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exponent_bits"><span class="LIDENT">exponent_bits</span></span> <span class="EQUAL">=</span> <span class="INT">11</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mantissa_bits"><span class="LIDENT">mantissa_bits</span></span> <span class="EQUAL">=</span> <span class="INT">52</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exponent_mask64"><span class="LIDENT">exponent_mask64</span></span> <span class="EQUAL">=</span> <a href="int64.ml.html"><span class="UIDENT">Int64</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="int64.ml.html#val-shift_left"><span class="LIDENT">shift_left</span></a> <a href="int64.ml.html#val-one"><span class="LIDENT">one</span></a> <span class="LIDENT">exponent_bits</span> <a href="int64.ml.html#module-Pre_O.val-(-)"><span class="MINUS">-</span></a> <a href="int64.ml.html#val-one"><span class="LIDENT">one</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exponent_mask"><span class="LIDENT">exponent_mask</span></span> <span class="EQUAL">=</span> <a href="int64.ml.html#val-to_int_exn"><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">to_int_exn</span></a> <span class="LIDENT">exponent_mask64</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mantissa_mask"><span class="LIDENT">mantissa_mask</span></span> <span class="EQUAL">=</span> <a href="int63.ml.html"><span class="UIDENT">Int63</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">shift_left</span> <span class="LIDENT">one</span> <span class="LIDENT">mantissa_bits</span> <span class="MINUS">-</span> <span class="LIDENT">one</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mantissa_mask64"><span class="LIDENT">mantissa_mask64</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">to_int64</span> <span class="LIDENT">mantissa_mask</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ieee_exponent"><span class="LIDENT">ieee_exponent</span></span> <span id="local_t_156"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_bits_157"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-bits_of_float"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">bits_of_float</span></a> <a href="#local_t_156"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="int64.ml.html"><span class="UIDENT">Int64</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="int64.ml.html#val-bit_and"><span class="LIDENT">bit_and</span></a> <span class="LPAREN">(</span><a href="int64.ml.html#val-shift_right_logical"><span class="LIDENT">shift_right_logical</span></a> <a href="#local_bits_157"><span class="LIDENT">bits</span></a> <span class="LIDENT">mantissa_bits</span><span class="RPAREN">)</span> <span class="LIDENT">exponent_mask64</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-to_int"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">to_int</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ieee_mantissa"><span class="LIDENT">ieee_mantissa</span></span> <span id="local_t_158"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_bits_159"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-bits_of_float"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">bits_of_float</span></a> <a href="#local_t_158"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* This is safe because mantissa_mask64 &lt; Int63.max_value *)</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">of_int64_trunc</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-logand"><span class="LIDENT">logand</span></a> <a href="#local_bits_159"><span class="LIDENT">bits</span></a> <span class="LIDENT">mantissa_mask64</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-create_ieee_exn"><span class="LIDENT">create_ieee_exn</span></span> <span class="TILDE">~</span><span id="local_negative_160"><span class="LIDENT">negative</span></span> <span class="TILDE">~</span><span id="local_exponent_161"><span class="LIDENT">exponent</span></span> <span class="TILDE">~</span><span id="local_mantissa_162"><span class="LIDENT">mantissa</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="int.ml.html"><span class="UIDENT">Int</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="int.ml.html#val-bit_and"><span class="LIDENT">bit_and</span></a> <a href="#local_exponent_161"><span class="LIDENT">exponent</span></a> <span class="LIDENT">exponent_mask</span> <a href="import0.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_exponent_161"><span class="LIDENT">exponent</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="THEN">then</span> <a href="printf.ml.html#val-failwithf"><span class="LIDENT">failwithf</span></a> <span class="STRING">&quot;exponent %d out of range [0, %d]&quot;</span> <a href="#local_exponent_161"><span class="LIDENT">exponent</span></a> <span class="LIDENT">exponent_mask</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="int63.ml.html"><span class="UIDENT">Int63</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">bit_and</span> <a href="#local_mantissa_162"><span class="LIDENT">mantissa</span></a> <span class="LIDENT">mantissa_mask</span> <span class="INFIXOP0">&lt;&gt;</span> <a href="#local_mantissa_162"><span class="LIDENT">mantissa</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="THEN">then</span><span class="EOL">
</span>    <a href="printf.ml.html#val-failwithf"><span class="LIDENT">failwithf</span></a><span class="EOL">
</span>      <span class="STRING">&quot;mantissa %s out of range [0, %s]&quot;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_mantissa_162"><span class="LIDENT">mantissa</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <span class="LIDENT">mantissa_mask</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sign_bits_163"><span class="LIDENT">sign_bits</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_negative_160"><span class="LIDENT">negative</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-min_int"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">min_int</span></a> <span class="ELSE">else</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-zero"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">zero</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_expt_bits_164"><span class="LIDENT">expt_bits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-shift_left"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">shift_left</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-of_int"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">of_int</span></a> <a href="#local_exponent_161"><span class="LIDENT">exponent</span></a><span class="RPAREN">)</span> <span class="LIDENT">mantissa_bits</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_mant_bits_165"><span class="LIDENT">mant_bits</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Int63</span><span class="DOT">.</span><span class="LIDENT">to_int64</span> <a href="#local_mantissa_162"><span class="LIDENT">mantissa</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bits_166"><span class="LIDENT">bits</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-logor"><span class="LIDENT">logor</span></a> <a href="#local_sign_bits_163"><span class="LIDENT">sign_bits</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-logor"><span class="LIDENT">logor</span></a> <a href="#local_expt_bits_164"><span class="LIDENT">expt_bits</span></a> <a href="#local_mant_bits_165"><span class="LIDENT">mant_bits</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-float_of_bits"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">float_of_bits</span></a> <a href="#local_bits_166"><span class="LIDENT">bits</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-create_ieee"><span class="LIDENT">create_ieee</span></span> <span class="TILDE">~</span><span id="local_negative_167"><span class="LIDENT">negative</span></span> <span class="TILDE">~</span><span id="local_exponent_168"><span class="LIDENT">exponent</span></span> <span class="TILDE">~</span><span id="local_mantissa_169"><span class="LIDENT">mantissa</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="or_error.ml.html#val-try_with"><span class="UIDENT">Or_error</span><span class="DOT">.</span><span class="LIDENT">try_with</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">create_ieee_exn</span> <span class="TILDE">~</span><a href="#local_negative_167"><span class="LIDENT">negative</span></a> <span class="TILDE">~</span><a href="#local_exponent_168"><span class="LIDENT">exponent</span></a> <span class="TILDE">~</span><a href="#local_mantissa_169"><span class="LIDENT">mantissa</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Terse"><span class="MODULE">module</span> <span class="UIDENT">Terse</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Terse.type-t"><span class="TYPE">type</span> <span class="NONREC">nonrec</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Terse.val-t_of_sexp"><span class="LIDENT">t_of_sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">t_of_sexp</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Terse.val-to_string"><span class="LIDENT">to_string</span></span> <span id="local_x_170"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%.8G&quot;</span> <a href="#local_x_170"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Terse.val-sexp_of_t"><span class="LIDENT">sexp_of_t</span></span> <span id="local_x_171"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="LIDENT">to_string</span> <a href="#local_x_171"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Terse.val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_x_172"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_string</span> <a href="#local_x_172"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Terse.val-t_sexp_grammar"><span class="LIDENT">t_sexp_grammar</span></span> <span class="EQUAL">=</span> <span class="LIDENT">t_sexp_grammar</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="comparable.ml.html#module-With_zero"><span class="UIDENT">Comparable</span><span class="DOT">.</span><span class="UIDENT">With_zero</span></a> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">T</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_zero_173"><span class="LIDENT">zero</span></span> <span class="EQUAL">=</span> <span class="LIDENT">zero</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* These are partly here as a performance hack to avoid some boxing we're getting with
   the versions we get from [With_zero].  They also make [Float.is_negative nan] and
   [Float.is_non_positive nan] return [false]; the versions we get from [With_zero] return
   [true]. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_positive"><span class="LIDENT">is_positive</span></span> <span id="local_t_174"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_174"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_non_negative"><span class="LIDENT">is_non_negative</span></span> <span id="local_t_175"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_175"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_negative"><span class="LIDENT">is_negative</span></span> <span id="local_t_176"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_176"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_non_positive"><span class="LIDENT">is_non_positive</span></span> <span id="local_t_177"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <a href="#local_t_177"><span class="LIDENT">t</span></a> <a href="import0.ml.html#module-Float_replace_polymorphic_compare.val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="FLOAT">0.</span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="pretty_printer.ml.html#module-Register"><span class="UIDENT">Pretty_printer</span><span class="DOT">.</span><span class="UIDENT">Register</span></a> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">T</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_module_name_178"><span class="LIDENT">module_name</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;Base.Float&quot;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_to_string_179"><span class="LIDENT">to_string</span></span> <span class="EQUAL">=</span> <span class="LIDENT">to_string</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-O"><span class="MODULE">module</span> <span class="UIDENT">O</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(+)"><span class="LPAREN">(</span> <span class="PLUS">+</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="PLUS">+</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(-)"><span class="LPAREN">(</span> <span class="MINUS">-</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="MINUS">-</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(*)"><span class="LPAREN">(</span> <span class="STAR">*</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="STAR">*</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(/)"><span class="LPAREN">(</span> <span class="INFIXOP3">/</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="INFIXOP3">/</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(%)"><span class="LPAREN">(</span> <span class="PERCENT">%</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="PERCENT">%</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(~-)"><span class="LPAREN">(</span> <span class="PREFIXOP">~-</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="PREFIXOP">~-</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-(**)"><span class="LPAREN">(</span> <span class="INFIXOP4">**</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="INFIXOP4">**</span> <span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="LPAREN">(</span><a href="import0.ml.html#module-Float_replace_polymorphic_compare"><span class="UIDENT">Float_replace_polymorphic_compare</span></a> <span class="COLON">:</span> <a href="comparisons.ml.html#module-type-Infix"><span class="UIDENT">Comparisons</span><span class="DOT">.</span><span class="UIDENT">Infix</span></a> <span class="WITH">with</span> <span id="def_187"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="COLONEQUAL">:=</span> <span class="LIDENT">t</span></span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-abs"><span class="LIDENT">abs</span></span> <span class="EQUAL">=</span> <span class="LIDENT">abs</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-neg"><span class="LIDENT">neg</span></span> <span class="EQUAL">=</span> <span class="LIDENT">neg</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-zero"><span class="LIDENT">zero</span></span> <span class="EQUAL">=</span> <span class="LIDENT">zero</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-of_int"><span class="LIDENT">of_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_int</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O.val-of_float"><span class="LIDENT">of_float</span></span> <span id="local_x_180"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_x_180"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-O_dot"><span class="MODULE">module</span> <span class="UIDENT">O_dot</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(*.)"><span class="LPAREN">(</span> <span class="INFIXOP3">*.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="STAR">*</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(+.)"><span class="LPAREN">(</span> <span class="PLUSDOT">+.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="PLUS">+</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(-.)"><span class="LPAREN">(</span> <span class="MINUSDOT">-.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="MINUS">-</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(/.)"><span class="LPAREN">(</span> <span class="INFIXOP3">/.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="INFIXOP3">/</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(%.)"><span class="LPAREN">(</span> <span class="INFIXOP3">%.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="PERCENT">%</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(~-.)"><span class="LPAREN">(</span> <span class="PREFIXOP">~-.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="PREFIXOP">~-</span> <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-O_dot.val-(**.)"><span class="LPAREN">(</span> <span class="INFIXOP4">**.</span> <span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span> <span class="INFIXOP4">**</span> <span class="RPAREN">)</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Private"><span class="MODULE">module</span> <span class="UIDENT">Private</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-box"><span class="LIDENT">box</span></span> <span class="EQUAL">=</span> <span class="LIDENT">box</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-clamp_unchecked"><span class="LIDENT">clamp_unchecked</span></span> <span class="EQUAL">=</span> <span class="LIDENT">clamp_unchecked</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-lower_bound_for_int"><span class="LIDENT">lower_bound_for_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">lower_bound_for_int</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-upper_bound_for_int"><span class="LIDENT">upper_bound_for_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">upper_bound_for_int</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-specialized_hash"><span class="LIDENT">specialized_hash</span></span> <span class="EQUAL">=</span> <a href="hash.ml.html#module-T.module-Builtin.val-hash_float"><span class="LIDENT">hash_float</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-one_ulp_less_than_half"><span class="LIDENT">one_ulp_less_than_half</span></span> <span class="EQUAL">=</span> <span class="LIDENT">one_ulp_less_than_half</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-int63_round_nearest_portable_alloc_exn"><span class="LIDENT">int63_round_nearest_portable_alloc_exn</span></span> <span class="EQUAL">=</span> <span class="LIDENT">int63_round_nearest_portable_alloc_exn</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-int63_round_nearest_arch64_noalloc_exn"><span class="LIDENT">int63_round_nearest_arch64_noalloc_exn</span></span> <span class="EQUAL">=</span> <span class="LIDENT">int63_round_nearest_arch64_noalloc_exn</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Private.val-iround_nearest_exn_64"><span class="LIDENT">iround_nearest_exn_64</span></span> <span class="EQUAL">=</span> <span class="LIDENT">iround_nearest_exn_64</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Include type-specific [Replace_polymorphic_compare] at the end, after
   including functor application that could shadow its definitions. This is
   here so that efficient versions of the comparison functions are exported by
   this module. *)</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="import0.ml.html#module-Float_replace_polymorphic_compare"><span class="UIDENT">Float_replace_polymorphic_compare</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* These functions specifically replace defaults in replace_polymorphic_compare.

   The desired behavior here is to propagate a nan if either argument is nan. Because the
   first comparison will always return false if either argument is nan, it suffices to
   check if x is nan. Then, when x is nan or both x and y are nan, we return x = nan; and
   when y is nan but not x, we return y = nan.

   There are various ways to implement these functions.  The benchmark below shows a few
   different versions.  This benchmark was run over an array of random floats (none of
   which are nan).

   ┌────────────────────────────────────────────────┬──────────┐
   │ Name                                           │ Time/Run │
   ├────────────────────────────────────────────────┼──────────┤
   │ if is_nan x then x else if x &lt; y then x else y │   2.42us │
   │ if is_nan x || x &lt; y then x else y             │   2.02us │
   │ if x &lt; y || is_nan x then x else y             │   1.88us │
   └────────────────────────────────────────────────┴──────────┘

   The benchmark below was run when x &gt; y is always true (again, no nan values).

   ┌────────────────────────────────────────────────┬──────────┐
   │ Name                                           │ Time/Run │
   ├────────────────────────────────────────────────┼──────────┤
   │ if is_nan x then x else if x &lt; y then x else y │   2.83us │
   │ if is_nan x || x &lt; y then x else y             │   1.97us │
   │ if x &lt; y || is_nan x then x else y             │   1.56us │
   └────────────────────────────────────────────────┴──────────┘
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-min"><span class="LIDENT">min</span></span> <span class="LPAREN">(</span><span id="local_x_181"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span id="local_y_182"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_x_181"><span class="LIDENT">x</span></a> <span class="LESS">&lt;</span> <a href="#local_y_182"><span class="LIDENT">y</span></a> <a href="import0.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">is_nan</span> <a href="#local_x_181"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_x_181"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_y_182"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-max"><span class="LIDENT">max</span></span> <span class="LPAREN">(</span><span id="local_x_183"><span class="LIDENT">x</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span id="local_y_184"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_x_183"><span class="LIDENT">x</span></a> <span class="GREATER">&gt;</span> <a href="#local_y_184"><span class="LIDENT">y</span></a> <a href="import0.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">is_nan</span> <a href="#local_x_183"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_x_183"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_y_184"><span class="LIDENT">y</span></a><span class="EOL">
</span></span></code></pre></body></html>
