<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cmarkit_html (cmarkit.cmarkit.Cmarkit_html)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../sherlodoc_db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../../index.html">Up</a> ‚Äì <a href="../../../index.html">üè†</a> &#x00BB; <a href="../../index.html">Cmarkit  <span class="version">v0.3.0</span></a> &#x00BB; Library <code>cmarkit</code> &#x00BB; Cmarkit_html</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Cmarkit_html</span></code></h1><p>Rendering CommonMark to HTML.</p><p>Generates HTML fragments, consult the <a href="#integration" title="integration">integration notes</a> for requirements on the webpage.</p><p>See <span class="xref-unresolved" title="index.quick">a quick example</span> and <a href="#page_frame" title="page_frame">another one</a>.</p><p><b>Warning.</b> Rendering outputs are unstable, they may be tweaked even between minor versions of the library.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#rendering">Rendering</a></li><li><a href="#renderers">Renderers</a></li><li><a href="#render">Render functions</a></li><li><a href="#integration">HTML integration notes</a><ul><li><a href="#code_blocks">Code blocks</a></li><li><a href="#ids">Heading identifiers</a></li><li><a href="#math">Maths</a></li><li><a href="#page_frame">Page frame</a></li></ul></li></ul></nav><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">Cmarkit  <span class="version">v0.3.0</span></a><ul><li>Library <code>cmarkit</code><ul><li><a href="../Cmarkit/index.html">Cmarkit</a></li><li><a href="../Cmarkit_commonmark/index.html">Cmarkit_commonmark</a></li><li><a href="#" class="current_unit">Cmarkit_html</a></li><li><a href="../Cmarkit_latex/index.html">Cmarkit_latex</a></li><li><a href="../Cmarkit_renderer/index.html">Cmarkit_renderer</a></li></ul></li></ul></li></ul></nav></div><div class="odoc-content"><h2 id="rendering"><a href="#rendering" class="anchor"></a>Rendering</h2><div class="odoc-spec"><div class="spec value anchored" id="val-of_doc"><a href="#val-of_doc" class="anchor"></a><code><span><span class="keyword">val</span> of_doc : <span><span class="optlabel">?backend_blocks</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span class="label">safe</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../Cmarkit/Doc/index.html#type-t">Cmarkit.Doc.t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>of_doc ~safe d</code> is an HTML fragment for <code>d</code>. See <a href="#val-renderer"><code>renderer</code></a> for more details and documentation about rendering options.</p></div></div><h2 id="renderers"><a href="#renderers" class="anchor"></a>Renderers</h2><div class="odoc-spec"><div class="spec value anchored" id="val-renderer"><a href="#val-renderer" class="anchor"></a><code><span><span class="keyword">val</span> renderer : <span><span class="optlabel">?backend_blocks</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span class="label">safe</span>:bool <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../Cmarkit_renderer/index.html#type-t">Cmarkit_renderer.t</a></span></code></div><div class="spec-doc"><p><code>renderer ~safe ()</code> is the default HTML renderer. This renders the strict CommonMark abstract syntax tree and the supported Cmarkit <a href="../Cmarkit/index.html#extensions" title="extensions">extensions</a>.</p><p>The inline, block and document renderers always return <code>true</code>. Unknown block and inline values are rendered by an HTML comment.</p><p>The following options are available:</p><ul><li><p><code>safe</code>, if <code>true</code> <a href="../Cmarkit/Block/index.html#extension-Html_block" title="Cmarkit.Block.Html_block">HTML blocks</a> and <a href="../Cmarkit/Inline/index.html#extension-Raw_html" title="Cmarkit.Inline.Raw_html">raw HTML inlines</a> are discarded and replaced by an HTML comment in the output. Besides the URLs of autolinks, links and images that satisfy <a href="../Cmarkit/Inline/Link/index.html#val-is_unsafe"><code>Cmarkit.Inline.Link.is_unsafe</code></a> are replaced by the empty string.</p><p>Using safe renderings is a good first step at preventing <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">XSS</a> from untrusted user inputs but you should rather post-process rendering outputs with a dedicated HTML sanitizer.</p></li><li><code>backend_blocks</code>, if <code>true</code>, code blocks with language <code>=html</code> are written verbatim in the output (iff <code>safe</code> is <code>true</code>) and any other code block whose langage starts with <code>=</code> is dropped. Defaults to <code>false</code>.</li></ul><p>See <a href="../Cmarkit_renderer/index.html#example" title="example">this example</a> to extend or selectively override the renderer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-xhtml_renderer"><a href="#val-xhtml_renderer" class="anchor"></a><code><span><span class="keyword">val</span> xhtml_renderer : 
  <span><span class="optlabel">?backend_blocks</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">safe</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="../Cmarkit_renderer/index.html#type-t">Cmarkit_renderer.t</a></span></code></div><div class="spec-doc"><p><code>xhtml_renderer</code> is like <a href="#val-renderer"><code>renderer</code></a> but explicitely closes empty tags to possibly make the output valid XML. Note that it still renders HTML blocks and inline raw HTML unless <a href="#val-safe"><code>safe</code></a> is <code>true</code> (which also suppresses some URLs).</p><p>See <a href="../Cmarkit_renderer/index.html#example" title="example">this example</a> to extend or selectively override the renderer.</p></div></div><h2 id="render"><a href="#render" class="anchor"></a>Render functions</h2><p>Only useful if you extend the renderer.</p><div class="odoc-spec"><div class="spec value anchored" id="val-safe"><a href="#val-safe" class="anchor"></a><code><span><span class="keyword">val</span> safe : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>safe c</code> is <code>true</code> if a safe rendering is requested. See <a href="#val-renderer"><code>renderer</code></a> for more information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-html_escaped_uchar"><a href="#val-html_escaped_uchar" class="anchor"></a><code><span><span class="keyword">val</span> html_escaped_uchar : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#type-t">Uchar.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>html_escaped_uchar c u</code> renders the UTF-8 encoding of <code>u</code> on <code>c</code> with HTML markup delimiters <code>&lt;</code>‚ÄÇ<code>&gt;</code>‚ÄÇ<code>&amp;</code> and <code>&quot;</code> escaped to HTML entities (Single quotes <code>'</code> are not escaped use <code>&quot;</code> to delimit your attributes). This also renders U+0000 to <a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#val-rep"><code>Uchar.rep</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-buffer_add_html_escaped_uchar"><a href="#val-buffer_add_html_escaped_uchar" class="anchor"></a><code><span><span class="keyword">val</span> buffer_add_html_escaped_uchar : <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Buffer/index.html#type-t">Buffer.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Uchar/index.html#type-t">Uchar.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>buffer_add_html_escaped_uchar</code> is <a href="#val-html_escaped_uchar"><code>html_escaped_uchar</code></a> but appends to a buffer value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-html_escaped_string"><a href="#val-html_escaped_string" class="anchor"></a><code><span><span class="keyword">val</span> html_escaped_string : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>html_escaped_string c s</code> renders string <code>s</code> on <code>c</code> with HTML markup delimiters <code>&lt;</code>, <code>&gt;</code>, <code>&amp;</code>, and <code>&quot;</code> escaped to HTML entities (Single quotes <code>'</code> are not escaped, use <code>&quot;</code> to delimit your attributes).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-buffer_add_html_escaped_string"><a href="#val-buffer_add_html_escaped_string" class="anchor"></a><code><span><span class="keyword">val</span> buffer_add_html_escaped_string : <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Buffer/index.html#type-t">Buffer.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>buffer_add_html_escaped_string</code> is <a href="#val-html_escaped_string"><code>html_escaped_string</code></a> but appends to a buffer value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pct_encoded_string"><a href="#val-pct_encoded_string" class="anchor"></a><code><span><span class="keyword">val</span> pct_encoded_string : <span><a href="../Cmarkit_renderer/index.html#type-context">Cmarkit_renderer.context</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pct_encoded_string c s</code> renders string <code>s</code> on <code>c</code> with everything percent encoded except <code>%</code> and the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.3"><code>unreserved</code></a>, <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.2"><code>sub-delims</code></a> and the <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-2.2"><code>gen-delims</code></a> URI characters except brackets <code>[</code> and <code>]</code> (to match the <code>cmark</code> tool).</p><p>In other words only characters <code>%</code>‚ÄÇ<code>a-z</code>‚ÄÇ<code>A-Z</code>‚ÄÇ<code>0-9</code>‚ÄÇ<code>-</code>‚ÄÇ<code>.</code>‚ÄÇ<code>_</code>‚ÄÇ<code>~</code>‚ÄÇ<code>!</code> <code>$</code>‚ÄÇ<code>&amp;</code>‚ÄÇ<code>'</code>‚ÄÇ<code>(</code>‚ÄÇ<code>)</code>‚ÄÇ<code>*</code>‚ÄÇ<code>+</code>‚ÄÇ<code>,</code>‚ÄÇ<code>;</code>‚ÄÇ<code>=</code>‚ÄÇ<code>:</code>‚ÄÇ<code>/</code>‚ÄÇ<code>?</code>‚ÄÇ<code>#</code>‚ÄÇ<code>@</code> are not percent-encoded.</p><p><b>Warning.</b> The function also replaces both <code>&amp;</code> and <code>'</code> by their corresponding HTML entities, so you can't use this in a context that doesn't allow entities. Besides this assumes <code>s</code> may already have percent encoded bits so it doesn't percent encode <code>%</code>, as such you can't use this as a general percent encode function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-buffer_add_pct_encoded_string"><a href="#val-buffer_add_pct_encoded_string" class="anchor"></a><code><span><span class="keyword">val</span> buffer_add_pct_encoded_string : <span><a href="../../../ocaml-base-compiler/stdlib/Stdlib/Buffer/index.html#type-t">Buffer.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>buffer_add_pct_encoded_string b s</code> is <a href="#val-pct_encoded_string"><code>pct_encoded_string</code></a> but appends to a buffer value.</p></div></div><h2 id="integration"><a href="#integration" class="anchor"></a>HTML integration notes</h2><h3 id="code_blocks"><a href="#code_blocks" class="anchor"></a>Code blocks</h3><p>If a language <code>lang</code> can be extracted from the info string of a code block with <a href="../Cmarkit/Block/Code_block/index.html#val-language_of_info_string"><code>Cmarkit.Block.Code_block.language_of_info_string</code></a>, a <code>language-lang</code> class is added to the corresponding <code>code</code> element. If you want to highlight the syntax, adding <a href="https://highlightjs.org/">highlight.js</a> to your page is an option.</p><h3 id="ids"><a href="#ids" class="anchor"></a>Heading identifiers</h3><p>Headings identifiers and anchors are added to the output whenever <a href="../Cmarkit/Block/Heading/index.html#val-id"><code>Cmarkit.Block.Heading.id</code></a> holds a value. If the identifier already exists it is made unique by appending <code>&quot;-&quot;</code> and the first number starting from 1 that makes it unique.</p><h3 id="math"><a href="#math" class="anchor"></a>Maths</h3><p>If your document has <a href="../Cmarkit/Inline/index.html#extension-Ext_math_span"><code>Cmarkit.Inline.Ext_math_span</code></a> inlines or <a href="../Cmarkit/Block/index.html#extension-Ext_math_block"><code>Cmarkit.Block.Ext_math_block</code></a> blocks, the default renderer outputs them in <code>\(</code>, <code>\)</code> and <code>\[</code>, <code>\]</code> delimiters. You should add <a href="https://katex.org/">K<sup>A</sup>T<sub>E</sub>X</a> or <a href="https://www.mathjax.org/">MathJax</a> in your page to let these bits be rendered by the typography they deserve.</p><h3 id="page_frame"><a href="#page_frame" class="anchor"></a>Page frame</h3><p>The default renderers only generate HTML fragments. You may want to add a page frame. For example:</p><pre class="language-ocaml"><code>let html_doc_of_md ?(lang = &quot;en&quot;) ~title ~safe md =
  let doc = Cmarkit.Doc.of_string md in
  let r = Cmarkit_html.renderer ~safe () in
  let buffer_add_doc = Cmarkit_renderer.buffer_add_doc r in
  let buffer_add_title = Cmarkit_html.buffer_add_html_escaped_string in
  Printf.kbprintf Buffer.contents (Buffer.create 1024)
{|&lt;html lang=&quot;%s&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;title&gt;%a&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
%a&lt;/body&gt;
&lt;/html&gt;|}
    lang buffer_add_title title buffer_add_doc doc</code></pre></div></body></html>
