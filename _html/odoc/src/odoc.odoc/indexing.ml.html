<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: indexing.ml (odoc.src.odoc.odoc)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">The odoc documentation generator</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; odoc.odoc &#x00BB; indexing.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>indexing.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">The odoc documentation generator</a><ul><li><a href="../../odoc_for_authors.html"><code>odoc</code> for Authors</a></li><li><a href="../../cheatsheet.html">Cheatsheet</a></li><li><a href="../../dune.html">Dune and odoc</a></li><li><a href="../../features.html">Language Features</a></li><li><a href="../../ocamldoc_differences.html">Markup Differences From OCamldoc</a></li><li><a href="../../interface.html"><code>odoc</code> Interface Guarantees</a></li><li><a href="../../driver.html">How to Drive <code>odoc</code></a></li><li><a href="../../json.html">JSON output</a></li><li><a href="../../deprecated/index.html">Deprecated features</a></li><li>Library <code>odoc.document</code><ul><li><a href="../../odoc.document/Odoc_document/index.html">Odoc_document</a></li></ul></li><li>Library <code>odoc.examples</code><ul><li><a href="../../odoc.examples/Odoc_examples/index.html">Odoc_examples</a></li></ul></li><li>Library <code>odoc.html</code><ul><li><a href="../../odoc.html/Odoc_html/index.html">Odoc_html</a></li></ul></li><li>Library <code>odoc.html_support_files</code><ul><li><a href="../../odoc.html_support_files/Odoc_html_support_files/index.html">Odoc_html_support_files</a></li></ul></li><li>Library <code>odoc.index</code><ul><li><a href="../../odoc.index/Odoc_index/index.html">Odoc_index</a></li></ul></li><li>Library <code>odoc.json_index</code><ul><li><a href="../../odoc.json_index/Odoc_json_index/index.html">Odoc_json_index</a></li></ul></li><li>Library <code>odoc.latex</code><ul><li><a href="../../odoc.latex/Odoc_latex/index.html">Odoc_latex</a></li></ul></li><li>Library <code>odoc.loader</code><ul><li><a href="../../odoc.loader/Odoc_loader/index.html">Odoc_loader</a></li></ul></li><li>Library <code>odoc.manpage</code><ul><li><a href="../../odoc.manpage/Odoc_manpage/index.html">Odoc_manpage</a></li></ul></li><li>Library <code>odoc.model</code><ul><li><a href="../../odoc.model/Odoc_model/index.html">Odoc_model</a></li></ul></li><li>Library <code>odoc.model_desc</code><ul><li><a href="../../odoc.model_desc/Odoc_model_desc/index.html">Odoc_model_desc</a></li></ul></li><li>Library <code>odoc.ocamlary</code><ul><li><a href="../../odoc.ocamlary/Ocamlary/index.html">Ocamlary</a></li></ul></li><li>Library <code>odoc.occurrences</code><ul><li><a href="../../odoc.occurrences/Odoc_occurrences/index.html">Odoc_occurrences</a></li></ul></li><li>Library <code>odoc.odoc</code><ul><li><a href="../../odoc.odoc/Odoc_odoc/index.html">Odoc_odoc</a></li></ul></li><li>Library <code>odoc.odoc_utils</code><ul><li><a href="../../odoc.odoc_utils/Odoc_utils/index.html">Odoc_utils</a></li></ul></li><li>Library <code>odoc.search</code><ul><li><a href="../../odoc.search/Odoc_search/index.html">Odoc_search</a></li></ul></li><li>Library <code>odoc.search_html_frontend</code><ul><li><a href="../../odoc.search_html_frontend/Odoc_html_frontend/index.html">Odoc_html_frontend</a></li></ul></li><li>Library <code>odoc.syntax_highlighter</code><ul><li><a href="../../odoc.syntax_highlighter/Syntax_highlighter/index.html">Syntax_highlighter</a></li></ul></li><li>Library <code>odoc.xref2</code><ul><li><a href="../../odoc.xref2/Odoc_xref2/index.html">Odoc_xref2</a></li></ul></li><li>Library <code>odoc.xref_test</code><ul><li><a href="../../odoc.xref_test/Odoc_xref_test/index.html">Odoc_xref_test</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>odoc.document<ul><li><a href="../odoc.document/ML.ml.html">ML.ml</a></li><li><a href="../odoc.document/codefmt.ml.html">codefmt.ml</a></li><li><a href="../odoc.document/comment.ml.html">comment.ml</a></li><li><a href="../odoc.document/compat.ml.html">compat.ml</a></li><li><a href="../odoc.document/doctree.ml.html">doctree.ml</a></li><li><a href="../odoc.document/generator.ml.html">generator.ml</a></li><li><a href="../odoc.document/generator_signatures.ml.html">generator_signatures.ml</a></li><li><a href="../odoc.document/odoc_document.ml.html">odoc_document.ml</a></li><li><a href="../odoc.document/reason.ml.html">reason.ml</a></li><li><a href="../odoc.document/renderer.ml.html">renderer.ml</a></li><li><a href="../odoc.document/sidebar.ml.html">sidebar.ml</a></li><li><a href="../odoc.document/targets.ml.html">targets.ml</a></li><li><a href="../odoc.document/types.ml.html">types.ml</a></li><li><a href="../odoc.document/url.ml.html">url.ml</a></li><li><a href="../odoc.document/utils.ml.html">utils.ml</a></li></ul></li><li>odoc.examples<ul><li><a href="../odoc.examples/odoc_examples.ml.html">odoc_examples.ml</a></li><li><a href="../odoc.examples/odoc_examples__.ml.html">odoc_examples__.ml</a></li></ul></li><li>odoc.html<ul><li><a href="../odoc.html/config.ml.html">config.ml</a></li><li><a href="../odoc.html/generator.ml.html">generator.ml</a></li><li><a href="../odoc.html/html_fragment_json.ml.html">html_fragment_json.ml</a></li><li><a href="../odoc.html/html_page.ml.html">html_page.ml</a></li><li><a href="../odoc.html/html_source.ml.html">html_source.ml</a></li><li><a href="../odoc.html/link.ml.html">link.ml</a></li><li><a href="../odoc.html/odoc_html.ml.html">odoc_html.ml</a></li><li><a href="../odoc.html/odoc_html__.ml.html">odoc_html__.ml</a></li><li><a href="../odoc.html/sidebar.ml.html">sidebar.ml</a></li><li><a href="../odoc.html/types.ml.html">types.ml</a></li></ul></li><li>odoc.html_support_files<ul><li><a href="../odoc.html_support_files/odoc_html_support_files.ml.html">odoc_html_support_files.ml</a></li></ul></li><li>odoc.index<ul><li><a href="../odoc.index/entry.ml.html">entry.ml</a></li><li><a href="../odoc.index/in_progress.ml.html">in_progress.ml</a></li><li><a href="../odoc.index/odoc_index.ml.html">odoc_index.ml</a></li><li><a href="../odoc.index/odoc_index__.ml.html">odoc_index__.ml</a></li><li><a href="../odoc.index/skeleton.ml.html">skeleton.ml</a></li><li><a href="../odoc.index/skeleton_of.ml.html">skeleton_of.ml</a></li></ul></li><li>odoc.json_index<ul><li><a href="../odoc.json_index/json_display.ml.html">json_display.ml</a></li><li><a href="../odoc.json_index/json_search.ml.html">json_search.ml</a></li><li><a href="../odoc.json_index/odoc_json_index.ml.html">odoc_json_index.ml</a></li></ul></li><li>odoc.latex<ul><li><a href="../odoc.latex/generator.ml.html">generator.ml</a></li><li><a href="../odoc.latex/odoc_latex.ml.html">odoc_latex.ml</a></li><li><a href="../odoc.latex/raw.ml.html">raw.ml</a></li><li><a href="../odoc.latex/types.ml.html">types.ml</a></li></ul></li><li>odoc.loader<ul><li><a href="../odoc.loader/cmi.ml.html">cmi.ml</a></li><li><a href="../odoc.loader/cmt.ml.html">cmt.ml</a></li><li><a href="../odoc.loader/cmti.ml.html">cmti.ml</a></li><li><a href="../odoc.loader/doc_attr.ml.html">doc_attr.ml</a></li><li><a href="../odoc.loader/ident_env.ml.html">ident_env.ml</a></li><li><a href="../odoc.loader/implementation.ml.html">implementation.ml</a></li><li><a href="../odoc.loader/odoc_loader.ml.html">odoc_loader.ml</a></li><li><a href="../odoc.loader/odoc_loader__.ml.html">odoc_loader__.ml</a></li><li><a href="../odoc.loader/typedtree_traverse.ml.html">typedtree_traverse.ml</a></li></ul></li><li>odoc.manpage<ul><li><a href="../odoc.manpage/generator.ml.html">generator.ml</a></li><li><a href="../odoc.manpage/link.ml.html">link.ml</a></li><li><a href="../odoc.manpage/odoc_manpage.ml.html">odoc_manpage.ml</a></li></ul></li><li>odoc.model<ul><li><a href="../odoc.model/comment.ml.html">comment.ml</a></li><li><a href="../odoc.model/compat.ml.html">compat.ml</a></li><li><a href="../odoc.model/error.ml.html">error.ml</a></li><li><a href="../odoc.model/frontmatter.ml.html">frontmatter.ml</a></li><li><a href="../odoc.model/lang.ml.html">lang.ml</a></li><li><a href="../odoc.model/location_.ml.html">location_.ml</a></li><li><a href="../odoc.model/names.ml.html">names.ml</a></li><li><a href="../odoc.model/odoc_model.ml.html">odoc_model.ml</a></li><li><a href="../odoc.model/odoc_model__.ml.html">odoc_model__.ml</a></li><li><a href="../odoc.model/paths.ml.html">paths.ml</a></li><li><a href="../odoc.model/paths_types.ml.html">paths_types.ml</a></li><li><a href="../odoc.model/reference.ml.html">reference.ml</a></li><li><a href="../odoc.model/root.ml.html">root.ml</a></li><li><a href="../odoc.model/semantics.ml.html">semantics.ml</a></li></ul></li><li>odoc.model_desc<ul><li><a href="../odoc.model_desc/comment_desc.ml.html">comment_desc.ml</a></li><li><a href="../odoc.model_desc/lang_desc.ml.html">lang_desc.ml</a></li><li><a href="../odoc.model_desc/odoc_model_desc.ml.html">odoc_model_desc.ml</a></li><li><a href="../odoc.model_desc/paths_desc.ml.html">paths_desc.ml</a></li><li><a href="../odoc.model_desc/type_desc.ml.html">type_desc.ml</a></li></ul></li><li>odoc.occurrences<ul><li><a href="../odoc.occurrences/odoc_occurrences.ml.html">odoc_occurrences.ml</a></li><li><a href="../odoc.occurrences/odoc_occurrences__.ml.html">odoc_occurrences__.ml</a></li><li><a href="../odoc.occurrences/table.ml.html">table.ml</a></li></ul></li><li>odoc.odoc<ul><li><a href="asset.ml.html">asset.ml</a></li><li><a href="classify.ml.html">classify.ml</a></li><li><a href="compile.ml.html">compile.ml</a></li><li><a href="depends.ml.html">depends.ml</a></li><li><a href="fs.ml.html">fs.ml</a></li><li><a href="html_fragment.ml.html">html_fragment.ml</a></li><li><a href="html_page.ml.html">html_page.ml</a></li><li><a href="#" class="current_unit">indexing.ml</a></li><li><a href="latex.ml.html">latex.ml</a></li><li><a href="man_page.ml.html">man_page.ml</a></li><li><a href="occurrences.ml.html">occurrences.ml</a></li><li><a href="odoc_file.ml.html">odoc_file.ml</a></li><li><a href="odoc_link.ml.html">odoc_link.ml</a></li><li><a href="odoc_odoc.ml.html">odoc_odoc.ml</a></li><li><a href="or_error.ml.html">or_error.ml</a></li><li><a href="rendering.ml.html">rendering.ml</a></li><li><a href="resolver.ml.html">resolver.ml</a></li><li><a href="sidebar.ml.html">sidebar.ml</a></li><li><a href="source.ml.html">source.ml</a></li><li><a href="support_files.ml.html">support_files.ml</a></li><li><a href="url.ml.html">url.ml</a></li></ul></li><li>odoc.odoc_utils<ul><li><a href="../odoc.odoc_utils/json.ml.html">json.ml</a></li><li><a href="../odoc.odoc_utils/odoc_list.ml.html">odoc_list.ml</a></li><li><a href="../odoc.odoc_utils/odoc_utils.ml.html">odoc_utils.ml</a></li><li><a href="../odoc.odoc_utils/odoc_utils__.ml.html">odoc_utils__.ml</a></li><li><a href="../odoc.odoc_utils/tree.ml.html">tree.ml</a></li></ul></li><li>odoc.search<ul><li><a href="../odoc.search/html.ml.html">html.ml</a></li><li><a href="../odoc.search/odoc_search.ml.html">odoc_search.ml</a></li><li><a href="../odoc.search/text.ml.html">text.ml</a></li></ul></li><li>odoc.search_html_frontend<ul><li><a href="../odoc.search_html_frontend/odoc_html_frontend.ml.html">odoc_html_frontend.ml</a></li></ul></li><li>odoc.syntax_highlighter<ul><li><a href="../odoc.syntax_highlighter/syntax_highlighter.ml.html">syntax_highlighter.ml</a></li></ul></li><li>odoc.xref2<ul><li><a href="../odoc.xref2/cfrag.ml.html">cfrag.ml</a></li><li><a href="../odoc.xref2/compile.ml.html">compile.ml</a></li><li><a href="../odoc.xref2/component.ml.html">component.ml</a></li><li><a href="../odoc.xref2/cpath.ml.html">cpath.ml</a></li><li><a href="../odoc.xref2/env.ml.html">env.ml</a></li><li><a href="../odoc.xref2/errors.ml.html">errors.ml</a></li><li><a href="../odoc.xref2/expand_tools.ml.html">expand_tools.ml</a></li><li><a href="../odoc.xref2/find.ml.html">find.ml</a></li><li><a href="../odoc.xref2/ident.ml.html">ident.ml</a></li><li><a href="../odoc.xref2/lang_of.ml.html">lang_of.ml</a></li><li><a href="../odoc.xref2/link.ml.html">link.ml</a></li><li><a href="../odoc.xref2/lookup_failures.ml.html">lookup_failures.ml</a></li><li><a href="../odoc.xref2/odoc_xref2.ml.html">odoc_xref2.ml</a></li><li><a href="../odoc.xref2/ref_tools.ml.html">ref_tools.ml</a></li><li><a href="../odoc.xref2/shape_tools.ml.html">shape_tools.ml</a></li><li><a href="../odoc.xref2/strengthen.ml.html">strengthen.ml</a></li><li><a href="../odoc.xref2/subst.ml.html">subst.ml</a></li><li><a href="../odoc.xref2/tools.ml.html">tools.ml</a></li></ul></li><li>odoc.xref_test<ul><li><a href="../odoc.xref_test/common.ml.html">common.ml</a></li><li><a href="../odoc.xref_test/odoc_xref_test.ml.html">odoc_xref_test.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
</code><code class="source_code"><span><span class="OPEN">open</span> <a href="../odoc.odoc_utils/odoc_utils.ml.html"><span class="UIDENT">Odoc_utils</span></a><span class="EOL">
</span><span class="OPEN">open</span> <span class="UIDENT">Astring</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="../odoc.json_index/odoc_json_index.ml.html"><span class="UIDENT">Odoc_json_index</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="or_error.ml.html"><span class="UIDENT">Or_error</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../odoc.model/odoc_model.ml.html"><span class="UIDENT">Odoc_model</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-H"><span class="MODULE">module</span> <span class="UIDENT">H</span> <span class="EQUAL">=</span> <a href="../odoc.model/paths.ml.html#module-Identifier.module-Hashtbl.module-Any"><span class="UIDENT">Odoc_model</span><span class="DOT">.</span><span class="UIDENT">Paths</span><span class="DOT">.</span><span class="UIDENT">Identifier</span><span class="DOT">.</span><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="UIDENT">Any</span></a></span><span class="EOL">
</span><span id="module-Id"><span class="MODULE">module</span> <span class="UIDENT">Id</span> <span class="EQUAL">=</span> <a href="../odoc.model/paths.ml.html#module-Identifier"><span class="UIDENT">Odoc_model</span><span class="DOT">.</span><span class="UIDENT">Paths</span><span class="DOT">.</span><span class="UIDENT">Identifier</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_input_file"><span class="LIDENT">parse_input_file</span></span> <span id="local_input_1"><span class="LIDENT">input</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_is_sep_2"><span class="LIDENT">is_sep</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span> <span class="CHAR">'\n'</span> <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="fs.ml.html#module-File.val-read"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">File</span><span class="DOT">.</span><span class="LIDENT">read</span></a> <a href="#local_input_1"><span class="LIDENT">input</span></a> <a href="or_error.ml.html#val-(&gt;&gt;=)"><span class="INFIXOP0">&gt;&gt;=</span></a> <span class="FUN">fun</span> <span id="local_content_3"><span class="LIDENT">content</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_files_4"><span class="LIDENT">files</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">fields</span> <span class="LABEL">~empty:</span><span class="FALSE">false</span> <span class="TILDE">~</span><a href="#local_is_sep_2"><span class="LIDENT">is_sep</span></a> <a href="#local_content_3"><span class="LIDENT">content</span></a> <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <a href="fs.ml.html#module-File.val-of_string"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">File</span><span class="DOT">.</span><span class="LIDENT">of_string</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">Ok</span> <a href="#local_files_4"><span class="LIDENT">files</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_input_files"><span class="LIDENT">parse_input_files</span></span> <span id="local_input_5"><span class="LIDENT">input</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_6"><span class="LIDENT">acc</span></span> <span id="local_file_7"><span class="LIDENT">file</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_acc_6"><span class="LIDENT">acc</span></a> <a href="or_error.ml.html#val-(&gt;&gt;=)"><span class="INFIXOP0">&gt;&gt;=</span></a> <span class="FUN">fun</span> <span id="local_acc_8"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">parse_input_file</span> <a href="#local_file_7"><span class="LIDENT">file</span></a> <a href="or_error.ml.html#val-(&gt;&gt;=)"><span class="INFIXOP0">&gt;&gt;=</span></a> <span class="FUN">fun</span> <span id="local_files_9"><span class="LIDENT">files</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><a href="#local_files_9"><span class="LIDENT">files</span></a> <span class="COLONCOLON">::</span> <a href="#local_acc_8"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">Ok</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_input_5"><span class="LIDENT">input</span></a><span class="EOL">
</span>  <a href="or_error.ml.html#val-(&gt;&gt;=)"><span class="INFIXOP0">&gt;&gt;=</span></a> <span class="FUN">fun</span> <span id="local_files_10"><span class="LIDENT">files</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-concat"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">concat</span></a> <a href="#local_files_10"><span class="LIDENT">files</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-compile_to_json"><span class="LIDENT">compile_to_json</span></span> <span class="TILDE">~</span><span id="local_output_11"><span class="LIDENT">output</span></span> <span class="TILDE">~</span><span id="local_occurrences_12"><span class="LIDENT">occurrences</span></span> <span class="TILDE">~</span><span id="local_wrap_13"><span class="LIDENT">wrap</span></span> <span class="TILDE">~</span><span id="local_simplified_14"><span class="LIDENT">simplified</span></span> <span id="local_hierarchies_15"><span class="LIDENT">hierarchies</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_output_channel_16"><span class="LIDENT">output_channel</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="fs.ml.html#module-Directory.val-mkdir_p"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">Directory</span><span class="DOT">.</span><span class="LIDENT">mkdir_p</span></a> <span class="LPAREN">(</span><a href="fs.ml.html#module-File.val-dirname"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">File</span><span class="DOT">.</span><span class="LIDENT">dirname</span></a> <a href="#local_output_11"><span class="LIDENT">output</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-open_out_bin"><span class="LIDENT">open_out_bin</span></a> <span class="LPAREN">(</span><a href="fs.ml.html#module-File.val-to_string"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">File</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_output_11"><span class="LIDENT">output</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_output_17"><span class="LIDENT">output</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-formatter_of_out_channel"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">formatter_of_out_channel</span></a> <a href="#local_output_channel_16"><span class="LIDENT">output_channel</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_wrap_13"><span class="LIDENT">wrap</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_output_17"><span class="LIDENT">output</span></a> <span class="STRING">&quot;let documents = &quot;</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_all_18"><span class="LIDENT">all</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_19"><span class="LIDENT">acc</span></span> <span id="local_hierarchy_20"><span class="LIDENT">hierarchy</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../odoc.odoc_utils/tree.ml.html#val-fold_left"><span class="UIDENT">Tree</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>          <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_21"><span class="LIDENT">acc</span></span> <span id="local_entry_22"><span class="LIDENT">entry</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="../odoc.json_index/json_search.ml.html#val-of_entry"><span class="UIDENT">Json_search</span><span class="DOT">.</span><span class="LIDENT">of_entry</span></a> <span class="TILDE">~</span><a href="#local_simplified_14"><span class="LIDENT">simplified</span></a> <span class="QUESTION">?</span><a href="#local_occurrences_12"><span class="LIDENT">occurrences</span></a> <a href="#local_entry_22"><span class="LIDENT">entry</span></a> <span class="COLONCOLON">::</span> <a href="#local_acc_21"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <a href="#local_acc_19"><span class="LIDENT">acc</span></a> <a href="#local_hierarchy_20"><span class="LIDENT">hierarchy</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_hierarchies_15"><span class="LIDENT">hierarchies</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_output_17"><span class="LIDENT">output</span></a> <span class="STRING">&quot;%s&quot;</span> <span class="LPAREN">(</span><a href="../odoc.odoc_utils/json.ml.html#val-to_string"><span class="UIDENT">Odoc_utils</span><span class="DOT">.</span><span class="UIDENT">Json</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Array</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_all_18"><span class="LIDENT">all</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_wrap_13"><span class="LIDENT">wrap</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-fprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">fprintf</span></a> <a href="#local_output_17"><span class="LIDENT">output</span></a><span class="EOL">
</span>      <span class="STRING">&quot;;\n\
       const options = { keys: ['name', 'comment'] };\n\
       var idx_fuse = new Fuse(documents, options);\n&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-read_occurrences"><span class="LIDENT">read_occurrences</span></span> <span id="local_file_23"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ic_24"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-open_in_bin"><span class="LIDENT">open_in_bin</span></a> <a href="#local_file_23"><span class="LIDENT">file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_htbl_25"><span class="LIDENT">htbl</span></span> <span class="COLON">:</span> <a href="../odoc.occurrences/table.ml.html#type-t"><span class="UIDENT">Odoc_occurrences</span><span class="DOT">.</span><span class="UIDENT">Table</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/marshal.ml.html#val-from_channel"><span class="UIDENT">Marshal</span><span class="DOT">.</span><span class="LIDENT">from_channel</span></a> <a href="#local_ic_24"><span class="LIDENT">ic</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_htbl_25"><span class="LIDENT">htbl</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-absolute_normalization"><span class="LIDENT">absolute_normalization</span></span> <span id="local_p_26"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_p_27"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LIDENT">is_rel</span> <a href="#local_p_26"><span class="LIDENT">p</span></a> <span class="THEN">then</span> <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LPAREN">(</span> <span class="INFIXOP3">//</span> <span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LIDENT">v</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-getcwd"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">getcwd</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_p_26"><span class="LIDENT">p</span></a> <span class="ELSE">else</span> <a href="#local_p_26"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LIDENT">normalize</span> <a href="#local_p_27"><span class="LIDENT">p</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-compile"><span class="LIDENT">compile</span></span> <span id="local_out_format_28"><span class="LIDENT">out_format</span></span> <span class="TILDE">~</span><span id="local_output_29"><span class="LIDENT">output</span></span> <span class="TILDE">~</span><span id="local_warnings_options_30"><span class="LIDENT">warnings_options</span></span> <span class="TILDE">~</span><span id="local_occurrences_31"><span class="LIDENT">occurrences</span></span> <span class="TILDE">~</span><span id="local_roots_32"><span class="LIDENT">roots</span></span><span class="EOL">
</span>    <span class="TILDE">~</span><span id="local_inputs_in_file_33"><span class="LIDENT">inputs_in_file</span></span> <span class="TILDE">~</span><span id="local_simplified_json_34"><span class="LIDENT">simplified_json</span></span> <span class="TILDE">~</span><span id="local_wrap_json_35"><span class="LIDENT">wrap_json</span></span> <span class="TILDE">~</span><span id="local_odocls_36"><span class="LIDENT">odocls</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_handle_warnings_37"><span class="LIDENT">handle_warnings</span></span> <span id="local_f_38"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_39"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../odoc.model/error.ml.html#val-catch_warnings"><span class="UIDENT">Error</span><span class="DOT">.</span><span class="LIDENT">catch_warnings</span></a> <a href="#local_f_38"><span class="LIDENT">f</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="../odoc.model/error.ml.html#val-handle_warnings"><span class="UIDENT">Error</span><span class="DOT">.</span><span class="LIDENT">handle_warnings</span></a> <span class="TILDE">~</span><a href="#local_warnings_options_30"><span class="LIDENT">warnings_options</span></a> <a href="#local_res_39"><span class="LIDENT">res</span></a> <span class="INFIXOP0">|&gt;</span> <a href="../odoc.odoc_utils/odoc_utils.ml.html#module-Result.val-join"><span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">join</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_handle_warnings_37"><span class="LIDENT">handle_warnings</span></a> <span class="INFIXOP1">@@</span> <span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LIDENT">parse_input_files</span> <a href="#local_inputs_in_file_33"><span class="LIDENT">inputs_in_file</span></a> <a href="or_error.ml.html#val-(&gt;&gt;=)"><span class="INFIXOP0">&gt;&gt;=</span></a> <span class="FUN">fun</span> <span id="local_files_40"><span class="LIDENT">files</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_files_41"><span class="LIDENT">files</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_append"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_append</span></a> <a href="#local_odocls_36"><span class="LIDENT">odocls</span></a> <a href="#local_files_40"><span class="LIDENT">files</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_occurrences_42"><span class="LIDENT">occurrences</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_occurrences_31"><span class="LIDENT">occurrences</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_occurrences_43"><span class="LIDENT">occurrences</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">read_occurrences</span> <span class="LPAREN">(</span><span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_occurrences_43"><span class="LIDENT">occurrences</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_all_files_44"><span class="LIDENT">all_files</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_roots_32"><span class="LIDENT">roots</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_set_45"><span class="LIDENT">set</span></span> <span id="local_include_rec_46"><span class="LIDENT">include_rec</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <a href="fs.ml.html#module-Directory.val-fold_files_rec"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">Directory</span><span class="DOT">.</span><span class="LIDENT">fold_files_rec</span></a> <span class="LABEL">~ext:</span><span class="STRING">&quot;odocl&quot;</span><span class="EOL">
</span>             <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_files_47"><span class="LIDENT">files</span></span> <span id="local_file_48"><span class="LIDENT">file</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>               <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="UIDENT">Set</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LPAREN">(</span><span class="LIDENT">absolute_normalization</span> <a href="#local_file_48"><span class="LIDENT">file</span></a><span class="RPAREN">)</span> <a href="#local_files_47"><span class="LIDENT">files</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <a href="#local_set_45"><span class="LIDENT">set</span></a> <a href="#local_include_rec_46"><span class="LIDENT">include_rec</span></a><span class="RPAREN">)</span><span class="EOL">
</span>         <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="UIDENT">Set</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(|&gt;)"><span class="INFIXOP0">|&gt;</span></a> <span class="FUN">fun</span> <span id="local_set_49"><span class="LIDENT">set</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="UIDENT">Set</span><span class="DOT">.</span><span class="LIDENT">fold</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_a_50"><span class="LIDENT">a</span></span> <span id="local_l_51"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_a_50"><span class="LIDENT">a</span></a> <span class="COLONCOLON">::</span> <a href="#local_l_51"><span class="LIDENT">l</span></a><span class="RPAREN">)</span> <a href="#local_set_49"><span class="LIDENT">set</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* let () = List.iter (Format.printf &quot;%a\n&quot; Fpath.pp) all_files in *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_root_groups_52"><span class="LIDENT">root_groups</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* We group the files we have found by root.

       Some files may belong to multiple roots. In this case, we associate the
       file to the root that is the deepest in the hierarchy.
    *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_roots_53"><span class="LIDENT">roots</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <a href="fs.ml.html#module-Directory.val-to_fpath"><span class="UIDENT">Fs</span><span class="DOT">.</span><span class="UIDENT">Directory</span><span class="DOT">.</span><span class="LIDENT">to_fpath</span></a> <a href="#local_roots_32"><span class="LIDENT">roots</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_roots_54"><span class="LIDENT">roots</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">absolute_normalization</span> <a href="#local_roots_53"><span class="LIDENT">roots</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* Add an index to keep the original order *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_roots_55"><span class="LIDENT">roots</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-mapi"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">mapi</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_56"><span class="LIDENT">i</span></span> <span id="local_c_57"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_i_56"><span class="LIDENT">i</span></a><span class="COMMA">,</span> <a href="#local_c_57"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_roots_54"><span class="LIDENT">roots</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_roots_58"><span class="LIDENT">roots</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* Make sure that we treat first the &quot;deepest&quot; one *)</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-sort"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">sort</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_p1_59"><span class="LIDENT">p1</span></span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_p2_60"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LIDENT">is_prefix</span> <a href="#local_p1_59"><span class="LIDENT">p1</span></a> <a href="#local_p2_60"><span class="LIDENT">p2</span></a> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <span class="MINUS">-</span><span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_roots_55"><span class="LIDENT">roots</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_87"><span id="local_groups_61"><span class="LIDENT">groups</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_acc_62"><span class="LIDENT">acc</span></span><span class="COMMA">,</span> <span id="local_remaining_files_63"><span class="LIDENT">remaining_files</span></span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_i_64"><span class="LIDENT">i</span></span><span class="COMMA">,</span> <span id="local_root_65"><span class="LIDENT">root</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_86"><span id="local_root_files_66"><span class="LIDENT">root_files</span></span><span class="COMMA">,</span> <span id="local_remaining_files_67"><span class="LIDENT">remaining_files</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-partition"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">partition</span></a> <span class="LPAREN">(</span><span class="UIDENT">Fpath</span><span class="DOT">.</span><span class="LIDENT">is_prefix</span> <a href="#local_root_65"><span class="LIDENT">root</span></a><span class="RPAREN">)</span> <a href="#local_remaining_files_63"><span class="LIDENT">remaining_files</span></a><span class="EOL">
</span>          <span class="IN">in</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_i_64"><span class="LIDENT">i</span></a><span class="COMMA">,</span> <a href="#local_root_files_66"><span class="LIDENT">root_files</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_62"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_remaining_files_67"><span class="LIDENT">remaining_files</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <a href="#local_all_files_44"><span class="LIDENT">all_files</span></a><span class="RPAREN">)</span> <a href="#local_roots_58"><span class="LIDENT">roots</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_root_groups_68"><span class="LIDENT">root_groups</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-sort"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">sort</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_i_69"><span class="LIDENT">i</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_j_70"><span class="LIDENT">j</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-compare"><span class="LIDENT">compare</span></a> <a href="#local_i_69"><span class="LIDENT">i</span></a> <a href="#local_j_70"><span class="LIDENT">j</span></a><span class="RPAREN">)</span> <a href="#local_groups_61"><span class="LIDENT">groups</span></a> <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* Files given without [--root] are grouped together *)</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_files_41"><span class="LIDENT">files</span></a> <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_files_41"><span class="LIDENT">files</span></a> <span class="COLONCOLON">::</span> <a href="#local_root_groups_68"><span class="LIDENT">root_groups</span></a> <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_root_groups_68"><span class="LIDENT">root_groups</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_hierarchies_71"><span class="LIDENT">hierarchies</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* For each group, we create a hierarchy. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_hierarchy_of_group_72"><span class="LIDENT">hierarchy_of_group</span></span> <span id="local_g_73"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_85"><span id="local_pages_74"><span class="LIDENT">pages</span></span><span class="COMMA">,</span> <span id="local_modules_75"><span class="LIDENT">modules</span></span><span class="COMMA">,</span> <span id="local_implementations_76"><span class="LIDENT">implementations</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_read_77"><span class="LIDENT">read</span></span> <span class="LPAREN">(</span><span id="local_pages_78"><span class="LIDENT">pages</span></span><span class="COMMA">,</span> <span id="local_modules_79"><span class="LIDENT">modules</span></span><span class="COMMA">,</span> <span id="local_impls_80"><span class="LIDENT">impls</span></span><span class="RPAREN">)</span> <span id="local_f_81"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="odoc_file.ml.html#val-load"><span class="UIDENT">Odoc_file</span><span class="DOT">.</span><span class="LIDENT">load</span></a> <a href="#local_f_81"><span class="LIDENT">f</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LBRACE">{</span> <span class="LIDENT">content</span> <span class="EQUAL">=</span> <span class="UIDENT">Page_content</span> <span id="local_p_82"><span class="LIDENT">p</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_p_82"><span class="LIDENT">p</span></a> <span class="COLONCOLON">::</span> <a href="#local_pages_78"><span class="LIDENT">pages</span></a><span class="COMMA">,</span> <a href="#local_modules_79"><span class="LIDENT">modules</span></a><span class="COMMA">,</span> <a href="#local_impls_80"><span class="LIDENT">impls</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LBRACE">{</span> <span class="LIDENT">content</span> <span class="EQUAL">=</span> <span class="UIDENT">Unit_content</span> <span id="local_m_83"><span class="LIDENT">m</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_pages_78"><span class="LIDENT">pages</span></a><span class="COMMA">,</span> <a href="#local_m_83"><span class="LIDENT">m</span></a> <span class="COLONCOLON">::</span> <a href="#local_modules_79"><span class="LIDENT">modules</span></a><span class="COMMA">,</span> <a href="#local_impls_80"><span class="LIDENT">impls</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LBRACE">{</span> <span class="LIDENT">content</span> <span class="EQUAL">=</span> <span class="UIDENT">Impl_content</span> <span id="local_i_84"><span class="LIDENT">i</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_pages_78"><span class="LIDENT">pages</span></a><span class="COMMA">,</span> <a href="#local_modules_79"><span class="LIDENT">modules</span></a><span class="COMMA">,</span> <a href="#local_i_84"><span class="LIDENT">i</span></a> <span class="COLONCOLON">::</span> <a href="#local_impls_80"><span class="LIDENT">impls</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_pages_78"><span class="LIDENT">pages</span></a><span class="COMMA">,</span> <a href="#local_modules_79"><span class="LIDENT">modules</span></a><span class="COMMA">,</span> <a href="#local_impls_80"><span class="LIDENT">impls</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <a href="#local_read_77"><span class="LIDENT">read</span></a> <span class="LPAREN">(</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_g_73"><span class="LIDENT">g</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <a href="../odoc.index/skeleton_of.ml.html#val-lang"><span class="UIDENT">Odoc_index</span><span class="DOT">.</span><span class="UIDENT">Skeleton_of</span><span class="DOT">.</span><span class="LIDENT">lang</span></a> <span class="TILDE">~</span><a href="#local_pages_74"><span class="LIDENT">pages</span></a> <span class="TILDE">~</span><a href="#local_modules_75"><span class="LIDENT">modules</span></a> <span class="TILDE">~</span><a href="#local_implementations_76"><span class="LIDENT">implementations</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <a href="#local_hierarchy_of_group_72"><span class="LIDENT">hierarchy_of_group</span></a> <a href="#local_root_groups_52"><span class="LIDENT">root_groups</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_out_format_28"><span class="LIDENT">out_format</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">JSON</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">compile_to_json</span> <span class="TILDE">~</span><a href="#local_output_29"><span class="LIDENT">output</span></a> <span class="TILDE">~</span><a href="#local_occurrences_42"><span class="LIDENT">occurrences</span></a> <span class="LABEL">~simplified:</span><a href="#local_simplified_json_34"><span class="LIDENT">simplified_json</span></a><span class="EOL">
</span>        <span class="LABEL">~wrap:</span><a href="#local_wrap_json_35"><span class="LIDENT">wrap_json</span></a> <a href="#local_hierarchies_71"><span class="LIDENT">hierarchies</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Marshall</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><a href="odoc_file.ml.html#val-save_index"><span class="UIDENT">Odoc_file</span><span class="DOT">.</span><span class="LIDENT">save_index</span></a> <a href="#local_output_29"><span class="LIDENT">output</span></a> <a href="#local_hierarchies_71"><span class="LIDENT">hierarchies</span></a><span class="RPAREN">)</span><span class="EOL">
</span></span></code></pre></body></html>
