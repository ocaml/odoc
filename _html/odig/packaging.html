<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>packaging (odig.packaging)</title><meta charset="utf-8"/><link rel="stylesheet" href="../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../';
let search_urls = ['sherlodoc_db.js','../sherlodoc.js'];
</script><script src="../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="index.html">Up</a> ‚Äì <a href="../index.html">üè†</a> &#x00BB; <a href="index.html">Odig  <span class="version">v0.0.9</span></a> &#x00BB; Odig packaging conventions</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1 id="conventions"><a href="#conventions" class="anchor"></a>Odig packaging conventions</h1><p>Packages following these convention maximize <code>odig</code>'s mining capabilities.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#package_install">Package install structure</a></li><li><a href="#meta">Metadata determination</a></li><li><a href="#distrib">Distribution documentation</a></li><li><a href="#odoc_api_and_manual">odoc API documentation and manual</a></li><li><a href="#theme_install">Odoc theme install structure</a></li></ul></nav><nav class="odoc-toc odoc-global-toc"><ul><li><a href="index.html">Odig  <span class="version">v0.0.9</span></a><ul><li><a href="manual.html">Odig manual</a></li><li><a href="#" class="current_unit">Odig packaging conventions</a></li><li>Library <code>odig.support</code><ul><li><a href="odig.support/Odig_odoc/index.html">Odig_odoc</a></li><li><a href="odig.support/Odig_odoc_page/index.html">Odig_odoc_page</a></li><li><a href="odig.support/Odig_support/index.html">Odig_support</a></li></ul></li></ul></li></ul></nav></div><div class="odoc-content"><h2 id="package_install"><a href="#package_install" class="anchor"></a>Package install structure</h2><p><code>odig</code> assumes all OCaml packages are installed in a library prefix called <code>LIBDIR</code> and have their distribution documentation installed in a prefix called <code>DOCDIR</code>. The values of these variables are automatically derived from the binary's installation path and can be overriden by environment variables, see <code>odig conf --help</code> for more information.</p><p>All direct subdirectories <code>LIBDIR/P</code> define a package name <code>P</code> whose corresponding documentation directory is assumed to be <code>DOCDIR/P</code>. The library path of the <code>ocaml</code> package is determined by <code>ocamlc -where</code>, not by <code>LIBDIR/ocaml</code> (for supporting opam system switches).</p><h2 id="meta"><a href="#meta" class="anchor"></a>Metadata determination</h2><p>Package metadata for package <code>P</code> is always read from a <code>LIBDIR/P/opam</code> file which must be a valid <a href="https://opam.ocaml.org/">opam</a> file. If present, the following fields are consulted and used by odig to define its metadata data fields:</p><ul><li><code>authors:</code> the authors</li><li><code>bug-reports:</code> the issues URI</li><li><code>depends:</code> the package's declared dependencies (only informative)</li><li><code>dev-repo:</code> the repository URI</li><li><code>doc:</code> the online documentation URI</li><li><code>homepage:</code> the homepage URI</li><li><code>license:</code> license tags</li><li><code>maintainers:</code> the maintainers</li><li><code>synopsis:</code> the package synopsis</li><li><code>tags:</code> classification tags</li><li><code>version:</code> the version string</li></ul><h2 id="distrib"><a href="#distrib" class="anchor"></a>Distribution documentation</h2><p>The distribution documentation for a package <code>P</code> is determined by <em>caseless</em> matching files in <code>DOCDIR/P</code>. The following matches are performed; multiple files are allowed to match, * denotes zero or more characters.</p><ul><li><code>DOCDIR/P/README*</code>, determines readme files</li><li><code>DOCDIR/P/CHANGE*</code>, <code>DOCDIR/P/HISTORY*</code>, <code>DOCDIR/P/NEWS*</code>, determines change log files</li><li><code>DOCDIR/P/LICENSE*</code>, determines license files</li></ul><h2 id="odoc_api_and_manual"><a href="#odoc_api_and_manual" class="anchor"></a>odoc API documentation and manual</h2><p>The API documentation and manual of a package <code>P</code> is generated by considering all <code>cmi</code> files in the hierarchy <code>LIBDIR/P</code>, the files in <code>DOCDIR/P/odoc-assets</code> and the files in <code>DOCDIR/P/odoc-pages</code></p><p>For each <code>cmi</code> file if a corresponding <code>cmti</code> file is found at the same location it is used to generate the documentation of the module with <code>odoc</code>; if not, an existing <code>cmt</code> file is used and lacking this the <code>cmi</code> file is used as a last resort.</p><p>Any file in <code>DOCDIR/P/odoc-assets</code> is copied over in an <code>_assets</code> directory at the root of the package's generated API documentation.</p><p>Any <code>.mld</code> file in <code>DOCDIR/P/odoc-pages</code> is compiled with <code>odoc</code> to a manual page. In particular the file <code>index.mld</code> is used to define ‚Äî modulo the chrome added by odig ‚Äî the content of the package's landing page. If <code>index.mld</code> has a level 0 heading it is stripped.</p><p>If no <code>index.mld</code> is provided the package's API modules ‚Äî those installed with <code>cmi</code> files and without <code>__</code> in their name ‚Äî are listed on the page.</p><p>Finally if the <code>DOCDIR/ocaml-manual</code> package exists it is copied over to the documentation set, linked (and possibly <a href="#theme_install" title="theme_install">themed</a>) from the package list page.</p><h2 id="theme_install"><a href="#theme_install" class="anchor"></a>Odoc theme install structure</h2><p><code>odig</code> assumes themes are installed in a <code>share</code> directory called <code>SHAREDIR</code>. The value of this variable is automatically derived from the binary's installation path and can be overriden by an environment variable, see <code>odig conf --help</code> for more information.</p><p>Each subdirectory <code>SHAREDIR/P/odoc-theme/T</code> defines a theme identified by <code>P.T</code>. This subdirectory is expected to at least hold an <code>odoc.css</code> file with the theme layout for the odoc documentation set.</p><p>The theme can also contain a <code>manual.css</code> file in which case it is used to style the local copy of the OCaml manual held in <code>DOCDIR/ocaml-manual</code> (e.g. as installed via <code>opam install ocaml-manual</code>) and linked from the documentation set package list page.</p></div></body></html>
