<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cmd (bos.bos.Bos.OS.Cmd)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../../../';
let search_urls = ['../../../../sherlodoc_db.js','../../../../../sherlodoc.js'];
</script><script src="../../../../../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> ‚Äì <a href="../../../../../index.html">üè†</a> &#x00BB; <a href="../../../../index.html">bos</a> &#x00BB; Library <code>bos</code> &#x00BB; <a href="../../index.html">Bos</a> &#x00BB; <a href="../index.html">OS</a> &#x00BB; Cmd</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>OS.Cmd</span></code></h1><p>Executing commands.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#exist">Tool existence and search</a></li><li><a href="#run">Command runs</a><ul><li><a href="#run_exit">Run statuses &amp; information</a></li><li><a href="#stderrs">Run standard errors</a></li><li><a href="#stdins">Run standard inputs</a></li><li><a href="#stdouts">Run standard outputs</a><ul><li><a href="#success">Extracting success</a></li></ul></li><li><a href="#runs">Run specifications</a></li></ul></li><li><a href="#ex">Examples</a></li></ul></nav><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../../../index.html">bos</a><ul><li>Library <code>bos</code><ul><li><a href="../../index.html">Bos</a><ul><li><a href="../../Pat/index.html">Pat</a></li><li><a href="../../Cmd/index.html">Cmd</a></li><li><a href="../index.html">OS</a><ul><li><a href="../Env/index.html">Env</a></li><li><a href="../Arg/index.html">Arg</a></li><li><a href="../Path/index.html">Path</a></li><li><a href="../File/index.html">File</a></li><li><a href="../Dir/index.html">Dir</a></li><li><a href="#" class="current_unit">Cmd</a></li><li><a href="../U/index.html">U</a></li></ul></li></ul></li></ul></li><li>Library <code>bos.setup</code><ul><li><a href="../../../../bos.setup/Bos_setup/index.html">Bos_setup</a></li></ul></li></ul></li></ul></nav></div><div class="odoc-content"><h2 id="exist"><a href="#exist" class="anchor"></a>Tool existence and search</h2><p><b>Tool search procedure.</b> Given a list of directories, the <span class="xref-unresolved" title="Cmd.line_tool">tool</span> of a command line is searched, in list order, for the first matching <em>executable</em> file. If the tool name is already a file path (i.e. contains a <a href="../../../../../fpath/fpath/Fpath/index.html#val-dir_sep"><code>Fpath.dir_sep</code></a>) it is neither searched nor tested for <a href="../File/index.html#val-is_executable" title="File.is_executable">existence and executability</a>. In the functions below if the list of directories <code>search</code> is unspecified the result of parsing the <code>PATH</code> environment variable with <a href="#val-search_path_dirs"><code>search_path_dirs</code></a> is used.</p><p><b>Portability.</b> In order to maximize portability no <code>.exe</code> suffix should be added to executable names on Windows, the tool search procedure will add the suffix during the tool search procedure if absent.</p><div class="odoc-spec"><div class="spec value anchored" id="val-find_tool"><a href="#val-find_tool" class="anchor"></a><code><span><span class="keyword">val</span> find_tool : <span><span class="optlabel">?search</span>:<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> option</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>find_tool ~search cmd</code> is the path to the <a href="../../Cmd/index.html#val-line_tool" title="Bos.Cmd.line_tool">tool</a> of <code>cmd</code> as found by the tool search procedure in <code>search</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_tool"><a href="#val-get_tool" class="anchor"></a><code><span><span class="keyword">val</span> get_tool : <span><span class="optlabel">?search</span>:<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>get_tool cmd</code> is like <a href="#val-find_tool"><code>find_tool</code></a> except it errors if the tool path cannot be found.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-exists"><a href="#val-exists" class="anchor"></a><code><span><span class="keyword">val</span> exists : <span><span class="optlabel">?search</span>:<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(bool, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>exists ~search cmd</code> is <code>Ok true</code> if <a href="#val-find_tool"><code>find_tool</code></a> finds a path and <code>Ok false</code> if it does not.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-must_exist"><a href="#val-must_exist" class="anchor"></a><code><span><span class="keyword">val</span> must_exist : <span><span class="optlabel">?search</span>:<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../Cmd/index.html#type-t">Cmd.t</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>must_exist ~search cmd</code> is <code>Ok cmd</code> if <a href="#val-get_tool"><code>get_tool</code></a> succeeds.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-resolve"><a href="#val-resolve" class="anchor"></a><code><span><span class="keyword">val</span> resolve : <span><span class="optlabel">?search</span>:<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../Cmd/index.html#type-t">Cmd.t</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>resolve ~search cmd</code> is like <a href="#val-must_exist"><code>must_exist</code></a> except the tool of the resulting command value has the path to the tool of <code>cmd</code> as determined by <a href="#val-get_tool"><code>get_tool</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-search_path_dirs"><a href="#val-search_path_dirs" class="anchor"></a><code><span><span class="keyword">val</span> search_path_dirs : <span><span class="optlabel">?sep</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>search_path_dirs ~sep s</code> parses <code>sep</code> seperated file paths from <code>s</code>. <code>sep</code> is not allowed to appear in the file paths, it defaults to <code>&quot;;&quot;</code> if <a href="../../../../../ocaml-base-compiler/stdlib/Stdlib/Sys/index.html#val-win32"><code>Sys.win32</code></a> is <code>true</code> and <code>&quot;:&quot;</code> otherwise.</p></div></div><h2 id="run"><a href="#run" class="anchor"></a>Command runs</h2><p>The following set of combinators are designed to be used with <a href="../../../../../ocaml-base-compiler/stdlib/Stdlib/index.html#val-(|&gt;)"><code>Stdlib.(|&gt;)</code></a> operator. See a few <a href="#ex" title="ex">examples</a>.</p><p><b>WARNING Windows.</b> The <code>~append:true</code> options for appending to files are unsupported on Windows. <a href="http://caml.inria.fr/mantis/view.php?id=4431">This</a> old feature request should be fixed upstream.</p><h3 id="run_exit"><a href="#run_exit" class="anchor"></a>Run statuses &amp; information</h3><div class="odoc-spec"><div class="spec type anchored" id="type-status"><a href="#type-status" class="anchor"></a><code><span><span class="keyword">type</span> status</span><span> = </span><span>[ </span></code><ol><li id="type-status.Exited" class="def variant constructor anchored"><a href="#type-status.Exited" class="anchor"></a><code><span>| </span><span>`Exited <span class="keyword">of</span> int</span></code></li><li id="type-status.Signaled" class="def variant constructor anchored"><a href="#type-status.Signaled" class="anchor"></a><code><span>| </span><span>`Signaled <span class="keyword">of</span> int</span></code></li></ol><code><span> ]</span></code></div><div class="spec-doc"><p>The type for process exit statuses.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_status"><a href="#val-pp_status" class="anchor"></a><code><span><span class="keyword">val</span> pp_status : <span><a href="#type-status">status</a> <a href="../../../../../fmt/fmt/Fmt/index.html#type-t">Fmt.t</a></span></span></code></div><div class="spec-doc"><p><code>pp_status</code> is a formatter for statuses.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-run_info"><a href="#type-run_info" class="anchor"></a><code><span><span class="keyword">type</span> run_info</span></code></div><div class="spec-doc"><p>The type for run information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_info_cmd"><a href="#val-run_info_cmd" class="anchor"></a><code><span><span class="keyword">val</span> run_info_cmd : <span><a href="#type-run_info">run_info</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../Cmd/index.html#type-t">Cmd.t</a></span></code></div><div class="spec-doc"><p><code>run_info_cmd ri</code> is the command that was run.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-run_status"><a href="#type-run_status" class="anchor"></a><code><span><span class="keyword">type</span> run_status</span><span> = <a href="#type-run_info">run_info</a> * <a href="#type-status">status</a></span></code></div><div class="spec-doc"><p>The type for run statuses the run information and the process exit status.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-success"><a href="#val-success" class="anchor"></a><code><span><span class="keyword">val</span> success : <span><span><span>(<span class="type-var">'a</span> * <a href="#type-run_status">run_status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>success r</code> is:</p><ul><li><code>Ok v</code> if <code>r = Ok (v, (_, `Exited 0))</code></li><li><code>Error _</code> otherwise. Non <code>`Exited 0</code> statuses are turned into an error message.</li></ul></div></div><h3 id="stderrs"><a href="#stderrs" class="anchor"></a>Run standard errors</h3><div class="odoc-spec"><div class="spec type anchored" id="type-run_err"><a href="#type-run_err" class="anchor"></a><code><span><span class="keyword">type</span> run_err</span></code></div><div class="spec-doc"><p>The type for representing the standard error of a command run.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-err_file"><a href="#val-err_file" class="anchor"></a><code><span><span class="keyword">val</span> err_file : <span><span class="optlabel">?append</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-run_err">run_err</a></span></code></div><div class="spec-doc"><p><code>err_file f</code> is a standard error that writes to file <code>f</code>. If <code>append</code> is <code>true</code> (defaults to <code>false</code>) the data is appended to <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-err_null"><a href="#val-err_null" class="anchor"></a><code><span><span class="keyword">val</span> err_null : <a href="#type-run_err">run_err</a></span></code></div><div class="spec-doc"><p><code>err_null</code> is <code>err_file File.null</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-err_run_out"><a href="#val-err_run_out" class="anchor"></a><code><span><span class="keyword">val</span> err_run_out : <a href="#type-run_err">run_err</a></span></code></div><div class="spec-doc"><p><code>err_run_out</code> is a standard error that is redirected to the run's standard output.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-err_stderr"><a href="#val-err_stderr" class="anchor"></a><code><span><span class="keyword">val</span> err_stderr : <a href="#type-run_err">run_err</a></span></code></div><div class="spec-doc"><p><code>err_stderr</code> is a standard error that is redirected to the current process standard error.</p></div></div><h3 id="stdins"><a href="#stdins" class="anchor"></a>Run standard inputs</h3><div class="odoc-spec"><div class="spec type anchored" id="type-run_in"><a href="#type-run_in" class="anchor"></a><code><span><span class="keyword">type</span> run_in</span></code></div><div class="spec-doc"><p>The type for representing the standard input of a command run.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-in_string"><a href="#val-in_string" class="anchor"></a><code><span><span class="keyword">val</span> in_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-run_in">run_in</a></span></code></div><div class="spec-doc"><p><code>in_string s</code> is a standard input that reads <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-in_file"><a href="#val-in_file" class="anchor"></a><code><span><span class="keyword">val</span> in_file : <span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-run_in">run_in</a></span></code></div><div class="spec-doc"><p><code>in_file f</code> is a standard input that reads from file <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-in_null"><a href="#val-in_null" class="anchor"></a><code><span><span class="keyword">val</span> in_null : <a href="#type-run_in">run_in</a></span></code></div><div class="spec-doc"><p><code>in_null</code> is <code>in_file File.null</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-in_stdin"><a href="#val-in_stdin" class="anchor"></a><code><span><span class="keyword">val</span> in_stdin : <a href="#type-run_in">run_in</a></span></code></div><div class="spec-doc"><p><code>in_stdin</code> is a standard input that reads from the current process standard input.</p></div></div><h3 id="stdouts"><a href="#stdouts" class="anchor"></a>Run standard outputs</h3><p>The following functions trigger actual command runs, consume their standard output and return the command and its status. In <a href="#val-out_run_in" title="out_run_in">pipelined</a> runs, the reported status is the one of the first failing run in the pipeline.</p><p><b>Warning.</b> When a value of type <a href="#type-run_out"><code>run_out</code></a> has been &quot;consumed&quot; with one of the following functions it cannot be reused.</p><div class="odoc-spec"><div class="spec type anchored" id="type-run_out"><a href="#type-run_out" class="anchor"></a><code><span><span class="keyword">type</span> run_out</span></code></div><div class="spec-doc"><p>The type for representing the standard output and status of a command run.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-out_string"><a href="#val-out_string" class="anchor"></a><code><span><span class="keyword">val</span> out_string : <span><span class="optlabel">?trim</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <a href="#type-run_status">run_status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>out_string ~trim o</code> captures the standard output <code>o</code> as a string. If <code>trim</code> is <code>true</code> (default) the result is passed through <a href="../../../../../ocaml-base-compiler/stdlib/Stdlib/String/index.html#val-trim"><code>String.trim</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-out_lines"><a href="#val-out_lines" class="anchor"></a><code><span><span class="keyword">val</span> out_lines : <span><span class="optlabel">?trim</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string list</span> * <a href="#type-run_status">run_status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>out_lines</code> is like <a href="#val-out_string"><code>out_string</code></a> but the result is splitted on newlines (<code>'\n'</code>). If the standard output is empty then the empty list is returned. Note that <code>trim</code> is applied before lines are splitted, it is not applied on the individual lines.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-out_file"><a href="#val-out_file" class="anchor"></a><code><span><span class="keyword">val</span> out_file : 
  <span><span class="optlabel">?append</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit * <a href="#type-run_status">run_status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>out_file f o</code> writes the standard output <code>o</code> to file <code>f</code>. If <code>append</code> is <code>true</code> (defaults to <code>false</code>) the data is appended to <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-out_run_in"><a href="#val-out_run_in" class="anchor"></a><code><span><span class="keyword">val</span> out_run_in : <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-run_in">run_in</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>out_run_in o</code> is a run input that can be used to feed the standard output of <code>o</code> to the standard input of another, <b>single</b>, command run. Note that when the function returns the command run of <code>o</code> may not be terminated yet. The run using the resulting input will report an unsucessful status or error of <code>o</code> rather than its own error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-out_null"><a href="#val-out_null" class="anchor"></a><code><span><span class="keyword">val</span> out_null : <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit * <a href="#type-run_status">run_status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>out_null o</code> is <code>out_file File.null o</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-out_stdout"><a href="#val-out_stdout" class="anchor"></a><code><span><span class="keyword">val</span> out_stdout : <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit * <a href="#type-run_status">run_status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>to_stdout o</code> redirects the standard output <code>o</code> to the current process standard output.</p></div></div><h4 id="success"><a href="#success" class="anchor"></a>Extracting success</h4><p>The following functions can be used if you only care about success.</p><div class="odoc-spec"><div class="spec value anchored" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><span class="optlabel">?trim</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>to_string ~trim o</code> is <code>(out_string ~trim o |&gt; success)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_lines"><a href="#val-to_lines" class="anchor"></a><code><span><span class="keyword">val</span> to_lines : <span><span class="optlabel">?trim</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string list</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>to_lines ~trim o</code> is <code>(out_lines ~trim o |&gt; success)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_file"><a href="#val-to_file" class="anchor"></a><code><span><span class="keyword">val</span> to_file : <span><span class="optlabel">?append</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>to_file ?append f o</code> is <code>(out_file ?append f o |&gt; success)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_null"><a href="#val-to_null" class="anchor"></a><code><span><span class="keyword">val</span> to_null : <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>to_null o</code> is <code>to_file File.null o</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_stdout"><a href="#val-to_stdout" class="anchor"></a><code><span><span class="keyword">val</span> to_stdout : <span><a href="#type-run_out">run_out</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>to_stdout o</code> is <code>(out_stdout o |&gt; success)</code>.</p></div></div><h3 id="runs"><a href="#runs" class="anchor"></a>Run specifications</h3><div class="odoc-spec"><div class="spec value anchored" id="val-run_io"><a href="#val-run_io" class="anchor"></a><code><span><span class="keyword">val</span> run_io : <span><span class="optlabel">?env</span>:<a href="../Env/index.html#type-t">Env.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?err</span>:<a href="#type-run_err">run_err</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_in">run_in</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-run_out">run_out</a></span></code></div><div class="spec-doc"><p><code>run_io ~env ~err cmd i</code> represents the standard output of the command run <code>cmd</code> performed in process environment <code>env</code> with its standard error output handled according to <code>err</code> (defaults to <a href="#val-err_stderr"><code>err_stderr</code></a>) and standard input connected to <code>i</code>. Note that the command run is not started before the output is consumed, see <a href="#stdouts" title="stdouts">run standard outputs</a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_out"><a href="#val-run_out" class="anchor"></a><code><span><span class="keyword">val</span> run_out : <span><span class="optlabel">?env</span>:<a href="../Env/index.html#type-t">Env.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?err</span>:<a href="#type-run_err">run_err</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-run_out">run_out</a></span></code></div><div class="spec-doc"><p><code>run_out ?env ?err cmd</code> is <code>(in_stdin |&gt; run_io ?env ?err cmd)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_in"><a href="#val-run_in" class="anchor"></a><code><span><span class="keyword">val</span> run_in : <span><span class="optlabel">?env</span>:<a href="../Env/index.html#type-t">Env.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?err</span>:<a href="#type-run_err">run_err</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-run_in">run_in</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>run_in ?env ?err cmd i</code> is <code>(run_io ?env ?err cmd |&gt; to_stdout)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : <span><span class="optlabel">?env</span>:<a href="../Env/index.html#type-t">Env.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?err</span>:<a href="#type-run_err">run_err</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>run ?env ?err cmd</code> is <code>(in_stdin |&gt; run_io ?env ?err cmd |&gt; to_stdout)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_status"><a href="#val-run_status" class="anchor"></a><code><span><span class="keyword">val</span> run_status : 
  <span><span class="optlabel">?env</span>:<a href="../Env/index.html#type-t">Env.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?err</span>:<a href="#type-run_err">run_err</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?quiet</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-status">status</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>run_status ?env ?err ?quiet cmd</code> is <code>(in_stdin |&gt; run_io ?env ?err ?cmd |&gt; out_stdout)</code> and extracts the run status.</p><p>If <code>quiet</code> is <code>true</code> (defaults to <code>false</code>), <code>in_stdin</code> and <code>out_stdout</code> are respectively replaced by <code>in_null</code> and <code>out_null</code> and <code>err</code> defaults to <code>err_null</code> rather than <code>err_stderr</code>.</p></div></div><h2 id="ex"><a href="#ex" class="anchor"></a>Examples</h2><p>Identity miaouw.</p><pre class="language-ocaml"><code>let id s = OS.Cmd.(in_string s |&gt; run_io Cmd.(v &quot;cat&quot;) |&gt; out_string)</code></pre><p>Get the current list of git tracked files in OCaml:</p><pre class="language-ocaml"><code>let git = Cmd.v &quot;git&quot;
let git_tracked () =
  let git_ls_files = Cmd.(git % &quot;ls-files&quot;) in
  OS.Cmd.(run_out git_ls_files |&gt; to_lines)</code></pre><p>Tarbzip the current list of git tracked files, without reading the tracked files in OCaml:</p><pre class="language-ocaml"><code>let tbz_git_tracked dst =
  let git_ls_files = Cmd.(git % &quot;ls-files&quot;) in
  let tbz = Cmd.(v &quot;tar&quot; % &quot;-cvzf&quot; % p dst % &quot;-T&quot; % &quot;-&quot;) in
  OS.Cmd.(run_out git_ls_files |&gt; out_run_in) &gt;&gt;= fun tracked -&gt;
  OS.Cmd.(tracked |&gt; run_in tbz)</code></pre><p>Send the email <code>mail</code>.</p><pre class="language-ocaml"><code>let send_email mail =
  let sendmail = Cmd.v &quot;sendmail&quot; in
  OS.Cmd.(in_string mail |&gt; run_in sendmail)</code></pre></div></body></html>
