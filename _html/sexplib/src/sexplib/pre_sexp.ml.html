<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: pre_sexp.ml (sexplib.src.sexplib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">sexplib</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; sexplib &#x00BB; pre_sexp.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>pre_sexp.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">sexplib</a><ul><li>Library <code>sexplib</code><ul><li><a href="../../sexplib/Sexplib/index.html">Sexplib</a></li></ul></li><li>Library <code>sexplib.num</code><ul><li><a href="../../sexplib.num/Sexplib_num/index.html">Sexplib_num</a></li></ul></li><li>Library <code>sexplib.unix</code><ul><li><a href="../../sexplib.unix/Sexplib_unix/index.html">Sexplib_unix</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>sexplib<ul><li><a href="conv.ml.html">conv.ml</a></li><li><a href="conv_error.ml.html">conv_error.ml</a></li><li><a href="exn_magic.ml.html">exn_magic.ml</a></li><li><a href="lexer.ml.html">lexer.ml</a></li><li><a href="parser.ml.html">parser.ml</a></li><li><a href="parser_with_layout.ml.html">parser_with_layout.ml</a></li><li><a href="path.ml.html">path.ml</a></li><li><a href="#" class="current_unit">pre_sexp.ml</a></li><li><a href="sexp.ml.html">sexp.ml</a></li><li><a href="sexp_grammar.ml.html">sexp_grammar.ml</a></li><li><a href="sexp_grammar_intf.ml.html">sexp_grammar_intf.ml</a></li><li><a href="sexp_intf.ml.html">sexp_intf.ml</a></li><li><a href="sexp_with_layout.ml.html">sexp_with_layout.ml</a></li><li><a href="sexplib.ml.html">sexplib.ml</a></li><li><a href="src_pos.ml.html">src_pos.ml</a></li><li><a href="std.ml.html">std.ml</a></li><li><a href="type.ml.html">type.ml</a></li><li><a href="type_with_layout.ml.html">type_with_layout.ml</a></li></ul></li><li>sexplib.num<ul><li><a href="../sexplib.num/sexplib_num.ml.html">sexplib_num.ml</a></li><li><a href="../sexplib.num/sexplib_num_conv.ml.html">sexplib_num_conv.ml</a></li><li><a href="../sexplib.num/std.ml.html">std.ml</a></li></ul></li><li>sexplib.unix<ul><li><a href="../sexplib.unix/sexplib_unix.ml.html">sexplib_unix.ml</a></li><li><a href="../sexplib.unix/sexplib_unix_conv.ml.html">sexplib_unix_conv.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
</code><code class="source_code"><span><span id="exception-Of_sexp_error"></span><span id="exception-Not_found_s"></span><span class="COMMENT">(* Sexp: Module for handling S-expressions (I/O, etc.) *)</span><span class="EOL">
</span><span id="type-t.constructor-Atom"><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html"><span class="UIDENT">Format</span></a><span class="EOL">
</span><span class="OPEN">ope</span></span>n <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html"><span class="UIDENT">B<span id="type-t.constructor-List">igarray</span></span></a><span class="EOL">
</span><span id="module-Sexplib"><span class="MODULE">module</span> <span class="UIDENT">Sexplib</span> <span class="EQUAL">=</span> <a href="../../../sexplib0/src/sexplib0/sexplib0.ml.html"><span class="UIDENT">Sexplib0</span></a></span><span class="EOL">
</span><span id="module-Conv"><span class="MODULE">module</span> <span class="UIDENT">Conv</span> <span class="EQUAL">=</span> <span class="UIDENT">Sexplib</span><span class="DOT">.</span><span class="UIDENT">Sexp_conv</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* conv.ml depends on us so we can only use this module *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="type.ml.html"><span class="UIDENT">Type</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="type-bigstring"><span class="TYPE">type</span> <span class="LIDENT">bigstring</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.type-t"><span class="LPAREN">(</span><span class="LIDENT">char</span><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#type-int8_unsigned_elt"><span class="LIDENT">int8_unsigned_elt</span></a><span class="COMMA">,</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#type-c_layout"><span class="LIDENT">c_layout</span></a><span class="RPAREN">)</span> <span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <span class="LPAREN">(</span><span class="EOL">
</span>  <span class="UIDENT">Sexplib</span><span class="DOT">.</span><span class="UIDENT">Sexp</span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="MODULE">module</span> <span class="TYPE">type</span> <span class="OF">of</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Sexplib</span><span class="DOT">.</span><span class="UIDENT">Sexp</span><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span>  <span class="WITH">with</span> <span id="def_462"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="COLONEQUAL">:=</span> <span class="LIDENT">t</span></span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <span class="UIDENT">Private</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-t_sexp_grammar"><span class="LIDENT">t_sexp_grammar</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_t_sexp_grammar</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Output of S-expressions to I/O-channels *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-with_new_buffer"><span class="LIDENT">with_new_buffer</span></span> <span id="local_oc_1"><span class="LIDENT">oc</span></span> <span id="local_f_2"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_3"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">buffer</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_f_2"><span class="LIDENT">f</span></a> <a href="#local_buf_3"><span class="LIDENT">buf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/buffer.ml.html#val-output_buffer"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">output_buffer</span></a> <a href="#local_oc_1"><span class="LIDENT">oc</span></a> <a href="#local_buf_3"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_hum"><span class="LIDENT">output_hum</span></span> <span id="local_oc_4"><span class="LIDENT">oc</span></span> <span id="local_sexp_5"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">with_new_buffer</span> <a href="#local_oc_4"><span class="LIDENT">oc</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_buf_6"><span class="LIDENT">buf</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">to_buffer_hum</span> <a href="#local_sexp_5"><span class="LIDENT">sexp</span></a> <span class="TILDE">~</span><a href="#local_buf_6"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_hum_indent"><span class="LIDENT">output_hum_indent</span></span> <span id="local_indent_7"><span class="LIDENT">indent</span></span> <span id="local_oc_8"><span class="LIDENT">oc</span></span> <span id="local_sexp_9"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">with_new_buffer</span> <a href="#local_oc_8"><span class="LIDENT">oc</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_buf_10"><span class="LIDENT">buf</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">to_buffer_hum</span> <span class="TILDE">~</span><a href="#local_indent_7"><span class="LIDENT">indent</span></a> <a href="#local_sexp_9"><span class="LIDENT">sexp</span></a> <span class="TILDE">~</span><a href="#local_buf_10"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_mach"><span class="LIDENT">output_mach</span></span> <span id="local_oc_11"><span class="LIDENT">oc</span></span> <span id="local_sexp_12"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">with_new_buffer</span> <a href="#local_oc_11"><span class="LIDENT">oc</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_buf_13"><span class="LIDENT">buf</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">to_buffer_mach</span> <a href="#local_sexp_12"><span class="LIDENT">sexp</span></a> <span class="TILDE">~</span><a href="#local_buf_13"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output"><span class="LIDENT">output</span></span> <span class="EQUAL">=</span> <span class="LIDENT">output_mach</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Output of S-expressions to file *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The temp file functions in the OCaml Filename module do not support
   permissions.  But opening a file with given permissions is different
   from opening it and chmoding it to these permissions, because the umask
   is taken in account.  Under Unix there's no easy way to get the umask in
   a thread-safe way. *)</span><span class="EOL">
</span><span id="module-Tmp_file"><span class="MODULE">module</span> <span class="UIDENT">Tmp_file</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Tmp_file.val-prng"><span class="LIDENT">prng</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">None</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Tmp_file.val-temp_file_name"><span class="LIDENT">temp_file_name</span></span> <span id="local_prefix_14"><span class="LIDENT">prefix</span></span> <span id="local_suffix_15"><span class="LIDENT">suffix</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rand_state_16"><span class="LIDENT">rand_state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">prng</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_v_17"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_v_17"><span class="LIDENT">v</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ret_18"><span class="LIDENT">ret</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/random.ml.html#module-State.val-make_self_init"><span class="UIDENT">Random</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">make_self_init</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LIDENT">prng</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Some</span> <a href="#local_ret_18"><span class="LIDENT">ret</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_ret_18"><span class="LIDENT">ret</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rnd_19"><span class="LIDENT">rnd</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/random.ml.html#module-State.val-bits"><span class="UIDENT">Random</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">bits</span></a> <a href="#local_rand_state_16"><span class="LIDENT">rand_state</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0xFFFFFF</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s%06x%s&quot;</span> <a href="#local_prefix_14"><span class="LIDENT">prefix</span></a> <a href="#local_rnd_19"><span class="LIDENT">rnd</span></a> <a href="#local_suffix_15"><span class="LIDENT">suffix</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Keep the permissions loose. Sexps are usually shared and rarely private*)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Tmp_file.val-open_temp_file"><span class="LIDENT">open_temp_file</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_perm_20"><span class="LIDENT">perm</span></span> <span class="EQUAL">=</span> <span class="INT">0o666</span><span class="RPAREN">)</span> <span id="local_prefix_21"><span class="LIDENT">prefix</span></span> <span id="local_suffix_22"><span class="LIDENT">suffix</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_try_name_23"><span class="LIDENT">try_name</span></span> <span id="local_counter_24"><span class="LIDENT">counter</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_name_25"><span class="LIDENT">name</span></span> <span class="EQUAL">=</span> <span class="LIDENT">temp_file_name</span> <a href="#local_prefix_21"><span class="LIDENT">prefix</span></a> <a href="#local_suffix_22"><span class="LIDENT">suffix</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_oc_26"><span class="LIDENT">oc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-open_out_gen"><span class="LIDENT">open_out_gen</span></a> <span class="LBRACKET">[</span> <span class="UIDENT">Open_wronly</span><span class="SEMI">;</span> <span class="UIDENT">Open_creat</span><span class="SEMI">;</span> <span class="UIDENT">Open_excl</span><span class="SEMI">;</span> <span class="UIDENT">Open_text</span> <span class="RBRACKET">]</span> <a href="#local_perm_20"><span class="LIDENT">perm</span></a> <a href="#local_name_25"><span class="LIDENT">name</span></a><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_name_25"><span class="LIDENT">name</span></a><span class="COMMA">,</span> <a href="#local_oc_26"><span class="LIDENT">oc</span></a><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Sys_error</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_e_27"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_counter_24"><span class="LIDENT">counter</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">1000</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_e_27"><span class="LIDENT">e</span></a> <span class="ELSE">else</span> <a href="#local_try_name_23"><span class="LIDENT">try_name</span></a> <span class="LPAREN">(</span><a href="#local_counter_24"><span class="LIDENT">counter</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_try_name_23"><span class="LIDENT">try_name</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-save_of_output"><span class="LIDENT">save_of_output</span></span> <span class="QUESTION">?</span><span id="local_perm_28"><span class="LIDENT">perm</span></span> <span id="local_output_function_29"><span class="LIDENT">output_function</span></span> <span id="local_file_30"><span class="LIDENT">file</span></span> <span id="local_sexp_31"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_450"><span id="local_tmp_name_32"><span class="LIDENT">tmp_name</span></span><span class="COMMA">,</span> <span id="local_oc_33"><span class="LIDENT">oc</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Tmp_file</span><span class="DOT">.</span><span class="LIDENT">open_temp_file</span> <span class="QUESTION">?</span><a href="#local_perm_28"><span class="LIDENT">perm</span></a> <a href="#local_file_30"><span class="LIDENT">file</span></a> <span class="STRING">&quot;tmp&quot;</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="TRY">try</span><span class="EOL">
</span>     <a href="#local_output_function_29"><span class="LIDENT">output_function</span></a> <a href="#local_oc_33"><span class="LIDENT">oc</span></a> <a href="#local_sexp_31"><span class="LIDENT">sexp</span></a><span class="SEMI">;</span><span class="EOL">
</span>     <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_out"><span class="LIDENT">close_out</span></a> <a href="#local_oc_33"><span class="LIDENT">oc</span></a><span class="EOL">
</span>   <span class="WITH">with</span><span class="EOL">
</span>   <span class="BAR">|</span> <span id="local_e_34"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_out_noerr"><span class="LIDENT">close_out_noerr</span></a> <a href="#local_oc_33"><span class="LIDENT">oc</span></a><span class="SEMI">;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-remove"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">remove</span></a> <a href="#local_tmp_name_32"><span class="LIDENT">tmp_name</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>     <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_e_34"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/sys.ml.html#val-rename"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">rename</span></a> <a href="#local_tmp_name_32"><span class="LIDENT">tmp_name</span></a> <a href="#local_file_30"><span class="LIDENT">file</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_sexp_nl"><span class="LIDENT">output_sexp_nl</span></span> <span id="local_do_output_35"><span class="LIDENT">do_output</span></span> <span id="local_oc_36"><span class="LIDENT">oc</span></span> <span id="local_sexp_37"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_do_output_35"><span class="LIDENT">do_output</span></a> <a href="#local_oc_36"><span class="LIDENT">oc</span></a> <a href="#local_sexp_37"><span class="LIDENT">sexp</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-output_string"><span class="LIDENT">output_string</span></a> <a href="#local_oc_36"><span class="LIDENT">oc</span></a> <span class="STRING">&quot;\n&quot;</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-save_hum"><span class="LIDENT">save_hum</span></span> <span class="QUESTION">?</span><span id="local_perm_38"><span class="LIDENT">perm</span></span> <span id="local_file_39"><span class="LIDENT">file</span></span> <span id="local_sexp_40"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">save_of_output</span> <span class="QUESTION">?</span><a href="#local_perm_38"><span class="LIDENT">perm</span></a> <span class="LPAREN">(</span><span class="LIDENT">output_sexp_nl</span> <span class="LIDENT">output_hum</span><span class="RPAREN">)</span> <a href="#local_file_39"><span class="LIDENT">file</span></a> <a href="#local_sexp_40"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-save_mach"><span class="LIDENT">save_mach</span></span> <span class="QUESTION">?</span><span id="local_perm_41"><span class="LIDENT">perm</span></span> <span id="local_file_42"><span class="LIDENT">file</span></span> <span id="local_sexp_43"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">save_of_output</span> <span class="QUESTION">?</span><a href="#local_perm_41"><span class="LIDENT">perm</span></a> <span class="LIDENT">output_mach</span> <a href="#local_file_42"><span class="LIDENT">file</span></a> <a href="#local_sexp_43"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-save"><span class="LIDENT">save</span></span> <span class="EQUAL">=</span> <span class="LIDENT">save_mach</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_sexps_nl"><span class="LIDENT">output_sexps_nl</span></span> <span id="local_do_output_44"><span class="LIDENT">do_output</span></span> <span id="local_oc_45"><span class="LIDENT">oc</span></span> <span id="local_sexps_46"><span class="LIDENT">sexps</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">output_sexp_nl</span> <a href="#local_do_output_44"><span class="LIDENT">do_output</span></a> <a href="#local_oc_45"><span class="LIDENT">oc</span></a><span class="RPAREN">)</span> <a href="#local_sexps_46"><span class="LIDENT">sexps</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-save_sexps_hum"><span class="LIDENT">save_sexps_hum</span></span> <span class="QUESTION">?</span><span id="local_perm_47"><span class="LIDENT">perm</span></span> <span id="local_file_48"><span class="LIDENT">file</span></span> <span id="local_sexps_49"><span class="LIDENT">sexps</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">save_of_output</span> <span class="QUESTION">?</span><a href="#local_perm_47"><span class="LIDENT">perm</span></a> <span class="LPAREN">(</span><span class="LIDENT">output_sexps_nl</span> <span class="LIDENT">output_hum</span><span class="RPAREN">)</span> <a href="#local_file_48"><span class="LIDENT">file</span></a> <a href="#local_sexps_49"><span class="LIDENT">sexps</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-save_sexps_mach"><span class="LIDENT">save_sexps_mach</span></span> <span class="QUESTION">?</span><span id="local_perm_50"><span class="LIDENT">perm</span></span> <span id="local_file_51"><span class="LIDENT">file</span></span> <span id="local_sexps_52"><span class="LIDENT">sexps</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">save_of_output</span> <span class="QUESTION">?</span><a href="#local_perm_50"><span class="LIDENT">perm</span></a> <span class="LPAREN">(</span><span class="LIDENT">output_sexps_nl</span> <span class="LIDENT">output_mach</span><span class="RPAREN">)</span> <a href="#local_file_51"><span class="LIDENT">file</span></a> <a href="#local_sexps_52"><span class="LIDENT">sexps</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-save_sexps"><span class="LIDENT">save_sexps</span></span> <span class="EQUAL">=</span> <span class="LIDENT">save_sexps_mach</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan functions *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_sexp"><span class="LIDENT">scan_sexp</span></span> <span class="QUESTION">?</span><span id="local_buf_53"><span class="LIDENT">buf</span></span> <span id="local_lexbuf_54"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span> <a href="parser.ml.html#val-sexp"><span class="UIDENT">Parser</span><span class="DOT">.</span><span class="LIDENT">sexp</span></a> <span class="LPAREN">(</span><a href="lexer.ml.html#val-main"><span class="UIDENT">Lexer</span><span class="DOT">.</span><span class="LIDENT">main</span></a> <span class="QUESTION">?</span><a href="#local_buf_53"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <a href="#local_lexbuf_54"><span class="LIDENT">lexbuf</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_sexp_opt"><span class="LIDENT">scan_sexp_opt</span></span> <span class="QUESTION">?</span><span id="local_buf_55"><span class="LIDENT">buf</span></span> <span id="local_lexbuf_56"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span> <a href="parser.ml.html#val-sexp_opt"><span class="UIDENT">Parser</span><span class="DOT">.</span><span class="LIDENT">sexp_opt</span></a> <span class="LPAREN">(</span><a href="lexer.ml.html#val-main"><span class="UIDENT">Lexer</span><span class="DOT">.</span><span class="LIDENT">main</span></a> <span class="QUESTION">?</span><a href="#local_buf_55"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <a href="#local_lexbuf_56"><span class="LIDENT">lexbuf</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_sexps"><span class="LIDENT">scan_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_57"><span class="LIDENT">buf</span></span> <span id="local_lexbuf_58"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span> <a href="parser.ml.html#val-sexps"><span class="UIDENT">Parser</span><span class="DOT">.</span><span class="LIDENT">sexps</span></a> <span class="LPAREN">(</span><a href="lexer.ml.html#val-main"><span class="UIDENT">Lexer</span><span class="DOT">.</span><span class="LIDENT">main</span></a> <span class="QUESTION">?</span><a href="#local_buf_57"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <a href="#local_lexbuf_58"><span class="LIDENT">lexbuf</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_rev_sexps"><span class="LIDENT">scan_rev_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_59"><span class="LIDENT">buf</span></span> <span id="local_lexbuf_60"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span> <a href="parser.ml.html#val-rev_sexps"><span class="UIDENT">Parser</span><span class="DOT">.</span><span class="LIDENT">rev_sexps</span></a> <span class="LPAREN">(</span><a href="lexer.ml.html#val-main"><span class="UIDENT">Lexer</span><span class="DOT">.</span><span class="LIDENT">main</span></a> <span class="QUESTION">?</span><a href="#local_buf_59"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <a href="#local_lexbuf_60"><span class="LIDENT">lexbuf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_main_buf"><span class="LIDENT">get_main_buf</span></span> <span id="local_buf_61"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_62"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_buf_61"><span class="LIDENT">buf</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">128</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_buf_63"><span class="LIDENT">buf</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_buf_63"><span class="LIDENT">buf</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="lexer.ml.html#val-main"><span class="UIDENT">Lexer</span><span class="DOT">.</span><span class="LIDENT">main</span></a> <span class="TILDE">~</span><a href="#local_buf_62"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_fold_sexps"><span class="LIDENT">scan_fold_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_64"><span class="LIDENT">buf</span></span> <span class="TILDE">~</span><span id="local_f_65"><span class="LIDENT">f</span></span> <span class="TILDE">~</span><span id="local_init_66"><span class="LIDENT">init</span></span> <span id="local_lexbuf_67"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_main_68"><span class="LIDENT">main</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_main_buf</span> <a href="#local_buf_64"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_69"><span class="LIDENT">loop</span></span> <span id="local_acc_70"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="parser.ml.html#val-sexp_opt"><span class="UIDENT">Parser</span><span class="DOT">.</span><span class="LIDENT">sexp_opt</span></a> <a href="#local_main_68"><span class="LIDENT">main</span></a> <a href="#local_lexbuf_67"><span class="LIDENT">lexbuf</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_acc_70"><span class="LIDENT">acc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_sexp_71"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_69"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="#local_f_65"><span class="LIDENT">f</span></a> <a href="#local_acc_70"><span class="LIDENT">acc</span></a> <a href="#local_sexp_71"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_69"><span class="LIDENT">loop</span></a> <a href="#local_init_66"><span class="LIDENT">init</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_iter_sexps"><span class="LIDENT">scan_iter_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_72"><span class="LIDENT">buf</span></span> <span class="TILDE">~</span><span id="local_f_73"><span class="LIDENT">f</span></span> <span id="local_lexbuf_74"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">scan_fold_sexps</span> <span class="QUESTION">?</span><a href="#local_buf_72"><span class="LIDENT">buf</span></a> <a href="#local_lexbuf_74"><span class="LIDENT">lexbuf</span></a> <span class="LABEL">~init:</span><span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span id="local_sexp_75"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_73"><span class="LIDENT">f</span></a> <a href="#local_sexp_75"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_sexps_conv"><span class="LIDENT">scan_sexps_conv</span></span> <span class="QUESTION">?</span><span id="local_buf_76"><span class="LIDENT">buf</span></span> <span class="TILDE">~</span><span id="local_f_77"><span class="LIDENT">f</span></span> <span id="local_lexbuf_78"><span class="LIDENT">lexbuf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_coll_79"><span class="LIDENT">coll</span></span> <span id="local_acc_80"><span class="LIDENT">acc</span></span> <span id="local_sexp_81"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="#local_f_77"><span class="LIDENT">f</span></a> <a href="#local_sexp_81"><span class="LIDENT">sexp</span></a> <span class="COLONCOLON">::</span> <a href="#local_acc_80"><span class="LIDENT">acc</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><span class="LIDENT">scan_fold_sexps</span> <span class="QUESTION">?</span><a href="#local_buf_76"><span class="LIDENT">buf</span></a> <span class="LABEL">~f:</span><a href="#local_coll_79"><span class="LIDENT">coll</span></a> <span class="LABEL">~init:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_lexbuf_78"><span class="LIDENT">lexbuf</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_conversion_error_message"><span class="LIDENT">sexp_conversion_error_message</span></span> <span class="QUESTION">?</span><span id="local_containing_sexp_82"><span class="LIDENT">containing_sexp</span></span> <span class="QUESTION">?</span><span id="local_location_83"><span class="LIDENT">location</span></span> <span class="QUESTION">?</span><span id="local_invalid_sexp_84"><span class="LIDENT">invalid_sexp</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_exn_85"><span class="LIDENT">exn</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="UIDENT">List</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-concat"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">concat</span></a><span class="EOL">
</span>       <span class="LBRACKET">[</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Of_sexp_error&quot;</span> <span class="RBRACKET">]</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_location_83"><span class="LIDENT">location</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_86"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <a href="#local_x_86"><span class="LIDENT">x</span></a> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="LBRACKET">[</span> <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_exn_85"><span class="LIDENT">exn</span></a> <span class="WITH">with</span><span class="EOL">
</span>             <span class="BAR">|</span> <span class="UIDENT">Failure</span> <span id="local_x_87"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <a href="#local_x_87"><span class="LIDENT">x</span></a><span class="EOL">
</span>             <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_of_exn</span> <a href="#local_exn_85"><span class="LIDENT">exn</span></a><span class="RPAREN">)</span><span class="EOL">
</span>         <span class="RBRACKET">]</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_invalid_sexp_84"><span class="LIDENT">invalid_sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_88"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;invalid_sexp&quot;</span><span class="SEMI">;</span> <a href="#local_x_88"><span class="LIDENT">x</span></a> <span class="RBRACKET">]</span> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="SEMI">;</span> <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_containing_sexp_82"><span class="LIDENT">containing_sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_89"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;containing_sexp&quot;</span><span class="SEMI">;</span> <a href="#local_x_89"><span class="LIDENT">x</span></a> <span class="RBRACKET">]</span> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Partial parsing *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Annot"><span class="MODULE">module</span> <span class="UIDENT">Annot</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Annot.type-pos"><span class="TYPE">type</span> <span class="LIDENT">pos</span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/positions.ml.html#type-pos"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Positions</span><span class="DOT">.</span><span class="LIDENT">pos</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_447"><span class="LIDENT">line</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_457"><span class="LIDENT">col</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_444"><span class="LIDENT">offset</span> <span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Annot.type-range"><span class="TYPE">type</span> <span class="LIDENT">range</span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/positions.ml.html#type-range"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Positions</span><span class="DOT">.</span><span class="LIDENT">range</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_442"><span class="LIDENT">start_pos</span> <span class="COLON">:</span> <span class="LIDENT">pos</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_451"><span class="LIDENT">end_pos</span> <span class="COLON">:</span> <span class="LIDENT">pos</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Annot.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Annotated.type-t.constructor-Atom"><span id="module-Annot.type-t.constructor-Atom"><span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="OF">of</span> <span class="LIDENT">range</span> <span class="STAR">*</span> <a href="type.ml.html#type-t"><span class="UIDENT">Type</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span></span><span class="EOL">
</span>    <span id="module-Annotated.type-t.constructor-List"><span id="module-Annot.type-t.constructor-List"><span class="BAR">|</span> <span class="UIDENT">List</span> <span class="OF">of</span> <span class="LIDENT">range</span> <span class="STAR">*</span> <span class="LIDENT">t</span> <span class="LIDENT">list</span> <span class="STAR">*</span> <a href="type.ml.html#type-t"><span class="UIDENT">Type</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Annot.type-conv"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">conv</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span class="OF">of</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Error</span> <span class="OF">of</span> <span class="LIDENT">exn</span> <span class="STAR">*</span> <span class="LIDENT">t</span><span class="EOL">
</span>    <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Annotated.exception-Conv_exn"><span id="module-Annot.exception-Conv_exn"><span class="EXCEPTION">exception</span> <span class="UIDENT">Conv_exn</span> <span class="OF">of</span> <span class="LIDENT">string</span> <span class="STAR">*</span> <span class="LIDENT">exn</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LABEL">~finalise:</span><span class="FALSE">false</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Conv_exn</span><span class="RBRACKET">]</span> <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Conv_exn</span> <span class="LPAREN">(</span><span id="local_location_90"><span class="LIDENT">location</span></span><span class="COMMA">,</span> <span id="local_exn_91"><span class="LIDENT">exn</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">sexp_conversion_error_message</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_location_90"><span class="LIDENT">location</span></a> <span class="TILDE">~</span><a href="#local_exn_91"><span class="LIDENT">exn</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Annot.type-stack"><span class="TYPE">type</span> <span class="LIDENT">stack</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_455"><span class="MUTABLE">mutable</span> <span class="LIDENT">positions</span> <span class="COLON">:</span> <span class="LIDENT">pos</span> <span class="LIDENT">list</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_449"><span class="MUTABLE">mutable</span> <span class="LIDENT">stack</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="LIDENT">list</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annot.val-get_sexp"><span class="LIDENT">get_sexp</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_sexp_92"><span class="LIDENT">sexp</span></span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_sexp_93"><span class="LIDENT">sexp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_93"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annot.val-get_range"><span class="LIDENT">get_range</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span id="local_range_94"><span class="LIDENT">range</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><span id="local_range_95"><span class="LIDENT">range</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_range_95"><span class="LIDENT">range</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annot.val-sexp_of_conv"><span class="LIDENT">sexp_of_conv</span></span> <span id="local_sexp_of_a_96"><span class="LIDENT">sexp_of_a</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span id="local_a_97"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Type</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Result&quot;</span><span class="SEMI">;</span> <a href="#local_a_97"><span class="LIDENT">a</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#local_sexp_of_a_96"><span class="LIDENT">sexp_of_a</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><span id="local_exn_98"><span class="LIDENT">exn</span></span><span class="COMMA">,</span> <span id="local_t_99"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Error&quot;</span><span class="SEMI">;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <a href="#local_exn_98"><span class="LIDENT">exn</span></a> <span class="INFIXOP0">|&gt;</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_of_exn</span><span class="SEMI">;</span> <a href="#local_t_99"><span class="LIDENT">t</span></a> <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">get_sexp</span> <span class="RBRACKET">]</span> <span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Annotated.exception-Annot_sexp"><span id="module-Annot.exception-Annot_sexp"><span class="EXCEPTION">exception</span> <span class="UIDENT">Annot_sexp</span> <span class="OF">of</span> <span class="LIDENT">t</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annot.val-find_sexp"><span class="LIDENT">find_sexp</span></span> <span id="local_annot_sexp_100"><span class="LIDENT">annot_sexp</span></span> <span id="local_sexp_101"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_102"><span class="LIDENT">loop</span></span> <span id="local_annot_sexp_103"><span class="LIDENT">annot_sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_annot_sexp_103"><span class="LIDENT">annot_sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LPAREN">(</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_sub_sexp_104"><span class="LIDENT">sub_sexp</span></span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_sub_sexp_105"><span class="LIDENT">sub_sexp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="WHEN">when</span> <a href="#local_sexp_101"><span class="LIDENT">sexp</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_sub_sexp_105"><span class="LIDENT">sub_sexp</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Annot_sexp</span> <a href="#local_annot_sexp_103"><span class="LIDENT">annot_sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_annots_106"><span class="LIDENT">annots</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_loop_102"><span class="LIDENT">loop</span></a> <a href="#local_annots_106"><span class="LIDENT">annots</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <a href="#local_loop_102"><span class="LIDENT">loop</span></a> <a href="#local_annot_sexp_100"><span class="LIDENT">annot_sexp</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Annot_sexp</span> <span id="local_res_107"><span class="LIDENT">res</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_res_107"><span class="LIDENT">res</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LABEL">~finalise:</span><span class="FALSE">false</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Of_sexp_error</span><span class="RBRACKET">]</span> <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span class="UIDENT">Annot</span><span class="DOT">.</span><span class="UIDENT">Conv_exn</span> <span class="LPAREN">(</span><span id="local_location_108"><span class="LIDENT">location</span></span><span class="COMMA">,</span> <span id="local_exn_109"><span class="LIDENT">exn</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_invalid_sexp_110"><span class="LIDENT">invalid_sexp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">sexp_conversion_error_message</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_location_108"><span class="LIDENT">location</span></a> <span class="TILDE">~</span><a href="#local_invalid_sexp_110"><span class="LIDENT">invalid_sexp</span></a> <span class="TILDE">~</span><a href="#local_exn_109"><span class="LIDENT">exn</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span id="local_exn_111"><span class="LIDENT">exn</span></span><span class="COMMA">,</span> <span id="local_invalid_sexp_112"><span class="LIDENT">invalid_sexp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">sexp_conversion_error_message</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_invalid_sexp_112"><span class="LIDENT">invalid_sexp</span></a> <span class="TILDE">~</span><a href="#local_exn_111"><span class="LIDENT">exn</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="COMMENT">(* Reaching this branch indicates a bug in sexplib. *)</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Parse_pos"><span class="MODULE">module</span> <span class="UIDENT">Parse_pos</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Parse_pos.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_441"><span class="MUTABLE">mutable</span> <span class="LIDENT">text_line</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_452"><span class="MUTABLE">mutable</span> <span class="LIDENT">text_char</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_446"><span class="MUTABLE">mutable</span> <span class="LIDENT">global_offset</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_460"><span class="MUTABLE">mutable</span> <span class="LIDENT">buf_pos</span> <span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Parse_pos.val-create"><span class="LIDENT">create</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_text_line_113"><span class="LIDENT">text_line</span></span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_text_char_114"><span class="LIDENT">text_char</span></span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buf_pos_115"><span class="LIDENT">buf_pos</span></span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_global_offset_116"><span class="LIDENT">global_offset</span></span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_fail_117"><span class="LIDENT">fail</span></span> <span id="local_msg_118"><span class="LIDENT">msg</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="LPAREN">(</span><span class="STRING">&quot;Sexplib.Sexp.Parse_pos.create: &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_msg_118"><span class="LIDENT">msg</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_text_line_113"><span class="LIDENT">text_line</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_fail_117"><span class="LIDENT">fail</span></a> <span class="STRING">&quot;text_line &lt; 1&quot;</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_text_char_114"><span class="LIDENT">text_char</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_fail_117"><span class="LIDENT">fail</span></a> <span class="STRING">&quot;text_char &lt; 0&quot;</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_global_offset_116"><span class="LIDENT">global_offset</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_fail_117"><span class="LIDENT">fail</span></a> <span class="STRING">&quot;global_offset &lt; 0&quot;</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_buf_pos_115"><span class="LIDENT">buf_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_fail_117"><span class="LIDENT">fail</span></a> <span class="STRING">&quot;buf_pos &lt; 0&quot;</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LBRACE">{</span> <a href="#local_text_line_113"><span class="LIDENT">text_line</span></a><span class="SEMI">;</span> <a href="#local_text_char_114"><span class="LIDENT">text_char</span></a><span class="SEMI">;</span> <a href="#local_global_offset_116"><span class="LIDENT">global_offset</span></a><span class="SEMI">;</span> <a href="#local_buf_pos_115"><span class="LIDENT">buf_pos</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Parse_pos.val-with_buf_pos"><span class="LIDENT">with_buf_pos</span></span> <span id="local_t_119"><span class="LIDENT">t</span></span> <span id="local_buf_pos_120"><span class="LIDENT">buf_pos</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_t_119"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <a href="#local_buf_pos_120"><span class="LIDENT">buf_pos</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Cont_state"><span class="MODULE">module</span> <span class="UIDENT">Cont_state</span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/old_parser_cont_state.ml.html"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Old_parser_cont_state</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-parse_result"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">parse_result</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-parse_result.constructor-Done"><span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="OF">of</span> <span class="QUOTE">'</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="type-parse_result.constructor-Cont"><span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="OF">of</span> <span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">parse_fun</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-parse_fun"><span class="AND">and</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">parse_fun</span> <span class="EQUAL">=</span> <span class="LIDENT">pos</span><span class="COLON">:</span><span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">len</span><span class="COLON">:</span><span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">parse_result</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-parse_state"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">t</span> <span class="LIDENT">parse_state</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span id="def_461"><span class="LIDENT">parse_pos</span> <span class="COLON">:</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">t</span></span> <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-parse_error"><span class="TYPE">type</span> <span class="LIDENT">parse_error</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span id="def_456"><span class="LIDENT">err_msg</span> <span class="COLON">:</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="SEMI">;</span></span> <span id="def_463"><span class="LIDENT">parse_state</span> <span class="COLON">:</span> <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Sexp</span> <span class="OF">of</span> <span class="LIDENT">t</span> <span class="LIDENT">list</span> <span class="LIDENT">list</span> <span class="LIDENT">parse_state</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Annot</span> <span class="OF">of</span> <span class="UIDENT">Annot</span><span class="DOT">.</span><span class="LIDENT">stack</span> <span class="LIDENT">parse_state</span> <span class="RBRACKET">]</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="exception-Parse_error"><span class="EXCEPTION">exception</span> <span class="UIDENT">Parse_error</span> <span class="OF">of</span> <span class="LIDENT">parse_error</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LABEL">~finalise:</span><span class="FALSE">false</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Parse_error</span><span class="RBRACKET">]</span> <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Parse_error</span> <span id="local_pe_121"><span class="LIDENT">pe</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_ppos_122"><span class="LIDENT">ppos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_pe_121"><span class="LIDENT">pe</span></a><span class="DOT">.</span><span class="LIDENT">parse_state</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Sexp</span> <span class="LBRACE">{</span> <span id="local_parse_pos_123"><span class="LIDENT">parse_pos</span></span> <span class="RBRACE">}</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Annot</span> <span class="LBRACE">{</span> <span id="local_parse_pos_124"><span class="LIDENT">parse_pos</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_pos_124"><span class="LIDENT">parse_pos</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">List</span><span class="EOL">
</span>        <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Sexplib.Sexp.Parse_error&quot;</span><span class="EOL">
</span>        <span class="SEMI">;</span> <span class="UIDENT">List</span><span class="EOL">
</span>            <span class="LBRACKET">[</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;err_msg&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_pe_121"><span class="LIDENT">pe</span></a><span class="DOT">.</span><span class="LIDENT">err_msg</span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;text_line&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_of_int</span> <a href="#local_ppos_122"><span class="LIDENT">ppos</span></a><span class="DOT">.</span><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">text_line</span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;text_char&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_of_int</span> <a href="#local_ppos_122"><span class="LIDENT">ppos</span></a><span class="DOT">.</span><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">text_char</span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;global_offset&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_of_int</span> <a href="#local_ppos_122"><span class="LIDENT">ppos</span></a><span class="DOT">.</span><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">global_offset</span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="SEMI">;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;buf_pos&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="LIDENT">sexp_of_int</span> <a href="#local_ppos_122"><span class="LIDENT">ppos</span></a><span class="DOT">.</span><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">buf_pos</span> <span class="RBRACKET">]</span><span class="EOL">
</span>            <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="RBRACKET">]</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Parser_output"><span class="MODULE">module</span> <span class="UIDENT">Parser_output</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-Parser_output.module-type-T"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">T</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.module-Impl"><span class="MODULE">module</span> <span class="UIDENT">Impl</span> <span class="COLON">:</span> <a href="../../../parsexp/src/parsexp/parsexp.ml.html#module-type-Eager_parser"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Eager_parser</span></a></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.type-output"><span class="TYPE">type</span> <span class="LIDENT">output</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Make_parser.argument-1-T.exception-Found"><span id="module-Parser_output.module-type-T.exception-Found"><span class="EXCEPTION">exception</span> <span class="UIDENT">Found</span> <span class="OF">of</span> <span class="LIDENT">output</span></span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.val-raise_found"><span class="VAL">val</span> <span class="LIDENT">raise_found</span> <span class="COLON">:</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="UIDENT">Read_only</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="LIDENT">parsed_value</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Parser_output.module-Bare_sexp"><span class="MODULE">module</span> <span class="UIDENT">Bare_sexp</span> <span class="COLON">:</span> <span class="UIDENT">T</span> <span class="WITH">with</span> <span id="def_443"><span class="TYPE">type</span> <span class="LIDENT">output</span> <span class="EQUAL">=</span> <a href="type.ml.html#type-t"><span class="UIDENT">Type</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span></span><span class="EOL">
</span>  <span id="module-Parser_output.module-Annotated_sexp"><span class="MODULE">module</span> <span class="UIDENT">Annotated_sexp</span> <span class="COLON">:</span> <span class="UIDENT">T</span> <span class="WITH">with</span> <span id="def_459"><span class="TYPE">type</span> <span class="LIDENT">output</span> <span class="EQUAL">=</span> <span class="UIDENT">Annot</span><span class="DOT">.</span><span class="LIDENT">t</span></span></span><span class="EOL">
</span><span class="END">end</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Parser_output.module-type-T"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">T</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.module-Impl"><span class="MODULE">module</span> <span class="UIDENT">Impl</span> <span class="COLON">:</span> <a href="../../../parsexp/src/parsexp/parsexp.ml.html#module-type-Eager_parser"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Eager_parser</span></a></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.type-output"><span class="TYPE">type</span> <span class="LIDENT">output</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.exception-Found"><span class="EXCEPTION">exception</span> <span class="UIDENT">Found</span> <span class="OF">of</span> <span class="LIDENT">output</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-type-T.val-raise_found"><span class="VAL">val</span> <span class="LIDENT">raise_found</span> <span class="COLON">:</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="UIDENT">Read_only</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="LIDENT">parsed_value</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Parser_output.module-I"><span class="MODULE">module</span> <span class="UIDENT">I</span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/positions.ml.html#module-Iterator"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Positions</span><span class="DOT">.</span><span class="UIDENT">Iterator</span></a></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Parser_output.val-annotate_sexp"><span class="LIDENT">annotate_sexp</span></span> <span id="local_sexp_125"><span class="LIDENT">sexp</span></span> <span id="local_iter_126"><span class="LIDENT">iter</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_sexp_125"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Type</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_start_pos_127"><span class="LIDENT">start_pos</span></span> <span class="EQUAL">=</span> <span class="UIDENT">I</span><span class="DOT">.</span><span class="LIDENT">advance_exn</span> <a href="#local_iter_126"><span class="LIDENT">iter</span></a> <span class="LABEL">~skip:</span><span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_end_pos_128"><span class="LIDENT">end_pos</span></span> <span class="EQUAL">=</span> <span class="UIDENT">I</span><span class="DOT">.</span><span class="LIDENT">advance_exn</span> <a href="#local_iter_126"><span class="LIDENT">iter</span></a> <span class="LABEL">~skip:</span><span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Annot</span><span class="DOT">.</span><span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <a href="#local_start_pos_127"><span class="LIDENT">start_pos</span></a><span class="SEMI">;</span> <a href="#local_end_pos_128"><span class="LIDENT">end_pos</span></a> <span class="RBRACE">}</span><span class="COMMA">,</span> <a href="#local_sexp_125"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Type</span><span class="DOT">.</span><span class="UIDENT">List</span> <span id="local_l_129"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_start_pos_130"><span class="LIDENT">start_pos</span></span> <span class="EQUAL">=</span> <span class="UIDENT">I</span><span class="DOT">.</span><span class="LIDENT">advance_exn</span> <a href="#local_iter_126"><span class="LIDENT">iter</span></a> <span class="LABEL">~skip:</span><span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_annot_131"><span class="LIDENT">annot</span></span> <span class="EQUAL">=</span> <span class="LIDENT">annotate_sexp_list</span> <a href="#local_l_129"><span class="LIDENT">l</span></a> <a href="#local_iter_126"><span class="LIDENT">iter</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_end_pos_132"><span class="LIDENT">end_pos</span></span> <span class="EQUAL">=</span> <span class="UIDENT">I</span><span class="DOT">.</span><span class="LIDENT">advance_exn</span> <a href="#local_iter_126"><span class="LIDENT">iter</span></a> <span class="LABEL">~skip:</span><span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Annot</span><span class="DOT">.</span><span class="UIDENT">List</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <a href="#local_start_pos_130"><span class="LIDENT">start_pos</span></a><span class="SEMI">;</span> <a href="#local_end_pos_132"><span class="LIDENT">end_pos</span></a> <span class="RBRACE">}</span><span class="COMMA">,</span> <a href="#local_annot_131"><span class="LIDENT">annot</span></a><span class="COMMA">,</span> <a href="#local_sexp_125"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Parser_output.val-annotate_sexp_list"><span class="LIDENT">annotate_sexp_list</span></span> <span id="local_sexps_133"><span class="LIDENT">sexps</span></span> <span id="local_iter_134"><span class="LIDENT">iter</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_sexp_135"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">annotate_sexp</span> <a href="#local_sexp_135"><span class="LIDENT">sexp</span></a> <a href="#local_iter_134"><span class="LIDENT">iter</span></a><span class="RPAREN">)</span> <a href="#local_sexps_133"><span class="LIDENT">sexps</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Parser_output.module-Bare_sexp"><span class="MODULE">module</span> <span class="UIDENT">Bare_sexp</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Parser_output.module-Bare_sexp.module-Impl"><span class="MODULE">module</span> <span class="UIDENT">Impl</span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/parsexp.ml.html#module-Eager"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Eager</span></a></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-Bare_sexp.type-output"><span class="TYPE">type</span> <span class="LIDENT">output</span> <span class="EQUAL">=</span> <a href="type.ml.html#type-t"><span class="UIDENT">Type</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-Bare_sexp.exception-Found"><span class="EXCEPTION">exception</span> <span class="UIDENT">Found</span> <span class="OF">of</span> <span class="LIDENT">output</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Parser_output.module-Bare_sexp.val-raise_found"><span class="LIDENT">raise_found</span></span> <span id="local__state_136"><span class="LIDENT">_state</span></span> <span id="local_sexp_137"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="LPAREN">(</span><span class="UIDENT">Found</span> <a href="#local_sexp_137"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Parser_output.module-Annotated_sexp"><span class="MODULE">module</span> <span class="UIDENT">Annotated_sexp</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Parser_output.module-Annotated_sexp.module-Impl"><span class="MODULE">module</span> <span class="UIDENT">Impl</span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/parsexp.ml.html#module-Eager_and_positions"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Eager_and_positions</span></a></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-Annotated_sexp.type-output"><span class="TYPE">type</span> <span class="LIDENT">output</span> <span class="EQUAL">=</span> <span class="UIDENT">Annot</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Parser_output.module-Annotated_sexp.exception-Found"><span class="EXCEPTION">exception</span> <span class="UIDENT">Found</span> <span class="OF">of</span> <span class="LIDENT">output</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Parser_output.module-Annotated_sexp.val-raise_found"><span class="LIDENT">raise_found</span></span> <span id="local__state_138"><span class="LIDENT">_state</span></span> <span class="LPAREN">(</span><span id="local_sexp_139"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span id="local_positions_140"><span class="LIDENT">positions</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_annot_141"><span class="LIDENT">annot</span></span> <span class="EQUAL">=</span> <span class="LIDENT">annotate_sexp</span> <a href="#local_sexp_139"><span class="LIDENT">sexp</span></a> <span class="LPAREN">(</span><span class="UIDENT">I</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_positions_140"><span class="LIDENT">positions</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise_notrace"><span class="LIDENT">raise_notrace</span></a> <span class="LPAREN">(</span><span class="UIDENT">Found</span> <a href="#local_annot_141"><span class="LIDENT">annot</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Make_parser"><span class="MODULE">module</span> <span class="UIDENT">Make_parser</span> <span class="LPAREN">(</span><span class="UIDENT">T</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Parser_output</span><span class="DOT">.</span><span class="UIDENT">T</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Make_parser.argument-1-T.type-input"><span class="TYPE">type</span> <span class="LIDENT">input</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Make_parser.argument-1-T.val-length"><span class="VAL">val</span> <span class="LIDENT">length</span> <span class="COLON">:</span> <span class="LIDENT">input</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Make_parser.argument-1-T.val-unsafe_feed_loop"><span class="VAL">val</span> <span class="LIDENT">unsafe_feed_loop</span><span class="EOL">
</span>      <span class="COLON">:</span>  <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">input</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">max_pos</span><span class="COLON">:</span><span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pos</span><span class="COLON">:</span><span class="LIDENT">int</span><span class="EOL">
</span>      <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-Make_parser.val-parse"><span class="VAL">val</span> <span class="LIDENT">parse</span><span class="EOL">
</span>    <span class="COLON">:</span>  <span class="OPTLABEL">?parse_pos:</span><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="EOL">
</span>    <span class="MINUSGREATER">-&gt;</span> <span class="OPTLABEL">?len:</span><span class="LIDENT">int</span><span class="EOL">
</span>    <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">input</span><span class="EOL">
</span>    <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">input</span><span class="COMMA">,</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">output</span><span class="RPAREN">)</span> <span class="LIDENT">parse_result</span></span><span class="EOL">
</span><span class="END">end</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_parser.val-parse_pos_of_state"><span class="LIDENT">parse_pos_of_state</span></span> <span id="local_state_142"><span class="LIDENT">state</span></span> <span id="local_buf_pos_143"><span class="LIDENT">buf_pos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">text_line</span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">line</span> <a href="#local_state_142"><span class="LIDENT">state</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">text_char</span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">column</span> <a href="#local_state_142"><span class="LIDENT">state</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">global_offset</span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">offset</span> <a href="#local_state_142"><span class="LIDENT">state</span></a><span class="EOL">
</span>    <span class="SEMI">;</span> <a href="#local_buf_pos_143"><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">buf_pos</span></a><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_parser.val-check_str_bounds"><span class="LIDENT">check_str_bounds</span></span> <span class="TILDE">~</span><span id="local_pos_144"><span class="LIDENT">pos</span></span> <span class="TILDE">~</span><span id="local_len_145"><span class="LIDENT">len</span></span> <span id="local_str_146"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_pos_144"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;parse: pos &lt; 0&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_len_145"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;parse: len &lt; 0&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_len_147"><span class="LIDENT">str_len</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_str_146"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pos_len_148"><span class="LIDENT">pos_len</span></span> <span class="EQUAL">=</span> <a href="#local_pos_144"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_145"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_pos_len_148"><span class="LIDENT">pos_len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_str_len_147"><span class="LIDENT">str_len</span></a> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;parse: pos + len &gt; str_len&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_pos_len_148"><span class="LIDENT">pos_len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_parser.val-raise_parse_error"><span class="LIDENT">raise_parse_error</span></span> <span id="local_state_149"><span class="LIDENT">state</span></span> <span id="local_pos_150"><span class="LIDENT">pos</span></span> <span id="local_msg_151"><span class="LIDENT">msg</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_parse_state_152"><span class="LIDENT">parse_state</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">parse_pos</span> <span class="EQUAL">=</span> <span class="LIDENT">parse_pos_of_state</span> <a href="#local_state_149"><span class="LIDENT">state</span></a> <a href="#local_pos_150"><span class="LIDENT">pos</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_parse_error_153"><span class="LIDENT">parse_error</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">err_msg</span> <span class="EQUAL">=</span> <a href="#local_msg_151"><span class="LIDENT">msg</span></a><span class="SEMI">;</span> <span class="LIDENT">parse_state</span> <span class="EQUAL">=</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Sexp</span> <a href="#local_parse_state_152"><span class="LIDENT">parse_state</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Parse_error</span> <a href="#local_parse_error_153"><span class="LIDENT">parse_error</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_parser.val-handle_parsexp_error"><span class="LIDENT">handle_parsexp_error</span></span> <span id="local_state_154"><span class="LIDENT">state</span></span> <span id="local_pos_155"><span class="LIDENT">pos</span></span> <span id="local_e_156"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_msg_157"><span class="LIDENT">msg</span></span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/parse_error.ml.html#val-message"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Parse_error</span><span class="DOT">.</span><span class="LIDENT">message</span></a> <a href="#local_e_156"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="../../../parsexp/src/parsexp/parse_error.ml.html#module-Private.val-old_parser_exn"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Parse_error</span><span class="DOT">.</span><span class="UIDENT">Private</span><span class="DOT">.</span><span class="LIDENT">old_parser_exn</span></a> <a href="#local_e_156"><span class="LIDENT">e</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Parse_error</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">raise_parse_error</span> <a href="#local_state_154"><span class="LIDENT">state</span></a> <a href="#local_pos_155"><span class="LIDENT">pos</span></a> <a href="#local_msg_157"><span class="LIDENT">msg</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Failure</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <a href="#local_msg_157"><span class="LIDENT">msg</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="module-Make_parser.val-run_feed_loop"><span class="LIDENT">run_feed_loop</span></span> <span id="local_state_158"><span class="LIDENT">state</span></span> <span id="local_stack_159"><span class="LIDENT">stack</span></span> <span class="TILDE">~</span><span id="local_pos_160"><span class="LIDENT">pos</span></span> <span class="TILDE">~</span><span id="local_len_161"><span class="LIDENT">len</span></span> <span id="local_str_162"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_pos_163"><span class="LIDENT">max_pos</span></span> <span class="EQUAL">=</span> <span class="LIDENT">check_str_bounds</span> <span class="TILDE">~</span><a href="#local_pos_160"><span class="LIDENT">pos</span></a> <span class="TILDE">~</span><a href="#local_len_161"><span class="LIDENT">len</span></a> <a href="#local_str_162"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_previous_offset_164"><span class="LIDENT">previous_offset</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">offset</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">unsafe_feed_loop</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <a href="#local_stack_159"><span class="LIDENT">stack</span></a> <a href="#local_str_162"><span class="LIDENT">str</span></a> <span class="TILDE">~</span><a href="#local_max_pos_163"><span class="LIDENT">max_pos</span></a> <span class="TILDE">~</span><a href="#local_pos_160"><span class="LIDENT">pos</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_stack_165"><span class="LIDENT">stack</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">mk_cont_state</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <a href="#local_stack_165"><span class="LIDENT">stack</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Found</span> <span id="local_result_166"><span class="LIDENT">result</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_offset_167"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">offset</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_next_pos_168"><span class="LIDENT">next_pos</span></span> <span class="EQUAL">=</span> <a href="#local_pos_160"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_offset_167"><span class="LIDENT">offset</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_previous_offset_164"><span class="LIDENT">previous_offset</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Done</span> <span class="LPAREN">(</span><a href="#local_result_166"><span class="LIDENT">result</span></a><span class="COMMA">,</span> <span class="LIDENT">parse_pos_of_state</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <a href="#local_next_pos_168"><span class="LIDENT">next_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Parse_error</span><span class="DOT">.</span><span class="UIDENT">Parse_error</span> <span id="local_err_169"><span class="LIDENT">err</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">handle_parsexp_error</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="#local_pos_160"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">offset</span> <a href="#local_state_158"><span class="LIDENT">state</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_previous_offset_164"><span class="LIDENT">previous_offset</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_err_169"><span class="LIDENT">err</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="module-Make_parser.val-mk_cont_state"><span class="LIDENT">mk_cont_state</span></span> <span id="local_state_170"><span class="LIDENT">state</span></span> <span id="local_stack_171"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_parse_fun_172"><span class="LIDENT">parse_fun</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_used_ref_173"><span class="LIDENT">used_ref</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="FUN">fun</span> <span class="TILDE">~</span><span id="local_pos_174"><span class="LIDENT">pos</span></span> <span class="TILDE">~</span><span id="local_len_175"><span class="LIDENT">len</span></span> <span id="local_str_176"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_used_ref_173"><span class="LIDENT">used_ref</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Sexplib.Sexp: parser continuation called twice&quot;</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <a href="#local_used_ref_173"><span class="LIDENT">used_ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">run_feed_loop</span> <a href="#local_state_170"><span class="LIDENT">state</span></a> <a href="#local_stack_171"><span class="LIDENT">stack</span></a> <span class="TILDE">~</span><a href="#local_pos_174"><span class="LIDENT">pos</span></a> <span class="TILDE">~</span><a href="#local_len_175"><span class="LIDENT">len</span></a> <a href="#local_str_176"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_cont_state_177"><span class="LIDENT">cont_state</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">old_parser_cont_state</span> <a href="#local_state_170"><span class="LIDENT">state</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><a href="#local_cont_state_177"><span class="LIDENT">cont_state</span></a><span class="COMMA">,</span> <a href="#local_parse_fun_172"><span class="LIDENT">parse_fun</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Make_parser.val-parse"><span class="LIDENT">parse</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_parse_pos_178"><span class="LIDENT">parse_pos</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span id="local_len_179"><span class="LIDENT">len</span></span> <span id="local_str_180"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_440"><span id="local_pos_181"><span class="LIDENT">pos</span></span><span class="COMMA">,</span> <span id="local_buf_pos_182"><span class="LIDENT">buf_pos</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_445"><span class="LBRACE">{</span> <span id="local_text_line_183"><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">text_line</span></span><span class="SEMI">;</span> <span id="local_text_char_184"><span class="LIDENT">text_char</span></span><span class="SEMI">;</span> <span id="local_global_offset_185"><span class="LIDENT">global_offset</span></span><span class="SEMI">;</span> <span id="local_buf_pos_186"><span class="LIDENT">buf_pos</span></span> <span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_parse_pos_178"><span class="LIDENT">parse_pos</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span> <span class="LBRACE">{</span> <span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Positions</span><span class="DOT">.</span><span class="LIDENT">line</span> <span class="EQUAL">=</span> <a href="#local_text_line_183"><span class="LIDENT">text_line</span></a><span class="SEMI">;</span> <span class="LIDENT">col</span> <span class="EQUAL">=</span> <a href="#local_text_char_184"><span class="LIDENT">text_char</span></a><span class="SEMI">;</span> <span class="LIDENT">offset</span> <span class="EQUAL">=</span> <a href="#local_global_offset_185"><span class="LIDENT">global_offset</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="COMMA">,</span> <a href="#local_buf_pos_186"><span class="LIDENT">buf_pos</span></a> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_state_187"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">State</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="TILDE">~</span><a href="#local_pos_181"><span class="LIDENT">pos</span></a> <span class="LABEL">~no_sexp_is_error:</span><span class="FALSE">false</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">raise_found</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_stack_188"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="UIDENT">Impl</span><span class="DOT">.</span><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">empty</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_189"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_len_179"><span class="LIDENT">len</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_190"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_190"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">T</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_str_180"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_buf_pos_182"><span class="LIDENT">buf_pos</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">run_feed_loop</span> <a href="#local_state_187"><span class="LIDENT">state</span></a> <a href="#local_stack_188"><span class="LIDENT">stack</span></a> <a href="#local_str_180"><span class="LIDENT">str</span></a> <span class="LABEL">~pos:</span><a href="#local_buf_pos_182"><span class="LIDENT">buf_pos</span></a> <span class="TILDE">~</span><a href="#local_len_189"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span><span class="EOL">
</span><span class="LBRACKETATAT">[@@</span><span class="LIDENT">inline</span> <span class="LIDENT">always</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-String_single_sexp"><span class="MODULE">module</span> <span class="UIDENT">String_single_sexp</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_parser</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Parser_output</span><span class="DOT">.</span><span class="UIDENT">Bare_sexp</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="def_448"><span class="TYPE">type</span> <span class="LIDENT">input</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_191"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_unsafe_feed_loop_192"><span class="LIDENT">unsafe_feed_loop</span></span> <span id="local_state_193"><span class="LIDENT">state</span></span> <span id="local_stack_194"><span class="LIDENT">stack</span></span> <span id="local_str_195"><span class="LIDENT">str</span></span> <span class="TILDE">~</span><span id="local_max_pos_196"><span class="LIDENT">max_pos</span></span> <span class="TILDE">~</span><span id="local_pos_197"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_pos_197"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_pos_196"><span class="LIDENT">max_pos</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_stack_198"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="LIDENT">feed</span> <a href="#local_state_193"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-unsafe_get"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_str_195"><span class="LIDENT">str</span></a> <a href="#local_pos_197"><span class="LIDENT">pos</span></a><span class="RPAREN">)</span> <a href="#local_stack_194"><span class="LIDENT">stack</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_unsafe_feed_loop_192"><span class="LIDENT">unsafe_feed_loop</span></a> <a href="#local_state_193"><span class="LIDENT">state</span></a> <a href="#local_stack_198"><span class="LIDENT">stack</span></a> <a href="#local_str_195"><span class="LIDENT">str</span></a> <span class="TILDE">~</span><a href="#local_max_pos_196"><span class="LIDENT">max_pos</span></a> <span class="LABEL">~pos:</span><span class="LPAREN">(</span><a href="#local_pos_197"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_stack_194"><span class="LIDENT">stack</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_str"><span class="LIDENT">parse_str</span></span> <span class="EQUAL">=</span> <span class="UIDENT">String_single_sexp</span><span class="DOT">.</span><span class="LIDENT">parse</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse"><span class="LIDENT">parse</span></span> <span class="EQUAL">=</span> <span class="UIDENT">String_single_sexp</span><span class="DOT">.</span><span class="LIDENT">parse</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-String_single_annot"><span class="MODULE">module</span> <span class="UIDENT">String_single_annot</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_parser</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Parser_output</span><span class="DOT">.</span><span class="UIDENT">Annotated_sexp</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="def_458"><span class="TYPE">type</span> <span class="LIDENT">input</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_199"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_unsafe_feed_loop_200"><span class="LIDENT">unsafe_feed_loop</span></span> <span id="local_state_201"><span class="LIDENT">state</span></span> <span id="local_stack_202"><span class="LIDENT">stack</span></span> <span id="local_str_203"><span class="LIDENT">str</span></span> <span class="TILDE">~</span><span id="local_max_pos_204"><span class="LIDENT">max_pos</span></span> <span class="TILDE">~</span><span id="local_pos_205"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_pos_205"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_pos_204"><span class="LIDENT">max_pos</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_stack_206"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="LIDENT">feed</span> <a href="#local_state_201"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-unsafe_get"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_str_203"><span class="LIDENT">str</span></a> <a href="#local_pos_205"><span class="LIDENT">pos</span></a><span class="RPAREN">)</span> <a href="#local_stack_202"><span class="LIDENT">stack</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_unsafe_feed_loop_200"><span class="LIDENT">unsafe_feed_loop</span></a> <a href="#local_state_201"><span class="LIDENT">state</span></a> <a href="#local_stack_206"><span class="LIDENT">stack</span></a> <a href="#local_str_203"><span class="LIDENT">str</span></a> <span class="TILDE">~</span><a href="#local_max_pos_204"><span class="LIDENT">max_pos</span></a> <span class="LABEL">~pos:</span><span class="LPAREN">(</span><a href="#local_pos_205"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_stack_202"><span class="LIDENT">stack</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_str_annot"><span class="LIDENT">parse_str_annot</span></span> <span class="EQUAL">=</span> <span class="UIDENT">String_single_annot</span><span class="DOT">.</span><span class="LIDENT">parse</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Bigstring_single_sexp"><span class="MODULE">module</span> <span class="UIDENT">Bigstring_single_sexp</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_parser</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Parser_output</span><span class="DOT">.</span><span class="UIDENT">Bare_sexp</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="def_453"><span class="TYPE">type</span> <span class="LIDENT">input</span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_207"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-dim"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">dim</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_unsafe_feed_loop_208"><span class="LIDENT">unsafe_feed_loop</span></span> <span id="local_state_209"><span class="LIDENT">state</span></span> <span id="local_stack_210"><span class="LIDENT">stack</span></span> <span class="LPAREN">(</span><span id="local_str_211"><span class="LIDENT">str</span></span> <span class="COLON">:</span> <span class="LIDENT">input</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_max_pos_212"><span class="LIDENT">max_pos</span></span> <span class="TILDE">~</span><span id="local_pos_213"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_pos_213"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_pos_212"><span class="LIDENT">max_pos</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_stack_214"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="LIDENT">feed</span> <a href="#local_state_209"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-unsafe_get"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_str_211"><span class="LIDENT">str</span></a> <a href="#local_pos_213"><span class="LIDENT">pos</span></a><span class="RPAREN">)</span> <a href="#local_stack_210"><span class="LIDENT">stack</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_unsafe_feed_loop_208"><span class="LIDENT">unsafe_feed_loop</span></a> <a href="#local_state_209"><span class="LIDENT">state</span></a> <a href="#local_stack_214"><span class="LIDENT">stack</span></a> <a href="#local_str_211"><span class="LIDENT">str</span></a> <span class="TILDE">~</span><a href="#local_max_pos_212"><span class="LIDENT">max_pos</span></a> <span class="LABEL">~pos:</span><span class="LPAREN">(</span><a href="#local_pos_213"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_stack_210"><span class="LIDENT">stack</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_bigstring"><span class="LIDENT">parse_bigstring</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Bigstring_single_sexp</span><span class="DOT">.</span><span class="LIDENT">parse</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Bigstring_single_annot"><span class="MODULE">module</span> <span class="UIDENT">Bigstring_single_annot</span> <span class="EQUAL">=</span> <span class="UIDENT">Make_parser</span> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">Parser_output</span><span class="DOT">.</span><span class="UIDENT">Annotated_sexp</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="def_438"><span class="TYPE">type</span> <span class="LIDENT">input</span> <span class="EQUAL">=</span> <span class="LIDENT">bigstring</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_215"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-dim"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">dim</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_unsafe_feed_loop_216"><span class="LIDENT">unsafe_feed_loop</span></span> <span id="local_state_217"><span class="LIDENT">state</span></span> <span id="local_stack_218"><span class="LIDENT">stack</span></span> <span class="LPAREN">(</span><span id="local_str_219"><span class="LIDENT">str</span></span> <span class="COLON">:</span> <span class="LIDENT">input</span><span class="RPAREN">)</span> <span class="TILDE">~</span><span id="local_max_pos_220"><span class="LIDENT">max_pos</span></span> <span class="TILDE">~</span><span id="local_pos_221"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_pos_221"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_pos_220"><span class="LIDENT">max_pos</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_stack_222"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Impl</span><span class="DOT">.</span><span class="LIDENT">feed</span> <a href="#local_state_217"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-unsafe_get"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_str_219"><span class="LIDENT">str</span></a> <a href="#local_pos_221"><span class="LIDENT">pos</span></a><span class="RPAREN">)</span> <a href="#local_stack_218"><span class="LIDENT">stack</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_unsafe_feed_loop_216"><span class="LIDENT">unsafe_feed_loop</span></a> <a href="#local_state_217"><span class="LIDENT">state</span></a> <a href="#local_stack_222"><span class="LIDENT">stack</span></a> <a href="#local_str_219"><span class="LIDENT">str</span></a> <span class="TILDE">~</span><a href="#local_max_pos_220"><span class="LIDENT">max_pos</span></a> <span class="LABEL">~pos:</span><span class="LPAREN">(</span><a href="#local_pos_221"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_stack_218"><span class="LIDENT">stack</span></a><span class="EOL">
</span>    <span class="SEMISEMI">;;</span><span class="EOL">
</span>  <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-parse_bigstring_annot"><span class="LIDENT">parse_bigstring_annot</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Bigstring_single_annot</span><span class="DOT">.</span><span class="LIDENT">parse</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Input functions *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mk_this_parse"><span class="LIDENT">mk_this_parse</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_223"><span class="LIDENT">parse_pos</span></span> <span id="local_my_parse_224"><span class="LIDENT">my_parse</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span class="TILDE">~</span><span id="local_pos_225"><span class="LIDENT">pos</span></span> <span class="TILDE">~</span><span id="local_len_226"><span class="LIDENT">len</span></span> <span id="local_str_227"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_parse_pos_228"><span class="LIDENT">parse_pos</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_parse_pos_223"><span class="LIDENT">parse_pos</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LABEL">~buf_pos:</span><a href="#local_pos_225"><span class="LIDENT">pos</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_parse_pos_229"><span class="LIDENT">parse_pos</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_pos_229"><span class="LIDENT">parse_pos</span></a><span class="DOT">.</span><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">buf_pos</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pos_225"><span class="LIDENT">pos</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_parse_pos_229"><span class="LIDENT">parse_pos</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_my_parse_224"><span class="LIDENT">my_parse</span></a> <span class="OPTLABEL">?parse_pos:</span><span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_parse_pos_228"><span class="LIDENT">parse_pos</span></a><span class="RPAREN">)</span> <span class="OPTLABEL">?len:</span><span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_len_226"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="#local_str_227"><span class="LIDENT">str</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* [ws_buf] must contain a single space character *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-feed_end_of_input"><span class="LIDENT">feed_end_of_input</span></span> <span class="TILDE">~</span><span id="local_this_parse_230"><span class="LIDENT">this_parse</span></span> <span class="TILDE">~</span><span id="local_ws_buf_231"><span class="LIDENT">ws_buf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* When parsing atoms, the incremental parser cannot tell whether
     it is at the end until it hits whitespace.  We therefore feed it
     one space to determine whether it is finished. *)</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_this_parse_230"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="LABEL">~len:</span><span class="INT">1</span> <a href="#local_ws_buf_231"><span class="LIDENT">ws_buf</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local_sexp_232"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ok</span> <a href="#local_sexp_232"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span id="local_cont_state_233"><span class="LIDENT">cont_state</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Error</span> <a href="#local_cont_state_233"><span class="LIDENT">cont_state</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_input_sexp"><span class="LIDENT">gen_input_sexp</span></span> <span id="local_my_parse_234"><span class="LIDENT">my_parse</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_235"><span class="LIDENT">parse_pos</span></span> <span id="local_ic_236"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_237"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_238"><span class="LIDENT">loop</span></span> <span id="local_this_parse_239"><span class="LIDENT">this_parse</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input_char"><span class="LIDENT">input_char</span></a> <a href="#local_ic_236"><span class="LIDENT">ic</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">End_of_file</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="LIDENT">feed_end_of_input</span> <span class="TILDE">~</span><a href="#local_this_parse_239"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~ws_buf:</span><span class="STRING">&quot; &quot;</span> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_sexp_240"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_240"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Error</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_241"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_buf_237"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_c_241"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_this_parse_239"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="LABEL">~len:</span><span class="INT">1</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_buf_237"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local_sexp_242"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_242"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_this_parse_243"><span class="LIDENT">this_parse</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_238"><span class="LIDENT">loop</span></a> <a href="#local_this_parse_243"><span class="LIDENT">this_parse</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_238"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="LIDENT">mk_this_parse</span> <span class="QUESTION">?</span><a href="#local_parse_pos_235"><span class="LIDENT">parse_pos</span></a> <a href="#local_my_parse_234"><span class="LIDENT">my_parse</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-input_sexp"><span class="LIDENT">input_sexp</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_244"><span class="LIDENT">parse_pos</span></span> <span id="local_ic_245"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_input_sexp</span> <span class="LIDENT">parse</span> <span class="QUESTION">?</span><a href="#local_parse_pos_244"><span class="LIDENT">parse_pos</span></a> <a href="#local_ic_245"><span class="LIDENT">ic</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_input_rev_sexps"><span class="LIDENT">gen_input_rev_sexps</span></span> <span id="local_my_parse_246"><span class="LIDENT">my_parse</span></span> <span class="TILDE">~</span><span id="local_ws_buf_247"><span class="LIDENT">ws_buf</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_248"><span class="LIDENT">parse_pos</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buf_249"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">8192</span><span class="RPAREN">)</span> <span id="local_ic_250"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_rev_sexps_ref_251"><span class="LIDENT">rev_sexps_ref</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_len_252"><span class="LIDENT">buf_len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-length"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_buf_249"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_253"><span class="LIDENT">loop</span></span> <span id="local_this_parse_254"><span class="LIDENT">this_parse</span></span> <span class="TILDE">~</span><span id="local_pos_255"><span class="LIDENT">pos</span></span> <span class="TILDE">~</span><span id="local_len_256"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_len_256"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_this_parse_254"><span class="LIDENT">this_parse</span></a> <span class="TILDE">~</span><a href="#local_pos_255"><span class="LIDENT">pos</span></a> <span class="TILDE">~</span><a href="#local_len_256"><span class="LIDENT">len</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_buf_249"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local_sexp_257"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_buf_pos_259"><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">buf_pos</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_parse_pos_258"><span class="LIDENT">parse_pos</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_rev_sexps_ref_251"><span class="LIDENT">rev_sexps_ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_sexp_257"><span class="LIDENT">sexp</span></a> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_rev_sexps_ref_251"><span class="LIDENT">rev_sexps_ref</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_n_parsed_260"><span class="LIDENT">n_parsed</span></span> <span class="EQUAL">=</span> <a href="#local_buf_pos_259"><span class="LIDENT">buf_pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pos_255"><span class="LIDENT">pos</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_this_parse_261"><span class="LIDENT">this_parse</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_this_parse</span> <span class="TILDE">~</span><a href="#local_parse_pos_258"><span class="LIDENT">parse_pos</span></a> <a href="#local_my_parse_246"><span class="LIDENT">my_parse</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_n_parsed_260"><span class="LIDENT">n_parsed</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_256"><span class="LIDENT">len</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_new_len_262"><span class="LIDENT">new_len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_250"><span class="LIDENT">ic</span></a> <a href="#local_buf_249"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_buf_len_252"><span class="LIDENT">buf_len</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_loop_253"><span class="LIDENT">loop</span></a> <a href="#local_this_parse_261"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="LABEL">~len:</span><a href="#local_new_len_262"><span class="LIDENT">new_len</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_253"><span class="LIDENT">loop</span></a> <a href="#local_this_parse_261"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><a href="#local_buf_pos_259"><span class="LIDENT">buf_pos</span></a> <span class="LABEL">~len:</span><span class="LPAREN">(</span><a href="#local_len_256"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_n_parsed_260"><span class="LIDENT">n_parsed</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_this_parse_263"><span class="LIDENT">this_parse</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_253"><span class="LIDENT">loop</span></a> <a href="#local_this_parse_263"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="LABEL">~len:</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_250"><span class="LIDENT">ic</span></a> <a href="#local_buf_249"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_buf_len_252"><span class="LIDENT">buf_len</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="LIDENT">feed_end_of_input</span> <span class="TILDE">~</span><a href="#local_this_parse_254"><span class="LIDENT">this_parse</span></a> <span class="TILDE">~</span><a href="#local_ws_buf_247"><span class="LIDENT">ws_buf</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_sexp_264"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_264"><span class="LIDENT">sexp</span></a> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_rev_sexps_ref_251"><span class="LIDENT">rev_sexps_ref</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Error</span> <span class="UIDENT">Parsing_toplevel_whitespace</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_rev_sexps_ref_251"><span class="LIDENT">rev_sexps_ref</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_cont_state_265"><span class="LIDENT">cont_state</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="STRING">&quot;Sexplib.Sexp.input_rev_sexps: reached EOF while in state &quot;</span><span class="EOL">
</span>           <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_cont_state_265"><span class="LIDENT">cont_state</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_266"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_250"><span class="LIDENT">ic</span></a> <a href="#local_buf_249"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_buf_len_252"><span class="LIDENT">buf_len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_this_parse_267"><span class="LIDENT">this_parse</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_this_parse</span> <span class="QUESTION">?</span><a href="#local_parse_pos_248"><span class="LIDENT">parse_pos</span></a> <a href="#local_my_parse_246"><span class="LIDENT">my_parse</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_253"><span class="LIDENT">loop</span></a> <a href="#local_this_parse_267"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="TILDE">~</span><a href="#local_len_266"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-input_rev_sexps"><span class="LIDENT">input_rev_sexps</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_268"><span class="LIDENT">parse_pos</span></span> <span class="QUESTION">?</span><span id="local_buf_269"><span class="LIDENT">buf</span></span> <span id="local_ic_270"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">gen_input_rev_sexps</span> <span class="LIDENT">parse</span> <span class="LABEL">~ws_buf:</span><span class="STRING">&quot; &quot;</span> <span class="QUESTION">?</span><a href="#local_parse_pos_268"><span class="LIDENT">parse_pos</span></a> <span class="QUESTION">?</span><a href="#local_buf_269"><span class="LIDENT">buf</span></a> <a href="#local_ic_270"><span class="LIDENT">ic</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-input_sexps"><span class="LIDENT">input_sexps</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_271"><span class="LIDENT">parse_pos</span></span> <span class="QUESTION">?</span><span id="local_buf_272"><span class="LIDENT">buf</span></span> <span id="local_ic_273"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><span class="LIDENT">input_rev_sexps</span> <span class="QUESTION">?</span><a href="#local_parse_pos_271"><span class="LIDENT">parse_pos</span></a> <span class="QUESTION">?</span><a href="#local_buf_272"><span class="LIDENT">buf</span></a> <a href="#local_ic_273"><span class="LIDENT">ic</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* of_string and of_bigstring *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string_bigstring"><span class="LIDENT">of_string_bigstring</span></span> <span id="local_loc_274"><span class="LIDENT">loc</span></span> <span id="local_my_parse_275"><span class="LIDENT">my_parse</span></span> <span id="local_ws_buf_276"><span class="LIDENT">ws_buf</span></span> <span id="local_get_len_277"><span class="LIDENT">get_len</span></span> <span id="local_get_sub_278"><span class="LIDENT">get_sub</span></span> <span id="local_str_279"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_my_parse_275"><span class="LIDENT">my_parse</span></a> <span class="OPTLABEL">?parse_pos:</span><span class="UIDENT">None</span> <span class="OPTLABEL">?len:</span><span class="UIDENT">None</span> <a href="#local_str_279"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local_sexp_280"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span id="local_parse_pos_281"><span class="LIDENT">parse_pos</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_my_parse_275"><span class="LIDENT">my_parse</span></a> <span class="OPTLABEL">?parse_pos:</span><span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_parse_pos_281"><span class="LIDENT">parse_pos</span></a><span class="RPAREN">)</span> <span class="OPTLABEL">?len:</span><span class="UIDENT">None</span> <a href="#local_str_279"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local__sexp2_282"><span class="LIDENT">_sexp2</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>         <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>            <span class="STRING">&quot;Sexplib.Sexp.%s: got multiple S-expressions where only one was expected.&quot;</span><span class="EOL">
</span>            <a href="#local_loc_274"><span class="LIDENT">loc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="UIDENT">Parsing_toplevel_whitespace</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_280"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="COMMENT">(* not using [feed_end_of_input] here means &quot;a b&quot; will end up here and not in
          &quot;multiple S-expressions&quot; branch, but it doesn't matter that much *)</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>         <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>            <span class="STRING">&quot;Sexplib.Sexp.%s: S-expression followed by data at position %d...&quot;</span><span class="EOL">
</span>            <a href="#local_loc_274"><span class="LIDENT">loc</span></a><span class="EOL">
</span>            <a href="#local_parse_pos_281"><span class="LIDENT">parse_pos</span></a><span class="DOT">.</span><span class="LIDENT">buf_pos</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_this_parse_283"><span class="LIDENT">this_parse</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="LIDENT">feed_end_of_input</span> <span class="TILDE">~</span><a href="#local_this_parse_283"><span class="LIDENT">this_parse</span></a> <span class="TILDE">~</span><a href="#local_ws_buf_276"><span class="LIDENT">ws_buf</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_sexp_284"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_284"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_cont_state_285"><span class="LIDENT">cont_state</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="LET">let</span> <span id="local_cont_state_str_286"><span class="LIDENT">cont_state_str</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_cont_state_285"><span class="LIDENT">cont_state</span></a> <span class="IN">in</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>         <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>            <span class="STRING">&quot;Sexplib.Sexp.%s: incomplete S-expression while in state %s: %s&quot;</span><span class="EOL">
</span>            <a href="#local_loc_274"><span class="LIDENT">loc</span></a><span class="EOL">
</span>            <a href="#local_cont_state_str_286"><span class="LIDENT">cont_state_str</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="#local_get_sub_278"><span class="LIDENT">get_sub</span></a> <a href="#local_str_279"><span class="LIDENT">str</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="#local_get_len_277"><span class="LIDENT">get_len</span></a> <a href="#local_str_279"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_str_287"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_string_bigstring</span> <span class="STRING">&quot;of_string&quot;</span> <span class="LIDENT">parse</span> <span class="STRING">&quot; &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_287"><span class="LIDENT">str</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string_many"><span class="LIDENT">of_string_many</span></span> <span id="local_str_288"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="../../../parsexp/src/parsexp/parsexp.ml.html#module-Many"><span class="UIDENT">Parsexp</span><span class="DOT">.</span><span class="UIDENT">Many</span><span class="DOT">.</span><span class="LIDENT">parse_string_exn</span></a> <a href="#local_str_288"><span class="LIDENT">str</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_bstr_sub_str"><span class="LIDENT">get_bstr_sub_str</span></span> <span id="local_bstr_289"><span class="LIDENT">bstr</span></span> <span id="local_pos_290"><span class="LIDENT">pos</span></span> <span id="local_len_291"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_292"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_len_291"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_291"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_str_292"><span class="LIDENT">str</span></a> <span class="LIDENT">i</span> <a href="#local_bstr_289"><span class="LIDENT">bstr</span></a><span class="DOT">.</span><span class="LBRACE">{</span><a href="#local_pos_290"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">i</span><span class="RBRACE">}</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_str_292"><span class="LIDENT">str</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bstr_ws_buf"><span class="LIDENT">bstr_ws_buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-create"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-char"><span class="LIDENT">char</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#val-c_layout"><span class="LIDENT">c_layout</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">bstr_ws_buf</span><span class="DOT">.</span><span class="LBRACE">{</span><span class="INT">0</span><span class="RBRACE">}</span> <span class="LESSMINUS">&lt;-</span> <span class="CHAR">' '</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_bigstring"><span class="LIDENT">of_bigstring</span></span> <span id="local_bstr_293"><span class="LIDENT">bstr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">of_string_bigstring</span><span class="EOL">
</span>    <span class="STRING">&quot;of_bigstring&quot;</span><span class="EOL">
</span>    <span class="LIDENT">parse_bigstring</span><span class="EOL">
</span>    <span class="LIDENT">bstr_ws_buf</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-dim"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">dim</span></a><span class="EOL">
</span>    <span class="LIDENT">get_bstr_sub_str</span><span class="EOL">
</span>    <a href="#local_bstr_293"><span class="LIDENT">bstr</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Loading *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_load_rev_sexps"><span class="LIDENT">gen_load_rev_sexps</span></span> <span id="local_input_rev_sexps_294"><span class="LIDENT">input_rev_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_295"><span class="LIDENT">buf</span></span> <span id="local_file_296"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ic_297"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-open_in"><span class="LIDENT">open_in</span></a> <a href="#local_file_296"><span class="LIDENT">file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sexps_298"><span class="LIDENT">sexps</span></span> <span class="EQUAL">=</span> <a href="#local_input_rev_sexps_294"><span class="LIDENT">input_rev_sexps</span></a> <span class="OPTLABEL">?parse_pos:</span><span class="UIDENT">None</span> <span class="QUESTION">?</span><a href="#local_buf_295"><span class="LIDENT">buf</span></a> <a href="#local_ic_297"><span class="LIDENT">ic</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_in"><span class="LIDENT">close_in</span></a> <a href="#local_ic_297"><span class="LIDENT">ic</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_sexps_298"><span class="LIDENT">sexps</span></a><span class="EOL">
</span>  <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_exc_299"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_in_noerr"><span class="LIDENT">close_in_noerr</span></a> <a href="#local_ic_297"><span class="LIDENT">ic</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_exc_299"><span class="LIDENT">exc</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_rev_sexps"><span class="LIDENT">load_rev_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_300"><span class="LIDENT">buf</span></span> <span id="local_file_301"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_load_rev_sexps</span> <span class="LIDENT">input_rev_sexps</span> <span class="QUESTION">?</span><a href="#local_buf_300"><span class="LIDENT">buf</span></a> <a href="#local_file_301"><span class="LIDENT">file</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_sexps"><span class="LIDENT">load_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_302"><span class="LIDENT">buf</span></span> <span id="local_file_303"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><span class="LIDENT">load_rev_sexps</span> <span class="QUESTION">?</span><a href="#local_buf_302"><span class="LIDENT">buf</span></a> <a href="#local_file_303"><span class="LIDENT">file</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_load_sexp_loc"><span class="LIDENT">gen_load_sexp_loc</span></span> <span class="EQUAL">=</span> <span class="STRING">&quot;Sexplib.Sexp.gen_load_sexp&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_load_sexp"><span class="LIDENT">gen_load_sexp</span></span> <span id="local_my_parse_304"><span class="LIDENT">my_parse</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_strict_305"><span class="LIDENT">strict</span></span> <span class="EQUAL">=</span> <span class="TRUE">true</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buf_306"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">8192</span><span class="RPAREN">)</span> <span id="local_file_307"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_len_308"><span class="LIDENT">buf_len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-length"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_buf_306"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ic_309"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-open_in"><span class="LIDENT">open_in</span></a> <a href="#local_file_307"><span class="LIDENT">file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_310"><span class="LIDENT">loop</span></span> <span id="local_this_parse_311"><span class="LIDENT">this_parse</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_312"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_309"><span class="LIDENT">ic</span></a> <a href="#local_buf_306"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_buf_len_308"><span class="LIDENT">buf_len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_len_312"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="LIDENT">feed_end_of_input</span> <span class="TILDE">~</span><a href="#local_this_parse_311"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~ws_buf:</span><span class="STRING">&quot; &quot;</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_sexp_313"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_313"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_cont_state_314"><span class="LIDENT">cont_state</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>             <span class="STRING">&quot;%s: EOF in %s while in state %s&quot;</span><span class="EOL">
</span>             <span class="LIDENT">gen_load_sexp_loc</span><span class="EOL">
</span>             <a href="#local_file_307"><span class="LIDENT">file</span></a><span class="EOL">
</span>             <span class="LPAREN">(</span><span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_cont_state_314"><span class="LIDENT">cont_state</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_this_parse_311"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="TILDE">~</span><a href="#local_len_312"><span class="LIDENT">len</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_buf_306"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local_sexp_315"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_buf_pos_317"><span class="UIDENT">Parse_pos</span><span class="DOT">.</span><span class="LIDENT">buf_pos</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_parse_pos_316"><span class="LIDENT">parse_pos</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="WHEN">when</span> <a href="#local_strict_305"><span class="LIDENT">strict</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="REC">rec</span> <span id="local_strict_loop_318"><span class="LIDENT">strict_loop</span></span> <span id="local_this_parse_319"><span class="LIDENT">this_parse</span></span> <span class="TILDE">~</span><span id="local_pos_320"><span class="LIDENT">pos</span></span> <span class="TILDE">~</span><span id="local_len_321"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_this_parse_319"><span class="LIDENT">this_parse</span></a> <span class="TILDE">~</span><a href="#local_pos_320"><span class="LIDENT">pos</span></a> <span class="TILDE">~</span><a href="#local_len_321"><span class="LIDENT">len</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_buf_306"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>              <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s: more than one S-expression in file %s&quot;</span> <span class="LIDENT">gen_load_sexp_loc</span> <a href="#local_file_307"><span class="LIDENT">file</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span id="local_cont_state_322"><span class="LIDENT">cont_state</span></span><span class="COMMA">,</span> <span id="local_this_parse_323"><span class="LIDENT">this_parse</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_len_324"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_309"><span class="LIDENT">ic</span></a> <a href="#local_buf_306"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_buf_len_308"><span class="LIDENT">buf_len</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_len_324"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>            <span class="THEN">then</span> <a href="#local_strict_loop_318"><span class="LIDENT">strict_loop</span></a> <a href="#local_this_parse_323"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><span class="INT">0</span> <span class="TILDE">~</span><a href="#local_len_324"><span class="LIDENT">len</span></a><span class="EOL">
</span>            <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_cont_state_322"><span class="LIDENT">cont_state</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="UIDENT">Parsing_toplevel_whitespace</span><span class="EOL">
</span>            <span class="THEN">then</span> <a href="#local_sexp_315"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>            <span class="ELSE">else</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a><span class="EOL">
</span>                <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>                   <span class="STRING">&quot;%s: %s in state %s loading file %s&quot;</span><span class="EOL">
</span>                   <span class="LIDENT">gen_load_sexp_loc</span><span class="EOL">
</span>                   <span class="STRING">&quot;additional incomplete data&quot;</span><span class="EOL">
</span>                   <span class="LPAREN">(</span><span class="UIDENT">Cont_state</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_cont_state_322"><span class="LIDENT">cont_state</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                   <a href="#local_file_307"><span class="LIDENT">file</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_this_parse_325"><span class="LIDENT">this_parse</span></span> <span class="EQUAL">=</span> <span class="LIDENT">mk_this_parse</span> <span class="TILDE">~</span><a href="#local_parse_pos_316"><span class="LIDENT">parse_pos</span></a> <a href="#local_my_parse_304"><span class="LIDENT">my_parse</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_strict_loop_318"><span class="LIDENT">strict_loop</span></a> <a href="#local_this_parse_325"><span class="LIDENT">this_parse</span></a> <span class="LABEL">~pos:</span><a href="#local_buf_pos_317"><span class="LIDENT">buf_pos</span></a> <span class="LABEL">~len:</span><span class="LPAREN">(</span><a href="#local_len_312"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_buf_pos_317"><span class="LIDENT">buf_pos</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Done</span> <span class="LPAREN">(</span><span id="local_sexp_326"><span class="LIDENT">sexp</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_326"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Cont</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_this_parse_327"><span class="LIDENT">this_parse</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_this_parse_327"><span class="LIDENT">this_parse</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sexp_328"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="LIDENT">mk_this_parse</span> <a href="#local_my_parse_304"><span class="LIDENT">my_parse</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_in"><span class="LIDENT">close_in</span></a> <a href="#local_ic_309"><span class="LIDENT">ic</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_sexp_328"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_exc_329"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-close_in_noerr"><span class="LIDENT">close_in_noerr</span></a> <a href="#local_ic_309"><span class="LIDENT">ic</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_exc_329"><span class="LIDENT">exc</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_sexp"><span class="LIDENT">load_sexp</span></span> <span class="QUESTION">?</span><span id="local_strict_330"><span class="LIDENT">strict</span></span> <span class="QUESTION">?</span><span id="local_buf_331"><span class="LIDENT">buf</span></span> <span id="local_file_332"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_load_sexp</span> <span class="LIDENT">parse</span> <span class="QUESTION">?</span><a href="#local_strict_330"><span class="LIDENT">strict</span></a> <span class="QUESTION">?</span><a href="#local_buf_331"><span class="LIDENT">buf</span></a> <a href="#local_file_332"><span class="LIDENT">file</span></a><span class="EOL">
</span><span class="EOL">
</span><span id="module-Annotated"><span class="MODULE">module</span> <span class="UIDENT">Annotated</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">Annot</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-parse"><span class="LIDENT">parse</span></span> <span class="EQUAL">=</span> <span class="LIDENT">parse_str_annot</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-parse_bigstring"><span class="LIDENT">parse_bigstring</span></span> <span class="EQUAL">=</span> <span class="LIDENT">parse_bigstring_annot</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-input_rev_sexps"><span class="LIDENT">input_rev_sexps</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_333"><span class="LIDENT">parse_pos</span></span> <span class="QUESTION">?</span><span id="local_buf_334"><span class="LIDENT">buf</span></span> <span id="local_ic_335"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">gen_input_rev_sexps</span> <span class="LIDENT">parse</span> <span class="LABEL">~ws_buf:</span><span class="STRING">&quot; &quot;</span> <span class="QUESTION">?</span><a href="#local_parse_pos_333"><span class="LIDENT">parse_pos</span></a> <span class="QUESTION">?</span><a href="#local_buf_334"><span class="LIDENT">buf</span></a> <a href="#local_ic_335"><span class="LIDENT">ic</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-input_sexp"><span class="LIDENT">input_sexp</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_336"><span class="LIDENT">parse_pos</span></span> <span id="local_ic_337"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_input_sexp</span> <span class="LIDENT">parse</span> <span class="QUESTION">?</span><a href="#local_parse_pos_336"><span class="LIDENT">parse_pos</span></a> <a href="#local_ic_337"><span class="LIDENT">ic</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-input_sexps"><span class="LIDENT">input_sexps</span></span> <span class="QUESTION">?</span><span id="local_parse_pos_338"><span class="LIDENT">parse_pos</span></span> <span class="QUESTION">?</span><span id="local_buf_339"><span class="LIDENT">buf</span></span> <span id="local_ic_340"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><span class="LIDENT">input_rev_sexps</span> <span class="QUESTION">?</span><a href="#local_parse_pos_338"><span class="LIDENT">parse_pos</span></a> <span class="QUESTION">?</span><a href="#local_buf_339"><span class="LIDENT">buf</span></a> <a href="#local_ic_340"><span class="LIDENT">ic</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_str_341"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">of_string_bigstring</span> <span class="STRING">&quot;Annotated.of_string&quot;</span> <span class="LIDENT">parse</span> <span class="STRING">&quot; &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_341"><span class="LIDENT">str</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-of_bigstring"><span class="LIDENT">of_bigstring</span></span> <span id="local_bstr_342"><span class="LIDENT">bstr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">of_string_bigstring</span><span class="EOL">
</span>      <span class="STRING">&quot;Annotated.of_bigstring&quot;</span><span class="EOL">
</span>      <span class="LIDENT">parse_bigstring</span><span class="EOL">
</span>      <span class="LIDENT">bstr_ws_buf</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/bigarray.ml.html#module-Array1.val-dim"><span class="UIDENT">Array1</span><span class="DOT">.</span><span class="LIDENT">dim</span></a><span class="EOL">
</span>      <span class="LIDENT">get_bstr_sub_str</span><span class="EOL">
</span>      <a href="#local_bstr_342"><span class="LIDENT">bstr</span></a><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-load_rev_sexps"><span class="LIDENT">load_rev_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_343"><span class="LIDENT">buf</span></span> <span id="local_file_344"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_load_rev_sexps</span> <span class="LIDENT">input_rev_sexps</span> <span class="QUESTION">?</span><a href="#local_buf_343"><span class="LIDENT">buf</span></a> <a href="#local_file_344"><span class="LIDENT">file</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-load_sexps"><span class="LIDENT">load_sexps</span></span> <span class="QUESTION">?</span><span id="local_buf_345"><span class="LIDENT">buf</span></span> <span id="local_file_346"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><span class="LIDENT">load_rev_sexps</span> <span class="QUESTION">?</span><a href="#local_buf_345"><span class="LIDENT">buf</span></a> <a href="#local_file_346"><span class="LIDENT">file</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-load_sexp"><span class="LIDENT">load_sexp</span></span> <span class="QUESTION">?</span><span id="local_strict_347"><span class="LIDENT">strict</span></span> <span class="QUESTION">?</span><span id="local_buf_348"><span class="LIDENT">buf</span></span> <span id="local_file_349"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_load_sexp</span> <span class="LIDENT">parse</span> <span class="QUESTION">?</span><a href="#local_strict_347"><span class="LIDENT">strict</span></a> <span class="QUESTION">?</span><a href="#local_buf_348"><span class="LIDENT">buf</span></a> <a href="#local_file_349"><span class="LIDENT">file</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-conv"><span class="LIDENT">conv</span></span> <span id="local_f_350"><span class="LIDENT">f</span></span> <span id="local_annot_sexp_351"><span class="LIDENT">annot_sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sexp_352"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_sexp</span> <a href="#local_annot_sexp_351"><span class="LIDENT">annot_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span class="LPAREN">(</span><a href="#local_f_350"><span class="LIDENT">f</span></a> <a href="#local_sexp_352"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span id="local_exc_354"><span class="LIDENT">exc</span></span><span class="COMMA">,</span> <span id="local_bad_sexp_355"><span class="LIDENT">bad_sexp</span></span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_e_353"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="LIDENT">find_sexp</span> <a href="#local_annot_sexp_351"><span class="LIDENT">annot_sexp</span></a> <a href="#local_bad_sexp_355"><span class="LIDENT">bad_sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_e_353"><span class="LIDENT">e</span></a><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_bad_annot_sexp_356"><span class="LIDENT">bad_annot_sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><a href="#local_exc_354"><span class="LIDENT">exc</span></a><span class="COMMA">,</span> <a href="#local_bad_annot_sexp_356"><span class="LIDENT">bad_annot_sexp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Annotated.val-get_conv_exn"><span class="LIDENT">get_conv_exn</span></span> <span class="TILDE">~</span><span id="local_file_357"><span class="LIDENT">file</span></span> <span class="TILDE">~</span><span id="local_exc_358"><span class="LIDENT">exc</span></span> <span id="local_annot_sexp_359"><span class="LIDENT">annot_sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_range_360"><span class="LIDENT">range</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_range</span> <a href="#local_annot_sexp_359"><span class="LIDENT">annot_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_439"><span class="LBRACE">{</span> <span class="LIDENT">start_pos</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span id="local_line_361"><span class="LIDENT">line</span></span><span class="SEMI">;</span> <span id="local_col_362"><span class="LIDENT">col</span></span><span class="SEMI">;</span> <span class="LIDENT">offset</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span><span class="SEMI">;</span> <span class="LIDENT">end_pos</span> <span class="EQUAL">=</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_range_360"><span class="LIDENT">range</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_loc_363"><span class="LIDENT">loc</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s:%d:%d&quot;</span> <a href="#local_file_357"><span class="LIDENT">file</span></a> <a href="#local_line_361"><span class="LIDENT">line</span></a> <a href="#local_col_362"><span class="LIDENT">col</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span class="UIDENT">Annot</span><span class="DOT">.</span><span class="UIDENT">Conv_exn</span> <span class="LPAREN">(</span><a href="#local_loc_363"><span class="LIDENT">loc</span></a><span class="COMMA">,</span> <a href="#local_exc_358"><span class="LIDENT">exc</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="LIDENT">get_sexp</span> <a href="#local_annot_sexp_359"><span class="LIDENT">annot_sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_sexp_conv"><span class="LIDENT">load_sexp_conv</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_strict_364"><span class="LIDENT">strict</span></span> <span class="EQUAL">=</span> <span class="TRUE">true</span><span class="RPAREN">)</span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buf_365"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">8192</span><span class="RPAREN">)</span> <span id="local_file_366"><span class="LIDENT">file</span></span> <span id="local_f_367"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sexp_368"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">load_sexp</span> <span class="TILDE">~</span><a href="#local_strict_364"><span class="LIDENT">strict</span></a> <span class="TILDE">~</span><a href="#local_buf_365"><span class="LIDENT">buf</span></a> <a href="#local_file_366"><span class="LIDENT">file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span class="LPAREN">(</span><a href="#local_f_367"><span class="LIDENT">f</span></a> <a href="#local_sexp_368"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">conv</span> <a href="#local_f_367"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">load_sexp</span> <span class="TILDE">~</span><a href="#local_strict_364"><span class="LIDENT">strict</span></a> <span class="TILDE">~</span><a href="#local_buf_365"><span class="LIDENT">buf</span></a> <a href="#local_file_366"><span class="LIDENT">file</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-raise_conv_exn"><span class="LIDENT">raise_conv_exn</span></span> <span class="TILDE">~</span><span id="local_file_369"><span class="LIDENT">file</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span id="local_res_370"><span class="LIDENT">res</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_res_370"><span class="LIDENT">res</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Error</span> <span class="LPAREN">(</span><span id="local_exc_371"><span class="LIDENT">exc</span></span><span class="COMMA">,</span> <span id="local_annot_sexp_372"><span class="LIDENT">annot_sexp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">get_conv_exn</span> <span class="TILDE">~</span><a href="#local_file_369"><span class="LIDENT">file</span></a> <span class="TILDE">~</span><a href="#local_exc_371"><span class="LIDENT">exc</span></a> <a href="#local_annot_sexp_372"><span class="LIDENT">annot_sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_sexp_conv_exn"><span class="LIDENT">load_sexp_conv_exn</span></span> <span class="QUESTION">?</span><span id="local_strict_373"><span class="LIDENT">strict</span></span> <span class="QUESTION">?</span><span id="local_buf_374"><span class="LIDENT">buf</span></span> <span id="local_file_375"><span class="LIDENT">file</span></span> <span id="local_f_376"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">raise_conv_exn</span> <span class="TILDE">~</span><a href="#local_file_375"><span class="LIDENT">file</span></a> <span class="LPAREN">(</span><span class="LIDENT">load_sexp_conv</span> <span class="QUESTION">?</span><a href="#local_strict_373"><span class="LIDENT">strict</span></a> <span class="QUESTION">?</span><a href="#local_buf_374"><span class="LIDENT">buf</span></a> <a href="#local_file_375"><span class="LIDENT">file</span></a> <a href="#local_f_376"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_sexps_conv"><span class="LIDENT">load_sexps_conv</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buf_377"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">8192</span><span class="RPAREN">)</span> <span id="local_file_378"><span class="LIDENT">file</span></span> <span id="local_f_379"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_rev_sexps_380"><span class="LIDENT">rev_sexps</span></span> <span class="EQUAL">=</span> <span class="LIDENT">load_rev_sexps</span> <span class="TILDE">~</span><a href="#local_buf_377"><span class="LIDENT">buf</span></a> <a href="#local_file_378"><span class="LIDENT">file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_sexp_381"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span class="LPAREN">(</span><a href="#local_f_379"><span class="LIDENT">f</span></a> <a href="#local_sexp_381"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rev_sexps_380"><span class="LIDENT">rev_sexps</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_e_382"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">load_rev_sexps</span> <span class="TILDE">~</span><a href="#local_buf_377"><span class="LIDENT">buf</span></a> <a href="#local_file_378"><span class="LIDENT">file</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="COMMENT">(* File is now empty - perhaps it was a temporary file handle? *)</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_e_382"><span class="LIDENT">e</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_rev_annot_sexps_383"><span class="LIDENT">rev_annot_sexps</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_annot_sexp_384"><span class="LIDENT">annot_sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">conv</span> <a href="#local_f_379"><span class="LIDENT">f</span></a> <a href="#local_annot_sexp_384"><span class="LIDENT">annot_sexp</span></a><span class="RPAREN">)</span> <a href="#local_rev_annot_sexps_383"><span class="LIDENT">rev_annot_sexps</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-load_sexps_conv_exn"><span class="LIDENT">load_sexps_conv_exn</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_buf_385"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">8192</span><span class="RPAREN">)</span> <span id="local_file_386"><span class="LIDENT">file</span></span> <span id="local_f_387"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_rev_sexps_388"><span class="LIDENT">rev_sexps</span></span> <span class="EQUAL">=</span> <span class="LIDENT">load_rev_sexps</span> <span class="TILDE">~</span><a href="#local_buf_385"><span class="LIDENT">buf</span></a> <a href="#local_file_386"><span class="LIDENT">file</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <a href="#local_f_387"><span class="LIDENT">f</span></a> <a href="#local_rev_sexps_388"><span class="LIDENT">rev_sexps</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_e_389"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">load_rev_sexps</span> <span class="TILDE">~</span><a href="#local_buf_385"><span class="LIDENT">buf</span></a> <a href="#local_file_386"><span class="LIDENT">file</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="COMMENT">(* File is now empty - perhaps it was a temporary file handle? *)</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_e_389"><span class="LIDENT">e</span></a><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_rev_annot_sexps_390"><span class="LIDENT">rev_annot_sexps</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a><span class="EOL">
</span>         <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_annot_sexp_391"><span class="LIDENT">annot_sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">raise_conv_exn</span> <span class="TILDE">~</span><a href="#local_file_386"><span class="LIDENT">file</span></a> <span class="LPAREN">(</span><span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">conv</span> <a href="#local_f_387"><span class="LIDENT">f</span></a> <a href="#local_annot_sexp_391"><span class="LIDENT">annot_sexp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>         <a href="#local_rev_annot_sexps_390"><span class="LIDENT">rev_annot_sexps</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_of_string_conv"><span class="LIDENT">gen_of_string_conv</span></span> <span id="local_of_string_392"><span class="LIDENT">of_string</span></span> <span id="local_annot_of_string_393"><span class="LIDENT">annot_of_string</span></span> <span id="local_str_394"><span class="LIDENT">str</span></span> <span id="local_f_395"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sexp_396"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="#local_of_string_392"><span class="LIDENT">of_string</span></a> <a href="#local_str_394"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Result</span> <span class="LPAREN">(</span><a href="#local_f_395"><span class="LIDENT">f</span></a> <a href="#local_sexp_396"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">conv</span> <a href="#local_f_395"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><a href="#local_annot_of_string_393"><span class="LIDENT">annot_of_string</span></a> <a href="#local_str_394"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string_conv"><span class="LIDENT">of_string_conv</span></span> <span id="local_str_397"><span class="LIDENT">str</span></span> <span id="local_f_398"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_of_string_conv</span> <span class="LIDENT">of_string</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">of_string</span> <a href="#local_str_397"><span class="LIDENT">str</span></a> <a href="#local_f_398"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_bigstring_conv"><span class="LIDENT">of_bigstring_conv</span></span> <span id="local_bstr_399"><span class="LIDENT">bstr</span></span> <span id="local_f_400"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">gen_of_string_conv</span> <span class="LIDENT">of_bigstring</span> <span class="UIDENT">Annotated</span><span class="DOT">.</span><span class="LIDENT">of_bigstring</span> <a href="#local_bstr_399"><span class="LIDENT">bstr</span></a> <a href="#local_f_400"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Of_string_conv_exn"><span class="MODULE">module</span> <span class="UIDENT">Of_string_conv_exn</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Of_string_conv_exn.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_464"><span class="LIDENT">exc</span> <span class="COLON">:</span> <span class="LIDENT">exn</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_454"><span class="LIDENT">sexp</span> <span class="COLON">:</span> <a href="type.ml.html#type-t"><span class="UIDENT">Type</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_465"><span class="LIDENT">sub_sexp</span> <span class="COLON">:</span> <a href="type.ml.html#type-t"><span class="UIDENT">Type</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Of_string_conv_exn.exception-E"><span class="EXCEPTION">exception</span> <span class="UIDENT">E</span> <span class="OF">of</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Conv</span><span class="DOT">.</span><span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LABEL">~finalise:</span><span class="FALSE">false</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">E</span><span class="RBRACKET">]</span> <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">E</span> <span id="local_osce_401"><span class="LIDENT">osce</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">sexp_conversion_error_message</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LABEL">~invalid_sexp:</span><a href="#local_osce_401"><span class="LIDENT">osce</span></a><span class="DOT">.</span><span class="LIDENT">sub_sexp</span><span class="EOL">
</span>          <span class="LABEL">~exn:</span><a href="#local_osce_401"><span class="LIDENT">osce</span></a><span class="DOT">.</span><span class="LIDENT">exc</span><span class="EOL">
</span>          <span class="LABEL">~containing_sexp:</span><a href="#local_osce_401"><span class="LIDENT">osce</span></a><span class="DOT">.</span><span class="LIDENT">sexp</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-gen_of_string_conv_exn"><span class="LIDENT">gen_of_string_conv_exn</span></span> <span id="local_of_string_402"><span class="LIDENT">of_string</span></span> <span id="local_str_403"><span class="LIDENT">str</span></span> <span id="local_f_404"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sexp_405"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="#local_of_string_402"><span class="LIDENT">of_string</span></a> <a href="#local_str_403"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <a href="#local_f_404"><span class="LIDENT">f</span></a> <a href="#local_sexp_405"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span id="local_exc_406"><span class="LIDENT">exc</span></span><span class="COMMA">,</span> <span id="local_sub_sexp_407"><span class="LIDENT">sub_sexp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Of_string_conv_exn</span><span class="DOT">.</span><span class="UIDENT">E</span> <span class="LBRACE">{</span> <a href="#local_exc_406"><span class="UIDENT">Of_string_conv_exn</span><span class="DOT">.</span><span class="LIDENT">exc</span></a><span class="SEMI">;</span> <a href="#local_sexp_405"><span class="LIDENT">sexp</span></a><span class="SEMI">;</span> <a href="#local_sub_sexp_407"><span class="LIDENT">sub_sexp</span></a> <span class="RBRACE">}</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string_conv_exn"><span class="LIDENT">of_string_conv_exn</span></span> <span id="local_str_408"><span class="LIDENT">str</span></span> <span id="local_f_409"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_of_string_conv_exn</span> <span class="LIDENT">of_string</span> <a href="#local_str_408"><span class="LIDENT">str</span></a> <a href="#local_f_409"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_bigstring_conv_exn"><span class="LIDENT">of_bigstring_conv_exn</span></span> <span id="local_bstr_410"><span class="LIDENT">bstr</span></span> <span id="local_f_411"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">gen_of_string_conv_exn</span> <span class="LIDENT">of_bigstring</span> <a href="#local_bstr_410"><span class="LIDENT">bstr</span></a> <a href="#local_f_411"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string_many_conv_exn"><span class="LIDENT">of_string_many_conv_exn</span></span> <span id="local_str_412"><span class="LIDENT">str</span></span> <span id="local_f_413"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sexps_414"><span class="LIDENT">sexps</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_string_many</span> <a href="#local_str_412"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_sexp_415"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">gen_of_string_conv_exn</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_416"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_416"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_sexp_415"><span class="LIDENT">sexp</span></a> <a href="#local_f_413"><span class="LIDENT">f</span></a><span class="RPAREN">)</span> <a href="#local_sexps_414"><span class="LIDENT">sexps</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Utilities for automated type conversions *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unit"><span class="LIDENT">unit</span></span> <span class="EQUAL">=</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_unit"><span class="LIDENT">is_unit</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-sexp_of_t"><span class="EXTERNAL">external</span> <span class="LIDENT">sexp_of_t</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%identity&quot;</span></span><span class="EOL">
</span><span id="val-t_of_sexp"><span class="EXTERNAL">external</span> <span class="LIDENT">t_of_sexp</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%identity&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Utilities for conversion error handling *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-found"><span class="TYPE">type</span> <span class="LIDENT">found</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Found</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Pos</span> <span class="OF">of</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">found</span><span class="EOL">
</span>  <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-search_result"><span class="TYPE">type</span> <span class="LIDENT">search_result</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACKET">[</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Not_found</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LIDENT">found</span><span class="EOL">
</span>  <span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-search_physical"><span class="LIDENT">search_physical</span></span> <span id="local_sexp_417"><span class="LIDENT">sexp</span></span> <span class="TILDE">~</span><span id="local_contained_418"><span class="LIDENT">contained</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_sexp_417"><span class="LIDENT">sexp</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="INFIXOP0">==</span></a> <a href="#local_contained_418"><span class="LIDENT">contained</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Found</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_sexp_417"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Not_found</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">List</span> <span id="local_lst_419"><span class="LIDENT">lst</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_420"><span class="LIDENT">loop</span></span> <span id="local_i_421"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Not_found</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local_h_422"><span class="LIDENT">h</span></span> <span class="COLONCOLON">::</span> <span id="local_t_423"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_res_424"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <span class="LIDENT">search_physical</span> <a href="#local_h_422"><span class="LIDENT">h</span></a> <span class="TILDE">~</span><a href="#local_contained_418"><span class="LIDENT">contained</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_res_424"><span class="LIDENT">res</span></a> <span class="WITH">with</span><span class="EOL">
</span>           <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_420"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="#local_i_421"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_t_423"><span class="LIDENT">t</span></a><span class="EOL">
</span>           <span class="BAR">|</span> <span class="HASH">#</span><span class="LIDENT">found</span> <span class="AS">as</span> <span id="local_found_425"><span class="LIDENT">found</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Pos</span> <span class="LPAREN">(</span><a href="#local_i_421"><span class="LIDENT">i</span></a><span class="COMMA">,</span> <a href="#local_found_425"><span class="LIDENT">found</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_loop_420"><span class="LIDENT">loop</span></a> <span class="INT">0</span> <a href="#local_lst_419"><span class="LIDENT">lst</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-subst_found"><span class="LIDENT">subst_found</span></span> <span id="local_sexp_426"><span class="LIDENT">sexp</span></span> <span class="TILDE">~</span><span id="local_subst_427"><span class="LIDENT">subst</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Found</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_subst_427"><span class="LIDENT">subst</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Pos</span> <span class="LPAREN">(</span><span id="local_pos_428"><span class="LIDENT">pos</span></span><span class="COMMA">,</span> <span id="local_found_429"><span class="LIDENT">found</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_sexp_426"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Sexplib.Sexp.subst_found: atom when position requested&quot;</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">List</span> <span id="local_lst_430"><span class="LIDENT">lst</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_431"><span class="LIDENT">loop</span></span> <span id="local_acc_432"><span class="LIDENT">acc</span></span> <span id="local_pos_433"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Sexplib.Sexp.subst_found: short list when position requested&quot;</span><span class="EOL">
</span>         <span class="BAR">|</span> <span id="local_h_434"><span class="LIDENT">h</span></span> <span class="COLONCOLON">::</span> <span id="local_t_435"><span class="LIDENT">t</span></span> <span class="WHEN">when</span> <a href="#local_pos_433"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_431"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="#local_h_434"><span class="LIDENT">h</span></a> <span class="COLONCOLON">::</span> <a href="#local_acc_432"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_pos_433"><span class="LIDENT">pos</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_t_435"><span class="LIDENT">t</span></a><span class="EOL">
</span>         <span class="BAR">|</span> <span id="local_h_436"><span class="LIDENT">h</span></span> <span class="COLONCOLON">::</span> <span id="local_t_437"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_append"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_append</span></a> <a href="#local_acc_432"><span class="LIDENT">acc</span></a> <span class="LPAREN">(</span><span class="LIDENT">subst_found</span> <a href="#local_h_436"><span class="LIDENT">h</span></a> <span class="TILDE">~</span><a href="#local_subst_427"><span class="LIDENT">subst</span></a> <a href="#local_found_429"><span class="LIDENT">found</span></a> <span class="COLONCOLON">::</span> <a href="#local_t_437"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="IN">in</span><span class="EOL">
</span>       <a href="#local_loop_431"><span class="LIDENT">loop</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_pos_428"><span class="LIDENT">pos</span></a> <a href="#local_lst_430"><span class="LIDENT">lst</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span></span></code></pre></body></html>
