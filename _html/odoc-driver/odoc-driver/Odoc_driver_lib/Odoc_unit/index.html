<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Odoc_unit (odoc-driver.odoc-driver.Odoc_driver_lib.Odoc_unit)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../../';
let search_urls = ['../../../sherlodoc_db.js','../../../../sherlodoc.js'];
</script><script src="../../../../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> ‚Äì <a href="../../../../index.html">üè†</a> &#x00BB; <a href="../../../index.html">The odoc reference driver</a> &#x00BB; Library <code>odoc-driver</code> &#x00BB; <a href="../index.html">Odoc_driver_lib</a> &#x00BB; Odoc_unit</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Odoc_driver_lib.Odoc_unit</span></code><a href="../../../src/odoc-driver/odoc_unit.ml.html" class="source_link">Source</a></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../../index.html">The odoc reference driver</a><ul><li>Library <code>odoc-driver</code><ul><li><a href="../index.html">Odoc_driver_lib</a><ul><li><a href="../Cmd_outputs/index.html">Cmd_outputs</a></li><li><a href="../Common_args/index.html">Common_args</a></li><li><a href="../Compile/index.html">Compile</a></li><li><a href="../Db/index.html">Db</a></li><li><a href="../Global_config/index.html">Global_config</a></li><li><a href="../Landing_pages/index.html">Landing_pages</a></li><li><a href="../Library_names/index.html">Library_names</a></li><li><a href="../Monorepo_style/index.html">Monorepo_style</a></li><li><a href="../Ocamlfind/index.html">Ocamlfind</a></li><li><a href="../Ocamlobjinfo/index.html">Ocamlobjinfo</a></li><li><a href="../Odoc/index.html">Odoc</a></li><li><a href="#" class="current_unit">Odoc_unit</a><ul><li><a href="Pkg_args/index.html">Pkg_args</a></li></ul></li><li><a href="../Odoc_units_of/index.html">Odoc_units_of</a></li><li><a href="../Opam/index.html">Opam</a></li><li><a href="../Packages/index.html">Packages</a></li><li><a href="../Run/index.html">Run</a></li><li><a href="../Sherlodoc/index.html">Sherlodoc</a></li><li><a href="../Stats/index.html">Stats</a></li><li><a href="../Util/index.html">Util</a></li><li><a href="../Voodoo/index.html">Voodoo</a></li><li><a href="../Worker_pool/index.html">Worker_pool</a></li></ul></li></ul></li><li><a href="../../../src/index.html">Sources</a></li></ul></li></ul></nav></div><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Pkg_args"><a href="#module-Pkg_args" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#module-Pkg_args" class="source_link">Source</a><code><span><span class="keyword">module</span> <a href="Pkg_args/index.html">Pkg_args</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-sidebar"><a href="#type-sidebar" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-sidebar" class="source_link">Source</a><code><span><span class="keyword">type</span> sidebar</span><span> = </span><span>{</span></code><ol><li id="type-sidebar.output_file" class="def record field anchored"><a href="#type-sidebar.output_file" class="anchor"></a><code><span>output_file : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-sidebar.json" class="def record field anchored"><a href="#type-sidebar.json" class="anchor"></a><code><span>json : bool;</span></code></li><li id="type-sidebar.pkg_dir" class="def record field anchored"><a href="#type-sidebar.pkg_dir" class="anchor"></a><code><span>pkg_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-index"><a href="#type-index" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-index" class="source_link">Source</a><code><span><span class="keyword">type</span> index</span><span> = </span><span>{</span></code><ol><li id="type-index.roots" class="def record field anchored"><a href="#type-index.roots" class="anchor"></a><code><span>roots : <span><a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a> list</span>;</span></code></li><li id="type-index.output_file" class="def record field anchored"><a href="#type-index.output_file" class="anchor"></a><code><span>output_file : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-index.json" class="def record field anchored"><a href="#type-index.json" class="anchor"></a><code><span>json : bool;</span></code></li><li id="type-index.search_dir" class="def record field anchored"><a href="#type-index.search_dir" class="anchor"></a><code><span>search_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-index.sidebar" class="def record field anchored"><a href="#type-index.sidebar" class="anchor"></a><code><span>sidebar : <span><a href="#type-sidebar">sidebar</a> option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-t" class="source_link">Source</a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = </span><span>{</span></code><ol><li id="type-t.parent_id" class="def record field anchored"><a href="#type-t.parent_id" class="anchor"></a><code><span>parent_id : <a href="../Odoc/Id/index.html#type-t">Odoc.Id.t</a>;</span></code></li><li id="type-t.input_file" class="def record field anchored"><a href="#type-t.input_file" class="anchor"></a><code><span>input_file : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-t.output_dir" class="def record field anchored"><a href="#type-t.output_dir" class="anchor"></a><code><span>output_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-t.odoc_file" class="def record field anchored"><a href="#type-t.odoc_file" class="anchor"></a><code><span>odoc_file : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-t.odocl_file" class="def record field anchored"><a href="#type-t.odocl_file" class="anchor"></a><code><span>odocl_file : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-t.pkg_args" class="def record field anchored"><a href="#type-t.pkg_args" class="anchor"></a><code><span>pkg_args : <a href="Pkg_args/index.html#type-t">Pkg_args.t</a>;</span></code></li><li id="type-t.pkgname" class="def record field anchored"><a href="#type-t.pkgname" class="anchor"></a><code><span>pkgname : <span>string option</span>;</span></code></li><li id="type-t.index" class="def record field anchored"><a href="#type-t.index" class="anchor"></a><code><span>index : <span><a href="#type-index">index</a> option</span>;</span></code></li><li id="type-t.enable_warnings" class="def record field anchored"><a href="#type-t.enable_warnings" class="anchor"></a><code><span>enable_warnings : bool;</span></code></li><li id="type-t.to_output" class="def record field anchored"><a href="#type-t.to_output" class="anchor"></a><code><span>to_output : bool;</span></code></li><li id="type-t.kind" class="def record field anchored"><a href="#type-t.kind" class="anchor"></a><code><span>kind : <span class="type-var">'a</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-intf_extra"><a href="#type-intf_extra" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-intf_extra" class="source_link">Source</a><code><span><span class="keyword">type</span> intf_extra</span><span> = </span><span>{</span></code><ol><li id="type-intf_extra.hidden" class="def record field anchored"><a href="#type-intf_extra.hidden" class="anchor"></a><code><span>hidden : bool;</span></code></li><li id="type-intf_extra.hash" class="def record field anchored"><a href="#type-intf_extra.hash" class="anchor"></a><code><span>hash : string;</span></code></li><li id="type-intf_extra.deps" class="def record field anchored"><a href="#type-intf_extra.deps" class="anchor"></a><code><span>deps : <span><span>(string * <a href="../../../../ocaml-base-compiler/stdlib/Stdlib/Digest/index.html#type-t">Digest.t</a>)</span> list</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-intf"><a href="#type-intf" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-intf" class="source_link">Source</a><code><span><span class="keyword">and</span> intf</span><span> = </span><span>[ </span></code><ol><li id="type-intf.Intf" class="def variant constructor anchored"><a href="#type-intf.Intf" class="anchor"></a><code><span>| </span><span>`Intf <span class="keyword">of</span> <a href="#type-intf_extra">intf_extra</a></span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-impl_extra"><a href="#type-impl_extra" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-impl_extra" class="source_link">Source</a><code><span><span class="keyword">type</span> impl_extra</span><span> = </span><span>{</span></code><ol><li id="type-impl_extra.src_id" class="def record field anchored"><a href="#type-impl_extra.src_id" class="anchor"></a><code><span>src_id : <a href="../Odoc/Id/index.html#type-t">Odoc.Id.t</a>;</span></code></li><li id="type-impl_extra.src_path" class="def record field anchored"><a href="#type-impl_extra.src_path" class="anchor"></a><code><span>src_path : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-impl"><a href="#type-impl" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-impl" class="source_link">Source</a><code><span><span class="keyword">type</span> impl</span><span> = </span><span>[ </span></code><ol><li id="type-impl.Impl" class="def variant constructor anchored"><a href="#type-impl.Impl" class="anchor"></a><code><span>| </span><span>`Impl <span class="keyword">of</span> <a href="#type-impl_extra">impl_extra</a></span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mld"><a href="#type-mld" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-mld" class="source_link">Source</a><code><span><span class="keyword">type</span> mld</span><span> = </span><span>[ </span></code><ol><li id="type-mld.Mld" class="def variant constructor anchored"><a href="#type-mld.Mld" class="anchor"></a><code><span>| </span><span>`Mld</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-md"><a href="#type-md" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-md" class="source_link">Source</a><code><span><span class="keyword">type</span> md</span><span> = </span><span>[ </span></code><ol><li id="type-md.Md" class="def variant constructor anchored"><a href="#type-md.Md" class="anchor"></a><code><span>| </span><span>`Md</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-asset"><a href="#type-asset" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-asset" class="source_link">Source</a><code><span><span class="keyword">type</span> asset</span><span> = </span><span>[ </span></code><ol><li id="type-asset.Asset" class="def variant constructor anchored"><a href="#type-asset.Asset" class="anchor"></a><code><span>| </span><span>`Asset</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-any"><a href="#type-any" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-any" class="source_link">Source</a><code><span><span class="keyword">type</span> any</span><span> = <span><span>[ <a href="#type-impl">impl</a> <span>| <a href="#type-intf">intf</a></span> <span>| <a href="#type-mld">mld</a></span> <span>| <a href="#type-asset">asset</a></span> <span>| <a href="#type-md">md</a></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-pp" class="source_link">Source</a><code><span><span class="keyword">val</span> pp : <span><a href="#type-any">any</a> <a href="../../../../fmt/fmt/Fmt/index.html#type-t">Fmt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pkg_dir"><a href="#val-pkg_dir" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-pkg_dir" class="source_link">Source</a><code><span><span class="keyword">val</span> pkg_dir : <span><a href="../Packages/index.html#type-t">Packages.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lib_dir"><a href="#val-lib_dir" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-lib_dir" class="source_link">Source</a><code><span><span class="keyword">val</span> lib_dir : <span><a href="../Packages/index.html#type-t">Packages.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Packages/index.html#type-libty">Packages.libty</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-doc_dir"><a href="#val-doc_dir" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-doc_dir" class="source_link">Source</a><code><span><span class="keyword">val</span> doc_dir : <span><a href="../Packages/index.html#type-t">Packages.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-src_dir"><a href="#val-src_dir" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-src_dir" class="source_link">Source</a><code><span><span class="keyword">val</span> src_dir : <span><a href="../Packages/index.html#type-t">Packages.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-src_lib_dir"><a href="#val-src_lib_dir" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-src_lib_dir" class="source_link">Source</a><code><span><span class="keyword">val</span> src_lib_dir : <span><a href="../Packages/index.html#type-t">Packages.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Packages/index.html#type-libty">Packages.libty</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dirs"><a href="#type-dirs" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#type-dirs" class="source_link">Source</a><code><span><span class="keyword">type</span> dirs</span><span> = </span><span>{</span></code><ol><li id="type-dirs.odoc_dir" class="def record field anchored"><a href="#type-dirs.odoc_dir" class="anchor"></a><code><span>odoc_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-dirs.odocl_dir" class="def record field anchored"><a href="#type-dirs.odocl_dir" class="anchor"></a><code><span>odocl_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-dirs.index_dir" class="def record field anchored"><a href="#type-dirs.index_dir" class="anchor"></a><code><span>index_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li><li id="type-dirs.mld_dir" class="def record field anchored"><a href="#type-dirs.mld_dir" class="anchor"></a><code><span>mld_dir : <a href="../../../../fpath/fpath/Fpath/index.html#type-t">Fpath.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fix_virtual"><a href="#val-fix_virtual" class="anchor"></a><a href="../../../src/odoc-driver/odoc_unit.ml.html#val-fix_virtual" class="source_link">Source</a><code><span><span class="keyword">val</span> fix_virtual : 
  <span><span class="label">precompiled_units</span>:<span><span><span><a href="#type-intf">intf</a> <a href="#type-t">t</a></span> list</span> <a href="../Util/StringMap/index.html#type-t">Util.StringMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">units</span>:<span><span><span><a href="#type-intf">intf</a> <a href="#type-t">t</a></span> list</span> <a href="../Util/StringMap/index.html#type-t">Util.StringMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="#type-intf">intf</a> <a href="#type-t">t</a></span> list</span> <a href="../Util/StringMap/index.html#type-t">Util.StringMap.t</a></span></span></code></div><div class="spec-doc"><p><code>fix_virtual ~precompiled_units ~units</code> replaces the input file in units representing implementations of virtual libraries. Implementation units have a <code>cmt</code> but no <code>cmti</code>, even though the interface is actually constrained by a <code>mli</code>. The <code>cmi</code> file for the implementation is actually taken from the virtual library, so this function replaces the <code>cmt</code> used for the interface rendering of the implemenetation library units with the <code>cmti</code> taken from the virtual library. <code>units</code> should contain all the units that might be changed by this function. <code>precompiled_units</code> should be empty if this is being called before any compilation has taken place - ie. in monorepo or opam mode. In voodoo mode if the virtual library is in a different package it will have already been compiled. and thus should not be changed. The types of the inputs and outputs are hashtbls of units, where the hashtable key is the interface hash.</p></div></div></div></body></html>
