<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: flow.ml (ocamlgraph.src.ocamlgraph)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocamlgraph</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; ocamlgraph &#x00BB; flow.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>flow.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocamlgraph</a><ul><li>Library <code>ocamlgraph</code><ul><li><a href="../../ocamlgraph/Graph/index.html">Graph</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>ocamlgraph<ul><li><a href="blocks.ml.html">blocks.ml</a></li><li><a href="builder.ml.html">builder.ml</a></li><li><a href="chaoticIteration.ml.html">chaoticIteration.ml</a></li><li><a href="classic.ml.html">classic.ml</a></li><li><a href="clique.ml.html">clique.ml</a></li><li><a href="cliquetree.ml.html">cliquetree.ml</a></li><li><a href="coloring.ml.html">coloring.ml</a></li><li><a href="components.ml.html">components.ml</a></li><li><a href="contraction.ml.html">contraction.ml</a></li><li><a href="cycles.ml.html">cycles.ml</a></li><li><a href="dGraphModel.ml.html">dGraphModel.ml</a></li><li><a href="dGraphRandModel.ml.html">dGraphRandModel.ml</a></li><li><a href="dGraphSubTree.ml.html">dGraphSubTree.ml</a></li><li><a href="dGraphTreeLayout.ml.html">dGraphTreeLayout.ml</a></li><li><a href="dGraphTreeModel.ml.html">dGraphTreeModel.ml</a></li><li><a href="delaunay.ml.html">delaunay.ml</a></li><li><a href="dominator.ml.html">dominator.ml</a></li><li><a href="dot.ml.html">dot.ml</a></li><li><a href="dot_lexer.ml.html">dot_lexer.ml</a></li><li><a href="dot_parser.ml.html">dot_parser.ml</a></li><li><a href="eulerian.ml.html">eulerian.ml</a></li><li><a href="fixpoint.ml.html">fixpoint.ml</a></li><li><a href="#" class="current_unit">flow.ml</a></li><li><a href="gmap.ml.html">gmap.ml</a></li><li><a href="gml.ml.html">gml.ml</a></li><li><a href="graph.ml.html">graph.ml</a></li><li><a href="graph__.ml.html">graph__.ml</a></li><li><a href="graphml.ml.html">graphml.ml</a></li><li><a href="graphviz.ml.html">graphviz.ml</a></li><li><a href="imperative.ml.html">imperative.ml</a></li><li><a href="kruskal.ml.html">kruskal.ml</a></li><li><a href="leaderlist.ml.html">leaderlist.ml</a></li><li><a href="mcs_m.ml.html">mcs_m.ml</a></li><li><a href="md.ml.html">md.ml</a></li><li><a href="merge.ml.html">merge.ml</a></li><li><a href="mincut.ml.html">mincut.ml</a></li><li><a href="minsep.ml.html">minsep.ml</a></li><li><a href="nonnegative.ml.html">nonnegative.ml</a></li><li><a href="oper.ml.html">oper.ml</a></li><li><a href="pack.ml.html">pack.ml</a></li><li><a href="path.ml.html">path.ml</a></li><li><a href="persistent.ml.html">persistent.ml</a></li><li><a href="prim.ml.html">prim.ml</a></li><li><a href="rand.ml.html">rand.ml</a></li><li><a href="strat.ml.html">strat.ml</a></li><li><a href="topological.ml.html">topological.ml</a></li><li><a href="traverse.ml.html">traverse.ml</a></li><li><a href="util.ml.html">util.ml</a></li><li><a href="weakTopological.ml.html">weakTopological.ml</a></li><li><a href="xDot.ml.html">xDot.ml</a></li><li><a href="xDotDraw.ml.html">xDotDraw.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  Ocamlgraph: a generic graph library for OCaml                         *)</span><span class="EOL">
</span><span class="COMMENT">(*  Copyright (C) 2004-2010                                               *)</span><span class="EOL">
</span><span class="COMMENT">(*  Sylvain Conchon, Jean-Christophe Filliatre and Julien Signoles        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This software is free software; you can redistribute it and/or        *)</span><span class="EOL">
</span><span class="COMMENT">(*  modify it under the terms of the GNU Library General Public           *)</span><span class="EOL">
</span><span class="COMMENT">(*  License version 2.1, with the special exception on linking            *)</span><span class="EOL">
</span><span class="COMMENT">(*  described in file LICENSE.                                            *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*  This software is distributed in the hope that it will be useful,      *)</span><span class="EOL">
</span><span class="COMMENT">(*  but WITHOUT ANY WARRANTY; without even the implied warranty of        *)</span><span class="EOL">
</span><span class="COMMENT">(*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-FLOW"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">FLOW</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-FLOW.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.type-label"><span class="TYPE">type</span> <span class="LIDENT">label</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.val-max_capacity"><span class="VAL">val</span> <span class="LIDENT">max_capacity</span> <span class="COLON">:</span> <span class="LIDENT">label</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.val-flow"><span class="VAL">val</span> <span class="LIDENT">flow</span> <span class="COLON">:</span> <span class="LIDENT">label</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.val-add"><span class="VAL">val</span> <span class="LIDENT">add</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.val-sub"><span class="VAL">val</span> <span class="LIDENT">sub</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.val-zero"><span class="VAL">val</span> <span class="LIDENT">zero</span> <span class="COLON">:</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-FLOW.val-compare"><span class="VAL">val</span> <span class="LIDENT">compare</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-G_GOLDBERG_TARJAN"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">G_GOLDBERG_TARJAN</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.module-V"><span class="MODULE">module</span> <span class="UIDENT">V</span> <span class="COLON">:</span> <span class="UIDENT">Sig</span><span class="DOT">.</span><span class="UIDENT">COMPARABLE</span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.module-E"><span class="MODULE">module</span> <span class="UIDENT">E</span> <span class="COLON">:</span> <span class="UIDENT">Sig</span><span class="DOT">.</span><span class="UIDENT">EDGE</span> <span class="WITH">with</span> <span id="def_221"><span class="TYPE">type</span> <span class="LIDENT">vertex</span> <span class="EQUAL">=</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.val-nb_vertex"><span class="VAL">val</span> <span class="LIDENT">nb_vertex</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.val-nb_edges"><span class="VAL">val</span> <span class="LIDENT">nb_edges</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.val-fold_edges_e"><span class="VAL">val</span> <span class="LIDENT">fold_edges_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.val-fold_succ_e"><span class="VAL">val</span> <span class="LIDENT">fold_succ_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span></span><span class="EOL">
</span>  <span id="module-type-G_GOLDBERG_TARJAN.val-fold_pred_e"><span class="VAL">val</span> <span class="LIDENT">fold_pred_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Goldberg_Tarjan"><span class="MODULE">module</span> <span class="UIDENT">Goldberg_Tarjan</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="COLON">:</span> <span class="UIDENT">G_GOLDBERG_TARJAN</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="COLON">:</span> <span class="UIDENT">FLOW</span> <span class="WITH">with</span> <span id="def_224"><span class="TYPE">type</span> <span class="LIDENT">label</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* This code is a contribution of Guyslain Naves

  Design notes:
   This is an implementation of the classical Goldberg-Tarjan push-relabel
   algorithm to compute maximum flow in directed graphs with upper capacities
   on arcs. Several common optimizations are implemented to make it
   more efficient than the pseudocode found in most textbooks on algorithms.

   About the push-relabel algorithm.
   --------------------------------------

   Instead of keeping a valid flow and improving it by iteration (similar to
   Ford-Fulkerson algorithm and its variants), the push-relabel always keep
   a preflow and try make it becoe a flow. A preflow is a function on arcs that
   violates the flow condition:
     &quot;flow that enters = flow that leaves (in every non-terminal vertex)&quot;
   and replaces it by:
     &quot; flow that enters &gt;= flow that leaves (in every non-source vertex)&quot;
   That means that any vertex may have *excessive* flow entering it.

   The algorithm proceed by making flow going down. Here down is defined
   by a *potential*, an integer attached to every vertex. The excess at some
   vertex can be routed to a successor in the residual graph with lower
   potential. This is a *push* operation on the corresponding arc.

   Pushing along all arcs leaving a vertex is a *discharge* of this vertex.

   If a vertex is excessive, but no successor has lower potential, then we
   increase the potential to make it slightly higher than at least one
   of its successor. This is a *relabel* operation of that vertex.

   The source (potential = n) and sink (potential = 0) may never be relabel.

   The algorithm consists in doing push and relabel steps,
   until no more are possible. Then the preflow is a maximum flow.

   Optimizations.
   --------------

   - The simplest (and less efficient) way to optimize this algorithm is
   to play with the order on which push and relabel operations are performed.
   Here, the strategy used is the following:
   1) sort excessive vertices by decreasing potential
   2) for each vertex in that order:
      a) discharge it
      b) if still in excess, relabel it
   (see [augmenting_step] and [discharge])
   This is a basic strategy that could be improved.

   - Textbook algorithms starts with non-source vertices with potential 0.
   This forces the algorithm to perform a lot of relabel operations to get
   to a more realistic and usable potential function. Here we use as initial
   potential the distance from a vertex to the sink (even for the source).
   (see [initialize_potential])

   - The most important optimization: empirically one can check that the
   push-relabel algorithm converges very quickly toward a preflow that maximizes
   the flow sent to the sink. But then it takes very long to send back the
   excessive flow to the source.  Here we detect every few iterations if the
   preflow is maximal. This is done by a bfs in the reversal of the residual
   graph, by determining whether the source is reachable.
   (see [is_maximum_preflow]).
   Once the preflow is maximum (first pahse), we compute a maximum preflow from
   sink to source in the reversed graph, with maximum capacities given by the
   values of the maximum preflow just computed (second phase). This will
   compute a reversed maximum preflow that must be actually a flow.
   (see [compute_maximum_flow], and the use of [forward_context]
   and [backward_context] for each of the two phases)


   Implementation.
   ---------------

   The most important thing is to understand that we are interested only
   in the residual graph, and not by the original graph. Original arcs
   may appears in one or two directions in the residual graph. This is
   why we manipulate almost only [residual_arc] and no [arc = G.E.t].

   It also implies that the incident arcs of a vertex are not those in
   the original graph. Because we will work with both the residual graph
   and its reversal, and that it depends on the current flow values, we
   define two functions [incidence_residual] and [incidence_reversal].
   Notice that their roles interchanged during the second phase.

   [Forward] and [Backward] only refers to the orientation compared to the
   orientation in the graph. Hence, in a reversed graph, backward residual arcs
   are [Forward], and forward residual arcs are [Backward].

   We define a type [context] containing the current state of computation.
   We hide the data structures in [context] by providing [set] and [get]
   functions. It makes the code more readable, and easier to modify if one
   would like to change the data structures.


   Structure of the code:
   The first part of the code contains mostly helpers, up to the bfs algorithm.
   With the bfs comes the function to compute the initial potential and
   check the maximality of a preflow.
   Then we define the push, relabel, discharge operations, and the functions
   computing maximal preflows.
   Finally we define how to initialize a context, and the max flow algorithm.

   We choose to require by a functor the implementations for the main data
   structures used by the algorithm. VMap and EMap could be replaced by
   arrays for better efficiency, or using vertex and edge labels.
   They are used to record potentials, excesses and flows.
   VSet is used to track vertices that are still in excess. Because
   we sort those vertices, using search trees would not be a problem,
   but an array of size [G.nb_vertex] could degrade the performance.
   The default is a hash table densely filled, hence [sort_by_potential]
   is the asymptotical bottleneck.

   Parameter:
   - [param_freq_check_preflow]: used to parametrized how often one should check
   whether the current preflow is maximum.

  *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-vertex"><span class="TYPE">type</span> <span class="LIDENT">vertex</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-arc"><span class="TYPE">type</span> <span class="LIDENT">arc</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-flow"><span class="TYPE">type</span> <span class="LIDENT">flow</span> <span class="EQUAL">=</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-(|&gt;)"><span class="LPAREN">(</span><span class="INFIXOP0">|&gt;</span><span class="RPAREN">)</span></span> <span id="local_x_1"><span class="LIDENT">x</span></span> <span id="local_f_2"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="#local_f_2"><span class="LIDENT">f</span></a> <a href="#local_x_1"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="OPEN">open</span> <span class="UIDENT">G</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.module-Q"><span class="MODULE">module</span> <span class="UIDENT">Q</span> <span class="EQUAL">=</span> <span class="UIDENT">PersistentQueue</span></span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.module-VH"><span class="MODULE">module</span> <span class="UIDENT">VH</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#module-Make"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="RPAREN">)</span></span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.module-EM"><span class="MODULE">module</span> <span class="UIDENT">EM</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/map.ml.html#module-Make"><span class="UIDENT">Map</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.module-VMap"><span class="MODULE">module</span> <span class="UIDENT">VMap</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Goldberg_Tarjan.module-VMap.type-t"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VMap.val-create"><span class="LIDENT">create</span></span> <span class="EQUAL">=</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">create</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VMap.val-add"><span class="LIDENT">add</span></span> <span id="local_tbl_3"><span class="LIDENT">tbl</span></span> <span id="local_key_4"><span class="LIDENT">key</span></span> <span id="local_value_5"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_tbl_3"><span class="LIDENT">tbl</span></a> <a href="#local_key_4"><span class="LIDENT">key</span></a> <a href="#local_value_5"><span class="LIDENT">value</span></a><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VMap.val-remove"><span class="LIDENT">remove</span></span> <span id="local_tbl_6"><span class="LIDENT">tbl</span></span> <span id="local_key_7"><span class="LIDENT">key</span></span> <span class="EQUAL">=</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_tbl_6"><span class="LIDENT">tbl</span></a> <a href="#local_key_7"><span class="LIDENT">key</span></a><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VMap.val-find"><span class="LIDENT">find</span></span> <span id="local_tbl_8"><span class="LIDENT">tbl</span></span> <span id="local_key_9"><span class="LIDENT">key</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_tbl_8"><span class="LIDENT">tbl</span></a> <a href="#local_key_9"><span class="LIDENT">key</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.module-VSet"><span class="MODULE">module</span> <span class="UIDENT">VSet</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Goldberg_Tarjan.module-VSet.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">unit</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VSet.val-create"><span class="LIDENT">create</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">16</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VSet.val-add"><span class="LIDENT">add</span></span> <span id="local_tbl_10"><span class="LIDENT">tbl</span></span> <span id="local_v_11"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_tbl_10"><span class="LIDENT">tbl</span></a> <a href="#local_v_11"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_tbl_10"><span class="LIDENT">tbl</span></a> <a href="#local_v_11"><span class="LIDENT">v</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-VSet.val-elements"><span class="LIDENT">elements</span></span> <span id="local_tbl_12"><span class="LIDENT">tbl</span></span> <span class="EQUAL">=</span> <span class="UIDENT">VH</span><span class="DOT">.</span><span class="LIDENT">fold</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_v_13"><span class="LIDENT">v</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span id="local_list_14"><span class="LIDENT">list</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_v_13"><span class="LIDENT">v</span></a><span class="COLONCOLON">::</span><a href="#local_list_14"><span class="LIDENT">list</span></a><span class="RPAREN">)</span> <a href="#local_tbl_12"><span class="LIDENT">tbl</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.module-EMap"><span class="MODULE">module</span> <span class="UIDENT">EMap</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Goldberg_Tarjan.module-EMap.type-t"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#type-ref"><span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="UIDENT">EM</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="LIDENT">ref</span></a></span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-EMap.val-create"><span class="LIDENT">create</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">EM</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-EMap.val-add"><span class="LIDENT">add</span></span> <span id="local_map_15"><span class="LIDENT">map</span></span> <span id="local_edge_16"><span class="LIDENT">edge</span></span> <span id="local_value_17"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_map_15"><span class="LIDENT">map</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">EM</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_edge_16"><span class="LIDENT">edge</span></a> <a href="#local_value_17"><span class="LIDENT">value</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_map_15"><span class="LIDENT">map</span></a><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Goldberg_Tarjan.module-EMap.val-find"><span class="LIDENT">find</span></span> <span id="local_map_18"><span class="LIDENT">map</span></span> <span id="local_edge_19"><span class="LIDENT">edge</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">EM</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_edge_19"><span class="LIDENT">edge</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_map_18"><span class="LIDENT">map</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-min_flow"><span class="LIDENT">min_flow</span></span> <span id="local_a_20"><span class="LIDENT">a</span></span> <span id="local_b_21"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <a href="#local_a_20"><span class="LIDENT">a</span></a> <a href="#local_b_21"><span class="LIDENT">b</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_a_20"><span class="LIDENT">a</span></a> <span class="ELSE">else</span> <a href="#local_b_21"><span class="LIDENT">b</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-(+-)"><span class="LPAREN">(</span><span class="INFIXOP2">+-</span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-(--)"><span class="LPAREN">(</span><span class="INFIXOP2">--</span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">sub</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-is_positive"><span class="LIDENT">is_positive</span></span> <span id="local_a_22"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <a href="#local_a_22"><span class="LIDENT">a</span></a> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-max_capacity"><span class="LIDENT">max_capacity</span></span> <span id="local_e_23"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">max_capacity</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_23"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-residual_arc"><span class="TYPE">type</span> <span class="LIDENT">residual_arc</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-residual_arc.constructor-Forward"><span class="BAR">|</span> <span class="UIDENT">Forward</span> <span class="OF">of</span> <span class="LIDENT">arc</span></span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-residual_arc.constructor-Backward"><span class="BAR">|</span> <span class="UIDENT">Backward</span> <span class="OF">of</span> <span class="LIDENT">arc</span></span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* context for computations *)</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.type-context"><span class="TYPE">type</span> <span class="LIDENT">context</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <span id="def_217"><span class="LIDENT">nb_vertices</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_226"><span class="LIDENT">source</span> <span class="COLON">:</span> <span class="LIDENT">vertex</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_227"><span class="LIDENT">sink</span> <span class="COLON">:</span> <span class="LIDENT">vertex</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_234"><span class="LIDENT">reversed</span> <span class="COLON">:</span> <span class="LIDENT">bool</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_232"><span class="LIDENT">incident</span> <span class="COLON">:</span> <span class="LIDENT">context</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">residual_arc</span> <span class="LIDENT">list</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_231"><span class="LIDENT">reverse_incident</span> <span class="COLON">:</span> <span class="LIDENT">context</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">residual_arc</span> <span class="LIDENT">list</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_233"><span class="LIDENT">max_capacity</span> <span class="COLON">:</span> <span class="LIDENT">arc</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_220"><span class="LIDENT">excess</span> <span class="COLON">:</span> <span class="LIDENT">flow</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_219"><span class="LIDENT">potential</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_230"><span class="MUTABLE">mutable</span> <span class="LIDENT">excessives</span> <span class="COLON">:</span> <span class="UIDENT">VSet</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="SEMI">;</span></span><span class="EOL">
</span>      <span id="def_216"><span class="LIDENT">flow</span> <span class="COLON">:</span> <span class="LIDENT">flow</span> <span class="UIDENT">EMap</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-get_excess"><span class="LIDENT">get_excess</span></span> <span id="local_ctxt_24"><span class="LIDENT">ctxt</span></span> <span id="local_vertex_25"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_ctxt_24"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">excess</span> <a href="#local_vertex_25"><span class="LIDENT">vertex</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_value_26"><span class="LIDENT">value</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_value_26"><span class="LIDENT">value</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-get_potential"><span class="LIDENT">get_potential</span></span> <span id="local_ctxt_27"><span class="LIDENT">ctxt</span></span> <span id="local_vertex_28"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_ctxt_27"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">potential</span> <a href="#local_vertex_28"><span class="LIDENT">vertex</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_value_29"><span class="LIDENT">value</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_value_29"><span class="LIDENT">value</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_ctxt_27"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">nb_vertices</span> <span class="COMMENT">(* sink is not reachable from vertex *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-set_excess"><span class="LIDENT">set_excess</span></span> <span id="local_ctxt_30"><span class="LIDENT">ctxt</span></span> <span id="local_vertex_31"><span class="LIDENT">vertex</span></span> <span id="local_value_32"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_ctxt_30"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">excess</span> <a href="#local_vertex_31"><span class="LIDENT">vertex</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_ctxt_30"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">excess</span> <a href="#local_vertex_31"><span class="LIDENT">vertex</span></a> <a href="#local_value_32"><span class="LIDENT">value</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-set_potential"><span class="LIDENT">set_potential</span></span> <span id="local_ctxt_33"><span class="LIDENT">ctxt</span></span> <span id="local_vertex_34"><span class="LIDENT">vertex</span></span> <span id="local_pi_35"><span class="LIDENT">pi</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">remove</span> <a href="#local_ctxt_33"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">potential</span> <a href="#local_vertex_34"><span class="LIDENT">vertex</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_ctxt_33"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">potential</span> <a href="#local_vertex_34"><span class="LIDENT">vertex</span></a> <a href="#local_pi_35"><span class="LIDENT">pi</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-mark_excessive"><span class="LIDENT">mark_excessive</span></span> <span id="local_ctxt_36"><span class="LIDENT">ctxt</span></span> <span id="local_vertex_37"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">VSet</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_ctxt_36"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">excessives</span> <a href="#local_vertex_37"><span class="LIDENT">vertex</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-extract_excessives"><span class="LIDENT">extract_excessives</span></span> <span id="local_ctxt_38"><span class="LIDENT">ctxt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_in_excess_39"><span class="LIDENT">in_excess</span></span> <span class="EQUAL">=</span> <span class="UIDENT">VSet</span><span class="DOT">.</span><span class="LIDENT">elements</span> <a href="#local_ctxt_38"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">excessives</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_ctxt_38"><span class="LIDENT">ctxt</span></a><span class="DOT">.</span><span class="LIDENT">excessives</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">VSet</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_in_excess_39"><span class="LIDENT">in_excess</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-get_flow"><span class="LIDENT">get_flow</span></span> <span id="local_context_40"><span class="LIDENT">context</span></span> <span id="local_arc_41"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">EMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_context_40"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_arc_41"><span class="LIDENT">arc</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_value_42"><span class="LIDENT">value</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_value_42"><span class="LIDENT">value</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-set_flow"><span class="LIDENT">set_flow</span></span> <span id="local_context_43"><span class="LIDENT">context</span></span> <span id="local_arc_44"><span class="LIDENT">arc</span></span> <span id="local_value_45"><span class="LIDENT">value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">EMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_context_43"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_arc_44"><span class="LIDENT">arc</span></a> <a href="#local_value_45"><span class="LIDENT">value</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-get_capacity"><span class="LIDENT">get_capacity</span></span> <span id="local_context_46"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Backward</span> <span id="local_arc_47"><span class="LIDENT">arc</span></span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Forward</span> <span id="local_arc_48"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_context_46"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">max_capacity</span> <a href="#local_arc_48"><span class="LIDENT">arc</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* residual graph helpers *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-origin"><span class="LIDENT">origin</span></span> <span class="COLON">:</span> <span class="LIDENT">residual_arc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Forward</span> <span id="local_arc_49"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_arc_49"><span class="LIDENT">arc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Backward</span> <span id="local_arc_50"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_arc_50"><span class="LIDENT">arc</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-destination"><span class="LIDENT">destination</span></span> <span class="COLON">:</span> <span class="LIDENT">residual_arc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">vertex</span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Forward</span> <span id="local_arc_51"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_arc_51"><span class="LIDENT">arc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Backward</span> <span id="local_arc_52"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_arc_52"><span class="LIDENT">arc</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-forward"><span class="LIDENT">forward</span></span> <span id="local_arc_53"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Forward</span> <a href="#local_arc_53"><span class="LIDENT">arc</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-backward"><span class="LIDENT">backward</span></span> <span id="local_arc_54"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Backward</span> <a href="#local_arc_54"><span class="LIDENT">arc</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-residual_capacity"><span class="LIDENT">residual_capacity</span></span> <span class="COLON">:</span> <span class="LIDENT">context</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">residual_arc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">flow</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_context_55"><span class="LIDENT">context</span></span> <span id="local_residual_arc_56"><span class="LIDENT">residual_arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_context_55"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">reversed</span><span class="COMMA">,</span> <a href="#local_residual_arc_56"><span class="LIDENT">residual_arc</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UIDENT">Forward</span> <span id="local_arc_57"><span class="LIDENT">arc</span></span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UIDENT">Backward</span> <span id="local_arc_58"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">get_flow</span> <a href="#local_context_55"><span class="LIDENT">context</span></a> <a href="#local_arc_58"><span class="LIDENT">arc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Backward</span> <span id="local_arc_59"><span class="LIDENT">arc</span></span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Forward</span> <span id="local_arc_60"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">sub</span> <span class="LPAREN">(</span><a href="#local_context_55"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">max_capacity</span> <a href="#local_arc_60"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">get_flow</span> <a href="#local_context_55"><span class="LIDENT">context</span></a> <a href="#local_arc_60"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-is_forward"><span class="LIDENT">is_forward</span></span> <span id="local_context_61"><span class="LIDENT">context</span></span> <span id="local_arc_62"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">is_positive</span> <span class="LPAREN">(</span><a href="#local_context_61"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">max_capacity</span> <a href="#local_arc_62"><span class="LIDENT">arc</span></a> <span class="INFIXOP2">--</span> <span class="LIDENT">get_flow</span> <a href="#local_context_61"><span class="LIDENT">context</span></a> <a href="#local_arc_62"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-is_backward"><span class="LIDENT">is_backward</span></span> <span id="local_context_63"><span class="LIDENT">context</span></span> <span id="local_arc_64"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">is_positive</span> <span class="LPAREN">(</span><span class="LIDENT">get_flow</span> <a href="#local_context_63"><span class="LIDENT">context</span></a> <a href="#local_arc_64"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-augment"><span class="LIDENT">augment</span></span> <span class="COLON">:</span> <span class="LIDENT">context</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">residual_arc</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_context_65"><span class="LIDENT">context</span></span> <span id="local_residual_arc_66"><span class="LIDENT">residual_arc</span></span> <span id="local_delta_67"><span class="LIDENT">delta</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_context_65"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">reversed</span><span class="COMMA">,</span> <a href="#local_residual_arc_66"><span class="LIDENT">residual_arc</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UIDENT">Backward</span> <span id="local_arc_68"><span class="LIDENT">arc</span></span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UIDENT">Forward</span> <span id="local_arc_69"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">get_flow</span> <a href="#local_context_65"><span class="LIDENT">context</span></a> <a href="#local_arc_69"><span class="LIDENT">arc</span></a> <span class="INFIXOP2">+-</span> <a href="#local_delta_67"><span class="LIDENT">delta</span></a> <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">set_flow</span> <a href="#local_context_65"><span class="LIDENT">context</span></a> <a href="#local_arc_69"><span class="LIDENT">arc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Backward</span> <span id="local_arc_70"><span class="LIDENT">arc</span></span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Forward</span> <span id="local_arc_71"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">get_flow</span> <a href="#local_context_65"><span class="LIDENT">context</span></a> <a href="#local_arc_71"><span class="LIDENT">arc</span></a> <span class="INFIXOP2">--</span> <a href="#local_delta_67"><span class="LIDENT">delta</span></a> <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">set_flow</span> <a href="#local_context_65"><span class="LIDENT">context</span></a> <a href="#local_arc_71"><span class="LIDENT">arc</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-cons"><span class="LIDENT">cons</span></span> <span id="local_e_72"><span class="LIDENT">e</span></span> <span id="local_l_73"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="#local_e_72"><span class="LIDENT">e</span></a><span class="COLONCOLON">::</span><a href="#local_l_73"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* incidence function in the residual graph
     and in the reversal of the residual of the reversed graph *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-incidence_residual"><span class="LIDENT">incidence_residual</span></span> <span id="local_graph_74"><span class="LIDENT">graph</span></span> <span id="local_context_75"><span class="LIDENT">context</span></span> <span id="local_vertex_76"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LIDENT">fold_succ_e</span> <span class="LIDENT">cons</span> <a href="#local_graph_74"><span class="LIDENT">graph</span></a> <a href="#local_vertex_76"><span class="LIDENT">vertex</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_forward</span> <a href="#local_context_75"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">forward</span><span class="EOL">
</span>    <span class="END">end</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(@)"><span class="INFIXOP1">@</span></a> <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LIDENT">fold_pred_e</span> <span class="LIDENT">cons</span> <a href="#local_graph_74"><span class="LIDENT">graph</span></a> <a href="#local_vertex_76"><span class="LIDENT">vertex</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_backward</span> <a href="#local_context_75"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">backward</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* incidence function in the reversal of the residual graph
     and in the residual of the reversed graph *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-incidence_reversal"><span class="LIDENT">incidence_reversal</span></span> <span id="local_graph_77"><span class="LIDENT">graph</span></span> <span id="local_context_78"><span class="LIDENT">context</span></span> <span id="local_vertex_79"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LIDENT">fold_succ_e</span> <span class="LIDENT">cons</span> <a href="#local_graph_77"><span class="LIDENT">graph</span></a> <a href="#local_vertex_79"><span class="LIDENT">vertex</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_backward</span> <a href="#local_context_78"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">forward</span><span class="EOL">
</span>    <span class="END">end</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(@)"><span class="INFIXOP1">@</span></a> <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LIDENT">fold_pred_e</span> <span class="LIDENT">cons</span> <a href="#local_graph_77"><span class="LIDENT">graph</span></a> <a href="#local_vertex_79"><span class="LIDENT">vertex</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_forward</span> <a href="#local_context_78"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LIDENT">backward</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Breadth-first search algorithm, with application of
   * a function on each arc of the BFS tree. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-generic_bfs"><span class="LIDENT">generic_bfs</span></span> <span class="COLON">:</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">residual_arc</span> <span class="LIDENT">list</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">residual_arc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">vertex</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>    <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_nb_vertices_80"><span class="LIDENT">nb_vertices</span></span> <span id="local_incidence_81"><span class="LIDENT">incidence</span></span> <span id="local_iter_fun_82"><span class="LIDENT">iter_fun</span></span> <span id="local_source_83"><span class="LIDENT">source</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_reached_84"><span class="LIDENT">reached</span></span> <span class="EQUAL">=</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_nb_vertices_80"><span class="LIDENT">nb_vertices</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_frontier_85"><span class="LIDENT">frontier</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">Q</span><span class="DOT">.</span><span class="LIDENT">empty</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_add_arc_86"><span class="LIDENT">add_arc</span></span> <span id="local_arc_87"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>	<span class="LET">let</span> <span id="local_dest_88"><span class="LIDENT">dest</span></span> <span class="EQUAL">=</span> <span class="LIDENT">destination</span> <a href="#local_arc_87"><span class="LIDENT">arc</span></a> <span class="IN">in</span><span class="EOL">
</span>	<span class="IF">if</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_reached_84"><span class="LIDENT">reached</span></a> <a href="#local_dest_88"><span class="LIDENT">dest</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">None</span> <span class="THEN">then</span><span class="EOL">
</span>	  <span class="LPAREN">(</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_reached_84"><span class="LIDENT">reached</span></a> <a href="#local_dest_88"><span class="LIDENT">dest</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>	    <a href="#local_iter_fun_82"><span class="LIDENT">iter_fun</span></a> <a href="#local_arc_87"><span class="LIDENT">arc</span></a><span class="SEMI">;</span><span class="EOL">
</span>	    <a href="#local_frontier_85"><span class="LIDENT">frontier</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Q</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_frontier_85"><span class="LIDENT">frontier</span></a> <a href="#local_dest_88"><span class="LIDENT">dest</span></a><span class="EOL">
</span>	  <span class="RPAREN">)</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_explore_89"><span class="LIDENT">explore</span></span> <span id="local_vertex_90"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_add_arc_86"><span class="LIDENT">add_arc</span></a> <span class="LPAREN">(</span><a href="#local_incidence_81"><span class="LIDENT">incidence</span></a> <a href="#local_vertex_90"><span class="LIDENT">vertex</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_reached_84"><span class="LIDENT">reached</span></a> <a href="#local_source_83"><span class="LIDENT">source</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_explore_89"><span class="LIDENT">explore</span></a> <a href="#local_source_83"><span class="LIDENT">source</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Q</span><span class="DOT">.</span><span class="LIDENT">is_empty</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_frontier_85"><span class="LIDENT">frontier</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>	<a href="#local_explore_89"><span class="LIDENT">explore</span></a> <span class="LPAREN">(</span><span class="UIDENT">Q</span><span class="DOT">.</span><span class="LIDENT">head</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_frontier_85"><span class="LIDENT">frontier</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>	<a href="#local_frontier_85"><span class="LIDENT">frontier</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Q</span><span class="DOT">.</span><span class="LIDENT">tail</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_frontier_85"><span class="LIDENT">frontier</span></a><span class="EOL">
</span>      <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* labels the vertices by their distance to the sink.
     This is used to initial the potential of vertices,
     and drastically improve the performance of the algorithm. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-initialize_potential"><span class="LIDENT">initialize_potential</span></span> <span id="local_context_91"><span class="LIDENT">context</span></span> <span id="local_sink_92"><span class="LIDENT">sink</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_update_93"><span class="LIDENT">update</span></span> <span id="local_arc_94"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">get_potential</span> <a href="#local_context_91"><span class="LIDENT">context</span></a> <span class="LPAREN">(</span><span class="LIDENT">origin</span> <a href="#local_arc_94"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">set_potential</span> <a href="#local_context_91"><span class="LIDENT">context</span></a> <span class="LPAREN">(</span><span class="LIDENT">destination</span> <a href="#local_arc_94"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">set_potential</span> <a href="#local_context_91"><span class="LIDENT">context</span></a> <a href="#local_sink_92"><span class="LIDENT">sink</span></a> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">generic_bfs</span><span class="EOL">
</span>      <a href="#local_context_91"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">nb_vertices</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="#local_context_91"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">reverse_incident</span> <a href="#local_context_91"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <a href="#local_update_93"><span class="LIDENT">update</span></a><span class="EOL">
</span>      <a href="#local_sink_92"><span class="LIDENT">sink</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* checks whether a preflow is maximum.
     Happens if no excessive vertex is reverse-reachable from the sink.
  *)</span><span class="EOL">
</span>  <span id="module-Goldberg_Tarjan.exception-Break"><span class="EXCEPTION">exception</span> <span class="UIDENT">Break</span></span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-is_maximum_preflow"><span class="LIDENT">is_maximum_preflow</span></span> <span id="local_context_95"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_check_arc_96"><span class="LIDENT">check_arc</span></span> <span id="local_arc_97"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <span class="LPAREN">(</span><span class="LIDENT">get_excess</span> <a href="#local_context_95"><span class="LIDENT">context</span></a> <span class="LPAREN">(</span><span class="LIDENT">destination</span> <a href="#local_arc_97"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>	<a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Break</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="LIDENT">generic_bfs</span><span class="EOL">
</span>	<a href="#local_context_95"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">nb_vertices</span><span class="EOL">
</span>	<span class="LPAREN">(</span><a href="#local_context_95"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">reverse_incident</span> <a href="#local_context_95"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>	<a href="#local_check_arc_96"><span class="LIDENT">check_arc</span></a><span class="EOL">
</span>	<a href="#local_context_95"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">sink</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="TRUE">true</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Push-relabel operations *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* push excessive flow along an residual arc *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-push"><span class="LIDENT">push</span></span> <span id="local_context_98"><span class="LIDENT">context</span></span> <span id="local_arc_99"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_225"><span class="LPAREN">(</span><span id="local_u_100"><span class="LIDENT">u</span></span><span class="COMMA">,</span><span id="local_v_101"><span class="LIDENT">v</span></span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">origin</span> <a href="#local_arc_99"><span class="LIDENT">arc</span></a><span class="COMMA">,</span> <span class="LIDENT">destination</span> <a href="#local_arc_99"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_exc_u_102"><span class="LIDENT">exc_u</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_excess</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_u_100"><span class="LIDENT">u</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">is_positive</span> <a href="#local_exc_u_102"><span class="LIDENT">exc_u</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="BEGIN">begin</span><span class="EOL">
</span>	<span class="LET">let</span> <span id="local_delta_103"><span class="LIDENT">delta</span></span> <span class="EQUAL">=</span> <span class="LIDENT">min_flow</span> <a href="#local_exc_u_102"><span class="LIDENT">exc_u</span></a> <span class="LPAREN">(</span><span class="LIDENT">residual_capacity</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_arc_99"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>	<a href="#local_exc_u_102"><span class="LIDENT">exc_u</span></a> <span class="INFIXOP2">--</span> <a href="#local_delta_103"><span class="LIDENT">delta</span></a> <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">set_excess</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_u_100"><span class="LIDENT">u</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">get_excess</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_v_101"><span class="LIDENT">v</span></a> <span class="INFIXOP2">+-</span> <a href="#local_delta_103"><span class="LIDENT">delta</span></a> <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">set_excess</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_v_101"><span class="LIDENT">v</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">augment</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_arc_99"><span class="LIDENT">arc</span></a> <a href="#local_delta_103"><span class="LIDENT">delta</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">mark_excessive</span> <a href="#local_context_98"><span class="LIDENT">context</span></a> <a href="#local_v_101"><span class="LIDENT">v</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Augment potential of a vertex to get a lower-potential successor *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-relabel"><span class="LIDENT">relabel</span></span> <span id="local_context_104"><span class="LIDENT">context</span></span> <span id="local_vertex_105"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_context_104"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">incident</span> <a href="#local_context_104"><span class="LIDENT">context</span></a> <a href="#local_vertex_105"><span class="LIDENT">vertex</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_arc_106"><span class="LIDENT">arc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">get_potential</span> <a href="#local_context_104"><span class="LIDENT">context</span></a> <span class="LPAREN">(</span><span class="LIDENT">destination</span> <a href="#local_arc_106"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-min"><span class="LIDENT">min</span></a> <span class="LPAREN">(</span><span class="LIDENT">get_potential</span> <a href="#local_context_104"><span class="LIDENT">context</span></a> <a href="#local_vertex_105"><span class="LIDENT">vertex</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <span class="FUN">fun</span> <span id="local_pi_107"><span class="LIDENT">pi</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">set_potential</span> <a href="#local_context_104"><span class="LIDENT">context</span></a> <a href="#local_vertex_105"><span class="LIDENT">vertex</span></a> <span class="LPAREN">(</span><a href="#local_pi_107"><span class="LIDENT">pi</span></a><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* push can be done only on arc with difference of potential = -1 *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-is_admissible"><span class="LIDENT">is_admissible</span></span> <span id="local_context_108"><span class="LIDENT">context</span></span> <span id="local_arc_109"><span class="LIDENT">arc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_218"><span class="LPAREN">(</span><span id="local_u_110"><span class="LIDENT">u</span></span><span class="COMMA">,</span><span id="local_v_111"><span class="LIDENT">v</span></span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LIDENT">origin</span> <a href="#local_arc_109"><span class="LIDENT">arc</span></a><span class="COMMA">,</span> <span class="LIDENT">destination</span> <a href="#local_arc_109"><span class="LIDENT">arc</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">get_potential</span> <a href="#local_context_108"><span class="LIDENT">context</span></a> <a href="#local_v_111"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">get_potential</span> <a href="#local_context_108"><span class="LIDENT">context</span></a> <a href="#local_u_110"><span class="LIDENT">u</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="MINUS">-</span><span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* push as much flow from a vertex as allowed. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-discharge"><span class="LIDENT">discharge</span></span> <span id="local_context_112"><span class="LIDENT">context</span></span> <span id="local_vertex_113"><span class="LIDENT">vertex</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_context_112"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">incident</span> <a href="#local_context_112"><span class="LIDENT">context</span></a> <a href="#local_vertex_113"><span class="LIDENT">vertex</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_admissible</span> <a href="#local_context_112"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">push</span> <a href="#local_context_112"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="LIDENT">is_positive</span> <span class="LPAREN">(</span><span class="LIDENT">get_excess</span> <a href="#local_context_112"><span class="LIDENT">context</span></a> <a href="#local_vertex_113"><span class="LIDENT">vertex</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>	<span class="BEGIN">begin</span><span class="EOL">
</span>	  <span class="LIDENT">relabel</span> <a href="#local_context_112"><span class="LIDENT">context</span></a> <a href="#local_vertex_113"><span class="LIDENT">vertex</span></a><span class="SEMI">;</span><span class="EOL">
</span>	  <span class="LIDENT">mark_excessive</span> <a href="#local_context_112"><span class="LIDENT">context</span></a> <a href="#local_vertex_113"><span class="LIDENT">vertex</span></a><span class="EOL">
</span>	<span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Optimization: push vertices ordered by their potential.
     (better strategies may be possible). *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-compare_potential"><span class="LIDENT">compare_potential</span></span> <span id="local_context_114"><span class="LIDENT">context</span></span> <span id="local_u_115"><span class="LIDENT">u</span></span> <span id="local_v_116"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">get_potential</span> <a href="#local_context_114"><span class="LIDENT">context</span></a> <a href="#local_v_116"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">get_potential</span> <a href="#local_context_114"><span class="LIDENT">context</span></a> <a href="#local_u_115"><span class="LIDENT">u</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-sort_by_potential"><span class="LIDENT">sort_by_potential</span></span> <span id="local_context_117"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-sort"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">sort</span></a> <span class="LPAREN">(</span><span class="LIDENT">compare_potential</span> <a href="#local_context_117"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-is_dischargeable"><span class="LIDENT">is_dischargeable</span></span> <span id="local_context_118"><span class="LIDENT">context</span></span> <span id="local_v_119"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_v_119"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_context_118"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">source</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_v_119"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_context_118"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">sink</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">is_positive</span> <span class="LPAREN">(</span><span class="LIDENT">get_excess</span> <a href="#local_context_118"><span class="LIDENT">context</span></a> <a href="#local_v_119"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-augmenting_step"><span class="LIDENT">augmenting_step</span></span> <span id="local_context_120"><span class="LIDENT">context</span></span> <span id="local_currently_in_excess_121"><span class="LIDENT">currently_in_excess</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_context_120"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">excessives</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">VSet</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_currently_in_excess_121"><span class="LIDENT">currently_in_excess</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-filter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">filter</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_dischargeable</span> <a href="#local_context_120"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">sort_by_potential</span> <a href="#local_context_120"><span class="LIDENT">context</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">discharge</span> <a href="#local_context_120"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-param_freq_check_preflow"><span class="LIDENT">param_freq_check_preflow</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">1000</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-compute_max_preflow"><span class="LIDENT">compute_max_preflow</span></span> <span id="local_context_122"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nb_steps_123"><span class="LIDENT">nb_steps</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_in_excess_124"><span class="LIDENT">in_excess</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">extract_excessives</span> <a href="#local_context_122"><span class="LIDENT">context</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_check_freq_125"><span class="LIDENT">check_freq</span></span> <span class="EQUAL">=</span> <a href="#local_context_122"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">nb_vertices</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">param_freq_check_preflow</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_is_maximum_126"><span class="LIDENT">is_maximum</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LPAREN">(</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_excess_124"><span class="LIDENT">in_excess</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RPAREN">)</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LPAREN">(</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_nb_steps_123"><span class="LIDENT">nb_steps</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <a href="#local_check_freq_125"><span class="LIDENT">check_freq</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">is_maximum_preflow</span> <a href="#local_context_122"><span class="LIDENT">context</span></a> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="WHILE">while</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_is_maximum_126"><span class="LIDENT">is_maximum</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LIDENT">augmenting_step</span> <a href="#local_context_122"><span class="LIDENT">context</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_in_excess_124"><span class="LIDENT">in_excess</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_in_excess_124"><span class="LIDENT">in_excess</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">extract_excessives</span> <a href="#local_context_122"><span class="LIDENT">context</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_nb_steps_123"><span class="LIDENT">nb_steps</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Maximally push each arc leaving the source,
     set the potential of any vertex at distance to sink (optimization). *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-init_context"><span class="LIDENT">init_context</span></span> <span id="local_context_127"><span class="LIDENT">context</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_out_source_128"><span class="LIDENT">out_source</span></span> <span class="EQUAL">=</span> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">incident</span> <a href="#local_context_127"><span class="LIDENT">context</span></a> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">source</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">initialize_potential</span> <a href="#local_context_127"><span class="LIDENT">context</span></a> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">sink</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">set_potential</span> <a href="#local_context_127"><span class="LIDENT">context</span></a> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">source</span> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">nb_vertices</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_out_source_128"><span class="LIDENT">out_source</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="LIDENT">get_capacity</span> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <span class="LIDENT">set_excess</span> <a href="#local_context_127"><span class="LIDENT">context</span></a> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="DOT">.</span><span class="LIDENT">source</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_out_source_128"><span class="LIDENT">out_source</span></a><span class="EOL">
</span>    <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">push</span> <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>   <a href="#local_context_127"><span class="LIDENT">context</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-new_context"><span class="LIDENT">new_context</span></span> <span id="local_graph_129"><span class="LIDENT">graph</span></span> <span class="TILDE">~</span><span id="local_source_130"><span class="LIDENT">source</span></span> <span class="TILDE">~</span><span id="local_sink_131"><span class="LIDENT">sink</span></span> <span class="TILDE">~</span><span id="local_reversed_132"><span class="LIDENT">reversed</span></span> <span class="TILDE">~</span><span id="local_max_capacity_133"><span class="LIDENT">max_capacity</span></span> <span class="TILDE">~</span><span id="local_flow_134"><span class="LIDENT">flow</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nb_vertices_135"><span class="LIDENT">nb_vertices</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">nb_vertex</span> <a href="#local_graph_129"><span class="LIDENT">graph</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">init_context</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <a href="#local_nb_vertices_135"><span class="LIDENT">nb_vertices</span></a><span class="SEMI">;</span> <a href="#local_source_130"><span class="LIDENT">source</span></a><span class="SEMI">;</span> <a href="#local_sink_131"><span class="LIDENT">sink</span></a><span class="SEMI">;</span> <a href="#local_reversed_132"><span class="LIDENT">reversed</span></a><span class="SEMI">;</span> <a href="#local_max_capacity_133"><span class="LIDENT">max_capacity</span></a><span class="SEMI">;</span> <a href="#local_flow_134"><span class="LIDENT">flow</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">incident</span> <span class="EQUAL">=</span><span class="EOL">
</span>	  <span class="IF">if</span> <a href="#local_reversed_132"><span class="LIDENT">reversed</span></a> <span class="THEN">then</span> <span class="LIDENT">incidence_reversal</span> <a href="#local_graph_129"><span class="LIDENT">graph</span></a><span class="EOL">
</span>	  <span class="ELSE">else</span> <span class="LIDENT">incidence_residual</span> <a href="#local_graph_129"><span class="LIDENT">graph</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">reverse_incident</span> <span class="EQUAL">=</span><span class="EOL">
</span>	  <span class="IF">if</span> <a href="#local_reversed_132"><span class="LIDENT">reversed</span></a> <span class="THEN">then</span> <span class="LIDENT">incidence_residual</span> <a href="#local_graph_129"><span class="LIDENT">graph</span></a><span class="EOL">
</span>	  <span class="ELSE">else</span> <span class="LIDENT">incidence_reversal</span> <a href="#local_graph_129"><span class="LIDENT">graph</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">excess</span> <span class="EQUAL">=</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_nb_vertices_135"><span class="LIDENT">nb_vertices</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">potential</span> <span class="EQUAL">=</span> <span class="UIDENT">VMap</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_nb_vertices_135"><span class="LIDENT">nb_vertices</span></a><span class="SEMI">;</span><span class="EOL">
</span>	<span class="LIDENT">excessives</span> <span class="EQUAL">=</span> <span class="UIDENT">VSet</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Goldberg_Tarjan.val-maxflow"><span class="LIDENT">maxflow</span></span> <span id="local_graph_136"><span class="LIDENT">graph</span></span> <span id="local_source_137"><span class="LIDENT">source</span></span> <span id="local_sink_138"><span class="LIDENT">sink</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_init_flow_139"><span class="LIDENT">init_flow</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_flow_140"><span class="LIDENT">flow</span></span> <span class="EQUAL">=</span> <span class="UIDENT">EMap</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">nb_edges</span> <a href="#local_graph_136"><span class="LIDENT">graph</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">fold_edges_e</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_141"><span class="LIDENT">e</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">EMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_flow_140"><span class="LIDENT">flow</span></a> <a href="#local_e_141"><span class="LIDENT">e</span></a> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="RPAREN">)</span> <a href="#local_graph_136"><span class="LIDENT">graph</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_flow_140"><span class="LIDENT">flow</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_forward_context_142"><span class="LIDENT">forward_context</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">new_context</span> <a href="#local_graph_136"><span class="LIDENT">graph</span></a> <span class="TILDE">~</span><a href="#local_source_137"><span class="LIDENT">source</span></a> <span class="TILDE">~</span><a href="#local_sink_138"><span class="LIDENT">sink</span></a><span class="EOL">
</span>	<span class="LABEL">~reversed:</span><span class="FALSE">false</span><span class="EOL">
</span>	<span class="TILDE">~</span><span class="LIDENT">max_capacity</span><span class="EOL">
</span>	<span class="LABEL">~flow:</span><span class="LPAREN">(</span><a href="#local_init_flow_139"><span class="LIDENT">init_flow</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">compute_max_preflow</span> <a href="#local_forward_context_142"><span class="LIDENT">forward_context</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_backward_context_143"><span class="LIDENT">backward_context</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">new_context</span> <a href="#local_graph_136"><span class="LIDENT">graph</span></a><span class="EOL">
</span>	<span class="LABEL">~source:</span><a href="#local_sink_138"><span class="LIDENT">sink</span></a><span class="EOL">
</span>	<span class="LABEL">~sink:</span><a href="#local_source_137"><span class="LIDENT">source</span></a><span class="EOL">
</span>	<span class="LABEL">~reversed:</span><span class="TRUE">true</span><span class="EOL">
</span>	<span class="LABEL">~max_capacity:</span><span class="LPAREN">(</span><span class="LIDENT">get_flow</span> <a href="#local_forward_context_142"><span class="LIDENT">forward_context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>	<span class="LABEL">~flow:</span><span class="LPAREN">(</span><a href="#local_init_flow_139"><span class="LIDENT">init_flow</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">compute_max_preflow</span> <a href="#local_backward_context_143"><span class="LIDENT">backward_context</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_max_flow_value_144"><span class="LIDENT">max_flow_value</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">fold_succ_e</span> <span class="LIDENT">cons</span> <a href="#local_graph_136"><span class="LIDENT">graph</span></a> <a href="#local_source_137"><span class="LIDENT">source</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span></a> <span class="LPAREN">(</span><span class="LIDENT">get_flow</span> <a href="#local_backward_context_143"><span class="LIDENT">backward_context</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="INFIXOP0">|&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_f_145"><span class="LIDENT">f</span></span> <span id="local_e_146"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">EMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_backward_context_143"><span class="LIDENT">backward_context</span></a><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_e_146"><span class="LIDENT">e</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_147"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_147"><span class="LIDENT">x</span></a> <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_f_145"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#local_max_flow_value_144"><span class="LIDENT">max_flow_value</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*****************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-G_FORD_FULKERSON"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">G_FORD_FULKERSON</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-G_FORD_FULKERSON.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-type-G_FORD_FULKERSON.module-V"><span class="MODULE">module</span> <span class="UIDENT">V</span> <span class="COLON">:</span> <span class="UIDENT">Sig</span><span class="DOT">.</span><span class="UIDENT">HASHABLE</span></span><span class="EOL">
</span>  <span id="module-type-G_FORD_FULKERSON.module-E"><span class="MODULE">module</span> <span class="UIDENT">E</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>    <span id="module-type-G_FORD_FULKERSON.module-E.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>    <span id="module-type-G_FORD_FULKERSON.module-E.type-label"><span class="TYPE">type</span> <span class="LIDENT">label</span></span><span class="EOL">
</span>    <span id="module-type-G_FORD_FULKERSON.module-E.val-src"><span class="VAL">val</span> <span class="LIDENT">src</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>    <span id="module-type-G_FORD_FULKERSON.module-E.val-dst"><span class="VAL">val</span> <span class="LIDENT">dst</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>    <span id="module-type-G_FORD_FULKERSON.module-E.val-label"><span class="VAL">val</span> <span class="LIDENT">label</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">label</span></span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span>  <span id="module-type-G_FORD_FULKERSON.val-iter_succ_e"><span class="VAL">val</span> <span class="LIDENT">iter_succ_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span id="module-type-G_FORD_FULKERSON.val-iter_pred_e"><span class="VAL">val</span> <span class="LIDENT">iter_pred_e</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-FLOWMIN"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">FLOWMIN</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span class="INCLUDE">include</span> <span class="UIDENT">FLOW</span><span class="EOL">
</span>  <span id="module-type-FLOWMIN.val-min_capacity"><span class="VAL">val</span> <span class="LIDENT">min_capacity</span> <span class="COLON">:</span> <span class="LIDENT">label</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Ford_Fulkerson"><span class="MODULE">module</span> <span class="UIDENT">Ford_Fulkerson</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="COLON">:</span> <span class="UIDENT">G_FORD_FULKERSON</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="COLON">:</span> <span class="UIDENT">FLOWMIN</span> <span class="WITH">with</span> <span id="def_229"><span class="TYPE">type</span> <span class="LIDENT">label</span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* redefinition of F *)</span><span class="EOL">
</span>  <span id="module-Ford_Fulkerson.module-F"><span class="MODULE">module</span> <span class="UIDENT">F</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="INCLUDE">include</span> <span class="UIDENT">F</span><span class="EOL">
</span><span class="EOL">
</span>    <span id="module-Ford_Fulkerson.module-F.type-u"><span class="TYPE">type</span> <span class="LIDENT">u</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span id="module-Ford_Fulkerson.module-F.type-u.constructor-Flow"><span class="BAR">|</span> <span class="UIDENT">Flow</span> <span class="OF">of</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>      <span id="module-Ford_Fulkerson.module-F.type-u.constructor-Infinity"><span class="BAR">|</span> <span class="UIDENT">Infinity</span></span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-F.val-min"><span class="LIDENT">min</span></span> <span id="local_x_148"><span class="LIDENT">x</span></span> <span id="local_y_149"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_x_148"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_y_149"><span class="LIDENT">y</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Flow</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Infinity</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_148"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Flow</span> <span id="local_fx_150"><span class="LIDENT">fx</span></span><span class="COMMA">,</span> <span class="UIDENT">Flow</span> <span id="local_fy_151"><span class="LIDENT">fy</span></span> <span class="WHEN">when</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <a href="#local_fx_150"><span class="LIDENT">fx</span></a> <a href="#local_fy_151"><span class="LIDENT">fy</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_148"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LPAREN">(</span><span class="UIDENT">Infinity</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="LPAREN">(</span><span class="UIDENT">Flow</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Flow</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_y_149"><span class="LIDENT">y</span></a><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Ford_Fulkerson.module-Mark"><span class="MODULE">module</span> <span class="UIDENT">Mark</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Ford_Fulkerson.module-Mark.module-H"><span class="MODULE">module</span> <span class="UIDENT">H</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#module-Make"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="RPAREN">)</span></span><span class="EOL">
</span>    <span id="module-Ford_Fulkerson.module-Mark.type-mark"><span class="TYPE">type</span> <span class="LIDENT">mark</span> <span class="EQUAL">=</span> <span id="module-Ford_Fulkerson.module-Mark.type-mark.constructor-Plus"><span class="UIDENT">Plus</span></span> <span id="module-Ford_Fulkerson.module-Mark.type-mark.constructor-Minus"><span class="BAR">|</span> <span class="UIDENT">Minus</span></span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-marked"><span class="LIDENT">marked</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">97</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-unvisited"><span class="LIDENT">unvisited</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/queue.ml.html#val-create"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-clear"><span class="LIDENT">clear</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">clear</span> <span class="LIDENT">marked</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-mem"><span class="LIDENT">mem</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">mem</span> <span class="LIDENT">marked</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-set"><span class="LIDENT">set</span></span> <span id="local_s_152"><span class="LIDENT">s</span></span> <span id="local_e_153"><span class="LIDENT">e</span></span> <span id="local_tag_154"><span class="LIDENT">tag</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">mem</span> <a href="#local_s_152"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LIDENT">marked</span> <a href="#local_s_152"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><a href="#local_e_153"><span class="LIDENT">e</span></a><span class="COMMA">,</span> <a href="#local_tag_154"><span class="LIDENT">tag</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/queue.ml.html#val-add"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_s_152"><span class="LIDENT">s</span></a> <span class="LIDENT">unvisited</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-get"><span class="LIDENT">get</span></span> <span id="local_s_155"><span class="LIDENT">s</span></span> <span class="COLON">:</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="LIDENT">mark</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_215"><span id="local_e_156"><span class="LIDENT">e</span></span><span class="COMMA">,</span> <span id="local_tag_157"><span class="LIDENT">tag</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LIDENT">marked</span> <a href="#local_s_155"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_e_156"><span class="LIDENT">e</span></a> <span class="WITH">with</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_e_158"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_e_158"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_tag_157"><span class="LIDENT">tag</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Mark.val-next"><span class="LIDENT">next</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/queue.ml.html#val-pop"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">pop</span></a> <span class="LIDENT">unvisited</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Ford_Fulkerson.module-Result"><span class="MODULE">module</span> <span class="UIDENT">Result</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Ford_Fulkerson.module-Result.module-H"><span class="MODULE">module</span> <span class="UIDENT">H</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#module-Make"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="UIDENT">Make</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>          <span class="OPEN">open</span> <span class="UIDENT">G</span><span class="EOL">
</span>          <span id="def_228"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">t</span></span><span class="EOL">
</span>          <span id="local_U_159"><span class="MODULE">module</span> <span class="UIDENT">U</span> <span class="EQUAL">=</span> <a href="util.ml.html#module-HTProduct"><span class="UIDENT">Util</span><span class="DOT">.</span><span class="UIDENT">HTProduct</span></a><span class="LPAREN">(</span><span class="UIDENT">V</span><span class="RPAREN">)</span><span class="LPAREN">(</span><span class="UIDENT">V</span><span class="RPAREN">)</span></span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_equal_160"><span class="LIDENT">equal</span></span> <span id="local_e1_161"><span class="LIDENT">e1</span></span> <span id="local_e2_162"><span class="LIDENT">e2</span></span> <span class="EQUAL">=</span> <span class="UIDENT">U</span><span class="DOT">.</span><span class="LIDENT">equal</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e1_161"><span class="LIDENT">e1</span></a><span class="COMMA">,</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e1_161"><span class="LIDENT">e1</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e2_162"><span class="LIDENT">e2</span></a><span class="COMMA">,</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e2_162"><span class="LIDENT">e2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_hash_163"><span class="LIDENT">hash</span></span> <span id="local_e_164"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <span class="UIDENT">U</span><span class="DOT">.</span><span class="LIDENT">hash</span> <span class="LPAREN">(</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_164"><span class="LIDENT">e</span></a><span class="COMMA">,</span> <span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_164"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Result.val-create"><span class="LIDENT">create</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">97</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Result.val-find"><span class="LIDENT">find</span></span> <span class="EQUAL">=</span> <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">find</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Result.val-flow"><span class="LIDENT">flow</span></span> <span id="local_r_165"><span class="LIDENT">r</span></span> <span id="local_e_166"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LIDENT">find</span> <a href="#local_r_165"><span class="LIDENT">r</span></a> <a href="#local_e_166"><span class="LIDENT">e</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_f_167"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">flow</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_166"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_r_165"><span class="LIDENT">r</span></a> <a href="#local_e_166"><span class="LIDENT">e</span></a> <a href="#local_f_167"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_f_167"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Result.val-change"><span class="LIDENT">change</span></span> <span id="local_op_168"><span class="LIDENT">op</span></span> <span id="local_r_169"><span class="LIDENT">r</span></span> <span id="local_e_170"><span class="LIDENT">e</span></span> <span id="local_f_171"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="UIDENT">H</span><span class="DOT">.</span><span class="LIDENT">replace</span> <a href="#local_r_169"><span class="LIDENT">r</span></a> <a href="#local_e_170"><span class="LIDENT">e</span></a> <span class="LPAREN">(</span><a href="#local_op_168"><span class="LIDENT">op</span></a> <span class="LPAREN">(</span><span class="LIDENT">find</span> <a href="#local_r_169"><span class="LIDENT">r</span></a> <a href="#local_e_170"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="#local_f_171"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Result.val-grow"><span class="LIDENT">grow</span></span> <span class="EQUAL">=</span> <span class="LIDENT">change</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Ford_Fulkerson.module-Result.val-reduce"><span class="LIDENT">reduce</span></span> <span class="EQUAL">=</span> <span class="LIDENT">change</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">sub</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Ford_Fulkerson.val-is_full"><span class="LIDENT">is_full</span></span> <span id="local_r_172"><span class="LIDENT">r</span></span> <span id="local_e_173"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">max_capacity</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_173"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_r_172"><span class="LIDENT">r</span></a> <a href="#local_e_173"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Ford_Fulkerson.val-is_empty"><span class="LIDENT">is_empty</span></span> <span id="local_r_174"><span class="LIDENT">r</span></span> <span id="local_e_175"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">min_capacity</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_175"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_r_174"><span class="LIDENT">r</span></a> <a href="#local_e_175"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Ford_Fulkerson.val-set_flow"><span class="LIDENT">set_flow</span></span> <span id="local_r_176"><span class="LIDENT">r</span></span> <span id="local_s_177"><span class="LIDENT">s</span></span> <span id="local_t_178"><span class="LIDENT">t</span></span> <span id="local_a_179"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_180"><span class="LIDENT">loop</span></span> <span id="local_t_181"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="#local_t_181"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_223"><span id="local_e_182"><span class="LIDENT">e</span></span><span class="COMMA">,</span> <span id="local_tag_183"><span class="LIDENT">tag</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_t_181"><span class="LIDENT">t</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_tag_183"><span class="LIDENT">tag</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Plus</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">grow</span> <a href="#local_r_176"><span class="LIDENT">r</span></a> <a href="#local_e_182"><span class="LIDENT">e</span></a> <a href="#local_a_179"><span class="LIDENT">a</span></a><span class="SEMI">;</span> <a href="#local_loop_180"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_182"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Minus</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">reduce</span> <a href="#local_r_176"><span class="LIDENT">r</span></a> <a href="#local_e_182"><span class="LIDENT">e</span></a> <a href="#local_a_179"><span class="LIDENT">a</span></a><span class="SEMI">;</span> <a href="#local_loop_180"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_182"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_loop_180"><span class="LIDENT">loop</span></a> <a href="#local_t_178"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Ford_Fulkerson.val-grow_flow"><span class="LIDENT">grow_flow</span></span> <span id="local_r_184"><span class="LIDENT">r</span></span> <span id="local_s_185"><span class="LIDENT">s</span></span> <span id="local_t_186"><span class="LIDENT">t</span></span> <span id="local_a_187"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_188"><span class="LIDENT">loop</span></span> <span id="local_u_189"><span class="LIDENT">u</span></span> <span id="local_b_190"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_s_185"><span class="LIDENT">s</span></a> <a href="#local_u_189"><span class="LIDENT">u</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_b_190"><span class="LIDENT">b</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="UIDENT">Infinity</span> <span class="MINUSGREATER">-&gt;</span> <span class="COMMENT">(* source = destination *)</span><span class="EOL">
</span>          <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_s_185"><span class="LIDENT">s</span></a> <a href="#local_t_186"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_a_187"><span class="LIDENT">a</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="UIDENT">Flow</span> <span id="local_f_191"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">set_flow</span> <a href="#local_r_184"><span class="LIDENT">r</span></a> <a href="#local_s_185"><span class="LIDENT">s</span></a> <a href="#local_t_186"><span class="LIDENT">t</span></a> <a href="#local_f_191"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_a_187"><span class="LIDENT">a</span></a> <a href="#local_f_191"><span class="LIDENT">f</span></a><span class="EOL">
</span>      <span class="END">end</span> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_222"><span id="local_e_192"><span class="LIDENT">e</span></span><span class="COMMA">,</span> <span id="local_tag_193"><span class="LIDENT">tag</span></span></span> <span class="EQUAL">=</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_u_189"><span class="LIDENT">u</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_l_194"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_192"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_tag_193"><span class="LIDENT">tag</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Plus</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="#local_loop_188"><span class="LIDENT">loop</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_192"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">min</span> <a href="#local_b_190"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="UIDENT">Flow</span> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">sub</span> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">max_capacity</span> <a href="#local_l_194"><span class="LIDENT">l</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_r_184"><span class="LIDENT">r</span></a> <a href="#local_e_192"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Minus</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="#local_loop_188"><span class="LIDENT">loop</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_192"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">min</span> <a href="#local_b_190"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="UIDENT">Flow</span> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">sub</span> <span class="LPAREN">(</span><span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">flow</span> <a href="#local_r_184"><span class="LIDENT">r</span></a> <a href="#local_e_192"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">min_capacity</span> <a href="#local_l_194"><span class="LIDENT">l</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_loop_188"><span class="LIDENT">loop</span></a> <a href="#local_t_186"><span class="LIDENT">t</span></a> <span class="UIDENT">F</span><span class="DOT">.</span><span class="UIDENT">Infinity</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Ford_Fulkerson.val-maxflow"><span class="LIDENT">maxflow</span></span> <span id="local_g_195"><span class="LIDENT">g</span></span> <span id="local_s_196"><span class="LIDENT">s</span></span> <span id="local_t_197"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_198"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_succ_199"><span class="LIDENT">succ</span></span> <span id="local_s_200"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_succ_e</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_201"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_s_200"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_201"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>           <span class="LET">let</span> <span id="local_t_202"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_201"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_t_202"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">is_full</span> <a href="#local_r_198"><span class="LIDENT">r</span></a> <a href="#local_e_201"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>             <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">set</span> <a href="#local_t_202"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_e_201"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Plus</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_g_195"><span class="LIDENT">g</span></a> <a href="#local_s_200"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pred_203"><span class="LIDENT">pred</span></span> <span id="local_s_204"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">G</span><span class="DOT">.</span><span class="LIDENT">iter_pred_e</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_205"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="ASSERT">assert</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">V</span><span class="DOT">.</span><span class="LIDENT">equal</span> <a href="#local_s_204"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">dst</span> <a href="#local_e_205"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>           <span class="LET">let</span> <span id="local_t_206"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span> <span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">src</span> <a href="#local_e_205"><span class="LIDENT">e</span></a> <span class="IN">in</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_t_206"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">is_empty</span> <a href="#local_r_198"><span class="LIDENT">r</span></a> <a href="#local_e_205"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>             <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">set</span> <a href="#local_t_206"><span class="LIDENT">t</span></a> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_e_205"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Minus</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_g_195"><span class="LIDENT">g</span></a> <a href="#local_s_204"><span class="LIDENT">s</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_internal_loop_207"><span class="LIDENT">internal_loop</span></span> <span id="local_a_208"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="WHILE">while</span> <span class="TRUE">true</span> <span class="DO">do</span> <span class="LET">let</span> <span id="local_s_209"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">next</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span> <a href="#local_succ_199"><span class="LIDENT">succ</span></a> <a href="#local_s_209"><span class="LIDENT">s</span></a><span class="SEMI">;</span> <a href="#local_pred_203"><span class="LIDENT">pred</span></a> <a href="#local_s_209"><span class="LIDENT">s</span></a> <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_t_197"><span class="LIDENT">t</span></a> <span class="THEN">then</span> <span class="LIDENT">grow_flow</span> <a href="#local_r_198"><span class="LIDENT">r</span></a> <a href="#local_s_196"><span class="LIDENT">s</span></a> <a href="#local_t_197"><span class="LIDENT">t</span></a> <a href="#local_a_208"><span class="LIDENT">a</span></a> <span class="ELSE">else</span> <a href="#local_a_208"><span class="LIDENT">a</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_external_loop_210"><span class="LIDENT">external_loop</span></span> <span id="local_a_211"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">clear</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="LIDENT">set</span> <a href="#local_s_196"><span class="LIDENT">s</span></a> <span class="UIDENT">None</span> <span class="UIDENT">Mark</span><span class="DOT">.</span><span class="UIDENT">Plus</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_a'_212"><span class="LIDENT">a'</span></span> <span class="EQUAL">=</span> <a href="#local_internal_loop_207"><span class="LIDENT">internal_loop</span></a> <a href="#local_a_211"><span class="LIDENT">a</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">compare</span> <a href="#local_a_211"><span class="LIDENT">a</span></a> <a href="#local_a'_212"><span class="LIDENT">a'</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_a_211"><span class="LIDENT">a</span></a> <span class="ELSE">else</span> <a href="#local_external_loop_210"><span class="LIDENT">external_loop</span></a> <a href="#local_a'_212"><span class="LIDENT">a'</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a_213"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <a href="#local_external_loop_210"><span class="LIDENT">external_loop</span></a> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">zero</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_e_214"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="TRY">try</span> <span class="UIDENT">Result</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_r_198"><span class="LIDENT">r</span></a> <a href="#local_e_214"><span class="LIDENT">e</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">F</span><span class="DOT">.</span><span class="LIDENT">flow</span> <span class="LPAREN">(</span><span class="UIDENT">G</span><span class="DOT">.</span><span class="UIDENT">E</span><span class="DOT">.</span><span class="LIDENT">label</span> <a href="#local_e_214"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_a_213"><span class="LIDENT">a</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span></span></code></pre></body></html>
