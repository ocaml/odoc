<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: sexp_conv.ml (sexplib0.src.sexplib0)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">sexplib0</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; sexplib0 &#x00BB; sexp_conv.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>sexp_conv.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">sexplib0</a><ul><li>Library <code>sexplib0</code><ul><li><a href="../../sexplib0/Sexplib0/index.html">Sexplib0</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>sexplib0<ul><li><a href="sexp.ml.html">sexp.ml</a></li><li><a href="#" class="current_unit">sexp_conv.ml</a></li><li><a href="sexp_conv_error.ml.html">sexp_conv_error.ml</a></li><li><a href="sexp_conv_grammar.ml.html">sexp_conv_grammar.ml</a></li><li><a href="sexp_conv_record.ml.html">sexp_conv_record.ml</a></li><li><a href="sexp_grammar.ml.html">sexp_grammar.ml</a></li><li><a href="sexpable.ml.html">sexpable.ml</a></li><li><a href="sexplib0.ml.html">sexplib0.ml</a></li><li><a href="sexplib0__.ml.html">sexplib0__.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
</code><code class="source_code"><span><span class="COMMENT">(* Utility Module for S-expression Conversions *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdLabels.ml.html"><span class="UIDENT">StdLabels</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ocaml-base-compiler/src/stdlib/moreLabels.ml.html"><span class="UIDENT">MoreLabels</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html"><span class="UIDENT">Printf</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="sexp.ml.html"><span class="UIDENT">Sexp</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Conversion of OCaml-values to S-expressions *)</span><span class="EOL">
</span><span id="val-format_float"><span class="EXTERNAL">external</span> <span class="LIDENT">format_float</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">float</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="EQUAL">=</span> <span class="STRING">&quot;caml_format_float&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* '%.17g' is guaranteed to be round-trippable.

   '%.15g' will be round-trippable and not have noise at the last digit or two for a float
   which was converted from a decimal (string) with &lt;= 15 significant digits.  So it's
   worth trying first to avoid things like &quot;3.1400000000000001&quot;.

   See comment above [to_string_round_trippable] in {!Core.Float} for
   detailed explanation and examples. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-default_string_of_float"><span class="LIDENT">default_string_of_float</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_1"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_y_2"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="LIDENT">format_float</span> <span class="STRING">&quot;%.15G&quot;</span> <a href="#local_x_1"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-float_of_string"><span class="LIDENT">float_of_string</span></a> <a href="#local_y_2"><span class="LIDENT">y</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_x_1"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_y_2"><span class="LIDENT">y</span></a> <span class="ELSE">else</span> <span class="LIDENT">format_float</span> <span class="STRING">&quot;%.17G&quot;</span> <a href="#local_x_1"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-read_old_option_format"><span class="LIDENT">read_old_option_format</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-write_old_option_format"><span class="LIDENT">write_old_option_format</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-list_map"><span class="LIDENT">list_map</span></span> <span id="local_f_3"><span class="LIDENT">f</span></span> <span id="local_l_4"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <a href="#local_l_4"><span class="LIDENT">l</span></a> <span class="TILDE">~</span><a href="#local_f_3"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_unit"><span class="LIDENT">sexp_of_unit</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_bool"><span class="LIDENT">sexp_of_bool</span></span> <span id="local_b_5"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-string_of_bool"><span class="LIDENT">string_of_bool</span></a> <a href="#local_b_5"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_string"><span class="LIDENT">sexp_of_string</span></span> <span id="local_str_6"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <a href="#local_str_6"><span class="LIDENT">str</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_bytes"><span class="LIDENT">sexp_of_bytes</span></span> <span id="local_bytes_7"><span class="LIDENT">bytes</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_bytes_7"><span class="LIDENT">bytes</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_char"><span class="LIDENT">sexp_of_char</span></span> <span id="local_c_8"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">1</span> <a href="#local_c_8"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_int"><span class="LIDENT">sexp_of_int</span></span> <span id="local_n_9"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-string_of_int"><span class="LIDENT">string_of_int</span></a> <a href="#local_n_9"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_float"><span class="LIDENT">sexp_of_float</span></span> <span id="local_n_10"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">default_string_of_float</span> <a href="#local_n_10"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_int32"><span class="LIDENT">sexp_of_int32</span></span> <span id="local_n_11"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int32.ml.html#val-to_string"><span class="UIDENT">Int32</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_n_11"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_int64"><span class="LIDENT">sexp_of_int64</span></span> <span id="local_n_12"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-to_string"><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_n_12"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_nativeint"><span class="LIDENT">sexp_of_nativeint</span></span> <span id="local_n_13"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-to_string"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_n_13"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_ref"><span class="LIDENT">sexp_of_ref</span></span> <span id="local_sexp_of__a_14"><span class="LIDENT">sexp_of__a</span></span> <span id="local_rf_15"><span class="LIDENT">rf</span></span> <span class="EQUAL">=</span> <a href="#local_sexp_of__a_14"><span class="LIDENT">sexp_of__a</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_rf_15"><span class="LIDENT">rf</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_lazy_t"><span class="LIDENT">sexp_of_lazy_t</span></span> <span id="local_sexp_of__a_16"><span class="LIDENT">sexp_of__a</span></span> <span id="local_lv_17"><span class="LIDENT">lv</span></span> <span class="EQUAL">=</span> <a href="#local_sexp_of__a_16"><span class="LIDENT">sexp_of__a</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/lazy.ml.html#val-force"><span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="LIDENT">force</span></a> <a href="#local_lv_17"><span class="LIDENT">lv</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_option"><span class="LIDENT">sexp_of_option</span></span> <span id="local_sexp_of__a_18"><span class="LIDENT">sexp_of__a</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_19"><span class="LIDENT">x</span></span> <span class="WHEN">when</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">write_old_option_format</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <a href="#local_sexp_of__a_18"><span class="LIDENT">sexp_of__a</span></a> <a href="#local_x_19"><span class="LIDENT">x</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_x_20"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;some&quot;</span><span class="SEMI">;</span> <a href="#local_sexp_of__a_18"><span class="LIDENT">sexp_of__a</span></a> <a href="#local_x_20"><span class="LIDENT">x</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="WHEN">when</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">write_old_option_format</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;none&quot;</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_pair"><span class="LIDENT">sexp_of_pair</span></span> <span id="local_sexp_of__a_21"><span class="LIDENT">sexp_of__a</span></span> <span id="local_sexp_of__b_22"><span class="LIDENT">sexp_of__b</span></span> <span class="LPAREN">(</span><span id="local_a_23"><span class="LIDENT">a</span></span><span class="COMMA">,</span> <span id="local_b_24"><span class="LIDENT">b</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <a href="#local_sexp_of__a_21"><span class="LIDENT">sexp_of__a</span></a> <a href="#local_a_23"><span class="LIDENT">a</span></a><span class="SEMI">;</span> <a href="#local_sexp_of__b_22"><span class="LIDENT">sexp_of__b</span></a> <a href="#local_b_24"><span class="LIDENT">b</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_triple"><span class="LIDENT">sexp_of_triple</span></span> <span id="local_sexp_of__a_25"><span class="LIDENT">sexp_of__a</span></span> <span id="local_sexp_of__b_26"><span class="LIDENT">sexp_of__b</span></span> <span id="local_sexp_of__c_27"><span class="LIDENT">sexp_of__c</span></span> <span class="LPAREN">(</span><span id="local_a_28"><span class="LIDENT">a</span></span><span class="COMMA">,</span> <span id="local_b_29"><span class="LIDENT">b</span></span><span class="COMMA">,</span> <span id="local_c_30"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <a href="#local_sexp_of__a_25"><span class="LIDENT">sexp_of__a</span></a> <a href="#local_a_28"><span class="LIDENT">a</span></a><span class="SEMI">;</span> <a href="#local_sexp_of__b_26"><span class="LIDENT">sexp_of__b</span></a> <a href="#local_b_29"><span class="LIDENT">b</span></a><span class="SEMI">;</span> <a href="#local_sexp_of__c_27"><span class="LIDENT">sexp_of__c</span></a> <a href="#local_c_30"><span class="LIDENT">c</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* List.rev (List.rev_map ...) is tail recursive, the OCaml standard
   library List.map is NOT. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_list"><span class="LIDENT">sexp_of_list</span></span> <span id="local_sexp_of__a_31"><span class="LIDENT">sexp_of__a</span></span> <span id="local_lst_32"><span class="LIDENT">lst</span></span> <span class="EQUAL">=</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <a href="#local_lst_32"><span class="LIDENT">lst</span></a> <span class="LABEL">~f:</span><a href="#local_sexp_of__a_31"><span class="LIDENT">sexp_of__a</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_array"><span class="LIDENT">sexp_of_array</span></span> <span id="local_sexp_of__a_33"><span class="LIDENT">sexp_of__a</span></span> <span id="local_ar_34"><span class="LIDENT">ar</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_lst_ref_35"><span class="LIDENT">lst_ref</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_ar_34"><span class="LIDENT">ar</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DOWNTO">downto</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="#local_lst_ref_35"><span class="LIDENT">lst_ref</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_sexp_of__a_33"><span class="LIDENT">sexp_of__a</span></a> <a href="#local_ar_34"><span class="LIDENT">ar</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_lst_ref_35"><span class="LIDENT">lst_ref</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="UIDENT">List</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_lst_ref_35"><span class="LIDENT">lst_ref</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_hashtbl"><span class="LIDENT">sexp_of_hashtbl</span></span> <span id="local_sexp_of_key_36"><span class="LIDENT">sexp_of_key</span></span> <span id="local_sexp_of_val_37"><span class="LIDENT">sexp_of_val</span></span> <span id="local_htbl_38"><span class="LIDENT">htbl</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_coll_39"><span class="LIDENT">coll</span></span> <span class="LABEL">~key:</span><span id="local_k_40"><span class="LIDENT">k</span></span> <span class="LABEL">~data:</span><span id="local_v_41"><span class="LIDENT">v</span></span> <span id="local_acc_42"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <a href="#local_sexp_of_key_36"><span class="LIDENT">sexp_of_key</span></a> <a href="#local_k_40"><span class="LIDENT">k</span></a><span class="SEMI">;</span> <a href="#local_sexp_of_val_37"><span class="LIDENT">sexp_of_val</span></a> <a href="#local_v_41"><span class="LIDENT">v</span></a> <span class="RBRACKET">]</span> <span class="COLONCOLON">::</span> <a href="#local_acc_42"><span class="LIDENT">acc</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">List</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-fold"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">fold</span></a> <a href="#local_htbl_38"><span class="LIDENT">htbl</span></a> <span class="LABEL">~init:</span><span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="LABEL">~f:</span><a href="#local_coll_39"><span class="LIDENT">coll</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_opaque"><span class="LIDENT">sexp_of_opaque</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;&lt;opaque&gt;&quot;</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_fun"><span class="LIDENT">sexp_of_fun</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;&lt;fun&gt;&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Exception converter registration and lookup *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Exn_converter"><span class="MODULE">module</span> <span class="UIDENT">Exn_converter</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="COMMENT">(* These exception registration functions assume that context-switches
     cannot happen unless there is an allocation.  It is reasonable to expect
     that this will remain true for the foreseeable future.  That way we
     avoid using mutexes and thus a dependency on the threads library. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Fast and automatic exception registration *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Exn_converter.module-Registration"><span class="MODULE">module</span> <span class="UIDENT">Registration</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span id="module-Exn_converter.module-Registration.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LBRACE">{</span> <span id="def_158"><span class="LIDENT">sexp_of_exn</span> <span class="COLON">:</span> <span class="LIDENT">exn</span> <span class="MINUSGREATER">-&gt;</span> <a href="sexp.ml.html#type-t"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="SEMI">;</span></span> <span class="COMMENT">(* If [printexc = true] then this sexp converter is used for Printexc.to_string *)</span><span class="EOL">
</span>        <span id="def_159"><span class="LIDENT">printexc</span> <span class="COLON">:</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>      <span class="RBRACE">}</span></span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Exn_converter.module-Exn_table"><span class="MODULE">module</span> <span class="UIDENT">Exn_table</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/ephemeron.ml.html#module-K1.module-Make"><span class="UIDENT">Ephemeron</span><span class="DOT">.</span><span class="UIDENT">K1</span><span class="DOT">.</span><span class="UIDENT">Make</span></a> <span class="LPAREN">(</span><span class="STRUCT">struct</span><span class="EOL">
</span>      <span id="def_160"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">extension_constructor</span></span><span class="EOL">
</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_equal_43"><span class="LIDENT">equal</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(==)"><span class="LPAREN">(</span> <span class="INFIXOP0">==</span> <span class="RPAREN">)</span></a><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_hash_44"><span class="LIDENT">hash</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/obj.ml.html#module-Extension_constructor.val-id"><span class="UIDENT">Obj</span><span class="DOT">.</span><span class="UIDENT">Extension_constructor</span><span class="DOT">.</span><span class="LIDENT">id</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="RPAREN">)</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Exn_converter.val-the_exn_table"><span class="LIDENT">the_exn_table</span></span> <span class="COLON">:</span> <span class="UIDENT">Registration</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="UIDENT">Exn_table</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="UIDENT">Exn_table</span><span class="DOT">.</span><span class="LIDENT">create</span> <span class="INT">17</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Ephemerons are used so that [sexp_of_exn] closure don't keep the
     extension_constructor live. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Exn_converter.val-add"><span class="LIDENT">add</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_printexc_45"><span class="LIDENT">printexc</span></span> <span class="EQUAL">=</span> <span class="TRUE">true</span><span class="RPAREN">)</span> <span class="OPTLABEL">?finalise:</span><span class="UNDERSCORE">_</span> <span id="local_extension_constructor_46"><span class="LIDENT">extension_constructor</span></span> <span id="local_sexp_of_exn_47"><span class="LIDENT">sexp_of_exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Exn_table</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LIDENT">the_exn_table</span> <a href="#local_extension_constructor_46"><span class="LIDENT">extension_constructor</span></a> <span class="LBRACE">{</span> <a href="#local_sexp_of_exn_47"><span class="LIDENT">sexp_of_exn</span></a><span class="SEMI">;</span> <a href="#local_printexc_45"><span class="LIDENT">printexc</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Exn_converter.val-find_auto"><span class="LIDENT">find_auto</span></span> <span class="TILDE">~</span><span id="local_for_printexc_48"><span class="LIDENT">for_printexc</span></span> <span id="local_exn_49"><span class="LIDENT">exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_extension_constructor_50"><span class="LIDENT">extension_constructor</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/obj.ml.html#module-Extension_constructor.val-of_val"><span class="UIDENT">Obj</span><span class="DOT">.</span><span class="UIDENT">Extension_constructor</span><span class="DOT">.</span><span class="LIDENT">of_val</span></a> <a href="#local_exn_49"><span class="LIDENT">exn</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">Exn_table</span><span class="DOT">.</span><span class="LIDENT">find_opt</span> <span class="LIDENT">the_exn_table</span> <a href="#local_extension_constructor_50"><span class="LIDENT">extension_constructor</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_sexp_of_exn_51"><span class="LIDENT">sexp_of_exn</span></span><span class="SEMI">;</span> <span id="local_printexc_52"><span class="LIDENT">printexc</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#local_for_printexc_48"><span class="LIDENT">for_printexc</span></a><span class="COMMA">,</span> <a href="#local_printexc_52"><span class="LIDENT">printexc</span></a> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_sexp_of_exn_51"><span class="LIDENT">sexp_of_exn</span></a> <a href="#local_exn_49"><span class="LIDENT">exn</span></a><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Exn_converter.module-For_unit_tests_only"><span class="MODULE">module</span> <span class="UIDENT">For_unit_tests_only</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="module-Exn_converter.module-For_unit_tests_only.val-size"><span class="LIDENT">size</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="UIDENT">Exn_table</span><span class="DOT">.</span><span class="LIDENT">stats_alive</span> <span class="LIDENT">the_exn_table</span><span class="RPAREN">)</span><span class="DOT">.</span><span class="LIDENT">num_bindings</span><span class="EOL">
</span>  <span class="END">end</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_exn_opt_for_printexc"><span class="LIDENT">sexp_of_exn_opt_for_printexc</span></span> <span id="local_exn_53"><span class="LIDENT">exn</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">find_auto</span> <span class="LABEL">~for_printexc:</span><span class="TRUE">true</span> <a href="#local_exn_53"><span class="LIDENT">exn</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_exn_opt"><span class="LIDENT">sexp_of_exn_opt</span></span> <span id="local_exn_54"><span class="LIDENT">exn</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">find_auto</span> <span class="LABEL">~for_printexc:</span><span class="FALSE">false</span> <a href="#local_exn_54"><span class="LIDENT">exn</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sexp_of_exn"><span class="LIDENT">sexp_of_exn</span></span> <span id="local_exn_55"><span class="LIDENT">exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">sexp_of_exn_opt</span> <a href="#local_exn_55"><span class="LIDENT">exn</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/printexc.ml.html#val-to_string"><span class="UIDENT">Printexc</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_exn_55"><span class="LIDENT">exn</span></a><span class="RPAREN">)</span> <span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_sexp_56"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_sexp_56"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exn_to_string"><span class="LIDENT">exn_to_string</span></span> <span id="local_e_57"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span> <a href="sexp.ml.html#module-Printing.val-to_string_hum"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">to_string_hum</span></a> <span class="LPAREN">(</span><span class="LIDENT">sexp_of_exn</span> <a href="#local_e_57"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* {[exception Blah [@@deriving sexp]]} generates a call to the function
   [Exn_converter.add] defined in this file.  So we are guaranted that as soon as we
   mark an exception as sexpable, this module will be linked in and this printer will be
   registered, which is what we want. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/printexc.ml.html#val-register_printer"><span class="UIDENT">Printexc</span><span class="DOT">.</span><span class="LIDENT">register_printer</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_exn_58"><span class="LIDENT">exn</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">sexp_of_exn_opt_for_printexc</span> <a href="#local_exn_58"><span class="LIDENT">exn</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_sexp_59"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="sexp.ml.html#module-Printing.val-to_string_hum"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">to_string_hum</span></a> <span class="LABEL">~indent:</span><span class="INT">2</span> <a href="#local_sexp_59"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-printexc_prefer_sexp"><span class="LIDENT">printexc_prefer_sexp</span></span> <span id="local_exn_60"><span class="LIDENT">exn</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">sexp_of_exn_opt</span> <a href="#local_exn_60"><span class="LIDENT">exn</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/printexc.ml.html#val-to_string"><span class="UIDENT">Printexc</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_exn_60"><span class="LIDENT">exn</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_sexp_61"><span class="LIDENT">sexp</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="sexp.ml.html#module-Printing.val-to_string_hum"><span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="LIDENT">to_string_hum</span></a> <span class="LABEL">~indent:</span><span class="INT">2</span> <a href="#local_sexp_61"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Conversion of S-expressions to OCaml-values *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="exception-Of_sexp_error"><span class="EXCEPTION">exception</span> <span class="UIDENT">Of_sexp_error</span> <span class="EQUAL">=</span> <span class="UIDENT">Sexp</span><span class="DOT">.</span><span class="UIDENT">Of_sexp_error</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-record_check_extra_fields"><span class="LIDENT">record_check_extra_fields</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_sexp_error_exn"><span class="LIDENT">of_sexp_error_exn</span></span> <span id="local_exc_62"><span class="LIDENT">exc</span></span> <span id="local_sexp_63"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><a href="#local_exc_62"><span class="LIDENT">exc</span></a><span class="COMMA">,</span> <a href="#local_sexp_63"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_sexp_error"><span class="LIDENT">of_sexp_error</span></span> <span id="local_what_64"><span class="LIDENT">what</span></span> <span id="local_sexp_65"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span class="UIDENT">Failure</span> <a href="#local_what_64"><span class="LIDENT">what</span></a><span class="COMMA">,</span> <a href="#local_sexp_65"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unit_of_sexp"><span class="LIDENT">unit_of_sexp</span></span> <span id="local_sexp_66"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_66"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;unit_of_sexp: empty list needed&quot;</span> <a href="#local_sexp_66"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bool_of_sexp"><span class="LIDENT">bool_of_sexp</span></span> <span id="local_sexp_67"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_67"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;true&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;True&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;false&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;False&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;bool_of_sexp: unknown string&quot;</span> <a href="#local_sexp_67"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;bool_of_sexp: atom needed&quot;</span> <a href="#local_sexp_67"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-string_of_sexp"><span class="LIDENT">string_of_sexp</span></span> <span id="local_sexp_68"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_68"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_69"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_69"><span class="LIDENT">str</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;string_of_sexp: atom needed&quot;</span> <a href="#local_sexp_68"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bytes_of_sexp"><span class="LIDENT">bytes_of_sexp</span></span> <span id="local_sexp_70"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_70"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_71"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/bytes.ml.html#val-of_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">of_string</span></a> <a href="#local_str_71"><span class="LIDENT">str</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;bytes_of_sexp: atom needed&quot;</span> <a href="#local_sexp_70"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_of_sexp"><span class="LIDENT">char_of_sexp</span></span> <span id="local_sexp_72"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_72"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_73"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_73"><span class="LIDENT">str</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;char_of_sexp: atom string must contain one character only&quot;</span> <a href="#local_sexp_72"><span class="LIDENT">sexp</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_str_73"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;char_of_sexp: atom needed&quot;</span> <a href="#local_sexp_72"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int_of_sexp"><span class="LIDENT">int_of_sexp</span></span> <span id="local_sexp_74"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_74"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_75"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-int_of_string"><span class="LIDENT">int_of_string</span></a> <a href="#local_str_75"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_exc_76"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="LPAREN">(</span><span class="STRING">&quot;int_of_sexp: &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LIDENT">exn_to_string</span> <a href="#local_exc_76"><span class="LIDENT">exc</span></a><span class="RPAREN">)</span> <a href="#local_sexp_74"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;int_of_sexp: atom needed&quot;</span> <a href="#local_sexp_74"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-float_of_sexp"><span class="LIDENT">float_of_sexp</span></span> <span id="local_sexp_77"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_77"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_78"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-float_of_string"><span class="LIDENT">float_of_string</span></a> <a href="#local_str_78"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_exc_79"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="LPAREN">(</span><span class="STRING">&quot;float_of_sexp: &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LIDENT">exn_to_string</span> <a href="#local_exc_79"><span class="LIDENT">exc</span></a><span class="RPAREN">)</span> <a href="#local_sexp_77"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;float_of_sexp: atom needed&quot;</span> <a href="#local_sexp_77"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int32_of_sexp"><span class="LIDENT">int32_of_sexp</span></span> <span id="local_sexp_80"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_80"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_81"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/int32.ml.html#val-of_string"><span class="UIDENT">Int32</span><span class="DOT">.</span><span class="LIDENT">of_string</span></a> <a href="#local_str_81"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_exc_82"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="LPAREN">(</span><span class="STRING">&quot;int32_of_sexp: &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LIDENT">exn_to_string</span> <a href="#local_exc_82"><span class="LIDENT">exc</span></a><span class="RPAREN">)</span> <a href="#local_sexp_80"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;int32_of_sexp: atom needed&quot;</span> <a href="#local_sexp_80"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-int64_of_sexp"><span class="LIDENT">int64_of_sexp</span></span> <span id="local_sexp_83"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_83"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_84"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/int64.ml.html#val-of_string"><span class="UIDENT">Int64</span><span class="DOT">.</span><span class="LIDENT">of_string</span></a> <a href="#local_str_84"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_exc_85"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="LPAREN">(</span><span class="STRING">&quot;int64_of_sexp: &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LIDENT">exn_to_string</span> <a href="#local_exc_85"><span class="LIDENT">exc</span></a><span class="RPAREN">)</span> <a href="#local_sexp_83"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;int64_of_sexp: atom needed&quot;</span> <a href="#local_sexp_83"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-nativeint_of_sexp"><span class="LIDENT">nativeint_of_sexp</span></span> <span id="local_sexp_86"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_86"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span id="local_str_87"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/nativeint.ml.html#val-of_string"><span class="UIDENT">Nativeint</span><span class="DOT">.</span><span class="LIDENT">of_string</span></a> <a href="#local_str_87"><span class="LIDENT">str</span></a> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span id="local_exc_88"><span class="LIDENT">exc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="LPAREN">(</span><span class="STRING">&quot;nativeint_of_sexp: &quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LIDENT">exn_to_string</span> <a href="#local_exc_88"><span class="LIDENT">exc</span></a><span class="RPAREN">)</span> <a href="#local_sexp_86"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;nativeint_of_sexp: atom needed&quot;</span> <a href="#local_sexp_86"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ref_of_sexp"><span class="LIDENT">ref_of_sexp</span></span> <span id="local_a__of_sexp_89"><span class="LIDENT">a__of_sexp</span></span> <span id="local_sexp_90"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_a__of_sexp_89"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_sexp_90"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-lazy_t_of_sexp"><span class="LIDENT">lazy_t_of_sexp</span></span> <span id="local_a__of_sexp_91"><span class="LIDENT">a__of_sexp</span></span> <span id="local_sexp_92"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/lazy.ml.html#val-from_val"><span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="LIDENT">from_val</span></a> <span class="LPAREN">(</span><a href="#local_a__of_sexp_91"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_sexp_92"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-option_of_sexp"><span class="LIDENT">option_of_sexp</span></span> <span id="local_a__of_sexp_93"><span class="LIDENT">a__of_sexp</span></span> <span id="local_sexp_94"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">read_old_option_format</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_sexp_94"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;none&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;None&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span id="local_el_95"><span class="LIDENT">el</span></span> <span class="RBRACKET">]</span> <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;some&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Some&quot;</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span id="local_el_96"><span class="LIDENT">el</span></span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_a__of_sexp_93"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_el_96"><span class="LIDENT">el</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;option_of_sexp: list must represent optional value&quot;</span> <a href="#local_sexp_94"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;option_of_sexp: only none can be atom&quot;</span> <a href="#local_sexp_94"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_sexp_94"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;none&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;None&quot;</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><span class="STRING">&quot;some&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;Some&quot;</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span id="local_el_97"><span class="LIDENT">el</span></span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_a__of_sexp_93"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_el_97"><span class="LIDENT">el</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;option_of_sexp: only none can be atom&quot;</span> <a href="#local_sexp_94"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;option_of_sexp: list must be (some el)&quot;</span> <a href="#local_sexp_94"><span class="LIDENT">sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pair_of_sexp"><span class="LIDENT">pair_of_sexp</span></span> <span id="local_a__of_sexp_98"><span class="LIDENT">a__of_sexp</span></span> <span id="local_b__of_sexp_99"><span class="LIDENT">b__of_sexp</span></span> <span id="local_sexp_100"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_100"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span id="local_a_sexp_101"><span class="LIDENT">a_sexp</span></span><span class="SEMI">;</span> <span id="local_b_sexp_102"><span class="LIDENT">b_sexp</span></span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a_103"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <a href="#local_a__of_sexp_98"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_a_sexp_101"><span class="LIDENT">a_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_b_104"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b__of_sexp_99"><span class="LIDENT">b__of_sexp</span></a> <a href="#local_b_sexp_102"><span class="LIDENT">b_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_a_103"><span class="LIDENT">a</span></a><span class="COMMA">,</span> <a href="#local_b_104"><span class="LIDENT">b</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;pair_of_sexp: list must contain exactly two elements only&quot;</span> <a href="#local_sexp_100"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;pair_of_sexp: list needed&quot;</span> <a href="#local_sexp_100"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-triple_of_sexp"><span class="LIDENT">triple_of_sexp</span></span> <span id="local_a__of_sexp_105"><span class="LIDENT">a__of_sexp</span></span> <span id="local_b__of_sexp_106"><span class="LIDENT">b__of_sexp</span></span> <span id="local_c__of_sexp_107"><span class="LIDENT">c__of_sexp</span></span> <span id="local_sexp_108"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_108"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span id="local_a_sexp_109"><span class="LIDENT">a_sexp</span></span><span class="SEMI">;</span> <span id="local_b_sexp_110"><span class="LIDENT">b_sexp</span></span><span class="SEMI">;</span> <span id="local_c_sexp_111"><span class="LIDENT">c_sexp</span></span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_a_112"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <a href="#local_a__of_sexp_105"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_a_sexp_109"><span class="LIDENT">a_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_b_113"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b__of_sexp_106"><span class="LIDENT">b__of_sexp</span></a> <a href="#local_b_sexp_110"><span class="LIDENT">b_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_114"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_c__of_sexp_107"><span class="LIDENT">c__of_sexp</span></a> <a href="#local_c_sexp_111"><span class="LIDENT">c_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_a_112"><span class="LIDENT">a</span></a><span class="COMMA">,</span> <a href="#local_b_113"><span class="LIDENT">b</span></a><span class="COMMA">,</span> <a href="#local_c_114"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;triple_of_sexp: list must contain exactly three elements only&quot;</span> <a href="#local_sexp_108"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;triple_of_sexp: list needed&quot;</span> <a href="#local_sexp_108"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-list_of_sexp"><span class="LIDENT">list_of_sexp</span></span> <span id="local_a__of_sexp_115"><span class="LIDENT">a__of_sexp</span></span> <span id="local_sexp_116"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_116"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span id="local_lst_117"><span class="LIDENT">lst</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_rev_lst_118"><span class="LIDENT">rev_lst</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev_map"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev_map</span></a> <a href="#local_lst_117"><span class="LIDENT">lst</span></a> <span class="LABEL">~f:</span><a href="#local_a__of_sexp_115"><span class="LIDENT">a__of_sexp</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_rev_lst_118"><span class="LIDENT">rev_lst</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;list_of_sexp: list needed&quot;</span> <a href="#local_sexp_116"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-array_of_sexp"><span class="LIDENT">array_of_sexp</span></span> <span id="local_a__of_sexp_119"><span class="LIDENT">a__of_sexp</span></span> <span id="local_sexp_120"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_120"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKETBAR">[|</span><span class="BARRBRACKET">|]</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LPAREN">(</span><span id="local_h_121"><span class="LIDENT">h</span></span> <span class="COLONCOLON">::</span> <span id="local_t_122"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_123"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-length"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_t_122"><span class="LIDENT">t</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_124"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_len_123"><span class="LIDENT">len</span></a> <span class="LPAREN">(</span><a href="#local_a__of_sexp_119"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_h_121"><span class="LIDENT">h</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_125"><span class="LIDENT">loop</span></span> <span id="local_i_126"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_res_124"><span class="LIDENT">res</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_h_127"><span class="LIDENT">h</span></span> <span class="COLONCOLON">::</span> <span id="local_t_128"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_res_124"><span class="LIDENT">res</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_126"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a__of_sexp_119"><span class="LIDENT">a__of_sexp</span></a> <a href="#local_h_127"><span class="LIDENT">h</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_loop_125"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="#local_i_126"><span class="LIDENT">i</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_t_128"><span class="LIDENT">t</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_loop_125"><span class="LIDENT">loop</span></a> <span class="INT">1</span> <a href="#local_t_122"><span class="LIDENT">t</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;array_of_sexp: list needed&quot;</span> <a href="#local_sexp_120"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-hashtbl_of_sexp"><span class="LIDENT">hashtbl_of_sexp</span></span> <span id="local_key_of_sexp_129"><span class="LIDENT">key_of_sexp</span></span> <span id="local_val_of_sexp_130"><span class="LIDENT">val_of_sexp</span></span> <span id="local_sexp_131"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sexp_131"><span class="LIDENT">sexp</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">List</span> <span id="local_lst_132"><span class="LIDENT">lst</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_htbl_133"><span class="LIDENT">htbl</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-create"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_act_134"><span class="LIDENT">act</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span id="local_k_sexp_135"><span class="LIDENT">k_sexp</span></span><span class="SEMI">;</span> <span id="local_v_sexp_136"><span class="LIDENT">v_sexp</span></span> <span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-add"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_htbl_133"><span class="LIDENT">htbl</span></a> <span class="LABEL">~key:</span><span class="LPAREN">(</span><a href="#local_key_of_sexp_129"><span class="LIDENT">key_of_sexp</span></a> <a href="#local_k_sexp_135"><span class="LIDENT">k_sexp</span></a><span class="RPAREN">)</span> <span class="LABEL">~data:</span><span class="LPAREN">(</span><a href="#local_val_of_sexp_130"><span class="LIDENT">val_of_sexp</span></a> <a href="#local_v_sexp_136"><span class="LIDENT">v_sexp</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">List</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;hashtbl_of_sexp: tuple list needed&quot;</span> <a href="#local_sexp_131"><span class="LIDENT">sexp</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_lst_132"><span class="LIDENT">lst</span></a> <span class="LABEL">~f:</span><a href="#local_act_134"><span class="LIDENT">act</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_htbl_133"><span class="LIDENT">htbl</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Atom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;hashtbl_of_sexp: list needed&quot;</span> <a href="#local_sexp_131"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-opaque_of_sexp"><span class="LIDENT">opaque_of_sexp</span></span> <span id="local_sexp_137"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;opaque_of_sexp: cannot convert opaque values&quot;</span> <a href="#local_sexp_137"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fun_of_sexp"><span class="LIDENT">fun_of_sexp</span></span> <span id="local_sexp_138"><span class="LIDENT">sexp</span></span> <span class="EQUAL">=</span> <span class="LIDENT">of_sexp_error</span> <span class="STRING">&quot;fun_of_sexp: cannot convert function values&quot;</span> <a href="#local_sexp_138"><span class="LIDENT">sexp</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Sexp Grammars *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="INCLUDE">include</span> <a href="sexp_conv_grammar.ml.html"><span class="UIDENT">Sexp_conv_grammar</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Registering default exception printers *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_flc_error"><span class="LIDENT">get_flc_error</span></span> <span id="local_name_139"><span class="LIDENT">name</span></span> <span class="LPAREN">(</span><span id="local_file_140"><span class="LIDENT">file</span></span><span class="COMMA">,</span> <span id="local_line_141"><span class="LIDENT">line</span></span><span class="COMMA">,</span> <span id="local_chr_142"><span class="LIDENT">chr</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">Atom</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s %s:%d:%d&quot;</span> <a href="#local_name_139"><span class="LIDENT">name</span></a> <a href="#local_file_140"><span class="LIDENT">file</span></a> <a href="#local_line_141"><span class="LIDENT">line</span></a> <a href="#local_chr_142"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>    <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_extension_constructor_143"><span class="LIDENT">extension_constructor</span></span><span class="COMMA">,</span> <span id="local_handler_144"><span class="LIDENT">handler</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LABEL">~printexc:</span><span class="FALSE">false</span> <span class="LABEL">~finalise:</span><span class="FALSE">false</span> <a href="#local_extension_constructor_143"><span class="LIDENT">extension_constructor</span></a> <a href="#local_handler_144"><span class="LIDENT">handler</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LBRACKET">[</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Assert_failure</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Assert_failure</span> <span id="local_arg_145"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">get_flc_error</span> <span class="STRING">&quot;Assert_failure&quot;</span> <a href="#local_arg_145"><span class="LIDENT">arg</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Exit</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Exit</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Exit&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">End_of_file</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">End_of_file</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;End_of_file&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Failure</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Failure</span> <span id="local_arg_146"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Failure&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_arg_146"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Not_found</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Not_found&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Invalid_argument</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Invalid_argument</span> <span id="local_arg_147"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Invalid_argument&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_arg_147"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Match_failure</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Match_failure</span> <span id="local_arg_148"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">get_flc_error</span> <span class="STRING">&quot;Match_failure&quot;</span> <a href="#local_arg_148"><span class="LIDENT">arg</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Not_found_s</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Not_found_s</span> <span id="local_arg_149"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Not_found_s&quot;</span><span class="SEMI">;</span> <a href="#local_arg_149"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Sys_error</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Sys_error</span> <span id="local_arg_150"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Sys_error&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_arg_150"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Arg</span><span class="DOT">.</span><span class="UIDENT">Help</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Arg</span><span class="DOT">.</span><span class="UIDENT">Help</span> <span id="local_arg_151"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Arg.Help&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_arg_151"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Arg</span><span class="DOT">.</span><span class="UIDENT">Bad</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Arg</span><span class="DOT">.</span><span class="UIDENT">Bad</span> <span id="local_arg_152"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Arg.Bad&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_arg_152"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="UIDENT">Undefined</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Lazy</span><span class="DOT">.</span><span class="UIDENT">Undefined</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Lazy.Undefined&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Parsing</span><span class="DOT">.</span><span class="UIDENT">Parse_error</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Parsing</span><span class="DOT">.</span><span class="UIDENT">Parse_error</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Parsing.Parse_error&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="UIDENT">Empty</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Queue.Empty&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Scanf</span><span class="DOT">.</span><span class="UIDENT">Scan_failure</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Scanf</span><span class="DOT">.</span><span class="UIDENT">Scan_failure</span> <span id="local_arg_153"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Scanf.Scan_failure&quot;</span><span class="SEMI">;</span> <span class="UIDENT">Atom</span> <a href="#local_arg_153"><span class="LIDENT">arg</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="UIDENT">Empty</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="UIDENT">Empty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Stack.Empty&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="SEMI">;</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Sys</span><span class="DOT">.</span><span class="UIDENT">Break</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Sys</span><span class="DOT">.</span><span class="UIDENT">Break</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Sys.Break&quot;</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>    <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_extension_constructor_154"><span class="LIDENT">extension_constructor</span></span><span class="COMMA">,</span> <span id="local_handler_155"><span class="LIDENT">handler</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Exn_converter</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LABEL">~printexc:</span><span class="TRUE">true</span> <span class="LABEL">~finalise:</span><span class="FALSE">false</span> <a href="#local_extension_constructor_154"><span class="LIDENT">extension_constructor</span></a> <a href="#local_handler_155"><span class="LIDENT">handler</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="LBRACKET">[</span> <span class="LPAREN">(</span> <span class="LBRACKETPERCENT">[%</span><span class="LIDENT">extension_constructor</span> <span class="UIDENT">Of_sexp_error</span><span class="RBRACKET">]</span><span class="EOL">
</span>      <span class="COMMA">,</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Of_sexp_error</span> <span class="LPAREN">(</span><span id="local_exc_156"><span class="LIDENT">exc</span></span><span class="COMMA">,</span> <span id="local_sexp_157"><span class="LIDENT">sexp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="UIDENT">List</span> <span class="LBRACKET">[</span> <span class="UIDENT">Atom</span> <span class="STRING">&quot;Sexplib.Conv.Of_sexp_error&quot;</span><span class="SEMI">;</span> <span class="LIDENT">sexp_of_exn</span> <a href="#local_exc_156"><span class="LIDENT">exc</span></a><span class="SEMI">;</span> <a href="#local_sexp_157"><span class="LIDENT">sexp</span></a> <span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="RBRACKET">]</span><span class="EOL">
</span><span class="SEMISEMI">;;</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-ignore"><span class="EXTERNAL">external</span> <span class="LIDENT">ignore</span> <span class="COLON">:</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%ignore&quot;</span></span><span class="EOL">
</span><span id="val-(=)"><span class="EXTERNAL">external</span> <span class="LPAREN">(</span> <span class="EQUAL">=</span> <span class="RPAREN">)</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%equal&quot;</span></span><span class="EOL">
</span></span></code></pre></body></html>
