<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: js_assign.ml (js_of_ocaml-compiler.src.js_of_ocaml-compiler)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">js_of_ocaml-compiler</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; js_of_ocaml-compiler &#x00BB; js_assign.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>js_assign.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">js_of_ocaml-compiler</a><ul><li>Library <code>js_of_ocaml-compiler</code><ul><li><a href="../../js_of_ocaml-compiler/Js_of_ocaml_compiler/index.html">Js_of_ocaml_compiler</a></li></ul></li><li>Library <code>js_of_ocaml-compiler.dynlink</code><ul><li><a href="../../js_of_ocaml-compiler.dynlink/Js_of_ocaml_compiler_dynlink/index.html">Js_of_ocaml_compiler_dynlink</a></li></ul></li><li>Library <code>js_of_ocaml-compiler.findlib-support</code><ul><li><a href="../../js_of_ocaml-compiler.findlib-support/Jsoo_findlib_support/index.html">Jsoo_findlib_support</a></li></ul></li><li>Library <code>js_of_ocaml-compiler.runtime</code><ul><li><a href="../../js_of_ocaml-compiler.runtime/Jsoo_runtime/index.html">Jsoo_runtime</a></li></ul></li><li>Library <code>js_of_ocaml-compiler.runtime-files</code><ul><li><a href="../../js_of_ocaml-compiler.runtime-files/Js_of_ocaml_compiler_runtime_files/index.html">Js_of_ocaml_compiler_runtime_files</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>js_of_ocaml-compiler<ul><li><a href="annot_lexer.ml.html">annot_lexer.ml</a></li><li><a href="annot_parser.ml.html">annot_parser.ml</a></li><li><a href="base64.ml.html">base64.ml</a></li><li><a href="build_info.ml.html">build_info.ml</a></li><li><a href="build_path_prefix_map.ml.html">build_path_prefix_map.ml</a></li><li><a href="builtins.ml.html">builtins.ml</a></li><li><a href="code.ml.html">code.ml</a></li><li><a href="compiler_version.ml.html">compiler_version.ml</a></li><li><a href="config.ml.html">config.ml</a></li><li><a href="constant.ml.html">constant.ml</a></li><li><a href="deadcode.ml.html">deadcode.ml</a></li><li><a href="debug.ml.html">debug.ml</a></li><li><a href="dgraph.ml.html">dgraph.ml</a></li><li><a href="driver.ml.html">driver.ml</a></li><li><a href="duplicate.ml.html">duplicate.ml</a></li><li><a href="effects.ml.html">effects.ml</a></li><li><a href="eval.ml.html">eval.ml</a></li><li><a href="findlib.ml.html">findlib.ml</a></li><li><a href="flow.ml.html">flow.ml</a></li><li><a href="flow_lexer.ml.html">flow_lexer.ml</a></li><li><a href="freevars.ml.html">freevars.ml</a></li><li><a href="fs.ml.html">fs.ml</a></li><li><a href="generate.ml.html">generate.ml</a></li><li><a href="generate_closure.ml.html">generate_closure.ml</a></li><li><a href="global_deadcode.ml.html">global_deadcode.ml</a></li><li><a href="global_flow.ml.html">global_flow.ml</a></li><li><a href="inline.ml.html">inline.ml</a></li><li><a href="instr.ml.html">instr.ml</a></li><li><a href="javascript.ml.html">javascript.ml</a></li><li><a href="#" class="current_unit">js_assign.ml</a></li><li><a href="js_of_ocaml_compiler.ml.html">js_of_ocaml_compiler.ml</a></li><li><a href="js_output.ml.html">js_output.ml</a></li><li><a href="js_parser.ml.html">js_parser.ml</a></li><li><a href="js_simpl.ml.html">js_simpl.ml</a></li><li><a href="js_token.ml.html">js_token.ml</a></li><li><a href="js_traverse.ml.html">js_traverse.ml</a></li><li><a href="lambda_lifting.ml.html">lambda_lifting.ml</a></li><li><a href="link_js.ml.html">link_js.ml</a></li><li><a href="linker.ml.html">linker.ml</a></li><li><a href="loc.ml.html">loc.ml</a></li><li><a href="macro.ml.html">macro.ml</a></li><li><a href="magic_number.ml.html">magic_number.ml</a></li><li><a href="mlvalue.ml.html">mlvalue.ml</a></li><li><a href="ocaml_compiler.ml.html">ocaml_compiler.ml</a></li><li><a href="ocaml_version.ml.html">ocaml_version.ml</a></li><li><a href="parse_bytecode.ml.html">parse_bytecode.ml</a></li><li><a href="parse_info.ml.html">parse_info.ml</a></li><li><a href="parse_js.ml.html">parse_js.ml</a></li><li><a href="partial_cps_analysis.ml.html">partial_cps_analysis.ml</a></li><li><a href="phisimpl.ml.html">phisimpl.ml</a></li><li><a href="pretty_print.ml.html">pretty_print.ml</a></li><li><a href="primitive.ml.html">primitive.ml</a></li><li><a href="pseudo_fs.ml.html">pseudo_fs.ml</a></li><li><a href="pure_fun.ml.html">pure_fun.ml</a></li><li><a href="reserved.ml.html">reserved.ml</a></li><li><a href="source_map.ml.html">source_map.ml</a></li><li><a href="source_map_io.ml.html">source_map_io.ml</a></li><li><a href="specialize.ml.html">specialize.ml</a></li><li><a href="specialize_js.ml.html">specialize_js.ml</a></li><li><a href="stdlib.ml.html">stdlib.ml</a></li><li><a href="strongly_connected_components.ml.html">strongly_connected_components.ml</a></li><li><a href="structure.ml.html">structure.ml</a></li><li><a href="subst.ml.html">subst.ml</a></li><li><a href="tailcall.ml.html">tailcall.ml</a></li><li><a href="target_env.ml.html">target_env.ml</a></li><li><a href="timer.ml.html">timer.ml</a></li><li><a href="unit_info.ml.html">unit_info.ml</a></li><li><a href="var_printer.ml.html">var_printer.ml</a></li><li><a href="vlq64.ml.html">vlq64.ml</a></li></ul></li><li>js_of_ocaml-compiler.dynlink<ul><li><a href="../js_of_ocaml-compiler.dynlink/js_of_ocaml_compiler_dynlink.ml.html">js_of_ocaml_compiler_dynlink.ml</a></li></ul></li><li>js_of_ocaml-compiler.findlib-support<ul><li><a href="../js_of_ocaml-compiler.findlib-support/jsoo_findlib_support.ml.html">jsoo_findlib_support.ml</a></li></ul></li><li>js_of_ocaml-compiler.runtime<ul><li><a href="../js_of_ocaml-compiler.runtime/jsoo_runtime.ml.html">jsoo_runtime.ml</a></li><li><a href="../js_of_ocaml-compiler.runtime/jsoo_runtime__.ml.html">jsoo_runtime__.ml</a></li><li><a href="../js_of_ocaml-compiler.runtime/runtime_version.ml.html">runtime_version.ml</a></li></ul></li><li>js_of_ocaml-compiler.runtime-files<ul><li><a href="../js_of_ocaml-compiler.runtime-files/files.ml.html">files.ml</a></li><li><a href="../js_of_ocaml-compiler.runtime-files/js_of_ocaml_compiler_runtime_files.ml.html">js_of_ocaml_compiler_runtime_files.ml</a></li><li><a href="../js_of_ocaml-compiler.runtime-files/js_of_ocaml_compiler_runtime_files__.ml.html">js_of_ocaml_compiler_runtime_files__.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
</code><code class="source_code"><span><span class="COMMENT">(* Js_of_ocaml compiler
 * http://www.ocsigen.org/js_of_ocaml/
 * Copyright (C) 2013 Jérôme Vouillon
 * Copyright (C) 2013 Hugo Heuzard
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, with linking exception;
 * either version 2.1 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 *)</span><span class="EOL">
</span><span class="OPEN">open</span><span class="BANG">!</span> <a href="stdlib.ml.html"><span class="UIDENT">Stdlib</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="javascript.ml.html"><span class="UIDENT">Javascript</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-debug_shortvar"><span class="LIDENT">debug_shortvar</span></span> <span class="EQUAL">=</span> <a href="debug.ml.html#val-find"><span class="UIDENT">Debug</span><span class="DOT">.</span><span class="LIDENT">find</span></a> <span class="STRING">&quot;shortvar&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-debug"><span class="LIDENT">debug</span></span> <span class="EQUAL">=</span> <a href="debug.ml.html#val-find"><span class="UIDENT">Debug</span><span class="DOT">.</span><span class="LIDENT">find</span></a> <span class="STRING">&quot;js_assign&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-S"><span class="MODULE">module</span> <span class="UIDENT">S</span> <span class="EQUAL">=</span> <a href="code.ml.html#module-Var.module-Set"><span class="UIDENT">Code</span><span class="DOT">.</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="UIDENT">Set</span></a></span><span class="EOL">
</span><span id="module-Var"><span class="MODULE">module</span> <span class="UIDENT">Var</span> <span class="EQUAL">=</span> <a href="code.ml.html#module-Var"><span class="UIDENT">Code</span><span class="DOT">.</span><span class="UIDENT">Var</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-type-Strategy"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">Strategy</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-type-Strategy.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-Strategy.val-create"><span class="VAL">val</span> <span class="LIDENT">create</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-Strategy.val-record_block"><span class="VAL">val</span> <span class="LIDENT">record_block</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <a href="js_traverse.ml.html#type-t"><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="js_traverse.ml.html#type-block"><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">block</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-Strategy.val-allocate_variables"><span class="VAL">val</span> <span class="LIDENT">allocate_variables</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">count</span><span class="COLON">:</span><a href="../../../ocaml-base-compiler/src/stdlib/map.ml.html#module-Make.type-t"><span class="LIDENT">int</span> <span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentMap</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="LIDENT">array</span></span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Min"><span class="MODULE">module</span> <span class="UIDENT">Min</span> <span class="COLON">:</span> <span class="UIDENT">Strategy</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="COMMENT">(*
We are trying to achieve the following goals:
(1) variable names should be as short as possible
(2) one should reuse as much as possible a small subsets of variable
    names
(3) function parameters should be: function(a,b,...){...}
(4) for longer variable names, variable which are closed from one
    another should share a same prefix

Point (1) minimizes the size of uncompressed files, while point (2) to
(4) improve compression.

We use the following strategy. We maintain the constraint that
variables occurring in a function should keep different names.
We first assign names a, b, ... (in order) to function parameters,
starting from inner functions, skipping variables which have a
conflict with a previously names variable (goal 3). Then, we order
the remaining variables by their number of occurrences, then by
their index (goal 4), and greedily assigned name to them. For that,
we use for each variable the smallest possible name still available
(goal 1/2).

This algorithm seems effective. Here are some statistics gathered
while compiling the OCaml toplevel:
(1) We get 132025 occurrences of one-char variables out of 169728
    occurrences while the optimal number (determined using a mixed
    integer linear programming solver) is 132105 occurrences (80 more
    occurrences).
(2) Variable names are heavily biased toward character a: among
    variables, we have about 34000 occurrences of character a, less
    than 5000 occurrences of character i (9th character, out of the 54
    characters that can start an identifier), and about 1500
    occurrences of character A.
(3) About 6% of the function parameters are not assigned as wanted;
    it is not clear we can do any better: there are a lot of nested
    functions.
(4) We save 8181 bytes on the compressed file (1.8%) by sorting
    variables using their index as a secondary key rather that just
    based on their weights (the size of the uncompressed file remains
    unchanged)
*)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Min.type-alloc"><span class="TYPE">type</span> <span class="LIDENT">alloc</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_159"><span class="MUTABLE">mutable</span> <span class="LIDENT">first_free</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_155"><span class="LIDENT">used</span> <span class="COLON">:</span> <a href="stdlib.ml.html#module-BitSet.type-t"><span class="UIDENT">BitSet</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-make_alloc_table"><span class="LIDENT">make_alloc_table</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">first_free</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">used</span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#module-BitSet.val-create"><span class="UIDENT">BitSet</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-next_available"><span class="LIDENT">next_available</span></span> <span id="local_a_1"><span class="LIDENT">a</span></span> <span id="local_i_2"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#module-BitSet.val-next_free"><span class="UIDENT">BitSet</span><span class="DOT">.</span><span class="LIDENT">next_free</span></a> <a href="#local_a_1"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">used</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-max"><span class="LIDENT">max</span></a> <a href="#local_i_2"><span class="LIDENT">i</span></a> <a href="#local_a_1"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">first_free</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-allocate"><span class="LIDENT">allocate</span></span> <span id="local_a_3"><span class="LIDENT">a</span></span> <span id="local_i_4"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="stdlib.ml.html#module-BitSet.val-set"><span class="UIDENT">BitSet</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_a_3"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">used</span> <a href="#local_i_4"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_a_3"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">first_free</span> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <a href="#local_i_4"><span class="LIDENT">i</span></a> <span class="THEN">then</span> <a href="#local_a_3"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">first_free</span> <span class="LESSMINUS">&lt;-</span> <a href="stdlib.ml.html#module-BitSet.val-next_free"><span class="UIDENT">BitSet</span><span class="DOT">.</span><span class="LIDENT">next_free</span></a> <a href="#local_a_3"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">used</span> <a href="#local_a_3"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">first_free</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-is_available"><span class="LIDENT">is_available</span></span> <span id="local_l_5"><span class="LIDENT">l</span></span> <span id="local_i_6"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-for_all"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">for_all</span></a> <a href="#local_l_5"><span class="LIDENT">l</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_a_7"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-BitSet.val-mem"><span class="UIDENT">BitSet</span><span class="DOT">.</span><span class="LIDENT">mem</span></a> <a href="#local_a_7"><span class="LIDENT">a</span></a><span class="DOT">.</span><span class="LIDENT">used</span> <a href="#local_i_6"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-first_available"><span class="LIDENT">first_available</span></span> <span id="local_l_8"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_find_rec_9"><span class="LIDENT">find_rec</span></span> <span id="local_n_10"><span class="LIDENT">n</span></span> <span id="local_l_11"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_n'_12"><span class="LIDENT">n'</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <a href="#local_l_11"><span class="LIDENT">l</span></a> <span class="LABEL">~init:</span><a href="#local_n_10"><span class="LIDENT">n</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_n_13"><span class="LIDENT">n</span></span> <span id="local_a_14"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">next_available</span> <a href="#local_a_14"><span class="LIDENT">a</span></a> <a href="#local_n_13"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_n_10"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <a href="#local_n'_12"><span class="LIDENT">n'</span></a> <span class="THEN">then</span> <a href="#local_n_10"><span class="LIDENT">n</span></a> <span class="ELSE">else</span> <a href="#local_find_rec_9"><span class="LIDENT">find_rec</span></a> <a href="#local_n'_12"><span class="LIDENT">n'</span></a> <a href="#local_l_11"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_find_rec_9"><span class="LIDENT">find_rec</span></a> <span class="INT">0</span> <a href="#local_l_8"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-mark_allocated"><span class="LIDENT">mark_allocated</span></span> <span id="local_l_15"><span class="LIDENT">l</span></span> <span id="local_i_16"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_l_15"><span class="LIDENT">l</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_a_17"><span class="LIDENT">a</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">allocate</span> <a href="#local_a_17"><span class="LIDENT">a</span></a> <a href="#local_i_16"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Min.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_157"><span class="LIDENT">constr</span> <span class="COLON">:</span> <span class="LIDENT">alloc</span> <span class="LIDENT">list</span> <span class="LIDENT">array</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span class="COMMENT">(* Constraints on variables *)</span><span class="EOL">
</span>      <span id="def_158"><span class="MUTABLE">mutable</span> <span class="LIDENT">parameters</span> <span class="COLON">:</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="LIDENT">list</span> <span class="LIDENT">array</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span class="COMMENT">(* Function parameters *)</span><span class="EOL">
</span>      <span id="def_156"><span class="MUTABLE">mutable</span> <span class="LIDENT">constraints</span> <span class="COLON">:</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* For debugging *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-create"><span class="LIDENT">create</span></span> <span id="local_nv_18"><span class="LIDENT">nv</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">constr</span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_nv_18"><span class="LIDENT">nv</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="SEMI">;</span> <span class="LIDENT">parameters</span> <span class="EQUAL">=</span> <span class="LBRACKETBAR">[|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="BARRBRACKET">|]</span><span class="SEMI">;</span> <span class="LIDENT">constraints</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-allocate_variables"><span class="LIDENT">allocate_variables</span></span> <span id="local_t_19"><span class="LIDENT">t</span></span> <span class="TILDE">~</span><span id="local_count_20"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_weight_21"><span class="LIDENT">weight</span></span> <span id="local_v_22"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="TRY">try</span> <a href="../../../ocaml-base-compiler/src/stdlib/map.ml.html#module-Make.val-find"><span class="UIDENT">IdentMap</span><span class="DOT">.</span><span class="LIDENT">find</span></a> <span class="LPAREN">(</span><span class="UIDENT">V</span> <span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">of_idx</span> <a href="#local_v_22"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_count_20"><span class="LIDENT">count</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_constr_23"><span class="LIDENT">constr</span></span> <span class="EQUAL">=</span> <a href="#local_t_19"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">constr</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_24"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_constr_23"><span class="LIDENT">constr</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_idx_25"><span class="LIDENT">idx</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_len_24"><span class="LIDENT">len</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_24"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <a href="#local_idx_25"><span class="LIDENT">idx</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">i</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-stable_sort"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">stable_sort</span></a> <a href="#local_idx_25"><span class="LIDENT">idx</span></a> <span class="LABEL">~cmp:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_26"><span class="LIDENT">i</span></span> <span id="local_j_27"><span class="LIDENT">j</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-compare"><span class="LIDENT">compare</span></a> <span class="LPAREN">(</span><a href="#local_weight_21"><span class="LIDENT">weight</span></a> <a href="#local_j_27"><span class="LIDENT">j</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_weight_21"><span class="LIDENT">weight</span></a> <a href="#local_i_26"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_name_28"><span class="LIDENT">name</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_len_24"><span class="LIDENT">len</span></a> <span class="STRING">&quot;&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n0_29"><span class="LIDENT">n0</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n1_30"><span class="LIDENT">n1</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n2_31"><span class="LIDENT">n2</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n3_32"><span class="LIDENT">n3</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_stats_33"><span class="LIDENT">stats</span></span> <span id="local_i_34"><span class="LIDENT">i</span></span> <span id="local_n_35"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n0_29"><span class="LIDENT">n0</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_n_35"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">54</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n1_30"><span class="LIDENT">n1</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_n2_31"><span class="LIDENT">n2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n2_31"><span class="LIDENT">n2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_weight_21"><span class="LIDENT">weight</span></a> <a href="#local_i_34"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_n3_32"><span class="LIDENT">n3</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n3_32"><span class="LIDENT">n3</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_weight_21"><span class="LIDENT">weight</span></a> <a href="#local_i_34"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nm_36"><span class="LIDENT">nm</span></span> <span class="TILDE">~</span><span id="local_origin_37"><span class="LIDENT">origin</span></span> <span id="local_n_38"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_n_39"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <span class="LABEL">~origin:</span><span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">of_idx</span> <a href="#local_origin_37"><span class="LIDENT">origin</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">of_idx</span> <a href="#local_n_38"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_name_28"><span class="LIDENT">name</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_origin_37"><span class="LIDENT">origin</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_39"><span class="LIDENT">n</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_total_40"><span class="LIDENT">total</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_bad_41"><span class="LIDENT">bad</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_t_19"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_t_19"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_42"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_total_40"><span class="LIDENT">total</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_idx_43"><span class="LIDENT">idx</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_x_42"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_l_44"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="#local_constr_23"><span class="LIDENT">constr</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_idx_43"><span class="LIDENT">idx</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <span class="LIDENT">is_available</span> <a href="#local_l_44"><span class="LIDENT">l</span></a> <span class="LIDENT">i</span><span class="EOL">
</span>          <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <a href="#local_nm_36"><span class="LIDENT">nm</span></a> <span class="LABEL">~origin:</span><a href="#local_idx_43"><span class="LIDENT">idx</span></a> <span class="LIDENT">i</span><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">mark_allocated</span> <a href="#local_l_44"><span class="LIDENT">l</span></a> <span class="LIDENT">i</span><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_stats_33"><span class="LIDENT">stats</span></a> <a href="#local_idx_43"><span class="LIDENT">idx</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="ELSE">else</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_bad_41"><span class="LIDENT">bad</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">debug_shortvar</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="THEN">then</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a><span class="EOL">
</span>        <span class="STRING">&quot;Function parameter properly assigned: %d/%d@.&quot;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_total_40"><span class="LIDENT">total</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_bad_41"><span class="LIDENT">bad</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_total_40"><span class="LIDENT">total</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_24"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_l_45"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="#local_constr_23"><span class="LIDENT">constr</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_idx_25"><span class="LIDENT">idx</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-List.val-is_empty"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">is_empty</span></a> <a href="#local_l_45"><span class="LIDENT">l</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_name_28"><span class="LIDENT">name</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_idx_25"><span class="LIDENT">idx</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_n_46"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">first_available</span> <a href="#local_l_45"><span class="LIDENT">l</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_idx_47"><span class="LIDENT">idx</span></span> <span class="EQUAL">=</span> <a href="#local_idx_25"><span class="LIDENT">idx</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_nm_36"><span class="LIDENT">nm</span></a> <span class="LABEL">~origin:</span><a href="#local_idx_47"><span class="LIDENT">idx</span></a> <a href="#local_n_46"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">mark_allocated</span> <a href="#local_l_45"><span class="LIDENT">l</span></a> <a href="#local_n_46"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_stats_33"><span class="LIDENT">stats</span></a> <a href="#local_idx_47"><span class="LIDENT">idx</span></a> <a href="#local_n_46"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="stdlib.ml.html#module-List.val-is_empty"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">is_empty</span></a> <a href="#local_l_45"><span class="LIDENT">l</span></a> <span class="THEN">then</span> <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="#local_weight_21"><span class="LIDENT">weight</span></a> <a href="#local_idx_25"><span class="LIDENT">idx</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">debug_shortvar</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a> <span class="STRING">&quot;short variable count: %d/%d@.&quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n1_30"><span class="LIDENT">n1</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n0_29"><span class="LIDENT">n0</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a> <span class="STRING">&quot;short variable occurrences: %d/%d@.&quot;</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n2_31"><span class="LIDENT">n2</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n3_32"><span class="LIDENT">n3</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_name_28"><span class="LIDENT">name</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-add_constraints"><span class="LIDENT">add_constraints</span></span> <span id="local_global_48"><span class="LIDENT">global</span></span> <span id="local_u_49"><span class="LIDENT">u</span></span> <span class="TILDE">~</span><span id="local_offset_50"><span class="LIDENT">offset</span></span> <span class="LPAREN">(</span><span id="local_params_51"><span class="LIDENT">params</span></span> <span class="COLON">:</span> <a href="javascript.ml.html#type-ident"><span class="LIDENT">ident</span></a> <span class="LIDENT">list</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_constr_52"><span class="LIDENT">constr</span></span> <span class="EQUAL">=</span> <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">constr</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_53"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">make_alloc_table</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">iter</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_v_54"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_55"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_v_54"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_constr_52"><span class="LIDENT">constr</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_55"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_53"><span class="LIDENT">c</span></a> <span class="COLONCOLON">::</span> <a href="#local_constr_52"><span class="LIDENT">constr</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_55"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <a href="#local_u_49"><span class="LIDENT">u</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_params_56"><span class="LIDENT">params</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-of_list"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">of_list</span></a> <a href="#local_params_51"><span class="LIDENT">params</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_57"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_params_56"><span class="LIDENT">params</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_max_58"><span class="LIDENT">len_max</span></span> <span class="EQUAL">=</span> <a href="#local_len_57"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_offset_50"><span class="LIDENT">offset</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_len_max_58"><span class="LIDENT">len_max</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_a_59"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><span class="INT">2</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="#local_len_max_58"><span class="LIDENT">len_max</span></a><span class="RPAREN">)</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-blit"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">blit</span></a><span class="EOL">
</span>        <span class="LABEL">~src:</span><a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span><span class="EOL">
</span>        <span class="LABEL">~src_pos:</span><span class="INT">0</span><span class="EOL">
</span>        <span class="LABEL">~dst:</span><a href="#local_a_59"><span class="LIDENT">a</span></a><span class="EOL">
</span>        <span class="LABEL">~dst_pos:</span><span class="INT">0</span><span class="EOL">
</span>        <span class="LABEL">~len:</span><span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-length"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_a_59"><span class="LIDENT">a</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_57"><span class="LIDENT">len</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_params_56"><span class="LIDENT">params</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_x_60"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_offset_50"><span class="LIDENT">offset</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_x_60"><span class="LIDENT">x</span></a> <span class="COLONCOLON">::</span> <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">parameters</span><span class="DOT">.</span><span class="LPAREN">(</span><span class="LIDENT">i</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_offset_50"><span class="LIDENT">offset</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">constraints</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_u_49"><span class="LIDENT">u</span></a> <span class="COLONCOLON">::</span> <a href="#local_global_48"><span class="LIDENT">global</span></a><span class="DOT">.</span><span class="LIDENT">constraints</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Min.val-record_block"><span class="LIDENT">record_block</span></span> <span id="local_state_61"><span class="LIDENT">state</span></span> <span id="local_scope_62"><span class="LIDENT">scope</span></span> <span class="LPAREN">(</span><span id="local_block_63"><span class="LIDENT">block</span></span> <span class="COLON">:</span> <a href="js_traverse.ml.html#type-block"><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">block</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_all_64"><span class="LIDENT">all</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-union"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">union</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-union"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">union</span></a> <a href="#local_scope_62"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_var</span> <a href="#local_scope_62"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_local</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_scope_62"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">use</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_all_65"><span class="LIDENT">all</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_block_63"><span class="LIDENT">block</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Normal</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_all_64"><span class="LIDENT">all</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Params</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_all_64"><span class="LIDENT">all</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Catch</span> <span class="LPAREN">(</span><span id="local_p_66"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_ids_67"><span class="LIDENT">ids</span></span> <span class="EQUAL">=</span> <a href="javascript.ml.html#val-bound_idents_of_binding"><span class="LIDENT">bound_idents_of_binding</span></a> <a href="#local_p_66"><span class="LIDENT">p</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a> <a href="#local_ids_67"><span class="LIDENT">ids</span></a> <span class="LABEL">~init:</span><a href="#local_all_64"><span class="LIDENT">all</span></a> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_all_68"><span class="LIDENT">all</span></span> <span id="local_i_69"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-add"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_i_69"><span class="LIDENT">i</span></a> <a href="#local_all_68"><span class="LIDENT">all</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_all_70"><span class="LIDENT">all</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-fold"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">fold</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_71"><span class="LIDENT">x</span></span> <span id="local_acc_72"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_x_71"><span class="LIDENT">x</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_i_73"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_i_73"><span class="LIDENT">i</span></a> <a href="#local_acc_72"><span class="LIDENT">acc</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">S</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_acc_72"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_all_65"><span class="LIDENT">all</span></a><span class="EOL">
</span>        <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_block_63"><span class="LIDENT">block</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Normal</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">add_constraints</span> <a href="#local_state_61"><span class="LIDENT">state</span></a> <a href="#local_all_70"><span class="LIDENT">all</span></a> <span class="LABEL">~offset:</span><span class="INT">0</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Catch</span> <span class="LPAREN">(</span><span id="local_v_74"><span class="LIDENT">v</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">add_constraints</span> <a href="#local_state_61"><span class="LIDENT">state</span></a> <a href="#local_all_70"><span class="LIDENT">all</span></a> <span class="LABEL">~offset:</span><span class="INT">5</span> <span class="LPAREN">(</span><a href="javascript.ml.html#val-bound_idents_of_binding"><span class="LIDENT">bound_idents_of_binding</span></a> <a href="#local_v_74"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Params</span> <span id="local_p_75"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">add_constraints</span> <a href="#local_state_61"><span class="LIDENT">state</span></a> <a href="#local_all_70"><span class="LIDENT">all</span></a> <span class="LABEL">~offset:</span><span class="INT">0</span> <span class="LPAREN">(</span><a href="javascript.ml.html#val-bound_idents_of_params"><span class="LIDENT">bound_idents_of_params</span></a> <a href="#local_p_75"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Preserve"><span class="MODULE">module</span> <span class="UIDENT">Preserve</span> <span class="COLON">:</span> <span class="UIDENT">Strategy</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span class="COMMENT">(* Try to preserve variable names.
     - Assign the origin name if present: &quot;{original_name}&quot;
     - If present but not available, derive a similar name: &quot;{original_name}${n}&quot; (eg. result$3).
     - If not present, make up a name: &quot;$${n}&quot;

     Color variables one scope/block at a time - outer scope first.
  *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Preserve.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span id="def_160"><span class="LIDENT">size</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="EOL">
</span>    <span class="SEMI">;</span></span> <span id="def_154"><span class="MUTABLE">mutable</span> <span class="LIDENT">scopes</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <a href="js_traverse.ml.html#type-t"><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="LIDENT">list</span></span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Preserve.val-create"><span class="LIDENT">create</span></span> <span id="local_size_76"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_size_76"><span class="LIDENT">size</span></a><span class="SEMI">;</span> <span class="LIDENT">scopes</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Preserve.val-record_block"><span class="LIDENT">record_block</span></span> <span id="local_t_77"><span class="LIDENT">t</span></span> <span id="local_scope_78"><span class="LIDENT">scope</span></span> <span class="LPAREN">(</span><span id="local_b_79"><span class="LIDENT">b</span></span> <span class="COLON">:</span> <a href="js_traverse.ml.html#type-block"><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">block</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_defs_80"><span class="LIDENT">defs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_b_79"><span class="LIDENT">b</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Catch</span> <span class="LPAREN">(</span><span id="local_p_81"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="javascript.ml.html#val-bound_idents_of_binding"><span class="LIDENT">bound_idents_of_binding</span></a> <a href="#local_p_81"><span class="LIDENT">p</span></a><span class="EOL">
</span>          <a href="stdlib.ml.html#val-(@)"><span class="INFIXOP1">@</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-elements"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">elements</span></a> <a href="#local_scope_78"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_local</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Normal</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-elements"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">elements</span></a> <a href="#local_scope_78"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_local</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Params</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-elements"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">elements</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-union"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">union</span></a> <a href="#local_scope_78"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_var</span> <a href="#local_scope_78"><span class="LIDENT">scope</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_local</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_defs_82"><span class="LIDENT">defs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-fold_left"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left</span></a><span class="EOL">
</span>        <span class="LABEL">~init:</span><span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="EOL">
</span>        <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_83"><span class="LIDENT">acc</span></span> <span id="local_x_84"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="MATCH">match</span> <span class="LPAREN">(</span><a href="#local_x_84"><span class="LIDENT">x</span></a> <span class="COLON">:</span> <a href="javascript.ml.html#type-ident"><span class="UIDENT">Javascript</span><span class="DOT">.</span><span class="LIDENT">ident</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_i_85"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_i_85"><span class="LIDENT">i</span></a> <a href="#local_acc_83"><span class="LIDENT">acc</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">S</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_acc_83"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_defs_80"><span class="LIDENT">defs</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <a href="#local_t_77"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">scopes</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><a href="#local_defs_82"><span class="LIDENT">defs</span></a><span class="COMMA">,</span> <a href="#local_scope_78"><span class="LIDENT">scope</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_t_77"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">scopes</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Preserve.val-allocate_variables"><span class="LIDENT">allocate_variables</span></span> <span id="local_t_86"><span class="LIDENT">t</span></span> <span class="LABEL">~count:</span><span class="UNDERSCORE">_</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_names_87"><span class="LIDENT">names</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-make"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_t_86"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">size</span> <span class="STRING">&quot;&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_t_86"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">scopes</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_defs_88"><span class="LIDENT">defs</span></span><span class="COMMA">,</span> <span id="local_state_89"><span class="LIDENT">state</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_assigned_90"><span class="LIDENT">assigned</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-fold"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">fold</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_var_91"><span class="LIDENT">var</span></span> <span id="local_acc_92"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="MATCH">match</span> <a href="#local_var_91"><span class="LIDENT">var</span></a> <span class="WITH">with</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UIDENT">S</span> <span class="LBRACE">{</span> <span class="LIDENT">name</span> <span class="EQUAL">=</span> <span class="UIDENT">Utf8</span> <span id="local_s_93"><span class="LIDENT">s</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-add"><span class="UIDENT">StringSet</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_s_93"><span class="LIDENT">s</span></a> <a href="#local_acc_92"><span class="LIDENT">acc</span></a><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_v_94"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                  <span class="LET">let</span> <span id="local_name_95"><span class="LIDENT">name</span></span> <span class="EQUAL">=</span> <a href="#local_names_87"><span class="LIDENT">names</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_v_94"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                  <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-String.val-is_empty"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">is_empty</span></a> <a href="#local_name_95"><span class="LIDENT">name</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-add"><span class="UIDENT">StringSet</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_name_95"><span class="LIDENT">name</span></a> <a href="#local_acc_92"><span class="LIDENT">acc</span></a> <span class="ELSE">else</span> <a href="#local_acc_92"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-union"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">union</span></a><span class="EOL">
</span>               <a href="#local_state_89"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">use</span><span class="EOL">
</span>               <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-union"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">union</span></a> <a href="#local_state_89"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_var</span> <a href="#local_state_89"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">def_local</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="reserved.ml.html#val-keyword"><span class="UIDENT">Reserved</span><span class="DOT">.</span><span class="LIDENT">keyword</span></a><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local__assigned_96"><span class="LIDENT">_assigned</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="UIDENT">S</span><span class="DOT">.</span><span class="LIDENT">fold</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_var_97"><span class="LIDENT">var</span></span> <span id="local_assigned_98"><span class="LIDENT">assigned</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-String.val-is_empty"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">is_empty</span></a> <a href="#local_names_87"><span class="LIDENT">names</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_var_97"><span class="LIDENT">var</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_name_99"><span class="LIDENT">name</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>                <span class="MATCH">match</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">get_name</span> <a href="#local_var_97"><span class="LIDENT">var</span></a> <span class="WITH">with</span><span class="EOL">
</span>                <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_expected_name_100"><span class="LIDENT">expected_name</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                    <span class="ASSERT">assert</span> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-String.val-is_empty"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">is_empty</span></a> <a href="#local_expected_name_100"><span class="LIDENT">expected_name</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>                    <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-mem"><span class="UIDENT">StringSet</span><span class="DOT">.</span><span class="LIDENT">mem</span></a> <a href="#local_expected_name_100"><span class="LIDENT">expected_name</span></a> <a href="#local_assigned_98"><span class="LIDENT">assigned</span></a><span class="RPAREN">)</span><span class="EOL">
</span>                    <span class="THEN">then</span> <a href="#local_expected_name_100"><span class="LIDENT">expected_name</span></a><span class="EOL">
</span>                    <span class="ELSE">else</span><span class="EOL">
</span>                      <span class="LET">let</span> <span id="local_i_101"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>                      <span class="WHILE">while</span><span class="EOL">
</span>                        <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-mem"><span class="UIDENT">StringSet</span><span class="DOT">.</span><span class="LIDENT">mem</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s$%d&quot;</span> <a href="#local_expected_name_100"><span class="LIDENT">expected_name</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_101"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_assigned_98"><span class="LIDENT">assigned</span></a><span class="EOL">
</span>                      <span class="DO">do</span><span class="EOL">
</span>                        <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_101"><span class="LIDENT">i</span></a><span class="EOL">
</span>                      <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>                      <a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;%s$%d&quot;</span> <a href="#local_expected_name_100"><span class="LIDENT">expected_name</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_101"><span class="LIDENT">i</span></a><span class="EOL">
</span>                <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_var_97"><span class="LIDENT">var</span></a><span class="EOL">
</span>              <span class="IN">in</span><span class="EOL">
</span>              <a href="#local_names_87"><span class="LIDENT">names</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_var_97"><span class="LIDENT">var</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_name_99"><span class="LIDENT">name</span></a><span class="SEMI">;</span><span class="EOL">
</span>              <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-add"><span class="UIDENT">StringSet</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_name_99"><span class="LIDENT">name</span></a> <a href="#local_assigned_98"><span class="LIDENT">assigned</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <a href="#local_defs_88"><span class="LIDENT">defs</span></a><span class="EOL">
</span>            <a href="#local_assigned_90"><span class="LIDENT">assigned</span></a><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_names_87"><span class="LIDENT">names</span></a><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="CLASS">class</span> <span id="class-traverse"><span class="LIDENT">traverse</span></span> <span id="local_record_block_102"><span class="LIDENT">record_block</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="OBJECT">object</span> <span class="LPAREN">(</span><span id="local_m_103"><span class="LIDENT">m</span></span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INHERIT">inherit</span> <span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">free</span> <span class="AS">as</span> <span class="LIDENT">super</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span><span class="BANG">!</span> <span class="LIDENT">record_block</span> <span id="local_b_104"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">record_block</span> <span class="LIDENT">m</span><span class="HASH">#</span><span class="LIDENT">state</span> <a href="#local_b_104"><span class="LIDENT">b</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">super</span><span class="HASH">#</span><span class="LIDENT">record_block</span> <a href="#local_b_104"><span class="LIDENT">b</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="CLASS">class</span> <span id="class-traverse_labels"><span class="LIDENT">traverse_labels</span></span> <span id="local_h_105"><span class="LIDENT">h</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="OBJECT">object</span><span class="EOL">
</span>    <span class="INHERIT">inherit</span> <span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">iter</span> <span class="AS">as</span> <span class="LIDENT">super</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="VAL">val</span> <span class="LIDENT">ldepth</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">fun_decl</span> <span class="LPAREN">(</span><span id="local__k_106"><span class="LIDENT">_k</span></span><span class="COMMA">,</span> <span id="local__params_107"><span class="LIDENT">_params</span></span><span class="COMMA">,</span> <span id="local_body_108"><span class="LIDENT">body</span></span><span class="COMMA">,</span> <span id="local__loc_109"><span class="LIDENT">_loc</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_m_110"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span> <span class="LBRACELESS">{&lt;</span><span class="LIDENT">ldepth</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="GREATERRBRACE">&gt;}</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_m_110"><span class="LIDENT">m</span></a><span class="HASH">#</span><span class="LIDENT">function_body</span> <a href="#local_body_108"><span class="LIDENT">body</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">statement</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Labelled_statement</span> <span class="LPAREN">(</span><span class="UIDENT">L</span> <span id="local_l_111"><span class="LIDENT">l</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span id="local_s_112"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_m_113"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span> <span class="LBRACELESS">{&lt;</span><span class="LIDENT">ldepth</span> <span class="EQUAL">=</span> <span class="LIDENT">ldepth</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="GREATERRBRACE">&gt;}</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-add"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <span class="LIDENT">h</span> <a href="#local_l_111"><span class="LIDENT">l</span></a> <span class="LIDENT">ldepth</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="#local_m_113"><span class="LIDENT">m</span></a><span class="HASH">#</span><span class="LIDENT">statement</span> <a href="#local_s_112"><span class="LIDENT">s</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_s_114"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">super</span><span class="HASH">#</span><span class="LIDENT">statement</span> <a href="#local_s_114"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="CLASS">class</span> <span id="class-name"><span class="LIDENT">name</span></span> <span id="local_ident_115"><span class="LIDENT">ident</span></span> <span id="local_label_116"><span class="LIDENT">label</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="OBJECT">object</span> <span class="LPAREN">(</span><span id="local_m_117"><span class="LIDENT">m</span></span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="INHERIT">inherit</span> <span class="UIDENT">Js_traverse</span><span class="DOT">.</span><span class="LIDENT">subst</span> <a href="#local_ident_115"><span class="LIDENT">ident</span></a> <span class="AS">as</span> <span class="LIDENT">super</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="METHOD">method</span> <span class="LIDENT">statement</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Labelled_statement</span> <span class="LPAREN">(</span><span id="local_l_118"><span class="LIDENT">l</span></span><span class="COMMA">,</span> <span class="LPAREN">(</span><span id="local_s_119"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_loc_120"><span class="LIDENT">loc</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="UIDENT">Labelled_statement</span> <span class="LPAREN">(</span><span class="LIDENT">label</span> <a href="#local_l_118"><span class="LIDENT">l</span></a><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="LIDENT">m</span><span class="HASH">#</span><span class="LIDENT">statement</span> <a href="#local_s_119"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_loc_120"><span class="LIDENT">loc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Break_statement</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span id="local_l_121"><span class="LIDENT">l</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Break_statement</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">label</span> <a href="#local_l_121"><span class="LIDENT">l</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Continue_statement</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span id="local_l_122"><span class="LIDENT">l</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Continue_statement</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="LIDENT">label</span> <a href="#local_l_122"><span class="LIDENT">l</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_s_123"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">super</span><span class="HASH">#</span><span class="LIDENT">statement</span> <a href="#local_s_123"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-program'"><span class="LIDENT">program'</span></span> <span class="LPAREN">(</span><span class="MODULE">module</span> <span id="local_Strategy_124"><span class="UIDENT">Strategy</span></span> <span class="COLON">:</span> <span class="UIDENT">Strategy</span><span class="RPAREN">)</span> <span id="local_p_125"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_nv_126"><span class="LIDENT">nv</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">count</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_state_127"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Strategy</span><span class="DOT">.</span><span class="LIDENT">create</span> <a href="#local_nv_126"><span class="LIDENT">nv</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_labels_128"><span class="LIDENT">labels</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-create"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">20</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_mapper_129"><span class="LIDENT">mapper</span></span> <span class="EQUAL">=</span> <span class="NEW">new</span> <span class="LIDENT">traverse</span> <span class="LPAREN">(</span><span class="UIDENT">Strategy</span><span class="DOT">.</span><span class="LIDENT">record_block</span> <a href="#local_state_127"><span class="LIDENT">state</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_p_130"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <a href="#local_mapper_129"><span class="LIDENT">mapper</span></a><span class="HASH">#</span><span class="LIDENT">program</span> <a href="#local_p_125"><span class="LIDENT">p</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_o_131"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span> <span class="NEW">new</span> <span class="LIDENT">traverse_labels</span> <a href="#local_labels_128"><span class="LIDENT">labels</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_o_131"><span class="LIDENT">o</span></a><span class="HASH">#</span><span class="LIDENT">program</span> <a href="#local_p_130"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_mapper_129"><span class="LIDENT">mapper</span></a><span class="HASH">#</span><span class="LIDENT">record_block</span> <span class="UIDENT">Normal</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_free_132"><span class="LIDENT">free</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-filter"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">filter</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">V</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">S</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="EOL">
</span>      <a href="#local_mapper_129"><span class="LIDENT">mapper</span></a><span class="HASH">#</span><span class="LIDENT">get_free</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_has_free_var_133"><span class="LIDENT">has_free_var</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-cardinal"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">cardinal</span></a> <a href="#local_free_132"><span class="LIDENT">free</span></a> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_unallocated_names_134"><span class="LIDENT">unallocated_names</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="UIDENT">Set</span><span class="DOT">.</span><span class="LIDENT">empty</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_names_135"><span class="LIDENT">names</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Strategy</span><span class="DOT">.</span><span class="LIDENT">allocate_variables</span> <a href="#local_state_127"><span class="LIDENT">state</span></a> <span class="LABEL">~count:</span><a href="#local_mapper_129"><span class="LIDENT">mapper</span></a><span class="HASH">#</span><span class="LIDENT">get_count</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* ignore the choosen name for escaping/free [V _] variables *)</span><span class="EOL">
</span>  <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-iter"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">S</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_x_136"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_names_135"><span class="LIDENT">names</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_x_136"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="LESSMINUS">&lt;-</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span><span class="EOL">
</span>    <a href="#local_free_132"><span class="LIDENT">free</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ident_137"><span class="LIDENT">ident</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_v_138"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="config.ml.html#module-Flag.val-stable_var"><span class="UIDENT">Config</span><span class="DOT">.</span><span class="UIDENT">Flag</span><span class="DOT">.</span><span class="LIDENT">stable_var</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span><span class="EOL">
</span>          <a href="javascript.ml.html#val-ident"><span class="LIDENT">ident</span></a> <span class="LABEL">~var:</span><a href="#local_v_138"><span class="LIDENT">v</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-Utf8_string.val-of_string_exn"><span class="UIDENT">Utf8_string</span><span class="DOT">.</span><span class="LIDENT">of_string_exn</span></a> <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;v%d&quot;</span> <span class="LPAREN">(</span><a href="code.ml.html#module-Var.val-idx"><span class="UIDENT">Code</span><span class="DOT">.</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span></a> <a href="#local_v_138"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_name_139"><span class="LIDENT">name</span></span> <span class="EQUAL">=</span> <a href="#local_names_135"><span class="LIDENT">names</span></a><span class="DOT">.</span><span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">idx</span> <a href="#local_v_138"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_name_139"><span class="LIDENT">name</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="STRING">&quot;&quot;</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <a href="#local_unallocated_names_134"><span class="LIDENT">unallocated_names</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="UIDENT">Set</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_v_138"><span class="LIDENT">v</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_unallocated_names_134"><span class="LIDENT">unallocated_names</span></a><span class="SEMI">;</span><span class="EOL">
</span>              <span class="UIDENT">V</span> <a href="#local_v_138"><span class="LIDENT">v</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="javascript.ml.html#val-ident"><span class="LIDENT">ident</span></a> <span class="LABEL">~var:</span><a href="#local_v_138"><span class="LIDENT">v</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-Utf8_string.val-of_string_exn"><span class="UIDENT">Utf8_string</span><span class="DOT">.</span><span class="LIDENT">of_string_exn</span></a> <a href="#local_name_139"><span class="LIDENT">name</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_x_140"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_140"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_label_printer_141"><span class="LIDENT">label_printer</span></span> <span class="EQUAL">=</span> <a href="var_printer.ml.html#val-create"><span class="UIDENT">Var_printer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="var_printer.ml.html#module-Alphabet.val-javascript"><span class="UIDENT">Var_printer</span><span class="DOT">.</span><span class="UIDENT">Alphabet</span><span class="DOT">.</span><span class="LIDENT">javascript</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_label_depth_142"><span class="LIDENT">max_label_depth</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-fold"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">fold</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span id="local_d_143"><span class="LIDENT">d</span></span> <span id="local_acc_144"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-max"><span class="LIDENT">max</span></a> <a href="#local_d_143"><span class="LIDENT">d</span></a> <a href="#local_acc_144"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span> <a href="#local_labels_128"><span class="LIDENT">labels</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_lname_per_depth_145"><span class="LIDENT">lname_per_depth</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="../../../ocaml-base-compiler/src/stdlib/array.ml.html#val-init"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">init</span></a> <span class="LPAREN">(</span><a href="#local_max_label_depth_142"><span class="LIDENT">max_label_depth</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LABEL">~f:</span><span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_146"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="var_printer.ml.html#val-to_string"><span class="UIDENT">Var_printer</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_label_printer_141"><span class="LIDENT">label_printer</span></a> <a href="#local_i_146"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_label_147"><span class="LIDENT">label</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Label</span><span class="DOT">.</span><span class="UIDENT">S</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_l_148"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_l_148"><span class="LIDENT">l</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">L</span> <span id="local_v_149"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_i_150"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="../../../ocaml-base-compiler/src/stdlib/hashtbl.ml.html#val-find"><span class="UIDENT">Hashtbl</span><span class="DOT">.</span><span class="LIDENT">find</span></a> <a href="#local_labels_128"><span class="LIDENT">labels</span></a> <a href="#local_v_149"><span class="LIDENT">v</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">S</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#module-Utf8_string.val-of_string_exn"><span class="UIDENT">Utf8_string</span><span class="DOT">.</span><span class="LIDENT">of_string_exn</span></a> <a href="#local_lname_per_depth_145"><span class="LIDENT">lname_per_depth</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="#local_i_150"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_p_151"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="NEW">new</span> <span class="LIDENT">name</span> <a href="#local_ident_137"><span class="LIDENT">ident</span></a> <a href="#local_label_147"><span class="LIDENT">label</span></a><span class="RPAREN">)</span><span class="HASH">#</span><span class="LIDENT">program</span> <a href="#local_p_130"><span class="LIDENT">p</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_has_free_var_133"><span class="LIDENT">has_free_var</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Var</span><span class="DOT">.</span><span class="UIDENT">Set</span><span class="DOT">.</span><span class="LIDENT">cardinal</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_unallocated_names_134"><span class="LIDENT">unallocated_names</span></a> <a href="stdlib.ml.html#module-Int_replace_polymorphic_compare.val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span>   <span class="THEN">then</span><span class="EOL">
</span>     <span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>       <span class="IF">if</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">debug_shortvar</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">debug</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="THEN">then</span><span class="EOL">
</span>         <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a><span class="EOL">
</span>           <span class="STRING">&quot;Some variables escaped (#%d). Use [--debug js_assign] for more info.@.&quot;</span><span class="EOL">
</span>           <span class="LPAREN">(</span><a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-cardinal"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">cardinal</span></a> <a href="#local_free_132"><span class="LIDENT">free</span></a><span class="RPAREN">)</span><span class="EOL">
</span>       <span class="ELSE">else</span><span class="EOL">
</span>         <span class="LET">let</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span> <span class="COLON">:</span> <a href="source_map.ml.html#type-t"><span class="UIDENT">Source_map</span><span class="DOT">.</span><span class="LIDENT">t</span></a> <span class="LIDENT">option</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>           <a href="js_output.ml.html#val-program"><span class="UIDENT">Js_output</span><span class="DOT">.</span><span class="LIDENT">program</span></a><span class="EOL">
</span>             <span class="LABEL">~accept_unnamed_var:</span><span class="TRUE">true</span><span class="EOL">
</span>             <span class="LPAREN">(</span><a href="pretty_print.ml.html#val-to_out_channel"><span class="UIDENT">Pretty_print</span><span class="DOT">.</span><span class="LIDENT">to_out_channel</span></a> <a href="../../../ocaml-base-compiler/src/stdlib/stdlib.ml.html#val-stderr"><span class="LIDENT">stderr</span></a><span class="RPAREN">)</span><span class="EOL">
</span>             <a href="#local_p_151"><span class="LIDENT">p</span></a><span class="EOL">
</span>         <span class="IN">in</span><span class="EOL">
</span>         <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a> <span class="STRING">&quot;Some variables escaped:&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>         <a href="../../../ocaml-base-compiler/src/stdlib/set.ml.html#module-Make.val-iter"><span class="UIDENT">IdentSet</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>           <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>             <span class="BAR">|</span> <span class="UIDENT">S</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>             <span class="BAR">|</span> <span class="UIDENT">V</span> <span id="local_v_152"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a> <span class="STRING">&quot; &lt;%s&gt;&quot;</span> <span class="LPAREN">(</span><span class="UIDENT">Var</span><span class="DOT">.</span><span class="LIDENT">to_string</span> <a href="#local_v_152"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>           <a href="#local_free_132"><span class="LIDENT">free</span></a><span class="SEMI">;</span><span class="EOL">
</span>         <a href="../../../ocaml-base-compiler/src/stdlib/format.ml.html#val-eprintf"><span class="UIDENT">Format</span><span class="DOT">.</span><span class="LIDENT">eprintf</span></a> <span class="STRING">&quot;@.&quot;</span><span class="EOL">
</span>     <span class="IN">in</span><span class="EOL">
</span>     <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_p_151"><span class="LIDENT">p</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-program"><span class="LIDENT">program</span></span> <span id="local_p_153"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="config.ml.html#module-Flag.val-shortvar"><span class="UIDENT">Config</span><span class="DOT">.</span><span class="UIDENT">Flag</span><span class="DOT">.</span><span class="LIDENT">shortvar</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">program'</span> <span class="LPAREN">(</span><span class="MODULE">module</span> <span class="UIDENT">Min</span><span class="RPAREN">)</span> <a href="#local_p_153"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">program'</span> <span class="LPAREN">(</span><span class="MODULE">module</span> <span class="UIDENT">Preserve</span><span class="RPAREN">)</span> <a href="#local_p_153"><span class="LIDENT">p</span></a><span class="EOL">
</span></span></code></pre></body></html>
