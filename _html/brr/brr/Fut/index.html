<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Fut (brr.brr.Fut)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../sherlodoc_db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../../index.html">Up</a> ‚Äì <a href="../../../index.html">üè†</a> &#x00BB; <a href="../../index.html">Brr  <span class="version">v0.0.7</span></a> &#x00BB; Library <code>brr</code> &#x00BB; Fut</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="üîé Type '/' to search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Fut</span></code></h1><p>Future values.</p><p>A future <code>'a Fut.t</code> is an undetermined value of type <code>'a</code> that becomes determined at an arbitrary point in the future. The future acts as a placeholder for the value while it is undetermined.</p><p>Future values do not support exceptions, you need to turn them into a value and make them appear in the future's type, for example using <a href="#val-error"><code>Fut.error</code></a>.</p><p><code>Brr</code> uses future values <code>('a, 'b) result Fut.t</code> to type the resolution and rejection case of JavaScript promises. Since most rejection cases given by browser APIs are simply <a href="../Jv/Error/index.html#type-t"><code>Jv.Error.t</code></a> values, the dedicated <a href="#type-or_error"><code>Fut.or_error</code></a> type alias can be used for that.</p><p><a href="#type-t"><code>Fut.t</code></a> values are <em>indirectly</em> implemented as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> objects that never reject. You can't substitute them directly for JavaScript promises and vice-versa, use <a href="#val-of_promise"><code>of_promise</code></a> and <a href="#val-to_promise"><code>to_promise</code></a> to convert between them.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#futs">Futures</a></li><li><a href="#fut">Future results</a></li><li><a href="#promises">Converting with JavaScript promises</a></li><li><a href="#syntax">Future syntaxes</a></li></ul></nav><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">Brr  <span class="version">v0.0.7</span></a><ul><li><a href="../../ffi_cookbook.html">Brr FFI cookbook</a></li><li><a href="../../ffi_manual.html">Brr FFI manual</a></li><li><a href="../../ocaml_console.html">OCaml console</a></li><li><a href="../../web_page_howto.html">Web page howto</a></li><li>Library <code>brr</code><ul><li><a href="../Brr/index.html">Brr</a></li><li><a href="../Brr_canvas/index.html">Brr_canvas</a></li><li><a href="../Brr_io/index.html">Brr_io</a></li><li><a href="../Brr_webaudio/index.html">Brr_webaudio</a></li><li><a href="../Brr_webcrypto/index.html">Brr_webcrypto</a></li><li><a href="../Brr_webgpu/index.html">Brr_webgpu</a></li><li><a href="../Brr_webmidi/index.html">Brr_webmidi</a></li><li><a href="../Brr_webworkers/index.html">Brr_webworkers</a></li><li><a href="#" class="current_unit">Fut</a><ul><li><a href="Syntax/index.html">Syntax</a></li><li><a href="Result_syntax/index.html">Result_syntax</a></li></ul></li><li><a href="../Jstr/index.html">Jstr</a></li><li><a href="../Jv/index.html">Jv</a></li></ul></li><li>Library <code>brr.ocaml_poke</code><ul><li><a href="../../brr.ocaml_poke/Brr_ocaml_poke/index.html">Brr_ocaml_poke</a></li></ul></li><li>Library <code>brr.ocaml_poke_ui</code><ul><li><a href="../../brr.ocaml_poke_ui/Brr_ocaml_poke_ui/index.html">Brr_ocaml_poke_ui</a></li></ul></li><li>Library <code>brr.poke</code><ul><li><a href="../../brr.poke/Brr_poke/index.html">Brr_poke</a></li></ul></li><li>Library <code>brr.poked</code><ul><li><a href="../../brr.poked/Brr_poked/index.html">Brr_poked</a></li></ul></li></ul></li></ul></nav></div><div class="odoc-content"><h2 id="futs"><a href="#futs" class="anchor"></a>Futures</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type for futures with value of type <code>'a</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> * <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span></span></code></div><div class="spec-doc"><p><code>create ()</code> is <code>(f, set</code> with <code>f</code> the future value and <code>set</code> the function to <code>set</code> it. The latter can be called only once, a <a href="../Jv/index.html#exception-Error"><code>Jv.Error</code></a> is thrown otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-await"><a href="#val-await" class="anchor"></a><code><span><span class="keyword">val</span> await : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>await f k</code> waits for <code>f</code> to determine <code>v</code> and continues with <code>k v</code>. If the future never determines <code>k</code> is not invoked. <code>k</code> must not raise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-return"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>return v</code> is a future that determines <code>v</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map fn f</code> is <code>return (fn v)</code> with <code>v</code> the value determined by <code>f</code>. <code>fn</code> must not raise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bind"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bind f fn</code> is the future <code>fn v</code> with <code>v</code> the value determined by <code>f</code>. <code>fn</code> must not raise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pair"><a href="#val-pair" class="anchor"></a><code><span><span class="keyword">val</span> pair : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>pair f0 f1</code> is the future that determines with the value of <code>f0</code> and <code>f1</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_list"><a href="#val-of_list" class="anchor"></a><code><span><span class="keyword">val</span> of_list : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_list fs</code> determines with the values of all future <code>fs</code> in the same order.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tick"><a href="#val-tick" class="anchor"></a><code><span><span class="keyword">val</span> tick : <span><span class="label">ms</span>:int <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>tick ~ms</code> determines <code>()</code> <code>ms</code> milliseconds after creation using <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout"><code>setTimeout</code></a>.</p></div></div><h2 id="fut"><a href="#fut" class="anchor"></a>Future results</h2><div class="odoc-spec"><div class="spec type anchored" id="type-result"><a href="#type-result" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> <span>('a, 'b) result</span></span><span> = <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../../../ocaml-base-compiler/stdlib/Stdlib/index.html#type-result">result</a></span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>The type for future values that may error.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-or_error"><a href="#type-or_error" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a or_error</span></span><span> = <span><span>(<span class="type-var">'a</span>, <a href="../Jv/Error/index.html#type-t">Jv.Error.t</a>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p>The type for future values that error with a JavaScript error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ok"><a href="#val-ok" class="anchor"></a><code><span><span class="keyword">val</span> ok : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>ok v</code> is <code>return (Ok v)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-error"><a href="#val-error" class="anchor"></a><code><span><span class="keyword">val</span> error : <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>error e</code> is <code>return (Error e)</code>.</p></div></div><h2 id="promises"><a href="#promises" class="anchor"></a>Converting with JavaScript promises</h2><div class="odoc-spec"><div class="spec value anchored" id="val-of_promise"><a href="#val-of_promise" class="anchor"></a><code><span><span class="keyword">val</span> of_promise : <span><span class="label">ok</span>:<span>(<span><a href="../Jv/index.html#type-t">Jv.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-or_error">or_error</a></span></span></code></div><div class="spec-doc"><p><code>of_promise ~ok p</code> is <code>of_promise' ~ok ~error:Jv.to_error. p</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_promise"><a href="#val-to_promise" class="anchor"></a><code><span><span class="keyword">val</span> to_promise : <span><span class="label">ok</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/index.html#type-t">Jv.t</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-or_error">or_error</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a></span></code></div><div class="spec-doc"><p><code>to_promise p</code> is <code>to_promise' ~ok ~error:Jv.of_error p</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_promise'"><a href="#val-of_promise'" class="anchor"></a><code><span><span class="keyword">val</span> of_promise' : 
  <span><span class="label">ok</span>:<span>(<span><a href="../Jv/index.html#type-t">Jv.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">error</span>:<span>(<span><a href="../Jv/index.html#type-t">Jv.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>of_promise ~ok ~error p</code> is a future for the promise <code>p</code>. The future determines with <code>Ok (ok v)</code> if <code>p</code> resolves with <code>v</code> and with <code>Error (error e)</code> if <code>p</code> rejects with <code>e</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_promise'"><a href="#val-to_promise'" class="anchor"></a><code><span><span class="keyword">val</span> to_promise' : 
  <span><span class="label">ok</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/index.html#type-t">Jv.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">error</span>:<span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/index.html#type-t">Jv.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a></span></code></div><div class="spec-doc"><p><code>to_promise f</code> is a JavaScript promise for the future <code>f</code> that resolves the promise with <code>ok v</code> if the future determines with <code>Ok v</code> and rejects with <code>e</code> if the future determines with <code>Error e</code>.</p></div></div><h2 id="syntax"><a href="#syntax" class="anchor"></a>Future syntaxes</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Syntax"><a href="#module-Syntax" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Syntax/index.html">Syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Future syntax.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Result_syntax"><a href="#module-Result_syntax" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Result_syntax/index.html">Result_syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Future result syntax.</p></div></div></div></body></html>
