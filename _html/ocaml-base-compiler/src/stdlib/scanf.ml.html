<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: scanf.ml (ocaml-base-compiler.src.stdlib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocaml-base-compiler</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; stdlib &#x00BB; scanf.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>scanf.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocaml-base-compiler</a><ul><li>Library <code>compiler-libs.bytecomp</code><ul><li><a href="../../compiler-libs.bytecomp/Bytegen/index.html">Bytegen</a></li><li><a href="../../compiler-libs.bytecomp/Bytelibrarian/index.html">Bytelibrarian</a></li><li><a href="../../compiler-libs.bytecomp/Bytelink/index.html">Bytelink</a></li><li><a href="../../compiler-libs.bytecomp/Bytepackager/index.html">Bytepackager</a></li><li><a href="../../compiler-libs.bytecomp/Compile/index.html">Compile</a></li><li><a href="../../compiler-libs.bytecomp/Emitcode/index.html">Emitcode</a></li><li><a href="../../compiler-libs.bytecomp/Errors/index.html">Errors</a></li><li><a href="../../compiler-libs.bytecomp/Instruct/index.html">Instruct</a></li><li><a href="../../compiler-libs.bytecomp/Maindriver/index.html">Maindriver</a></li><li><a href="../../compiler-libs.bytecomp/Printinstr/index.html">Printinstr</a></li></ul></li><li>Library <code>compiler-libs.common</code><ul><li><a href="../../compiler-libs.common/Annot/index.html">Annot</a></li><li><a href="../../compiler-libs.common/Arg_helper/index.html">Arg_helper</a></li><li><a href="../../compiler-libs.common/Ast_helper/index.html">Ast_helper</a></li><li><a href="../../compiler-libs.common/Ast_invariants/index.html">Ast_invariants</a></li><li><a href="../../compiler-libs.common/Ast_iterator/index.html">Ast_iterator</a></li><li><a href="../../compiler-libs.common/Ast_mapper/index.html">Ast_mapper</a></li><li><a href="../../compiler-libs.common/Asttypes/index.html">Asttypes</a></li><li><a href="../../compiler-libs.common/Attr_helper/index.html">Attr_helper</a></li><li><a href="../../compiler-libs.common/Binutils/index.html">Binutils</a></li><li><a href="../../compiler-libs.common/Btype/index.html">Btype</a></li><li><a href="../../compiler-libs.common/Build_path_prefix_map/index.html">Build_path_prefix_map</a></li><li><a href="../../compiler-libs.common/Builtin_attributes/index.html">Builtin_attributes</a></li><li><a href="../../compiler-libs.common/Bytesections/index.html">Bytesections</a></li><li><a href="../../compiler-libs.common/CamlinternalMenhirLib/index.html">CamlinternalMenhirLib</a></li><li><a href="../../compiler-libs.common/Ccomp/index.html">Ccomp</a></li><li><a href="../../compiler-libs.common/Clflags/index.html">Clflags</a></li><li><a href="../../compiler-libs.common/Cmi_format/index.html">Cmi_format</a></li><li><a href="../../compiler-libs.common/Cmo_format/index.html">Cmo_format</a></li><li><a href="../../compiler-libs.common/Cmt2annot/index.html">Cmt2annot</a></li><li><a href="../../compiler-libs.common/Cmt_format/index.html">Cmt_format</a></li><li><a href="../../compiler-libs.common/Compenv/index.html">Compenv</a></li><li><a href="../../compiler-libs.common/Compile_common/index.html">Compile_common</a></li><li><a href="../../compiler-libs.common/Compmisc/index.html">Compmisc</a></li><li><a href="../../compiler-libs.common/Compression/index.html">Compression</a></li><li><a href="../../compiler-libs.common/Config/index.html">Config</a></li><li><a href="../../compiler-libs.common/Config_boot/index.html">Config_boot</a></li><li><a href="../../compiler-libs.common/Config_main/index.html">Config_main</a></li><li><a href="../../compiler-libs.common/Consistbl/index.html">Consistbl</a></li><li><a href="../../compiler-libs.common/Ctype/index.html">Ctype</a></li><li><a href="../../compiler-libs.common/Datarepr/index.html">Datarepr</a></li><li><a href="../../compiler-libs.common/Debuginfo/index.html">Debuginfo</a></li><li><a href="../../compiler-libs.common/Depend/index.html">Depend</a></li><li><a href="../../compiler-libs.common/Diffing/index.html">Diffing</a></li><li><a href="../../compiler-libs.common/Diffing_with_keys/index.html">Diffing_with_keys</a></li><li><a href="../../compiler-libs.common/Dll/index.html">Dll</a></li><li><a href="../../compiler-libs.common/Docstrings/index.html">Docstrings</a></li><li><a href="../../compiler-libs.common/Domainstate/index.html">Domainstate</a></li><li><a href="../../compiler-libs.common/Env/index.html">Env</a></li><li><a href="../../compiler-libs.common/Envaux/index.html">Envaux</a></li><li><a href="../../compiler-libs.common/Errortrace/index.html">Errortrace</a></li><li><a href="../../compiler-libs.common/Expunge/index.html">Expunge</a></li><li><a href="../../compiler-libs.common/Ident/index.html">Ident</a></li><li><a href="../../compiler-libs.common/Identifiable/index.html">Identifiable</a></li><li><a href="../../compiler-libs.common/Includeclass/index.html">Includeclass</a></li><li><a href="../../compiler-libs.common/Includecore/index.html">Includecore</a></li><li><a href="../../compiler-libs.common/Includemod/index.html">Includemod</a></li><li><a href="../../compiler-libs.common/Includemod_errorprinter/index.html">Includemod_errorprinter</a></li><li><a href="../../compiler-libs.common/Int_replace_polymorphic_compare/index.html">Int_replace_polymorphic_compare</a></li><li><a href="../../compiler-libs.common/Lambda/index.html">Lambda</a></li><li><a href="../../compiler-libs.common/Lazy_backtrack/index.html">Lazy_backtrack</a></li><li><a href="../../compiler-libs.common/Lexer/index.html">Lexer</a></li><li><a href="../../compiler-libs.common/Load_path/index.html">Load_path</a></li><li><a href="../../compiler-libs.common/Local_store/index.html">Local_store</a></li><li><a href="../../compiler-libs.common/Location/index.html">Location</a></li><li><a href="../../compiler-libs.common/Longident/index.html">Longident</a></li><li><a href="../../compiler-libs.common/Main_args/index.html">Main_args</a></li><li><a href="../../compiler-libs.common/Makedepend/index.html">Makedepend</a></li><li><a href="../../compiler-libs.common/Matching/index.html">Matching</a></li><li><a href="../../compiler-libs.common/Meta/index.html">Meta</a></li><li><a href="../../compiler-libs.common/Misc/index.html">Misc</a></li><li><a href="../../compiler-libs.common/Mtype/index.html">Mtype</a></li><li><a href="../../compiler-libs.common/Numbers/index.html">Numbers</a></li><li><a href="../../compiler-libs.common/Opcodes/index.html">Opcodes</a></li><li><a href="../../compiler-libs.common/Oprint/index.html">Oprint</a></li><li><a href="../../compiler-libs.common/Outcometree/index.html">Outcometree</a></li><li><a href="../../compiler-libs.common/Parmatch/index.html">Parmatch</a></li><li><a href="../../compiler-libs.common/Parse/index.html">Parse</a></li><li><a href="../../compiler-libs.common/Parser/index.html">Parser</a></li><li><a href="../../compiler-libs.common/Parsetree/index.html">Parsetree</a></li><li><a href="../../compiler-libs.common/Path/index.html">Path</a></li><li><a href="../../compiler-libs.common/Patterns/index.html">Patterns</a></li><li><a href="../../compiler-libs.common/Persistent_env/index.html">Persistent_env</a></li><li><a href="../../compiler-libs.common/Pparse/index.html">Pparse</a></li><li><a href="../../compiler-libs.common/Pprintast/index.html">Pprintast</a></li><li><a href="../../compiler-libs.common/Predef/index.html">Predef</a></li><li><a href="../../compiler-libs.common/Primitive/index.html">Primitive</a></li><li><a href="../../compiler-libs.common/Printast/index.html">Printast</a></li><li><a href="../../compiler-libs.common/Printlambda/index.html">Printlambda</a></li><li><a href="../../compiler-libs.common/Printpat/index.html">Printpat</a></li><li><a href="../../compiler-libs.common/Printtyp/index.html">Printtyp</a></li><li><a href="../../compiler-libs.common/Printtyped/index.html">Printtyped</a></li><li><a href="../../compiler-libs.common/Profile/index.html">Profile</a></li><li><a href="../../compiler-libs.common/Runtimedef/index.html">Runtimedef</a></li><li><a href="../../compiler-libs.common/Shape/index.html">Shape</a></li><li><a href="../../compiler-libs.common/Shape_reduce/index.html">Shape_reduce</a></li><li><a href="../../compiler-libs.common/Signature_group/index.html">Signature_group</a></li><li><a href="../../compiler-libs.common/Simplif/index.html">Simplif</a></li><li><a href="../../compiler-libs.common/Strongly_connected_components/index.html">Strongly_connected_components</a></li><li><a href="../../compiler-libs.common/Stypes/index.html">Stypes</a></li><li><a href="../../compiler-libs.common/Subst/index.html">Subst</a></li><li><a href="../../compiler-libs.common/Switch/index.html">Switch</a></li><li><a href="../../compiler-libs.common/Symtable/index.html">Symtable</a></li><li><a href="../../compiler-libs.common/Syntaxerr/index.html">Syntaxerr</a></li><li><a href="../../compiler-libs.common/Targetint/index.html">Targetint</a></li><li><a href="../../compiler-libs.common/Tast_iterator/index.html">Tast_iterator</a></li><li><a href="../../compiler-libs.common/Tast_mapper/index.html">Tast_mapper</a></li><li><a href="../../compiler-libs.common/Terminfo/index.html">Terminfo</a></li><li><a href="../../compiler-libs.common/Tmc/index.html">Tmc</a></li><li><a href="../../compiler-libs.common/Translattribute/index.html">Translattribute</a></li><li><a href="../../compiler-libs.common/Translclass/index.html">Translclass</a></li><li><a href="../../compiler-libs.common/Translcore/index.html">Translcore</a></li><li><a href="../../compiler-libs.common/Translmod/index.html">Translmod</a></li><li><a href="../../compiler-libs.common/Translobj/index.html">Translobj</a></li><li><a href="../../compiler-libs.common/Translprim/index.html">Translprim</a></li><li><a href="../../compiler-libs.common/Type_immediacy/index.html">Type_immediacy</a></li><li><a href="../../compiler-libs.common/Typeclass/index.html">Typeclass</a></li><li><a href="../../compiler-libs.common/Typecore/index.html">Typecore</a></li><li><a href="../../compiler-libs.common/Typedecl/index.html">Typedecl</a></li><li><a href="../../compiler-libs.common/Typedecl_immediacy/index.html">Typedecl_immediacy</a></li><li><a href="../../compiler-libs.common/Typedecl_properties/index.html">Typedecl_properties</a></li><li><a href="../../compiler-libs.common/Typedecl_separability/index.html">Typedecl_separability</a></li><li><a href="../../compiler-libs.common/Typedecl_unboxed/index.html">Typedecl_unboxed</a></li><li><a href="../../compiler-libs.common/Typedecl_variance/index.html">Typedecl_variance</a></li><li><a href="../../compiler-libs.common/Typedtree/index.html">Typedtree</a></li><li><a href="../../compiler-libs.common/Typemod/index.html">Typemod</a></li><li><a href="../../compiler-libs.common/Typeopt/index.html">Typeopt</a></li><li><a href="../../compiler-libs.common/Types/index.html">Types</a></li><li><a href="../../compiler-libs.common/Typetexp/index.html">Typetexp</a></li><li><a href="../../compiler-libs.common/Unit_info/index.html">Unit_info</a></li><li><a href="../../compiler-libs.common/Untypeast/index.html">Untypeast</a></li><li><a href="../../compiler-libs.common/Value_rec_check/index.html">Value_rec_check</a></li><li><a href="../../compiler-libs.common/Value_rec_compiler/index.html">Value_rec_compiler</a></li><li><a href="../../compiler-libs.common/Value_rec_types/index.html">Value_rec_types</a></li><li><a href="../../compiler-libs.common/Warnings/index.html">Warnings</a></li><li><a href="../../compiler-libs.common/X86_ast/index.html">X86_ast</a></li></ul></li><li>Library <code>compiler-libs.optcomp</code><ul><li><a href="../../compiler-libs.optcomp/Afl_instrument/index.html">Afl_instrument</a></li><li><a href="../../compiler-libs.optcomp/Alias_analysis/index.html">Alias_analysis</a></li><li><a href="../../compiler-libs.optcomp/Allocated_const/index.html">Allocated_const</a></li><li><a href="../../compiler-libs.optcomp/Arch/index.html">Arch</a></li><li><a href="../../compiler-libs.optcomp/Asmgen/index.html">Asmgen</a></li><li><a href="../../compiler-libs.optcomp/Asmlibrarian/index.html">Asmlibrarian</a></li><li><a href="../../compiler-libs.optcomp/Asmlink/index.html">Asmlink</a></li><li><a href="../../compiler-libs.optcomp/Asmpackager/index.html">Asmpackager</a></li><li><a href="../../compiler-libs.optcomp/Augment_specialised_args/index.html">Augment_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Backend_intf/index.html">Backend_intf</a></li><li><a href="../../compiler-libs.optcomp/Backend_var/index.html">Backend_var</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation/index.html">Branch_relaxation</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation_intf/index.html">Branch_relaxation_intf</a></li><li><a href="../../compiler-libs.optcomp/Build_export_info/index.html">Build_export_info</a></li><li><a href="../../compiler-libs.optcomp/CSE/index.html">CSE</a></li><li><a href="../../compiler-libs.optcomp/CSEgen/index.html">CSEgen</a></li><li><a href="../../compiler-libs.optcomp/Clambda/index.html">Clambda</a></li><li><a href="../../compiler-libs.optcomp/Clambda_primitives/index.html">Clambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Closure/index.html">Closure</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion/index.html">Closure_conversion</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion_aux/index.html">Closure_conversion_aux</a></li><li><a href="../../compiler-libs.optcomp/Closure_element/index.html">Closure_element</a></li><li><a href="../../compiler-libs.optcomp/Closure_id/index.html">Closure_id</a></li><li><a href="../../compiler-libs.optcomp/Closure_middle_end/index.html">Closure_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Closure_offsets/index.html">Closure_offsets</a></li><li><a href="../../compiler-libs.optcomp/Closure_origin/index.html">Closure_origin</a></li><li><a href="../../compiler-libs.optcomp/Cmm/index.html">Cmm</a></li><li><a href="../../compiler-libs.optcomp/Cmm_helpers/index.html">Cmm_helpers</a></li><li><a href="../../compiler-libs.optcomp/Cmm_invariants/index.html">Cmm_invariants</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen/index.html">Cmmgen</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen_state/index.html">Cmmgen_state</a></li><li><a href="../../compiler-libs.optcomp/Cmx_format/index.html">Cmx_format</a></li><li><a href="../../compiler-libs.optcomp/Cmxs_format/index.html">Cmxs_format</a></li><li><a href="../../compiler-libs.optcomp/Coloring/index.html">Coloring</a></li><li><a href="../../compiler-libs.optcomp/Comballoc/index.html">Comballoc</a></li><li><a href="../../compiler-libs.optcomp/Compilation_unit/index.html">Compilation_unit</a></li><li><a href="../../compiler-libs.optcomp/Compilenv/index.html">Compilenv</a></li><li><a href="../../compiler-libs.optcomp/Convert_primitives/index.html">Convert_primitives</a></li><li><a href="../../compiler-libs.optcomp/Dataflow/index.html">Dataflow</a></li><li><a href="../../compiler-libs.optcomp/Deadcode/index.html">Deadcode</a></li><li><a href="../../compiler-libs.optcomp/Effect_analysis/index.html">Effect_analysis</a></li><li><a href="../../compiler-libs.optcomp/Emit/index.html">Emit</a></li><li><a href="../../compiler-libs.optcomp/Emitaux/index.html">Emitaux</a></li><li><a href="../../compiler-libs.optcomp/Emitenv/index.html">Emitenv</a></li><li><a href="../../compiler-libs.optcomp/Export_id/index.html">Export_id</a></li><li><a href="../../compiler-libs.optcomp/Export_info/index.html">Export_info</a></li><li><a href="../../compiler-libs.optcomp/Export_info_for_pack/index.html">Export_info_for_pack</a></li><li><a href="../../compiler-libs.optcomp/Extract_projections/index.html">Extract_projections</a></li><li><a href="../../compiler-libs.optcomp/Find_recursive_functions/index.html">Find_recursive_functions</a></li><li><a href="../../compiler-libs.optcomp/Flambda/index.html">Flambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_invariants/index.html">Flambda_invariants</a></li><li><a href="../../compiler-libs.optcomp/Flambda_iterators/index.html">Flambda_iterators</a></li><li><a href="../../compiler-libs.optcomp/Flambda_middle_end/index.html">Flambda_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Flambda_to_clambda/index.html">Flambda_to_clambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_utils/index.html">Flambda_utils</a></li><li><a href="../../compiler-libs.optcomp/Freshening/index.html">Freshening</a></li><li><a href="../../compiler-libs.optcomp/Id_types/index.html">Id_types</a></li><li><a href="../../compiler-libs.optcomp/Import_approx/index.html">Import_approx</a></li><li><a href="../../compiler-libs.optcomp/Inconstant_idents/index.html">Inconstant_idents</a></li><li><a href="../../compiler-libs.optcomp/Initialize_symbol_to_let_symbol/index.html">Initialize_symbol_to_let_symbol</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify/index.html">Inline_and_simplify</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify_aux/index.html">Inline_and_simplify_aux</a></li><li><a href="../../compiler-libs.optcomp/Inlining_cost/index.html">Inlining_cost</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision/index.html">Inlining_decision</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision_intf/index.html">Inlining_decision_intf</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats/index.html">Inlining_stats</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats_types/index.html">Inlining_stats_types</a></li><li><a href="../../compiler-libs.optcomp/Inlining_transforms/index.html">Inlining_transforms</a></li><li><a href="../../compiler-libs.optcomp/Interf/index.html">Interf</a></li><li><a href="../../compiler-libs.optcomp/Internal_variable_names/index.html">Internal_variable_names</a></li><li><a href="../../compiler-libs.optcomp/Interval/index.html">Interval</a></li><li><a href="../../compiler-libs.optcomp/Invariant_params/index.html">Invariant_params</a></li><li><a href="../../compiler-libs.optcomp/Lift_code/index.html">Lift_code</a></li><li><a href="../../compiler-libs.optcomp/Lift_constants/index.html">Lift_constants</a></li><li><a href="../../compiler-libs.optcomp/Lift_let_to_initialize_symbol/index.html">Lift_let_to_initialize_symbol</a></li><li><a href="../../compiler-libs.optcomp/Linear/index.html">Linear</a></li><li><a href="../../compiler-libs.optcomp/Linear_format/index.html">Linear_format</a></li><li><a href="../../compiler-libs.optcomp/Linearize/index.html">Linearize</a></li><li><a href="../../compiler-libs.optcomp/Linkage_name/index.html">Linkage_name</a></li><li><a href="../../compiler-libs.optcomp/Linscan/index.html">Linscan</a></li><li><a href="../../compiler-libs.optcomp/Liveness/index.html">Liveness</a></li><li><a href="../../compiler-libs.optcomp/Mach/index.html">Mach</a></li><li><a href="../../compiler-libs.optcomp/Mutable_variable/index.html">Mutable_variable</a></li><li><a href="../../compiler-libs.optcomp/Optcompile/index.html">Optcompile</a></li><li><a href="../../compiler-libs.optcomp/Opterrors/index.html">Opterrors</a></li><li><a href="../../compiler-libs.optcomp/Optmaindriver/index.html">Optmaindriver</a></li><li><a href="../../compiler-libs.optcomp/Parameter/index.html">Parameter</a></li><li><a href="../../compiler-libs.optcomp/Pass_wrapper/index.html">Pass_wrapper</a></li><li><a href="../../compiler-libs.optcomp/Polling/index.html">Polling</a></li><li><a href="../../compiler-libs.optcomp/Printclambda/index.html">Printclambda</a></li><li><a href="../../compiler-libs.optcomp/Printclambda_primitives/index.html">Printclambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Printcmm/index.html">Printcmm</a></li><li><a href="../../compiler-libs.optcomp/Printlinear/index.html">Printlinear</a></li><li><a href="../../compiler-libs.optcomp/Printmach/index.html">Printmach</a></li><li><a href="../../compiler-libs.optcomp/Proc/index.html">Proc</a></li><li><a href="../../compiler-libs.optcomp/Projection/index.html">Projection</a></li><li><a href="../../compiler-libs.optcomp/Ref_to_variables/index.html">Ref_to_variables</a></li><li><a href="../../compiler-libs.optcomp/Reg/index.html">Reg</a></li><li><a href="../../compiler-libs.optcomp/Reload/index.html">Reload</a></li><li><a href="../../compiler-libs.optcomp/Reloadgen/index.html">Reloadgen</a></li><li><a href="../../compiler-libs.optcomp/Remove_free_vars_equal_to_args/index.html">Remove_free_vars_equal_to_args</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_arguments/index.html">Remove_unused_arguments</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_closure_vars/index.html">Remove_unused_closure_vars</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_program_constructs/index.html">Remove_unused_program_constructs</a></li><li><a href="../../compiler-libs.optcomp/Schedgen/index.html">Schedgen</a></li><li><a href="../../compiler-libs.optcomp/Scheduling/index.html">Scheduling</a></li><li><a href="../../compiler-libs.optcomp/Selectgen/index.html">Selectgen</a></li><li><a href="../../compiler-libs.optcomp/Selection/index.html">Selection</a></li><li><a href="../../compiler-libs.optcomp/Semantics_of_primitives/index.html">Semantics_of_primitives</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_id/index.html">Set_of_closures_id</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_origin/index.html">Set_of_closures_origin</a></li><li><a href="../../compiler-libs.optcomp/Share_constants/index.html">Share_constants</a></li><li><a href="../../compiler-libs.optcomp/Simple_value_approx/index.html">Simple_value_approx</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops/index.html">Simplify_boxed_integer_ops</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops_intf/index.html">Simplify_boxed_integer_ops_intf</a></li><li><a href="../../compiler-libs.optcomp/Simplify_common/index.html">Simplify_common</a></li><li><a href="../../compiler-libs.optcomp/Simplify_primitives/index.html">Simplify_primitives</a></li><li><a href="../../compiler-libs.optcomp/Spill/index.html">Spill</a></li><li><a href="../../compiler-libs.optcomp/Split/index.html">Split</a></li><li><a href="../../compiler-libs.optcomp/Stackframe/index.html">Stackframe</a></li><li><a href="../../compiler-libs.optcomp/Stackframegen/index.html">Stackframegen</a></li><li><a href="../../compiler-libs.optcomp/Static_exception/index.html">Static_exception</a></li><li><a href="../../compiler-libs.optcomp/Strmatch/index.html">Strmatch</a></li><li><a href="../../compiler-libs.optcomp/Symbol/index.html">Symbol</a></li><li><a href="../../compiler-libs.optcomp/Tag/index.html">Tag</a></li><li><a href="../../compiler-libs.optcomp/Thread_sanitizer/index.html">Thread_sanitizer</a></li><li><a href="../../compiler-libs.optcomp/Traverse_for_exported_symbols/index.html">Traverse_for_exported_symbols</a></li><li><a href="../../compiler-libs.optcomp/Un_anf/index.html">Un_anf</a></li><li><a href="../../compiler-libs.optcomp/Unbox_closures/index.html">Unbox_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_free_vars_of_closures/index.html">Unbox_free_vars_of_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_specialised_args/index.html">Unbox_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Var_within_closure/index.html">Var_within_closure</a></li><li><a href="../../compiler-libs.optcomp/Variable/index.html">Variable</a></li></ul></li><li>Library <code>compiler-libs.toplevel</code><ul><li><a href="../../compiler-libs.toplevel/Genprintval/index.html">Genprintval</a></li><li><a href="../../compiler-libs.toplevel/Topcommon/index.html">Topcommon</a></li><li><a href="../../compiler-libs.toplevel/Topdirs/index.html">Topdirs</a></li><li><a href="../../compiler-libs.toplevel/Topeval/index.html">Topeval</a></li><li><a href="../../compiler-libs.toplevel/Toploop/index.html">Toploop</a></li><li><a href="../../compiler-libs.toplevel/Topmain/index.html">Topmain</a></li><li><a href="../../compiler-libs.toplevel/Topprinters/index.html">Topprinters</a></li><li><a href="../../compiler-libs.toplevel/Trace/index.html">Trace</a></li></ul></li><li>Library <code>dynlink</code><ul><li><a href="../../dynlink/Dynlink/index.html">Dynlink</a></li></ul></li><li>Library <code>runtime_events</code><ul><li><a href="../../runtime_events/Runtime_events/index.html">Runtime_events</a></li></ul></li><li>Library <code>stdlib</code><ul><li><a href="../../stdlib/CamlinternalFormat/index.html">CamlinternalFormat</a></li><li><a href="../../stdlib/CamlinternalFormatBasics/index.html">CamlinternalFormatBasics</a></li><li><a href="../../stdlib/CamlinternalLazy/index.html">CamlinternalLazy</a></li><li><a href="../../stdlib/CamlinternalMod/index.html">CamlinternalMod</a></li><li><a href="../../stdlib/CamlinternalOO/index.html">CamlinternalOO</a></li><li><a href="../../stdlib/Stdlib/index.html">Stdlib</a></li></ul></li><li>Library <code>str</code><ul><li><a href="../../str/Str/index.html">Str</a></li></ul></li><li>Library <code>threads</code><ul><li><a href="../../threads/Event/index.html">Event</a></li><li><a href="../../threads/Thread/index.html">Thread</a></li></ul></li><li>Library <code>unix</code><ul><li><a href="../../unix/Unix/index.html">Unix</a></li><li><a href="../../unix/UnixLabels/index.html">UnixLabels</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>stdlib<ul><li><a href="arg.ml.html">arg.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="arrayLabels.ml.html">arrayLabels.ml</a></li><li><a href="atomic.ml.html">atomic.ml</a></li><li><a href="bigarray.ml.html">bigarray.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytesLabels.ml.html">bytesLabels.ml</a></li><li><a href="callback.ml.html">callback.ml</a></li><li><a href="camlinternalFormat.ml.html">camlinternalFormat.ml</a></li><li><a href="camlinternalFormatBasics.ml.html">camlinternalFormatBasics.ml</a></li><li><a href="camlinternalLazy.ml.html">camlinternalLazy.ml</a></li><li><a href="camlinternalMod.ml.html">camlinternalMod.ml</a></li><li><a href="camlinternalOO.ml.html">camlinternalOO.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="complex.ml.html">complex.ml</a></li><li><a href="condition.ml.html">condition.ml</a></li><li><a href="digest.ml.html">digest.ml</a></li><li><a href="domain.ml.html">domain.ml</a></li><li><a href="dynarray.ml.html">dynarray.ml</a></li><li><a href="effect.ml.html">effect.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="ephemeron.ml.html">ephemeron.ml</a></li><li><a href="filename.ml.html">filename.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="format.ml.html">format.ml</a></li><li><a href="fun.ml.html">fun.ml</a></li><li><a href="gc.ml.html">gc.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="in_channel.ml.html">in_channel.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="lexing.ml.html">lexing.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="listLabels.ml.html">listLabels.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="marshal.ml.html">marshal.ml</a></li><li><a href="moreLabels.ml.html">moreLabels.ml</a></li><li><a href="mutex.ml.html">mutex.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="obj.ml.html">obj.ml</a></li><li><a href="oo.ml.html">oo.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="out_channel.ml.html">out_channel.ml</a></li><li><a href="parsing.ml.html">parsing.ml</a></li><li><a href="printexc.ml.html">printexc.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="#" class="current_unit">scanf.ml</a></li><li><a href="semaphore.ml.html">semaphore.ml</a></li><li><a href="seq.ml.html">seq.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stdLabels.ml.html">stdLabels.ml</a></li><li><a href="stdlib.ml.html">stdlib.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="stringLabels.ml.html">stringLabels.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="type.ml.html">type.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="weak.ml.html">weak.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
<a id="L948" class="source_line" href="#L948">948</a>
<a id="L949" class="source_line" href="#L949">949</a>
<a id="L950" class="source_line" href="#L950">950</a>
<a id="L951" class="source_line" href="#L951">951</a>
<a id="L952" class="source_line" href="#L952">952</a>
<a id="L953" class="source_line" href="#L953">953</a>
<a id="L954" class="source_line" href="#L954">954</a>
<a id="L955" class="source_line" href="#L955">955</a>
<a id="L956" class="source_line" href="#L956">956</a>
<a id="L957" class="source_line" href="#L957">957</a>
<a id="L958" class="source_line" href="#L958">958</a>
<a id="L959" class="source_line" href="#L959">959</a>
<a id="L960" class="source_line" href="#L960">960</a>
<a id="L961" class="source_line" href="#L961">961</a>
<a id="L962" class="source_line" href="#L962">962</a>
<a id="L963" class="source_line" href="#L963">963</a>
<a id="L964" class="source_line" href="#L964">964</a>
<a id="L965" class="source_line" href="#L965">965</a>
<a id="L966" class="source_line" href="#L966">966</a>
<a id="L967" class="source_line" href="#L967">967</a>
<a id="L968" class="source_line" href="#L968">968</a>
<a id="L969" class="source_line" href="#L969">969</a>
<a id="L970" class="source_line" href="#L970">970</a>
<a id="L971" class="source_line" href="#L971">971</a>
<a id="L972" class="source_line" href="#L972">972</a>
<a id="L973" class="source_line" href="#L973">973</a>
<a id="L974" class="source_line" href="#L974">974</a>
<a id="L975" class="source_line" href="#L975">975</a>
<a id="L976" class="source_line" href="#L976">976</a>
<a id="L977" class="source_line" href="#L977">977</a>
<a id="L978" class="source_line" href="#L978">978</a>
<a id="L979" class="source_line" href="#L979">979</a>
<a id="L980" class="source_line" href="#L980">980</a>
<a id="L981" class="source_line" href="#L981">981</a>
<a id="L982" class="source_line" href="#L982">982</a>
<a id="L983" class="source_line" href="#L983">983</a>
<a id="L984" class="source_line" href="#L984">984</a>
<a id="L985" class="source_line" href="#L985">985</a>
<a id="L986" class="source_line" href="#L986">986</a>
<a id="L987" class="source_line" href="#L987">987</a>
<a id="L988" class="source_line" href="#L988">988</a>
<a id="L989" class="source_line" href="#L989">989</a>
<a id="L990" class="source_line" href="#L990">990</a>
<a id="L991" class="source_line" href="#L991">991</a>
<a id="L992" class="source_line" href="#L992">992</a>
<a id="L993" class="source_line" href="#L993">993</a>
<a id="L994" class="source_line" href="#L994">994</a>
<a id="L995" class="source_line" href="#L995">995</a>
<a id="L996" class="source_line" href="#L996">996</a>
<a id="L997" class="source_line" href="#L997">997</a>
<a id="L998" class="source_line" href="#L998">998</a>
<a id="L999" class="source_line" href="#L999">999</a>
<a id="L1000" class="source_line" href="#L1000">1000</a>
<a id="L1001" class="source_line" href="#L1001">1001</a>
<a id="L1002" class="source_line" href="#L1002">1002</a>
<a id="L1003" class="source_line" href="#L1003">1003</a>
<a id="L1004" class="source_line" href="#L1004">1004</a>
<a id="L1005" class="source_line" href="#L1005">1005</a>
<a id="L1006" class="source_line" href="#L1006">1006</a>
<a id="L1007" class="source_line" href="#L1007">1007</a>
<a id="L1008" class="source_line" href="#L1008">1008</a>
<a id="L1009" class="source_line" href="#L1009">1009</a>
<a id="L1010" class="source_line" href="#L1010">1010</a>
<a id="L1011" class="source_line" href="#L1011">1011</a>
<a id="L1012" class="source_line" href="#L1012">1012</a>
<a id="L1013" class="source_line" href="#L1013">1013</a>
<a id="L1014" class="source_line" href="#L1014">1014</a>
<a id="L1015" class="source_line" href="#L1015">1015</a>
<a id="L1016" class="source_line" href="#L1016">1016</a>
<a id="L1017" class="source_line" href="#L1017">1017</a>
<a id="L1018" class="source_line" href="#L1018">1018</a>
<a id="L1019" class="source_line" href="#L1019">1019</a>
<a id="L1020" class="source_line" href="#L1020">1020</a>
<a id="L1021" class="source_line" href="#L1021">1021</a>
<a id="L1022" class="source_line" href="#L1022">1022</a>
<a id="L1023" class="source_line" href="#L1023">1023</a>
<a id="L1024" class="source_line" href="#L1024">1024</a>
<a id="L1025" class="source_line" href="#L1025">1025</a>
<a id="L1026" class="source_line" href="#L1026">1026</a>
<a id="L1027" class="source_line" href="#L1027">1027</a>
<a id="L1028" class="source_line" href="#L1028">1028</a>
<a id="L1029" class="source_line" href="#L1029">1029</a>
<a id="L1030" class="source_line" href="#L1030">1030</a>
<a id="L1031" class="source_line" href="#L1031">1031</a>
<a id="L1032" class="source_line" href="#L1032">1032</a>
<a id="L1033" class="source_line" href="#L1033">1033</a>
<a id="L1034" class="source_line" href="#L1034">1034</a>
<a id="L1035" class="source_line" href="#L1035">1035</a>
<a id="L1036" class="source_line" href="#L1036">1036</a>
<a id="L1037" class="source_line" href="#L1037">1037</a>
<a id="L1038" class="source_line" href="#L1038">1038</a>
<a id="L1039" class="source_line" href="#L1039">1039</a>
<a id="L1040" class="source_line" href="#L1040">1040</a>
<a id="L1041" class="source_line" href="#L1041">1041</a>
<a id="L1042" class="source_line" href="#L1042">1042</a>
<a id="L1043" class="source_line" href="#L1043">1043</a>
<a id="L1044" class="source_line" href="#L1044">1044</a>
<a id="L1045" class="source_line" href="#L1045">1045</a>
<a id="L1046" class="source_line" href="#L1046">1046</a>
<a id="L1047" class="source_line" href="#L1047">1047</a>
<a id="L1048" class="source_line" href="#L1048">1048</a>
<a id="L1049" class="source_line" href="#L1049">1049</a>
<a id="L1050" class="source_line" href="#L1050">1050</a>
<a id="L1051" class="source_line" href="#L1051">1051</a>
<a id="L1052" class="source_line" href="#L1052">1052</a>
<a id="L1053" class="source_line" href="#L1053">1053</a>
<a id="L1054" class="source_line" href="#L1054">1054</a>
<a id="L1055" class="source_line" href="#L1055">1055</a>
<a id="L1056" class="source_line" href="#L1056">1056</a>
<a id="L1057" class="source_line" href="#L1057">1057</a>
<a id="L1058" class="source_line" href="#L1058">1058</a>
<a id="L1059" class="source_line" href="#L1059">1059</a>
<a id="L1060" class="source_line" href="#L1060">1060</a>
<a id="L1061" class="source_line" href="#L1061">1061</a>
<a id="L1062" class="source_line" href="#L1062">1062</a>
<a id="L1063" class="source_line" href="#L1063">1063</a>
<a id="L1064" class="source_line" href="#L1064">1064</a>
<a id="L1065" class="source_line" href="#L1065">1065</a>
<a id="L1066" class="source_line" href="#L1066">1066</a>
<a id="L1067" class="source_line" href="#L1067">1067</a>
<a id="L1068" class="source_line" href="#L1068">1068</a>
<a id="L1069" class="source_line" href="#L1069">1069</a>
<a id="L1070" class="source_line" href="#L1070">1070</a>
<a id="L1071" class="source_line" href="#L1071">1071</a>
<a id="L1072" class="source_line" href="#L1072">1072</a>
<a id="L1073" class="source_line" href="#L1073">1073</a>
<a id="L1074" class="source_line" href="#L1074">1074</a>
<a id="L1075" class="source_line" href="#L1075">1075</a>
<a id="L1076" class="source_line" href="#L1076">1076</a>
<a id="L1077" class="source_line" href="#L1077">1077</a>
<a id="L1078" class="source_line" href="#L1078">1078</a>
<a id="L1079" class="source_line" href="#L1079">1079</a>
<a id="L1080" class="source_line" href="#L1080">1080</a>
<a id="L1081" class="source_line" href="#L1081">1081</a>
<a id="L1082" class="source_line" href="#L1082">1082</a>
<a id="L1083" class="source_line" href="#L1083">1083</a>
<a id="L1084" class="source_line" href="#L1084">1084</a>
<a id="L1085" class="source_line" href="#L1085">1085</a>
<a id="L1086" class="source_line" href="#L1086">1086</a>
<a id="L1087" class="source_line" href="#L1087">1087</a>
<a id="L1088" class="source_line" href="#L1088">1088</a>
<a id="L1089" class="source_line" href="#L1089">1089</a>
<a id="L1090" class="source_line" href="#L1090">1090</a>
<a id="L1091" class="source_line" href="#L1091">1091</a>
<a id="L1092" class="source_line" href="#L1092">1092</a>
<a id="L1093" class="source_line" href="#L1093">1093</a>
<a id="L1094" class="source_line" href="#L1094">1094</a>
<a id="L1095" class="source_line" href="#L1095">1095</a>
<a id="L1096" class="source_line" href="#L1096">1096</a>
<a id="L1097" class="source_line" href="#L1097">1097</a>
<a id="L1098" class="source_line" href="#L1098">1098</a>
<a id="L1099" class="source_line" href="#L1099">1099</a>
<a id="L1100" class="source_line" href="#L1100">1100</a>
<a id="L1101" class="source_line" href="#L1101">1101</a>
<a id="L1102" class="source_line" href="#L1102">1102</a>
<a id="L1103" class="source_line" href="#L1103">1103</a>
<a id="L1104" class="source_line" href="#L1104">1104</a>
<a id="L1105" class="source_line" href="#L1105">1105</a>
<a id="L1106" class="source_line" href="#L1106">1106</a>
<a id="L1107" class="source_line" href="#L1107">1107</a>
<a id="L1108" class="source_line" href="#L1108">1108</a>
<a id="L1109" class="source_line" href="#L1109">1109</a>
<a id="L1110" class="source_line" href="#L1110">1110</a>
<a id="L1111" class="source_line" href="#L1111">1111</a>
<a id="L1112" class="source_line" href="#L1112">1112</a>
<a id="L1113" class="source_line" href="#L1113">1113</a>
<a id="L1114" class="source_line" href="#L1114">1114</a>
<a id="L1115" class="source_line" href="#L1115">1115</a>
<a id="L1116" class="source_line" href="#L1116">1116</a>
<a id="L1117" class="source_line" href="#L1117">1117</a>
<a id="L1118" class="source_line" href="#L1118">1118</a>
<a id="L1119" class="source_line" href="#L1119">1119</a>
<a id="L1120" class="source_line" href="#L1120">1120</a>
<a id="L1121" class="source_line" href="#L1121">1121</a>
<a id="L1122" class="source_line" href="#L1122">1122</a>
<a id="L1123" class="source_line" href="#L1123">1123</a>
<a id="L1124" class="source_line" href="#L1124">1124</a>
<a id="L1125" class="source_line" href="#L1125">1125</a>
<a id="L1126" class="source_line" href="#L1126">1126</a>
<a id="L1127" class="source_line" href="#L1127">1127</a>
<a id="L1128" class="source_line" href="#L1128">1128</a>
<a id="L1129" class="source_line" href="#L1129">1129</a>
<a id="L1130" class="source_line" href="#L1130">1130</a>
<a id="L1131" class="source_line" href="#L1131">1131</a>
<a id="L1132" class="source_line" href="#L1132">1132</a>
<a id="L1133" class="source_line" href="#L1133">1133</a>
<a id="L1134" class="source_line" href="#L1134">1134</a>
<a id="L1135" class="source_line" href="#L1135">1135</a>
<a id="L1136" class="source_line" href="#L1136">1136</a>
<a id="L1137" class="source_line" href="#L1137">1137</a>
<a id="L1138" class="source_line" href="#L1138">1138</a>
<a id="L1139" class="source_line" href="#L1139">1139</a>
<a id="L1140" class="source_line" href="#L1140">1140</a>
<a id="L1141" class="source_line" href="#L1141">1141</a>
<a id="L1142" class="source_line" href="#L1142">1142</a>
<a id="L1143" class="source_line" href="#L1143">1143</a>
<a id="L1144" class="source_line" href="#L1144">1144</a>
<a id="L1145" class="source_line" href="#L1145">1145</a>
<a id="L1146" class="source_line" href="#L1146">1146</a>
<a id="L1147" class="source_line" href="#L1147">1147</a>
<a id="L1148" class="source_line" href="#L1148">1148</a>
<a id="L1149" class="source_line" href="#L1149">1149</a>
<a id="L1150" class="source_line" href="#L1150">1150</a>
<a id="L1151" class="source_line" href="#L1151">1151</a>
<a id="L1152" class="source_line" href="#L1152">1152</a>
<a id="L1153" class="source_line" href="#L1153">1153</a>
<a id="L1154" class="source_line" href="#L1154">1154</a>
<a id="L1155" class="source_line" href="#L1155">1155</a>
<a id="L1156" class="source_line" href="#L1156">1156</a>
<a id="L1157" class="source_line" href="#L1157">1157</a>
<a id="L1158" class="source_line" href="#L1158">1158</a>
<a id="L1159" class="source_line" href="#L1159">1159</a>
<a id="L1160" class="source_line" href="#L1160">1160</a>
<a id="L1161" class="source_line" href="#L1161">1161</a>
<a id="L1162" class="source_line" href="#L1162">1162</a>
<a id="L1163" class="source_line" href="#L1163">1163</a>
<a id="L1164" class="source_line" href="#L1164">1164</a>
<a id="L1165" class="source_line" href="#L1165">1165</a>
<a id="L1166" class="source_line" href="#L1166">1166</a>
<a id="L1167" class="source_line" href="#L1167">1167</a>
<a id="L1168" class="source_line" href="#L1168">1168</a>
<a id="L1169" class="source_line" href="#L1169">1169</a>
<a id="L1170" class="source_line" href="#L1170">1170</a>
<a id="L1171" class="source_line" href="#L1171">1171</a>
<a id="L1172" class="source_line" href="#L1172">1172</a>
<a id="L1173" class="source_line" href="#L1173">1173</a>
<a id="L1174" class="source_line" href="#L1174">1174</a>
<a id="L1175" class="source_line" href="#L1175">1175</a>
<a id="L1176" class="source_line" href="#L1176">1176</a>
<a id="L1177" class="source_line" href="#L1177">1177</a>
<a id="L1178" class="source_line" href="#L1178">1178</a>
<a id="L1179" class="source_line" href="#L1179">1179</a>
<a id="L1180" class="source_line" href="#L1180">1180</a>
<a id="L1181" class="source_line" href="#L1181">1181</a>
<a id="L1182" class="source_line" href="#L1182">1182</a>
<a id="L1183" class="source_line" href="#L1183">1183</a>
<a id="L1184" class="source_line" href="#L1184">1184</a>
<a id="L1185" class="source_line" href="#L1185">1185</a>
<a id="L1186" class="source_line" href="#L1186">1186</a>
<a id="L1187" class="source_line" href="#L1187">1187</a>
<a id="L1188" class="source_line" href="#L1188">1188</a>
<a id="L1189" class="source_line" href="#L1189">1189</a>
<a id="L1190" class="source_line" href="#L1190">1190</a>
<a id="L1191" class="source_line" href="#L1191">1191</a>
<a id="L1192" class="source_line" href="#L1192">1192</a>
<a id="L1193" class="source_line" href="#L1193">1193</a>
<a id="L1194" class="source_line" href="#L1194">1194</a>
<a id="L1195" class="source_line" href="#L1195">1195</a>
<a id="L1196" class="source_line" href="#L1196">1196</a>
<a id="L1197" class="source_line" href="#L1197">1197</a>
<a id="L1198" class="source_line" href="#L1198">1198</a>
<a id="L1199" class="source_line" href="#L1199">1199</a>
<a id="L1200" class="source_line" href="#L1200">1200</a>
<a id="L1201" class="source_line" href="#L1201">1201</a>
<a id="L1202" class="source_line" href="#L1202">1202</a>
<a id="L1203" class="source_line" href="#L1203">1203</a>
<a id="L1204" class="source_line" href="#L1204">1204</a>
<a id="L1205" class="source_line" href="#L1205">1205</a>
<a id="L1206" class="source_line" href="#L1206">1206</a>
<a id="L1207" class="source_line" href="#L1207">1207</a>
<a id="L1208" class="source_line" href="#L1208">1208</a>
<a id="L1209" class="source_line" href="#L1209">1209</a>
<a id="L1210" class="source_line" href="#L1210">1210</a>
<a id="L1211" class="source_line" href="#L1211">1211</a>
<a id="L1212" class="source_line" href="#L1212">1212</a>
<a id="L1213" class="source_line" href="#L1213">1213</a>
<a id="L1214" class="source_line" href="#L1214">1214</a>
<a id="L1215" class="source_line" href="#L1215">1215</a>
<a id="L1216" class="source_line" href="#L1216">1216</a>
<a id="L1217" class="source_line" href="#L1217">1217</a>
<a id="L1218" class="source_line" href="#L1218">1218</a>
<a id="L1219" class="source_line" href="#L1219">1219</a>
<a id="L1220" class="source_line" href="#L1220">1220</a>
<a id="L1221" class="source_line" href="#L1221">1221</a>
<a id="L1222" class="source_line" href="#L1222">1222</a>
<a id="L1223" class="source_line" href="#L1223">1223</a>
<a id="L1224" class="source_line" href="#L1224">1224</a>
<a id="L1225" class="source_line" href="#L1225">1225</a>
<a id="L1226" class="source_line" href="#L1226">1226</a>
<a id="L1227" class="source_line" href="#L1227">1227</a>
<a id="L1228" class="source_line" href="#L1228">1228</a>
<a id="L1229" class="source_line" href="#L1229">1229</a>
<a id="L1230" class="source_line" href="#L1230">1230</a>
<a id="L1231" class="source_line" href="#L1231">1231</a>
<a id="L1232" class="source_line" href="#L1232">1232</a>
<a id="L1233" class="source_line" href="#L1233">1233</a>
<a id="L1234" class="source_line" href="#L1234">1234</a>
<a id="L1235" class="source_line" href="#L1235">1235</a>
<a id="L1236" class="source_line" href="#L1236">1236</a>
<a id="L1237" class="source_line" href="#L1237">1237</a>
<a id="L1238" class="source_line" href="#L1238">1238</a>
<a id="L1239" class="source_line" href="#L1239">1239</a>
<a id="L1240" class="source_line" href="#L1240">1240</a>
<a id="L1241" class="source_line" href="#L1241">1241</a>
<a id="L1242" class="source_line" href="#L1242">1242</a>
<a id="L1243" class="source_line" href="#L1243">1243</a>
<a id="L1244" class="source_line" href="#L1244">1244</a>
<a id="L1245" class="source_line" href="#L1245">1245</a>
<a id="L1246" class="source_line" href="#L1246">1246</a>
<a id="L1247" class="source_line" href="#L1247">1247</a>
<a id="L1248" class="source_line" href="#L1248">1248</a>
<a id="L1249" class="source_line" href="#L1249">1249</a>
<a id="L1250" class="source_line" href="#L1250">1250</a>
<a id="L1251" class="source_line" href="#L1251">1251</a>
<a id="L1252" class="source_line" href="#L1252">1252</a>
<a id="L1253" class="source_line" href="#L1253">1253</a>
<a id="L1254" class="source_line" href="#L1254">1254</a>
<a id="L1255" class="source_line" href="#L1255">1255</a>
<a id="L1256" class="source_line" href="#L1256">1256</a>
<a id="L1257" class="source_line" href="#L1257">1257</a>
<a id="L1258" class="source_line" href="#L1258">1258</a>
<a id="L1259" class="source_line" href="#L1259">1259</a>
<a id="L1260" class="source_line" href="#L1260">1260</a>
<a id="L1261" class="source_line" href="#L1261">1261</a>
<a id="L1262" class="source_line" href="#L1262">1262</a>
<a id="L1263" class="source_line" href="#L1263">1263</a>
<a id="L1264" class="source_line" href="#L1264">1264</a>
<a id="L1265" class="source_line" href="#L1265">1265</a>
<a id="L1266" class="source_line" href="#L1266">1266</a>
<a id="L1267" class="source_line" href="#L1267">1267</a>
<a id="L1268" class="source_line" href="#L1268">1268</a>
<a id="L1269" class="source_line" href="#L1269">1269</a>
<a id="L1270" class="source_line" href="#L1270">1270</a>
<a id="L1271" class="source_line" href="#L1271">1271</a>
<a id="L1272" class="source_line" href="#L1272">1272</a>
<a id="L1273" class="source_line" href="#L1273">1273</a>
<a id="L1274" class="source_line" href="#L1274">1274</a>
<a id="L1275" class="source_line" href="#L1275">1275</a>
<a id="L1276" class="source_line" href="#L1276">1276</a>
<a id="L1277" class="source_line" href="#L1277">1277</a>
<a id="L1278" class="source_line" href="#L1278">1278</a>
<a id="L1279" class="source_line" href="#L1279">1279</a>
<a id="L1280" class="source_line" href="#L1280">1280</a>
<a id="L1281" class="source_line" href="#L1281">1281</a>
<a id="L1282" class="source_line" href="#L1282">1282</a>
<a id="L1283" class="source_line" href="#L1283">1283</a>
<a id="L1284" class="source_line" href="#L1284">1284</a>
<a id="L1285" class="source_line" href="#L1285">1285</a>
<a id="L1286" class="source_line" href="#L1286">1286</a>
<a id="L1287" class="source_line" href="#L1287">1287</a>
<a id="L1288" class="source_line" href="#L1288">1288</a>
<a id="L1289" class="source_line" href="#L1289">1289</a>
<a id="L1290" class="source_line" href="#L1290">1290</a>
<a id="L1291" class="source_line" href="#L1291">1291</a>
<a id="L1292" class="source_line" href="#L1292">1292</a>
<a id="L1293" class="source_line" href="#L1293">1293</a>
<a id="L1294" class="source_line" href="#L1294">1294</a>
<a id="L1295" class="source_line" href="#L1295">1295</a>
<a id="L1296" class="source_line" href="#L1296">1296</a>
<a id="L1297" class="source_line" href="#L1297">1297</a>
<a id="L1298" class="source_line" href="#L1298">1298</a>
<a id="L1299" class="source_line" href="#L1299">1299</a>
<a id="L1300" class="source_line" href="#L1300">1300</a>
<a id="L1301" class="source_line" href="#L1301">1301</a>
<a id="L1302" class="source_line" href="#L1302">1302</a>
<a id="L1303" class="source_line" href="#L1303">1303</a>
<a id="L1304" class="source_line" href="#L1304">1304</a>
<a id="L1305" class="source_line" href="#L1305">1305</a>
<a id="L1306" class="source_line" href="#L1306">1306</a>
<a id="L1307" class="source_line" href="#L1307">1307</a>
<a id="L1308" class="source_line" href="#L1308">1308</a>
<a id="L1309" class="source_line" href="#L1309">1309</a>
<a id="L1310" class="source_line" href="#L1310">1310</a>
<a id="L1311" class="source_line" href="#L1311">1311</a>
<a id="L1312" class="source_line" href="#L1312">1312</a>
<a id="L1313" class="source_line" href="#L1313">1313</a>
<a id="L1314" class="source_line" href="#L1314">1314</a>
<a id="L1315" class="source_line" href="#L1315">1315</a>
<a id="L1316" class="source_line" href="#L1316">1316</a>
<a id="L1317" class="source_line" href="#L1317">1317</a>
<a id="L1318" class="source_line" href="#L1318">1318</a>
<a id="L1319" class="source_line" href="#L1319">1319</a>
<a id="L1320" class="source_line" href="#L1320">1320</a>
<a id="L1321" class="source_line" href="#L1321">1321</a>
<a id="L1322" class="source_line" href="#L1322">1322</a>
<a id="L1323" class="source_line" href="#L1323">1323</a>
<a id="L1324" class="source_line" href="#L1324">1324</a>
<a id="L1325" class="source_line" href="#L1325">1325</a>
<a id="L1326" class="source_line" href="#L1326">1326</a>
<a id="L1327" class="source_line" href="#L1327">1327</a>
<a id="L1328" class="source_line" href="#L1328">1328</a>
<a id="L1329" class="source_line" href="#L1329">1329</a>
<a id="L1330" class="source_line" href="#L1330">1330</a>
<a id="L1331" class="source_line" href="#L1331">1331</a>
<a id="L1332" class="source_line" href="#L1332">1332</a>
<a id="L1333" class="source_line" href="#L1333">1333</a>
<a id="L1334" class="source_line" href="#L1334">1334</a>
<a id="L1335" class="source_line" href="#L1335">1335</a>
<a id="L1336" class="source_line" href="#L1336">1336</a>
<a id="L1337" class="source_line" href="#L1337">1337</a>
<a id="L1338" class="source_line" href="#L1338">1338</a>
<a id="L1339" class="source_line" href="#L1339">1339</a>
<a id="L1340" class="source_line" href="#L1340">1340</a>
<a id="L1341" class="source_line" href="#L1341">1341</a>
<a id="L1342" class="source_line" href="#L1342">1342</a>
<a id="L1343" class="source_line" href="#L1343">1343</a>
<a id="L1344" class="source_line" href="#L1344">1344</a>
<a id="L1345" class="source_line" href="#L1345">1345</a>
<a id="L1346" class="source_line" href="#L1346">1346</a>
<a id="L1347" class="source_line" href="#L1347">1347</a>
<a id="L1348" class="source_line" href="#L1348">1348</a>
<a id="L1349" class="source_line" href="#L1349">1349</a>
<a id="L1350" class="source_line" href="#L1350">1350</a>
<a id="L1351" class="source_line" href="#L1351">1351</a>
<a id="L1352" class="source_line" href="#L1352">1352</a>
<a id="L1353" class="source_line" href="#L1353">1353</a>
<a id="L1354" class="source_line" href="#L1354">1354</a>
<a id="L1355" class="source_line" href="#L1355">1355</a>
<a id="L1356" class="source_line" href="#L1356">1356</a>
<a id="L1357" class="source_line" href="#L1357">1357</a>
<a id="L1358" class="source_line" href="#L1358">1358</a>
<a id="L1359" class="source_line" href="#L1359">1359</a>
<a id="L1360" class="source_line" href="#L1360">1360</a>
<a id="L1361" class="source_line" href="#L1361">1361</a>
<a id="L1362" class="source_line" href="#L1362">1362</a>
<a id="L1363" class="source_line" href="#L1363">1363</a>
<a id="L1364" class="source_line" href="#L1364">1364</a>
<a id="L1365" class="source_line" href="#L1365">1365</a>
<a id="L1366" class="source_line" href="#L1366">1366</a>
<a id="L1367" class="source_line" href="#L1367">1367</a>
<a id="L1368" class="source_line" href="#L1368">1368</a>
<a id="L1369" class="source_line" href="#L1369">1369</a>
<a id="L1370" class="source_line" href="#L1370">1370</a>
<a id="L1371" class="source_line" href="#L1371">1371</a>
<a id="L1372" class="source_line" href="#L1372">1372</a>
<a id="L1373" class="source_line" href="#L1373">1373</a>
<a id="L1374" class="source_line" href="#L1374">1374</a>
<a id="L1375" class="source_line" href="#L1375">1375</a>
<a id="L1376" class="source_line" href="#L1376">1376</a>
<a id="L1377" class="source_line" href="#L1377">1377</a>
<a id="L1378" class="source_line" href="#L1378">1378</a>
<a id="L1379" class="source_line" href="#L1379">1379</a>
<a id="L1380" class="source_line" href="#L1380">1380</a>
<a id="L1381" class="source_line" href="#L1381">1381</a>
<a id="L1382" class="source_line" href="#L1382">1382</a>
<a id="L1383" class="source_line" href="#L1383">1383</a>
<a id="L1384" class="source_line" href="#L1384">1384</a>
<a id="L1385" class="source_line" href="#L1385">1385</a>
<a id="L1386" class="source_line" href="#L1386">1386</a>
<a id="L1387" class="source_line" href="#L1387">1387</a>
<a id="L1388" class="source_line" href="#L1388">1388</a>
<a id="L1389" class="source_line" href="#L1389">1389</a>
<a id="L1390" class="source_line" href="#L1390">1390</a>
<a id="L1391" class="source_line" href="#L1391">1391</a>
<a id="L1392" class="source_line" href="#L1392">1392</a>
<a id="L1393" class="source_line" href="#L1393">1393</a>
<a id="L1394" class="source_line" href="#L1394">1394</a>
<a id="L1395" class="source_line" href="#L1395">1395</a>
<a id="L1396" class="source_line" href="#L1396">1396</a>
<a id="L1397" class="source_line" href="#L1397">1397</a>
<a id="L1398" class="source_line" href="#L1398">1398</a>
<a id="L1399" class="source_line" href="#L1399">1399</a>
<a id="L1400" class="source_line" href="#L1400">1400</a>
<a id="L1401" class="source_line" href="#L1401">1401</a>
<a id="L1402" class="source_line" href="#L1402">1402</a>
<a id="L1403" class="source_line" href="#L1403">1403</a>
<a id="L1404" class="source_line" href="#L1404">1404</a>
<a id="L1405" class="source_line" href="#L1405">1405</a>
<a id="L1406" class="source_line" href="#L1406">1406</a>
<a id="L1407" class="source_line" href="#L1407">1407</a>
<a id="L1408" class="source_line" href="#L1408">1408</a>
<a id="L1409" class="source_line" href="#L1409">1409</a>
<a id="L1410" class="source_line" href="#L1410">1410</a>
<a id="L1411" class="source_line" href="#L1411">1411</a>
<a id="L1412" class="source_line" href="#L1412">1412</a>
<a id="L1413" class="source_line" href="#L1413">1413</a>
<a id="L1414" class="source_line" href="#L1414">1414</a>
<a id="L1415" class="source_line" href="#L1415">1415</a>
<a id="L1416" class="source_line" href="#L1416">1416</a>
<a id="L1417" class="source_line" href="#L1417">1417</a>
<a id="L1418" class="source_line" href="#L1418">1418</a>
<a id="L1419" class="source_line" href="#L1419">1419</a>
<a id="L1420" class="source_line" href="#L1420">1420</a>
<a id="L1421" class="source_line" href="#L1421">1421</a>
<a id="L1422" class="source_line" href="#L1422">1422</a>
<a id="L1423" class="source_line" href="#L1423">1423</a>
<a id="L1424" class="source_line" href="#L1424">1424</a>
<a id="L1425" class="source_line" href="#L1425">1425</a>
<a id="L1426" class="source_line" href="#L1426">1426</a>
<a id="L1427" class="source_line" href="#L1427">1427</a>
<a id="L1428" class="source_line" href="#L1428">1428</a>
<a id="L1429" class="source_line" href="#L1429">1429</a>
<a id="L1430" class="source_line" href="#L1430">1430</a>
<a id="L1431" class="source_line" href="#L1431">1431</a>
<a id="L1432" class="source_line" href="#L1432">1432</a>
<a id="L1433" class="source_line" href="#L1433">1433</a>
<a id="L1434" class="source_line" href="#L1434">1434</a>
<a id="L1435" class="source_line" href="#L1435">1435</a>
<a id="L1436" class="source_line" href="#L1436">1436</a>
<a id="L1437" class="source_line" href="#L1437">1437</a>
<a id="L1438" class="source_line" href="#L1438">1438</a>
<a id="L1439" class="source_line" href="#L1439">1439</a>
<a id="L1440" class="source_line" href="#L1440">1440</a>
<a id="L1441" class="source_line" href="#L1441">1441</a>
<a id="L1442" class="source_line" href="#L1442">1442</a>
<a id="L1443" class="source_line" href="#L1443">1443</a>
<a id="L1444" class="source_line" href="#L1444">1444</a>
<a id="L1445" class="source_line" href="#L1445">1445</a>
<a id="L1446" class="source_line" href="#L1446">1446</a>
<a id="L1447" class="source_line" href="#L1447">1447</a>
<a id="L1448" class="source_line" href="#L1448">1448</a>
<a id="L1449" class="source_line" href="#L1449">1449</a>
<a id="L1450" class="source_line" href="#L1450">1450</a>
<a id="L1451" class="source_line" href="#L1451">1451</a>
<a id="L1452" class="source_line" href="#L1452">1452</a>
<a id="L1453" class="source_line" href="#L1453">1453</a>
<a id="L1454" class="source_line" href="#L1454">1454</a>
<a id="L1455" class="source_line" href="#L1455">1455</a>
<a id="L1456" class="source_line" href="#L1456">1456</a>
<a id="L1457" class="source_line" href="#L1457">1457</a>
<a id="L1458" class="source_line" href="#L1458">1458</a>
<a id="L1459" class="source_line" href="#L1459">1459</a>
<a id="L1460" class="source_line" href="#L1460">1460</a>
<a id="L1461" class="source_line" href="#L1461">1461</a>
<a id="L1462" class="source_line" href="#L1462">1462</a>
<a id="L1463" class="source_line" href="#L1463">1463</a>
<a id="L1464" class="source_line" href="#L1464">1464</a>
<a id="L1465" class="source_line" href="#L1465">1465</a>
<a id="L1466" class="source_line" href="#L1466">1466</a>
<a id="L1467" class="source_line" href="#L1467">1467</a>
<a id="L1468" class="source_line" href="#L1468">1468</a>
<a id="L1469" class="source_line" href="#L1469">1469</a>
<a id="L1470" class="source_line" href="#L1470">1470</a>
<a id="L1471" class="source_line" href="#L1471">1471</a>
<a id="L1472" class="source_line" href="#L1472">1472</a>
<a id="L1473" class="source_line" href="#L1473">1473</a>
<a id="L1474" class="source_line" href="#L1474">1474</a>
<a id="L1475" class="source_line" href="#L1475">1475</a>
<a id="L1476" class="source_line" href="#L1476">1476</a>
<a id="L1477" class="source_line" href="#L1477">1477</a>
<a id="L1478" class="source_line" href="#L1478">1478</a>
<a id="L1479" class="source_line" href="#L1479">1479</a>
<a id="L1480" class="source_line" href="#L1480">1480</a>
<a id="L1481" class="source_line" href="#L1481">1481</a>
<a id="L1482" class="source_line" href="#L1482">1482</a>
<a id="L1483" class="source_line" href="#L1483">1483</a>
<a id="L1484" class="source_line" href="#L1484">1484</a>
<a id="L1485" class="source_line" href="#L1485">1485</a>
<a id="L1486" class="source_line" href="#L1486">1486</a>
<a id="L1487" class="source_line" href="#L1487">1487</a>
<a id="L1488" class="source_line" href="#L1488">1488</a>
<a id="L1489" class="source_line" href="#L1489">1489</a>
<a id="L1490" class="source_line" href="#L1490">1490</a>
<a id="L1491" class="source_line" href="#L1491">1491</a>
<a id="L1492" class="source_line" href="#L1492">1492</a>
<a id="L1493" class="source_line" href="#L1493">1493</a>
<a id="L1494" class="source_line" href="#L1494">1494</a>
<a id="L1495" class="source_line" href="#L1495">1495</a>
<a id="L1496" class="source_line" href="#L1496">1496</a>
<a id="L1497" class="source_line" href="#L1497">1497</a>
<a id="L1498" class="source_line" href="#L1498">1498</a>
<a id="L1499" class="source_line" href="#L1499">1499</a>
<a id="L1500" class="source_line" href="#L1500">1500</a>
<a id="L1501" class="source_line" href="#L1501">1501</a>
<a id="L1502" class="source_line" href="#L1502">1502</a>
<a id="L1503" class="source_line" href="#L1503">1503</a>
<a id="L1504" class="source_line" href="#L1504">1504</a>
<a id="L1505" class="source_line" href="#L1505">1505</a>
<a id="L1506" class="source_line" href="#L1506">1506</a>
<a id="L1507" class="source_line" href="#L1507">1507</a>
<a id="L1508" class="source_line" href="#L1508">1508</a>
<a id="L1509" class="source_line" href="#L1509">1509</a>
<a id="L1510" class="source_line" href="#L1510">1510</a>
<a id="L1511" class="source_line" href="#L1511">1511</a>
<a id="L1512" class="source_line" href="#L1512">1512</a>
<a id="L1513" class="source_line" href="#L1513">1513</a>
<a id="L1514" class="source_line" href="#L1514">1514</a>
<a id="L1515" class="source_line" href="#L1515">1515</a>
<a id="L1516" class="source_line" href="#L1516">1516</a>
<a id="L1517" class="source_line" href="#L1517">1517</a>
<a id="L1518" class="source_line" href="#L1518">1518</a>
<a id="L1519" class="source_line" href="#L1519">1519</a>
<a id="L1520" class="source_line" href="#L1520">1520</a>
<a id="L1521" class="source_line" href="#L1521">1521</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                 OCaml                                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*             Pierre Weis, projet Cristal, INRIA Rocquencourt            *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   Copyright 2002 Institut National de Recherche en Informatique et     *)</span><span class="EOL">
</span><span class="COMMENT">(*     en Automatique.                                                    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   All rights reserved.  This file is distributed under the terms of    *)</span><span class="EOL">
</span><span class="COMMENT">(*   the GNU Lesser General Public License version 2.1, with the          *)</span><span class="EOL">
</span><span class="COMMENT">(*   special exception on linking described in the file LICENSE.          *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="camlinternalFormatBasics.ml.html"><span class="UIDENT">CamlinternalFormatBasics</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="camlinternalFormat.ml.html"><span class="UIDENT">CamlinternalFormat</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* alias to avoid warning for ambiguity between
   Stdlib.format6
   and CamlinternalFormatBasics.format6

   (the former is in fact an alias for the latter,
    but the ambiguity warning doesn't care)
*)</span><span class="EOL">
</span><span id="type-format6"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="stdlib.ml.html#type-format6"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">format6</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The run-time library for scanners. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scanning buffers. *)</span><span class="EOL">
</span><span id="module-type-SCANNING"><span class="MODULE">module</span> <span class="TYPE">type</span> <span class="UIDENT">SCANNING</span> <span class="EQUAL">=</span> <span class="SIG">sig</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.type-in_channel"><span class="TYPE">type</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.type-scanbuf"><span class="TYPE">type</span> <span class="LIDENT">scanbuf</span> <span class="EQUAL">=</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.type-file_name"><span class="TYPE">type</span> <span class="LIDENT">file_name</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-stdin"><span class="VAL">val</span> <span class="LIDENT">stdin</span> <span class="COLON">:</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span class="COMMENT">(* The scanning buffer reading from [Stdlib.stdin]. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-next_char"><span class="VAL">val</span> <span class="LIDENT">next_char</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.next_char ib] advance the scanning buffer for
     one character.
     If no more character can be read, sets a end of file condition and
     returns '\000'. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-invalidate_current_char"><span class="VAL">val</span> <span class="LIDENT">invalidate_current_char</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.invalidate_current_char ib] mark the current_char as already
     scanned. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-peek_char"><span class="VAL">val</span> <span class="LIDENT">peek_char</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.peek_char ib] returns the current char available in
     the buffer or reads one if necessary (when the current character is
     already scanned).
     If no character can be read, sets an end of file condition and
     returns '\000'. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-checked_peek_char"><span class="VAL">val</span> <span class="LIDENT">checked_peek_char</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Same as [Scanning.peek_char] above but always returns a valid char or
     fails: instead of returning a null char when the reading method of the
     input buffer has reached an end of file, the function raises exception
     [End_of_file]. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-store_char"><span class="VAL">val</span> <span class="LIDENT">store_char</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.store_char lim ib c] adds [c] to the token buffer
     of the scanning buffer [ib]. It also advances the scanning buffer for
     one character and returns [lim - 1], indicating the new limit for the
     length of the current token. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-skip_char"><span class="VAL">val</span> <span class="LIDENT">skip_char</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.skip_char lim ib] ignores the current character. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-ignore_char"><span class="VAL">val</span> <span class="LIDENT">ignore_char</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.ignore_char ib lim] ignores the current character and
     decrements the limit. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-token"><span class="VAL">val</span> <span class="LIDENT">token</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.token ib] returns the string stored into the token
     buffer of the scanning buffer: it returns the token matched by the
     format. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-reset_token"><span class="VAL">val</span> <span class="LIDENT">reset_token</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.reset_token ib] resets the token buffer of
     the given scanning buffer. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-char_count"><span class="VAL">val</span> <span class="LIDENT">char_count</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.char_count ib] returns the number of characters
     read so far from the given buffer. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-line_count"><span class="VAL">val</span> <span class="LIDENT">line_count</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.line_count ib] returns the number of new line
     characters read so far from the given buffer. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-token_count"><span class="VAL">val</span> <span class="LIDENT">token_count</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.token_count ib] returns the number of tokens read
     so far from [ib]. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-eof"><span class="VAL">val</span> <span class="LIDENT">eof</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.eof ib] returns the end of input condition
     of the given buffer. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-end_of_input"><span class="VAL">val</span> <span class="LIDENT">end_of_input</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.end_of_input ib] tests the end of input condition
     of the given buffer (if no char has ever been read, an attempt to
     read one is performed). *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-beginning_of_input"><span class="VAL">val</span> <span class="LIDENT">beginning_of_input</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.beginning_of_input ib] tests the beginning of input
     condition of the given buffer. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-name_of_input"><span class="VAL">val</span> <span class="LIDENT">name_of_input</span> <span class="COLON">:</span> <span class="LIDENT">scanbuf</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span class="COMMENT">(* [Scanning.name_of_input ib] returns the name of the character
     source for input buffer [ib]. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-open_in"><span class="VAL">val</span> <span class="LIDENT">open_in</span> <span class="COLON">:</span> <span class="LIDENT">file_name</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-open_in_bin"><span class="VAL">val</span> <span class="LIDENT">open_in_bin</span> <span class="COLON">:</span> <span class="LIDENT">file_name</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-from_file"><span class="VAL">val</span> <span class="LIDENT">from_file</span> <span class="COLON">:</span> <span class="LIDENT">file_name</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-from_file_bin"><span class="VAL">val</span> <span class="LIDENT">from_file_bin</span> <span class="COLON">:</span> <span class="LIDENT">file_name</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-from_string"><span class="VAL">val</span> <span class="LIDENT">from_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-from_function"><span class="VAL">val</span> <span class="LIDENT">from_function</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-from_channel"><span class="VAL">val</span> <span class="LIDENT">from_channel</span> <span class="COLON">:</span> <a href="stdlib.ml.html#type-in_channel"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">in_channel</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-type-SCANNING.val-close_in"><span class="VAL">val</span> <span class="LIDENT">close_in</span> <span class="COLON">:</span> <span class="LIDENT">in_channel</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span id="module-Scanning"><span class="MODULE">module</span> <span class="UIDENT">Scanning</span> <span class="COLON">:</span> <span class="UIDENT">SCANNING</span> <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* The run-time library for scanf. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Scanning.type-file_name"><span class="TYPE">type</span> <span class="LIDENT">file_name</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Scanning.type-in_channel_name"><span class="TYPE">type</span> <span class="LIDENT">in_channel_name</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span id="module-Scanning.type-in_channel_name.constructor-From_channel"><span class="BAR">|</span> <span class="UIDENT">From_channel</span> <span class="OF">of</span> <a href="stdlib.ml.html#type-in_channel"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">in_channel</span></a></span><span class="EOL">
</span>    <span id="module-Scanning.type-in_channel_name.constructor-From_file"><span class="BAR">|</span> <span class="UIDENT">From_file</span> <span class="OF">of</span> <span class="LIDENT">file_name</span> <span class="STAR">*</span> <a href="stdlib.ml.html#type-in_channel"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">in_channel</span></a></span><span class="EOL">
</span>    <span id="module-Scanning.type-in_channel_name.constructor-From_function"><span class="BAR">|</span> <span class="UIDENT">From_function</span></span><span class="EOL">
</span>    <span id="module-Scanning.type-in_channel_name.constructor-From_string"><span class="BAR">|</span> <span class="UIDENT">From_string</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Scanning.type-in_channel"><span class="TYPE">type</span> <span class="LIDENT">in_channel</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>    <span id="def_573"><span class="MUTABLE">mutable</span> <span class="LIDENT">ic_eof</span> <span class="COLON">:</span> <span class="LIDENT">bool</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_574"><span class="MUTABLE">mutable</span> <span class="LIDENT">ic_current_char</span> <span class="COLON">:</span> <span class="LIDENT">char</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_583"><span class="MUTABLE">mutable</span> <span class="LIDENT">ic_current_char_is_valid</span> <span class="COLON">:</span> <span class="LIDENT">bool</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_572"><span class="MUTABLE">mutable</span> <span class="LIDENT">ic_char_count</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_578"><span class="MUTABLE">mutable</span> <span class="LIDENT">ic_line_count</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_582"><span class="MUTABLE">mutable</span> <span class="LIDENT">ic_token_count</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_579"><span class="LIDENT">ic_get_next_char</span> <span class="COLON">:</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_576"><span class="LIDENT">ic_token_buffer</span> <span class="COLON">:</span> <a href="buffer.ml.html#type-t"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="SEMI">;</span></span><span class="EOL">
</span>    <span id="def_581"><span class="LIDENT">ic_input_name</span> <span class="COLON">:</span> <span class="LIDENT">in_channel_name</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Scanning.type-scanbuf"><span class="TYPE">type</span> <span class="LIDENT">scanbuf</span> <span class="EQUAL">=</span> <span class="LIDENT">in_channel</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-null_char"><span class="LIDENT">null_char</span></span> <span class="EQUAL">=</span> <span class="CHAR">'\000'</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Reads a new character from input buffer.
     Next_char never fails, even in case of end of input:
     it then simply sets the end of file condition. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-next_char"><span class="LIDENT">next_char</span></span> <span id="local_ib_1"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_2"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_get_next_char</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_2"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char_is_valid</span> <span class="LESSMINUS">&lt;-</span> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_char_count</span> <span class="LESSMINUS">&lt;-</span> <a href="stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_char_count</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_c_2"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'\n'</span> <span class="THEN">then</span> <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_line_count</span> <span class="LESSMINUS">&lt;-</span> <a href="stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_line_count</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_c_2"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End_of_file</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_3"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">null_char</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_c_3"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char_is_valid</span> <span class="LESSMINUS">&lt;-</span> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_ib_1"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_eof</span> <span class="LESSMINUS">&lt;-</span> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_c_3"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-peek_char"><span class="LIDENT">peek_char</span></span> <span id="local_ib_4"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_ib_4"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char_is_valid</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_ib_4"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LIDENT">next_char</span> <a href="#local_ib_4"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Returns a valid current char for the input buffer. In particular
     no irrelevant null character (as set by [next_char] in case of end
     of input) is returned, since [End_of_file] is raised when
     [next_char] sets the end of file condition while trying to read a
     new character. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-checked_peek_char"><span class="LIDENT">checked_peek_char</span></span> <span id="local_ib_5"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_6"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">peek_char</span> <a href="#local_ib_5"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_ib_5"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_eof</span> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_c_6"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-end_of_input"><span class="LIDENT">end_of_input</span></span> <span id="local_ib_7"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <span class="LPAREN">(</span><span class="LIDENT">peek_char</span> <a href="#local_ib_7"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_ib_7"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_eof</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-eof"><span class="LIDENT">eof</span></span> <span id="local_ib_8"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="#local_ib_8"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_eof</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-beginning_of_input"><span class="LIDENT">beginning_of_input</span></span> <span id="local_ib_9"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="#local_ib_9"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_char_count</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-name_of_input"><span class="LIDENT">name_of_input</span></span> <span id="local_ib_10"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_ib_10"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_input_name</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_channel</span> <span id="local__ic_11"><span class="LIDENT">_ic</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;unnamed Stdlib input channel&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_file</span> <span class="LPAREN">(</span><span id="local_fname_12"><span class="LIDENT">fname</span></span><span class="COMMA">,</span> <span id="local__ic_13"><span class="LIDENT">_ic</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_fname_12"><span class="LIDENT">fname</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_function</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;unnamed function&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_string</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;unnamed character string&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-char_count"><span class="LIDENT">char_count</span></span> <span id="local_ib_14"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_ib_14"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char_is_valid</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_ib_14"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_char_count</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_ib_14"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_char_count</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-line_count"><span class="LIDENT">line_count</span></span> <span id="local_ib_15"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="#local_ib_15"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_line_count</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-reset_token"><span class="LIDENT">reset_token</span></span> <span id="local_ib_16"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-reset"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">reset</span></a> <a href="#local_ib_16"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_token_buffer</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-invalidate_current_char"><span class="LIDENT">invalidate_current_char</span></span> <span id="local_ib_17"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="#local_ib_17"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_current_char_is_valid</span> <span class="LESSMINUS">&lt;-</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-token"><span class="LIDENT">token</span></span> <span id="local_ib_18"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_token_buffer_19"><span class="LIDENT">token_buffer</span></span> <span class="EQUAL">=</span> <a href="#local_ib_18"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_token_buffer</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_tok_20"><span class="LIDENT">tok</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_token_buffer_19"><span class="LIDENT">token_buffer</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="buffer.ml.html#val-clear"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_token_buffer_19"><span class="LIDENT">token_buffer</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_ib_18"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_token_count</span> <span class="LESSMINUS">&lt;-</span> <a href="stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_ib_18"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_token_count</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_tok_20"><span class="LIDENT">tok</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-token_count"><span class="LIDENT">token_count</span></span> <span id="local_ib_21"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="#local_ib_21"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_token_count</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-skip_char"><span class="LIDENT">skip_char</span></span> <span id="local_width_22"><span class="LIDENT">width</span></span> <span id="local_ib_23"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">invalidate_current_char</span> <a href="#local_ib_23"><span class="LIDENT">ib</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_width_22"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-ignore_char"><span class="LIDENT">ignore_char</span></span> <span id="local_width_24"><span class="LIDENT">width</span></span> <span id="local_ib_25"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">skip_char</span> <span class="LPAREN">(</span><a href="#local_width_24"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_ib_25"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-store_char"><span class="LIDENT">store_char</span></span> <span id="local_width_26"><span class="LIDENT">width</span></span> <span id="local_ib_27"><span class="LIDENT">ib</span></span> <span id="local_c_28"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="buffer.ml.html#val-add_char"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_char</span></a> <a href="#local_ib_27"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_token_buffer</span> <a href="#local_c_28"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ignore_char</span> <a href="#local_width_26"><span class="LIDENT">width</span></a> <a href="#local_ib_27"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-default_token_buffer_size"><span class="LIDENT">default_token_buffer_size</span></span> <span class="EQUAL">=</span> <span class="INT">1024</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-create"><span class="LIDENT">create</span></span> <span id="local_iname_29"><span class="LIDENT">iname</span></span> <span id="local_next_30"><span class="LIDENT">next</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>    <span class="LIDENT">ic_eof</span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_current_char</span> <span class="EQUAL">=</span> <span class="LIDENT">null_char</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_current_char_is_valid</span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_char_count</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_line_count</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_token_count</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_get_next_char</span> <span class="EQUAL">=</span> <a href="#local_next_30"><span class="LIDENT">next</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_token_buffer</span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LIDENT">default_token_buffer_size</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">ic_input_name</span> <span class="EQUAL">=</span> <a href="#local_iname_29"><span class="LIDENT">iname</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_string"><span class="LIDENT">from_string</span></span> <span id="local_s_31"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_32"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_33"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_31"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_next_34"><span class="LIDENT">next</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_32"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_len_33"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_35"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_s_31"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_32"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_32"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_c_35"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">create</span> <span class="UIDENT">From_string</span> <a href="#local_next_34"><span class="LIDENT">next</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_function"><span class="LIDENT">from_function</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="UIDENT">From_function</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Scanning from an input channel. *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Position of the problem:

     We cannot prevent the scanning mechanism to use one lookahead character,
     if needed by the semantics of the format string specifications (e.g. a
     trailing 'skip space' specification in the format string); in this case,
     the mandatory lookahead character is indeed read from the input and not
     used to return the token read. It is thus mandatory to be able to store
     an unused lookahead character somewhere to get it as the first character
     of the next scan.

     To circumvent this problem, all the scanning functions get a low level
     input buffer argument where they store the lookahead character when
     needed; additionally, the input buffer is the only source of character of
     a scanner. The [scanbuf] input buffers are defined in module {!Scanning}.

     Now we understand that it is extremely important that related and
     successive calls to scanners indeed read from the same input buffer.
     In effect, if a scanner [scan1] is reading from [ib1] and stores an
     unused lookahead character [c1] into its input buffer [ib1], then
     another scanner [scan2] not reading from the same buffer [ib1] will miss
     the character [c1], seemingly vanished in the air from the point of view
     of [scan2].

     This mechanism works perfectly to read from strings, from files, and from
     functions, since in those cases, allocating two buffers reading from the
     same source is unnatural.

     Still, there is a difficulty in the case of scanning from an input
     channel. In effect, when scanning from an input channel [ic], this channel
     may not have been allocated from within this library. Hence, it may be
     shared (two functions of the user's program may successively read from
     [ic]). This is highly error prone since, one of the function may seek the
     input channel, while the other function has still an unused lookahead
     character in its input buffer. In conclusion, you should never mix direct
     low level reading and high level scanning from the same input channel.

  *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Perform bufferized input to improve efficiency. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-file_buffer_size"><span class="LIDENT">file_buffer_size</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">1024</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* The scanner closes the input channel at end of input. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-scan_close_at_end"><span class="LIDENT">scan_close_at_end</span></span> <span id="local_ic_36"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-close_in"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">close_in</span></a> <a href="#local_ic_36"><span class="LIDENT">ic</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* The scanner does not close the input channel at end of input:
     it just raises [End_of_file]. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-scan_raise_at_end"><span class="LIDENT">scan_raise_at_end</span></span> <span id="local__ic_37"><span class="LIDENT">_ic</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_ic"><span class="LIDENT">from_ic</span></span> <span id="local_scan_close_ic_38"><span class="LIDENT">scan_close_ic</span></span> <span id="local_iname_39"><span class="LIDENT">iname</span></span> <span id="local_ic_40"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_41"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><span class="LIDENT">file_buffer_size</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_buf_42"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_len_41"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_43"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_lim_44"><span class="LIDENT">lim</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_eof_45"><span class="LIDENT">eof</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_next_46"><span class="LIDENT">next</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_43"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_lim_44"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span> <span class="LET">let</span> <span id="local_c_47"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_buf_42"><span class="LIDENT">buf</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_43"><span class="LIDENT">i</span></a> <span class="IN">in</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_43"><span class="LIDENT">i</span></a><span class="SEMI">;</span> <a href="#local_c_47"><span class="LIDENT">c</span></a> <span class="END">end</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_eof_45"><span class="LIDENT">eof</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span> <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <a href="#local_lim_44"><span class="LIDENT">lim</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_40"><span class="LIDENT">ic</span></a> <a href="#local_buf_42"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_len_41"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_lim_44"><span class="LIDENT">lim</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="BEGIN">begin</span> <a href="#local_eof_45"><span class="LIDENT">eof</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_scan_close_ic_38"><span class="LIDENT">scan_close_ic</span></a> <a href="#local_ic_40"><span class="LIDENT">ic</span></a> <span class="END">end</span> <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <a href="#local_i_43"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="bytes.ml.html#val-get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_buf_42"><span class="LIDENT">buf</span></a> <span class="INT">0</span><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>      <span class="END">end</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">create</span> <a href="#local_iname_39"><span class="LIDENT">iname</span></a> <a href="#local_next_46"><span class="LIDENT">next</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_ic_close_at_end"><span class="LIDENT">from_ic_close_at_end</span></span> <span class="EQUAL">=</span> <span class="LIDENT">from_ic</span> <span class="LIDENT">scan_close_at_end</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_ic_raise_at_end"><span class="LIDENT">from_ic_raise_at_end</span></span> <span class="EQUAL">=</span> <span class="LIDENT">from_ic</span> <span class="LIDENT">scan_raise_at_end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* The scanning buffer reading from [Stdlib.stdin].
     One could try to define [stdin] as a scanning buffer reading a character
     at a time (no bufferization at all), but unfortunately the top-level
     interaction would be wrong. This is due to some kind of
     'race condition' when reading from [Stdlib.stdin],
     since the interactive compiler and [Scanf.scanf] will simultaneously
     read the material they need from [Stdlib.stdin]; then, confusion
     will result from what should be read by the top-level and what should be
     read by [Scanf.scanf].
     This is even more complicated by the one character lookahead that
     [Scanf.scanf] is sometimes obliged to maintain: the lookahead character
     will be available for the next [Scanf.scanf] entry, seemingly coming from
     nowhere.
     Also no [End_of_file] is raised when reading from stdin: if not enough
     characters have been read, we simply ask to read more. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-stdin"><span class="LIDENT">stdin</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">from_ic</span> <span class="LIDENT">scan_raise_at_end</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">From_file</span> <span class="LPAREN">(</span><span class="STRING">&quot;-&quot;</span><span class="COMMA">,</span> <a href="stdlib.ml.html#val-stdin"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stdin</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-stdin"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stdin</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-open_in_file"><span class="LIDENT">open_in_file</span></span> <span id="local_open_in_48"><span class="LIDENT">open_in</span></span> <span id="local_fname_49"><span class="LIDENT">fname</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_fname_49"><span class="LIDENT">fname</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="STRING">&quot;-&quot;</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">stdin</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_fname_50"><span class="LIDENT">fname</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_ic_51"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span> <a href="#local_open_in_48"><span class="LIDENT">open_in</span></a> <a href="#local_fname_50"><span class="LIDENT">fname</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">from_ic_close_at_end</span> <span class="LPAREN">(</span><span class="UIDENT">From_file</span> <span class="LPAREN">(</span><a href="#local_fname_50"><span class="LIDENT">fname</span></a><span class="COMMA">,</span> <a href="#local_ic_51"><span class="LIDENT">ic</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_ic_51"><span class="LIDENT">ic</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-open_in"><span class="LIDENT">open_in</span></span> <span class="EQUAL">=</span> <span class="LIDENT">open_in_file</span> <a href="stdlib.ml.html#val-open_in"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">open_in</span></a><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-open_in_bin"><span class="LIDENT">open_in_bin</span></span> <span class="EQUAL">=</span> <span class="LIDENT">open_in_file</span> <a href="stdlib.ml.html#val-open_in_bin"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">open_in_bin</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_file"><span class="LIDENT">from_file</span></span> <span class="EQUAL">=</span> <span class="LIDENT">open_in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_file_bin"><span class="LIDENT">from_file_bin</span></span> <span class="EQUAL">=</span> <span class="LIDENT">open_in_bin</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-from_channel"><span class="LIDENT">from_channel</span></span> <span id="local_ic_52"><span class="LIDENT">ic</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">from_ic_raise_at_end</span> <span class="LPAREN">(</span><span class="UIDENT">From_channel</span> <a href="#local_ic_52"><span class="LIDENT">ic</span></a><span class="RPAREN">)</span> <a href="#local_ic_52"><span class="LIDENT">ic</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Scanning.val-close_in"><span class="LIDENT">close_in</span></span> <span id="local_ib_53"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_ib_53"><span class="LIDENT">ib</span></a><span class="DOT">.</span><span class="LIDENT">ic_input_name</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_channel</span> <span id="local_ic_54"><span class="LIDENT">ic</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-close_in"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">close_in</span></a> <a href="#local_ic_54"><span class="LIDENT">ic</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_file</span> <span class="LPAREN">(</span><span id="local__fname_55"><span class="LIDENT">_fname</span></span><span class="COMMA">,</span> <span id="local_ic_56"><span class="LIDENT">ic</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-close_in"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">close_in</span></a> <a href="#local_ic_56"><span class="LIDENT">ic</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">From_function</span> <span class="BAR">|</span> <span class="UIDENT">From_string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Formatted input functions. *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-scanner"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="LIDENT">scanner</span> <span class="EQUAL">=</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">c</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-scanner_opt"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="LIDENT">scanner_opt</span> <span class="EQUAL">=</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">d</span> <span class="LIDENT">option</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">c</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Reporting errors. *)</span><span class="EOL">
</span><span id="exception-Scan_failure"><span class="EXCEPTION">exception</span> <span class="UIDENT">Scan_failure</span> <span class="OF">of</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bad_input"><span class="LIDENT">bad_input</span></span> <span id="local_s_57"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scan_failure</span> <a href="#local_s_57"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bad_input_escape"><span class="LIDENT">bad_input_escape</span></span> <span id="local_c_58"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">bad_input</span> <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;illegal escape character %C&quot;</span> <a href="#local_c_58"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bad_token_length"><span class="LIDENT">bad_token_length</span></span> <span id="local_message_59"><span class="LIDENT">message</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">bad_input</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>       <span class="STRING">&quot;scanning of %s failed: \
        the specified length was too short for token&quot;</span><span class="EOL">
</span>       <a href="#local_message_59"><span class="LIDENT">message</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bad_end_of_input"><span class="LIDENT">bad_end_of_input</span></span> <span id="local_message_60"><span class="LIDENT">message</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">bad_input</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>       <span class="STRING">&quot;scanning of %s failed: \
        premature end of file occurred before end of token&quot;</span><span class="EOL">
</span>       <a href="#local_message_60"><span class="LIDENT">message</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bad_float"><span class="LIDENT">bad_float</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">bad_input</span> <span class="STRING">&quot;no dot or exponent part found in float token&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bad_hex_float"><span class="LIDENT">bad_hex_float</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">bad_input</span> <span class="STRING">&quot;not a valid float in hexadecimal notation&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-character_mismatch_err"><span class="LIDENT">character_mismatch_err</span></span> <span id="local_c_61"><span class="LIDENT">c</span></span> <span id="local_ci_62"><span class="LIDENT">ci</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;looking for %C, found %C&quot;</span> <a href="#local_c_61"><span class="LIDENT">c</span></a> <a href="#local_ci_62"><span class="LIDENT">ci</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-character_mismatch"><span class="LIDENT">character_mismatch</span></span> <span id="local_c_63"><span class="LIDENT">c</span></span> <span id="local_ci_64"><span class="LIDENT">ci</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">bad_input</span> <span class="LPAREN">(</span><span class="LIDENT">character_mismatch_err</span> <a href="#local_c_63"><span class="LIDENT">c</span></a> <a href="#local_ci_64"><span class="LIDENT">ci</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-skip_whites"><span class="LIDENT">skip_whites</span></span> <span id="local_ib_65"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_66"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_65"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_65"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_c_66"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="BAR">|</span> <span class="CHAR">'\t'</span> <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">invalidate_current_char</span> <a href="#local_ib_65"><span class="LIDENT">ib</span></a><span class="SEMI">;</span> <span class="LIDENT">skip_whites</span> <a href="#local_ib_65"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Checking that [c] is indeed in the input, then skips it.
   In this case, the character [c] has been explicitly specified in the
   format as being mandatory in the input; hence we should fail with
   [End_of_file] in case of end_of_input.
   (Remember that [Scan_failure] is raised only when (we can prove by
   evidence) that the input does not match the format string given. We must
   thus differentiate [End_of_file] as an error due to lack of input, and
   [Scan_failure] which is due to provably wrong input. I am not sure this is
   worth the burden: it is complex and somehow subliminal; should be clearer
   to fail with Scan_failure &quot;Not enough input to complete scanning&quot;!)

   That's why, waiting for a better solution, we use checked_peek_char here.
   We are also careful to treat &quot;\r\n&quot; in the input as an end of line marker:
   it always matches a '\n' specification in the input format string. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-check_char"><span class="LIDENT">check_char</span></span> <span id="local_ib_67"><span class="LIDENT">ib</span></span> <span id="local_c_68"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_68"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">skip_whites</span> <a href="#local_ib_67"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">check_newline</span> <a href="#local_ib_67"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_c_69"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">check_this_char</span> <a href="#local_ib_67"><span class="LIDENT">ib</span></a> <a href="#local_c_69"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-check_this_char"><span class="LIDENT">check_this_char</span></span> <span id="local_ib_70"><span class="LIDENT">ib</span></span> <span id="local_c_71"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ci_72"><span class="LIDENT">ci</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_70"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_ci_72"><span class="LIDENT">ci</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c_71"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">invalidate_current_char</span> <a href="#local_ib_70"><span class="LIDENT">ib</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LIDENT">character_mismatch</span> <a href="#local_c_71"><span class="LIDENT">c</span></a> <a href="#local_ci_72"><span class="LIDENT">ci</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-check_newline"><span class="LIDENT">check_newline</span></span> <span id="local_ib_73"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ci_74"><span class="LIDENT">ci</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_73"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_ci_74"><span class="LIDENT">ci</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">invalidate_current_char</span> <a href="#local_ib_73"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">invalidate_current_char</span> <a href="#local_ib_73"><span class="LIDENT">ib</span></a><span class="SEMI">;</span> <span class="LIDENT">check_this_char</span> <a href="#local_ib_73"><span class="LIDENT">ib</span></a> <span class="CHAR">'\n'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">character_mismatch</span> <span class="CHAR">'\n'</span> <a href="#local_ci_74"><span class="LIDENT">ci</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Extracting tokens from the output token buffer. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_char"><span class="LIDENT">token_char</span></span> <span id="local_ib_75"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_75"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_string"><span class="LIDENT">token_string</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_bool"><span class="LIDENT">token_bool</span></span> <span id="local_ib_76"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_76"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="STRING">&quot;true&quot;</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="STRING">&quot;false&quot;</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_s_77"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_input</span> <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;invalid boolean '%s'&quot;</span> <a href="#local_s_77"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The type of integer conversions. *)</span><span class="EOL">
</span><span id="type-integer_conversion"><span class="TYPE">type</span> <span class="LIDENT">integer_conversion</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-integer_conversion.constructor-B_conversion"><span class="BAR">|</span> <span class="UIDENT">B_conversion</span></span> <span class="COMMENT">(* Unsigned binary conversion *)</span><span class="EOL">
</span>  <span id="type-integer_conversion.constructor-D_conversion"><span class="BAR">|</span> <span class="UIDENT">D_conversion</span></span> <span class="COMMENT">(* Signed decimal conversion *)</span><span class="EOL">
</span>  <span id="type-integer_conversion.constructor-I_conversion"><span class="BAR">|</span> <span class="UIDENT">I_conversion</span></span> <span class="COMMENT">(* Signed integer conversion *)</span><span class="EOL">
</span>  <span id="type-integer_conversion.constructor-O_conversion"><span class="BAR">|</span> <span class="UIDENT">O_conversion</span></span> <span class="COMMENT">(* Unsigned octal conversion *)</span><span class="EOL">
</span>  <span id="type-integer_conversion.constructor-U_conversion"><span class="BAR">|</span> <span class="UIDENT">U_conversion</span></span> <span class="COMMENT">(* Unsigned decimal conversion *)</span><span class="EOL">
</span>  <span id="type-integer_conversion.constructor-X_conversion"><span class="BAR">|</span> <span class="UIDENT">X_conversion</span></span></span> <span class="COMMENT">(* Unsigned hexadecimal conversion *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-integer_conversion_of_char"><span class="LIDENT">integer_conversion_of_char</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'b'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">B_conversion</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'d'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">D_conversion</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'i'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">I_conversion</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'o'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">O_conversion</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'u'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">U_conversion</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'x'</span> <span class="BAR">|</span> <span class="CHAR">'X'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">X_conversion</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Extract an integer literal token.
   Since the functions Stdlib.*int*_of_string do not accept a leading +,
   we skip it if necessary. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_int_literal"><span class="LIDENT">token_int_literal</span></span> <span id="local_conv_78"><span class="LIDENT">conv</span></span> <span id="local_ib_79"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_tok_80"><span class="LIDENT">tok</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_conv_78"><span class="LIDENT">conv</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">D_conversion</span> <span class="BAR">|</span> <span class="UIDENT">I_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_79"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">U_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;0u&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_79"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">O_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;0o&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_79"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">X_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;0x&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_79"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">B_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;0b&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_79"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_81"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_tok_80"><span class="LIDENT">tok</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_l_81"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_tok_80"><span class="LIDENT">tok</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="CHAR">'+'</span> <span class="THEN">then</span> <a href="#local_tok_80"><span class="LIDENT">tok</span></a> <span class="ELSE">else</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_tok_80"><span class="LIDENT">tok</span></a> <span class="INT">1</span> <span class="LPAREN">(</span><a href="#local_l_81"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* All the functions that convert a string to a number raise the exception
   Failure when the conversion is not possible.
   This exception is then trapped in [kscanf]. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_int"><span class="LIDENT">token_int</span></span> <span id="local_conv_82"><span class="LIDENT">conv</span></span> <span id="local_ib_83"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-int_of_string"><span class="LIDENT">int_of_string</span></a> <span class="LPAREN">(</span><span class="LIDENT">token_int_literal</span> <a href="#local_conv_82"><span class="LIDENT">conv</span></a> <a href="#local_ib_83"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_float"><span class="LIDENT">token_float</span></span> <span id="local_ib_84"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-float_of_string"><span class="LIDENT">float_of_string</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token</span> <a href="#local_ib_84"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To scan native ints, int32 and int64 integers.
   We cannot access to conversions to/from strings for those types,
   Nativeint.of_string, Int32.of_string, and Int64.of_string,
   since those modules are not available to [Scanf].
   However, we can bind and use the corresponding primitives that are
   available in the runtime. *)</span><span class="EOL">
</span><span id="val-nativeint_of_string"><span class="EXTERNAL">external</span> <span class="LIDENT">nativeint_of_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">nativeint</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_nativeint_of_string&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-int32_of_string"><span class="EXTERNAL">external</span> <span class="LIDENT">int32_of_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_int32_of_string&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-int64_of_string"><span class="EXTERNAL">external</span> <span class="LIDENT">int64_of_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_int64_of_string&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_nativeint"><span class="LIDENT">token_nativeint</span></span> <span id="local_conv_85"><span class="LIDENT">conv</span></span> <span id="local_ib_86"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">nativeint_of_string</span> <span class="LPAREN">(</span><span class="LIDENT">token_int_literal</span> <a href="#local_conv_85"><span class="LIDENT">conv</span></a> <a href="#local_ib_86"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_int32"><span class="LIDENT">token_int32</span></span> <span id="local_conv_87"><span class="LIDENT">conv</span></span> <span id="local_ib_88"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">int32_of_string</span> <span class="LPAREN">(</span><span class="LIDENT">token_int_literal</span> <a href="#local_conv_87"><span class="LIDENT">conv</span></a> <a href="#local_ib_88"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-token_int64"><span class="LIDENT">token_int64</span></span> <span id="local_conv_89"><span class="LIDENT">conv</span></span> <span id="local_ib_90"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">int64_of_string</span> <span class="LPAREN">(</span><span class="LIDENT">token_int_literal</span> <a href="#local_conv_89"><span class="LIDENT">conv</span></a> <a href="#local_ib_90"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scanning numbers. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Digits scanning functions suppose that one character has been checked and
   is available, since they return at end of file with the currently found
   token selected.

   Put it in another way, the digits scanning functions scan for a possibly
   empty sequence of digits, (hence, a successful scanning from one of those
   functions does not imply that the token is a well-formed number: to get a
   true number, it is mandatory to check that at least one valid digit is
   available before calling one of the digit scanning functions). *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The decimal case is treated especially for optimization purposes. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-scan_decimal_digit_star"><span class="LIDENT">scan_decimal_digit_star</span></span> <span id="local_width_91"><span class="LIDENT">width</span></span> <span id="local_ib_92"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_91"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_91"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_93"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_92"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_92"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_91"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_93"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_94"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_95"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_91"><span class="LIDENT">width</span></a> <a href="#local_ib_92"><span class="LIDENT">ib</span></a> <a href="#local_c_94"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_decimal_digit_star</span> <a href="#local_width_95"><span class="LIDENT">width</span></a> <a href="#local_ib_92"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'_'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_96"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_91"><span class="LIDENT">width</span></a> <a href="#local_ib_92"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_decimal_digit_star</span> <a href="#local_width_96"><span class="LIDENT">width</span></a> <a href="#local_ib_92"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_91"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_decimal_digit_plus"><span class="LIDENT">scan_decimal_digit_plus</span></span> <span id="local_width_97"><span class="LIDENT">width</span></span> <span id="local_ib_98"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_97"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">bad_token_length</span> <span class="STRING">&quot;decimal digits&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_99"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_98"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_99"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_100"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_97"><span class="LIDENT">width</span></a> <a href="#local_ib_98"><span class="LIDENT">ib</span></a> <a href="#local_c_99"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_decimal_digit_star</span> <a href="#local_width_100"><span class="LIDENT">width</span></a> <a href="#local_ib_98"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_c_101"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">bad_input</span> <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;character %C is not a decimal digit&quot;</span> <a href="#local_c_101"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To scan numbers from other bases, we use a predicate argument to
   scan digits. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_digit_star"><span class="LIDENT">scan_digit_star</span></span> <span id="local_digitp_102"><span class="LIDENT">digitp</span></span> <span id="local_width_103"><span class="LIDENT">width</span></span> <span id="local_ib_104"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_scan_digits_105"><span class="LIDENT">scan_digits</span></span> <span id="local_width_106"><span class="LIDENT">width</span></span> <span id="local_ib_107"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_106"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_106"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_108"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_107"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_107"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_106"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_c_108"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_109"><span class="LIDENT">c</span></span> <span class="WHEN">when</span> <a href="#local_digitp_102"><span class="LIDENT">digitp</span></a> <a href="#local_c_109"><span class="LIDENT">c</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_width_110"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_106"><span class="LIDENT">width</span></a> <a href="#local_ib_107"><span class="LIDENT">ib</span></a> <a href="#local_c_109"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_scan_digits_105"><span class="LIDENT">scan_digits</span></a> <a href="#local_width_110"><span class="LIDENT">width</span></a> <a href="#local_ib_107"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'_'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_width_111"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_106"><span class="LIDENT">width</span></a> <a href="#local_ib_107"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_scan_digits_105"><span class="LIDENT">scan_digits</span></a> <a href="#local_width_111"><span class="LIDENT">width</span></a> <a href="#local_ib_107"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_106"><span class="LIDENT">width</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_scan_digits_105"><span class="LIDENT">scan_digits</span></a> <a href="#local_width_103"><span class="LIDENT">width</span></a> <a href="#local_ib_104"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_digit_plus"><span class="LIDENT">scan_digit_plus</span></span> <span id="local_basis_112"><span class="LIDENT">basis</span></span> <span id="local_digitp_113"><span class="LIDENT">digitp</span></span> <span id="local_width_114"><span class="LIDENT">width</span></span> <span id="local_ib_115"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* Ensure we have got enough width left,
     and read at least one digit. *)</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_114"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">bad_token_length</span> <span class="STRING">&quot;digits&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_116"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_115"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_digitp_113"><span class="LIDENT">digitp</span></a> <a href="#local_c_116"><span class="LIDENT">c</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_117"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_114"><span class="LIDENT">width</span></a> <a href="#local_ib_115"><span class="LIDENT">ib</span></a> <a href="#local_c_116"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_digit_star</span> <a href="#local_digitp_113"><span class="LIDENT">digitp</span></a> <a href="#local_width_117"><span class="LIDENT">width</span></a> <a href="#local_ib_115"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">bad_input</span> <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;character %C is not a valid %s digit&quot;</span> <a href="#local_c_116"><span class="LIDENT">c</span></a> <a href="#local_basis_112"><span class="LIDENT">basis</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_binary_digit"><span class="LIDENT">is_binary_digit</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'1'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_binary_int"><span class="LIDENT">scan_binary_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_digit_plus</span> <span class="STRING">&quot;binary&quot;</span> <span class="LIDENT">is_binary_digit</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_octal_digit"><span class="LIDENT">is_octal_digit</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'7'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_octal_int"><span class="LIDENT">scan_octal_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_digit_plus</span> <span class="STRING">&quot;octal&quot;</span> <span class="LIDENT">is_octal_digit</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_hexa_digit"><span class="LIDENT">is_hexa_digit</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'a'</span> <span class="DOTDOT">..</span> <span class="CHAR">'f'</span> <span class="BAR">|</span> <span class="CHAR">'A'</span> <span class="DOTDOT">..</span> <span class="CHAR">'F'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_hexadecimal_int"><span class="LIDENT">scan_hexadecimal_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_digit_plus</span> <span class="STRING">&quot;hexadecimal&quot;</span> <span class="LIDENT">is_hexa_digit</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a decimal integer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_unsigned_decimal_int"><span class="LIDENT">scan_unsigned_decimal_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_decimal_digit_plus</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_sign"><span class="LIDENT">scan_sign</span></span> <span id="local_width_118"><span class="LIDENT">width</span></span> <span id="local_ib_119"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_120"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_119"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_120"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'+'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_118"><span class="LIDENT">width</span></a> <a href="#local_ib_119"><span class="LIDENT">ib</span></a> <a href="#local_c_120"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_118"><span class="LIDENT">width</span></a> <a href="#local_ib_119"><span class="LIDENT">ib</span></a> <a href="#local_c_120"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_118"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_optionally_signed_decimal_int"><span class="LIDENT">scan_optionally_signed_decimal_int</span></span> <span id="local_width_121"><span class="LIDENT">width</span></span> <span id="local_ib_122"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_123"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_sign</span> <a href="#local_width_121"><span class="LIDENT">width</span></a> <a href="#local_ib_122"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">scan_unsigned_decimal_int</span> <a href="#local_width_123"><span class="LIDENT">width</span></a> <a href="#local_ib_122"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan an unsigned integer that could be given in any (common) basis.
   If digits are prefixed by one of 0x, 0X, 0o, or 0b, the number is
   assumed to be written respectively in hexadecimal, hexadecimal,
   octal, or binary. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_unsigned_int"><span class="LIDENT">scan_unsigned_int</span></span> <span id="local_width_124"><span class="LIDENT">width</span></span> <span id="local_ib_125"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="AS">as</span> <span id="local_c_126"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_127"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_124"><span class="LIDENT">width</span></a> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <a href="#local_c_126"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_128"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_c_128"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'x'</span> <span class="BAR">|</span> <span class="CHAR">'X'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_hexadecimal_int</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <a href="#local_c_128"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <a href="#local_ib_125"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'o'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_octal_int</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <a href="#local_c_128"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <a href="#local_ib_125"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'b'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_binary_int</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <a href="#local_c_128"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <a href="#local_ib_125"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_decimal_digit_star</span> <a href="#local_width_127"><span class="LIDENT">width</span></a> <a href="#local_ib_125"><span class="LIDENT">ib</span></a> <span class="END">end</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_unsigned_decimal_int</span> <a href="#local_width_124"><span class="LIDENT">width</span></a> <a href="#local_ib_125"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_optionally_signed_int"><span class="LIDENT">scan_optionally_signed_int</span></span> <span id="local_width_129"><span class="LIDENT">width</span></span> <span id="local_ib_130"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_131"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_sign</span> <a href="#local_width_129"><span class="LIDENT">width</span></a> <a href="#local_ib_130"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">scan_unsigned_int</span> <a href="#local_width_131"><span class="LIDENT">width</span></a> <a href="#local_ib_130"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_int_conversion"><span class="LIDENT">scan_int_conversion</span></span> <span id="local_conv_132"><span class="LIDENT">conv</span></span> <span id="local_width_133"><span class="LIDENT">width</span></span> <span id="local_ib_134"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_conv_132"><span class="LIDENT">conv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">B_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_binary_int</span> <a href="#local_width_133"><span class="LIDENT">width</span></a> <a href="#local_ib_134"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">D_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_optionally_signed_decimal_int</span> <a href="#local_width_133"><span class="LIDENT">width</span></a> <a href="#local_ib_134"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">I_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_optionally_signed_int</span> <a href="#local_width_133"><span class="LIDENT">width</span></a> <a href="#local_ib_134"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">O_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_octal_int</span> <a href="#local_width_133"><span class="LIDENT">width</span></a> <a href="#local_ib_134"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">U_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_unsigned_decimal_int</span> <a href="#local_width_133"><span class="LIDENT">width</span></a> <a href="#local_ib_134"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">X_conversion</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_hexadecimal_int</span> <a href="#local_width_133"><span class="LIDENT">width</span></a> <a href="#local_ib_134"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scanning floating point numbers. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Fractional part is optional and can be reduced to 0 digits. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_fractional_part"><span class="LIDENT">scan_fractional_part</span></span> <span id="local_width_135"><span class="LIDENT">width</span></span> <span id="local_ib_136"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_135"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_135"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_137"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_136"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_136"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_135"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_137"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_138"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">scan_decimal_digit_star</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_135"><span class="LIDENT">width</span></a> <a href="#local_ib_136"><span class="LIDENT">ib</span></a> <a href="#local_c_138"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <a href="#local_ib_136"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_135"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Exp part is optional and can be reduced to 0 digits. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_exponent_part"><span class="LIDENT">scan_exponent_part</span></span> <span id="local_width_139"><span class="LIDENT">width</span></span> <span id="local_ib_140"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_139"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_139"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_141"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_140"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_140"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_139"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_141"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'e'</span> <span class="BAR">|</span> <span class="CHAR">'E'</span> <span class="AS">as</span> <span id="local_c_142"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">scan_optionally_signed_decimal_int</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_139"><span class="LIDENT">width</span></a> <a href="#local_ib_140"><span class="LIDENT">ib</span></a> <a href="#local_c_142"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <a href="#local_ib_140"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_139"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan the integer part of a floating point number, (not using the
   OCaml lexical convention since the integer part can be empty):
   an optional sign, followed by a possibly empty sequence of decimal
   digits (e.g. -.1). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_integer_part"><span class="LIDENT">scan_integer_part</span></span> <span id="local_width_143"><span class="LIDENT">width</span></span> <span id="local_ib_144"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_145"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_sign</span> <a href="#local_width_143"><span class="LIDENT">width</span></a> <a href="#local_ib_144"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">scan_decimal_digit_star</span> <a href="#local_width_145"><span class="LIDENT">width</span></a> <a href="#local_ib_144"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*
   For the time being we have (as found in scanf.mli):
   the field width is composed of an optional integer literal
   indicating the maximal width of the token to read.
   Unfortunately, the type-checker let the user write an optional precision,
   since this is valid for printf format strings.

   Thus, the next step for Scanf is to support a full width and precision
   indication, more or less similar to the one for printf, possibly extended
   to the specification of a [max, min] range for the width of the token read
   for strings. Something like the following spec for scanf.mli:

   The optional [width] is an integer indicating the maximal
   width of the token read. For instance, [%6d] reads an integer,
   having at most 6 characters.

   The optional [precision] is a dot [.] followed by an integer:

   - in the floating point number conversions ([%f], [%e], [%g], [%F], [%E],
   and [%F] conversions, the [precision] indicates the maximum number of
   digits that may follow the decimal point. For instance, [%.4f] reads a
   [float] with at most 4 fractional digits,

   - in the string conversions ([%s], [%S], [%\[ range \]]), and in the
   integer number conversions ([%i], [%d], [%u], [%x], [%o], and their
   [int32], [int64], and [native_int] correspondent), the [precision]
   indicates the required minimum width of the token read,

   - on all other conversions, the width and precision specify the [max, min]
   range for the width of the token read.
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_float"><span class="LIDENT">scan_float</span></span> <span id="local_width_146"><span class="LIDENT">width</span></span> <span id="local_precision_147"><span class="LIDENT">precision</span></span> <span id="local_ib_148"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_149"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_integer_part</span> <a href="#local_width_146"><span class="LIDENT">width</span></a> <a href="#local_ib_148"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_149"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_149"><span class="LIDENT">width</span></a><span class="COMMA">,</span> <a href="#local_precision_147"><span class="LIDENT">precision</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_150"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_148"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_148"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_149"><span class="LIDENT">width</span></a><span class="COMMA">,</span> <a href="#local_precision_147"><span class="LIDENT">precision</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_150"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_151"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_149"><span class="LIDENT">width</span></a> <a href="#local_ib_148"><span class="LIDENT">ib</span></a> <a href="#local_c_150"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_precision_152"><span class="LIDENT">precision</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <a href="#local_width_151"><span class="LIDENT">width</span></a> <a href="#local_precision_147"><span class="LIDENT">precision</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_153"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <a href="#local_width_151"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_precision_152"><span class="LIDENT">precision</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">scan_fractional_part</span> <a href="#local_precision_152"><span class="LIDENT">precision</span></a> <a href="#local_ib_148"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_exponent_part</span> <a href="#local_width_153"><span class="LIDENT">width</span></a> <a href="#local_ib_148"><span class="LIDENT">ib</span></a><span class="COMMA">,</span> <a href="#local_precision_152"><span class="LIDENT">precision</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">scan_exponent_part</span> <a href="#local_width_149"><span class="LIDENT">width</span></a> <a href="#local_ib_148"><span class="LIDENT">ib</span></a><span class="COMMA">,</span> <a href="#local_precision_147"><span class="LIDENT">precision</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-check_case_insensitive_string"><span class="LIDENT">check_case_insensitive_string</span></span> <span id="local_width_154"><span class="LIDENT">width</span></span> <span id="local_ib_155"><span class="LIDENT">ib</span></span> <span id="local_error_156"><span class="LIDENT">error</span></span> <span id="local_str_157"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_lowercase_158"><span class="LIDENT">lowercase</span></span> <span id="local_c_159"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_c_159"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'A'</span> <span class="DOTDOT">..</span> <span class="CHAR">'Z'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_159"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'A'</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'a'</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_c_159"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_160"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_157"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_161"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_width_154"><span class="LIDENT">width</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_len_160"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_162"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_155"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_lowercase_158"><span class="LIDENT">lowercase</span></a> <a href="#local_c_162"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_lowercase_158"><span class="LIDENT">lowercase</span></a> <a href="#local_str_157"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="LIDENT">i</span><span class="RBRACKET">]</span> <span class="THEN">then</span> <a href="#local_error_156"><span class="LIDENT">error</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_width_161"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_error_156"><span class="LIDENT">error</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_width_161"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_width_161"><span class="LIDENT">width</span></a> <a href="#local_ib_155"><span class="LIDENT">ib</span></a> <a href="#local_c_162"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_width_161"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_hex_float"><span class="LIDENT">scan_hex_float</span></span> <span id="local_width_163"><span class="LIDENT">width</span></span> <span id="local_precision_164"><span class="LIDENT">precision</span></span> <span id="local_ib_165"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_163"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_166"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_sign</span> <a href="#local_width_163"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_166"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="AS">as</span> <span id="local_c_167"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_168"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_166"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <a href="#local_c_167"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_168"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_169"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">check_case_insensitive_string</span> <a href="#local_width_168"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="LIDENT">bad_hex_float</span> <span class="STRING">&quot;x&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_169"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_169"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_width_170"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="BAR">|</span> <span class="CHAR">'p'</span> <span class="BAR">|</span> <span class="CHAR">'P'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_169"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">scan_hexadecimal_int</span> <a href="#local_width_169"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_width_170"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_170"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_width_171"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="AS">as</span> <span id="local_c_172"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_width_173"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_170"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <a href="#local_c_172"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_width_173"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_173"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>              <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="CHAR">'p'</span> <span class="BAR">|</span> <span class="CHAR">'P'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_173"><span class="LIDENT">width</span></a><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_precision_174"><span class="LIDENT">precision</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <a href="#local_width_173"><span class="LIDENT">width</span></a> <a href="#local_precision_164"><span class="LIDENT">precision</span></a> <span class="IN">in</span><span class="EOL">
</span>                <a href="#local_width_173"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_precision_174"><span class="LIDENT">precision</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">scan_hexadecimal_int</span> <a href="#local_precision_174"><span class="LIDENT">precision</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_170"><span class="LIDENT">width</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_width_171"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_171"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>          <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="CHAR">'p'</span> <span class="BAR">|</span> <span class="CHAR">'P'</span> <span class="AS">as</span> <span id="local_c_175"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_width_176"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_171"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <a href="#local_c_175"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="IF">if</span> <a href="#local_width_176"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">scan_optionally_signed_decimal_int</span> <a href="#local_width_176"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_171"><span class="LIDENT">width</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'n'</span> <span class="BAR">|</span> <span class="CHAR">'N'</span> <span class="AS">as</span> <span id="local_c_177"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_178"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_166"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <a href="#local_c_177"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_178"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">check_case_insensitive_string</span> <a href="#local_width_178"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="LIDENT">bad_hex_float</span> <span class="STRING">&quot;an&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'i'</span> <span class="BAR">|</span> <span class="CHAR">'I'</span> <span class="AS">as</span> <span id="local_c_179"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_180"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_166"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <a href="#local_c_179"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_180"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">check_case_insensitive_string</span> <a href="#local_width_180"><span class="LIDENT">width</span></a> <a href="#local_ib_165"><span class="LIDENT">ib</span></a> <span class="LIDENT">bad_hex_float</span> <span class="STRING">&quot;nfinity&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_caml_float_rest"><span class="LIDENT">scan_caml_float_rest</span></span> <span id="local_width_181"><span class="LIDENT">width</span></span> <span id="local_precision_182"><span class="LIDENT">precision</span></span> <span id="local_ib_183"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_181"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_183"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_184"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_decimal_digit_star</span> <a href="#local_width_181"><span class="LIDENT">width</span></a> <a href="#local_ib_183"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_184"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_183"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_185"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_183"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_c_185"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_186"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_184"><span class="LIDENT">width</span></a> <a href="#local_ib_183"><span class="LIDENT">ib</span></a> <a href="#local_c_185"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* The effective width available for scanning the fractional part is
       the minimum of declared precision and width left. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_precision_187"><span class="LIDENT">precision</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <a href="#local_width_186"><span class="LIDENT">width</span></a> <a href="#local_precision_182"><span class="LIDENT">precision</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* After scanning the fractional part with [precision] provisional width,
       [width_precision] is left. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_precision_188"><span class="LIDENT">width_precision</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_fractional_part</span> <a href="#local_precision_187"><span class="LIDENT">precision</span></a> <a href="#local_ib_183"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* Hence, scanning the fractional part took exactly
       [precision - width_precision] chars. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_frac_width_189"><span class="LIDENT">frac_width</span></span> <span class="EQUAL">=</span> <a href="#local_precision_187"><span class="LIDENT">precision</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_width_precision_188"><span class="LIDENT">width_precision</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* And new provisional width is [width - width_precision. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_190"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <a href="#local_width_186"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_frac_width_189"><span class="LIDENT">frac_width</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_exponent_part</span> <a href="#local_width_190"><span class="LIDENT">width</span></a> <a href="#local_ib_183"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'e'</span> <span class="BAR">|</span> <span class="CHAR">'E'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">scan_exponent_part</span> <a href="#local_width_184"><span class="LIDENT">width</span></a> <a href="#local_ib_183"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_caml_float"><span class="LIDENT">scan_caml_float</span></span> <span id="local_width_191"><span class="LIDENT">width</span></span> <span id="local_precision_192"><span class="LIDENT">precision</span></span> <span id="local_ib_193"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_191"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_width_194"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_sign</span> <a href="#local_width_191"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_194"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="AS">as</span> <span id="local_c_195"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_196"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_194"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <a href="#local_c_195"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_196"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'x'</span> <span class="BAR">|</span> <span class="CHAR">'X'</span> <span class="AS">as</span> <span id="local_c_197"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_width_198"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_196"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <a href="#local_c_197"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_width_198"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_width_199"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_hexadecimal_int</span> <a href="#local_width_198"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_width_199"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_width_200"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="AS">as</span> <span id="local_c_201"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_width_202"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_199"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <a href="#local_c_201"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_width_202"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_202"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>            <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="CHAR">'p'</span> <span class="BAR">|</span> <span class="CHAR">'P'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_202"><span class="LIDENT">width</span></a><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="LET">let</span> <span id="local_precision_203"><span class="LIDENT">precision</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <a href="#local_width_202"><span class="LIDENT">width</span></a> <a href="#local_precision_192"><span class="LIDENT">precision</span></a> <span class="IN">in</span><span class="EOL">
</span>              <a href="#local_width_202"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LPAREN">(</span><a href="#local_precision_203"><span class="LIDENT">precision</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">scan_hexadecimal_int</span> <a href="#local_precision_203"><span class="LIDENT">precision</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'p'</span> <span class="BAR">|</span> <span class="CHAR">'P'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_199"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_width_200"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_200"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'p'</span> <span class="BAR">|</span> <span class="CHAR">'P'</span> <span class="AS">as</span> <span id="local_c_204"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_width_205"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_200"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <a href="#local_c_204"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_width_205"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_hex_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">scan_optionally_signed_decimal_int</span> <a href="#local_width_205"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_200"><span class="LIDENT">width</span></a><span class="EOL">
</span>    <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">scan_caml_float_rest</span> <a href="#local_width_196"><span class="LIDENT">width</span></a> <a href="#local_precision_192"><span class="LIDENT">precision</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'1'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_206"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_207"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_194"><span class="LIDENT">width</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <a href="#local_c_206"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_207"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_193"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">scan_caml_float_rest</span> <a href="#local_width_207"><span class="LIDENT">width</span></a> <a href="#local_precision_192"><span class="LIDENT">precision</span></a> <a href="#local_ib_193"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="COMMENT">(* Special case of nan and infinity:
  | 'i' -&gt;
  | 'n' -&gt;
*)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_float</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a regular string:
   stops when encountering a space, if no scanning indication has been given;
   otherwise, stops when encountering the characters in the scanning
   indication [stp].
   It also stops at end of file or when the maximum number of characters has
   been read. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_string"><span class="LIDENT">scan_string</span></span> <span id="local_stp_208"><span class="LIDENT">stp</span></span> <span id="local_width_209"><span class="LIDENT">width</span></span> <span id="local_ib_210"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_211"><span class="LIDENT">loop</span></span> <span id="local_width_212"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_212"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_width_212"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_213"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_210"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_210"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <a href="#local_width_212"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_stp_208"><span class="LIDENT">stp</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_c'_214"><span class="LIDENT">c'</span></span> <span class="WHEN">when</span> <a href="#local_c_213"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c'_214"><span class="LIDENT">c'</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">skip_char</span> <a href="#local_width_212"><span class="LIDENT">width</span></a> <a href="#local_ib_210"><span class="LIDENT">ib</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_211"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_212"><span class="LIDENT">width</span></a> <a href="#local_ib_210"><span class="LIDENT">ib</span></a> <a href="#local_c_213"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_c_213"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="BAR">|</span> <span class="CHAR">'\t'</span> <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_212"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_211"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_212"><span class="LIDENT">width</span></a> <a href="#local_ib_210"><span class="LIDENT">ib</span></a> <a href="#local_c_213"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_211"><span class="LIDENT">loop</span></a> <a href="#local_width_209"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a char: peek strictly one character in the input, whatsoever. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_char"><span class="LIDENT">scan_char</span></span> <span id="local_width_215"><span class="LIDENT">width</span></span> <span id="local_ib_216"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* The case width = 0 could not happen here, since it is tested before
     calling scan_char, in the main scanning function.
    if width = 0 then bad_token_length &quot;a character&quot; else *)</span><span class="EOL">
</span>  <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_215"><span class="LIDENT">width</span></a> <a href="#local_ib_216"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_216"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_for_backslash"><span class="LIDENT">char_for_backslash</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'n'</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'\010'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'r'</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'\013'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'b'</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'\008'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'t'</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'\009'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_c_217"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_c_217"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The integer value corresponding to the facial value of a valid
   decimal digit character. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-decimal_value_of_char"><span class="LIDENT">decimal_value_of_char</span></span> <span id="local_c_218"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_218"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'0'</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_for_decimal_code"><span class="LIDENT">char_for_decimal_code</span></span> <span id="local_c0_219"><span class="LIDENT">c0</span></span> <span id="local_c1_220"><span class="LIDENT">c1</span></span> <span id="local_c2_221"><span class="LIDENT">c2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_222"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="INT">100</span> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">decimal_value_of_char</span> <a href="#local_c0_219"><span class="LIDENT">c0</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="EOL">
</span>     <span class="INT">10</span> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">decimal_value_of_char</span> <a href="#local_c1_220"><span class="LIDENT">c1</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="EOL">
</span>          <span class="LIDENT">decimal_value_of_char</span> <a href="#local_c2_221"><span class="LIDENT">c2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_c_222"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_c_222"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">255</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">bad_input</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a><span class="EOL">
</span>         <span class="STRING">&quot;bad character decimal encoding \\%c%c%c&quot;</span> <a href="#local_c0_219"><span class="LIDENT">c0</span></a> <a href="#local_c1_220"><span class="LIDENT">c1</span></a> <a href="#local_c2_221"><span class="LIDENT">c2</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_c_222"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The integer value corresponding to the facial value of a valid
   hexadecimal digit character. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-hexadecimal_value_of_char"><span class="LIDENT">hexadecimal_value_of_char</span></span> <span id="local_c_223"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_d_224"><span class="LIDENT">d</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_223"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* Could also be:
    if d &lt;= int_of_char '9' then d - int_of_char '0' else
    if d &lt;= int_of_char 'F' then 10 + d - int_of_char 'A' else
    if d &lt;= int_of_char 'f' then 10 + d - int_of_char 'a' else assert false
  *)</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_d_224"><span class="LIDENT">d</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'a'</span> <span class="THEN">then</span><span class="EOL">
</span>    <a href="#local_d_224"><span class="LIDENT">d</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">87</span> <span class="COMMENT">(* 10 + int_of_char c - int_of_char 'a' *)</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_d_224"><span class="LIDENT">d</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'A'</span> <span class="THEN">then</span><span class="EOL">
</span>    <a href="#local_d_224"><span class="LIDENT">d</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">55</span>  <span class="COMMENT">(* 10 + int_of_char c - int_of_char 'A' *)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <a href="#local_d_224"><span class="LIDENT">d</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'0'</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_for_hexadecimal_code"><span class="LIDENT">char_for_hexadecimal_code</span></span> <span id="local_c1_225"><span class="LIDENT">c1</span></span> <span id="local_c2_226"><span class="LIDENT">c2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_227"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="INT">16</span> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">hexadecimal_value_of_char</span> <a href="#local_c1_225"><span class="LIDENT">c1</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="EOL">
</span>         <span class="LIDENT">hexadecimal_value_of_char</span> <a href="#local_c2_226"><span class="LIDENT">c2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_c_227"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_c_227"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">255</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">bad_input</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;bad character hexadecimal encoding \\%c%c&quot;</span> <a href="#local_c1_225"><span class="LIDENT">c1</span></a> <a href="#local_c2_226"><span class="LIDENT">c2</span></a><span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_c_227"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Called in particular when encountering '\\' as starter of a char.
   Stops before the corresponding '\''. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-check_next_char"><span class="LIDENT">check_next_char</span></span> <span id="local_message_228"><span class="LIDENT">message</span></span> <span id="local_width_229"><span class="LIDENT">width</span></span> <span id="local_ib_230"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_229"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">bad_token_length</span> <a href="#local_message_228"><span class="LIDENT">message</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_231"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_230"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_230"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">bad_end_of_input</span> <a href="#local_message_228"><span class="LIDENT">message</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <a href="#local_c_231"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-check_next_char_for_char"><span class="LIDENT">check_next_char_for_char</span></span> <span class="EQUAL">=</span> <span class="LIDENT">check_next_char</span> <span class="STRING">&quot;a Char&quot;</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-check_next_char_for_string"><span class="LIDENT">check_next_char_for_string</span></span> <span class="EQUAL">=</span> <span class="LIDENT">check_next_char</span> <span class="STRING">&quot;a String&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_backslash_char"><span class="LIDENT">scan_backslash_char</span></span> <span id="local_width_232"><span class="LIDENT">width</span></span> <span id="local_ib_233"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_char</span> <a href="#local_width_232"><span class="LIDENT">width</span></a> <a href="#local_ib_233"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\\'</span> <span class="BAR">|</span> <span class="CHAR">'\''</span> <span class="BAR">|</span> <span class="CHAR">'\&quot;'</span> <span class="BAR">|</span> <span class="CHAR">'n'</span> <span class="BAR">|</span> <span class="CHAR">'t'</span> <span class="BAR">|</span> <span class="CHAR">'b'</span> <span class="BAR">|</span> <span class="CHAR">'r'</span> <span class="AS">as</span> <span id="local_c_234"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_232"><span class="LIDENT">width</span></a> <a href="#local_ib_233"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_for_backslash</span> <a href="#local_c_234"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_235"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_digit_236"><span class="LIDENT">get_digit</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_237"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">next_char</span> <a href="#local_ib_233"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_c_237"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_238"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_c_238"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_239"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_input_escape</span> <a href="#local_c_239"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c0_240"><span class="LIDENT">c0</span></span> <span class="EQUAL">=</span> <a href="#local_c_235"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c1_241"><span class="LIDENT">c1</span></span> <span class="EQUAL">=</span> <a href="#local_get_digit_236"><span class="LIDENT">get_digit</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c2_242"><span class="LIDENT">c2</span></span> <span class="EQUAL">=</span> <a href="#local_get_digit_236"><span class="LIDENT">get_digit</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <span class="LPAREN">(</span><a href="#local_width_232"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_ib_233"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_for_decimal_code</span> <a href="#local_c0_240"><span class="LIDENT">c0</span></a> <a href="#local_c1_241"><span class="LIDENT">c1</span></a> <a href="#local_c2_242"><span class="LIDENT">c2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'x'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_digit_243"><span class="LIDENT">get_digit</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_244"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">next_char</span> <a href="#local_ib_233"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_c_244"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'A'</span> <span class="DOTDOT">..</span> <span class="CHAR">'F'</span> <span class="BAR">|</span> <span class="CHAR">'a'</span> <span class="DOTDOT">..</span> <span class="CHAR">'f'</span> <span class="AS">as</span> <span id="local_c_245"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_c_245"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_246"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_input_escape</span> <a href="#local_c_246"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c1_247"><span class="LIDENT">c1</span></span> <span class="EQUAL">=</span> <a href="#local_get_digit_243"><span class="LIDENT">get_digit</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c2_248"><span class="LIDENT">c2</span></span> <span class="EQUAL">=</span> <a href="#local_get_digit_243"><span class="LIDENT">get_digit</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <span class="LPAREN">(</span><a href="#local_width_232"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_ib_233"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_for_hexadecimal_code</span> <a href="#local_c1_247"><span class="LIDENT">c1</span></a> <a href="#local_c2_248"><span class="LIDENT">c2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_c_249"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">bad_input_escape</span> <a href="#local_c_249"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a character (an OCaml token). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_caml_char"><span class="LIDENT">scan_caml_char</span></span> <span id="local_width_250"><span class="LIDENT">width</span></span> <span id="local_ib_251"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_find_start_252"><span class="LIDENT">find_start</span></span> <span id="local_width_253"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_251"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\''</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_find_char_255"><span class="LIDENT">find_char</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_253"><span class="LIDENT">width</span></a> <a href="#local_ib_251"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_254"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">character_mismatch</span> <span class="CHAR">'\''</span> <a href="#local_c_254"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_find_char_255"><span class="LIDENT">find_char</span></span> <span id="local_width_256"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_char</span> <a href="#local_width_256"><span class="LIDENT">width</span></a> <a href="#local_ib_251"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\\'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_find_stop_258"><span class="LIDENT">find_stop</span></a> <span class="LPAREN">(</span><span class="LIDENT">scan_backslash_char</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_256"><span class="LIDENT">width</span></a> <a href="#local_ib_251"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <a href="#local_ib_251"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_257"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_find_stop_258"><span class="LIDENT">find_stop</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_256"><span class="LIDENT">width</span></a> <a href="#local_ib_251"><span class="LIDENT">ib</span></a> <a href="#local_c_257"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_find_stop_258"><span class="LIDENT">find_stop</span></span> <span id="local_width_259"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_char</span> <a href="#local_width_259"><span class="LIDENT">width</span></a> <a href="#local_ib_251"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\''</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_259"><span class="LIDENT">width</span></a> <a href="#local_ib_251"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_260"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">character_mismatch</span> <span class="CHAR">'\''</span> <a href="#local_c_260"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <a href="#local_find_start_252"><span class="LIDENT">find_start</span></a> <a href="#local_width_250"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a delimited string (an OCaml token). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_caml_string"><span class="LIDENT">scan_caml_string</span></span> <span id="local_width_261"><span class="LIDENT">width</span></span> <span id="local_ib_262"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_find_start_263"><span class="LIDENT">find_start</span></span> <span id="local_width_264"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\&quot;'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_find_stop_266"><span class="LIDENT">find_stop</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_264"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_265"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">character_mismatch</span> <span class="CHAR">'\&quot;'</span> <a href="#local_c_265"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_find_stop_266"><span class="LIDENT">find_stop</span></span> <span id="local_width_267"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_string</span> <a href="#local_width_267"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\&quot;'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_267"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\\'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_scan_backslash_269"><span class="LIDENT">scan_backslash</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_267"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_268"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_find_stop_266"><span class="LIDENT">find_stop</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_267"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <a href="#local_c_268"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_scan_backslash_269"><span class="LIDENT">scan_backslash</span></span> <span id="local_width_270"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_string</span> <a href="#local_width_270"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_skip_newline_271"><span class="LIDENT">skip_newline</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_270"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_skip_spaces_273"><span class="LIDENT">skip_spaces</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_270"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_find_stop_266"><span class="LIDENT">find_stop</span></a> <span class="LPAREN">(</span><span class="LIDENT">scan_backslash_char</span> <a href="#local_width_270"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_skip_newline_271"><span class="LIDENT">skip_newline</span></span> <span id="local_width_272"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_string</span> <a href="#local_width_272"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_skip_spaces_273"><span class="LIDENT">skip_spaces</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_272"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_find_stop_266"><span class="LIDENT">find_stop</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="#local_width_272"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <span class="CHAR">'\r'</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_skip_spaces_273"><span class="LIDENT">skip_spaces</span></span> <span id="local_width_274"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">check_next_char_for_string</span> <a href="#local_width_274"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_skip_spaces_273"><span class="LIDENT">skip_spaces</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">ignore_char</span> <a href="#local_width_274"><span class="LIDENT">width</span></a> <a href="#local_ib_262"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_find_stop_266"><span class="LIDENT">find_stop</span></a> <a href="#local_width_274"><span class="LIDENT">width</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <a href="#local_find_start_263"><span class="LIDENT">find_start</span></a> <a href="#local_width_261"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a boolean (an OCaml token). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_bool"><span class="LIDENT">scan_bool</span></span> <span id="local_ib_275"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_276"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_275"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_m_277"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_c_276"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'t'</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">4</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'f'</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">5</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_278"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bad_input</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;the character %C cannot start a boolean&quot;</span> <a href="#local_c_278"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">scan_string</span> <span class="UIDENT">None</span> <a href="#local_m_277"><span class="LIDENT">m</span></a> <a href="#local_ib_275"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scan a string containing elements in char_set and terminated by scan_indic
   if provided. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_chars_in_char_set"><span class="LIDENT">scan_chars_in_char_set</span></span> <span id="local_char_set_279"><span class="LIDENT">char_set</span></span> <span id="local_scan_indic_280"><span class="LIDENT">scan_indic</span></span> <span id="local_width_281"><span class="LIDENT">width</span></span> <span id="local_ib_282"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_scan_chars_283"><span class="LIDENT">scan_chars</span></span> <span id="local_i_284"><span class="LIDENT">i</span></span> <span id="local_stp_285"><span class="LIDENT">stp</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_286"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_282"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_284"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_282"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a><span class="EOL">
</span>       <a href="camlinternalFormat.ml.html#val-is_in_char_set"><span class="LIDENT">is_in_char_set</span></a> <a href="#local_char_set_279"><span class="LIDENT">char_set</span></a> <a href="#local_c_286"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a><span class="EOL">
</span>       <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_286"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_stp_285"><span class="LIDENT">stp</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">store_char</span> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a> <a href="#local_ib_282"><span class="LIDENT">ib</span></a> <a href="#local_c_286"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_scan_chars_283"><span class="LIDENT">scan_chars</span></a> <span class="LPAREN">(</span><a href="#local_i_284"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_stp_285"><span class="LIDENT">stp</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_scan_indic_280"><span class="LIDENT">scan_indic</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_scan_chars_283"><span class="LIDENT">scan_chars</span></a> <a href="#local_width_281"><span class="LIDENT">width</span></a> <span class="LPAREN">(</span><span class="MINUS">-</span><span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_c_287"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="#local_scan_chars_283"><span class="LIDENT">scan_chars</span></a> <a href="#local_width_281"><span class="LIDENT">width</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_287"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">eof</span> <a href="#local_ib_282"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_ci_288"><span class="LIDENT">ci</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">peek_char</span> <a href="#local_ib_282"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_c_287"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_ci_288"><span class="LIDENT">ci</span></a><span class="EOL">
</span>      <span class="THEN">then</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">invalidate_current_char</span> <a href="#local_ib_282"><span class="LIDENT">ib</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">character_mismatch</span> <a href="#local_c_287"><span class="LIDENT">c</span></a> <a href="#local_ci_288"><span class="LIDENT">ci</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The global error report function for [Scanf]. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scanf_bad_input"><span class="LIDENT">scanf_bad_input</span></span> <span id="local_ib_289"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_failure</span> <span id="local_s_290"><span class="LIDENT">s</span></span> <span class="BAR">|</span> <span class="UIDENT">Failure</span> <span id="local_s_291"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_i_292"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">char_count</span> <a href="#local_ib_289"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">bad_input</span> <span class="LPAREN">(</span><a href="printf.ml.html#val-sprintf"><span class="UIDENT">Printf</span><span class="DOT">.</span><span class="LIDENT">sprintf</span></a> <span class="STRING">&quot;scanf: bad input at char number %i: %s&quot;</span> <a href="#local_i_292"><span class="LIDENT">i</span></a> <a href="#local_s_291"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_x_293"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <a href="#local_x_293"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Get the content of a counter from an input buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_counter"><span class="LIDENT">get_counter</span></span> <span id="local_ib_294"><span class="LIDENT">ib</span></span> <span id="local_counter_295"><span class="LIDENT">counter</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_counter_295"><span class="LIDENT">counter</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Line_counter</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">line_count</span> <a href="#local_ib_294"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_counter</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">char_count</span> <a href="#local_ib_294"><span class="LIDENT">ib</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Token_counter</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">token_count</span> <a href="#local_ib_294"><span class="LIDENT">ib</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Compute the width of a padding option (see &quot;%42{&quot; and &quot;%123(&quot;). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-width_of_pad_opt"><span class="LIDENT">width_of_pad_opt</span></span> <span id="local_pad_opt_296"><span class="LIDENT">pad_opt</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_pad_opt_296"><span class="LIDENT">pad_opt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_width_297"><span class="LIDENT">width</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_width_297"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-stopper_of_formatting_lit"><span class="LIDENT">stopper_of_formatting_lit</span></span> <span id="local_fmting_298"><span class="LIDENT">fmting</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_fmting_298"><span class="LIDENT">fmting</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">Escaped_percent</span> <span class="THEN">then</span> <span class="CHAR">'%'</span><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_299"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-string_of_formatting_lit"><span class="LIDENT">string_of_formatting_lit</span></a> <a href="#local_fmting_298"><span class="LIDENT">fmting</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_stp_300"><span class="LIDENT">stp</span></span> <span class="EQUAL">=</span> <a href="#local_str_299"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sub_str_301"><span class="LIDENT">sub_str</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_299"><span class="LIDENT">str</span></a> <span class="INT">2</span> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_299"><span class="LIDENT">str</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_stp_300"><span class="LIDENT">stp</span></a><span class="COMMA">,</span> <a href="#local_sub_str_301"><span class="LIDENT">sub_str</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                           <span class="COMMENT">(* Reader management *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* A call to take_format_readers on a format is evaluated into functions
   taking readers as arguments and aggregate them into an heterogeneous list *)</span><span class="EOL">
</span><span class="COMMENT">(* When all readers are taken, finally pass the list of the readers to the
   continuation k. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-take_format_readers"><span class="LIDENT">take_format_readers</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">d</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_302"><span class="LIDENT">k</span></span> <span id="local_fmt_303"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmt_303"><span class="LIDENT">fmt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span id="local_fmt_rest_304"><span class="LIDENT">fmt_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_reader_305"><span class="LIDENT">reader</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_k_306"><span class="LIDENT">new_k</span></span> <span id="local_readers_rest_307"><span class="LIDENT">readers_rest</span></span> <span class="EQUAL">=</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_reader_305"><span class="LIDENT">reader</span></a><span class="COMMA">,</span> <a href="#local_readers_rest_307"><span class="LIDENT">readers_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">take_format_readers</span> <a href="#local_new_k_306"><span class="LIDENT">new_k</span></a> <a href="#local_fmt_rest_304"><span class="LIDENT">fmt_rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_rest_308"><span class="LIDENT">rest</span></span>                        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_308"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_rest_309"><span class="LIDENT">rest</span></span>                   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_309"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_310"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>                 <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_310"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_311"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_311"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_312"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_312"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_313"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_313"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_314"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_314"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_315"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_315"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_316"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_316"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_317"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>                   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_317"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span id="local_rest_318"><span class="LIDENT">rest</span></span>                       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_318"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span id="local_rest_319"><span class="LIDENT">rest</span></span>                       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_319"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_rest_320"><span class="LIDENT">rest</span></span>                       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_320"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_321"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_321"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_322"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>           <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_322"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_323"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_323"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_324"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_324"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_325"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_325"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_next_char</span> <span id="local_rest_326"><span class="LIDENT">rest</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_326"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_327"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_327"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_328"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_329"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt_328"><span class="LIDENT">fmt</span></a> <a href="#local_rest_329"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_330"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_331"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt_330"><span class="LIDENT">fmt</span></a> <a href="#local_rest_331"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_332"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>          <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_rest_332"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_fmtty_333"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_334"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>    <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-symm"><span class="LIDENT">symm</span></a> <a href="#local_fmtty_333"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_334"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_335"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_336"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_ignored_format_readers</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <a href="#local_ign_335"><span class="LIDENT">ign</span></a> <a href="#local_rest_336"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_format</span>                    <span class="MINUSGREATER">-&gt;</span> <a href="#local_k_302"><span class="LIDENT">k</span></a> <span class="UIDENT">Nil</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Take readers associated to an fmtty coming from a Format_subst &quot;%(...%)&quot;. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-take_fmtty_format_readers"><span class="LIDENT">take_fmtty_format_readers</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">d</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_337"><span class="LIDENT">k</span></span> <span id="local_fmtty_338"><span class="LIDENT">fmtty</span></span> <span id="local_fmt_339"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmtty_338"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span id="local_fmt_rest_340"><span class="LIDENT">fmt_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_reader_341"><span class="LIDENT">reader</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_k_342"><span class="LIDENT">new_k</span></span> <span id="local_readers_rest_343"><span class="LIDENT">readers_rest</span></span> <span class="EQUAL">=</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_reader_341"><span class="LIDENT">reader</span></a><span class="COMMA">,</span> <a href="#local_readers_rest_343"><span class="LIDENT">readers_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_new_k_342"><span class="LIDENT">new_k</span></a> <a href="#local_fmt_rest_340"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_fmt_rest_344"><span class="LIDENT">fmt_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_reader_345"><span class="LIDENT">reader</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_k_346"><span class="LIDENT">new_k</span></span> <span id="local_readers_rest_347"><span class="LIDENT">readers_rest</span></span> <span class="EQUAL">=</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_reader_345"><span class="LIDENT">reader</span></a><span class="COMMA">,</span> <a href="#local_readers_rest_347"><span class="LIDENT">readers_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_new_k_346"><span class="LIDENT">new_k</span></a> <a href="#local_fmt_rest_344"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_rest_348"><span class="LIDENT">rest</span></span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_348"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_rest_349"><span class="LIDENT">rest</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_349"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_350"><span class="LIDENT">rest</span></span>                 <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_350"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest_351"><span class="LIDENT">rest</span></span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_351"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest_352"><span class="LIDENT">rest</span></span>           <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_352"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest_353"><span class="LIDENT">rest</span></span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_353"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_rest_354"><span class="LIDENT">rest</span></span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_354"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest_355"><span class="LIDENT">rest</span></span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_355"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest_356"><span class="LIDENT">rest</span></span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_356"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest_357"><span class="LIDENT">rest</span></span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_357"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span id="local_rest_358"><span class="LIDENT">rest</span></span>                 <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_358"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_359"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_rest_359"><span class="LIDENT">rest</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_ty1_360"><span class="LIDENT">ty1</span></span><span class="COMMA">,</span> <span id="local_ty2_361"><span class="LIDENT">ty2</span></span><span class="COMMA">,</span> <span id="local_rest_362"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_363"><span class="LIDENT">ty</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-trans"><span class="LIDENT">trans</span></a> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-symm"><span class="LIDENT">symm</span></a> <a href="#local_ty1_360"><span class="LIDENT">ty1</span></a><span class="RPAREN">)</span> <a href="#local_ty2_361"><span class="LIDENT">ty2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_337"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmtty"><span class="LIDENT">concat_fmtty</span></a> <a href="#local_ty_363"><span class="LIDENT">ty</span></a> <a href="#local_rest_362"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_fmt_339"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Take readers associated to an ignored parameter. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-take_ignored_format_readers"><span class="LIDENT">take_ignored_format_readers</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-ignored"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">ignored</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">d</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_364"><span class="LIDENT">k</span></span> <span id="local_ign_365"><span class="LIDENT">ign</span></span> <span id="local_fmt_366"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_ign_365"><span class="LIDENT">ign</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_reader_367"><span class="LIDENT">reader</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_k_368"><span class="LIDENT">new_k</span></span> <span id="local_readers_rest_369"><span class="LIDENT">readers_rest</span></span> <span class="EQUAL">=</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_reader_367"><span class="LIDENT">reader</span></a><span class="COMMA">,</span> <a href="#local_readers_rest_369"><span class="LIDENT">readers_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">take_format_readers</span> <a href="#local_new_k_368"><span class="LIDENT">new_k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_char</span>                    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_char</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_string</span> <span class="UNDERSCORE">_</span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_string</span> <span class="UNDERSCORE">_</span>           <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int32</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_nativeint</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int64</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_float</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_bool</span> <span class="UNDERSCORE">_</span>                  <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_arg</span> <span class="UNDERSCORE">_</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_fmtty_370"><span class="LIDENT">fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_fmtty_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmtty_370"><span class="LIDENT">fmtty</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_char_set</span> <span class="UNDERSCORE">_</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_get_counter</span> <span class="UNDERSCORE">_</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_next_char</span>          <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">take_format_readers</span> <a href="#local_k_364"><span class="LIDENT">k</span></a> <a href="#local_fmt_366"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                          <span class="COMMENT">(* Generic scanning *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Make a generic scanning function. *)</span><span class="EOL">
</span><span class="COMMENT">(* Scan a stream according to a format and readers obtained by
   take_format_readers, and aggregate scanned values into an
   heterogeneous list. *)</span><span class="EOL">
</span><span class="COMMENT">(* Return the heterogeneous list of scanned values. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-make_scanf"><span class="LIDENT">make_scanf</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span><span class="DOT">.</span><span class="EOL">
</span>    <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_ib_371"><span class="LIDENT">ib</span></span> <span id="local_fmt_372"><span class="LIDENT">fmt</span></span> <span id="local_readers_373"><span class="LIDENT">readers</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmt_372"><span class="LIDENT">fmt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_rest_374"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="LIDENT">scan_char</span> <span class="INT">0</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_375"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_c_375"><span class="LIDENT">c</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_374"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_rest_376"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="LIDENT">scan_caml_char</span> <span class="INT">0</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_377"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_c_377"><span class="LIDENT">c</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_376"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_378"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span id="local_fmting_lit_379"><span class="LIDENT">fmting_lit</span></span><span class="COMMA">,</span> <span id="local_rest_380"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_580"><span id="local_stp_381"><span class="LIDENT">stp</span></span><span class="COMMA">,</span> <span id="local_str_382"><span class="LIDENT">str</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">stopper_of_formatting_lit</span> <a href="#local_fmting_lit_379"><span class="LIDENT">fmting_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_383"><span class="LIDENT">scan</span></span> <span id="local_width_384"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_385"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_string</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_stp_381"><span class="LIDENT">stp</span></a><span class="RPAREN">)</span> <a href="#local_width_384"><span class="LIDENT">width</span></a> <a href="#local_ib_385"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_rest_386"><span class="LIDENT">str_rest</span></span> <span class="EQUAL">=</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><a href="#local_str_382"><span class="LIDENT">str</span></a><span class="COMMA">,</span> <a href="#local_rest_380"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_str_rest_386"><span class="LIDENT">str_rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_378"><span class="LIDENT">pad</span></a> <span class="UIDENT">No_precision</span> <a href="#local_scan_383"><span class="LIDENT">scan</span></a> <span class="LIDENT">token_string</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_387"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_388"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_389"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_390"><span class="LIDENT">scan</span></span> <span id="local_width_391"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_392"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_string</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="CHAR">'{'</span><span class="RPAREN">)</span> <a href="#local_width_391"><span class="LIDENT">width</span></a> <a href="#local_ib_392"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt'_388"><span class="LIDENT">fmt'</span></a> <a href="#local_rest_389"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_387"><span class="LIDENT">pad</span></a> <span class="UIDENT">No_precision</span> <a href="#local_scan_390"><span class="LIDENT">scan</span></a><span class="EOL">
</span>                   <span class="LIDENT">token_string</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_393"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_394"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_395"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_396"><span class="LIDENT">scan</span></span> <span id="local_width_397"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_398"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_string</span> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <span class="CHAR">'['</span><span class="RPAREN">)</span> <a href="#local_width_397"><span class="LIDENT">width</span></a> <a href="#local_ib_398"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt'_394"><span class="LIDENT">fmt'</span></a> <a href="#local_rest_395"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_393"><span class="LIDENT">pad</span></a> <span class="UIDENT">No_precision</span> <a href="#local_scan_396"><span class="LIDENT">scan</span></a><span class="EOL">
</span>                   <span class="LIDENT">token_string</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_399"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_400"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_401"><span class="LIDENT">scan</span></span> <span id="local_width_402"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_403"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_string</span> <span class="UIDENT">None</span> <a href="#local_width_402"><span class="LIDENT">width</span></a> <a href="#local_ib_403"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_400"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_399"><span class="LIDENT">pad</span></a> <span class="UIDENT">No_precision</span> <a href="#local_scan_401"><span class="LIDENT">scan</span></a> <span class="LIDENT">token_string</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span id="local_pad_404"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_405"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_406"><span class="LIDENT">scan</span></span> <span id="local_width_407"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_408"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_caml_string</span> <a href="#local_width_407"><span class="LIDENT">width</span></a> <a href="#local_ib_408"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_405"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_404"><span class="LIDENT">pad</span></a> <span class="UIDENT">No_precision</span> <a href="#local_scan_406"><span class="LIDENT">scan</span></a> <span class="LIDENT">token_string</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span id="local_iconv_409"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_410"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_411"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_412"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_413"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">integer_conversion_of_char</span> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-char_of_iconv"><span class="LIDENT">char_of_iconv</span></a> <a href="#local_iconv_409"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_414"><span class="LIDENT">scan</span></span> <span id="local_width_415"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_416"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_int_conversion</span> <a href="#local_c_413"><span class="LIDENT">c</span></a> <a href="#local_width_415"><span class="LIDENT">width</span></a> <a href="#local_ib_416"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_412"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_410"><span class="LIDENT">pad</span></a> <a href="#local_prec_411"><span class="LIDENT">prec</span></a> <a href="#local_scan_414"><span class="LIDENT">scan</span></a> <span class="LPAREN">(</span><span class="LIDENT">token_int</span> <a href="#local_c_413"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span id="local_iconv_417"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_418"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_419"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_420"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_421"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">integer_conversion_of_char</span> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-char_of_iconv"><span class="LIDENT">char_of_iconv</span></a> <a href="#local_iconv_417"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_422"><span class="LIDENT">scan</span></span> <span id="local_width_423"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_424"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_int_conversion</span> <a href="#local_c_421"><span class="LIDENT">c</span></a> <a href="#local_width_423"><span class="LIDENT">width</span></a> <a href="#local_ib_424"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_420"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_418"><span class="LIDENT">pad</span></a> <a href="#local_prec_419"><span class="LIDENT">prec</span></a> <a href="#local_scan_422"><span class="LIDENT">scan</span></a> <span class="LPAREN">(</span><span class="LIDENT">token_int32</span> <a href="#local_c_421"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span id="local_iconv_425"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_426"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_427"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_428"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_429"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">integer_conversion_of_char</span> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-char_of_iconv"><span class="LIDENT">char_of_iconv</span></a> <a href="#local_iconv_425"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_430"><span class="LIDENT">scan</span></span> <span id="local_width_431"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_432"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_int_conversion</span> <a href="#local_c_429"><span class="LIDENT">c</span></a> <a href="#local_width_431"><span class="LIDENT">width</span></a> <a href="#local_ib_432"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_428"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_426"><span class="LIDENT">pad</span></a> <a href="#local_prec_427"><span class="LIDENT">prec</span></a> <a href="#local_scan_430"><span class="LIDENT">scan</span></a> <span class="LPAREN">(</span><span class="LIDENT">token_nativeint</span> <a href="#local_c_429"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span id="local_iconv_433"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_434"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_435"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_436"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_437"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">integer_conversion_of_char</span> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-char_of_iconv"><span class="LIDENT">char_of_iconv</span></a> <a href="#local_iconv_433"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_438"><span class="LIDENT">scan</span></span> <span id="local_width_439"><span class="LIDENT">width</span></span> <span class="UNDERSCORE">_</span> <span id="local_ib_440"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_int_conversion</span> <a href="#local_c_437"><span class="LIDENT">c</span></a> <a href="#local_width_439"><span class="LIDENT">width</span></a> <a href="#local_ib_440"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_436"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_434"><span class="LIDENT">pad</span></a> <a href="#local_prec_435"><span class="LIDENT">prec</span></a> <a href="#local_scan_438"><span class="LIDENT">scan</span></a> <span class="LPAREN">(</span><span class="LIDENT">token_int64</span> <a href="#local_c_437"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Float_F</span> <span class="BAR">|</span> <span class="UIDENT">Float_CF</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_pad_441"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_442"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_443"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_443"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_441"><span class="LIDENT">pad</span></a> <a href="#local_prec_442"><span class="LIDENT">prec</span></a> <span class="LIDENT">scan_caml_float</span> <span class="LIDENT">token_float</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Float_f</span> <span class="BAR">|</span> <span class="UIDENT">Float_e</span> <span class="BAR">|</span> <span class="UIDENT">Float_E</span> <span class="BAR">|</span> <span class="UIDENT">Float_g</span> <span class="BAR">|</span> <span class="UIDENT">Float_G</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>           <span id="local_pad_444"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_445"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_446"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_446"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_444"><span class="LIDENT">pad</span></a> <a href="#local_prec_445"><span class="LIDENT">prec</span></a> <span class="LIDENT">scan_float</span> <span class="LIDENT">token_float</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="UIDENT">Float_h</span> <span class="BAR">|</span> <span class="UIDENT">Float_H</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_pad_447"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_448"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_449"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_449"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_447"><span class="LIDENT">pad</span></a> <a href="#local_prec_448"><span class="LIDENT">prec</span></a> <span class="LIDENT">scan_hex_float</span> <span class="LIDENT">token_float</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span id="local_pad_450"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_451"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_scan_452"><span class="LIDENT">scan</span></span> <span class="UNDERSCORE">_</span> <span class="UNDERSCORE">_</span> <span id="local_ib_453"><span class="LIDENT">ib</span></span> <span class="EQUAL">=</span> <span class="LIDENT">scan_bool</span> <a href="#local_ib_453"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pad_prec_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_451"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <a href="#local_pad_450"><span class="LIDENT">pad</span></a> <span class="UIDENT">No_precision</span> <a href="#local_scan_452"><span class="LIDENT">scan</span></a> <span class="LIDENT">token_bool</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%a\&quot;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%t\&quot;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%?\&quot; (custom converter)&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span id="local_fmt_rest_454"><span class="LIDENT">fmt_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><span id="local_reader_455"><span class="LIDENT">reader</span></span><span class="COMMA">,</span> <span id="local_readers_rest_456"><span class="LIDENT">readers_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_x_457"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_reader_455"><span class="LIDENT">reader</span></a> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_457"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_fmt_rest_454"><span class="LIDENT">fmt_rest</span></a> <a href="#local_readers_rest_456"><span class="LIDENT">readers_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Nil</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: missing reader&quot;</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_rest_458"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">end_of_input</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="THEN">then</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_458"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LIDENT">bad_input</span> <span class="STRING">&quot;end of input not found&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span id="local_str_459"><span class="LIDENT">str</span></span><span class="COMMA">,</span> <span id="local_rest_460"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="string.ml.html#val-iter"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <a href="#local_str_459"><span class="LIDENT">str</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_460"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span id="local_chr_461"><span class="LIDENT">chr</span></span><span class="COMMA">,</span> <span id="local_rest_462"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_chr_461"><span class="LIDENT">chr</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_462"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span id="local_pad_opt_463"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_fmtty_464"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_465"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="LIDENT">scan_caml_string</span> <span class="LPAREN">(</span><span class="LIDENT">width_of_pad_opt</span> <a href="#local_pad_opt_463"><span class="LIDENT">pad_opt</span></a><span class="RPAREN">)</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_466"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_string</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_fmt_467"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <a href="camlinternalFormat.ml.html#val-format_of_string_fmtty"><span class="LIDENT">format_of_string_fmtty</span></a> <a href="#local_s_466"><span class="LIDENT">s</span></a> <a href="#local_fmtty_464"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Failure</span> <span id="local_msg_468"><span class="LIDENT">msg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_input</span> <a href="#local_msg_468"><span class="LIDENT">msg</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_fmt_467"><span class="LIDENT">fmt</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_465"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span id="local_pad_opt_469"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_fmtty_470"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_471"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="LIDENT">scan_caml_string</span> <span class="LPAREN">(</span><span class="LIDENT">width_of_pad_opt</span> <a href="#local_pad_opt_469"><span class="LIDENT">pad_opt</span></a><span class="RPAREN">)</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_472"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_string</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_575"><span id="local_fmt_473"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span id="local_fmt'_474"><span class="LIDENT">fmt'</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_475"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-fmt_ebb_of_string"><span class="LIDENT">fmt_ebb_of_string</span></a> <a href="#local_s_472"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt'_476"><span class="LIDENT">fmt'</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-fmt_ebb_of_string"><span class="LIDENT">fmt_ebb_of_string</span></a> <a href="#local_s_472"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="COMMENT">(* TODO: find a way to avoid reparsing twice *)</span><span class="EOL">
</span><span class="EOL">
</span>        <span class="COMMENT">(* TODO: these type-checks below *can* fail because of type
           ambiguity in presence of ignored-readers: &quot;%_r%d&quot; and &quot;%d%_r&quot;
           are typed in the same way.

           # Scanf.sscanf &quot;\&quot;%_r%d\&quot;3&quot; &quot;%(%d%_r%)&quot; ignore
             (fun fmt n -&gt; string_of_format fmt, n)
           Exception: CamlinternalFormat.Type_mismatch.

           We should properly catch this exception.
        *)</span><span class="EOL">
</span>        <a href="camlinternalFormat.ml.html#val-type_format"><span class="LIDENT">type_format</span></a> <a href="#local_fmt_475"><span class="LIDENT">fmt</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_fmtty_470"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>        <a href="camlinternalFormat.ml.html#val-type_format"><span class="LIDENT">type_format</span></a> <a href="#local_fmt'_476"><span class="LIDENT">fmt'</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-symm"><span class="LIDENT">symm</span></a> <a href="#local_fmtty_470"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Failure</span> <span id="local_msg_477"><span class="LIDENT">msg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_input</span> <a href="#local_msg_477"><span class="LIDENT">msg</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><a href="#local_fmt_473"><span class="LIDENT">fmt</span></a><span class="COMMA">,</span> <a href="#local_s_472"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>          <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt'_474"><span class="LIDENT">fmt'</span></a> <a href="#local_rest_471"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span id="local_width_opt_478"><span class="LIDENT">width_opt</span></span><span class="COMMA">,</span> <span id="local_char_set_479"><span class="LIDENT">char_set</span></span><span class="COMMA">,</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span id="local_fmting_lit_480"><span class="LIDENT">fmting_lit</span></span><span class="COMMA">,</span> <span id="local_rest_481"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_577"><span id="local_stp_482"><span class="LIDENT">stp</span></span><span class="COMMA">,</span> <span id="local_str_483"><span class="LIDENT">str</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">stopper_of_formatting_lit</span> <a href="#local_fmting_lit_480"><span class="LIDENT">fmting_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_484"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">width_of_pad_opt</span> <a href="#local_width_opt_478"><span class="LIDENT">width_opt</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_chars_in_char_set</span> <a href="#local_char_set_479"><span class="LIDENT">char_set</span></a> <span class="LPAREN">(</span><span class="UIDENT">Some</span> <a href="#local_stp_482"><span class="LIDENT">stp</span></a><span class="RPAREN">)</span> <a href="#local_width_484"><span class="LIDENT">width</span></a> <a href="#local_ib_371"><span class="LIDENT">ib</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_485"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_string</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_rest_486"><span class="LIDENT">str_rest</span></span> <span class="EQUAL">=</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><a href="#local_str_483"><span class="LIDENT">str</span></a><span class="COMMA">,</span> <a href="#local_rest_481"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_s_485"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_str_rest_486"><span class="LIDENT">str_rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span id="local_width_opt_487"><span class="LIDENT">width_opt</span></span><span class="COMMA">,</span> <span id="local_char_set_488"><span class="LIDENT">char_set</span></span><span class="COMMA">,</span> <span id="local_rest_489"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_490"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">width_of_pad_opt</span> <a href="#local_width_opt_487"><span class="LIDENT">width_opt</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_chars_in_char_set</span> <a href="#local_char_set_488"><span class="LIDENT">char_set</span></a> <span class="UIDENT">None</span> <a href="#local_width_490"><span class="LIDENT">width</span></a> <a href="#local_ib_371"><span class="LIDENT">ib</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_491"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_string</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_s_491"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_489"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span id="local_counter_492"><span class="LIDENT">counter</span></span><span class="COMMA">,</span> <span id="local_rest_493"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_count_494"><span class="LIDENT">count</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_counter</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_counter_492"><span class="LIDENT">counter</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_count_494"><span class="LIDENT">count</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_493"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_next_char</span> <span id="local_rest_495"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_c_496"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">checked_peek_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_c_496"><span class="LIDENT">c</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_495"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span id="local_formatting_lit_497"><span class="LIDENT">formatting_lit</span></span><span class="COMMA">,</span> <span id="local_rest_498"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="string.ml.html#val-iter"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="camlinternalFormat.ml.html#val-string_of_formatting_lit"><span class="LIDENT">string_of_formatting_lit</span></a> <a href="#local_formatting_lit_497"><span class="LIDENT">formatting_lit</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_rest_498"><span class="LIDENT">rest</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_499"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_500"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="CHAR">'@'</span><span class="SEMI">;</span> <span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="CHAR">'{'</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt'_499"><span class="LIDENT">fmt'</span></a> <a href="#local_rest_500"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_501"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_502"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="CHAR">'@'</span><span class="SEMI">;</span> <span class="LIDENT">check_char</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="CHAR">'['</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <a href="#local_fmt'_501"><span class="LIDENT">fmt'</span></a> <a href="#local_rest_502"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_readers_373"><span class="LIDENT">readers</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_503"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_504"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Param_format_EBB</span> <span id="local_fmt'_505"><span class="LIDENT">fmt'</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-param_format_of_ignored_format"><span class="LIDENT">param_format_of_ignored_format</span></a> <a href="#local_ign_503"><span class="LIDENT">ign</span></a> <a href="#local_rest_504"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_371"><span class="LIDENT">ib</span></a> <a href="#local_fmt'_505"><span class="LIDENT">fmt'</span></a> <a href="#local_readers_373"><span class="LIDENT">readers</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_arg_rest_506"><span class="LIDENT">arg_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_arg_rest_506"><span class="LIDENT">arg_rest</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Nil</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_format</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Nil</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Case analysis on padding and precision. *)</span><span class="EOL">
</span><span class="COMMENT">(* Reject formats containing &quot;%*&quot; or &quot;%.*&quot;. *)</span><span class="EOL">
</span><span class="COMMENT">(* Pass padding and precision to the generic scanner `scan'. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pad_prec_scanf"><span class="LIDENT">pad_prec_scanf</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">t</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">z</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_ib_507"><span class="LIDENT">ib</span></span> <span id="local_fmt_508"><span class="LIDENT">fmt</span></span> <span id="local_readers_509"><span class="LIDENT">readers</span></span> <span id="local_pad_510"><span class="LIDENT">pad</span></span> <span id="local_prec_511"><span class="LIDENT">prec</span></span> <span id="local_scan_512"><span class="LIDENT">scan</span></span> <span id="local_token_513"><span class="LIDENT">token</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_510"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_511"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <a href="#local_scan_512"><span class="LIDENT">scan</span></a> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_x_514"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_token_513"><span class="LIDENT">token</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_514"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <a href="#local_fmt_508"><span class="LIDENT">fmt</span></a> <a href="#local_readers_509"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_515"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <a href="#local_scan_512"><span class="LIDENT">scan</span></a> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a> <a href="#local_p_515"><span class="LIDENT">p</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_x_516"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_token_513"><span class="LIDENT">token</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_516"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <a href="#local_fmt_508"><span class="LIDENT">fmt</span></a> <a href="#local_readers_509"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UIDENT">Right</span> <span class="BAR">|</span> <span class="UIDENT">Zeros</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_w_517"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <a href="#local_scan_512"><span class="LIDENT">scan</span></a> <a href="#local_w_517"><span class="LIDENT">w</span></a> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_x_518"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_token_513"><span class="LIDENT">token</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_518"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <a href="#local_fmt_508"><span class="LIDENT">fmt</span></a> <a href="#local_readers_509"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UIDENT">Right</span> <span class="BAR">|</span> <span class="UIDENT">Zeros</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_w_519"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_520"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <a href="#local_scan_512"><span class="LIDENT">scan</span></a> <a href="#local_w_519"><span class="LIDENT">w</span></a> <a href="#local_p_520"><span class="LIDENT">p</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_x_521"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_token_513"><span class="LIDENT">token</span></a> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_521"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_507"><span class="LIDENT">ib</span></a> <a href="#local_fmt_508"><span class="LIDENT">fmt</span></a> <a href="#local_readers_509"><span class="LIDENT">readers</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Left</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%-\&quot;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UIDENT">Right</span> <span class="BAR">|</span> <span class="UIDENT">Zeros</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%*\&quot;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%*\&quot;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;scanf: bad conversion \&quot;%*\&quot;&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>            <span class="COMMENT">(* Defining [scanf] and various flavors of [scanf] *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kscanf_gen"><span class="LIDENT">kscanf_gen</span></span> <span id="local_ib_522"><span class="LIDENT">ib</span></span> <span id="local_ef_523"><span class="LIDENT">ef</span></span> <span id="local_af_524"><span class="LIDENT">af</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_525"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span id="local_str_526"><span class="LIDENT">str</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_apply_527"><span class="LIDENT">apply</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="DOT">.</span> <span class="LIDENT">a</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormat.ml.html#type-heter_list"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">b</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_f_528"><span class="LIDENT">f</span></span> <span id="local_args_529"><span class="LIDENT">args</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_args_529"><span class="LIDENT">args</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Cons</span> <span class="LPAREN">(</span><span id="local_x_530"><span class="LIDENT">x</span></span><span class="COMMA">,</span> <span id="local_r_531"><span class="LIDENT">r</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_apply_527"><span class="LIDENT">apply</span></a> <span class="LPAREN">(</span><a href="#local_f_528"><span class="LIDENT">f</span></a> <a href="#local_x_530"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_r_531"><span class="LIDENT">r</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Nil</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_528"><span class="LIDENT">f</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_k_532"><span class="LIDENT">k</span></span> <span id="local_readers_533"><span class="LIDENT">readers</span></span> <span id="local_f_534"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">reset_token</span> <a href="#local_ib_522"><span class="LIDENT">ib</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">make_scanf</span> <a href="#local_ib_522"><span class="LIDENT">ib</span></a> <a href="#local_fmt_525"><span class="LIDENT">fmt</span></a> <a href="#local_readers_533"><span class="LIDENT">readers</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_failure</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Failure</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">End_of_file</span> <span class="AS">as</span> <span id="local_exc_535"><span class="LIDENT">exc</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_ef_523"><span class="LIDENT">ef</span></a> <a href="#local_ib_522"><span class="LIDENT">ib</span></a> <a href="#local_exc_535"><span class="LIDENT">exc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">Invalid_argument</span> <span id="local_msg_536"><span class="LIDENT">msg</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="LPAREN">(</span><a href="#local_msg_536"><span class="LIDENT">msg</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot; in format \&quot;&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="string.ml.html#val-escaped"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">escaped</span></a> <a href="#local_str_526"><span class="LIDENT">str</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;\&quot;&quot;</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_args_537"><span class="LIDENT">args</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_af_524"><span class="LIDENT">af</span></a> <span class="LPAREN">(</span><a href="#local_apply_527"><span class="LIDENT">apply</span></a> <a href="#local_f_534"><span class="LIDENT">f</span></a> <a href="#local_args_537"><span class="LIDENT">args</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">take_format_readers</span> <a href="#local_k_532"><span class="LIDENT">k</span></a> <a href="#local_fmt_525"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kscanf"><span class="LIDENT">kscanf</span></span> <span id="local_ib_538"><span class="LIDENT">ib</span></span> <span id="local_ef_539"><span class="LIDENT">ef</span></span> <span id="local_fmt_540"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">kscanf_gen</span> <a href="#local_ib_538"><span class="LIDENT">ib</span></a> <a href="#local_ef_539"><span class="LIDENT">ef</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_541"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_541"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_fmt_540"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kscanf_opt"><span class="LIDENT">kscanf_opt</span></span> <span id="local_ib_542"><span class="LIDENT">ib</span></span> <span id="local_fmt_543"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">kscanf_gen</span> <a href="#local_ib_542"><span class="LIDENT">ib</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_544"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_x_544"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <a href="#local_fmt_543"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kbscanf"><span class="LIDENT">kbscanf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kscanf</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bscanf"><span class="LIDENT">bscanf</span></span> <span id="local_ib_545"><span class="LIDENT">ib</span></span> <span id="local_fmt_546"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kbscanf</span> <a href="#local_ib_545"><span class="LIDENT">ib</span></a> <span class="LIDENT">scanf_bad_input</span> <a href="#local_fmt_546"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-bscanf_opt"><span class="LIDENT">bscanf_opt</span></span> <span id="local_ib_547"><span class="LIDENT">ib</span></span> <span id="local_fmt_548"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kscanf_opt</span> <a href="#local_ib_547"><span class="LIDENT">ib</span></a> <a href="#local_fmt_548"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ksscanf"><span class="LIDENT">ksscanf</span></span> <span id="local_s_549"><span class="LIDENT">s</span></span> <span id="local_ef_550"><span class="LIDENT">ef</span></span> <span id="local_fmt_551"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kbscanf</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">from_string</span> <a href="#local_s_549"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_ef_550"><span class="LIDENT">ef</span></a> <a href="#local_fmt_551"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sscanf"><span class="LIDENT">sscanf</span></span> <span id="local_s_552"><span class="LIDENT">s</span></span> <span id="local_fmt_553"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kbscanf</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">from_string</span> <a href="#local_s_552"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <span class="LIDENT">scanf_bad_input</span> <a href="#local_fmt_553"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-sscanf_opt"><span class="LIDENT">sscanf_opt</span></span> <span id="local_s_554"><span class="LIDENT">s</span></span> <span id="local_fmt_555"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kscanf_opt</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">from_string</span> <a href="#local_s_554"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_fmt_555"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scanf"><span class="LIDENT">scanf</span></span> <span id="local_fmt_556"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kscanf</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">stdin</span> <span class="LIDENT">scanf_bad_input</span> <a href="#local_fmt_556"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-scanf_opt"><span class="LIDENT">scanf_opt</span></span> <span id="local_fmt_557"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kscanf_opt</span> <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">stdin</span> <a href="#local_fmt_557"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Scanning format strings. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bscanf_format"><span class="LIDENT">bscanf_format</span></span> <span class="COLON">:</span><span class="EOL">
</span>  <span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">in_channel</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">g</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">g</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_ib_558"><span class="LIDENT">ib</span></span> <span id="local_format_559"><span class="LIDENT">format</span></span> <span id="local_f_560"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="LIDENT">scan_caml_string</span> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a> <a href="#local_ib_558"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_561"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">token_string</span> <a href="#local_ib_558"><span class="LIDENT">ib</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_fmt'_562"><span class="LIDENT">fmt'</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span> <a href="camlinternalFormat.ml.html#val-format_of_string_format"><span class="LIDENT">format_of_string_format</span></a> <a href="#local_str_561"><span class="LIDENT">str</span></a> <a href="#local_format_559"><span class="LIDENT">format</span></a><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Failure</span> <span id="local_msg_563"><span class="LIDENT">msg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bad_input</span> <a href="#local_msg_563"><span class="LIDENT">msg</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_f_560"><span class="LIDENT">f</span></a> <a href="#local_fmt'_562"><span class="LIDENT">fmt'</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sscanf_format"><span class="LIDENT">sscanf_format</span></span> <span class="COLON">:</span><span class="EOL">
</span>  <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">format6</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">g</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">g</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_s_564"><span class="LIDENT">s</span></span> <span id="local_format_565"><span class="LIDENT">format</span></span> <span id="local_f_566"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bscanf_format</span> <span class="LPAREN">(</span><span class="UIDENT">Scanning</span><span class="DOT">.</span><span class="LIDENT">from_string</span> <a href="#local_s_564"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_format_565"><span class="LIDENT">format</span></a> <a href="#local_f_566"><span class="LIDENT">f</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_from_string"><span class="LIDENT">format_from_string</span></span> <span id="local_s_567"><span class="LIDENT">s</span></span> <span id="local_fmt_568"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">sscanf_format</span> <span class="LPAREN">(</span><span class="STRING">&quot;\&quot;&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="string.ml.html#val-escaped"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">escaped</span></a> <a href="#local_s_567"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;\&quot;&quot;</span><span class="RPAREN">)</span> <a href="#local_fmt_568"><span class="LIDENT">fmt</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_569"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_569"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unescaped"><span class="LIDENT">unescaped</span></span> <span id="local_s_570"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">sscanf</span> <span class="LPAREN">(</span><span class="STRING">&quot;\&quot;&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_s_570"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;\&quot;&quot;</span><span class="RPAREN">)</span> <span class="STRING">&quot;%S%!&quot;</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_571"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_571"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span></span></code></pre></body></html>
