<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: format.ml (ocaml-base-compiler.src.stdlib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocaml-base-compiler</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; stdlib &#x00BB; format.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>format.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocaml-base-compiler</a><ul><li>Library <code>compiler-libs.bytecomp</code><ul><li><a href="../../compiler-libs.bytecomp/Bytegen/index.html">Bytegen</a></li><li><a href="../../compiler-libs.bytecomp/Bytelibrarian/index.html">Bytelibrarian</a></li><li><a href="../../compiler-libs.bytecomp/Bytelink/index.html">Bytelink</a></li><li><a href="../../compiler-libs.bytecomp/Bytepackager/index.html">Bytepackager</a></li><li><a href="../../compiler-libs.bytecomp/Compile/index.html">Compile</a></li><li><a href="../../compiler-libs.bytecomp/Emitcode/index.html">Emitcode</a></li><li><a href="../../compiler-libs.bytecomp/Errors/index.html">Errors</a></li><li><a href="../../compiler-libs.bytecomp/Instruct/index.html">Instruct</a></li><li><a href="../../compiler-libs.bytecomp/Maindriver/index.html">Maindriver</a></li><li><a href="../../compiler-libs.bytecomp/Printinstr/index.html">Printinstr</a></li></ul></li><li>Library <code>compiler-libs.common</code><ul><li><a href="../../compiler-libs.common/Annot/index.html">Annot</a></li><li><a href="../../compiler-libs.common/Arg_helper/index.html">Arg_helper</a></li><li><a href="../../compiler-libs.common/Ast_helper/index.html">Ast_helper</a></li><li><a href="../../compiler-libs.common/Ast_invariants/index.html">Ast_invariants</a></li><li><a href="../../compiler-libs.common/Ast_iterator/index.html">Ast_iterator</a></li><li><a href="../../compiler-libs.common/Ast_mapper/index.html">Ast_mapper</a></li><li><a href="../../compiler-libs.common/Asttypes/index.html">Asttypes</a></li><li><a href="../../compiler-libs.common/Attr_helper/index.html">Attr_helper</a></li><li><a href="../../compiler-libs.common/Binutils/index.html">Binutils</a></li><li><a href="../../compiler-libs.common/Btype/index.html">Btype</a></li><li><a href="../../compiler-libs.common/Build_path_prefix_map/index.html">Build_path_prefix_map</a></li><li><a href="../../compiler-libs.common/Builtin_attributes/index.html">Builtin_attributes</a></li><li><a href="../../compiler-libs.common/Bytesections/index.html">Bytesections</a></li><li><a href="../../compiler-libs.common/CamlinternalMenhirLib/index.html">CamlinternalMenhirLib</a></li><li><a href="../../compiler-libs.common/Ccomp/index.html">Ccomp</a></li><li><a href="../../compiler-libs.common/Clflags/index.html">Clflags</a></li><li><a href="../../compiler-libs.common/Cmi_format/index.html">Cmi_format</a></li><li><a href="../../compiler-libs.common/Cmo_format/index.html">Cmo_format</a></li><li><a href="../../compiler-libs.common/Cmt2annot/index.html">Cmt2annot</a></li><li><a href="../../compiler-libs.common/Cmt_format/index.html">Cmt_format</a></li><li><a href="../../compiler-libs.common/Compenv/index.html">Compenv</a></li><li><a href="../../compiler-libs.common/Compile_common/index.html">Compile_common</a></li><li><a href="../../compiler-libs.common/Compmisc/index.html">Compmisc</a></li><li><a href="../../compiler-libs.common/Compression/index.html">Compression</a></li><li><a href="../../compiler-libs.common/Config/index.html">Config</a></li><li><a href="../../compiler-libs.common/Config_boot/index.html">Config_boot</a></li><li><a href="../../compiler-libs.common/Config_main/index.html">Config_main</a></li><li><a href="../../compiler-libs.common/Consistbl/index.html">Consistbl</a></li><li><a href="../../compiler-libs.common/Ctype/index.html">Ctype</a></li><li><a href="../../compiler-libs.common/Datarepr/index.html">Datarepr</a></li><li><a href="../../compiler-libs.common/Debuginfo/index.html">Debuginfo</a></li><li><a href="../../compiler-libs.common/Depend/index.html">Depend</a></li><li><a href="../../compiler-libs.common/Diffing/index.html">Diffing</a></li><li><a href="../../compiler-libs.common/Diffing_with_keys/index.html">Diffing_with_keys</a></li><li><a href="../../compiler-libs.common/Dll/index.html">Dll</a></li><li><a href="../../compiler-libs.common/Docstrings/index.html">Docstrings</a></li><li><a href="../../compiler-libs.common/Domainstate/index.html">Domainstate</a></li><li><a href="../../compiler-libs.common/Env/index.html">Env</a></li><li><a href="../../compiler-libs.common/Envaux/index.html">Envaux</a></li><li><a href="../../compiler-libs.common/Errortrace/index.html">Errortrace</a></li><li><a href="../../compiler-libs.common/Expunge/index.html">Expunge</a></li><li><a href="../../compiler-libs.common/Ident/index.html">Ident</a></li><li><a href="../../compiler-libs.common/Identifiable/index.html">Identifiable</a></li><li><a href="../../compiler-libs.common/Includeclass/index.html">Includeclass</a></li><li><a href="../../compiler-libs.common/Includecore/index.html">Includecore</a></li><li><a href="../../compiler-libs.common/Includemod/index.html">Includemod</a></li><li><a href="../../compiler-libs.common/Includemod_errorprinter/index.html">Includemod_errorprinter</a></li><li><a href="../../compiler-libs.common/Int_replace_polymorphic_compare/index.html">Int_replace_polymorphic_compare</a></li><li><a href="../../compiler-libs.common/Lambda/index.html">Lambda</a></li><li><a href="../../compiler-libs.common/Lazy_backtrack/index.html">Lazy_backtrack</a></li><li><a href="../../compiler-libs.common/Lexer/index.html">Lexer</a></li><li><a href="../../compiler-libs.common/Load_path/index.html">Load_path</a></li><li><a href="../../compiler-libs.common/Local_store/index.html">Local_store</a></li><li><a href="../../compiler-libs.common/Location/index.html">Location</a></li><li><a href="../../compiler-libs.common/Longident/index.html">Longident</a></li><li><a href="../../compiler-libs.common/Main_args/index.html">Main_args</a></li><li><a href="../../compiler-libs.common/Makedepend/index.html">Makedepend</a></li><li><a href="../../compiler-libs.common/Matching/index.html">Matching</a></li><li><a href="../../compiler-libs.common/Meta/index.html">Meta</a></li><li><a href="../../compiler-libs.common/Misc/index.html">Misc</a></li><li><a href="../../compiler-libs.common/Mtype/index.html">Mtype</a></li><li><a href="../../compiler-libs.common/Numbers/index.html">Numbers</a></li><li><a href="../../compiler-libs.common/Opcodes/index.html">Opcodes</a></li><li><a href="../../compiler-libs.common/Oprint/index.html">Oprint</a></li><li><a href="../../compiler-libs.common/Outcometree/index.html">Outcometree</a></li><li><a href="../../compiler-libs.common/Parmatch/index.html">Parmatch</a></li><li><a href="../../compiler-libs.common/Parse/index.html">Parse</a></li><li><a href="../../compiler-libs.common/Parser/index.html">Parser</a></li><li><a href="../../compiler-libs.common/Parsetree/index.html">Parsetree</a></li><li><a href="../../compiler-libs.common/Path/index.html">Path</a></li><li><a href="../../compiler-libs.common/Patterns/index.html">Patterns</a></li><li><a href="../../compiler-libs.common/Persistent_env/index.html">Persistent_env</a></li><li><a href="../../compiler-libs.common/Pparse/index.html">Pparse</a></li><li><a href="../../compiler-libs.common/Pprintast/index.html">Pprintast</a></li><li><a href="../../compiler-libs.common/Predef/index.html">Predef</a></li><li><a href="../../compiler-libs.common/Primitive/index.html">Primitive</a></li><li><a href="../../compiler-libs.common/Printast/index.html">Printast</a></li><li><a href="../../compiler-libs.common/Printlambda/index.html">Printlambda</a></li><li><a href="../../compiler-libs.common/Printpat/index.html">Printpat</a></li><li><a href="../../compiler-libs.common/Printtyp/index.html">Printtyp</a></li><li><a href="../../compiler-libs.common/Printtyped/index.html">Printtyped</a></li><li><a href="../../compiler-libs.common/Profile/index.html">Profile</a></li><li><a href="../../compiler-libs.common/Runtimedef/index.html">Runtimedef</a></li><li><a href="../../compiler-libs.common/Shape/index.html">Shape</a></li><li><a href="../../compiler-libs.common/Shape_reduce/index.html">Shape_reduce</a></li><li><a href="../../compiler-libs.common/Signature_group/index.html">Signature_group</a></li><li><a href="../../compiler-libs.common/Simplif/index.html">Simplif</a></li><li><a href="../../compiler-libs.common/Strongly_connected_components/index.html">Strongly_connected_components</a></li><li><a href="../../compiler-libs.common/Stypes/index.html">Stypes</a></li><li><a href="../../compiler-libs.common/Subst/index.html">Subst</a></li><li><a href="../../compiler-libs.common/Switch/index.html">Switch</a></li><li><a href="../../compiler-libs.common/Symtable/index.html">Symtable</a></li><li><a href="../../compiler-libs.common/Syntaxerr/index.html">Syntaxerr</a></li><li><a href="../../compiler-libs.common/Targetint/index.html">Targetint</a></li><li><a href="../../compiler-libs.common/Tast_iterator/index.html">Tast_iterator</a></li><li><a href="../../compiler-libs.common/Tast_mapper/index.html">Tast_mapper</a></li><li><a href="../../compiler-libs.common/Terminfo/index.html">Terminfo</a></li><li><a href="../../compiler-libs.common/Tmc/index.html">Tmc</a></li><li><a href="../../compiler-libs.common/Translattribute/index.html">Translattribute</a></li><li><a href="../../compiler-libs.common/Translclass/index.html">Translclass</a></li><li><a href="../../compiler-libs.common/Translcore/index.html">Translcore</a></li><li><a href="../../compiler-libs.common/Translmod/index.html">Translmod</a></li><li><a href="../../compiler-libs.common/Translobj/index.html">Translobj</a></li><li><a href="../../compiler-libs.common/Translprim/index.html">Translprim</a></li><li><a href="../../compiler-libs.common/Type_immediacy/index.html">Type_immediacy</a></li><li><a href="../../compiler-libs.common/Typeclass/index.html">Typeclass</a></li><li><a href="../../compiler-libs.common/Typecore/index.html">Typecore</a></li><li><a href="../../compiler-libs.common/Typedecl/index.html">Typedecl</a></li><li><a href="../../compiler-libs.common/Typedecl_immediacy/index.html">Typedecl_immediacy</a></li><li><a href="../../compiler-libs.common/Typedecl_properties/index.html">Typedecl_properties</a></li><li><a href="../../compiler-libs.common/Typedecl_separability/index.html">Typedecl_separability</a></li><li><a href="../../compiler-libs.common/Typedecl_unboxed/index.html">Typedecl_unboxed</a></li><li><a href="../../compiler-libs.common/Typedecl_variance/index.html">Typedecl_variance</a></li><li><a href="../../compiler-libs.common/Typedtree/index.html">Typedtree</a></li><li><a href="../../compiler-libs.common/Typemod/index.html">Typemod</a></li><li><a href="../../compiler-libs.common/Typeopt/index.html">Typeopt</a></li><li><a href="../../compiler-libs.common/Types/index.html">Types</a></li><li><a href="../../compiler-libs.common/Typetexp/index.html">Typetexp</a></li><li><a href="../../compiler-libs.common/Unit_info/index.html">Unit_info</a></li><li><a href="../../compiler-libs.common/Untypeast/index.html">Untypeast</a></li><li><a href="../../compiler-libs.common/Value_rec_check/index.html">Value_rec_check</a></li><li><a href="../../compiler-libs.common/Value_rec_compiler/index.html">Value_rec_compiler</a></li><li><a href="../../compiler-libs.common/Value_rec_types/index.html">Value_rec_types</a></li><li><a href="../../compiler-libs.common/Warnings/index.html">Warnings</a></li><li><a href="../../compiler-libs.common/X86_ast/index.html">X86_ast</a></li></ul></li><li>Library <code>compiler-libs.optcomp</code><ul><li><a href="../../compiler-libs.optcomp/Afl_instrument/index.html">Afl_instrument</a></li><li><a href="../../compiler-libs.optcomp/Alias_analysis/index.html">Alias_analysis</a></li><li><a href="../../compiler-libs.optcomp/Allocated_const/index.html">Allocated_const</a></li><li><a href="../../compiler-libs.optcomp/Arch/index.html">Arch</a></li><li><a href="../../compiler-libs.optcomp/Asmgen/index.html">Asmgen</a></li><li><a href="../../compiler-libs.optcomp/Asmlibrarian/index.html">Asmlibrarian</a></li><li><a href="../../compiler-libs.optcomp/Asmlink/index.html">Asmlink</a></li><li><a href="../../compiler-libs.optcomp/Asmpackager/index.html">Asmpackager</a></li><li><a href="../../compiler-libs.optcomp/Augment_specialised_args/index.html">Augment_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Backend_intf/index.html">Backend_intf</a></li><li><a href="../../compiler-libs.optcomp/Backend_var/index.html">Backend_var</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation/index.html">Branch_relaxation</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation_intf/index.html">Branch_relaxation_intf</a></li><li><a href="../../compiler-libs.optcomp/Build_export_info/index.html">Build_export_info</a></li><li><a href="../../compiler-libs.optcomp/CSE/index.html">CSE</a></li><li><a href="../../compiler-libs.optcomp/CSEgen/index.html">CSEgen</a></li><li><a href="../../compiler-libs.optcomp/Clambda/index.html">Clambda</a></li><li><a href="../../compiler-libs.optcomp/Clambda_primitives/index.html">Clambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Closure/index.html">Closure</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion/index.html">Closure_conversion</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion_aux/index.html">Closure_conversion_aux</a></li><li><a href="../../compiler-libs.optcomp/Closure_element/index.html">Closure_element</a></li><li><a href="../../compiler-libs.optcomp/Closure_id/index.html">Closure_id</a></li><li><a href="../../compiler-libs.optcomp/Closure_middle_end/index.html">Closure_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Closure_offsets/index.html">Closure_offsets</a></li><li><a href="../../compiler-libs.optcomp/Closure_origin/index.html">Closure_origin</a></li><li><a href="../../compiler-libs.optcomp/Cmm/index.html">Cmm</a></li><li><a href="../../compiler-libs.optcomp/Cmm_helpers/index.html">Cmm_helpers</a></li><li><a href="../../compiler-libs.optcomp/Cmm_invariants/index.html">Cmm_invariants</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen/index.html">Cmmgen</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen_state/index.html">Cmmgen_state</a></li><li><a href="../../compiler-libs.optcomp/Cmx_format/index.html">Cmx_format</a></li><li><a href="../../compiler-libs.optcomp/Cmxs_format/index.html">Cmxs_format</a></li><li><a href="../../compiler-libs.optcomp/Coloring/index.html">Coloring</a></li><li><a href="../../compiler-libs.optcomp/Comballoc/index.html">Comballoc</a></li><li><a href="../../compiler-libs.optcomp/Compilation_unit/index.html">Compilation_unit</a></li><li><a href="../../compiler-libs.optcomp/Compilenv/index.html">Compilenv</a></li><li><a href="../../compiler-libs.optcomp/Convert_primitives/index.html">Convert_primitives</a></li><li><a href="../../compiler-libs.optcomp/Dataflow/index.html">Dataflow</a></li><li><a href="../../compiler-libs.optcomp/Deadcode/index.html">Deadcode</a></li><li><a href="../../compiler-libs.optcomp/Effect_analysis/index.html">Effect_analysis</a></li><li><a href="../../compiler-libs.optcomp/Emit/index.html">Emit</a></li><li><a href="../../compiler-libs.optcomp/Emitaux/index.html">Emitaux</a></li><li><a href="../../compiler-libs.optcomp/Emitenv/index.html">Emitenv</a></li><li><a href="../../compiler-libs.optcomp/Export_id/index.html">Export_id</a></li><li><a href="../../compiler-libs.optcomp/Export_info/index.html">Export_info</a></li><li><a href="../../compiler-libs.optcomp/Export_info_for_pack/index.html">Export_info_for_pack</a></li><li><a href="../../compiler-libs.optcomp/Extract_projections/index.html">Extract_projections</a></li><li><a href="../../compiler-libs.optcomp/Find_recursive_functions/index.html">Find_recursive_functions</a></li><li><a href="../../compiler-libs.optcomp/Flambda/index.html">Flambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_invariants/index.html">Flambda_invariants</a></li><li><a href="../../compiler-libs.optcomp/Flambda_iterators/index.html">Flambda_iterators</a></li><li><a href="../../compiler-libs.optcomp/Flambda_middle_end/index.html">Flambda_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Flambda_to_clambda/index.html">Flambda_to_clambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_utils/index.html">Flambda_utils</a></li><li><a href="../../compiler-libs.optcomp/Freshening/index.html">Freshening</a></li><li><a href="../../compiler-libs.optcomp/Id_types/index.html">Id_types</a></li><li><a href="../../compiler-libs.optcomp/Import_approx/index.html">Import_approx</a></li><li><a href="../../compiler-libs.optcomp/Inconstant_idents/index.html">Inconstant_idents</a></li><li><a href="../../compiler-libs.optcomp/Initialize_symbol_to_let_symbol/index.html">Initialize_symbol_to_let_symbol</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify/index.html">Inline_and_simplify</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify_aux/index.html">Inline_and_simplify_aux</a></li><li><a href="../../compiler-libs.optcomp/Inlining_cost/index.html">Inlining_cost</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision/index.html">Inlining_decision</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision_intf/index.html">Inlining_decision_intf</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats/index.html">Inlining_stats</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats_types/index.html">Inlining_stats_types</a></li><li><a href="../../compiler-libs.optcomp/Inlining_transforms/index.html">Inlining_transforms</a></li><li><a href="../../compiler-libs.optcomp/Interf/index.html">Interf</a></li><li><a href="../../compiler-libs.optcomp/Internal_variable_names/index.html">Internal_variable_names</a></li><li><a href="../../compiler-libs.optcomp/Interval/index.html">Interval</a></li><li><a href="../../compiler-libs.optcomp/Invariant_params/index.html">Invariant_params</a></li><li><a href="../../compiler-libs.optcomp/Lift_code/index.html">Lift_code</a></li><li><a href="../../compiler-libs.optcomp/Lift_constants/index.html">Lift_constants</a></li><li><a href="../../compiler-libs.optcomp/Lift_let_to_initialize_symbol/index.html">Lift_let_to_initialize_symbol</a></li><li><a href="../../compiler-libs.optcomp/Linear/index.html">Linear</a></li><li><a href="../../compiler-libs.optcomp/Linear_format/index.html">Linear_format</a></li><li><a href="../../compiler-libs.optcomp/Linearize/index.html">Linearize</a></li><li><a href="../../compiler-libs.optcomp/Linkage_name/index.html">Linkage_name</a></li><li><a href="../../compiler-libs.optcomp/Linscan/index.html">Linscan</a></li><li><a href="../../compiler-libs.optcomp/Liveness/index.html">Liveness</a></li><li><a href="../../compiler-libs.optcomp/Mach/index.html">Mach</a></li><li><a href="../../compiler-libs.optcomp/Mutable_variable/index.html">Mutable_variable</a></li><li><a href="../../compiler-libs.optcomp/Optcompile/index.html">Optcompile</a></li><li><a href="../../compiler-libs.optcomp/Opterrors/index.html">Opterrors</a></li><li><a href="../../compiler-libs.optcomp/Optmaindriver/index.html">Optmaindriver</a></li><li><a href="../../compiler-libs.optcomp/Parameter/index.html">Parameter</a></li><li><a href="../../compiler-libs.optcomp/Pass_wrapper/index.html">Pass_wrapper</a></li><li><a href="../../compiler-libs.optcomp/Polling/index.html">Polling</a></li><li><a href="../../compiler-libs.optcomp/Printclambda/index.html">Printclambda</a></li><li><a href="../../compiler-libs.optcomp/Printclambda_primitives/index.html">Printclambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Printcmm/index.html">Printcmm</a></li><li><a href="../../compiler-libs.optcomp/Printlinear/index.html">Printlinear</a></li><li><a href="../../compiler-libs.optcomp/Printmach/index.html">Printmach</a></li><li><a href="../../compiler-libs.optcomp/Proc/index.html">Proc</a></li><li><a href="../../compiler-libs.optcomp/Projection/index.html">Projection</a></li><li><a href="../../compiler-libs.optcomp/Ref_to_variables/index.html">Ref_to_variables</a></li><li><a href="../../compiler-libs.optcomp/Reg/index.html">Reg</a></li><li><a href="../../compiler-libs.optcomp/Reload/index.html">Reload</a></li><li><a href="../../compiler-libs.optcomp/Reloadgen/index.html">Reloadgen</a></li><li><a href="../../compiler-libs.optcomp/Remove_free_vars_equal_to_args/index.html">Remove_free_vars_equal_to_args</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_arguments/index.html">Remove_unused_arguments</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_closure_vars/index.html">Remove_unused_closure_vars</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_program_constructs/index.html">Remove_unused_program_constructs</a></li><li><a href="../../compiler-libs.optcomp/Schedgen/index.html">Schedgen</a></li><li><a href="../../compiler-libs.optcomp/Scheduling/index.html">Scheduling</a></li><li><a href="../../compiler-libs.optcomp/Selectgen/index.html">Selectgen</a></li><li><a href="../../compiler-libs.optcomp/Selection/index.html">Selection</a></li><li><a href="../../compiler-libs.optcomp/Semantics_of_primitives/index.html">Semantics_of_primitives</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_id/index.html">Set_of_closures_id</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_origin/index.html">Set_of_closures_origin</a></li><li><a href="../../compiler-libs.optcomp/Share_constants/index.html">Share_constants</a></li><li><a href="../../compiler-libs.optcomp/Simple_value_approx/index.html">Simple_value_approx</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops/index.html">Simplify_boxed_integer_ops</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops_intf/index.html">Simplify_boxed_integer_ops_intf</a></li><li><a href="../../compiler-libs.optcomp/Simplify_common/index.html">Simplify_common</a></li><li><a href="../../compiler-libs.optcomp/Simplify_primitives/index.html">Simplify_primitives</a></li><li><a href="../../compiler-libs.optcomp/Spill/index.html">Spill</a></li><li><a href="../../compiler-libs.optcomp/Split/index.html">Split</a></li><li><a href="../../compiler-libs.optcomp/Stackframe/index.html">Stackframe</a></li><li><a href="../../compiler-libs.optcomp/Stackframegen/index.html">Stackframegen</a></li><li><a href="../../compiler-libs.optcomp/Static_exception/index.html">Static_exception</a></li><li><a href="../../compiler-libs.optcomp/Strmatch/index.html">Strmatch</a></li><li><a href="../../compiler-libs.optcomp/Symbol/index.html">Symbol</a></li><li><a href="../../compiler-libs.optcomp/Tag/index.html">Tag</a></li><li><a href="../../compiler-libs.optcomp/Thread_sanitizer/index.html">Thread_sanitizer</a></li><li><a href="../../compiler-libs.optcomp/Traverse_for_exported_symbols/index.html">Traverse_for_exported_symbols</a></li><li><a href="../../compiler-libs.optcomp/Un_anf/index.html">Un_anf</a></li><li><a href="../../compiler-libs.optcomp/Unbox_closures/index.html">Unbox_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_free_vars_of_closures/index.html">Unbox_free_vars_of_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_specialised_args/index.html">Unbox_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Var_within_closure/index.html">Var_within_closure</a></li><li><a href="../../compiler-libs.optcomp/Variable/index.html">Variable</a></li></ul></li><li>Library <code>compiler-libs.toplevel</code><ul><li><a href="../../compiler-libs.toplevel/Genprintval/index.html">Genprintval</a></li><li><a href="../../compiler-libs.toplevel/Topcommon/index.html">Topcommon</a></li><li><a href="../../compiler-libs.toplevel/Topdirs/index.html">Topdirs</a></li><li><a href="../../compiler-libs.toplevel/Topeval/index.html">Topeval</a></li><li><a href="../../compiler-libs.toplevel/Toploop/index.html">Toploop</a></li><li><a href="../../compiler-libs.toplevel/Topmain/index.html">Topmain</a></li><li><a href="../../compiler-libs.toplevel/Topprinters/index.html">Topprinters</a></li><li><a href="../../compiler-libs.toplevel/Trace/index.html">Trace</a></li></ul></li><li>Library <code>dynlink</code><ul><li><a href="../../dynlink/Dynlink/index.html">Dynlink</a></li></ul></li><li>Library <code>runtime_events</code><ul><li><a href="../../runtime_events/Runtime_events/index.html">Runtime_events</a></li></ul></li><li>Library <code>stdlib</code><ul><li><a href="../../stdlib/CamlinternalFormat/index.html">CamlinternalFormat</a></li><li><a href="../../stdlib/CamlinternalFormatBasics/index.html">CamlinternalFormatBasics</a></li><li><a href="../../stdlib/CamlinternalLazy/index.html">CamlinternalLazy</a></li><li><a href="../../stdlib/CamlinternalMod/index.html">CamlinternalMod</a></li><li><a href="../../stdlib/CamlinternalOO/index.html">CamlinternalOO</a></li><li><a href="../../stdlib/Stdlib/index.html">Stdlib</a></li></ul></li><li>Library <code>str</code><ul><li><a href="../../str/Str/index.html">Str</a></li></ul></li><li>Library <code>threads</code><ul><li><a href="../../threads/Event/index.html">Event</a></li><li><a href="../../threads/Thread/index.html">Thread</a></li></ul></li><li>Library <code>unix</code><ul><li><a href="../../unix/Unix/index.html">Unix</a></li><li><a href="../../unix/UnixLabels/index.html">UnixLabels</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>stdlib<ul><li><a href="arg.ml.html">arg.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="arrayLabels.ml.html">arrayLabels.ml</a></li><li><a href="atomic.ml.html">atomic.ml</a></li><li><a href="bigarray.ml.html">bigarray.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytesLabels.ml.html">bytesLabels.ml</a></li><li><a href="callback.ml.html">callback.ml</a></li><li><a href="camlinternalFormat.ml.html">camlinternalFormat.ml</a></li><li><a href="camlinternalFormatBasics.ml.html">camlinternalFormatBasics.ml</a></li><li><a href="camlinternalLazy.ml.html">camlinternalLazy.ml</a></li><li><a href="camlinternalMod.ml.html">camlinternalMod.ml</a></li><li><a href="camlinternalOO.ml.html">camlinternalOO.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="complex.ml.html">complex.ml</a></li><li><a href="condition.ml.html">condition.ml</a></li><li><a href="digest.ml.html">digest.ml</a></li><li><a href="domain.ml.html">domain.ml</a></li><li><a href="dynarray.ml.html">dynarray.ml</a></li><li><a href="effect.ml.html">effect.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="ephemeron.ml.html">ephemeron.ml</a></li><li><a href="filename.ml.html">filename.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="#" class="current_unit">format.ml</a></li><li><a href="fun.ml.html">fun.ml</a></li><li><a href="gc.ml.html">gc.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="in_channel.ml.html">in_channel.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="lexing.ml.html">lexing.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="listLabels.ml.html">listLabels.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="marshal.ml.html">marshal.ml</a></li><li><a href="moreLabels.ml.html">moreLabels.ml</a></li><li><a href="mutex.ml.html">mutex.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="obj.ml.html">obj.ml</a></li><li><a href="oo.ml.html">oo.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="out_channel.ml.html">out_channel.ml</a></li><li><a href="parsing.ml.html">parsing.ml</a></li><li><a href="printexc.ml.html">printexc.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="scanf.ml.html">scanf.ml</a></li><li><a href="semaphore.ml.html">semaphore.ml</a></li><li><a href="seq.ml.html">seq.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stdLabels.ml.html">stdLabels.ml</a></li><li><a href="stdlib.ml.html">stdlib.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="stringLabels.ml.html">stringLabels.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="type.ml.html">type.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="weak.ml.html">weak.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
<a id="L948" class="source_line" href="#L948">948</a>
<a id="L949" class="source_line" href="#L949">949</a>
<a id="L950" class="source_line" href="#L950">950</a>
<a id="L951" class="source_line" href="#L951">951</a>
<a id="L952" class="source_line" href="#L952">952</a>
<a id="L953" class="source_line" href="#L953">953</a>
<a id="L954" class="source_line" href="#L954">954</a>
<a id="L955" class="source_line" href="#L955">955</a>
<a id="L956" class="source_line" href="#L956">956</a>
<a id="L957" class="source_line" href="#L957">957</a>
<a id="L958" class="source_line" href="#L958">958</a>
<a id="L959" class="source_line" href="#L959">959</a>
<a id="L960" class="source_line" href="#L960">960</a>
<a id="L961" class="source_line" href="#L961">961</a>
<a id="L962" class="source_line" href="#L962">962</a>
<a id="L963" class="source_line" href="#L963">963</a>
<a id="L964" class="source_line" href="#L964">964</a>
<a id="L965" class="source_line" href="#L965">965</a>
<a id="L966" class="source_line" href="#L966">966</a>
<a id="L967" class="source_line" href="#L967">967</a>
<a id="L968" class="source_line" href="#L968">968</a>
<a id="L969" class="source_line" href="#L969">969</a>
<a id="L970" class="source_line" href="#L970">970</a>
<a id="L971" class="source_line" href="#L971">971</a>
<a id="L972" class="source_line" href="#L972">972</a>
<a id="L973" class="source_line" href="#L973">973</a>
<a id="L974" class="source_line" href="#L974">974</a>
<a id="L975" class="source_line" href="#L975">975</a>
<a id="L976" class="source_line" href="#L976">976</a>
<a id="L977" class="source_line" href="#L977">977</a>
<a id="L978" class="source_line" href="#L978">978</a>
<a id="L979" class="source_line" href="#L979">979</a>
<a id="L980" class="source_line" href="#L980">980</a>
<a id="L981" class="source_line" href="#L981">981</a>
<a id="L982" class="source_line" href="#L982">982</a>
<a id="L983" class="source_line" href="#L983">983</a>
<a id="L984" class="source_line" href="#L984">984</a>
<a id="L985" class="source_line" href="#L985">985</a>
<a id="L986" class="source_line" href="#L986">986</a>
<a id="L987" class="source_line" href="#L987">987</a>
<a id="L988" class="source_line" href="#L988">988</a>
<a id="L989" class="source_line" href="#L989">989</a>
<a id="L990" class="source_line" href="#L990">990</a>
<a id="L991" class="source_line" href="#L991">991</a>
<a id="L992" class="source_line" href="#L992">992</a>
<a id="L993" class="source_line" href="#L993">993</a>
<a id="L994" class="source_line" href="#L994">994</a>
<a id="L995" class="source_line" href="#L995">995</a>
<a id="L996" class="source_line" href="#L996">996</a>
<a id="L997" class="source_line" href="#L997">997</a>
<a id="L998" class="source_line" href="#L998">998</a>
<a id="L999" class="source_line" href="#L999">999</a>
<a id="L1000" class="source_line" href="#L1000">1000</a>
<a id="L1001" class="source_line" href="#L1001">1001</a>
<a id="L1002" class="source_line" href="#L1002">1002</a>
<a id="L1003" class="source_line" href="#L1003">1003</a>
<a id="L1004" class="source_line" href="#L1004">1004</a>
<a id="L1005" class="source_line" href="#L1005">1005</a>
<a id="L1006" class="source_line" href="#L1006">1006</a>
<a id="L1007" class="source_line" href="#L1007">1007</a>
<a id="L1008" class="source_line" href="#L1008">1008</a>
<a id="L1009" class="source_line" href="#L1009">1009</a>
<a id="L1010" class="source_line" href="#L1010">1010</a>
<a id="L1011" class="source_line" href="#L1011">1011</a>
<a id="L1012" class="source_line" href="#L1012">1012</a>
<a id="L1013" class="source_line" href="#L1013">1013</a>
<a id="L1014" class="source_line" href="#L1014">1014</a>
<a id="L1015" class="source_line" href="#L1015">1015</a>
<a id="L1016" class="source_line" href="#L1016">1016</a>
<a id="L1017" class="source_line" href="#L1017">1017</a>
<a id="L1018" class="source_line" href="#L1018">1018</a>
<a id="L1019" class="source_line" href="#L1019">1019</a>
<a id="L1020" class="source_line" href="#L1020">1020</a>
<a id="L1021" class="source_line" href="#L1021">1021</a>
<a id="L1022" class="source_line" href="#L1022">1022</a>
<a id="L1023" class="source_line" href="#L1023">1023</a>
<a id="L1024" class="source_line" href="#L1024">1024</a>
<a id="L1025" class="source_line" href="#L1025">1025</a>
<a id="L1026" class="source_line" href="#L1026">1026</a>
<a id="L1027" class="source_line" href="#L1027">1027</a>
<a id="L1028" class="source_line" href="#L1028">1028</a>
<a id="L1029" class="source_line" href="#L1029">1029</a>
<a id="L1030" class="source_line" href="#L1030">1030</a>
<a id="L1031" class="source_line" href="#L1031">1031</a>
<a id="L1032" class="source_line" href="#L1032">1032</a>
<a id="L1033" class="source_line" href="#L1033">1033</a>
<a id="L1034" class="source_line" href="#L1034">1034</a>
<a id="L1035" class="source_line" href="#L1035">1035</a>
<a id="L1036" class="source_line" href="#L1036">1036</a>
<a id="L1037" class="source_line" href="#L1037">1037</a>
<a id="L1038" class="source_line" href="#L1038">1038</a>
<a id="L1039" class="source_line" href="#L1039">1039</a>
<a id="L1040" class="source_line" href="#L1040">1040</a>
<a id="L1041" class="source_line" href="#L1041">1041</a>
<a id="L1042" class="source_line" href="#L1042">1042</a>
<a id="L1043" class="source_line" href="#L1043">1043</a>
<a id="L1044" class="source_line" href="#L1044">1044</a>
<a id="L1045" class="source_line" href="#L1045">1045</a>
<a id="L1046" class="source_line" href="#L1046">1046</a>
<a id="L1047" class="source_line" href="#L1047">1047</a>
<a id="L1048" class="source_line" href="#L1048">1048</a>
<a id="L1049" class="source_line" href="#L1049">1049</a>
<a id="L1050" class="source_line" href="#L1050">1050</a>
<a id="L1051" class="source_line" href="#L1051">1051</a>
<a id="L1052" class="source_line" href="#L1052">1052</a>
<a id="L1053" class="source_line" href="#L1053">1053</a>
<a id="L1054" class="source_line" href="#L1054">1054</a>
<a id="L1055" class="source_line" href="#L1055">1055</a>
<a id="L1056" class="source_line" href="#L1056">1056</a>
<a id="L1057" class="source_line" href="#L1057">1057</a>
<a id="L1058" class="source_line" href="#L1058">1058</a>
<a id="L1059" class="source_line" href="#L1059">1059</a>
<a id="L1060" class="source_line" href="#L1060">1060</a>
<a id="L1061" class="source_line" href="#L1061">1061</a>
<a id="L1062" class="source_line" href="#L1062">1062</a>
<a id="L1063" class="source_line" href="#L1063">1063</a>
<a id="L1064" class="source_line" href="#L1064">1064</a>
<a id="L1065" class="source_line" href="#L1065">1065</a>
<a id="L1066" class="source_line" href="#L1066">1066</a>
<a id="L1067" class="source_line" href="#L1067">1067</a>
<a id="L1068" class="source_line" href="#L1068">1068</a>
<a id="L1069" class="source_line" href="#L1069">1069</a>
<a id="L1070" class="source_line" href="#L1070">1070</a>
<a id="L1071" class="source_line" href="#L1071">1071</a>
<a id="L1072" class="source_line" href="#L1072">1072</a>
<a id="L1073" class="source_line" href="#L1073">1073</a>
<a id="L1074" class="source_line" href="#L1074">1074</a>
<a id="L1075" class="source_line" href="#L1075">1075</a>
<a id="L1076" class="source_line" href="#L1076">1076</a>
<a id="L1077" class="source_line" href="#L1077">1077</a>
<a id="L1078" class="source_line" href="#L1078">1078</a>
<a id="L1079" class="source_line" href="#L1079">1079</a>
<a id="L1080" class="source_line" href="#L1080">1080</a>
<a id="L1081" class="source_line" href="#L1081">1081</a>
<a id="L1082" class="source_line" href="#L1082">1082</a>
<a id="L1083" class="source_line" href="#L1083">1083</a>
<a id="L1084" class="source_line" href="#L1084">1084</a>
<a id="L1085" class="source_line" href="#L1085">1085</a>
<a id="L1086" class="source_line" href="#L1086">1086</a>
<a id="L1087" class="source_line" href="#L1087">1087</a>
<a id="L1088" class="source_line" href="#L1088">1088</a>
<a id="L1089" class="source_line" href="#L1089">1089</a>
<a id="L1090" class="source_line" href="#L1090">1090</a>
<a id="L1091" class="source_line" href="#L1091">1091</a>
<a id="L1092" class="source_line" href="#L1092">1092</a>
<a id="L1093" class="source_line" href="#L1093">1093</a>
<a id="L1094" class="source_line" href="#L1094">1094</a>
<a id="L1095" class="source_line" href="#L1095">1095</a>
<a id="L1096" class="source_line" href="#L1096">1096</a>
<a id="L1097" class="source_line" href="#L1097">1097</a>
<a id="L1098" class="source_line" href="#L1098">1098</a>
<a id="L1099" class="source_line" href="#L1099">1099</a>
<a id="L1100" class="source_line" href="#L1100">1100</a>
<a id="L1101" class="source_line" href="#L1101">1101</a>
<a id="L1102" class="source_line" href="#L1102">1102</a>
<a id="L1103" class="source_line" href="#L1103">1103</a>
<a id="L1104" class="source_line" href="#L1104">1104</a>
<a id="L1105" class="source_line" href="#L1105">1105</a>
<a id="L1106" class="source_line" href="#L1106">1106</a>
<a id="L1107" class="source_line" href="#L1107">1107</a>
<a id="L1108" class="source_line" href="#L1108">1108</a>
<a id="L1109" class="source_line" href="#L1109">1109</a>
<a id="L1110" class="source_line" href="#L1110">1110</a>
<a id="L1111" class="source_line" href="#L1111">1111</a>
<a id="L1112" class="source_line" href="#L1112">1112</a>
<a id="L1113" class="source_line" href="#L1113">1113</a>
<a id="L1114" class="source_line" href="#L1114">1114</a>
<a id="L1115" class="source_line" href="#L1115">1115</a>
<a id="L1116" class="source_line" href="#L1116">1116</a>
<a id="L1117" class="source_line" href="#L1117">1117</a>
<a id="L1118" class="source_line" href="#L1118">1118</a>
<a id="L1119" class="source_line" href="#L1119">1119</a>
<a id="L1120" class="source_line" href="#L1120">1120</a>
<a id="L1121" class="source_line" href="#L1121">1121</a>
<a id="L1122" class="source_line" href="#L1122">1122</a>
<a id="L1123" class="source_line" href="#L1123">1123</a>
<a id="L1124" class="source_line" href="#L1124">1124</a>
<a id="L1125" class="source_line" href="#L1125">1125</a>
<a id="L1126" class="source_line" href="#L1126">1126</a>
<a id="L1127" class="source_line" href="#L1127">1127</a>
<a id="L1128" class="source_line" href="#L1128">1128</a>
<a id="L1129" class="source_line" href="#L1129">1129</a>
<a id="L1130" class="source_line" href="#L1130">1130</a>
<a id="L1131" class="source_line" href="#L1131">1131</a>
<a id="L1132" class="source_line" href="#L1132">1132</a>
<a id="L1133" class="source_line" href="#L1133">1133</a>
<a id="L1134" class="source_line" href="#L1134">1134</a>
<a id="L1135" class="source_line" href="#L1135">1135</a>
<a id="L1136" class="source_line" href="#L1136">1136</a>
<a id="L1137" class="source_line" href="#L1137">1137</a>
<a id="L1138" class="source_line" href="#L1138">1138</a>
<a id="L1139" class="source_line" href="#L1139">1139</a>
<a id="L1140" class="source_line" href="#L1140">1140</a>
<a id="L1141" class="source_line" href="#L1141">1141</a>
<a id="L1142" class="source_line" href="#L1142">1142</a>
<a id="L1143" class="source_line" href="#L1143">1143</a>
<a id="L1144" class="source_line" href="#L1144">1144</a>
<a id="L1145" class="source_line" href="#L1145">1145</a>
<a id="L1146" class="source_line" href="#L1146">1146</a>
<a id="L1147" class="source_line" href="#L1147">1147</a>
<a id="L1148" class="source_line" href="#L1148">1148</a>
<a id="L1149" class="source_line" href="#L1149">1149</a>
<a id="L1150" class="source_line" href="#L1150">1150</a>
<a id="L1151" class="source_line" href="#L1151">1151</a>
<a id="L1152" class="source_line" href="#L1152">1152</a>
<a id="L1153" class="source_line" href="#L1153">1153</a>
<a id="L1154" class="source_line" href="#L1154">1154</a>
<a id="L1155" class="source_line" href="#L1155">1155</a>
<a id="L1156" class="source_line" href="#L1156">1156</a>
<a id="L1157" class="source_line" href="#L1157">1157</a>
<a id="L1158" class="source_line" href="#L1158">1158</a>
<a id="L1159" class="source_line" href="#L1159">1159</a>
<a id="L1160" class="source_line" href="#L1160">1160</a>
<a id="L1161" class="source_line" href="#L1161">1161</a>
<a id="L1162" class="source_line" href="#L1162">1162</a>
<a id="L1163" class="source_line" href="#L1163">1163</a>
<a id="L1164" class="source_line" href="#L1164">1164</a>
<a id="L1165" class="source_line" href="#L1165">1165</a>
<a id="L1166" class="source_line" href="#L1166">1166</a>
<a id="L1167" class="source_line" href="#L1167">1167</a>
<a id="L1168" class="source_line" href="#L1168">1168</a>
<a id="L1169" class="source_line" href="#L1169">1169</a>
<a id="L1170" class="source_line" href="#L1170">1170</a>
<a id="L1171" class="source_line" href="#L1171">1171</a>
<a id="L1172" class="source_line" href="#L1172">1172</a>
<a id="L1173" class="source_line" href="#L1173">1173</a>
<a id="L1174" class="source_line" href="#L1174">1174</a>
<a id="L1175" class="source_line" href="#L1175">1175</a>
<a id="L1176" class="source_line" href="#L1176">1176</a>
<a id="L1177" class="source_line" href="#L1177">1177</a>
<a id="L1178" class="source_line" href="#L1178">1178</a>
<a id="L1179" class="source_line" href="#L1179">1179</a>
<a id="L1180" class="source_line" href="#L1180">1180</a>
<a id="L1181" class="source_line" href="#L1181">1181</a>
<a id="L1182" class="source_line" href="#L1182">1182</a>
<a id="L1183" class="source_line" href="#L1183">1183</a>
<a id="L1184" class="source_line" href="#L1184">1184</a>
<a id="L1185" class="source_line" href="#L1185">1185</a>
<a id="L1186" class="source_line" href="#L1186">1186</a>
<a id="L1187" class="source_line" href="#L1187">1187</a>
<a id="L1188" class="source_line" href="#L1188">1188</a>
<a id="L1189" class="source_line" href="#L1189">1189</a>
<a id="L1190" class="source_line" href="#L1190">1190</a>
<a id="L1191" class="source_line" href="#L1191">1191</a>
<a id="L1192" class="source_line" href="#L1192">1192</a>
<a id="L1193" class="source_line" href="#L1193">1193</a>
<a id="L1194" class="source_line" href="#L1194">1194</a>
<a id="L1195" class="source_line" href="#L1195">1195</a>
<a id="L1196" class="source_line" href="#L1196">1196</a>
<a id="L1197" class="source_line" href="#L1197">1197</a>
<a id="L1198" class="source_line" href="#L1198">1198</a>
<a id="L1199" class="source_line" href="#L1199">1199</a>
<a id="L1200" class="source_line" href="#L1200">1200</a>
<a id="L1201" class="source_line" href="#L1201">1201</a>
<a id="L1202" class="source_line" href="#L1202">1202</a>
<a id="L1203" class="source_line" href="#L1203">1203</a>
<a id="L1204" class="source_line" href="#L1204">1204</a>
<a id="L1205" class="source_line" href="#L1205">1205</a>
<a id="L1206" class="source_line" href="#L1206">1206</a>
<a id="L1207" class="source_line" href="#L1207">1207</a>
<a id="L1208" class="source_line" href="#L1208">1208</a>
<a id="L1209" class="source_line" href="#L1209">1209</a>
<a id="L1210" class="source_line" href="#L1210">1210</a>
<a id="L1211" class="source_line" href="#L1211">1211</a>
<a id="L1212" class="source_line" href="#L1212">1212</a>
<a id="L1213" class="source_line" href="#L1213">1213</a>
<a id="L1214" class="source_line" href="#L1214">1214</a>
<a id="L1215" class="source_line" href="#L1215">1215</a>
<a id="L1216" class="source_line" href="#L1216">1216</a>
<a id="L1217" class="source_line" href="#L1217">1217</a>
<a id="L1218" class="source_line" href="#L1218">1218</a>
<a id="L1219" class="source_line" href="#L1219">1219</a>
<a id="L1220" class="source_line" href="#L1220">1220</a>
<a id="L1221" class="source_line" href="#L1221">1221</a>
<a id="L1222" class="source_line" href="#L1222">1222</a>
<a id="L1223" class="source_line" href="#L1223">1223</a>
<a id="L1224" class="source_line" href="#L1224">1224</a>
<a id="L1225" class="source_line" href="#L1225">1225</a>
<a id="L1226" class="source_line" href="#L1226">1226</a>
<a id="L1227" class="source_line" href="#L1227">1227</a>
<a id="L1228" class="source_line" href="#L1228">1228</a>
<a id="L1229" class="source_line" href="#L1229">1229</a>
<a id="L1230" class="source_line" href="#L1230">1230</a>
<a id="L1231" class="source_line" href="#L1231">1231</a>
<a id="L1232" class="source_line" href="#L1232">1232</a>
<a id="L1233" class="source_line" href="#L1233">1233</a>
<a id="L1234" class="source_line" href="#L1234">1234</a>
<a id="L1235" class="source_line" href="#L1235">1235</a>
<a id="L1236" class="source_line" href="#L1236">1236</a>
<a id="L1237" class="source_line" href="#L1237">1237</a>
<a id="L1238" class="source_line" href="#L1238">1238</a>
<a id="L1239" class="source_line" href="#L1239">1239</a>
<a id="L1240" class="source_line" href="#L1240">1240</a>
<a id="L1241" class="source_line" href="#L1241">1241</a>
<a id="L1242" class="source_line" href="#L1242">1242</a>
<a id="L1243" class="source_line" href="#L1243">1243</a>
<a id="L1244" class="source_line" href="#L1244">1244</a>
<a id="L1245" class="source_line" href="#L1245">1245</a>
<a id="L1246" class="source_line" href="#L1246">1246</a>
<a id="L1247" class="source_line" href="#L1247">1247</a>
<a id="L1248" class="source_line" href="#L1248">1248</a>
<a id="L1249" class="source_line" href="#L1249">1249</a>
<a id="L1250" class="source_line" href="#L1250">1250</a>
<a id="L1251" class="source_line" href="#L1251">1251</a>
<a id="L1252" class="source_line" href="#L1252">1252</a>
<a id="L1253" class="source_line" href="#L1253">1253</a>
<a id="L1254" class="source_line" href="#L1254">1254</a>
<a id="L1255" class="source_line" href="#L1255">1255</a>
<a id="L1256" class="source_line" href="#L1256">1256</a>
<a id="L1257" class="source_line" href="#L1257">1257</a>
<a id="L1258" class="source_line" href="#L1258">1258</a>
<a id="L1259" class="source_line" href="#L1259">1259</a>
<a id="L1260" class="source_line" href="#L1260">1260</a>
<a id="L1261" class="source_line" href="#L1261">1261</a>
<a id="L1262" class="source_line" href="#L1262">1262</a>
<a id="L1263" class="source_line" href="#L1263">1263</a>
<a id="L1264" class="source_line" href="#L1264">1264</a>
<a id="L1265" class="source_line" href="#L1265">1265</a>
<a id="L1266" class="source_line" href="#L1266">1266</a>
<a id="L1267" class="source_line" href="#L1267">1267</a>
<a id="L1268" class="source_line" href="#L1268">1268</a>
<a id="L1269" class="source_line" href="#L1269">1269</a>
<a id="L1270" class="source_line" href="#L1270">1270</a>
<a id="L1271" class="source_line" href="#L1271">1271</a>
<a id="L1272" class="source_line" href="#L1272">1272</a>
<a id="L1273" class="source_line" href="#L1273">1273</a>
<a id="L1274" class="source_line" href="#L1274">1274</a>
<a id="L1275" class="source_line" href="#L1275">1275</a>
<a id="L1276" class="source_line" href="#L1276">1276</a>
<a id="L1277" class="source_line" href="#L1277">1277</a>
<a id="L1278" class="source_line" href="#L1278">1278</a>
<a id="L1279" class="source_line" href="#L1279">1279</a>
<a id="L1280" class="source_line" href="#L1280">1280</a>
<a id="L1281" class="source_line" href="#L1281">1281</a>
<a id="L1282" class="source_line" href="#L1282">1282</a>
<a id="L1283" class="source_line" href="#L1283">1283</a>
<a id="L1284" class="source_line" href="#L1284">1284</a>
<a id="L1285" class="source_line" href="#L1285">1285</a>
<a id="L1286" class="source_line" href="#L1286">1286</a>
<a id="L1287" class="source_line" href="#L1287">1287</a>
<a id="L1288" class="source_line" href="#L1288">1288</a>
<a id="L1289" class="source_line" href="#L1289">1289</a>
<a id="L1290" class="source_line" href="#L1290">1290</a>
<a id="L1291" class="source_line" href="#L1291">1291</a>
<a id="L1292" class="source_line" href="#L1292">1292</a>
<a id="L1293" class="source_line" href="#L1293">1293</a>
<a id="L1294" class="source_line" href="#L1294">1294</a>
<a id="L1295" class="source_line" href="#L1295">1295</a>
<a id="L1296" class="source_line" href="#L1296">1296</a>
<a id="L1297" class="source_line" href="#L1297">1297</a>
<a id="L1298" class="source_line" href="#L1298">1298</a>
<a id="L1299" class="source_line" href="#L1299">1299</a>
<a id="L1300" class="source_line" href="#L1300">1300</a>
<a id="L1301" class="source_line" href="#L1301">1301</a>
<a id="L1302" class="source_line" href="#L1302">1302</a>
<a id="L1303" class="source_line" href="#L1303">1303</a>
<a id="L1304" class="source_line" href="#L1304">1304</a>
<a id="L1305" class="source_line" href="#L1305">1305</a>
<a id="L1306" class="source_line" href="#L1306">1306</a>
<a id="L1307" class="source_line" href="#L1307">1307</a>
<a id="L1308" class="source_line" href="#L1308">1308</a>
<a id="L1309" class="source_line" href="#L1309">1309</a>
<a id="L1310" class="source_line" href="#L1310">1310</a>
<a id="L1311" class="source_line" href="#L1311">1311</a>
<a id="L1312" class="source_line" href="#L1312">1312</a>
<a id="L1313" class="source_line" href="#L1313">1313</a>
<a id="L1314" class="source_line" href="#L1314">1314</a>
<a id="L1315" class="source_line" href="#L1315">1315</a>
<a id="L1316" class="source_line" href="#L1316">1316</a>
<a id="L1317" class="source_line" href="#L1317">1317</a>
<a id="L1318" class="source_line" href="#L1318">1318</a>
<a id="L1319" class="source_line" href="#L1319">1319</a>
<a id="L1320" class="source_line" href="#L1320">1320</a>
<a id="L1321" class="source_line" href="#L1321">1321</a>
<a id="L1322" class="source_line" href="#L1322">1322</a>
<a id="L1323" class="source_line" href="#L1323">1323</a>
<a id="L1324" class="source_line" href="#L1324">1324</a>
<a id="L1325" class="source_line" href="#L1325">1325</a>
<a id="L1326" class="source_line" href="#L1326">1326</a>
<a id="L1327" class="source_line" href="#L1327">1327</a>
<a id="L1328" class="source_line" href="#L1328">1328</a>
<a id="L1329" class="source_line" href="#L1329">1329</a>
<a id="L1330" class="source_line" href="#L1330">1330</a>
<a id="L1331" class="source_line" href="#L1331">1331</a>
<a id="L1332" class="source_line" href="#L1332">1332</a>
<a id="L1333" class="source_line" href="#L1333">1333</a>
<a id="L1334" class="source_line" href="#L1334">1334</a>
<a id="L1335" class="source_line" href="#L1335">1335</a>
<a id="L1336" class="source_line" href="#L1336">1336</a>
<a id="L1337" class="source_line" href="#L1337">1337</a>
<a id="L1338" class="source_line" href="#L1338">1338</a>
<a id="L1339" class="source_line" href="#L1339">1339</a>
<a id="L1340" class="source_line" href="#L1340">1340</a>
<a id="L1341" class="source_line" href="#L1341">1341</a>
<a id="L1342" class="source_line" href="#L1342">1342</a>
<a id="L1343" class="source_line" href="#L1343">1343</a>
<a id="L1344" class="source_line" href="#L1344">1344</a>
<a id="L1345" class="source_line" href="#L1345">1345</a>
<a id="L1346" class="source_line" href="#L1346">1346</a>
<a id="L1347" class="source_line" href="#L1347">1347</a>
<a id="L1348" class="source_line" href="#L1348">1348</a>
<a id="L1349" class="source_line" href="#L1349">1349</a>
<a id="L1350" class="source_line" href="#L1350">1350</a>
<a id="L1351" class="source_line" href="#L1351">1351</a>
<a id="L1352" class="source_line" href="#L1352">1352</a>
<a id="L1353" class="source_line" href="#L1353">1353</a>
<a id="L1354" class="source_line" href="#L1354">1354</a>
<a id="L1355" class="source_line" href="#L1355">1355</a>
<a id="L1356" class="source_line" href="#L1356">1356</a>
<a id="L1357" class="source_line" href="#L1357">1357</a>
<a id="L1358" class="source_line" href="#L1358">1358</a>
<a id="L1359" class="source_line" href="#L1359">1359</a>
<a id="L1360" class="source_line" href="#L1360">1360</a>
<a id="L1361" class="source_line" href="#L1361">1361</a>
<a id="L1362" class="source_line" href="#L1362">1362</a>
<a id="L1363" class="source_line" href="#L1363">1363</a>
<a id="L1364" class="source_line" href="#L1364">1364</a>
<a id="L1365" class="source_line" href="#L1365">1365</a>
<a id="L1366" class="source_line" href="#L1366">1366</a>
<a id="L1367" class="source_line" href="#L1367">1367</a>
<a id="L1368" class="source_line" href="#L1368">1368</a>
<a id="L1369" class="source_line" href="#L1369">1369</a>
<a id="L1370" class="source_line" href="#L1370">1370</a>
<a id="L1371" class="source_line" href="#L1371">1371</a>
<a id="L1372" class="source_line" href="#L1372">1372</a>
<a id="L1373" class="source_line" href="#L1373">1373</a>
<a id="L1374" class="source_line" href="#L1374">1374</a>
<a id="L1375" class="source_line" href="#L1375">1375</a>
<a id="L1376" class="source_line" href="#L1376">1376</a>
<a id="L1377" class="source_line" href="#L1377">1377</a>
<a id="L1378" class="source_line" href="#L1378">1378</a>
<a id="L1379" class="source_line" href="#L1379">1379</a>
<a id="L1380" class="source_line" href="#L1380">1380</a>
<a id="L1381" class="source_line" href="#L1381">1381</a>
<a id="L1382" class="source_line" href="#L1382">1382</a>
<a id="L1383" class="source_line" href="#L1383">1383</a>
<a id="L1384" class="source_line" href="#L1384">1384</a>
<a id="L1385" class="source_line" href="#L1385">1385</a>
<a id="L1386" class="source_line" href="#L1386">1386</a>
<a id="L1387" class="source_line" href="#L1387">1387</a>
<a id="L1388" class="source_line" href="#L1388">1388</a>
<a id="L1389" class="source_line" href="#L1389">1389</a>
<a id="L1390" class="source_line" href="#L1390">1390</a>
<a id="L1391" class="source_line" href="#L1391">1391</a>
<a id="L1392" class="source_line" href="#L1392">1392</a>
<a id="L1393" class="source_line" href="#L1393">1393</a>
<a id="L1394" class="source_line" href="#L1394">1394</a>
<a id="L1395" class="source_line" href="#L1395">1395</a>
<a id="L1396" class="source_line" href="#L1396">1396</a>
<a id="L1397" class="source_line" href="#L1397">1397</a>
<a id="L1398" class="source_line" href="#L1398">1398</a>
<a id="L1399" class="source_line" href="#L1399">1399</a>
<a id="L1400" class="source_line" href="#L1400">1400</a>
<a id="L1401" class="source_line" href="#L1401">1401</a>
<a id="L1402" class="source_line" href="#L1402">1402</a>
<a id="L1403" class="source_line" href="#L1403">1403</a>
<a id="L1404" class="source_line" href="#L1404">1404</a>
<a id="L1405" class="source_line" href="#L1405">1405</a>
<a id="L1406" class="source_line" href="#L1406">1406</a>
<a id="L1407" class="source_line" href="#L1407">1407</a>
<a id="L1408" class="source_line" href="#L1408">1408</a>
<a id="L1409" class="source_line" href="#L1409">1409</a>
<a id="L1410" class="source_line" href="#L1410">1410</a>
<a id="L1411" class="source_line" href="#L1411">1411</a>
<a id="L1412" class="source_line" href="#L1412">1412</a>
<a id="L1413" class="source_line" href="#L1413">1413</a>
<a id="L1414" class="source_line" href="#L1414">1414</a>
<a id="L1415" class="source_line" href="#L1415">1415</a>
<a id="L1416" class="source_line" href="#L1416">1416</a>
<a id="L1417" class="source_line" href="#L1417">1417</a>
<a id="L1418" class="source_line" href="#L1418">1418</a>
<a id="L1419" class="source_line" href="#L1419">1419</a>
<a id="L1420" class="source_line" href="#L1420">1420</a>
<a id="L1421" class="source_line" href="#L1421">1421</a>
<a id="L1422" class="source_line" href="#L1422">1422</a>
<a id="L1423" class="source_line" href="#L1423">1423</a>
<a id="L1424" class="source_line" href="#L1424">1424</a>
<a id="L1425" class="source_line" href="#L1425">1425</a>
<a id="L1426" class="source_line" href="#L1426">1426</a>
<a id="L1427" class="source_line" href="#L1427">1427</a>
<a id="L1428" class="source_line" href="#L1428">1428</a>
<a id="L1429" class="source_line" href="#L1429">1429</a>
<a id="L1430" class="source_line" href="#L1430">1430</a>
<a id="L1431" class="source_line" href="#L1431">1431</a>
<a id="L1432" class="source_line" href="#L1432">1432</a>
<a id="L1433" class="source_line" href="#L1433">1433</a>
<a id="L1434" class="source_line" href="#L1434">1434</a>
<a id="L1435" class="source_line" href="#L1435">1435</a>
<a id="L1436" class="source_line" href="#L1436">1436</a>
<a id="L1437" class="source_line" href="#L1437">1437</a>
<a id="L1438" class="source_line" href="#L1438">1438</a>
<a id="L1439" class="source_line" href="#L1439">1439</a>
<a id="L1440" class="source_line" href="#L1440">1440</a>
<a id="L1441" class="source_line" href="#L1441">1441</a>
<a id="L1442" class="source_line" href="#L1442">1442</a>
<a id="L1443" class="source_line" href="#L1443">1443</a>
<a id="L1444" class="source_line" href="#L1444">1444</a>
<a id="L1445" class="source_line" href="#L1445">1445</a>
<a id="L1446" class="source_line" href="#L1446">1446</a>
<a id="L1447" class="source_line" href="#L1447">1447</a>
<a id="L1448" class="source_line" href="#L1448">1448</a>
<a id="L1449" class="source_line" href="#L1449">1449</a>
<a id="L1450" class="source_line" href="#L1450">1450</a>
<a id="L1451" class="source_line" href="#L1451">1451</a>
<a id="L1452" class="source_line" href="#L1452">1452</a>
<a id="L1453" class="source_line" href="#L1453">1453</a>
<a id="L1454" class="source_line" href="#L1454">1454</a>
<a id="L1455" class="source_line" href="#L1455">1455</a>
<a id="L1456" class="source_line" href="#L1456">1456</a>
<a id="L1457" class="source_line" href="#L1457">1457</a>
<a id="L1458" class="source_line" href="#L1458">1458</a>
<a id="L1459" class="source_line" href="#L1459">1459</a>
<a id="L1460" class="source_line" href="#L1460">1460</a>
<a id="L1461" class="source_line" href="#L1461">1461</a>
<a id="L1462" class="source_line" href="#L1462">1462</a>
<a id="L1463" class="source_line" href="#L1463">1463</a>
<a id="L1464" class="source_line" href="#L1464">1464</a>
<a id="L1465" class="source_line" href="#L1465">1465</a>
<a id="L1466" class="source_line" href="#L1466">1466</a>
<a id="L1467" class="source_line" href="#L1467">1467</a>
<a id="L1468" class="source_line" href="#L1468">1468</a>
<a id="L1469" class="source_line" href="#L1469">1469</a>
<a id="L1470" class="source_line" href="#L1470">1470</a>
<a id="L1471" class="source_line" href="#L1471">1471</a>
<a id="L1472" class="source_line" href="#L1472">1472</a>
<a id="L1473" class="source_line" href="#L1473">1473</a>
<a id="L1474" class="source_line" href="#L1474">1474</a>
<a id="L1475" class="source_line" href="#L1475">1475</a>
<a id="L1476" class="source_line" href="#L1476">1476</a>
<a id="L1477" class="source_line" href="#L1477">1477</a>
<a id="L1478" class="source_line" href="#L1478">1478</a>
<a id="L1479" class="source_line" href="#L1479">1479</a>
<a id="L1480" class="source_line" href="#L1480">1480</a>
<a id="L1481" class="source_line" href="#L1481">1481</a>
<a id="L1482" class="source_line" href="#L1482">1482</a>
<a id="L1483" class="source_line" href="#L1483">1483</a>
<a id="L1484" class="source_line" href="#L1484">1484</a>
<a id="L1485" class="source_line" href="#L1485">1485</a>
<a id="L1486" class="source_line" href="#L1486">1486</a>
<a id="L1487" class="source_line" href="#L1487">1487</a>
<a id="L1488" class="source_line" href="#L1488">1488</a>
<a id="L1489" class="source_line" href="#L1489">1489</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                 OCaml                                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*             Pierre Weis, projet Cristal, INRIA Rocquencourt            *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   Copyright 1996 Institut National de Recherche en Informatique et     *)</span><span class="EOL">
</span><span class="COMMENT">(*     en Automatique.                                                    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   All rights reserved.  This file is distributed under the terms of    *)</span><span class="EOL">
</span><span class="COMMENT">(*   the GNU Lesser General Public License version 2.1, with the          *)</span><span class="EOL">
</span><span class="COMMENT">(*   special exception on linking described in the file LICENSE.          *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* A pretty-printing facility and definition of formatters for 'parallel'
   (i.e. unrelated or independent) pretty-printing on multiple out channels. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*
   The pretty-printing engine internal data structures.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-id"><span class="LIDENT">id</span></span> <span id="local_x_1"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="#local_x_1"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* A devoted type for sizes to avoid confusion
   between sizes and mere integers. *)</span><span class="EOL">
</span><span id="module-Size"><span class="MODULE">module</span> <span class="UIDENT">Size</span> <span class="COLON">:</span> <span class="SIG">sig</span><span class="EOL">
</span>  <span id="module-Size.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span id="module-Size.val-to_int"><span class="VAL">val</span> <span class="LIDENT">to_int</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span id="module-Size.val-of_int"><span class="VAL">val</span> <span class="LIDENT">of_int</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-Size.val-zero"><span class="VAL">val</span> <span class="LIDENT">zero</span> <span class="COLON">:</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-Size.val-unknown"><span class="VAL">val</span> <span class="LIDENT">unknown</span> <span class="COLON">:</span> <span class="LIDENT">t</span></span><span class="EOL">
</span>  <span id="module-Size.val-is_known"><span class="VAL">val</span> <span class="LIDENT">is_known</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span></span><span class="EOL">
</span><span class="END">end</span>  <span class="EQUAL">=</span> <span class="STRUCT">struct</span><span class="EOL">
</span>  <span id="module-Size.type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">int</span></span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Size.val-to_int"><span class="LIDENT">to_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">id</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Size.val-of_int"><span class="LIDENT">of_int</span></span> <span class="EQUAL">=</span> <span class="LIDENT">id</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Size.val-zero"><span class="LIDENT">zero</span></span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Size.val-unknown"><span class="LIDENT">unknown</span></span> <span class="EQUAL">=</span> <span class="MINUS">-</span><span class="INT">1</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="module-Size.val-is_known"><span class="LIDENT">is_known</span></span> <span id="local_n_2"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_n_2"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="END">end</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printing boxes definition:
   a pretty-printing box is either
   - hbox: horizontal box (no line splitting)
   - vbox: vertical box (every break hint splits the line)
   - hvbox: horizontal/vertical box
     (the box behaves as an horizontal box if it fits on
      the current line, otherwise the box behaves as a vertical box)
   - hovbox: horizontal or vertical compacting box
     (the box is compacting material, printing as much material as possible
      on every lines)
   - box: horizontal or vertical compacting box with enhanced box structure
     (the box behaves as an horizontal or vertical box but break hints split
      the line if splitting would move to the left)
*)</span><span class="EOL">
</span><span id="type-box_type"><span class="TYPE">type</span> <span class="LIDENT">box_type</span> <span class="EQUAL">=</span> <a href="camlinternalFormatBasics.ml.html#type-block_type"><span class="UIDENT">CamlinternalFormatBasics</span><span class="DOT">.</span><span class="LIDENT">block_type</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-box_type.constructor-Pp_hbox"><span class="BAR">|</span> <span class="UIDENT">Pp_hbox</span></span> <span id="type-box_type.constructor-Pp_vbox"><span class="BAR">|</span> <span class="UIDENT">Pp_vbox</span></span> <span id="type-box_type.constructor-Pp_hvbox"><span class="BAR">|</span> <span class="UIDENT">Pp_hvbox</span></span> <span id="type-box_type.constructor-Pp_hovbox"><span class="BAR">|</span> <span class="UIDENT">Pp_hovbox</span></span> <span id="type-box_type.constructor-Pp_box"><span class="BAR">|</span> <span class="UIDENT">Pp_box</span></span> <span id="type-box_type.constructor-Pp_fits"><span class="BAR">|</span> <span class="UIDENT">Pp_fits</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printing tokens definition:
   are either text to print or pretty printing
   elements that drive indentation and line splitting. *)</span><span class="EOL">
</span><span id="type-pp_token"><span class="TYPE">type</span> <span class="LIDENT">pp_token</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_text"><span class="BAR">|</span> <span class="UIDENT">Pp_text</span> <span class="OF">of</span> <span class="LIDENT">string</span></span>          <span class="COMMENT">(* normal text *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_break"><span class="BAR">|</span> <span class="UIDENT">Pp_break</span> <span class="OF">of</span> <span class="LBRACE">{</span>              <span class="COMMENT">(* complete break *)</span><span class="EOL">
</span>      <span id="def_568"><span class="LIDENT">fits</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="STAR">*</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span>   <span class="COMMENT">(* line is not split *)</span><span class="EOL">
</span>      <span id="def_534"><span class="LIDENT">breaks</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="STAR">*</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span> <span class="COMMENT">(* line is split *)</span><span class="EOL">
</span>    <span class="RBRACE">}</span></span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_tbreak"><span class="BAR">|</span> <span class="UIDENT">Pp_tbreak</span> <span class="OF">of</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">int</span></span>     <span class="COMMENT">(* go to next tabulation *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_stab"><span class="BAR">|</span> <span class="UIDENT">Pp_stab</span></span>                    <span class="COMMENT">(* set a tabulation *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_begin"><span class="BAR">|</span> <span class="UIDENT">Pp_begin</span> <span class="OF">of</span> <span class="LIDENT">int</span> <span class="STAR">*</span> <span class="LIDENT">box_type</span></span> <span class="COMMENT">(* beginning of a box *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_end"><span class="BAR">|</span> <span class="UIDENT">Pp_end</span></span>                     <span class="COMMENT">(* end of a box *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_tbegin"><span class="BAR">|</span> <span class="UIDENT">Pp_tbegin</span> <span class="OF">of</span> <span class="LIDENT">tbox</span></span>          <span class="COMMENT">(* beginning of a tabulation box *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_tend"><span class="BAR">|</span> <span class="UIDENT">Pp_tend</span></span>                    <span class="COMMENT">(* end of a tabulation box *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_newline"><span class="BAR">|</span> <span class="UIDENT">Pp_newline</span></span>                 <span class="COMMENT">(* to force a newline inside a box *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_if_newline"><span class="BAR">|</span> <span class="UIDENT">Pp_if_newline</span></span>              <span class="COMMENT">(* to do something only if this very
                                  line has been broken *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_open_tag"><span class="BAR">|</span> <span class="UIDENT">Pp_open_tag</span> <span class="OF">of</span> <span class="LIDENT">stag</span></span>         <span class="COMMENT">(* opening a tag name *)</span><span class="EOL">
</span>  <span id="type-pp_token.constructor-Pp_close_tag"><span class="BAR">|</span> <span class="UIDENT">Pp_close_tag</span></span></span>               <span class="COMMENT">(* closing the most recently open tag *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-stag"><span class="AND">and</span> <span class="LIDENT">stag</span> <span class="EQUAL">=</span> <span class="DOTDOT">..</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-tbox"><span class="AND">and</span> <span class="LIDENT">tbox</span> <span class="EQUAL">=</span> <span id="type-tbox.constructor-Pp_tbox"><span class="UIDENT">Pp_tbox</span> <span class="OF">of</span> <a href="stdlib.ml.html#type-ref"><span class="LIDENT">int</span> <span class="LIDENT">list</span> <span class="LIDENT">ref</span></a></span></span>  <span class="COMMENT">(* Tabulation box *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-tag"><span class="TYPE">type</span> <span class="LIDENT">tag</span> <span class="EQUAL">=</span> <span class="LIDENT">string</span></span><span class="EOL">
</span><span class="TYPE">type</span> <span class="LIDENT">stag</span> <span class="PLUSEQ">+=</span> <span id="extension-String_tag"><span class="UIDENT">String_tag</span> <span class="OF">of</span> <span class="LIDENT">tag</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printer queue:
   pretty-printing material is not written in the output as soon as emitted;
   instead, the material is simply recorded in the pretty-printer queue,
   until the enclosing box has a known computed size and proper splitting
   decisions can be made.

   The pretty-printer queue contains formatting elements to be printed.
   Each formatting element is a tuple (size, token, length), where
   - length is the declared length of the token,
   - size is effective size of the token when it is printed
     (size is set when the size of the box is known, so that size of break
      hints are definitive). *)</span><span class="EOL">
</span><span id="type-pp_queue_elem"><span class="TYPE">type</span> <span class="LIDENT">pp_queue_elem</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_558"><span class="MUTABLE">mutable</span> <span class="LIDENT">size</span> <span class="COLON">:</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_560"><span class="LIDENT">token</span> <span class="COLON">:</span> <span class="LIDENT">pp_token</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_561"><span class="LIDENT">length</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printer queue definition. *)</span><span class="EOL">
</span><span id="type-pp_queue"><span class="TYPE">type</span> <span class="LIDENT">pp_queue</span> <span class="EQUAL">=</span> <a href="queue.ml.html#type-t"><span class="LIDENT">pp_queue_elem</span> <span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">t</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printer scanning stack. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printer scanning stack: scanning element definition. *)</span><span class="EOL">
</span><span id="type-pp_scan_elem"><span class="TYPE">type</span> <span class="LIDENT">pp_scan_elem</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_546"><span class="LIDENT">left_total</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span> <span class="COMMENT">(* Value of pp_left_total when the element was enqueued. *)</span><span class="EOL">
</span>  <span id="def_551"><span class="LIDENT">queue_elem</span> <span class="COLON">:</span> <span class="LIDENT">pp_queue_elem</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printer formatting stack:
   the formatting stack contains the description of all the currently active
   boxes; the pretty-printer formatting stack is used to split the lines
   while printing tokens. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The pretty-printer formatting stack: formatting stack element definition.
   Each stack element describes a pretty-printing box. *)</span><span class="EOL">
</span><span id="type-pp_format_elem"><span class="TYPE">type</span> <span class="LIDENT">pp_format_elem</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span id="def_549"><span class="LIDENT">box_type</span> <span class="COLON">:</span> <span class="LIDENT">box_type</span><span class="SEMI">;</span></span> <span id="def_577"><span class="LIDENT">width</span> <span class="COLON">:</span> <span class="LIDENT">int</span></span> <span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The formatter definition.
   Each formatter value is a pretty-printer instance with all its
   machinery. *)</span><span class="EOL">
</span><span id="type-formatter"><span class="TYPE">type</span> <span class="LIDENT">formatter</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span class="COMMENT">(* The pretty-printer scanning stack. *)</span><span class="EOL">
</span>  <span id="def_571"><span class="LIDENT">pp_scan_stack</span> <span class="COLON">:</span> <a href="stack.ml.html#type-t"><span class="LIDENT">pp_scan_elem</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* The pretty-printer formatting stack. *)</span><span class="EOL">
</span>  <span id="def_530"><span class="LIDENT">pp_format_stack</span> <span class="COLON">:</span> <a href="stack.ml.html#type-t"><span class="LIDENT">pp_format_elem</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_543"><span class="LIDENT">pp_tbox_stack</span> <span class="COLON">:</span> <a href="stack.ml.html#type-t"><span class="LIDENT">tbox</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* The pretty-printer semantics tag stack. *)</span><span class="EOL">
</span>  <span id="def_542"><span class="LIDENT">pp_tag_stack</span> <span class="COLON">:</span> <a href="stack.ml.html#type-t"><span class="LIDENT">stag</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_573"><span class="LIDENT">pp_mark_stack</span> <span class="COLON">:</span> <a href="stack.ml.html#type-t"><span class="LIDENT">stag</span> <span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">t</span></a><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Value of right margin. *)</span><span class="EOL">
</span>  <span id="def_531"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_margin</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Minimal space left before margin, when opening a box. *)</span><span class="EOL">
</span>  <span id="def_569"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_min_space_left</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Maximum value of indentation:
     no box can be opened further. *)</span><span class="EOL">
</span>  <span id="def_576"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_max_indent</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Space remaining on the current line. *)</span><span class="EOL">
</span>  <span id="def_559"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_space_left</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Current value of indentation. *)</span><span class="EOL">
</span>  <span id="def_556"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_current_indent</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* True when the line has been broken by the pretty-printer. *)</span><span class="EOL">
</span>  <span id="def_566"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_is_new_line</span> <span class="COLON">:</span> <span class="LIDENT">bool</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Total width of tokens already printed. *)</span><span class="EOL">
</span>  <span id="def_572"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_left_total</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Total width of tokens ever put in queue. *)</span><span class="EOL">
</span>  <span id="def_539"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_right_total</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Current number of open boxes. *)</span><span class="EOL">
</span>  <span id="def_535"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_curr_depth</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Maximum number of boxes which can be simultaneously open. *)</span><span class="EOL">
</span>  <span id="def_532"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_max_boxes</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Ellipsis string. *)</span><span class="EOL">
</span>  <span id="def_544"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_ellipsis</span> <span class="COLON">:</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Output function. *)</span><span class="EOL">
</span>  <span id="def_548"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_out_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Flushing function. *)</span><span class="EOL">
</span>  <span id="def_574"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_out_flush</span> <span class="COLON">:</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Output of new lines. *)</span><span class="EOL">
</span>  <span id="def_578"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_out_newline</span> <span class="COLON">:</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Output of break hints spaces. *)</span><span class="EOL">
</span>  <span id="def_557"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_out_spaces</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Output of indentation of new lines. *)</span><span class="EOL">
</span>  <span id="def_565"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_out_indent</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Are tags printed ? *)</span><span class="EOL">
</span>  <span id="def_575"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_print_tags</span> <span class="COLON">:</span> <span class="LIDENT">bool</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Are tags marked ? *)</span><span class="EOL">
</span>  <span id="def_554"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_mark_tags</span> <span class="COLON">:</span> <span class="LIDENT">bool</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* Find opening and closing markers of tags. *)</span><span class="EOL">
</span>  <span id="def_563"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_mark_open_tag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_547"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_mark_close_tag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_529"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_print_open_tag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_552"><span class="MUTABLE">mutable</span> <span class="LIDENT">pp_print_close_tag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span class="COMMENT">(* The pretty-printer queue. *)</span><span class="EOL">
</span>  <span id="def_555"><span class="LIDENT">pp_queue</span> <span class="COLON">:</span> <span class="LIDENT">pp_queue</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The formatter specific tag handling functions. *)</span><span class="EOL">
</span><span id="type-formatter_stag_functions"><span class="TYPE">type</span> <span class="LIDENT">formatter_stag_functions</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_570"><span class="LIDENT">mark_open_stag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_553"><span class="LIDENT">mark_close_stag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_567"><span class="LIDENT">print_open_stag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_540"><span class="LIDENT">print_close_stag</span> <span class="COLON">:</span> <span class="LIDENT">stag</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The formatter functions to output material. *)</span><span class="EOL">
</span><span id="type-formatter_out_functions"><span class="TYPE">type</span> <span class="LIDENT">formatter_out_functions</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_536"><span class="LIDENT">out_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_550"><span class="LIDENT">out_flush</span> <span class="COLON">:</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_537"><span class="LIDENT">out_newline</span> <span class="COLON">:</span> <span class="LIDENT">unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_533"><span class="LIDENT">out_spaces</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_526"><span class="LIDENT">out_indent</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  Auxiliaries and basic functions.

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Enter a token in the pretty-printer queue. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_enqueue"><span class="LIDENT">pp_enqueue</span></span> <span id="local_state_3"><span class="LIDENT">state</span></span> <span id="local_token_4"><span class="LIDENT">token</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_3"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_3"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_token_4"><span class="LIDENT">token</span></a><span class="DOT">.</span><span class="LIDENT">length</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="queue.ml.html#val-add"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_token_4"><span class="LIDENT">token</span></a> <a href="#local_state_3"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_queue</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_clear_queue"><span class="LIDENT">pp_clear_queue</span></span> <span id="local_state_5"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_5"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span><span class="SEMI">;</span> <a href="#local_state_5"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="queue.ml.html#val-clear"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_state_5"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_queue</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Pp_infinity: large value for default tokens size.

   Pp_infinity is documented as being greater than 1e10; to avoid
   confusion about the word 'greater', we choose pp_infinity greater
   than 1e10 + 1; for correct handling of tests in the algorithm,
   pp_infinity must be even one more than 1e10 + 1; let's stand on the
   safe side by choosing 1.e10+10.

   Pp_infinity could probably be 1073741823 that is 2^30 - 1, that is
   the minimal upper bound for integers; now that max_int is defined,
   this limit could also be defined as max_int - 1.

   However, before setting pp_infinity to something around max_int, we
   must carefully double-check all the integer arithmetic operations
   that involve pp_infinity, since any overflow would wreck havoc the
   pretty-printing algorithm's invariants. Given that this arithmetic
   correctness check is difficult and error prone and given that 1e10
   + 1 is in practice large enough, there is no need to attempt to set
   pp_infinity to the theoretically maximum limit. It is not worth the
   burden ! *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_infinity"><span class="LIDENT">pp_infinity</span></span> <span class="EQUAL">=</span> <span class="INT">1000000010</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Output functions for the formatter. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_output_string"><span class="LIDENT">pp_output_string</span></span> <span id="local_state_6"><span class="LIDENT">state</span></span> <span id="local_s_7"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_state_6"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <a href="#local_s_7"><span class="LIDENT">s</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_7"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_output_newline"><span class="LIDENT">pp_output_newline</span></span> <span id="local_state_8"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span> <a href="#local_state_8"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_output_spaces"><span class="LIDENT">pp_output_spaces</span></span> <span id="local_state_9"><span class="LIDENT">state</span></span> <span id="local_n_10"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_state_9"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span> <a href="#local_n_10"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_output_indent"><span class="LIDENT">pp_output_indent</span></span> <span id="local_state_11"><span class="LIDENT">state</span></span> <span id="local_n_12"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="#local_state_11"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span> <a href="#local_n_12"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Format a textual token *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_pp_text"><span class="LIDENT">format_pp_text</span></span> <span id="local_state_13"><span class="LIDENT">state</span></span> <span id="local_size_14"><span class="LIDENT">size</span></span> <span id="local_text_15"><span class="LIDENT">text</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_13"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_13"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_size_14"><span class="LIDENT">size</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_output_string</span> <a href="#local_state_13"><span class="LIDENT">state</span></a> <a href="#local_text_15"><span class="LIDENT">text</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_13"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_is_new_line</span> <span class="LESSMINUS">&lt;-</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Format a string by its length, if not empty *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_string"><span class="LIDENT">format_string</span></span> <span id="local_state_16"><span class="LIDENT">state</span></span> <span id="local_s_17"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_s_17"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="STRING">&quot;&quot;</span> <span class="THEN">then</span> <span class="LIDENT">format_pp_text</span> <a href="#local_state_16"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_17"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_s_17"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a break, indenting a new line. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-break_new_line"><span class="LIDENT">break_new_line</span></span> <span id="local_state_18"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span id="local_before_19"><span class="LIDENT">before</span></span><span class="COMMA">,</span> <span id="local_offset_20"><span class="LIDENT">offset</span></span><span class="COMMA">,</span> <span id="local_after_21"><span class="LIDENT">after</span></span><span class="RPAREN">)</span> <span id="local_width_22"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">format_string</span> <a href="#local_state_18"><span class="LIDENT">state</span></a> <a href="#local_before_19"><span class="LIDENT">before</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_output_newline</span> <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_is_new_line</span> <span class="LESSMINUS">&lt;-</span> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_indent_23"><span class="LIDENT">indent</span></span> <span class="EQUAL">=</span> <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_width_22"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_offset_20"><span class="LIDENT">offset</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* Don't indent more than pp_max_indent. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_real_indent_24"><span class="LIDENT">real_indent</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_indent</span> <a href="#local_indent_23"><span class="LIDENT">indent</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_current_indent</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_real_indent_24"><span class="LIDENT">real_indent</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_current_indent</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_output_indent</span> <a href="#local_state_18"><span class="LIDENT">state</span></a> <a href="#local_state_18"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_current_indent</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">format_string</span> <a href="#local_state_18"><span class="LIDENT">state</span></a> <a href="#local_after_21"><span class="LIDENT">after</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To force a line break inside a box: no offset is added. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-break_line"><span class="LIDENT">break_line</span></span> <span id="local_state_25"><span class="LIDENT">state</span></span> <span id="local_width_26"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_25"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="STRING">&quot;&quot;</span><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span> <a href="#local_width_26"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a break that fits on the current line. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-break_same_line"><span class="LIDENT">break_same_line</span></span> <span id="local_state_27"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span id="local_before_28"><span class="LIDENT">before</span></span><span class="COMMA">,</span> <span id="local_width_29"><span class="LIDENT">width</span></span><span class="COMMA">,</span> <span id="local_after_30"><span class="LIDENT">after</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">format_string</span> <a href="#local_state_27"><span class="LIDENT">state</span></a> <a href="#local_before_28"><span class="LIDENT">before</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_27"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_27"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_width_29"><span class="LIDENT">width</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_output_spaces</span> <a href="#local_state_27"><span class="LIDENT">state</span></a> <a href="#local_width_29"><span class="LIDENT">width</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">format_string</span> <a href="#local_state_27"><span class="LIDENT">state</span></a> <a href="#local_after_30"><span class="LIDENT">after</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To indent no more than pp_max_indent, if one tries to open a box
   beyond pp_max_indent, then the box is rejected on the left
   by simulating a break. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_force_break_line"><span class="LIDENT">pp_force_break_line</span></span> <span id="local_state_31"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="stack.ml.html#val-top_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">top_opt</span></a> <a href="#local_state_31"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_format_stack</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_output_newline</span> <a href="#local_state_31"><span class="LIDENT">state</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_box_type_32"><span class="LIDENT">box_type</span></span><span class="SEMI">;</span> <span id="local_width_33"><span class="LIDENT">width</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_33"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_state_31"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_box_type_32"><span class="LIDENT">box_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_fits</span> <span class="BAR">|</span> <span class="UIDENT">Pp_hbox</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_vbox</span> <span class="BAR">|</span> <span class="UIDENT">Pp_hvbox</span> <span class="BAR">|</span> <span class="UIDENT">Pp_hovbox</span> <span class="BAR">|</span> <span class="UIDENT">Pp_box</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">break_line</span> <a href="#local_state_31"><span class="LIDENT">state</span></a> <a href="#local_width_33"><span class="LIDENT">width</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To skip a token, if the previous line has been broken. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_skip_token"><span class="LIDENT">pp_skip_token</span></span> <span id="local_state_34"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="queue.ml.html#val-take_opt"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">take_opt</span></a> <a href="#local_state_34"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_queue</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* print_if_newline must have been the last printing command *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_size_35"><span class="LIDENT">size</span></span><span class="SEMI">;</span> <span id="local_length_36"><span class="LIDENT">length</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="#local_state_34"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_34"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_length_36"><span class="LIDENT">length</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_state_34"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_34"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">to_int</span> <a href="#local_size_35"><span class="LIDENT">size</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  The main pretty printing functions.

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Formatting a token with a given size. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_pp_token"><span class="LIDENT">format_pp_token</span></span> <span id="local_state_37"><span class="LIDENT">state</span></span> <span id="local_size_38"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_text</span> <span id="local_s_39"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">format_pp_text</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_size_38"><span class="LIDENT">size</span></a> <a href="#local_s_39"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_begin</span> <span class="LPAREN">(</span><span id="local_off_40"><span class="LIDENT">off</span></span><span class="COMMA">,</span> <span id="local_ty_41"><span class="LIDENT">ty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_insertion_point_42"><span class="LIDENT">insertion_point</span></span> <span class="EQUAL">=</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_insertion_point_42"><span class="LIDENT">insertion_point</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_indent</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="COMMENT">(* can not open a box right there. *)</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="LIDENT">pp_force_break_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_width_43"><span class="LIDENT">width</span></span> <span class="EQUAL">=</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_off_40"><span class="LIDENT">off</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_box_type_44"><span class="LIDENT">box_type</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_ty_41"><span class="LIDENT">ty</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_vbox</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Pp_vbox</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_hbox</span> <span class="BAR">|</span> <span class="UIDENT">Pp_hvbox</span> <span class="BAR">|</span> <span class="UIDENT">Pp_hovbox</span> <span class="BAR">|</span> <span class="UIDENT">Pp_box</span> <span class="BAR">|</span> <span class="UIDENT">Pp_fits</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_size_38"><span class="LIDENT">size</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="THEN">then</span> <a href="#local_ty_41"><span class="LIDENT">ty</span></a> <span class="ELSE">else</span> <span class="UIDENT">Pp_fits</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <span class="LBRACE">{</span> <a href="#local_box_type_44"><span class="LIDENT">box_type</span></a><span class="SEMI">;</span> <a href="#local_width_43"><span class="LIDENT">width</span></a> <span class="RBRACE">}</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_format_stack</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_end</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stack.ml.html#val-pop_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_format_stack</span> <span class="INFIXOP0">|&gt;</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_tbegin</span> <span class="LPAREN">(</span><span class="UIDENT">Pp_tbox</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_tbox_45"><span class="LIDENT">tbox</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <a href="#local_tbox_45"><span class="LIDENT">tbox</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tbox_stack</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_tend</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stack.ml.html#val-pop_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tbox_stack</span> <span class="INFIXOP0">|&gt;</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_stab</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="stack.ml.html#val-top_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">top_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tbox_stack</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* No open tabulation box. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Pp_tbox</span> <span id="local_tabs_46"><span class="LIDENT">tabs</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="REC">rec</span> <span id="local_add_tab_47"><span class="LIDENT">add_tab</span></span> <span id="local_n_48"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span><a href="#local_n_48"><span class="LIDENT">n</span></a><span class="RBRACKET">]</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local_x_50"><span class="LIDENT">x</span></span> <span class="COLONCOLON">::</span> <span id="local_l_51"><span class="LIDENT">l</span></span> <span class="AS">as</span> <span id="local_ls_49"><span class="LIDENT">ls</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_n_48"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_x_50"><span class="LIDENT">x</span></a> <span class="THEN">then</span> <a href="#local_n_48"><span class="LIDENT">n</span></a> <span class="COLONCOLON">::</span> <a href="#local_ls_49"><span class="LIDENT">ls</span></a> <span class="ELSE">else</span> <a href="#local_x_50"><span class="LIDENT">x</span></a> <span class="COLONCOLON">::</span> <a href="#local_add_tab_47"><span class="LIDENT">add_tab</span></a> <a href="#local_n_48"><span class="LIDENT">n</span></a> <a href="#local_l_51"><span class="LIDENT">l</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_tabs_46"><span class="LIDENT">tabs</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_add_tab_47"><span class="LIDENT">add_tab</span></a> <span class="LPAREN">(</span><a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_tabs_46"><span class="LIDENT">tabs</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_tbreak</span> <span class="LPAREN">(</span><span id="local_n_52"><span class="LIDENT">n</span></span><span class="COMMA">,</span> <span id="local_off_53"><span class="LIDENT">off</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_insertion_point_54"><span class="LIDENT">insertion_point</span></span> <span class="EQUAL">=</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="stack.ml.html#val-top_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">top_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tbox_stack</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* No open tabulation box. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Pp_tbox</span> <span id="local_tabs_55"><span class="LIDENT">tabs</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_tab_56"><span class="LIDENT">tab</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_tabs_55"><span class="LIDENT">tabs</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_insertion_point_54"><span class="LIDENT">insertion_point</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local_first_57"><span class="LIDENT">first</span></span> <span class="COLONCOLON">::</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span class="REC">rec</span> <span id="local_find_58"><span class="LIDENT">find</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>            <span class="BAR">|</span> <span id="local_head_59"><span class="LIDENT">head</span></span> <span class="COLONCOLON">::</span> <span id="local_tail_60"><span class="LIDENT">tail</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="IF">if</span> <a href="#local_head_59"><span class="LIDENT">head</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_insertion_point_54"><span class="LIDENT">insertion_point</span></a> <span class="THEN">then</span> <a href="#local_head_59"><span class="LIDENT">head</span></a> <span class="ELSE">else</span> <a href="#local_find_58"><span class="LIDENT">find</span></a> <a href="#local_tail_60"><span class="LIDENT">tail</span></a><span class="EOL">
</span>            <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_first_57"><span class="LIDENT">first</span></a> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_find_58"><span class="LIDENT">find</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_tabs_55"><span class="LIDENT">tabs</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_offset_61"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span> <a href="#local_tab_56"><span class="LIDENT">tab</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_insertion_point_54"><span class="LIDENT">insertion_point</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_offset_61"><span class="LIDENT">offset</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span><span class="EOL">
</span>      <span class="THEN">then</span> <span class="LIDENT">break_same_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="STRING">&quot;&quot;</span><span class="COMMA">,</span> <a href="#local_offset_61"><span class="LIDENT">offset</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_n_52"><span class="LIDENT">n</span></a><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="STRING">&quot;&quot;</span><span class="COMMA">,</span> <a href="#local_tab_56"><span class="LIDENT">tab</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_off_53"><span class="LIDENT">off</span></a><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_newline</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="stack.ml.html#val-top_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">top_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_format_stack</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_output_newline</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <span class="COMMENT">(* No open box. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_width_62"><span class="LIDENT">width</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span><span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">break_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_width_62"><span class="LIDENT">width</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_if_newline</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_current_indent</span> <a href="stdlib.ml.html#val-(!=)"><span class="INFIXOP0">!=</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LIDENT">pp_skip_token</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Pp_break</span> <span class="LBRACE">{</span> <span id="local_fits_63"><span class="LIDENT">fits</span></span><span class="SEMI">;</span> <span id="local_breaks_64"><span class="LIDENT">breaks</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_527"><span id="local_before_65"><span class="LIDENT">before</span></span><span class="COMMA">,</span> <span id="local_off_66"><span class="LIDENT">off</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span></span> <span class="EQUAL">=</span> <a href="#local_breaks_64"><span class="LIDENT">breaks</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="stack.ml.html#val-top_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">top_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_format_stack</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* No open box. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_box_type_67"><span class="LIDENT">box_type</span></span><span class="SEMI">;</span> <span id="local_width_68"><span class="LIDENT">width</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_box_type_67"><span class="LIDENT">box_type</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_hovbox</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_size_38"><span class="LIDENT">size</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_before_65"><span class="LIDENT">before</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_breaks_64"><span class="LIDENT">breaks</span></a> <a href="#local_width_68"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LIDENT">break_same_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_fits_63"><span class="LIDENT">fits</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_box</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="COMMENT">(* Have the line just been broken here ? *)</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_is_new_line</span> <span class="THEN">then</span> <span class="LIDENT">break_same_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_fits_63"><span class="LIDENT">fits</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_size_38"><span class="LIDENT">size</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_before_65"><span class="LIDENT">before</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span><span class="EOL">
</span>          <span class="THEN">then</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_breaks_64"><span class="LIDENT">breaks</span></a> <a href="#local_width_68"><span class="LIDENT">width</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="COMMENT">(* break the line here leads to new indentation ? *)</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_current_indent</span> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_width_68"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_off_66"><span class="LIDENT">off</span></a><span class="EOL">
</span>        <span class="THEN">then</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_breaks_64"><span class="LIDENT">breaks</span></a> <a href="#local_width_68"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="LIDENT">break_same_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_fits_63"><span class="LIDENT">fits</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_hvbox</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_breaks_64"><span class="LIDENT">breaks</span></a> <a href="#local_width_68"><span class="LIDENT">width</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_fits</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">break_same_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_fits_63"><span class="LIDENT">fits</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_vbox</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">break_new_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_breaks_64"><span class="LIDENT">breaks</span></a> <a href="#local_width_68"><span class="LIDENT">width</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_hbox</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">break_same_line</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_fits_63"><span class="LIDENT">fits</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>   <span class="BAR">|</span> <span class="UIDENT">Pp_open_tag</span> <span id="local_tag_name_69"><span class="LIDENT">tag_name</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LET">let</span> <span id="local_marker_70"><span class="LIDENT">marker</span></span> <span class="EQUAL">=</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_open_tag</span> <a href="#local_tag_name_69"><span class="LIDENT">tag_name</span></a> <span class="IN">in</span><span class="EOL">
</span>     <span class="LIDENT">pp_output_string</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_marker_70"><span class="LIDENT">marker</span></a><span class="SEMI">;</span><span class="EOL">
</span>     <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <a href="#local_tag_name_69"><span class="LIDENT">tag_name</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_stack</span><span class="EOL">
</span><span class="EOL">
</span>   <span class="BAR">|</span> <span class="UIDENT">Pp_close_tag</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="stack.ml.html#val-pop_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop_opt</span></a> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_stack</span> <span class="WITH">with</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* No more tag to close. *)</span><span class="EOL">
</span>     <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_tag_name_71"><span class="LIDENT">tag_name</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="LET">let</span> <span id="local_marker_72"><span class="LIDENT">marker</span></span> <span class="EQUAL">=</span> <a href="#local_state_37"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_close_tag</span> <a href="#local_tag_name_71"><span class="LIDENT">tag_name</span></a> <span class="IN">in</span><span class="EOL">
</span>       <span class="LIDENT">pp_output_string</span> <a href="#local_state_37"><span class="LIDENT">state</span></a> <a href="#local_marker_72"><span class="LIDENT">marker</span></a><span class="EOL">
</span>     <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print if token size is known else printing is delayed.
   Printing is delayed when the text waiting in the queue requires
   more room to format than exists on the current line. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-advance_left"><span class="LIDENT">advance_left</span></span> <span id="local_state_73"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="queue.ml.html#val-peek_opt"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">peek_opt</span></a> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_queue</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* No tokens to print *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_size_74"><span class="LIDENT">size</span></span><span class="SEMI">;</span> <span id="local_token_75"><span class="LIDENT">token</span></span><span class="SEMI">;</span> <span id="local_length_76"><span class="LIDENT">length</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pending_count_77"><span class="LIDENT">pending_count</span></span> <span class="EQUAL">=</span> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">is_known</span> <a href="#local_size_74"><span class="LIDENT">size</span></a> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_pending_count_77"><span class="LIDENT">pending_count</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>      <a href="queue.ml.html#val-take"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">take</span></a> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_queue</span> <span class="INFIXOP0">|&gt;</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="SEMI">;</span> <span class="COMMENT">(* Not empty: we peek into it *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_size_78"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">is_known</span> <a href="#local_size_74"><span class="LIDENT">size</span></a> <span class="THEN">then</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">to_int</span> <a href="#local_size_74"><span class="LIDENT">size</span></a> <span class="ELSE">else</span> <span class="LIDENT">pp_infinity</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">format_pp_token</span> <a href="#local_state_73"><span class="LIDENT">state</span></a> <a href="#local_size_78"><span class="LIDENT">size</span></a> <a href="#local_token_75"><span class="LIDENT">token</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_length_76"><span class="LIDENT">length</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">advance_left</span> <span class="LBRACKETAT">[@</span><span class="LIDENT">tailcall</span><span class="RBRACKET">]</span><span class="RPAREN">)</span> <a href="#local_state_73"><span class="LIDENT">state</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To enqueue a token : try to advance. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-enqueue_advance"><span class="LIDENT">enqueue_advance</span></span> <span id="local_state_79"><span class="LIDENT">state</span></span> <span id="local_tok_80"><span class="LIDENT">tok</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_enqueue</span> <a href="#local_state_79"><span class="LIDENT">state</span></a> <a href="#local_tok_80"><span class="LIDENT">tok</span></a><span class="SEMI">;</span> <span class="LIDENT">advance_left</span> <a href="#local_state_79"><span class="LIDENT">state</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To enqueue strings. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-enqueue_string_as"><span class="LIDENT">enqueue_string_as</span></span> <span id="local_state_81"><span class="LIDENT">state</span></span> <span id="local_size_82"><span class="LIDENT">size</span></span> <span id="local_s_83"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">enqueue_advance</span> <a href="#local_state_81"><span class="LIDENT">state</span></a> <span class="LBRACE">{</span> <a href="#local_size_82"><span class="LIDENT">size</span></a><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_text</span> <a href="#local_s_83"><span class="LIDENT">s</span></a><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">to_int</span> <a href="#local_size_82"><span class="LIDENT">size</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-enqueue_string"><span class="LIDENT">enqueue_string</span></span> <span id="local_state_84"><span class="LIDENT">state</span></span> <span id="local_s_85"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">enqueue_string_as</span> <a href="#local_state_84"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_85"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_s_85"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Routines for scan stack
   determine size of boxes. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The scan_stack is never empty. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-initialize_scan_stack"><span class="LIDENT">initialize_scan_stack</span></span> <span id="local_stack_86"><span class="LIDENT">stack</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="stack.ml.html#val-clear"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_stack_86"><span class="LIDENT">stack</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_queue_elem_87"><span class="LIDENT">queue_elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">unknown</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_text</span> <span class="STRING">&quot;&quot;</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <span class="LBRACE">{</span> <span class="LIDENT">left_total</span> <span class="EQUAL">=</span> <span class="MINUS">-</span><span class="INT">1</span><span class="SEMI">;</span> <a href="#local_queue_elem_87"><span class="LIDENT">queue_elem</span></a> <span class="RBRACE">}</span> <a href="#local_stack_86"><span class="LIDENT">stack</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Setting the size of boxes on scan stack:
   if ty = true then size of break is set else size of box is set;
   in each case pp_scan_stack is popped.

   Note:
   Pattern matching on scan stack is exhaustive, since scan_stack is never
   empty.
   Pattern matching on token in scan stack is also exhaustive,
   since scan_push is used on breaks and opening of boxes. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_size"><span class="LIDENT">set_size</span></span> <span id="local_state_88"><span class="LIDENT">state</span></span> <span id="local_ty_89"><span class="LIDENT">ty</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="stack.ml.html#val-top_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">top_opt</span></a> <a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_scan_stack</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* scan_stack is never empty. *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LBRACE">{</span> <span id="local_left_total_90"><span class="LIDENT">left_total</span></span><span class="SEMI">;</span> <span id="local_queue_elem_91"><span class="LIDENT">queue_elem</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_size_92"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">to_int</span> <a href="#local_queue_elem_91"><span class="LIDENT">queue_elem</span></a><span class="DOT">.</span><span class="LIDENT">size</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* test if scan stack contains any data that is not obsolete. *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_left_total_90"><span class="LIDENT">left_total</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_left_total</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LIDENT">initialize_scan_stack</span> <a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_scan_stack</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_queue_elem_91"><span class="LIDENT">queue_elem</span></a><span class="DOT">.</span><span class="LIDENT">token</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_break</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Pp_tbreak</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_ty_89"><span class="LIDENT">ty</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <a href="#local_queue_elem_91"><span class="LIDENT">queue_elem</span></a><span class="DOT">.</span><span class="LIDENT">size</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_size_92"><span class="LIDENT">size</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="stack.ml.html#val-pop_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop_opt</span></a> <a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_scan_stack</span> <span class="INFIXOP0">|&gt;</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_begin</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_ty_89"><span class="LIDENT">ty</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>          <a href="#local_queue_elem_91"><span class="LIDENT">queue_elem</span></a><span class="DOT">.</span><span class="LIDENT">size</span> <span class="LESSMINUS">&lt;-</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_size_92"><span class="LIDENT">size</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="stack.ml.html#val-pop_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop_opt</span></a> <a href="#local_state_88"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_scan_stack</span> <span class="INFIXOP0">|&gt;</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_text</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Pp_stab</span> <span class="BAR">|</span> <span class="UIDENT">Pp_tbegin</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Pp_tend</span> <span class="BAR">|</span> <span class="UIDENT">Pp_end</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Pp_newline</span> <span class="BAR">|</span> <span class="UIDENT">Pp_if_newline</span> <span class="BAR">|</span> <span class="UIDENT">Pp_open_tag</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UIDENT">Pp_close_tag</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* scan_push is only used for breaks and boxes. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Push a token on pretty-printer scanning stack.
   If b is true set_size is called. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-scan_push"><span class="LIDENT">scan_push</span></span> <span id="local_state_93"><span class="LIDENT">state</span></span> <span id="local_b_94"><span class="LIDENT">b</span></span> <span id="local_token_95"><span class="LIDENT">token</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_enqueue</span> <a href="#local_state_93"><span class="LIDENT">state</span></a> <a href="#local_token_95"><span class="LIDENT">token</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_b_94"><span class="LIDENT">b</span></a> <span class="THEN">then</span> <span class="LIDENT">set_size</span> <a href="#local_state_93"><span class="LIDENT">state</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_elem_96"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">left_total</span> <span class="EQUAL">=</span> <a href="#local_state_93"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span><span class="SEMI">;</span> <span class="LIDENT">queue_elem</span> <span class="EQUAL">=</span> <a href="#local_token_95"><span class="LIDENT">token</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <a href="#local_elem_96"><span class="LIDENT">elem</span></a> <a href="#local_state_93"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_scan_stack</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To open a new box :
   the user may set the depth bound pp_max_boxes
   any text nested deeper is printed as the ellipsis string. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_open_box_gen"><span class="LIDENT">pp_open_box_gen</span></span> <span id="local_state_97"><span class="LIDENT">state</span></span> <span id="local_indent_98"><span class="LIDENT">indent</span></span> <span id="local_br_ty_99"><span class="LIDENT">br_ty</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_size_100"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elem_101"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_size_100"><span class="LIDENT">size</span></a><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_begin</span> <span class="LPAREN">(</span><a href="#local_indent_98"><span class="LIDENT">indent</span></a><span class="COMMA">,</span> <a href="#local_br_ty_99"><span class="LIDENT">br_ty</span></a><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_push</span> <a href="#local_state_97"><span class="LIDENT">state</span></a> <span class="FALSE">false</span> <a href="#local_elem_101"><span class="LIDENT">elem</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">enqueue_string</span> <a href="#local_state_97"><span class="LIDENT">state</span></a> <a href="#local_state_97"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_ellipsis</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The box which is always open. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_open_sys_box"><span class="LIDENT">pp_open_sys_box</span></span> <span id="local_state_102"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box_gen</span> <a href="#local_state_102"><span class="LIDENT">state</span></a> <span class="INT">0</span> <span class="UIDENT">Pp_hovbox</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Close a box, setting sizes of its sub boxes. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_close_box"><span class="LIDENT">pp_close_box</span></span> <span id="local_state_103"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_103"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <span class="THEN">then</span><span class="EOL">
</span>  <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_state_103"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_103"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LIDENT">pp_enqueue</span> <a href="#local_state_103"><span class="LIDENT">state</span></a> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_end</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">set_size</span> <a href="#local_state_103"><span class="LIDENT">state</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <span class="LIDENT">set_size</span> <a href="#local_state_103"><span class="LIDENT">state</span></a> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_state_103"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_103"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Open a tag, pushing it on the tag stack. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_open_stag"><span class="LIDENT">pp_open_stag</span></span> <span id="local_state_104"><span class="LIDENT">state</span></span> <span id="local_tag_name_105"><span class="LIDENT">tag_name</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_104"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_tags</span> <span class="THEN">then</span><span class="EOL">
</span>  <span class="BEGIN">begin</span><span class="EOL">
</span>    <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <a href="#local_tag_name_105"><span class="LIDENT">tag_name</span></a> <a href="#local_state_104"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tag_stack</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_state_104"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_open_tag</span> <a href="#local_tag_name_105"><span class="LIDENT">tag_name</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_104"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_tags</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_token_106"><span class="LIDENT">token</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_open_tag</span> <a href="#local_tag_name_105"><span class="LIDENT">tag_name</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pp_enqueue</span> <a href="#local_state_104"><span class="LIDENT">state</span></a> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <a href="#local_token_106"><span class="LIDENT">token</span></a><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Close a tag, popping it from the tag stack. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_close_stag"><span class="LIDENT">pp_close_stag</span></span> <span id="local_state_107"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_107"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_tags</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">pp_enqueue</span> <a href="#local_state_107"><span class="LIDENT">state</span></a> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_close_tag</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_107"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_tags</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="stack.ml.html#val-pop_opt"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">pop_opt</span></a> <a href="#local_state_107"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tag_stack</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COMMENT">(* No more tag to close. *)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_tag_name_108"><span class="LIDENT">tag_name</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_state_107"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_close_tag</span> <a href="#local_tag_name_108"><span class="LIDENT">tag_name</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_print_tags"><span class="LIDENT">pp_set_print_tags</span></span> <span id="local_state_109"><span class="LIDENT">state</span></span> <span id="local_b_110"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_state_109"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_tags</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_b_110"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_mark_tags"><span class="LIDENT">pp_set_mark_tags</span></span> <span id="local_state_111"><span class="LIDENT">state</span></span> <span id="local_b_112"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_state_111"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_tags</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_b_112"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_print_tags"><span class="LIDENT">pp_get_print_tags</span></span> <span id="local_state_113"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_113"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_tags</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_mark_tags"><span class="LIDENT">pp_get_mark_tags</span></span> <span id="local_state_114"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_114"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_tags</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_tags"><span class="LIDENT">pp_set_tags</span></span> <span id="local_state_115"><span class="LIDENT">state</span></span> <span id="local_b_116"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_print_tags</span> <a href="#local_state_115"><span class="LIDENT">state</span></a> <a href="#local_b_116"><span class="LIDENT">b</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_set_mark_tags</span> <a href="#local_state_115"><span class="LIDENT">state</span></a> <a href="#local_b_116"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Handling tag handling functions: get/set functions. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_formatter_stag_functions"><span class="LIDENT">pp_get_formatter_stag_functions</span></span> <span id="local_state_117"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span class="LIDENT">mark_open_stag</span> <span class="EQUAL">=</span> <a href="#local_state_117"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_open_tag</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">mark_close_stag</span> <span class="EQUAL">=</span> <a href="#local_state_117"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_close_tag</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">print_open_stag</span> <span class="EQUAL">=</span> <a href="#local_state_117"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_open_tag</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">print_close_stag</span> <span class="EQUAL">=</span> <a href="#local_state_117"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_close_tag</span><span class="SEMI">;</span><span class="EOL">
</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_formatter_stag_functions"><span class="LIDENT">pp_set_formatter_stag_functions</span></span> <span id="local_state_118"><span class="LIDENT">state</span></span> <span class="LBRACE">{</span><span class="EOL">
</span>     <span class="LIDENT">mark_open_stag</span> <span class="EQUAL">=</span> <span id="local_mot_119"><span class="LIDENT">mot</span></span><span class="SEMI">;</span><span class="EOL">
</span>     <span class="LIDENT">mark_close_stag</span> <span class="EQUAL">=</span> <span id="local_mct_120"><span class="LIDENT">mct</span></span><span class="SEMI">;</span><span class="EOL">
</span>     <span class="LIDENT">print_open_stag</span> <span class="EQUAL">=</span> <span id="local_pot_121"><span class="LIDENT">pot</span></span><span class="SEMI">;</span><span class="EOL">
</span>     <span class="LIDENT">print_close_stag</span> <span class="EQUAL">=</span> <span id="local_pct_122"><span class="LIDENT">pct</span></span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_118"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_open_tag</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_mot_119"><span class="LIDENT">mot</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_118"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_close_tag</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_mct_120"><span class="LIDENT">mct</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_118"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_open_tag</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pot_121"><span class="LIDENT">pot</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_118"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_print_close_tag</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pct_122"><span class="LIDENT">pct</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Initialize pretty-printer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_rinit"><span class="LIDENT">pp_rinit</span></span> <span id="local_state_123"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_clear_queue</span> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">initialize_scan_stack</span> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_scan_stack</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stack.ml.html#val-clear"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_format_stack</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stack.ml.html#val-clear"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tbox_stack</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stack.ml.html#val-clear"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tag_stack</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stack.ml.html#val-clear"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_mark_stack</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_current_indent</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_space_left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_open_sys_box</span> <a href="#local_state_123"><span class="LIDENT">state</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-clear_tag_stack"><span class="LIDENT">clear_tag_stack</span></span> <span id="local_state_124"><span class="LIDENT">state</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="stack.ml.html#val-iter"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_close_stag</span> <a href="#local_state_124"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_state_124"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_tag_stack</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Flushing pretty-printer queue. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_flush_queue"><span class="LIDENT">pp_flush_queue</span></span> <span id="local_state_125"><span class="LIDENT">state</span></span> <span class="TILDE">~</span><span id="local_end_with_newline_126"><span class="LIDENT">end_with_newline</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">clear_tag_stack</span> <a href="#local_state_125"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="#local_state_125"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LIDENT">pp_close_box</span> <a href="#local_state_125"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_125"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">pp_infinity</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">advance_left</span> <a href="#local_state_125"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_end_with_newline_126"><span class="LIDENT">end_with_newline</span></a> <span class="THEN">then</span> <span class="LIDENT">pp_output_newline</span> <a href="#local_state_125"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_rinit</span> <a href="#local_state_125"><span class="LIDENT">state</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  Procedures to format values and use boxes.

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a string. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_as_size"><span class="LIDENT">pp_print_as_size</span></span> <span id="local_state_127"><span class="LIDENT">state</span></span> <span id="local_size_128"><span class="LIDENT">size</span></span> <span id="local_s_129"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_127"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_127"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">enqueue_string_as</span> <a href="#local_state_127"><span class="LIDENT">state</span></a> <a href="#local_size_128"><span class="LIDENT">size</span></a> <a href="#local_s_129"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_as"><span class="LIDENT">pp_print_as</span></span> <span id="local_state_130"><span class="LIDENT">state</span></span> <span id="local_isize_131"><span class="LIDENT">isize</span></span> <span id="local_s_132"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_as_size</span> <a href="#local_state_130"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <a href="#local_isize_131"><span class="LIDENT">isize</span></a><span class="RPAREN">)</span> <a href="#local_s_132"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_string"><span class="LIDENT">pp_print_string</span></span> <span id="local_state_133"><span class="LIDENT">state</span></span> <span id="local_s_134"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_as</span> <a href="#local_state_133"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_134"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_s_134"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_bytes"><span class="LIDENT">pp_print_bytes</span></span> <span id="local_state_135"><span class="LIDENT">state</span></span> <span id="local_s_136"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_as</span> <a href="#local_state_135"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="bytes.ml.html#val-length"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_136"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="bytes.ml.html#val-to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_s_136"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format an integer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_int"><span class="LIDENT">pp_print_int</span></span> <span id="local_state_137"><span class="LIDENT">state</span></span> <span id="local_i_138"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_string</span> <a href="#local_state_137"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="int.ml.html#val-to_string"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_i_138"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a float. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_float"><span class="LIDENT">pp_print_float</span></span> <span id="local_state_139"><span class="LIDENT">state</span></span> <span id="local_f_140"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_string</span> <a href="#local_state_139"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-string_of_float"><span class="LIDENT">string_of_float</span></a> <a href="#local_f_140"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a boolean. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_bool"><span class="LIDENT">pp_print_bool</span></span> <span id="local_state_141"><span class="LIDENT">state</span></span> <span id="local_b_142"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_string</span> <a href="#local_state_141"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-string_of_bool"><span class="LIDENT">string_of_bool</span></a> <a href="#local_b_142"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a char. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_char"><span class="LIDENT">pp_print_char</span></span> <span id="local_state_143"><span class="LIDENT">state</span></span> <span id="local_c_144"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_as</span> <a href="#local_state_143"><span class="LIDENT">state</span></a> <span class="INT">1</span> <span class="LPAREN">(</span><a href="string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">1</span> <a href="#local_c_144"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_nothing"><span class="LIDENT">pp_print_nothing</span></span> <span id="local__state_145"><span class="LIDENT">_state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Opening boxes. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_open_hbox"><span class="LIDENT">pp_open_hbox</span></span> <span id="local_state_146"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box_gen</span> <a href="#local_state_146"><span class="LIDENT">state</span></a> <span class="INT">0</span> <span class="UIDENT">Pp_hbox</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_open_vbox"><span class="LIDENT">pp_open_vbox</span></span> <span id="local_state_147"><span class="LIDENT">state</span></span> <span id="local_indent_148"><span class="LIDENT">indent</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box_gen</span> <a href="#local_state_147"><span class="LIDENT">state</span></a> <a href="#local_indent_148"><span class="LIDENT">indent</span></a> <span class="UIDENT">Pp_vbox</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_open_hvbox"><span class="LIDENT">pp_open_hvbox</span></span> <span id="local_state_149"><span class="LIDENT">state</span></span> <span id="local_indent_150"><span class="LIDENT">indent</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box_gen</span> <a href="#local_state_149"><span class="LIDENT">state</span></a> <a href="#local_indent_150"><span class="LIDENT">indent</span></a> <span class="UIDENT">Pp_hvbox</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_open_hovbox"><span class="LIDENT">pp_open_hovbox</span></span> <span id="local_state_151"><span class="LIDENT">state</span></span> <span id="local_indent_152"><span class="LIDENT">indent</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box_gen</span> <a href="#local_state_151"><span class="LIDENT">state</span></a> <a href="#local_indent_152"><span class="LIDENT">indent</span></a> <span class="UIDENT">Pp_hovbox</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_open_box"><span class="LIDENT">pp_open_box</span></span> <span id="local_state_153"><span class="LIDENT">state</span></span> <span id="local_indent_154"><span class="LIDENT">indent</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box_gen</span> <a href="#local_state_153"><span class="LIDENT">state</span></a> <a href="#local_indent_154"><span class="LIDENT">indent</span></a> <span class="UIDENT">Pp_box</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Printing queued text.

   [pp_print_flush] prints all pending items in the pretty-printer queue and
   then flushes the low level output device of the formatter to actually
   display printing material.

   [pp_print_newline] behaves as [pp_print_flush] after printing an additional
   new line. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_newline"><span class="LIDENT">pp_print_newline</span></span> <span id="local_state_155"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_flush_queue</span> <a href="#local_state_155"><span class="LIDENT">state</span></a> <span class="LABEL">~end_with_newline:</span><span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_state_155"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_print_flush"><span class="LIDENT">pp_print_flush</span></span> <span id="local_state_156"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_flush_queue</span> <a href="#local_state_156"><span class="LIDENT">state</span></a> <span class="LABEL">~end_with_newline:</span><span class="FALSE">false</span><span class="SEMI">;</span> <a href="#local_state_156"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To get a newline when one does not want to close the current box. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_force_newline"><span class="LIDENT">pp_force_newline</span></span> <span id="local_state_157"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_157"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_157"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">enqueue_advance</span> <a href="#local_state_157"><span class="LIDENT">state</span></a> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_newline</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format something, only in case the line has just been broken. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_if_newline"><span class="LIDENT">pp_print_if_newline</span></span> <span id="local_state_158"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_158"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_158"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">enqueue_advance</span> <a href="#local_state_158"><span class="LIDENT">state</span></a><span class="EOL">
</span>      <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_if_newline</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Generalized break hint that allows printing strings before/after
   same-line offset (width) or new-line offset *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_custom_break"><span class="LIDENT">pp_print_custom_break</span></span> <span id="local_state_159"><span class="LIDENT">state</span></span> <span class="TILDE">~</span><span id="local_fits_160"><span class="LIDENT">fits</span></span> <span class="TILDE">~</span><span id="local_breaks_161"><span class="LIDENT">breaks</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_528"><span id="local_before_162"><span class="LIDENT">before</span></span><span class="COMMA">,</span> <span id="local_width_163"><span class="LIDENT">width</span></span><span class="COMMA">,</span> <span id="local_after_164"><span class="LIDENT">after</span></span></span> <span class="EQUAL">=</span> <a href="#local_fits_160"><span class="LIDENT">fits</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_159"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_159"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_size_165"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a> <a href="#local_state_159"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_token_166"><span class="LIDENT">token</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_break</span> <span class="LBRACE">{</span> <a href="#local_fits_160"><span class="LIDENT">fits</span></a><span class="SEMI">;</span> <a href="#local_breaks_161"><span class="LIDENT">breaks</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_length_167"><span class="LIDENT">length</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_before_162"><span class="LIDENT">before</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_width_163"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_after_164"><span class="LIDENT">after</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elem_168"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_size_165"><span class="LIDENT">size</span></a><span class="SEMI">;</span> <a href="#local_token_166"><span class="LIDENT">token</span></a><span class="SEMI">;</span> <a href="#local_length_167"><span class="LIDENT">length</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_push</span> <a href="#local_state_159"><span class="LIDENT">state</span></a> <span class="TRUE">true</span> <a href="#local_elem_168"><span class="LIDENT">elem</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Printing break hints:
   A break hint indicates where a box may be broken.
   If line is broken then offset is added to the indentation of the current
   box else (the value of) width blanks are printed. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_break"><span class="LIDENT">pp_print_break</span></span> <span id="local_state_169"><span class="LIDENT">state</span></span> <span id="local_width_170"><span class="LIDENT">width</span></span> <span id="local_offset_171"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_custom_break</span> <a href="#local_state_169"><span class="LIDENT">state</span></a><span class="EOL">
</span>    <span class="LABEL">~fits:</span><span class="LPAREN">(</span><span class="STRING">&quot;&quot;</span><span class="COMMA">,</span> <a href="#local_width_170"><span class="LIDENT">width</span></a><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span> <span class="LABEL">~breaks:</span><span class="LPAREN">(</span><span class="STRING">&quot;&quot;</span><span class="COMMA">,</span> <a href="#local_offset_171"><span class="LIDENT">offset</span></a><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a space :
   a space is a break hint that prints a single space if the break does not
   split the line;
   a cut is a break hint that prints nothing if the break does not split the
   line. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_space"><span class="LIDENT">pp_print_space</span></span> <span id="local_state_172"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_break</span> <a href="#local_state_172"><span class="LIDENT">state</span></a> <span class="INT">1</span> <span class="INT">0</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_print_cut"><span class="LIDENT">pp_print_cut</span></span> <span id="local_state_173"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_break</span> <a href="#local_state_173"><span class="LIDENT">state</span></a> <span class="INT">0</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Tabulation boxes. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_open_tbox"><span class="LIDENT">pp_open_tbox</span></span> <span id="local_state_174"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_174"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_174"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_174"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_174"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_size_175"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elem_176"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_size_175"><span class="LIDENT">size</span></a><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_tbegin</span> <span class="LPAREN">(</span><span class="UIDENT">Pp_tbox</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">enqueue_advance</span> <a href="#local_state_174"><span class="LIDENT">state</span></a> <a href="#local_elem_176"><span class="LIDENT">elem</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Close a tabulation box. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_close_tbox"><span class="LIDENT">pp_close_tbox</span></span> <span id="local_state_177"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_177"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <span class="THEN">then</span><span class="EOL">
</span>  <span class="BEGIN">begin</span><span class="EOL">
</span>   <span class="IF">if</span> <a href="#local_state_177"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_177"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>     <span class="LET">let</span> <span id="local_elem_178"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_tend</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>     <span class="LIDENT">enqueue_advance</span> <a href="#local_state_177"><span class="LIDENT">state</span></a> <a href="#local_elem_178"><span class="LIDENT">elem</span></a><span class="SEMI">;</span><span class="EOL">
</span>     <a href="#local_state_177"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_177"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a tabulation break. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_tbreak"><span class="LIDENT">pp_print_tbreak</span></span> <span id="local_state_179"><span class="LIDENT">state</span></span> <span id="local_width_180"><span class="LIDENT">width</span></span> <span id="local_offset_181"><span class="LIDENT">offset</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_179"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_179"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_size_182"><span class="LIDENT">size</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a> <a href="#local_state_179"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_right_total</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elem_183"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_size_182"><span class="LIDENT">size</span></a><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_tbreak</span> <span class="LPAREN">(</span><a href="#local_width_180"><span class="LIDENT">width</span></a><span class="COMMA">,</span> <a href="#local_offset_181"><span class="LIDENT">offset</span></a><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <a href="#local_width_180"><span class="LIDENT">width</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">scan_push</span> <a href="#local_state_179"><span class="LIDENT">state</span></a> <span class="TRUE">true</span> <a href="#local_elem_183"><span class="LIDENT">elem</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_tab"><span class="LIDENT">pp_print_tab</span></span> <span id="local_state_184"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_tbreak</span> <a href="#local_state_184"><span class="LIDENT">state</span></a> <span class="INT">0</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_tab"><span class="LIDENT">pp_set_tab</span></span> <span id="local_state_185"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_state_185"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_state_185"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_elem_186"><span class="LIDENT">elem</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">zero</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_stab</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">enqueue_advance</span> <a href="#local_state_185"><span class="LIDENT">state</span></a> <a href="#local_elem_186"><span class="LIDENT">elem</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  Procedures to control the pretty-printers

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Set_max_boxes. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_max_boxes"><span class="LIDENT">pp_set_max_boxes</span></span> <span id="local_state_187"><span class="LIDENT">state</span></span> <span id="local_n_188"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_n_188"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <span class="THEN">then</span> <a href="#local_state_187"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_188"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To know the current maximum number of boxes allowed. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_max_boxes"><span class="LIDENT">pp_get_max_boxes</span></span> <span id="local_state_189"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_189"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_over_max_boxes"><span class="LIDENT">pp_over_max_boxes</span></span> <span id="local_state_190"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_190"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_curr_depth</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_state_190"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_boxes</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Ellipsis. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_ellipsis_text"><span class="LIDENT">pp_set_ellipsis_text</span></span> <span id="local_state_191"><span class="LIDENT">state</span></span> <span id="local_s_192"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="#local_state_191"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_ellipsis</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_s_192"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-pp_get_ellipsis_text"><span class="LIDENT">pp_get_ellipsis_text</span></span> <span id="local_state_193"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_193"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_ellipsis</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To set the margin of pretty-printer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_limit"><span class="LIDENT">pp_limit</span></span> <span id="local_n_194"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_194"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="LIDENT">pp_infinity</span> <span class="THEN">then</span> <a href="#local_n_194"><span class="LIDENT">n</span></a> <span class="ELSE">else</span> <a href="stdlib.ml.html#val-pred"><span class="LIDENT">pred</span></a> <span class="LIDENT">pp_infinity</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Internal pretty-printer functions. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_min_space_left"><span class="LIDENT">pp_set_min_space_left</span></span> <span id="local_state_195"><span class="LIDENT">state</span></span> <span id="local_n_196"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_196"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">1</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n_197"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_limit</span> <a href="#local_n_196"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_state_195"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_min_space_left</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_197"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_state_195"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_indent</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_state_195"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_195"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_min_space_left</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_rinit</span> <a href="#local_state_195"><span class="LIDENT">state</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Initially, we have :
   pp_max_indent = pp_margin - pp_min_space_left, and
   pp_space_left = pp_margin. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_max_indent"><span class="LIDENT">pp_set_max_indent</span></span> <span id="local_state_198"><span class="LIDENT">state</span></span> <span id="local_n_199"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_199"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">pp_set_min_space_left</span> <a href="#local_state_198"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="#local_state_198"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_n_199"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_max_indent"><span class="LIDENT">pp_get_max_indent</span></span> <span id="local_state_200"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_200"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_indent</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_margin"><span class="LIDENT">pp_set_margin</span></span> <span id="local_state_201"><span class="LIDENT">state</span></span> <span id="local_n_202"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_202"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">1</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_n_203"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_limit</span> <a href="#local_n_202"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_n_203"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_max_indent_204"><span class="LIDENT">new_max_indent</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* Try to maintain max_indent to its actual value. *)</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_indent</span> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span><span class="EOL">
</span>      <span class="THEN">then</span> <a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_max_indent</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="COMMENT">(* If possible maintain pp_min_space_left to its actual value,
         if this leads to a too small max_indent, take half of the
         new margin, if it is greater than 1. *)</span><span class="EOL">
</span>       <a href="int.ml.html#val-max"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">max</span></a> <span class="LPAREN">(</span><a href="int.ml.html#val-max"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">max</span></a> <span class="LPAREN">(</span><a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_min_space_left</span><span class="RPAREN">)</span><span class="EOL">
</span>                <span class="LPAREN">(</span><a href="#local_state_201"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span> <a href="stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* Rebuild invariants. *)</span><span class="EOL">
</span>    <span class="LIDENT">pp_set_max_indent</span> <a href="#local_state_201"><span class="LIDENT">state</span></a> <a href="#local_new_max_indent_204"><span class="LIDENT">new_max_indent</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** Geometry functions and types *)</span><span class="EOL">
</span><span id="type-geometry"><span class="TYPE">type</span> <span class="LIDENT">geometry</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span id="def_541"><span class="LIDENT">max_indent</span><span class="COLON">:</span><span class="LIDENT">int</span><span class="SEMI">;</span></span> <span id="def_562"><span class="LIDENT">margin</span><span class="COLON">:</span> <span class="LIDENT">int</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-validate_geometry"><span class="LIDENT">validate_geometry</span></span> <span class="LBRACE">{</span><span id="local_margin_206"><span class="LIDENT">margin</span></span><span class="SEMI">;</span> <span id="local_max_indent_205"><span class="LIDENT">max_indent</span></span><span class="RBRACE">}</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_max_indent_205"><span class="LIDENT">max_indent</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">2</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="UIDENT">Error</span> <span class="STRING">&quot;max_indent &lt; 2&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_margin_206"><span class="LIDENT">margin</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_max_indent_205"><span class="LIDENT">max_indent</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <span class="UIDENT">Error</span> <span class="STRING">&quot;margin &lt;= max_indent&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_margin_206"><span class="LIDENT">margin</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">pp_infinity</span> <span class="THEN">then</span><span class="EOL">
</span>    <span class="UIDENT">Error</span> <span class="STRING">&quot;margin &gt;= pp_infinity&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-check_geometry"><span class="LIDENT">check_geometry</span></span> <span id="local_geometry_207"><span class="LIDENT">geometry</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">validate_geometry</span> <a href="#local_geometry_207"><span class="LIDENT">geometry</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Error</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_margin"><span class="LIDENT">pp_get_margin</span></span> <span id="local_state_208"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_208"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_margin</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_full_geometry"><span class="LIDENT">pp_set_full_geometry</span></span> <span id="local_state_209"><span class="LIDENT">state</span></span> <span class="LBRACE">{</span><span id="local_margin_211"><span class="LIDENT">margin</span></span><span class="SEMI">;</span> <span id="local_max_indent_210"><span class="LIDENT">max_indent</span></span><span class="RBRACE">}</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_margin</span> <a href="#local_state_209"><span class="LIDENT">state</span></a> <a href="#local_margin_211"><span class="LIDENT">margin</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_max_indent</span> <a href="#local_state_209"><span class="LIDENT">state</span></a> <a href="#local_max_indent_210"><span class="LIDENT">max_indent</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_geometry"><span class="LIDENT">pp_set_geometry</span></span> <span id="local_state_212"><span class="LIDENT">state</span></span> <span class="TILDE">~</span><span id="local_max_indent_213"><span class="LIDENT">max_indent</span></span> <span class="TILDE">~</span><span id="local_margin_214"><span class="LIDENT">margin</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_geometry_215"><span class="LIDENT">geometry</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_max_indent_213"><span class="LIDENT">max_indent</span></a><span class="SEMI">;</span> <a href="#local_margin_214"><span class="LIDENT">margin</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">validate_geometry</span> <a href="#local_geometry_215"><span class="LIDENT">geometry</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_msg_216"><span class="LIDENT">msg</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="LPAREN">(</span><span class="UIDENT">Invalid_argument</span> <span class="LPAREN">(</span><span class="STRING">&quot;Format.pp_set_geometry: &quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_msg_216"><span class="LIDENT">msg</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">pp_set_full_geometry</span> <a href="#local_state_212"><span class="LIDENT">state</span></a> <a href="#local_geometry_215"><span class="LIDENT">geometry</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_safe_set_geometry"><span class="LIDENT">pp_safe_set_geometry</span></span> <span id="local_state_217"><span class="LIDENT">state</span></span> <span class="TILDE">~</span><span id="local_max_indent_218"><span class="LIDENT">max_indent</span></span> <span class="TILDE">~</span><span id="local_margin_219"><span class="LIDENT">margin</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_geometry_220"><span class="LIDENT">geometry</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_max_indent_218"><span class="LIDENT">max_indent</span></a><span class="SEMI">;</span> <a href="#local_margin_219"><span class="LIDENT">margin</span></a> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <span class="LIDENT">validate_geometry</span> <a href="#local_geometry_220"><span class="LIDENT">geometry</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local__msg_221"><span class="LIDENT">_msg</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ok</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">pp_set_full_geometry</span> <a href="#local_state_217"><span class="LIDENT">state</span></a> <a href="#local_geometry_220"><span class="LIDENT">geometry</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_geometry"><span class="LIDENT">pp_get_geometry</span></span> <span id="local_state_222"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span class="LIDENT">margin</span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_margin</span> <a href="#local_state_222"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">max_indent</span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_max_indent</span> <a href="#local_state_222"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_update_geometry"><span class="LIDENT">pp_update_geometry</span></span> <span id="local_state_223"><span class="LIDENT">state</span></span> <span id="local_update_224"><span class="LIDENT">update</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_geometry_225"><span class="LIDENT">geometry</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_geometry</span> <a href="#local_state_223"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_full_geometry</span> <a href="#local_state_223"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="#local_update_224"><span class="LIDENT">update</span></a> <a href="#local_geometry_225"><span class="LIDENT">geometry</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Setting a formatter basic output functions. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_formatter_out_functions"><span class="LIDENT">pp_set_formatter_out_functions</span></span> <span id="local_state_226"><span class="LIDENT">state</span></span> <span class="LBRACE">{</span><span class="EOL">
</span>      <span class="LIDENT">out_string</span> <span class="EQUAL">=</span> <span id="local_f_227"><span class="LIDENT">f</span></span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">out_flush</span> <span class="EQUAL">=</span> <span id="local_g_228"><span class="LIDENT">g</span></span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">out_newline</span> <span class="EQUAL">=</span> <span id="local_h_229"><span class="LIDENT">h</span></span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">out_spaces</span> <span class="EQUAL">=</span> <span id="local_i_230"><span class="LIDENT">i</span></span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">out_indent</span> <span class="EQUAL">=</span> <span id="local_j_231"><span class="LIDENT">j</span></span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="RBRACE">}</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_226"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_f_227"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_226"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_g_228"><span class="LIDENT">g</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_226"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_h_229"><span class="LIDENT">h</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_226"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_i_230"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_226"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_j_231"><span class="LIDENT">j</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_formatter_out_functions"><span class="LIDENT">pp_get_formatter_out_functions</span></span> <span id="local_state_232"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span class="LIDENT">out_string</span> <span class="EQUAL">=</span> <a href="#local_state_232"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">out_flush</span> <span class="EQUAL">=</span> <a href="#local_state_232"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">out_newline</span> <span class="EQUAL">=</span> <a href="#local_state_232"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">out_spaces</span> <span class="EQUAL">=</span> <a href="#local_state_232"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">out_indent</span> <span class="EQUAL">=</span> <a href="#local_state_232"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span><span class="SEMI">;</span><span class="EOL">
</span><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Setting a formatter basic string output and flush functions. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_formatter_output_functions"><span class="LIDENT">pp_set_formatter_output_functions</span></span> <span id="local_state_233"><span class="LIDENT">state</span></span> <span id="local_f_234"><span class="LIDENT">f</span></span> <span id="local_g_235"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_233"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_f_234"><span class="LIDENT">f</span></a><span class="SEMI">;</span> <a href="#local_state_233"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_g_235"><span class="LIDENT">g</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_get_formatter_output_functions"><span class="LIDENT">pp_get_formatter_output_functions</span></span> <span id="local_state_236"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><a href="#local_state_236"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span><span class="COMMA">,</span> <a href="#local_state_236"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The default function to output new lines. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-display_newline"><span class="LIDENT">display_newline</span></span> <span id="local_state_237"><span class="LIDENT">state</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_state_237"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <span class="STRING">&quot;\n&quot;</span> <span class="INT">0</span>  <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The default function to output spaces. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-blank_line"><span class="LIDENT">blank_line</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">80</span> <span class="CHAR">' '</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-display_blanks"><span class="LIDENT">display_blanks</span></span> <span id="local_state_238"><span class="LIDENT">state</span></span> <span id="local_n_239"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_239"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_239"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">80</span> <span class="THEN">then</span> <a href="#local_state_238"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <span class="LIDENT">blank_line</span> <span class="INT">0</span> <a href="#local_n_239"><span class="LIDENT">n</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="BEGIN">begin</span><span class="EOL">
</span>    <a href="#local_state_238"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <span class="LIDENT">blank_line</span> <span class="INT">0</span> <span class="INT">80</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">display_blanks</span> <a href="#local_state_238"><span class="LIDENT">state</span></a> <span class="LPAREN">(</span><a href="#local_n_239"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">80</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The default function to output indentation of new lines. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-display_indent"><span class="LIDENT">display_indent</span></span> <span class="EQUAL">=</span> <span class="LIDENT">display_blanks</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Setting a formatter basic output functions as printing to a given
   [Stdlib.out_channel] value. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_set_formatter_out_channel"><span class="LIDENT">pp_set_formatter_out_channel</span></span> <span id="local_state_240"><span class="LIDENT">state</span></span> <span id="local_oc_241"><span class="LIDENT">oc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_string</span> <span class="LESSMINUS">&lt;-</span> <a href="stdlib.ml.html#val-output_substring"><span class="LIDENT">output_substring</span></a> <a href="#local_oc_241"><span class="LIDENT">oc</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_flush</span> <span class="LESSMINUS">&lt;-</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-flush"><span class="LIDENT">flush</span></a> <a href="#local_oc_241"><span class="LIDENT">oc</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_newline</span> <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_blanks</span> <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_indent</span> <a href="#local_state_240"><span class="LIDENT">state</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  Defining specific formatters

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-default_pp_mark_open_tag"><span class="LIDENT">default_pp_mark_open_tag</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_tag</span> <span id="local_s_242"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;&lt;&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_s_242"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;&gt;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;&quot;</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-default_pp_mark_close_tag"><span class="LIDENT">default_pp_mark_close_tag</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_tag</span> <span id="local_s_243"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;&lt;/&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <a href="#local_s_243"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;&gt;&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-default_pp_print_open_tag"><span class="LIDENT">default_pp_print_open_tag</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-default_pp_print_close_tag"><span class="LIDENT">default_pp_print_close_tag</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Building a formatter given its basic output functions.
   Other fields get reasonable default values. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_make_formatter"><span class="LIDENT">pp_make_formatter</span></span> <span id="local_f_244"><span class="LIDENT">f</span></span> <span id="local_g_245"><span class="LIDENT">g</span></span> <span id="local_h_246"><span class="LIDENT">h</span></span> <span id="local_i_247"><span class="LIDENT">i</span></span> <span id="local_j_248"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* The initial state of the formatter contains a dummy box. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pp_queue_249"><span class="LIDENT">pp_queue</span></span> <span class="EQUAL">=</span> <a href="queue.ml.html#val-create"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sys_tok_250"><span class="LIDENT">sys_tok</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span class="LIDENT">size</span> <span class="EQUAL">=</span> <span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">unknown</span><span class="SEMI">;</span> <span class="LIDENT">token</span> <span class="EQUAL">=</span> <span class="UIDENT">Pp_begin</span> <span class="LPAREN">(</span><span class="INT">0</span><span class="COMMA">,</span> <span class="UIDENT">Pp_hovbox</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="RBRACE">}</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="queue.ml.html#val-add"><span class="UIDENT">Queue</span><span class="DOT">.</span><span class="LIDENT">add</span></a> <a href="#local_sys_tok_250"><span class="LIDENT">sys_tok</span></a> <a href="#local_pp_queue_249"><span class="LIDENT">pp_queue</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_scan_stack_251"><span class="LIDENT">scan_stack</span></span> <span class="EQUAL">=</span> <a href="stack.ml.html#val-create"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">initialize_scan_stack</span> <a href="#local_scan_stack_251"><span class="LIDENT">scan_stack</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stack.ml.html#val-push"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">push</span></a> <span class="LBRACE">{</span> <span class="LIDENT">left_total</span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="SEMI">;</span> <span class="LIDENT">queue_elem</span> <span class="EQUAL">=</span> <a href="#local_sys_tok_250"><span class="LIDENT">sys_tok</span></a> <span class="RBRACE">}</span> <a href="#local_scan_stack_251"><span class="LIDENT">scan_stack</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pp_margin_252"><span class="LIDENT">pp_margin</span></span> <span class="EQUAL">=</span> <span class="INT">78</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_pp_min_space_left_253"><span class="LIDENT">pp_min_space_left</span></span> <span class="EQUAL">=</span> <span class="INT">10</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <span class="LIDENT">pp_scan_stack</span> <span class="EQUAL">=</span> <a href="#local_scan_stack_251"><span class="LIDENT">scan_stack</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_format_stack</span> <span class="EQUAL">=</span> <a href="stack.ml.html#val-create"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_tbox_stack</span> <span class="EQUAL">=</span> <a href="stack.ml.html#val-create"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_tag_stack</span> <span class="EQUAL">=</span> <a href="stack.ml.html#val-create"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_mark_stack</span> <span class="EQUAL">=</span> <a href="stack.ml.html#val-create"><span class="UIDENT">Stack</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_margin</span> <span class="EQUAL">=</span> <a href="#local_pp_margin_252"><span class="LIDENT">pp_margin</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_min_space_left</span> <span class="EQUAL">=</span> <a href="#local_pp_min_space_left_253"><span class="LIDENT">pp_min_space_left</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_max_indent</span> <span class="EQUAL">=</span> <a href="#local_pp_margin_252"><span class="LIDENT">pp_margin</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pp_min_space_left_253"><span class="LIDENT">pp_min_space_left</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_space_left</span> <span class="EQUAL">=</span> <a href="#local_pp_margin_252"><span class="LIDENT">pp_margin</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_current_indent</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_is_new_line</span> <span class="EQUAL">=</span> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_left_total</span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_right_total</span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_curr_depth</span> <span class="EQUAL">=</span> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_max_boxes</span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-max_int"><span class="LIDENT">max_int</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_ellipsis</span> <span class="EQUAL">=</span> <span class="STRING">&quot;.&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_out_string</span> <span class="EQUAL">=</span> <a href="#local_f_244"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_out_flush</span> <span class="EQUAL">=</span> <a href="#local_g_245"><span class="LIDENT">g</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_out_newline</span> <span class="EQUAL">=</span> <a href="#local_h_246"><span class="LIDENT">h</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_out_spaces</span> <span class="EQUAL">=</span> <a href="#local_i_247"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_out_indent</span> <span class="EQUAL">=</span> <a href="#local_j_248"><span class="LIDENT">j</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_tags</span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_mark_tags</span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_mark_open_tag</span> <span class="EQUAL">=</span> <span class="LIDENT">default_pp_mark_open_tag</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_mark_close_tag</span> <span class="EQUAL">=</span> <span class="LIDENT">default_pp_mark_close_tag</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_open_tag</span> <span class="EQUAL">=</span> <span class="LIDENT">default_pp_print_open_tag</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_close_tag</span> <span class="EQUAL">=</span> <span class="LIDENT">default_pp_print_close_tag</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_queue</span> <span class="EQUAL">=</span> <a href="#local_pp_queue_249"><span class="LIDENT">pp_queue</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Build a formatter out of its out functions. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-formatter_of_out_functions"><span class="LIDENT">formatter_of_out_functions</span></span> <span id="local_out_funs_254"><span class="LIDENT">out_funs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_make_formatter</span><span class="EOL">
</span>    <a href="#local_out_funs_254"><span class="LIDENT">out_funs</span></a><span class="DOT">.</span><span class="LIDENT">out_string</span><span class="EOL">
</span>    <a href="#local_out_funs_254"><span class="LIDENT">out_funs</span></a><span class="DOT">.</span><span class="LIDENT">out_flush</span><span class="EOL">
</span>    <a href="#local_out_funs_254"><span class="LIDENT">out_funs</span></a><span class="DOT">.</span><span class="LIDENT">out_newline</span><span class="EOL">
</span>    <a href="#local_out_funs_254"><span class="LIDENT">out_funs</span></a><span class="DOT">.</span><span class="LIDENT">out_spaces</span><span class="EOL">
</span>    <a href="#local_out_funs_254"><span class="LIDENT">out_funs</span></a><span class="DOT">.</span><span class="LIDENT">out_indent</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Make a formatter with default functions to output spaces,
  indentation, and new lines. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_formatter"><span class="LIDENT">make_formatter</span></span> <span id="local_output_255"><span class="LIDENT">output</span></span> <span id="local_flush_256"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ppf_257"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_make_formatter</span> <a href="#local_output_255"><span class="LIDENT">output</span></a> <a href="#local_flush_256"><span class="LIDENT">flush</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_newline</span> <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_blanks</span> <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_indent</span> <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_257"><span class="LIDENT">ppf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Make a formatter writing to a given [Stdlib.out_channel] value. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-formatter_of_out_channel"><span class="LIDENT">formatter_of_out_channel</span></span> <span id="local_oc_258"><span class="LIDENT">oc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">make_formatter</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-output_substring"><span class="LIDENT">output_substring</span></a> <a href="#local_oc_258"><span class="LIDENT">oc</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-flush"><span class="LIDENT">flush</span></a> <a href="#local_oc_258"><span class="LIDENT">oc</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Make a formatter writing to a given [Buffer.t] value. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-formatter_of_buffer"><span class="LIDENT">formatter_of_buffer</span></span> <span id="local_b_259"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">make_formatter</span> <span class="LPAREN">(</span><a href="buffer.ml.html#val-add_substring"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_substring</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Allocating buffer for pretty-printing purposes.
   Default buffer size is pp_buffer_size or 512.
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_buffer_size"><span class="LIDENT">pp_buffer_size</span></span> <span class="EQUAL">=</span> <span class="INT">512</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_make_buffer"><span class="LIDENT">pp_make_buffer</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LIDENT">pp_buffer_size</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The standard (shared) buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-stdbuf"><span class="LIDENT">stdbuf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_make_buffer</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Predefined formatters standard formatter to print
   to [Stdlib.stdout], [Stdlib.stderr], and {!stdbuf}. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-std_formatter"><span class="LIDENT">std_formatter</span></span> <span class="EQUAL">=</span> <span class="LIDENT">formatter_of_out_channel</span> <a href="stdlib.ml.html#val-stdout"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stdout</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-err_formatter"><span class="LIDENT">err_formatter</span></span> <span class="EQUAL">=</span> <span class="LIDENT">formatter_of_out_channel</span> <a href="stdlib.ml.html#val-stderr"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stderr</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-str_formatter"><span class="LIDENT">str_formatter</span></span> <span class="EQUAL">=</span> <span class="LIDENT">formatter_of_buffer</span> <span class="LIDENT">stdbuf</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Initialise domain local state *)</span><span class="EOL">
</span><span id="module-DLS"><span class="MODULE">module</span> <span class="UIDENT">DLS</span> <span class="EQUAL">=</span> <a href="domain.ml.html#module-DLS"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="UIDENT">DLS</span></a></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-stdbuf_key"><span class="LIDENT">stdbuf_key</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span> <span class="LIDENT">pp_make_buffer</span><span class="EOL">
</span><span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">set</span> <span class="LIDENT">stdbuf_key</span> <span class="LIDENT">stdbuf</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-str_formatter_key"><span class="LIDENT">str_formatter_key</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LIDENT">formatter_of_buffer</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">stdbuf_key</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">set</span> <span class="LIDENT">str_formatter_key</span> <span class="LIDENT">str_formatter</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffered_out_string"><span class="LIDENT">buffered_out_string</span></span> <span id="local_key_260"><span class="LIDENT">key</span></span> <span id="local_str_261"><span class="LIDENT">str</span></span> <span id="local_ofs_262"><span class="LIDENT">ofs</span></span> <span id="local_len_263"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="buffer.ml.html#val-add_substring"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_substring</span></a> <span class="LPAREN">(</span><a href="domain.ml.html#module-DLS.val-get"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_key_260"><span class="LIDENT">key</span></a><span class="RPAREN">)</span> <a href="#local_str_261"><span class="LIDENT">str</span></a> <a href="#local_ofs_262"><span class="LIDENT">ofs</span></a> <a href="#local_len_263"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffered_out_flush"><span class="LIDENT">buffered_out_flush</span></span> <span id="local_oc_264"><span class="LIDENT">oc</span></span> <span id="local_key_265"><span class="LIDENT">key</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_266"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="domain.ml.html#module-DLS.val-get"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_key_265"><span class="LIDENT">key</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_267"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-length"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_buf_266"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_268"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_buf_266"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-output_substring"><span class="LIDENT">output_substring</span></a> <a href="#local_oc_264"><span class="LIDENT">oc</span></a> <a href="#local_str_268"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_len_267"><span class="LIDENT">len</span></a> <span class="SEMI">;</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-flush"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">flush</span></a> <a href="#local_oc_264"><span class="LIDENT">oc</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="buffer.ml.html#val-clear"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_buf_266"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-std_buf_key"><span class="LIDENT">std_buf_key</span></span> <span class="EQUAL">=</span> <a href="domain.ml.html#module-DLS.val-new_key"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LIDENT">pp_buffer_size</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-err_buf_key"><span class="LIDENT">err_buf_key</span></span> <span class="EQUAL">=</span> <a href="domain.ml.html#module-DLS.val-new_key"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LIDENT">pp_buffer_size</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-std_formatter_key"><span class="LIDENT">std_formatter_key</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ppf_269"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">pp_make_formatter</span> <span class="LPAREN">(</span><span class="LIDENT">buffered_out_string</span> <span class="LIDENT">std_buf_key</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">buffered_out_flush</span> <a href="stdlib.ml.html#val-stdout"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stdout</span></a> <span class="LIDENT">std_buf_key</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_newline</span> <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_blanks</span> <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_indent</span> <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="domain.ml.html#val-at_exit"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="LIDENT">at_exit</span></a> <span class="LPAREN">(</span><span class="LIDENT">pp_print_flush</span> <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_269"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">set</span> <span class="LIDENT">std_formatter_key</span> <span class="LIDENT">std_formatter</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-err_formatter_key"><span class="LIDENT">err_formatter_key</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ppf_270"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">pp_make_formatter</span> <span class="LPAREN">(</span><span class="LIDENT">buffered_out_string</span> <span class="LIDENT">err_buf_key</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">buffered_out_flush</span> <a href="stdlib.ml.html#val-stderr"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stderr</span></a> <span class="LIDENT">err_buf_key</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_newline</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_newline</span> <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_spaces</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_blanks</span> <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="DOT">.</span><span class="LIDENT">pp_out_indent</span> <span class="LESSMINUS">&lt;-</span> <span class="LIDENT">display_indent</span> <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="domain.ml.html#val-at_exit"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="LIDENT">at_exit</span></a> <span class="LPAREN">(</span><span class="LIDENT">pp_print_flush</span> <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_ppf_270"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">set</span> <span class="LIDENT">err_formatter_key</span> <span class="LIDENT">err_formatter</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_std_formatter"><span class="LIDENT">get_std_formatter</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_err_formatter"><span class="LIDENT">get_err_formatter</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">err_formatter_key</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_str_formatter"><span class="LIDENT">get_str_formatter</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">str_formatter_key</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_stdbuf"><span class="LIDENT">get_stdbuf</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">stdbuf_key</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* [flush_buffer_formatter buf ppf] flushes formatter [ppf],
   then returns the contents of buffer [buf] that is reset.
   Formatter [ppf] is supposed to print to buffer [buf], otherwise this
   function is not really useful. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-flush_buffer_formatter"><span class="LIDENT">flush_buffer_formatter</span></span> <span id="local_buf_271"><span class="LIDENT">buf</span></span> <span id="local_ppf_272"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_flush_queue</span> <a href="#local_ppf_272"><span class="LIDENT">ppf</span></a> <span class="LABEL">~end_with_newline:</span><span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_s_273"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_buf_271"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="buffer.ml.html#val-reset"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">reset</span></a> <a href="#local_buf_271"><span class="LIDENT">buf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_s_273"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Flush [str_formatter] and get the contents of [stdbuf]. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-flush_str_formatter"><span class="LIDENT">flush_str_formatter</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_stdbuf_274"><span class="LIDENT">stdbuf</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">stdbuf_key</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_formatter_275"><span class="LIDENT">str_formatter</span></span> <span class="EQUAL">=</span> <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">str_formatter_key</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">flush_buffer_formatter</span> <a href="#local_stdbuf_274"><span class="LIDENT">stdbuf</span></a> <a href="#local_str_formatter_275"><span class="LIDENT">str_formatter</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_synchronized_formatter"><span class="LIDENT">make_synchronized_formatter</span></span> <span id="local_output_276"><span class="LIDENT">output</span></span> <span id="local_flush_277"><span class="LIDENT">flush</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">new_key</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_buf_278"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LIDENT">pp_buffer_size</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_output'_279"><span class="LIDENT">output'</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-add_substring"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_substring</span></a> <a href="#local_buf_278"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_flush'_280"><span class="LIDENT">flush'</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_output_276"><span class="LIDENT">output</span></a> <span class="LPAREN">(</span><a href="buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_buf_278"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <span class="LPAREN">(</span><a href="buffer.ml.html#val-length"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_buf_278"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="buffer.ml.html#val-clear"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">clear</span></a> <a href="#local_buf_278"><span class="LIDENT">buf</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_flush_277"><span class="LIDENT">flush</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">make_formatter</span> <a href="#local_output'_279"><span class="LIDENT">output'</span></a> <a href="#local_flush'_280"><span class="LIDENT">flush'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-synchronized_formatter_of_out_channel"><span class="LIDENT">synchronized_formatter_of_out_channel</span></span> <span id="local_oc_281"><span class="LIDENT">oc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">make_synchronized_formatter</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-output_substring"><span class="LIDENT">output_substring</span></a> <a href="#local_oc_281"><span class="LIDENT">oc</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-flush"><span class="LIDENT">flush</span></a> <a href="#local_oc_281"><span class="LIDENT">oc</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*
  Symbolic pretty-printing
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*
  Symbolic pretty-printing is pretty-printing with no low level output.

  When using a symbolic formatter, all regular pretty-printing activities
  occur but output material is symbolic and stored in a buffer of output
  items. At the end of pretty-printing, flushing the output buffer allows
  post-processing of symbolic output before low level output operations.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-symbolic_output_item"><span class="TYPE">type</span> <span class="LIDENT">symbolic_output_item</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-symbolic_output_item.constructor-Output_flush"><span class="BAR">|</span> <span class="UIDENT">Output_flush</span></span><span class="EOL">
</span>  <span id="type-symbolic_output_item.constructor-Output_newline"><span class="BAR">|</span> <span class="UIDENT">Output_newline</span></span><span class="EOL">
</span>  <span id="type-symbolic_output_item.constructor-Output_string"><span class="BAR">|</span> <span class="UIDENT">Output_string</span> <span class="OF">of</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>  <span id="type-symbolic_output_item.constructor-Output_spaces"><span class="BAR">|</span> <span class="UIDENT">Output_spaces</span> <span class="OF">of</span> <span class="LIDENT">int</span></span><span class="EOL">
</span>  <span id="type-symbolic_output_item.constructor-Output_indent"><span class="BAR">|</span> <span class="UIDENT">Output_indent</span> <span class="OF">of</span> <span class="LIDENT">int</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-symbolic_output_buffer"><span class="TYPE">type</span> <span class="LIDENT">symbolic_output_buffer</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_538"><span class="MUTABLE">mutable</span> <span class="LIDENT">symbolic_output_contents</span> <span class="COLON">:</span> <span class="LIDENT">symbolic_output_item</span> <span class="LIDENT">list</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_symbolic_output_buffer"><span class="LIDENT">make_symbolic_output_buffer</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span class="LIDENT">symbolic_output_contents</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-clear_symbolic_output_buffer"><span class="LIDENT">clear_symbolic_output_buffer</span></span> <span id="local_sob_282"><span class="LIDENT">sob</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_sob_282"><span class="LIDENT">sob</span></a><span class="DOT">.</span><span class="LIDENT">symbolic_output_contents</span> <span class="LESSMINUS">&lt;-</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_symbolic_output_buffer"><span class="LIDENT">get_symbolic_output_buffer</span></span> <span id="local_sob_283"><span class="LIDENT">sob</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="list.ml.html#val-rev"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span></a> <a href="#local_sob_283"><span class="LIDENT">sob</span></a><span class="DOT">.</span><span class="LIDENT">symbolic_output_contents</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-flush_symbolic_output_buffer"><span class="LIDENT">flush_symbolic_output_buffer</span></span> <span id="local_sob_284"><span class="LIDENT">sob</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_items_285"><span class="LIDENT">items</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_symbolic_output_buffer</span> <a href="#local_sob_284"><span class="LIDENT">sob</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">clear_symbolic_output_buffer</span> <a href="#local_sob_284"><span class="LIDENT">sob</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_items_285"><span class="LIDENT">items</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_symbolic_output_item"><span class="LIDENT">add_symbolic_output_item</span></span> <span id="local_sob_286"><span class="LIDENT">sob</span></span> <span id="local_item_287"><span class="LIDENT">item</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_sob_286"><span class="LIDENT">sob</span></a><span class="DOT">.</span><span class="LIDENT">symbolic_output_contents</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_item_287"><span class="LIDENT">item</span></a> <span class="COLONCOLON">::</span> <a href="#local_sob_286"><span class="LIDENT">sob</span></a><span class="DOT">.</span><span class="LIDENT">symbolic_output_contents</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-formatter_of_symbolic_output_buffer"><span class="LIDENT">formatter_of_symbolic_output_buffer</span></span> <span id="local_sob_288"><span class="LIDENT">sob</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_symbolic_flush_289"><span class="LIDENT">symbolic_flush</span></span> <span id="local_sob_290"><span class="LIDENT">sob</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">add_symbolic_output_item</span> <a href="#local_sob_290"><span class="LIDENT">sob</span></a> <span class="UIDENT">Output_flush</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_symbolic_newline_291"><span class="LIDENT">symbolic_newline</span></span> <span id="local_sob_292"><span class="LIDENT">sob</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">add_symbolic_output_item</span> <a href="#local_sob_292"><span class="LIDENT">sob</span></a> <span class="UIDENT">Output_newline</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_symbolic_string_293"><span class="LIDENT">symbolic_string</span></span> <span id="local_sob_294"><span class="LIDENT">sob</span></span> <span id="local_s_295"><span class="LIDENT">s</span></span> <span id="local_i_296"><span class="LIDENT">i</span></span> <span id="local_n_297"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">add_symbolic_output_item</span> <a href="#local_sob_294"><span class="LIDENT">sob</span></a> <span class="LPAREN">(</span><span class="UIDENT">Output_string</span> <span class="LPAREN">(</span><a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_s_295"><span class="LIDENT">s</span></a> <a href="#local_i_296"><span class="LIDENT">i</span></a> <a href="#local_n_297"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_symbolic_spaces_298"><span class="LIDENT">symbolic_spaces</span></span> <span id="local_sob_299"><span class="LIDENT">sob</span></span> <span id="local_n_300"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">add_symbolic_output_item</span> <a href="#local_sob_299"><span class="LIDENT">sob</span></a> <span class="LPAREN">(</span><span class="UIDENT">Output_spaces</span> <a href="#local_n_300"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_symbolic_indent_301"><span class="LIDENT">symbolic_indent</span></span> <span id="local_sob_302"><span class="LIDENT">sob</span></span> <span id="local_n_303"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">add_symbolic_output_item</span> <a href="#local_sob_302"><span class="LIDENT">sob</span></a> <span class="LPAREN">(</span><span class="UIDENT">Output_indent</span> <a href="#local_n_303"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_f_304"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <a href="#local_symbolic_string_293"><span class="LIDENT">symbolic_string</span></a> <a href="#local_sob_288"><span class="LIDENT">sob</span></a><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_g_305"><span class="LIDENT">g</span></span> <span class="EQUAL">=</span> <a href="#local_symbolic_flush_289"><span class="LIDENT">symbolic_flush</span></a> <a href="#local_sob_288"><span class="LIDENT">sob</span></a><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_h_306"><span class="LIDENT">h</span></span> <span class="EQUAL">=</span> <a href="#local_symbolic_newline_291"><span class="LIDENT">symbolic_newline</span></a> <a href="#local_sob_288"><span class="LIDENT">sob</span></a><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_i_307"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_symbolic_spaces_298"><span class="LIDENT">symbolic_spaces</span></a> <a href="#local_sob_288"><span class="LIDENT">sob</span></a><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_j_308"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span> <a href="#local_symbolic_indent_301"><span class="LIDENT">symbolic_indent</span></a> <a href="#local_sob_288"><span class="LIDENT">sob</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">pp_make_formatter</span> <a href="#local_f_304"><span class="LIDENT">f</span></a> <a href="#local_g_305"><span class="LIDENT">g</span></a> <a href="#local_h_306"><span class="LIDENT">h</span></a> <a href="#local_i_307"><span class="LIDENT">i</span></a> <a href="#local_j_308"><span class="LIDENT">j</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  Basic functions on the 'standard' formatter
  (the formatter that prints to [Stdlib.stdout]).

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-open_hbox"><span class="LIDENT">open_hbox</span></span> <span id="local_v_309"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_hbox</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_309"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_vbox"><span class="LIDENT">open_vbox</span></span> <span id="local_v_310"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_vbox</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_310"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_hvbox"><span class="LIDENT">open_hvbox</span></span> <span id="local_v_311"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_hvbox</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_311"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_hovbox"><span class="LIDENT">open_hovbox</span></span> <span id="local_v_312"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_hovbox</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_312"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_box"><span class="LIDENT">open_box</span></span> <span id="local_v_313"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_box</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_313"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-close_box"><span class="LIDENT">close_box</span></span> <span id="local_v_314"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_close_box</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_314"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_stag"><span class="LIDENT">open_stag</span></span> <span id="local_v_315"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_stag</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_315"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-close_stag"><span class="LIDENT">close_stag</span></span> <span id="local_v_316"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_close_stag</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_316"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_as"><span class="LIDENT">print_as</span></span> <span id="local_v_317"><span class="LIDENT">v</span></span> <span id="local_w_318"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_as</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_317"><span class="LIDENT">v</span></a> <a href="#local_w_318"><span class="LIDENT">w</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_string"><span class="LIDENT">print_string</span></span> <span id="local_v_319"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_string</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_319"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_bytes"><span class="LIDENT">print_bytes</span></span> <span id="local_v_320"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_bytes</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_320"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_int"><span class="LIDENT">print_int</span></span> <span id="local_v_321"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_int</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_321"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_float"><span class="LIDENT">print_float</span></span> <span id="local_v_322"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_float</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_322"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_char"><span class="LIDENT">print_char</span></span> <span id="local_v_323"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_char</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_323"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_bool"><span class="LIDENT">print_bool</span></span> <span id="local_v_324"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_bool</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_324"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_break"><span class="LIDENT">print_break</span></span> <span id="local_v_325"><span class="LIDENT">v</span></span> <span id="local_w_326"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_break</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_325"><span class="LIDENT">v</span></a> <a href="#local_w_326"><span class="LIDENT">w</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_cut"><span class="LIDENT">print_cut</span></span> <span id="local_v_327"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_cut</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_327"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_space"><span class="LIDENT">print_space</span></span> <span id="local_v_328"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_space</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_328"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-force_newline"><span class="LIDENT">force_newline</span></span> <span id="local_v_329"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_force_newline</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_329"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_flush"><span class="LIDENT">print_flush</span></span> <span id="local_v_330"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_flush</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_330"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_newline"><span class="LIDENT">print_newline</span></span> <span id="local_v_331"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_newline</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_331"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_if_newline"><span class="LIDENT">print_if_newline</span></span> <span id="local_v_332"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_if_newline</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_332"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_tbox"><span class="LIDENT">open_tbox</span></span> <span id="local_v_333"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_open_tbox</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_333"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-close_tbox"><span class="LIDENT">close_tbox</span></span> <span id="local_v_334"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_close_tbox</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_334"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_tbreak"><span class="LIDENT">print_tbreak</span></span> <span id="local_v_335"><span class="LIDENT">v</span></span> <span id="local_w_336"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_tbreak</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_335"><span class="LIDENT">v</span></a> <a href="#local_w_336"><span class="LIDENT">w</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_tab"><span class="LIDENT">set_tab</span></span> <span id="local_v_337"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_set_tab</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_337"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-print_tab"><span class="LIDENT">print_tab</span></span> <span id="local_v_338"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_tab</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_338"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_margin"><span class="LIDENT">set_margin</span></span> <span id="local_v_339"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_set_margin</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_339"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_margin"><span class="LIDENT">get_margin</span></span> <span id="local_v_340"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_margin</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_340"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_max_indent"><span class="LIDENT">set_max_indent</span></span> <span id="local_v_341"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_set_max_indent</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_341"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_max_indent"><span class="LIDENT">get_max_indent</span></span> <span id="local_v_342"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_max_indent</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_342"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_geometry"><span class="LIDENT">set_geometry</span></span> <span class="TILDE">~</span><span id="local_max_indent_343"><span class="LIDENT">max_indent</span></span> <span class="TILDE">~</span><span id="local_margin_344"><span class="LIDENT">margin</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_geometry</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_max_indent_343"><span class="LIDENT">max_indent</span></a> <span class="TILDE">~</span><a href="#local_margin_344"><span class="LIDENT">margin</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-safe_set_geometry"><span class="LIDENT">safe_set_geometry</span></span> <span class="TILDE">~</span><span id="local_max_indent_345"><span class="LIDENT">max_indent</span></span> <span class="TILDE">~</span><span id="local_margin_346"><span class="LIDENT">margin</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_safe_set_geometry</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <span class="TILDE">~</span><a href="#local_max_indent_345"><span class="LIDENT">max_indent</span></a> <span class="TILDE">~</span><a href="#local_margin_346"><span class="LIDENT">margin</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_geometry"><span class="LIDENT">get_geometry</span></span> <span id="local_v_347"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_geometry</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_347"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-update_geometry"><span class="LIDENT">update_geometry</span></span> <span id="local_v_348"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_update_geometry</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_348"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_max_boxes"><span class="LIDENT">set_max_boxes</span></span> <span id="local_v_349"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_set_max_boxes</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_349"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_max_boxes"><span class="LIDENT">get_max_boxes</span></span> <span id="local_v_350"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_max_boxes</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_350"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-over_max_boxes"><span class="LIDENT">over_max_boxes</span></span> <span id="local_v_351"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_over_max_boxes</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_351"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_ellipsis_text"><span class="LIDENT">set_ellipsis_text</span></span> <span id="local_v_352"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_set_ellipsis_text</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_352"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_ellipsis_text"><span class="LIDENT">get_ellipsis_text</span></span> <span id="local_v_353"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_ellipsis_text</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_353"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_formatter_out_channel"><span class="LIDENT">set_formatter_out_channel</span></span> <span id="local_v_354"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_formatter_out_channel</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_354"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_formatter_out_functions"><span class="LIDENT">set_formatter_out_functions</span></span> <span id="local_v_355"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_formatter_out_functions</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_355"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_formatter_out_functions"><span class="LIDENT">get_formatter_out_functions</span></span> <span id="local_v_356"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_get_formatter_out_functions</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_356"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_formatter_output_functions"><span class="LIDENT">set_formatter_output_functions</span></span> <span id="local_v_357"><span class="LIDENT">v</span></span> <span id="local_w_358"><span class="LIDENT">w</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_formatter_output_functions</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_357"><span class="LIDENT">v</span></a> <a href="#local_w_358"><span class="LIDENT">w</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_formatter_output_functions"><span class="LIDENT">get_formatter_output_functions</span></span> <span id="local_v_359"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_get_formatter_output_functions</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_359"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_formatter_stag_functions"><span class="LIDENT">set_formatter_stag_functions</span></span> <span id="local_v_360"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_formatter_stag_functions</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_360"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_formatter_stag_functions"><span class="LIDENT">get_formatter_stag_functions</span></span> <span id="local_v_361"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_get_formatter_stag_functions</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_361"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_print_tags"><span class="LIDENT">set_print_tags</span></span> <span id="local_v_362"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_print_tags</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_362"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_print_tags"><span class="LIDENT">get_print_tags</span></span> <span id="local_v_363"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_get_print_tags</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_363"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_mark_tags"><span class="LIDENT">set_mark_tags</span></span> <span id="local_v_364"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_mark_tags</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_364"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-get_mark_tags"><span class="LIDENT">get_mark_tags</span></span> <span id="local_v_365"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_get_mark_tags</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_365"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-set_tags"><span class="LIDENT">set_tags</span></span> <span id="local_v_366"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_tags</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_v_366"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convenience functions *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_iter"><span class="LIDENT">pp_print_iter</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_pp_sep_367"><span class="LIDENT">pp_sep</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_cut</span><span class="RPAREN">)</span> <span id="local_iter_368"><span class="LIDENT">iter</span></span> <span id="local_pp_v_369"><span class="LIDENT">pp_v</span></span> <span id="local_ppf_370"><span class="LIDENT">ppf</span></span> <span id="local_v_371"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_is_first_372"><span class="LIDENT">is_first</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="TRUE">true</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pp_v_373"><span class="LIDENT">pp_v</span></span> <span id="local_v_374"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_is_first_372"><span class="LIDENT">is_first</span></a> <span class="THEN">then</span> <a href="#local_is_first_372"><span class="LIDENT">is_first</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="FALSE">false</span> <span class="ELSE">else</span> <a href="#local_pp_sep_367"><span class="LIDENT">pp_sep</span></a> <a href="#local_ppf_370"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_pp_v_369"><span class="LIDENT">pp_v</span></a> <a href="#local_ppf_370"><span class="LIDENT">ppf</span></a> <a href="#local_v_374"><span class="LIDENT">v</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_iter_368"><span class="LIDENT">iter</span></a> <a href="#local_pp_v_373"><span class="LIDENT">pp_v</span></a> <a href="#local_v_371"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a list *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_list"><span class="LIDENT">pp_print_list</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_pp_sep_375"><span class="LIDENT">pp_sep</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_cut</span><span class="RPAREN">)</span> <span id="local_pp_v_376"><span class="LIDENT">pp_v</span></span> <span id="local_ppf_377"><span class="LIDENT">ppf</span></span> <span id="local_v_378"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_iter</span> <span class="TILDE">~</span><a href="#local_pp_sep_375"><span class="LIDENT">pp_sep</span></a> <a href="list.ml.html#val-iter"><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_pp_v_376"><span class="LIDENT">pp_v</span></a> <a href="#local_ppf_377"><span class="LIDENT">ppf</span></a> <a href="#local_v_378"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format an array *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_array"><span class="LIDENT">pp_print_array</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_pp_sep_379"><span class="LIDENT">pp_sep</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_cut</span><span class="RPAREN">)</span> <span id="local_pp_v_380"><span class="LIDENT">pp_v</span></span> <span id="local_ppf_381"><span class="LIDENT">ppf</span></span> <span id="local_v_382"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_iter</span> <span class="TILDE">~</span><a href="#local_pp_sep_379"><span class="LIDENT">pp_sep</span></a> <a href="array.ml.html#val-iter"><span class="UIDENT">Array</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_pp_v_380"><span class="LIDENT">pp_v</span></a> <a href="#local_ppf_381"><span class="LIDENT">ppf</span></a> <a href="#local_v_382"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format a sequence *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_seq"><span class="LIDENT">pp_print_seq</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_pp_sep_383"><span class="LIDENT">pp_sep</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_print_cut</span><span class="RPAREN">)</span> <span id="local_pp_v_384"><span class="LIDENT">pp_v</span></span> <span id="local_ppf_385"><span class="LIDENT">ppf</span></span> <span id="local_seq_386"><span class="LIDENT">seq</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_iter</span> <span class="TILDE">~</span><a href="#local_pp_sep_383"><span class="LIDENT">pp_sep</span></a> <a href="seq.ml.html#val-iter"><span class="UIDENT">Seq</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <a href="#local_pp_v_384"><span class="LIDENT">pp_v</span></a> <a href="#local_ppf_385"><span class="LIDENT">ppf</span></a> <a href="#local_seq_386"><span class="LIDENT">seq</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* To format free-flowing text *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_text"><span class="LIDENT">pp_print_text</span></span> <span id="local_ppf_387"><span class="LIDENT">ppf</span></span> <span id="local_s_388"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_389"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_388"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_left_390"><span class="LIDENT">left</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_right_391"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_flush_392"><span class="LIDENT">flush</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_string</span> <a href="#local_ppf_387"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_s_388"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_390"><span class="LIDENT">left</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_right_391"><span class="LIDENT">right</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_390"><span class="LIDENT">left</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_right_391"><span class="LIDENT">right</span></a><span class="SEMI">;</span> <a href="#local_left_390"><span class="LIDENT">left</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_right_391"><span class="LIDENT">right</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_right_391"><span class="LIDENT">right</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_len_389"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_s_388"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_right_391"><span class="LIDENT">right</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_flush_392"><span class="LIDENT">flush</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">pp_force_newline</span> <a href="#local_ppf_387"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_flush_392"><span class="LIDENT">flush</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="LIDENT">pp_print_space</span> <a href="#local_ppf_387"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="COMMENT">(* there is no specific support for '\t'
         as it is unclear what a right semantics would be *)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_right_391"><span class="LIDENT">right</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_390"><span class="LIDENT">left</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_len_389"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="#local_flush_392"><span class="LIDENT">flush</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_option"><span class="LIDENT">pp_print_option</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_none_393"><span class="LIDENT">none</span></span> <span class="EQUAL">=</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span id="local_pp_v_394"><span class="LIDENT">pp_v</span></span> <span id="local_ppf_395"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span><span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_none_393"><span class="LIDENT">none</span></a> <a href="#local_ppf_395"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_v_396"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pp_v_394"><span class="LIDENT">pp_v</span></a> <a href="#local_ppf_395"><span class="LIDENT">ppf</span></a> <a href="#local_v_396"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_result"><span class="LIDENT">pp_print_result</span></span> <span class="TILDE">~</span><span id="local_ok_397"><span class="LIDENT">ok</span></span> <span class="TILDE">~</span><span id="local_error_398"><span class="LIDENT">error</span></span> <span id="local_ppf_399"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span><span class="BAR">|</span> <span class="UIDENT">Ok</span> <span id="local_v_400"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_ok_397"><span class="LIDENT">ok</span></a> <a href="#local_ppf_399"><span class="LIDENT">ppf</span></a> <a href="#local_v_400"><span class="LIDENT">v</span></a><span class="EOL">
</span><span class="BAR">|</span> <span class="UIDENT">Error</span> <span id="local_e_401"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_error_398"><span class="LIDENT">error</span></a> <a href="#local_ppf_399"><span class="LIDENT">ppf</span></a> <a href="#local_e_401"><span class="LIDENT">e</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pp_print_either"><span class="LIDENT">pp_print_either</span></span> <span class="TILDE">~</span><span id="local_left_402"><span class="LIDENT">left</span></span> <span class="TILDE">~</span><span id="local_right_403"><span class="LIDENT">right</span></span> <span id="local_ppf_404"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span><span class="BAR">|</span> <span class="UIDENT">Either</span><span class="DOT">.</span><span class="UIDENT">Left</span> <span id="local_l_405"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_left_402"><span class="LIDENT">left</span></a> <a href="#local_ppf_404"><span class="LIDENT">ppf</span></a> <a href="#local_l_405"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="BAR">|</span> <span class="UIDENT">Either</span><span class="DOT">.</span><span class="UIDENT">Right</span> <span id="local_r_406"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_right_403"><span class="LIDENT">right</span></a> <a href="#local_ppf_404"><span class="LIDENT">ppf</span></a> <a href="#local_r_406"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span> <span class="COMMENT">(**************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-compute_tag"><span class="LIDENT">compute_tag</span></span> <span id="local_output_407"><span class="LIDENT">output</span></span> <span id="local_tag_acc_408"><span class="LIDENT">tag_acc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_409"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">16</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ppf_410"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">formatter_of_buffer</span> <a href="#local_buf_409"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_output_407"><span class="LIDENT">output</span></a> <a href="#local_ppf_410"><span class="LIDENT">ppf</span></a> <a href="#local_tag_acc_408"><span class="LIDENT">tag_acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_flush</span> <a href="#local_ppf_410"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_411"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-length"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_buf_409"><span class="LIDENT">buf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_len_411"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">2</span> <span class="THEN">then</span> <a href="buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_buf_409"><span class="LIDENT">buf</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="buffer.ml.html#val-sub"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_buf_409"><span class="LIDENT">buf</span></a> <span class="INT">1</span> <span class="LPAREN">(</span><a href="#local_len_411"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span> <span class="COMMENT">(**************************************************************

  Defining continuations to be passed as arguments of
  CamlinternalFormat.make_printf.

  **************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="camlinternalFormatBasics.ml.html"><span class="UIDENT">CamlinternalFormatBasics</span></a><span class="EOL">
</span><span class="OPEN">open</span> <a href="camlinternalFormat.ml.html"><span class="UIDENT">CamlinternalFormat</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Interpret a formatting entity on a formatter. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_formatting_lit"><span class="LIDENT">output_formatting_lit</span></span> <span id="local_ppf_412"><span class="LIDENT">ppf</span></span> <span id="local_fmting_lit_413"><span class="LIDENT">fmting_lit</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_fmting_lit_413"><span class="LIDENT">fmting_lit</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Close_box</span>                 <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_close_box</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Close_tag</span>                 <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_close_stag</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Break</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_width_414"><span class="LIDENT">width</span></span><span class="COMMA">,</span> <span id="local_offset_415"><span class="LIDENT">offset</span></span><span class="RPAREN">)</span>  <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_print_break</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <a href="#local_width_414"><span class="LIDENT">width</span></a> <a href="#local_offset_415"><span class="LIDENT">offset</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FFlush</span>                    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_print_flush</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Force_newline</span>             <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_force_newline</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush_newline</span>             <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_print_newline</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Escaped_at</span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_print_char</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="CHAR">'@'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Escaped_percent</span>           <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_print_char</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="CHAR">'%'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_indic</span> <span id="local_c_416"><span class="LIDENT">c</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">pp_print_char</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <span class="CHAR">'@'</span><span class="SEMI">;</span> <span class="LIDENT">pp_print_char</span> <a href="#local_ppf_412"><span class="LIDENT">ppf</span></a> <a href="#local_c_416"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Recursively output an &quot;accumulator&quot; containing a reversed list of
   printing entities (string, char, flus, ...) in an output_stream. *)</span><span class="EOL">
</span><span class="COMMENT">(* Differ from Printf.output_acc by the interpretation of formatting. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used as a continuation of CamlinternalFormat.make_printf. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-output_acc"><span class="LIDENT">output_acc</span></span> <span id="local_ppf_417"><span class="LIDENT">ppf</span></span> <span id="local_acc_418"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_acc_418"><span class="LIDENT">acc</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_419"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_420"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_s_421"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_422"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_423"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_s_424"><span class="LIDENT">s</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_422"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_as_size</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <a href="#local_size_423"><span class="LIDENT">size</span></a><span class="RPAREN">)</span> <a href="#local_s_424"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_425"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_426"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_c_427"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_428"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_429"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_c_430"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_428"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_as_size</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <a href="#local_size_429"><span class="LIDENT">size</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">1</span> <a href="#local_c_430"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_431"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_432"><span class="LIDENT">f</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_431"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">output_formatting_lit</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_f_432"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_433"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_tag</span> <span id="local_acc'_434"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_433"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_open_stag</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">String_tag</span> <span class="LPAREN">(</span><span class="LIDENT">compute_tag</span> <span class="LIDENT">output_acc</span> <a href="#local_acc'_434"><span class="LIDENT">acc'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_435"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_box</span> <span id="local_acc'_436"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_435"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_545"><span class="LPAREN">(</span><span id="local_indent_437"><span class="LIDENT">indent</span></span><span class="COMMA">,</span> <span id="local_bty_438"><span class="LIDENT">bty</span></span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-open_box_of_string"><span class="LIDENT">open_box_of_string</span></a> <span class="LPAREN">(</span><span class="LIDENT">compute_tag</span> <span class="LIDENT">output_acc</span> <a href="#local_acc'_436"><span class="LIDENT">acc'</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pp_open_box_gen</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_indent_437"><span class="LIDENT">indent</span></a> <a href="#local_bty_438"><span class="LIDENT">bty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span id="local_p_439"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_440"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span id="local_p_441"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_442"><span class="LIDENT">s</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_441"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_string</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_s_442"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span id="local_p_443"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_444"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span id="local_p_445"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_446"><span class="LIDENT">c</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_445"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_char</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_c_446"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><span id="local_p_447"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_448"><span class="LIDENT">f</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_447"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="#local_f_448"><span class="LIDENT">f</span></a> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_flush</span> <span id="local_p_449"><span class="LIDENT">p</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_449"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_flush</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><span id="local_p_450"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_msg_451"><span class="LIDENT">msg</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_417"><span class="LIDENT">ppf</span></a> <a href="#local_p_450"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <a href="#local_msg_451"><span class="LIDENT">msg</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_acc</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Recursively output an &quot;accumulator&quot; containing a reversed list of
   printing entities (string, char, flus, ...) in a buffer. *)</span><span class="EOL">
</span><span class="COMMENT">(* Differ from Printf.bufput_acc by the interpretation of formatting. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used as a continuation of CamlinternalFormat.make_printf. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-strput_acc"><span class="LIDENT">strput_acc</span></span> <span id="local_ppf_452"><span class="LIDENT">ppf</span></span> <span id="local_acc_453"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_acc_453"><span class="LIDENT">acc</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_454"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_455"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_s_456"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_457"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_458"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_s_459"><span class="LIDENT">s</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_457"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_as_size</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <a href="#local_size_458"><span class="LIDENT">size</span></a><span class="RPAREN">)</span> <a href="#local_s_459"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_460"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_461"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_c_462"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_463"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_464"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_c_465"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_463"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_as_size</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <a href="#local_size_464"><span class="LIDENT">size</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">1</span> <a href="#local_c_465"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_466"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_size_467"><span class="LIDENT">size</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_f_468"><span class="LIDENT">f</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_466"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_print_as_size</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">Size</span><span class="DOT">.</span><span class="LIDENT">of_int</span> <a href="#local_size_467"><span class="LIDENT">size</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_f_468"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_469"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_470"><span class="LIDENT">f</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_469"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">output_formatting_lit</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_f_470"><span class="LIDENT">f</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_471"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_tag</span> <span id="local_acc'_472"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_471"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">pp_open_stag</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="UIDENT">String_tag</span> <span class="LPAREN">(</span><span class="LIDENT">compute_tag</span> <span class="LIDENT">strput_acc</span> <a href="#local_acc'_472"><span class="LIDENT">acc'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_473"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_box</span> <span id="local_acc'_474"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_473"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_564"><span class="LPAREN">(</span><span id="local_indent_475"><span class="LIDENT">indent</span></span><span class="COMMA">,</span> <span id="local_bty_476"><span class="LIDENT">bty</span></span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <a href="camlinternalFormat.ml.html#val-open_box_of_string"><span class="LIDENT">open_box_of_string</span></a> <span class="LPAREN">(</span><span class="LIDENT">compute_tag</span> <span class="LIDENT">strput_acc</span> <a href="#local_acc'_474"><span class="LIDENT">acc'</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">pp_open_box_gen</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_indent_475"><span class="LIDENT">indent</span></a> <a href="#local_bty_476"><span class="LIDENT">bty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span id="local_p_477"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_478"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span id="local_p_479"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_480"><span class="LIDENT">s</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_479"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_string</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_s_480"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span id="local_p_481"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_482"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span id="local_p_483"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_484"><span class="LIDENT">c</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_483"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_char</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_c_484"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><span id="local_p_485"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_486"><span class="LIDENT">f</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_485"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_string</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><a href="#local_f_486"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_flush</span> <span id="local_p_487"><span class="LIDENT">p</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_487"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <span class="LIDENT">pp_print_flush</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><span id="local_p_488"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_msg_489"><span class="LIDENT">msg</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_ppf_452"><span class="LIDENT">ppf</span></a> <a href="#local_p_488"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <a href="#local_msg_489"><span class="LIDENT">msg</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_acc</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(*

  Defining [fprintf] and various flavors of [fprintf].

*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kfprintf"><span class="LIDENT">kfprintf</span></span> <span id="local_k_490"><span class="LIDENT">k</span></span> <span id="local_ppf_491"><span class="LIDENT">ppf</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_492"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_printf"><span class="LIDENT">make_printf</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_493"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_491"><span class="LIDENT">ppf</span></a> <a href="#local_acc_493"><span class="LIDENT">acc</span></a><span class="SEMI">;</span> <a href="#local_k_490"><span class="LIDENT">k</span></a> <a href="#local_ppf_491"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_492"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-ikfprintf"><span class="LIDENT">ikfprintf</span></span> <span id="local_k_494"><span class="LIDENT">k</span></span> <span id="local_ppf_495"><span class="LIDENT">ppf</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_496"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_iprintf"><span class="LIDENT">make_iprintf</span></a> <a href="#local_k_494"><span class="LIDENT">k</span></a> <a href="#local_ppf_495"><span class="LIDENT">ppf</span></a> <a href="#local_fmt_496"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ifprintf"><span class="LIDENT">ifprintf</span></span> <span id="local__ppf_497"><span class="LIDENT">_ppf</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_498"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_iprintf"><span class="LIDENT">make_iprintf</span></a> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <a href="#local_fmt_498"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fprintf"><span class="LIDENT">fprintf</span></span> <span id="local_ppf_499"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kfprintf</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="#local_ppf_499"><span class="LIDENT">ppf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-printf"><span class="LIDENT">printf</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_500"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_printf"><span class="LIDENT">make_printf</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_501"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <a href="#local_acc_501"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_500"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-eprintf"><span class="LIDENT">eprintf</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_502"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_printf"><span class="LIDENT">make_printf</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_503"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">err_formatter_key</span><span class="RPAREN">)</span> <a href="#local_acc_503"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_502"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kdprintf"><span class="LIDENT">kdprintf</span></span> <span id="local_k_504"><span class="LIDENT">k</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_505"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_printf"><span class="LIDENT">make_printf</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_acc_506"><span class="LIDENT">acc</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_k_504"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_ppf_507"><span class="LIDENT">ppf</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_ppf_507"><span class="LIDENT">ppf</span></a> <a href="#local_acc_506"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_505"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-dprintf"><span class="LIDENT">dprintf</span></span> <span id="local_fmt_508"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kdprintf</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_i_509"><span class="LIDENT">i</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_i_509"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="#local_fmt_508"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ksprintf"><span class="LIDENT">ksprintf</span></span> <span id="local_k_510"><span class="LIDENT">k</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_511"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_b_512"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_make_buffer</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ppf_513"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">formatter_of_buffer</span> <a href="#local_b_512"><span class="LIDENT">b</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_k_514"><span class="LIDENT">k</span></span> <span id="local_acc_515"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_ppf_513"><span class="LIDENT">ppf</span></a> <a href="#local_acc_515"><span class="LIDENT">acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_k_510"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="LIDENT">flush_buffer_formatter</span> <a href="#local_b_512"><span class="LIDENT">b</span></a> <a href="#local_ppf_513"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_printf"><span class="LIDENT">make_printf</span></a> <a href="#local_k_514"><span class="LIDENT">k</span></a> <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_511"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sprintf"><span class="LIDENT">sprintf</span></span> <span id="local_fmt_516"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">ksprintf</span> <span class="LIDENT">id</span> <a href="#local_fmt_516"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-kasprintf"><span class="LIDENT">kasprintf</span></span> <span id="local_k_517"><span class="LIDENT">k</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_518"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_b_519"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_make_buffer</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ppf_520"><span class="LIDENT">ppf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">formatter_of_buffer</span> <a href="#local_b_519"><span class="LIDENT">b</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_k_521"><span class="LIDENT">k</span></span> <span id="local_acc_522"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_ppf_520"><span class="LIDENT">ppf</span></a> <a href="#local_acc_522"><span class="LIDENT">acc</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_k_517"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="LIDENT">flush_buffer_formatter</span> <a href="#local_b_519"><span class="LIDENT">b</span></a> <a href="#local_ppf_520"><span class="LIDENT">ppf</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="camlinternalFormat.ml.html#val-make_printf"><span class="LIDENT">make_printf</span></a> <a href="#local_k_521"><span class="LIDENT">k</span></a> <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_518"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-asprintf"><span class="LIDENT">asprintf</span></span> <span id="local_fmt_523"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">kasprintf</span> <span class="LIDENT">id</span> <a href="#local_fmt_523"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Flushing standard formatters at end of execution. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-flush_standard_formatters"><span class="LIDENT">flush_standard_formatters</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_flush</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">std_formatter_key</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">pp_print_flush</span> <span class="LPAREN">(</span><span class="UIDENT">DLS</span><span class="DOT">.</span><span class="LIDENT">get</span> <span class="LIDENT">err_formatter_key</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-at_exit"><span class="LIDENT">at_exit</span></a> <span class="LIDENT">flush_standard_formatters</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="domain.ml.html#val-before_first_spawn"><span class="UIDENT">Domain</span><span class="DOT">.</span><span class="LIDENT">before_first_spawn</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LIDENT">flush_standard_formatters</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_fs_524"><span class="LIDENT">fs</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_formatter_out_functions</span> <span class="LIDENT">std_formatter</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_formatter_out_functions</span> <span class="LIDENT">std_formatter</span><span class="EOL">
</span>    <span class="LBRACE">{</span><a href="#local_fs_524"><span class="LIDENT">fs</span></a> <span class="WITH">with</span> <span class="LIDENT">out_string</span> <span class="EQUAL">=</span> <span class="LIDENT">buffered_out_string</span> <span class="LIDENT">std_buf_key</span><span class="SEMI">;</span><span class="EOL">
</span>             <span class="LIDENT">out_flush</span> <span class="EQUAL">=</span> <span class="LIDENT">buffered_out_flush</span> <a href="stdlib.ml.html#val-stdout"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stdout</span></a> <span class="LIDENT">std_buf_key</span><span class="RBRACE">}</span><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_fs_525"><span class="LIDENT">fs</span></span> <span class="EQUAL">=</span> <span class="LIDENT">pp_get_formatter_out_functions</span> <span class="LIDENT">err_formatter</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">pp_set_formatter_out_functions</span> <span class="LIDENT">err_formatter</span><span class="EOL">
</span>    <span class="LBRACE">{</span><a href="#local_fs_525"><span class="LIDENT">fs</span></a> <span class="WITH">with</span> <span class="LIDENT">out_string</span> <span class="EQUAL">=</span> <span class="LIDENT">buffered_out_string</span> <span class="LIDENT">err_buf_key</span><span class="SEMI">;</span><span class="EOL">
</span>             <span class="LIDENT">out_flush</span> <span class="EQUAL">=</span> <span class="LIDENT">buffered_out_flush</span> <a href="stdlib.ml.html#val-stderr"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">stderr</span></a> <span class="LIDENT">err_buf_key</span><span class="RBRACE">}</span><span class="SEMI">;</span><span class="EOL">
</span><span class="RPAREN">)</span><span class="EOL">
</span></span></code></pre></body></html>
