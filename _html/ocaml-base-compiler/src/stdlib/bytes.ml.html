<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: bytes.ml (ocaml-base-compiler.src.stdlib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocaml-base-compiler</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; stdlib &#x00BB; bytes.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>bytes.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocaml-base-compiler</a><ul><li>Library <code>compiler-libs.bytecomp</code><ul><li><a href="../../compiler-libs.bytecomp/Bytegen/index.html">Bytegen</a></li><li><a href="../../compiler-libs.bytecomp/Bytelibrarian/index.html">Bytelibrarian</a></li><li><a href="../../compiler-libs.bytecomp/Bytelink/index.html">Bytelink</a></li><li><a href="../../compiler-libs.bytecomp/Bytepackager/index.html">Bytepackager</a></li><li><a href="../../compiler-libs.bytecomp/Compile/index.html">Compile</a></li><li><a href="../../compiler-libs.bytecomp/Emitcode/index.html">Emitcode</a></li><li><a href="../../compiler-libs.bytecomp/Errors/index.html">Errors</a></li><li><a href="../../compiler-libs.bytecomp/Instruct/index.html">Instruct</a></li><li><a href="../../compiler-libs.bytecomp/Maindriver/index.html">Maindriver</a></li><li><a href="../../compiler-libs.bytecomp/Printinstr/index.html">Printinstr</a></li></ul></li><li>Library <code>compiler-libs.common</code><ul><li><a href="../../compiler-libs.common/Annot/index.html">Annot</a></li><li><a href="../../compiler-libs.common/Arg_helper/index.html">Arg_helper</a></li><li><a href="../../compiler-libs.common/Ast_helper/index.html">Ast_helper</a></li><li><a href="../../compiler-libs.common/Ast_invariants/index.html">Ast_invariants</a></li><li><a href="../../compiler-libs.common/Ast_iterator/index.html">Ast_iterator</a></li><li><a href="../../compiler-libs.common/Ast_mapper/index.html">Ast_mapper</a></li><li><a href="../../compiler-libs.common/Asttypes/index.html">Asttypes</a></li><li><a href="../../compiler-libs.common/Attr_helper/index.html">Attr_helper</a></li><li><a href="../../compiler-libs.common/Binutils/index.html">Binutils</a></li><li><a href="../../compiler-libs.common/Btype/index.html">Btype</a></li><li><a href="../../compiler-libs.common/Build_path_prefix_map/index.html">Build_path_prefix_map</a></li><li><a href="../../compiler-libs.common/Builtin_attributes/index.html">Builtin_attributes</a></li><li><a href="../../compiler-libs.common/Bytesections/index.html">Bytesections</a></li><li><a href="../../compiler-libs.common/CamlinternalMenhirLib/index.html">CamlinternalMenhirLib</a></li><li><a href="../../compiler-libs.common/Ccomp/index.html">Ccomp</a></li><li><a href="../../compiler-libs.common/Clflags/index.html">Clflags</a></li><li><a href="../../compiler-libs.common/Cmi_format/index.html">Cmi_format</a></li><li><a href="../../compiler-libs.common/Cmo_format/index.html">Cmo_format</a></li><li><a href="../../compiler-libs.common/Cmt2annot/index.html">Cmt2annot</a></li><li><a href="../../compiler-libs.common/Cmt_format/index.html">Cmt_format</a></li><li><a href="../../compiler-libs.common/Compenv/index.html">Compenv</a></li><li><a href="../../compiler-libs.common/Compile_common/index.html">Compile_common</a></li><li><a href="../../compiler-libs.common/Compmisc/index.html">Compmisc</a></li><li><a href="../../compiler-libs.common/Compression/index.html">Compression</a></li><li><a href="../../compiler-libs.common/Config/index.html">Config</a></li><li><a href="../../compiler-libs.common/Config_boot/index.html">Config_boot</a></li><li><a href="../../compiler-libs.common/Config_main/index.html">Config_main</a></li><li><a href="../../compiler-libs.common/Consistbl/index.html">Consistbl</a></li><li><a href="../../compiler-libs.common/Ctype/index.html">Ctype</a></li><li><a href="../../compiler-libs.common/Datarepr/index.html">Datarepr</a></li><li><a href="../../compiler-libs.common/Debuginfo/index.html">Debuginfo</a></li><li><a href="../../compiler-libs.common/Depend/index.html">Depend</a></li><li><a href="../../compiler-libs.common/Diffing/index.html">Diffing</a></li><li><a href="../../compiler-libs.common/Diffing_with_keys/index.html">Diffing_with_keys</a></li><li><a href="../../compiler-libs.common/Dll/index.html">Dll</a></li><li><a href="../../compiler-libs.common/Docstrings/index.html">Docstrings</a></li><li><a href="../../compiler-libs.common/Domainstate/index.html">Domainstate</a></li><li><a href="../../compiler-libs.common/Env/index.html">Env</a></li><li><a href="../../compiler-libs.common/Envaux/index.html">Envaux</a></li><li><a href="../../compiler-libs.common/Errortrace/index.html">Errortrace</a></li><li><a href="../../compiler-libs.common/Expunge/index.html">Expunge</a></li><li><a href="../../compiler-libs.common/Ident/index.html">Ident</a></li><li><a href="../../compiler-libs.common/Identifiable/index.html">Identifiable</a></li><li><a href="../../compiler-libs.common/Includeclass/index.html">Includeclass</a></li><li><a href="../../compiler-libs.common/Includecore/index.html">Includecore</a></li><li><a href="../../compiler-libs.common/Includemod/index.html">Includemod</a></li><li><a href="../../compiler-libs.common/Includemod_errorprinter/index.html">Includemod_errorprinter</a></li><li><a href="../../compiler-libs.common/Int_replace_polymorphic_compare/index.html">Int_replace_polymorphic_compare</a></li><li><a href="../../compiler-libs.common/Lambda/index.html">Lambda</a></li><li><a href="../../compiler-libs.common/Lazy_backtrack/index.html">Lazy_backtrack</a></li><li><a href="../../compiler-libs.common/Lexer/index.html">Lexer</a></li><li><a href="../../compiler-libs.common/Load_path/index.html">Load_path</a></li><li><a href="../../compiler-libs.common/Local_store/index.html">Local_store</a></li><li><a href="../../compiler-libs.common/Location/index.html">Location</a></li><li><a href="../../compiler-libs.common/Longident/index.html">Longident</a></li><li><a href="../../compiler-libs.common/Main_args/index.html">Main_args</a></li><li><a href="../../compiler-libs.common/Makedepend/index.html">Makedepend</a></li><li><a href="../../compiler-libs.common/Matching/index.html">Matching</a></li><li><a href="../../compiler-libs.common/Meta/index.html">Meta</a></li><li><a href="../../compiler-libs.common/Misc/index.html">Misc</a></li><li><a href="../../compiler-libs.common/Mtype/index.html">Mtype</a></li><li><a href="../../compiler-libs.common/Numbers/index.html">Numbers</a></li><li><a href="../../compiler-libs.common/Opcodes/index.html">Opcodes</a></li><li><a href="../../compiler-libs.common/Oprint/index.html">Oprint</a></li><li><a href="../../compiler-libs.common/Outcometree/index.html">Outcometree</a></li><li><a href="../../compiler-libs.common/Parmatch/index.html">Parmatch</a></li><li><a href="../../compiler-libs.common/Parse/index.html">Parse</a></li><li><a href="../../compiler-libs.common/Parser/index.html">Parser</a></li><li><a href="../../compiler-libs.common/Parsetree/index.html">Parsetree</a></li><li><a href="../../compiler-libs.common/Path/index.html">Path</a></li><li><a href="../../compiler-libs.common/Patterns/index.html">Patterns</a></li><li><a href="../../compiler-libs.common/Persistent_env/index.html">Persistent_env</a></li><li><a href="../../compiler-libs.common/Pparse/index.html">Pparse</a></li><li><a href="../../compiler-libs.common/Pprintast/index.html">Pprintast</a></li><li><a href="../../compiler-libs.common/Predef/index.html">Predef</a></li><li><a href="../../compiler-libs.common/Primitive/index.html">Primitive</a></li><li><a href="../../compiler-libs.common/Printast/index.html">Printast</a></li><li><a href="../../compiler-libs.common/Printlambda/index.html">Printlambda</a></li><li><a href="../../compiler-libs.common/Printpat/index.html">Printpat</a></li><li><a href="../../compiler-libs.common/Printtyp/index.html">Printtyp</a></li><li><a href="../../compiler-libs.common/Printtyped/index.html">Printtyped</a></li><li><a href="../../compiler-libs.common/Profile/index.html">Profile</a></li><li><a href="../../compiler-libs.common/Runtimedef/index.html">Runtimedef</a></li><li><a href="../../compiler-libs.common/Shape/index.html">Shape</a></li><li><a href="../../compiler-libs.common/Shape_reduce/index.html">Shape_reduce</a></li><li><a href="../../compiler-libs.common/Signature_group/index.html">Signature_group</a></li><li><a href="../../compiler-libs.common/Simplif/index.html">Simplif</a></li><li><a href="../../compiler-libs.common/Strongly_connected_components/index.html">Strongly_connected_components</a></li><li><a href="../../compiler-libs.common/Stypes/index.html">Stypes</a></li><li><a href="../../compiler-libs.common/Subst/index.html">Subst</a></li><li><a href="../../compiler-libs.common/Switch/index.html">Switch</a></li><li><a href="../../compiler-libs.common/Symtable/index.html">Symtable</a></li><li><a href="../../compiler-libs.common/Syntaxerr/index.html">Syntaxerr</a></li><li><a href="../../compiler-libs.common/Targetint/index.html">Targetint</a></li><li><a href="../../compiler-libs.common/Tast_iterator/index.html">Tast_iterator</a></li><li><a href="../../compiler-libs.common/Tast_mapper/index.html">Tast_mapper</a></li><li><a href="../../compiler-libs.common/Terminfo/index.html">Terminfo</a></li><li><a href="../../compiler-libs.common/Tmc/index.html">Tmc</a></li><li><a href="../../compiler-libs.common/Translattribute/index.html">Translattribute</a></li><li><a href="../../compiler-libs.common/Translclass/index.html">Translclass</a></li><li><a href="../../compiler-libs.common/Translcore/index.html">Translcore</a></li><li><a href="../../compiler-libs.common/Translmod/index.html">Translmod</a></li><li><a href="../../compiler-libs.common/Translobj/index.html">Translobj</a></li><li><a href="../../compiler-libs.common/Translprim/index.html">Translprim</a></li><li><a href="../../compiler-libs.common/Type_immediacy/index.html">Type_immediacy</a></li><li><a href="../../compiler-libs.common/Typeclass/index.html">Typeclass</a></li><li><a href="../../compiler-libs.common/Typecore/index.html">Typecore</a></li><li><a href="../../compiler-libs.common/Typedecl/index.html">Typedecl</a></li><li><a href="../../compiler-libs.common/Typedecl_immediacy/index.html">Typedecl_immediacy</a></li><li><a href="../../compiler-libs.common/Typedecl_properties/index.html">Typedecl_properties</a></li><li><a href="../../compiler-libs.common/Typedecl_separability/index.html">Typedecl_separability</a></li><li><a href="../../compiler-libs.common/Typedecl_unboxed/index.html">Typedecl_unboxed</a></li><li><a href="../../compiler-libs.common/Typedecl_variance/index.html">Typedecl_variance</a></li><li><a href="../../compiler-libs.common/Typedtree/index.html">Typedtree</a></li><li><a href="../../compiler-libs.common/Typemod/index.html">Typemod</a></li><li><a href="../../compiler-libs.common/Typeopt/index.html">Typeopt</a></li><li><a href="../../compiler-libs.common/Types/index.html">Types</a></li><li><a href="../../compiler-libs.common/Typetexp/index.html">Typetexp</a></li><li><a href="../../compiler-libs.common/Unit_info/index.html">Unit_info</a></li><li><a href="../../compiler-libs.common/Untypeast/index.html">Untypeast</a></li><li><a href="../../compiler-libs.common/Value_rec_check/index.html">Value_rec_check</a></li><li><a href="../../compiler-libs.common/Value_rec_compiler/index.html">Value_rec_compiler</a></li><li><a href="../../compiler-libs.common/Value_rec_types/index.html">Value_rec_types</a></li><li><a href="../../compiler-libs.common/Warnings/index.html">Warnings</a></li><li><a href="../../compiler-libs.common/X86_ast/index.html">X86_ast</a></li></ul></li><li>Library <code>compiler-libs.optcomp</code><ul><li><a href="../../compiler-libs.optcomp/Afl_instrument/index.html">Afl_instrument</a></li><li><a href="../../compiler-libs.optcomp/Alias_analysis/index.html">Alias_analysis</a></li><li><a href="../../compiler-libs.optcomp/Allocated_const/index.html">Allocated_const</a></li><li><a href="../../compiler-libs.optcomp/Arch/index.html">Arch</a></li><li><a href="../../compiler-libs.optcomp/Asmgen/index.html">Asmgen</a></li><li><a href="../../compiler-libs.optcomp/Asmlibrarian/index.html">Asmlibrarian</a></li><li><a href="../../compiler-libs.optcomp/Asmlink/index.html">Asmlink</a></li><li><a href="../../compiler-libs.optcomp/Asmpackager/index.html">Asmpackager</a></li><li><a href="../../compiler-libs.optcomp/Augment_specialised_args/index.html">Augment_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Backend_intf/index.html">Backend_intf</a></li><li><a href="../../compiler-libs.optcomp/Backend_var/index.html">Backend_var</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation/index.html">Branch_relaxation</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation_intf/index.html">Branch_relaxation_intf</a></li><li><a href="../../compiler-libs.optcomp/Build_export_info/index.html">Build_export_info</a></li><li><a href="../../compiler-libs.optcomp/CSE/index.html">CSE</a></li><li><a href="../../compiler-libs.optcomp/CSEgen/index.html">CSEgen</a></li><li><a href="../../compiler-libs.optcomp/Clambda/index.html">Clambda</a></li><li><a href="../../compiler-libs.optcomp/Clambda_primitives/index.html">Clambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Closure/index.html">Closure</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion/index.html">Closure_conversion</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion_aux/index.html">Closure_conversion_aux</a></li><li><a href="../../compiler-libs.optcomp/Closure_element/index.html">Closure_element</a></li><li><a href="../../compiler-libs.optcomp/Closure_id/index.html">Closure_id</a></li><li><a href="../../compiler-libs.optcomp/Closure_middle_end/index.html">Closure_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Closure_offsets/index.html">Closure_offsets</a></li><li><a href="../../compiler-libs.optcomp/Closure_origin/index.html">Closure_origin</a></li><li><a href="../../compiler-libs.optcomp/Cmm/index.html">Cmm</a></li><li><a href="../../compiler-libs.optcomp/Cmm_helpers/index.html">Cmm_helpers</a></li><li><a href="../../compiler-libs.optcomp/Cmm_invariants/index.html">Cmm_invariants</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen/index.html">Cmmgen</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen_state/index.html">Cmmgen_state</a></li><li><a href="../../compiler-libs.optcomp/Cmx_format/index.html">Cmx_format</a></li><li><a href="../../compiler-libs.optcomp/Cmxs_format/index.html">Cmxs_format</a></li><li><a href="../../compiler-libs.optcomp/Coloring/index.html">Coloring</a></li><li><a href="../../compiler-libs.optcomp/Comballoc/index.html">Comballoc</a></li><li><a href="../../compiler-libs.optcomp/Compilation_unit/index.html">Compilation_unit</a></li><li><a href="../../compiler-libs.optcomp/Compilenv/index.html">Compilenv</a></li><li><a href="../../compiler-libs.optcomp/Convert_primitives/index.html">Convert_primitives</a></li><li><a href="../../compiler-libs.optcomp/Dataflow/index.html">Dataflow</a></li><li><a href="../../compiler-libs.optcomp/Deadcode/index.html">Deadcode</a></li><li><a href="../../compiler-libs.optcomp/Effect_analysis/index.html">Effect_analysis</a></li><li><a href="../../compiler-libs.optcomp/Emit/index.html">Emit</a></li><li><a href="../../compiler-libs.optcomp/Emitaux/index.html">Emitaux</a></li><li><a href="../../compiler-libs.optcomp/Emitenv/index.html">Emitenv</a></li><li><a href="../../compiler-libs.optcomp/Export_id/index.html">Export_id</a></li><li><a href="../../compiler-libs.optcomp/Export_info/index.html">Export_info</a></li><li><a href="../../compiler-libs.optcomp/Export_info_for_pack/index.html">Export_info_for_pack</a></li><li><a href="../../compiler-libs.optcomp/Extract_projections/index.html">Extract_projections</a></li><li><a href="../../compiler-libs.optcomp/Find_recursive_functions/index.html">Find_recursive_functions</a></li><li><a href="../../compiler-libs.optcomp/Flambda/index.html">Flambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_invariants/index.html">Flambda_invariants</a></li><li><a href="../../compiler-libs.optcomp/Flambda_iterators/index.html">Flambda_iterators</a></li><li><a href="../../compiler-libs.optcomp/Flambda_middle_end/index.html">Flambda_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Flambda_to_clambda/index.html">Flambda_to_clambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_utils/index.html">Flambda_utils</a></li><li><a href="../../compiler-libs.optcomp/Freshening/index.html">Freshening</a></li><li><a href="../../compiler-libs.optcomp/Id_types/index.html">Id_types</a></li><li><a href="../../compiler-libs.optcomp/Import_approx/index.html">Import_approx</a></li><li><a href="../../compiler-libs.optcomp/Inconstant_idents/index.html">Inconstant_idents</a></li><li><a href="../../compiler-libs.optcomp/Initialize_symbol_to_let_symbol/index.html">Initialize_symbol_to_let_symbol</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify/index.html">Inline_and_simplify</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify_aux/index.html">Inline_and_simplify_aux</a></li><li><a href="../../compiler-libs.optcomp/Inlining_cost/index.html">Inlining_cost</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision/index.html">Inlining_decision</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision_intf/index.html">Inlining_decision_intf</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats/index.html">Inlining_stats</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats_types/index.html">Inlining_stats_types</a></li><li><a href="../../compiler-libs.optcomp/Inlining_transforms/index.html">Inlining_transforms</a></li><li><a href="../../compiler-libs.optcomp/Interf/index.html">Interf</a></li><li><a href="../../compiler-libs.optcomp/Internal_variable_names/index.html">Internal_variable_names</a></li><li><a href="../../compiler-libs.optcomp/Interval/index.html">Interval</a></li><li><a href="../../compiler-libs.optcomp/Invariant_params/index.html">Invariant_params</a></li><li><a href="../../compiler-libs.optcomp/Lift_code/index.html">Lift_code</a></li><li><a href="../../compiler-libs.optcomp/Lift_constants/index.html">Lift_constants</a></li><li><a href="../../compiler-libs.optcomp/Lift_let_to_initialize_symbol/index.html">Lift_let_to_initialize_symbol</a></li><li><a href="../../compiler-libs.optcomp/Linear/index.html">Linear</a></li><li><a href="../../compiler-libs.optcomp/Linear_format/index.html">Linear_format</a></li><li><a href="../../compiler-libs.optcomp/Linearize/index.html">Linearize</a></li><li><a href="../../compiler-libs.optcomp/Linkage_name/index.html">Linkage_name</a></li><li><a href="../../compiler-libs.optcomp/Linscan/index.html">Linscan</a></li><li><a href="../../compiler-libs.optcomp/Liveness/index.html">Liveness</a></li><li><a href="../../compiler-libs.optcomp/Mach/index.html">Mach</a></li><li><a href="../../compiler-libs.optcomp/Mutable_variable/index.html">Mutable_variable</a></li><li><a href="../../compiler-libs.optcomp/Optcompile/index.html">Optcompile</a></li><li><a href="../../compiler-libs.optcomp/Opterrors/index.html">Opterrors</a></li><li><a href="../../compiler-libs.optcomp/Optmaindriver/index.html">Optmaindriver</a></li><li><a href="../../compiler-libs.optcomp/Parameter/index.html">Parameter</a></li><li><a href="../../compiler-libs.optcomp/Pass_wrapper/index.html">Pass_wrapper</a></li><li><a href="../../compiler-libs.optcomp/Polling/index.html">Polling</a></li><li><a href="../../compiler-libs.optcomp/Printclambda/index.html">Printclambda</a></li><li><a href="../../compiler-libs.optcomp/Printclambda_primitives/index.html">Printclambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Printcmm/index.html">Printcmm</a></li><li><a href="../../compiler-libs.optcomp/Printlinear/index.html">Printlinear</a></li><li><a href="../../compiler-libs.optcomp/Printmach/index.html">Printmach</a></li><li><a href="../../compiler-libs.optcomp/Proc/index.html">Proc</a></li><li><a href="../../compiler-libs.optcomp/Projection/index.html">Projection</a></li><li><a href="../../compiler-libs.optcomp/Ref_to_variables/index.html">Ref_to_variables</a></li><li><a href="../../compiler-libs.optcomp/Reg/index.html">Reg</a></li><li><a href="../../compiler-libs.optcomp/Reload/index.html">Reload</a></li><li><a href="../../compiler-libs.optcomp/Reloadgen/index.html">Reloadgen</a></li><li><a href="../../compiler-libs.optcomp/Remove_free_vars_equal_to_args/index.html">Remove_free_vars_equal_to_args</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_arguments/index.html">Remove_unused_arguments</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_closure_vars/index.html">Remove_unused_closure_vars</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_program_constructs/index.html">Remove_unused_program_constructs</a></li><li><a href="../../compiler-libs.optcomp/Schedgen/index.html">Schedgen</a></li><li><a href="../../compiler-libs.optcomp/Scheduling/index.html">Scheduling</a></li><li><a href="../../compiler-libs.optcomp/Selectgen/index.html">Selectgen</a></li><li><a href="../../compiler-libs.optcomp/Selection/index.html">Selection</a></li><li><a href="../../compiler-libs.optcomp/Semantics_of_primitives/index.html">Semantics_of_primitives</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_id/index.html">Set_of_closures_id</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_origin/index.html">Set_of_closures_origin</a></li><li><a href="../../compiler-libs.optcomp/Share_constants/index.html">Share_constants</a></li><li><a href="../../compiler-libs.optcomp/Simple_value_approx/index.html">Simple_value_approx</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops/index.html">Simplify_boxed_integer_ops</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops_intf/index.html">Simplify_boxed_integer_ops_intf</a></li><li><a href="../../compiler-libs.optcomp/Simplify_common/index.html">Simplify_common</a></li><li><a href="../../compiler-libs.optcomp/Simplify_primitives/index.html">Simplify_primitives</a></li><li><a href="../../compiler-libs.optcomp/Spill/index.html">Spill</a></li><li><a href="../../compiler-libs.optcomp/Split/index.html">Split</a></li><li><a href="../../compiler-libs.optcomp/Stackframe/index.html">Stackframe</a></li><li><a href="../../compiler-libs.optcomp/Stackframegen/index.html">Stackframegen</a></li><li><a href="../../compiler-libs.optcomp/Static_exception/index.html">Static_exception</a></li><li><a href="../../compiler-libs.optcomp/Strmatch/index.html">Strmatch</a></li><li><a href="../../compiler-libs.optcomp/Symbol/index.html">Symbol</a></li><li><a href="../../compiler-libs.optcomp/Tag/index.html">Tag</a></li><li><a href="../../compiler-libs.optcomp/Thread_sanitizer/index.html">Thread_sanitizer</a></li><li><a href="../../compiler-libs.optcomp/Traverse_for_exported_symbols/index.html">Traverse_for_exported_symbols</a></li><li><a href="../../compiler-libs.optcomp/Un_anf/index.html">Un_anf</a></li><li><a href="../../compiler-libs.optcomp/Unbox_closures/index.html">Unbox_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_free_vars_of_closures/index.html">Unbox_free_vars_of_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_specialised_args/index.html">Unbox_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Var_within_closure/index.html">Var_within_closure</a></li><li><a href="../../compiler-libs.optcomp/Variable/index.html">Variable</a></li></ul></li><li>Library <code>compiler-libs.toplevel</code><ul><li><a href="../../compiler-libs.toplevel/Genprintval/index.html">Genprintval</a></li><li><a href="../../compiler-libs.toplevel/Topcommon/index.html">Topcommon</a></li><li><a href="../../compiler-libs.toplevel/Topdirs/index.html">Topdirs</a></li><li><a href="../../compiler-libs.toplevel/Topeval/index.html">Topeval</a></li><li><a href="../../compiler-libs.toplevel/Toploop/index.html">Toploop</a></li><li><a href="../../compiler-libs.toplevel/Topmain/index.html">Topmain</a></li><li><a href="../../compiler-libs.toplevel/Topprinters/index.html">Topprinters</a></li><li><a href="../../compiler-libs.toplevel/Trace/index.html">Trace</a></li></ul></li><li>Library <code>dynlink</code><ul><li><a href="../../dynlink/Dynlink/index.html">Dynlink</a></li></ul></li><li>Library <code>runtime_events</code><ul><li><a href="../../runtime_events/Runtime_events/index.html">Runtime_events</a></li></ul></li><li>Library <code>stdlib</code><ul><li><a href="../../stdlib/CamlinternalFormat/index.html">CamlinternalFormat</a></li><li><a href="../../stdlib/CamlinternalFormatBasics/index.html">CamlinternalFormatBasics</a></li><li><a href="../../stdlib/CamlinternalLazy/index.html">CamlinternalLazy</a></li><li><a href="../../stdlib/CamlinternalMod/index.html">CamlinternalMod</a></li><li><a href="../../stdlib/CamlinternalOO/index.html">CamlinternalOO</a></li><li><a href="../../stdlib/Stdlib/index.html">Stdlib</a></li></ul></li><li>Library <code>str</code><ul><li><a href="../../str/Str/index.html">Str</a></li></ul></li><li>Library <code>threads</code><ul><li><a href="../../threads/Event/index.html">Event</a></li><li><a href="../../threads/Thread/index.html">Thread</a></li></ul></li><li>Library <code>unix</code><ul><li><a href="../../unix/Unix/index.html">Unix</a></li><li><a href="../../unix/UnixLabels/index.html">UnixLabels</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>stdlib<ul><li><a href="arg.ml.html">arg.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="arrayLabels.ml.html">arrayLabels.ml</a></li><li><a href="atomic.ml.html">atomic.ml</a></li><li><a href="bigarray.ml.html">bigarray.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="#" class="current_unit">bytes.ml</a></li><li><a href="bytesLabels.ml.html">bytesLabels.ml</a></li><li><a href="callback.ml.html">callback.ml</a></li><li><a href="camlinternalFormat.ml.html">camlinternalFormat.ml</a></li><li><a href="camlinternalFormatBasics.ml.html">camlinternalFormatBasics.ml</a></li><li><a href="camlinternalLazy.ml.html">camlinternalLazy.ml</a></li><li><a href="camlinternalMod.ml.html">camlinternalMod.ml</a></li><li><a href="camlinternalOO.ml.html">camlinternalOO.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="complex.ml.html">complex.ml</a></li><li><a href="condition.ml.html">condition.ml</a></li><li><a href="digest.ml.html">digest.ml</a></li><li><a href="domain.ml.html">domain.ml</a></li><li><a href="dynarray.ml.html">dynarray.ml</a></li><li><a href="effect.ml.html">effect.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="ephemeron.ml.html">ephemeron.ml</a></li><li><a href="filename.ml.html">filename.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="format.ml.html">format.ml</a></li><li><a href="fun.ml.html">fun.ml</a></li><li><a href="gc.ml.html">gc.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="in_channel.ml.html">in_channel.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="lexing.ml.html">lexing.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="listLabels.ml.html">listLabels.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="marshal.ml.html">marshal.ml</a></li><li><a href="moreLabels.ml.html">moreLabels.ml</a></li><li><a href="mutex.ml.html">mutex.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="obj.ml.html">obj.ml</a></li><li><a href="oo.ml.html">oo.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="out_channel.ml.html">out_channel.ml</a></li><li><a href="parsing.ml.html">parsing.ml</a></li><li><a href="printexc.ml.html">printexc.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="scanf.ml.html">scanf.ml</a></li><li><a href="semaphore.ml.html">semaphore.ml</a></li><li><a href="seq.ml.html">seq.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stdLabels.ml.html">stdLabels.ml</a></li><li><a href="stdlib.ml.html">stdlib.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="stringLabels.ml.html">stringLabels.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="type.ml.html">type.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="weak.ml.html">weak.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                 OCaml                                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*             Xavier Leroy, projet Cristal, INRIA Rocquencourt           *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   Copyright 1996 Institut National de Recherche en Informatique et     *)</span><span class="EOL">
</span><span class="COMMENT">(*     en Automatique.                                                    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   All rights reserved.  This file is distributed under the terms of    *)</span><span class="EOL">
</span><span class="COMMENT">(*   the GNU Lesser General Public License version 2.1, with the          *)</span><span class="EOL">
</span><span class="COMMENT">(*   special exception on linking described in the file LICENSE.          *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Byte sequence operations *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* WARNING: Some functions in this file are duplicated in string.ml for
   efficiency reasons. When you modify the one in this file you need to
   modify its duplicate in string.ml.
   These functions have a &quot;duplicated&quot; comment above their definition.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-length"><span class="EXTERNAL">external</span> <span class="LIDENT">length</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_length&quot;</span></span><span class="EOL">
</span><span id="val-string_length"><span class="EXTERNAL">external</span> <span class="LIDENT">string_length</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%string_length&quot;</span></span><span class="EOL">
</span><span id="val-get"><span class="EXTERNAL">external</span> <span class="LIDENT">get</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_safe_get&quot;</span></span><span class="EOL">
</span><span id="val-set"><span class="EXTERNAL">external</span> <span class="LIDENT">set</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_safe_set&quot;</span></span><span class="EOL">
</span><span id="val-create"><span class="EXTERNAL">external</span> <span class="LIDENT">create</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bytes</span> <span class="EQUAL">=</span> <span class="STRING">&quot;caml_create_bytes&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_get"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_unsafe_get&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_set"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_unsafe_set&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_fill"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_fill</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>                     <span class="EQUAL">=</span> <span class="STRING">&quot;caml_fill_bytes&quot;</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">noalloc</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span id="val-unsafe_to_string"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_to_string</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_to_string&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_of_string"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_of_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bytes</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_of_string&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_blit"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_blit</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>                     <span class="EQUAL">=</span> <span class="STRING">&quot;caml_blit_bytes&quot;</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">noalloc</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span id="val-unsafe_blit_string"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_blit_string</span> <span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>                     <span class="EQUAL">=</span> <span class="STRING">&quot;caml_blit_string&quot;</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">noalloc</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make"><span class="LIDENT">make</span></span> <span id="local_n_1"><span class="LIDENT">n</span></span> <span id="local_c_2"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_s_3"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_n_1"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">unsafe_fill</span> <a href="#local_s_3"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="#local_n_1"><span class="LIDENT">n</span></a> <a href="#local_c_2"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_s_3"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-init"><span class="LIDENT">init</span></span> <span id="local_n_4"><span class="LIDENT">n</span></span> <span id="local_f_5"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_s_6"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_n_4"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_n_4"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set</span> <a href="#local_s_6"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_f_5"><span class="LIDENT">f</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_s_6"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-empty"><span class="LIDENT">empty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-copy"><span class="LIDENT">copy</span></span> <span id="local_s_7"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_8"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_7"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_9"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_len_8"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">unsafe_blit</span> <a href="#local_s_7"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="#local_r_9"><span class="LIDENT">r</span></a> <span class="INT">0</span> <a href="#local_len_8"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_r_9"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_string"><span class="LIDENT">to_string</span></span> <span id="local_b_10"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_to_string</span> <span class="LPAREN">(</span><span class="LIDENT">copy</span> <a href="#local_b_10"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_string"><span class="LIDENT">of_string</span></span> <span id="local_s_11"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">copy</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_of_string</span> <a href="#local_s_11"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sub"><span class="LIDENT">sub</span></span> <span id="local_s_12"><span class="LIDENT">s</span></span> <span id="local_ofs_13"><span class="LIDENT">ofs</span></span> <span id="local_len_14"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_ofs_13"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_len_14"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs_13"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_s_12"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_14"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.sub / Bytes.sub&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_15"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_len_14"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_blit</span> <a href="#local_s_12"><span class="LIDENT">s</span></a> <a href="#local_ofs_13"><span class="LIDENT">ofs</span></a> <a href="#local_r_15"><span class="LIDENT">r</span></a> <span class="INT">0</span> <a href="#local_len_14"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_r_15"><span class="LIDENT">r</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sub_string"><span class="LIDENT">sub_string</span></span> <span id="local_b_16"><span class="LIDENT">b</span></span> <span id="local_ofs_17"><span class="LIDENT">ofs</span></span> <span id="local_len_18"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_to_string</span> <span class="LPAREN">(</span><span class="LIDENT">sub</span> <a href="#local_b_16"><span class="LIDENT">b</span></a> <a href="#local_ofs_17"><span class="LIDENT">ofs</span></a> <a href="#local_len_18"><span class="LIDENT">len</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* addition with an overflow check *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-(++)"><span class="LPAREN">(</span><span class="INFIXOP2">++</span><span class="RPAREN">)</span></span> <span id="local_a_19"><span class="LIDENT">a</span></span> <span id="local_b_20"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_c_21"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_a_19"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_b_20"><span class="LIDENT">b</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_a_19"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="COMMA">,</span> <a href="#local_b_20"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span><span class="COMMA">,</span> <a href="#local_c_21"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="TRUE">true</span> <span class="COMMA">,</span> <span class="TRUE">true</span> <span class="COMMA">,</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="TRUE">true</span>  <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Bytes.extend&quot;</span> <span class="COMMENT">(* overflow *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_c_21"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-extend"><span class="LIDENT">extend</span></span> <span id="local_s_22"><span class="LIDENT">s</span></span> <span id="local_left_23"><span class="LIDENT">left</span></span> <span id="local_right_24"><span class="LIDENT">right</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_25"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_22"><span class="LIDENT">s</span></a> <span class="INFIXOP2">++</span> <a href="#local_left_23"><span class="LIDENT">left</span></a> <span class="INFIXOP2">++</span> <a href="#local_right_24"><span class="LIDENT">right</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_26"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_len_25"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_394"><span class="LPAREN">(</span><span id="local_srcoff_27"><span class="LIDENT">srcoff</span></span><span class="COMMA">,</span> <span id="local_dstoff_28"><span class="LIDENT">dstoff</span></span><span class="RPAREN">)</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_left_23"><span class="LIDENT">left</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a><a href="#local_left_23"><span class="LIDENT">left</span></a><span class="COMMA">,</span> <span class="INT">0</span> <span class="ELSE">else</span> <span class="INT">0</span><span class="COMMA">,</span> <a href="#local_left_23"><span class="LIDENT">left</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_cpylen_29"><span class="LIDENT">cpylen</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_s_22"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_srcoff_27"><span class="LIDENT">srcoff</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_len_25"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_dstoff_28"><span class="LIDENT">dstoff</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_cpylen_29"><span class="LIDENT">cpylen</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LIDENT">unsafe_blit</span> <a href="#local_s_22"><span class="LIDENT">s</span></a> <a href="#local_srcoff_27"><span class="LIDENT">srcoff</span></a> <a href="#local_r_26"><span class="LIDENT">r</span></a> <a href="#local_dstoff_28"><span class="LIDENT">dstoff</span></a> <a href="#local_cpylen_29"><span class="LIDENT">cpylen</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_r_26"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fill"><span class="LIDENT">fill</span></span> <span id="local_s_30"><span class="LIDENT">s</span></span> <span id="local_ofs_31"><span class="LIDENT">ofs</span></span> <span id="local_len_32"><span class="LIDENT">len</span></span> <span id="local_c_33"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_ofs_31"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_len_32"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs_31"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_s_30"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_32"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.fill / Bytes.fill&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">unsafe_fill</span> <a href="#local_s_30"><span class="LIDENT">s</span></a> <a href="#local_ofs_31"><span class="LIDENT">ofs</span></a> <a href="#local_len_32"><span class="LIDENT">len</span></a> <a href="#local_c_33"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-blit"><span class="LIDENT">blit</span></span> <span id="local_s1_34"><span class="LIDENT">s1</span></span> <span id="local_ofs1_35"><span class="LIDENT">ofs1</span></span> <span id="local_s2_36"><span class="LIDENT">s2</span></span> <span id="local_ofs2_37"><span class="LIDENT">ofs2</span></span> <span id="local_len_38"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_len_38"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs1_35"><span class="LIDENT">ofs1</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs1_35"><span class="LIDENT">ofs1</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_s1_34"><span class="LIDENT">s1</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_38"><span class="LIDENT">len</span></a><span class="EOL">
</span>             <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs2_37"><span class="LIDENT">ofs2</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs2_37"><span class="LIDENT">ofs2</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_s2_36"><span class="LIDENT">s2</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_38"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Bytes.blit&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">unsafe_blit</span> <a href="#local_s1_34"><span class="LIDENT">s1</span></a> <a href="#local_ofs1_35"><span class="LIDENT">ofs1</span></a> <a href="#local_s2_36"><span class="LIDENT">s2</span></a> <a href="#local_ofs2_37"><span class="LIDENT">ofs2</span></a> <a href="#local_len_38"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-blit_string"><span class="LIDENT">blit_string</span></span> <span id="local_s1_39"><span class="LIDENT">s1</span></span> <span id="local_ofs1_40"><span class="LIDENT">ofs1</span></span> <span id="local_s2_41"><span class="LIDENT">s2</span></span> <span id="local_ofs2_42"><span class="LIDENT">ofs2</span></span> <span id="local_len_43"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_len_43"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs1_40"><span class="LIDENT">ofs1</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs1_40"><span class="LIDENT">ofs1</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">string_length</span> <a href="#local_s1_39"><span class="LIDENT">s1</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_43"><span class="LIDENT">len</span></a><span class="EOL">
</span>             <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs2_42"><span class="LIDENT">ofs2</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs2_42"><span class="LIDENT">ofs2</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_s2_41"><span class="LIDENT">s2</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_43"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.blit / Bytes.blit_string&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">unsafe_blit_string</span> <a href="#local_s1_39"><span class="LIDENT">s1</span></a> <a href="#local_ofs1_40"><span class="LIDENT">ofs1</span></a> <a href="#local_s2_41"><span class="LIDENT">s2</span></a> <a href="#local_ofs2_42"><span class="LIDENT">ofs2</span></a> <a href="#local_len_43"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iter"><span class="LIDENT">iter</span></span> <span id="local_f_44"><span class="LIDENT">f</span></span> <span id="local_a_45"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_a_45"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span> <a href="#local_f_44"><span class="LIDENT">f</span></a><span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a_45"><span class="LIDENT">a</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-iteri"><span class="LIDENT">iteri</span></span> <span id="local_f_46"><span class="LIDENT">f</span></span> <span id="local_a_47"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_a_47"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span> <a href="#local_f_46"><span class="LIDENT">f</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a_47"><span class="LIDENT">a</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ensure_ge"><span class="LIDENT">ensure_ge</span></span> <span class="LPAREN">(</span><span id="local_x_48"><span class="LIDENT">x</span></span><span class="COLON">:</span><span class="LIDENT">int</span><span class="RPAREN">)</span> <span id="local_y_49"><span class="LIDENT">y</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_x_48"><span class="LIDENT">x</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_y_49"><span class="LIDENT">y</span></a> <span class="THEN">then</span> <a href="#local_x_48"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Bytes.concat&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-sum_lengths"><span class="LIDENT">sum_lengths</span></span> <span id="local_acc_50"><span class="LIDENT">acc</span></span> <span id="local_seplen_51"><span class="LIDENT">seplen</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_acc_50"><span class="LIDENT">acc</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hd_52"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">length</span> <a href="#local_hd_52"><span class="LIDENT">hd</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_acc_50"><span class="LIDENT">acc</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hd_53"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span id="local_tl_54"><span class="LIDENT">tl</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">sum_lengths</span> <span class="LPAREN">(</span><span class="LIDENT">ensure_ge</span> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_hd_53"><span class="LIDENT">hd</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_seplen_51"><span class="LIDENT">seplen</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_acc_50"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span> <a href="#local_acc_50"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span> <a href="#local_seplen_51"><span class="LIDENT">seplen</span></a> <a href="#local_tl_54"><span class="LIDENT">tl</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-unsafe_blits"><span class="LIDENT">unsafe_blits</span></span> <span id="local_dst_55"><span class="LIDENT">dst</span></span> <span id="local_pos_56"><span class="LIDENT">pos</span></span> <span id="local_sep_57"><span class="LIDENT">sep</span></span> <span id="local_seplen_58"><span class="LIDENT">seplen</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_dst_55"><span class="LIDENT">dst</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hd_59"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_blit</span> <a href="#local_hd_59"><span class="LIDENT">hd</span></a> <span class="INT">0</span> <a href="#local_dst_55"><span class="LIDENT">dst</span></a> <a href="#local_pos_56"><span class="LIDENT">pos</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_hd_59"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span><span class="SEMI">;</span> <a href="#local_dst_55"><span class="LIDENT">dst</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hd_60"><span class="LIDENT">hd</span></span> <span class="COLONCOLON">::</span> <span id="local_tl_61"><span class="LIDENT">tl</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_blit</span> <a href="#local_hd_60"><span class="LIDENT">hd</span></a> <span class="INT">0</span> <a href="#local_dst_55"><span class="LIDENT">dst</span></a> <a href="#local_pos_56"><span class="LIDENT">pos</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_hd_60"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_blit</span> <a href="#local_sep_57"><span class="LIDENT">sep</span></a> <span class="INT">0</span> <a href="#local_dst_55"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_pos_56"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">length</span> <a href="#local_hd_60"><span class="LIDENT">hd</span></a><span class="RPAREN">)</span> <a href="#local_seplen_58"><span class="LIDENT">seplen</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_blits</span> <a href="#local_dst_55"><span class="LIDENT">dst</span></a> <span class="LPAREN">(</span><a href="#local_pos_56"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">length</span> <a href="#local_hd_60"><span class="LIDENT">hd</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_seplen_58"><span class="LIDENT">seplen</span></a><span class="RPAREN">)</span> <a href="#local_sep_57"><span class="LIDENT">sep</span></a> <a href="#local_seplen_58"><span class="LIDENT">seplen</span></a> <a href="#local_tl_61"><span class="LIDENT">tl</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-concat"><span class="LIDENT">concat</span></span> <span id="local_sep_62"><span class="LIDENT">sep</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">empty</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_l_63"><span class="LIDENT">l</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span id="local_seplen_64"><span class="LIDENT">seplen</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_sep_62"><span class="LIDENT">sep</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_blits</span><span class="EOL">
</span>            <span class="LPAREN">(</span><span class="LIDENT">create</span> <span class="LPAREN">(</span><span class="LIDENT">sum_lengths</span> <span class="INT">0</span> <a href="#local_seplen_64"><span class="LIDENT">seplen</span></a> <a href="#local_l_63"><span class="LIDENT">l</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="INT">0</span> <a href="#local_sep_62"><span class="LIDENT">sep</span></a> <a href="#local_seplen_64"><span class="LIDENT">seplen</span></a> <a href="#local_l_63"><span class="LIDENT">l</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-cat"><span class="LIDENT">cat</span></span> <span id="local_s1_65"><span class="LIDENT">s1</span></span> <span id="local_s2_66"><span class="LIDENT">s2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l1_67"><span class="LIDENT">l1</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s1_65"><span class="LIDENT">s1</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l2_68"><span class="LIDENT">l2</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s2_66"><span class="LIDENT">s2</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_69"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="LPAREN">(</span><a href="#local_l1_67"><span class="LIDENT">l1</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_l2_68"><span class="LIDENT">l2</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">unsafe_blit</span> <a href="#local_s1_65"><span class="LIDENT">s1</span></a> <span class="INT">0</span> <a href="#local_r_69"><span class="LIDENT">r</span></a> <span class="INT">0</span> <a href="#local_l1_67"><span class="LIDENT">l1</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">unsafe_blit</span> <a href="#local_s2_66"><span class="LIDENT">s2</span></a> <span class="INT">0</span> <a href="#local_r_69"><span class="LIDENT">r</span></a> <a href="#local_l1_67"><span class="LIDENT">l1</span></a> <a href="#local_l2_68"><span class="LIDENT">l2</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_r_69"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-char_code"><span class="EXTERNAL">external</span> <span class="LIDENT">char_code</span><span class="COLON">:</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%identity&quot;</span></span><span class="EOL">
</span><span id="val-char_chr"><span class="EXTERNAL">external</span> <span class="LIDENT">char_chr</span><span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%identity&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_space"><span class="LIDENT">is_space</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="BAR">|</span> <span class="CHAR">'\012'</span> <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="BAR">|</span> <span class="CHAR">'\t'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-trim"><span class="LIDENT">trim</span></span> <span id="local_s_70"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_71"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_70"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_i_72"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_72"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_len_71"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">is_space</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_70"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_72"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_i_72"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_j_73"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><a href="#local_len_71"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_73"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_72"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">is_space</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_70"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_73"><span class="LIDENT">j</span></a><span class="RPAREN">)</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_j_73"><span class="LIDENT">j</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_73"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_72"><span class="LIDENT">i</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <span class="LIDENT">sub</span> <a href="#local_s_70"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_72"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_73"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_i_72"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">empty</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_escape"><span class="LIDENT">unsafe_escape</span></span> <span id="local_s_74"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* We perform two passes on the input sequence, one to compute the
     result size and one to write the result.

     #11508, #11509: This logic would be incorrect in presence of
     concurrent modification to the input, making the use of
     [unsafe_set] below memory-unsafe.

     Precondition: This function may be safely called on:
     - an immutable byte sequence
     - a uniquely-owned byte sequence (the function takes ownership)

     In either case we return a uniquely-owned byte sequence.
  *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_75"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="#local_n_75"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span> <span class="WITH">with</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="CHAR">'\&quot;'</span> <span class="BAR">|</span> <span class="CHAR">'\\'</span> <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="BAR">|</span> <span class="CHAR">'\t'</span> <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="BAR">|</span> <span class="CHAR">'\b'</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">2</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="DOTDOT">..</span> <span class="CHAR">'~'</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">1</span><span class="EOL">
</span>       <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">length</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <a href="#local_s_74"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s'_76"><span class="LIDENT">s'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_n_75"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_74"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'\&quot;'</span> <span class="BAR">|</span> <span class="CHAR">'\\'</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_c_77"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'\\'</span><span class="SEMI">;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <a href="#local_c_77"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'\\'</span><span class="SEMI">;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'n'</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\t'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'\\'</span><span class="SEMI">;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'t'</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\r'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'\\'</span><span class="SEMI">;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'r'</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\b'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'\\'</span><span class="SEMI">;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'b'</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">' '</span> <span class="DOTDOT">..</span> <span class="CHAR">'~'</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_c_78"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <a href="#local_c_78"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_79"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_a_80"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span> <span class="LIDENT">char_code</span> <a href="#local_c_79"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="CHAR">'\\'</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_chr</span> <span class="LPAREN">(</span><span class="INT">48</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_a_80"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">100</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_chr</span> <span class="LPAREN">(</span><span class="INT">48</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_a_80"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">10</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <span class="INT">10</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">unsafe_set</span> <a href="#local_s'_76"><span class="LIDENT">s'</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_75"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_chr</span> <span class="LPAREN">(</span><span class="INT">48</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_a_80"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <span class="INT">10</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_75"><span class="LIDENT">n</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_s'_76"><span class="LIDENT">s'</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-escaped"><span class="LIDENT">escaped</span></span> <span id="local_b_81"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_b_82"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="LIDENT">copy</span> <a href="#local_b_81"><span class="LIDENT">b</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* We copy our input to obtain a uniquely-owned byte sequence [b]
     to satisfy [unsafe_escape]'s precondition *)</span><span class="EOL">
</span>  <span class="LIDENT">unsafe_escape</span> <a href="#local_b_82"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-map"><span class="LIDENT">map</span></span> <span id="local_f_83"><span class="LIDENT">f</span></span> <span id="local_s_84"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_85"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_84"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_l_85"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_s_84"><span class="LIDENT">s</span></a> <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_86"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_l_85"><span class="LIDENT">l</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_l_85"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span> <span class="LIDENT">unsafe_set</span> <a href="#local_r_86"><span class="LIDENT">r</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_f_83"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_84"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_r_86"><span class="LIDENT">r</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mapi"><span class="LIDENT">mapi</span></span> <span id="local_f_87"><span class="LIDENT">f</span></span> <span id="local_s_88"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_89"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_88"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_l_89"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_s_88"><span class="LIDENT">s</span></a> <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_90"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <a href="#local_l_89"><span class="LIDENT">l</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="#local_l_89"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span> <span class="LIDENT">unsafe_set</span> <a href="#local_r_90"><span class="LIDENT">r</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><a href="#local_f_87"><span class="LIDENT">f</span></a> <span class="LIDENT">i</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_88"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_r_90"><span class="LIDENT">r</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold_left"><span class="LIDENT">fold_left</span></span> <span id="local_f_91"><span class="LIDENT">f</span></span> <span id="local_x_92"><span class="LIDENT">x</span></span> <span id="local_a_93"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_94"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_x_92"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="LIDENT">length</span> <a href="#local_a_93"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="#local_r_94"><span class="LIDENT">r</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_f_91"><span class="LIDENT">f</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_94"><span class="LIDENT">r</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a_93"><span class="LIDENT">a</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_94"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fold_right"><span class="LIDENT">fold_right</span></span> <span id="local_f_95"><span class="LIDENT">f</span></span> <span id="local_a_96"><span class="LIDENT">a</span></span> <span id="local_x_97"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_98"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_x_97"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_a_96"><span class="LIDENT">a</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DOWNTO">downto</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="#local_r_98"><span class="LIDENT">r</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_f_95"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_a_96"><span class="LIDENT">a</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_98"><span class="LIDENT">r</span></a><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_98"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-exists"><span class="LIDENT">exists</span></span> <span id="local_p_99"><span class="LIDENT">p</span></span> <span id="local_s_100"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_101"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_100"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_102"><span class="LIDENT">loop</span></span> <span id="local_i_103"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_103"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_n_101"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_p_99"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_100"><span class="LIDENT">s</span></a> <a href="#local_i_103"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_loop_102"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_i_103"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_102"><span class="LIDENT">loop</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-for_all"><span class="LIDENT">for_all</span></span> <span id="local_p_104"><span class="LIDENT">p</span></span> <span id="local_s_105"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_106"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_105"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_107"><span class="LIDENT">loop</span></span> <span id="local_i_108"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_108"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_n_106"><span class="LIDENT">n</span></a> <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <a href="#local_p_104"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_105"><span class="LIDENT">s</span></a> <a href="#local_i_108"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_loop_107"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-succ"><span class="LIDENT">succ</span></a> <a href="#local_i_108"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_107"><span class="LIDENT">loop</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-uppercase_ascii"><span class="LIDENT">uppercase_ascii</span></span> <span id="local_s_109"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">map</span> <a href="char.ml.html#val-uppercase_ascii"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">uppercase_ascii</span></a> <a href="#local_s_109"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-lowercase_ascii"><span class="LIDENT">lowercase_ascii</span></span> <span id="local_s_110"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">map</span> <a href="char.ml.html#val-lowercase_ascii"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">lowercase_ascii</span></a> <a href="#local_s_110"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-apply1"><span class="LIDENT">apply1</span></span> <span id="local_f_111"><span class="LIDENT">f</span></span> <span id="local_s_112"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">length</span> <a href="#local_s_112"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_s_112"><span class="LIDENT">s</span></a> <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_r_113"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <span class="LIDENT">copy</span> <a href="#local_s_112"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set</span> <a href="#local_r_113"><span class="LIDENT">r</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="#local_f_111"><span class="LIDENT">f</span></a><span class="LPAREN">(</span><span class="LIDENT">unsafe_get</span> <a href="#local_s_112"><span class="LIDENT">s</span></a> <span class="INT">0</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_r_113"><span class="LIDENT">r</span></a><span class="EOL">
</span>  <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-capitalize_ascii"><span class="LIDENT">capitalize_ascii</span></span> <span id="local_s_114"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">apply1</span> <a href="char.ml.html#val-uppercase_ascii"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">uppercase_ascii</span></a> <a href="#local_s_114"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="LET">let</span> <span id="val-uncapitalize_ascii"><span class="LIDENT">uncapitalize_ascii</span></span> <span id="local_s_115"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">apply1</span> <a href="char.ml.html#val-lowercase_ascii"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">lowercase_ascii</span></a> <a href="#local_s_115"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-starts_with"><span class="LIDENT">starts_with</span></span> <span class="TILDE">~</span><span id="local_prefix_116"><span class="LIDENT">prefix</span></span> <span id="local_s_117"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_s_118"><span class="LIDENT">len_s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_117"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_len_pre_119"><span class="LIDENT">len_pre</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_prefix_116"><span class="LIDENT">prefix</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_120"><span class="LIDENT">aux</span></span> <span id="local_i_121"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_pre_119"><span class="LIDENT">len_pre</span></a> <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_117"><span class="LIDENT">s</span></a> <a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">unsafe_get</span> <a href="#local_prefix_116"><span class="LIDENT">prefix</span></a> <a href="#local_i_121"><span class="LIDENT">i</span></a> <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_aux_120"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span> <a href="#local_len_s_118"><span class="LIDENT">len_s</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_len_pre_119"><span class="LIDENT">len_pre</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_aux_120"><span class="LIDENT">aux</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-ends_with"><span class="LIDENT">ends_with</span></span> <span class="TILDE">~</span><span id="local_suffix_122"><span class="LIDENT">suffix</span></span> <span id="local_s_123"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_s_124"><span class="LIDENT">len_s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_123"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_len_suf_125"><span class="LIDENT">len_suf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_suffix_122"><span class="LIDENT">suffix</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_diff_126"><span class="LIDENT">diff</span></span> <span class="EQUAL">=</span> <a href="#local_len_s_124"><span class="LIDENT">len_s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_suf_125"><span class="LIDENT">len_suf</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_127"><span class="LIDENT">aux</span></span> <span id="local_i_128"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_128"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_suf_125"><span class="LIDENT">len_suf</span></a> <span class="THEN">then</span> <span class="TRUE">true</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_123"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><a href="#local_diff_126"><span class="LIDENT">diff</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_i_128"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="LIDENT">unsafe_get</span> <a href="#local_suffix_122"><span class="LIDENT">suffix</span></a> <a href="#local_i_128"><span class="LIDENT">i</span></a> <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_aux_127"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><a href="#local_i_128"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span> <a href="#local_diff_126"><span class="LIDENT">diff</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_aux_127"><span class="LIDENT">aux</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-index_rec"><span class="LIDENT">index_rec</span></span> <span id="local_s_129"><span class="LIDENT">s</span></span> <span id="local_lim_130"><span class="LIDENT">lim</span></span> <span id="local_i_131"><span class="LIDENT">i</span></span> <span id="local_c_132"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_131"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_lim_130"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_129"><span class="LIDENT">s</span></a> <a href="#local_i_131"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c_132"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <a href="#local_i_131"><span class="LIDENT">i</span></a> <span class="ELSE">else</span> <span class="LIDENT">index_rec</span> <a href="#local_s_129"><span class="LIDENT">s</span></a> <a href="#local_lim_130"><span class="LIDENT">lim</span></a> <span class="LPAREN">(</span><a href="#local_i_131"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_c_132"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-index"><span class="LIDENT">index</span></span> <span id="local_s_133"><span class="LIDENT">s</span></span> <span id="local_c_134"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">index_rec</span> <a href="#local_s_133"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_s_133"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_c_134"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-index_rec_opt"><span class="LIDENT">index_rec_opt</span></span> <span id="local_s_135"><span class="LIDENT">s</span></span> <span id="local_lim_136"><span class="LIDENT">lim</span></span> <span id="local_i_137"><span class="LIDENT">i</span></span> <span id="local_c_138"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_137"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_lim_136"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <span class="UIDENT">None</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_135"><span class="LIDENT">s</span></a> <a href="#local_i_137"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c_138"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <span class="UIDENT">Some</span> <a href="#local_i_137"><span class="LIDENT">i</span></a> <span class="ELSE">else</span> <span class="LIDENT">index_rec_opt</span> <a href="#local_s_135"><span class="LIDENT">s</span></a> <a href="#local_lim_136"><span class="LIDENT">lim</span></a> <span class="LPAREN">(</span><a href="#local_i_137"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_c_138"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-index_opt"><span class="LIDENT">index_opt</span></span> <span id="local_s_139"><span class="LIDENT">s</span></span> <span id="local_c_140"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">index_rec_opt</span> <a href="#local_s_139"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_s_139"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_c_140"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-index_from"><span class="LIDENT">index_from</span></span> <span id="local_s_141"><span class="LIDENT">s</span></span> <span id="local_i_142"><span class="LIDENT">i</span></span> <span id="local_c_143"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_144"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_141"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_142"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_142"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_l_144"><span class="LIDENT">l</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.index_from / Bytes.index_from&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LIDENT">index_rec</span> <a href="#local_s_141"><span class="LIDENT">s</span></a> <a href="#local_l_144"><span class="LIDENT">l</span></a> <a href="#local_i_142"><span class="LIDENT">i</span></a> <a href="#local_c_143"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-index_from_opt"><span class="LIDENT">index_from_opt</span></span> <span id="local_s_145"><span class="LIDENT">s</span></span> <span id="local_i_146"><span class="LIDENT">i</span></span> <span id="local_c_147"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_148"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_145"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_146"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_146"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_l_148"><span class="LIDENT">l</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.index_from_opt / Bytes.index_from_opt&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">index_rec_opt</span> <a href="#local_s_145"><span class="LIDENT">s</span></a> <a href="#local_l_148"><span class="LIDENT">l</span></a> <a href="#local_i_146"><span class="LIDENT">i</span></a> <a href="#local_c_147"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-rindex_rec"><span class="LIDENT">rindex_rec</span></span> <span id="local_s_149"><span class="LIDENT">s</span></span> <span id="local_i_150"><span class="LIDENT">i</span></span> <span id="local_c_151"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_150"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_149"><span class="LIDENT">s</span></a> <a href="#local_i_150"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c_151"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <a href="#local_i_150"><span class="LIDENT">i</span></a> <span class="ELSE">else</span> <span class="LIDENT">rindex_rec</span> <a href="#local_s_149"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><a href="#local_i_150"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_c_151"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rindex"><span class="LIDENT">rindex</span></span> <span id="local_s_152"><span class="LIDENT">s</span></span> <span id="local_c_153"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">rindex_rec</span> <a href="#local_s_152"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_s_152"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_c_153"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rindex_from"><span class="LIDENT">rindex_from</span></span> <span id="local_s_154"><span class="LIDENT">s</span></span> <span id="local_i_155"><span class="LIDENT">i</span></span> <span id="local_c_156"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_155"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="MINUS">-</span><span class="INT">1</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_155"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">length</span> <a href="#local_s_154"><span class="LIDENT">s</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.rindex_from / Bytes.rindex_from&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">rindex_rec</span> <a href="#local_s_154"><span class="LIDENT">s</span></a> <a href="#local_i_155"><span class="LIDENT">i</span></a> <a href="#local_c_156"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-rindex_rec_opt"><span class="LIDENT">rindex_rec_opt</span></span> <span id="local_s_157"><span class="LIDENT">s</span></span> <span id="local_i_158"><span class="LIDENT">i</span></span> <span id="local_c_159"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_158"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="UIDENT">None</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_157"><span class="LIDENT">s</span></a> <a href="#local_i_158"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c_159"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <span class="UIDENT">Some</span> <a href="#local_i_158"><span class="LIDENT">i</span></a> <span class="ELSE">else</span> <span class="LIDENT">rindex_rec_opt</span> <a href="#local_s_157"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><a href="#local_i_158"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_c_159"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rindex_opt"><span class="LIDENT">rindex_opt</span></span> <span id="local_s_160"><span class="LIDENT">s</span></span> <span id="local_c_161"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">rindex_rec_opt</span> <a href="#local_s_160"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_s_160"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_c_161"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rindex_from_opt"><span class="LIDENT">rindex_from_opt</span></span> <span id="local_s_162"><span class="LIDENT">s</span></span> <span id="local_i_163"><span class="LIDENT">i</span></span> <span id="local_c_164"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_163"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="MINUS">-</span><span class="INT">1</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_163"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">length</span> <a href="#local_s_162"><span class="LIDENT">s</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.rindex_from_opt / Bytes.rindex_from_opt&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">rindex_rec_opt</span> <a href="#local_s_162"><span class="LIDENT">s</span></a> <a href="#local_i_163"><span class="LIDENT">i</span></a> <a href="#local_c_164"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-contains_from"><span class="LIDENT">contains_from</span></span> <span id="local_s_165"><span class="LIDENT">s</span></span> <span id="local_i_166"><span class="LIDENT">i</span></span> <span id="local_c_167"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_168"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_165"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_166"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_166"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_l_168"><span class="LIDENT">l</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.contains_from / Bytes.contains_from&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="TRY">try</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <span class="LPAREN">(</span><span class="LIDENT">index_rec</span> <a href="#local_s_165"><span class="LIDENT">s</span></a> <a href="#local_l_168"><span class="LIDENT">l</span></a> <a href="#local_i_166"><span class="LIDENT">i</span></a> <a href="#local_c_167"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="TRUE">true</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-contains"><span class="LIDENT">contains</span></span> <span id="local_s_169"><span class="LIDENT">s</span></span> <span id="local_c_170"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <span class="LIDENT">contains_from</span> <a href="#local_s_169"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="#local_c_170"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rcontains_from"><span class="LIDENT">rcontains_from</span></span> <span id="local_s_171"><span class="LIDENT">s</span></span> <span id="local_i_172"><span class="LIDENT">i</span></span> <span id="local_c_173"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_172"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_172"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <span class="LIDENT">length</span> <a href="#local_s_171"><span class="LIDENT">s</span></a> <span class="THEN">then</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;String.rcontains_from / Bytes.rcontains_from&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <span class="TRY">try</span> <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <span class="LPAREN">(</span><span class="LIDENT">rindex_rec</span> <a href="#local_s_171"><span class="LIDENT">s</span></a> <a href="#local_i_172"><span class="LIDENT">i</span></a> <a href="#local_c_173"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="TRUE">true</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">bytes</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-compare"><span class="LIDENT">compare</span></span> <span class="LPAREN">(</span><span id="local_x_174"><span class="LIDENT">x</span></span><span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_y_175"><span class="LIDENT">y</span></span><span class="COLON">:</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-compare"><span class="UIDENT">Stdlib</span><span class="DOT">.</span><span class="LIDENT">compare</span></a> <a href="#local_x_174"><span class="LIDENT">x</span></a> <a href="#local_y_175"><span class="LIDENT">y</span></a><span class="EOL">
</span><span id="val-equal"><span class="EXTERNAL">external</span> <span class="LIDENT">equal</span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span> <span class="STRING">&quot;caml_bytes_equal&quot;</span> <span class="LBRACKETATAT">[@@</span><span class="LIDENT">noalloc</span><span class="RBRACKET">]</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* duplicated in string.ml *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-split_on_char"><span class="LIDENT">split_on_char</span></span> <span id="local_sep_176"><span class="LIDENT">sep</span></span> <span id="local_s_177"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_r_178"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_j_179"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_s_177"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DOWNTO">downto</span> <span class="INT">0</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">unsafe_get</span> <a href="#local_s_177"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_sep_176"><span class="LIDENT">sep</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>      <a href="#local_r_178"><span class="LIDENT">r</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">sub</span> <a href="#local_s_177"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="LIDENT">i</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_179"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="LIDENT">i</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_178"><span class="LIDENT">r</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_j_179"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="LIDENT">i</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">sub</span> <a href="#local_s_177"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_j_179"><span class="LIDENT">j</span></a> <span class="COLONCOLON">::</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_r_178"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** {1 Iterators} *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_seq"><span class="LIDENT">to_seq</span></span> <span id="local_s_180"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_181"><span class="LIDENT">aux</span></span> <span id="local_i_182"><span class="LIDENT">i</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_182"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">length</span> <a href="#local_s_180"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Nil</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_x_183"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_s_180"><span class="LIDENT">s</span></a> <a href="#local_i_182"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_183"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_aux_181"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><a href="#local_i_182"><span class="LIDENT">i</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_aux_181"><span class="LIDENT">aux</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_seqi"><span class="LIDENT">to_seqi</span></span> <span id="local_s_184"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_185"><span class="LIDENT">aux</span></span> <span id="local_i_186"><span class="LIDENT">i</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_186"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">length</span> <a href="#local_s_184"><span class="LIDENT">s</span></a> <span class="THEN">then</span> <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Nil</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_x_187"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get</span> <a href="#local_s_184"><span class="LIDENT">s</span></a> <a href="#local_i_186"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_i_186"><span class="LIDENT">i</span></a><span class="COMMA">,</span><a href="#local_x_187"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_aux_185"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><a href="#local_i_186"><span class="LIDENT">i</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_aux_185"><span class="LIDENT">aux</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_seq"><span class="LIDENT">of_seq</span></span> <span id="local_i_188"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_189"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_190"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LIDENT">make</span> <span class="INT">256</span> <span class="CHAR">'\000'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_resize_191"><span class="LIDENT">resize</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* resize *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_len_192"><span class="LIDENT">new_len</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-min"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">min</span></a> <span class="LPAREN">(</span><span class="INT">2</span> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="LIDENT">length</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_buf_190"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">length</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_buf_190"><span class="LIDENT">buf</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_new_len_192"><span class="LIDENT">new_len</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Bytes.of_seq: cannot grow bytes&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_buf_193"><span class="LIDENT">new_buf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">make</span> <a href="#local_new_len_192"><span class="LIDENT">new_len</span></a> <span class="CHAR">'\000'</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">blit</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_buf_190"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="#local_new_buf_193"><span class="LIDENT">new_buf</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_189"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_buf_190"><span class="LIDENT">buf</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="#local_new_buf_193"><span class="LIDENT">new_buf</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="seq.ml.html#val-iter"><span class="UIDENT">Seq</span><span class="DOT">.</span><span class="LIDENT">iter</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_c_194"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>       <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_189"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="LIDENT">length</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_buf_190"><span class="LIDENT">buf</span></a> <span class="THEN">then</span> <a href="#local_resize_191"><span class="LIDENT">resize</span></a><span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <span class="LIDENT">set</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_buf_190"><span class="LIDENT">buf</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_189"><span class="LIDENT">n</span></a> <a href="#local_c_194"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>       <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_189"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <a href="#local_i_188"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">sub</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_buf_190"><span class="LIDENT">buf</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_189"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** {6 Binary encoding/decoding of integers} *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The get_ functions are all duplicated in string.ml *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_get_uint8"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get_uint8</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_unsafe_get&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_get_uint16_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_get_uint16_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_get16u&quot;</span></span><span class="EOL">
</span><span id="val-get_uint8"><span class="EXTERNAL">external</span> <span class="LIDENT">get_uint8</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_safe_get&quot;</span></span><span class="EOL">
</span><span id="val-get_uint16_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">get_uint16_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_get16&quot;</span></span><span class="EOL">
</span><span id="val-get_int32_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">get_int32_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_get32&quot;</span></span><span class="EOL">
</span><span id="val-get_int64_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">get_int64_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_get64&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_set_uint8"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_uint8</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_unsafe_set&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_set_uint16_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_uint16_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span><span class="EOL">
</span>                              <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set16u&quot;</span></span><span class="EOL">
</span><span id="val-set_int8"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int8</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_safe_set&quot;</span></span><span class="EOL">
</span><span id="val-set_int16_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int16_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set16&quot;</span></span><span class="EOL">
</span><span id="val-set_int32_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int32_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set32&quot;</span></span><span class="EOL">
</span><span id="val-set_int64_ne"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int64_ne</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set64&quot;</span></span><span class="EOL">
</span><span id="val-swap16"><span class="EXTERNAL">external</span> <span class="LIDENT">swap16</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap16&quot;</span></span><span class="EOL">
</span><span id="val-swap32"><span class="EXTERNAL">external</span> <span class="LIDENT">swap32</span> <span class="COLON">:</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap_int32&quot;</span></span><span class="EOL">
</span><span id="val-swap64"><span class="EXTERNAL">external</span> <span class="LIDENT">swap64</span> <span class="COLON">:</span> <span class="LIDENT">int64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap_int64&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_get_uint16_le"><span class="LIDENT">unsafe_get_uint16_le</span></span> <span id="local_b_195"><span class="LIDENT">b</span></span> <span id="local_i_196"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">swap16</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint16_ne</span> <a href="#local_b_195"><span class="LIDENT">b</span></a> <a href="#local_i_196"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">unsafe_get_uint16_ne</span> <a href="#local_b_195"><span class="LIDENT">b</span></a> <a href="#local_i_196"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_get_uint16_be"><span class="LIDENT">unsafe_get_uint16_be</span></span> <span id="local_b_197"><span class="LIDENT">b</span></span> <span id="local_i_198"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">unsafe_get_uint16_ne</span> <a href="#local_b_197"><span class="LIDENT">b</span></a> <a href="#local_i_198"><span class="LIDENT">i</span></a><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">swap16</span> <span class="LPAREN">(</span><span class="LIDENT">unsafe_get_uint16_ne</span> <a href="#local_b_197"><span class="LIDENT">b</span></a> <a href="#local_i_198"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int8"><span class="LIDENT">get_int8</span></span> <span id="local_b_199"><span class="LIDENT">b</span></span> <span id="local_i_200"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">get_uint8</span> <a href="#local_b_199"><span class="LIDENT">b</span></a> <a href="#local_i_200"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">8</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_uint16_le"><span class="LIDENT">get_uint16_le</span></span> <span id="local_b_201"><span class="LIDENT">b</span></span> <span id="local_i_202"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap16</span> <span class="LPAREN">(</span><span class="LIDENT">get_uint16_ne</span> <a href="#local_b_201"><span class="LIDENT">b</span></a> <a href="#local_i_202"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">get_uint16_ne</span> <a href="#local_b_201"><span class="LIDENT">b</span></a> <a href="#local_i_202"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_uint16_be"><span class="LIDENT">get_uint16_be</span></span> <span id="local_b_203"><span class="LIDENT">b</span></span> <span id="local_i_204"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap16</span> <span class="LPAREN">(</span><span class="LIDENT">get_uint16_ne</span> <a href="#local_b_203"><span class="LIDENT">b</span></a> <a href="#local_i_204"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">get_uint16_ne</span> <a href="#local_b_203"><span class="LIDENT">b</span></a> <a href="#local_i_204"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int16_ne"><span class="LIDENT">get_int16_ne</span></span> <span id="local_b_205"><span class="LIDENT">b</span></span> <span id="local_i_206"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">get_uint16_ne</span> <a href="#local_b_205"><span class="LIDENT">b</span></a> <a href="#local_i_206"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int16_le"><span class="LIDENT">get_int16_le</span></span> <span id="local_b_207"><span class="LIDENT">b</span></span> <span id="local_i_208"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">get_uint16_le</span> <a href="#local_b_207"><span class="LIDENT">b</span></a> <a href="#local_i_208"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int16_be"><span class="LIDENT">get_int16_be</span></span> <span id="local_b_209"><span class="LIDENT">b</span></span> <span id="local_i_210"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">get_uint16_be</span> <a href="#local_b_209"><span class="LIDENT">b</span></a> <a href="#local_i_210"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(asr)"><span class="INFIXOP4">asr</span></a> <span class="LPAREN">(</span><a href="sys.ml.html#val-int_size"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">int_size</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">16</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int32_le"><span class="LIDENT">get_int32_le</span></span> <span id="local_b_211"><span class="LIDENT">b</span></span> <span id="local_i_212"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap32</span> <span class="LPAREN">(</span><span class="LIDENT">get_int32_ne</span> <a href="#local_b_211"><span class="LIDENT">b</span></a> <a href="#local_i_212"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">get_int32_ne</span> <a href="#local_b_211"><span class="LIDENT">b</span></a> <a href="#local_i_212"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int32_be"><span class="LIDENT">get_int32_be</span></span> <span id="local_b_213"><span class="LIDENT">b</span></span> <span id="local_i_214"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap32</span> <span class="LPAREN">(</span><span class="LIDENT">get_int32_ne</span> <a href="#local_b_213"><span class="LIDENT">b</span></a> <a href="#local_i_214"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">get_int32_ne</span> <a href="#local_b_213"><span class="LIDENT">b</span></a> <a href="#local_i_214"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int64_le"><span class="LIDENT">get_int64_le</span></span> <span id="local_b_215"><span class="LIDENT">b</span></span> <span id="local_i_216"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap64</span> <span class="LPAREN">(</span><span class="LIDENT">get_int64_ne</span> <a href="#local_b_215"><span class="LIDENT">b</span></a> <a href="#local_i_216"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">get_int64_ne</span> <a href="#local_b_215"><span class="LIDENT">b</span></a> <a href="#local_i_216"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_int64_be"><span class="LIDENT">get_int64_be</span></span> <span id="local_b_217"><span class="LIDENT">b</span></span> <span id="local_i_218"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap64</span> <span class="LPAREN">(</span><span class="LIDENT">get_int64_ne</span> <a href="#local_b_217"><span class="LIDENT">b</span></a> <a href="#local_i_218"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">get_int64_ne</span> <a href="#local_b_217"><span class="LIDENT">b</span></a> <a href="#local_i_218"><span class="LIDENT">i</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_set_uint16_le"><span class="LIDENT">unsafe_set_uint16_le</span></span> <span id="local_b_219"><span class="LIDENT">b</span></span> <span id="local_i_220"><span class="LIDENT">i</span></span> <span id="local_x_221"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">unsafe_set_uint16_ne</span> <a href="#local_b_219"><span class="LIDENT">b</span></a> <a href="#local_i_220"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap16</span> <a href="#local_x_221"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">unsafe_set_uint16_ne</span> <a href="#local_b_219"><span class="LIDENT">b</span></a> <a href="#local_i_220"><span class="LIDENT">i</span></a> <a href="#local_x_221"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_set_uint16_be"><span class="LIDENT">unsafe_set_uint16_be</span></span> <span id="local_b_222"><span class="LIDENT">b</span></span> <span id="local_i_223"><span class="LIDENT">i</span></span> <span id="local_x_224"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LIDENT">unsafe_set_uint16_ne</span> <a href="#local_b_222"><span class="LIDENT">b</span></a> <a href="#local_i_223"><span class="LIDENT">i</span></a> <a href="#local_x_224"><span class="LIDENT">x</span></a> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="LIDENT">unsafe_set_uint16_ne</span> <a href="#local_b_222"><span class="LIDENT">b</span></a> <a href="#local_i_223"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap16</span> <a href="#local_x_224"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_int16_le"><span class="LIDENT">set_int16_le</span></span> <span id="local_b_225"><span class="LIDENT">b</span></span> <span id="local_i_226"><span class="LIDENT">i</span></span> <span id="local_x_227"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">set_int16_ne</span> <a href="#local_b_225"><span class="LIDENT">b</span></a> <a href="#local_i_226"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap16</span> <a href="#local_x_227"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">set_int16_ne</span> <a href="#local_b_225"><span class="LIDENT">b</span></a> <a href="#local_i_226"><span class="LIDENT">i</span></a> <a href="#local_x_227"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_int16_be"><span class="LIDENT">set_int16_be</span></span> <span id="local_b_228"><span class="LIDENT">b</span></span> <span id="local_i_229"><span class="LIDENT">i</span></span> <span id="local_x_230"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">set_int16_ne</span> <a href="#local_b_228"><span class="LIDENT">b</span></a> <a href="#local_i_229"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap16</span> <a href="#local_x_230"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">set_int16_ne</span> <a href="#local_b_228"><span class="LIDENT">b</span></a> <a href="#local_i_229"><span class="LIDENT">i</span></a> <a href="#local_x_230"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_int32_le"><span class="LIDENT">set_int32_le</span></span> <span id="local_b_231"><span class="LIDENT">b</span></span> <span id="local_i_232"><span class="LIDENT">i</span></span> <span id="local_x_233"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">set_int32_ne</span> <a href="#local_b_231"><span class="LIDENT">b</span></a> <a href="#local_i_232"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap32</span> <a href="#local_x_233"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">set_int32_ne</span> <a href="#local_b_231"><span class="LIDENT">b</span></a> <a href="#local_i_232"><span class="LIDENT">i</span></a> <a href="#local_x_233"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_int32_be"><span class="LIDENT">set_int32_be</span></span> <span id="local_b_234"><span class="LIDENT">b</span></span> <span id="local_i_235"><span class="LIDENT">i</span></span> <span id="local_x_236"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">set_int32_ne</span> <a href="#local_b_234"><span class="LIDENT">b</span></a> <a href="#local_i_235"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap32</span> <a href="#local_x_236"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">set_int32_ne</span> <a href="#local_b_234"><span class="LIDENT">b</span></a> <a href="#local_i_235"><span class="LIDENT">i</span></a> <a href="#local_x_236"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_int64_le"><span class="LIDENT">set_int64_le</span></span> <span id="local_b_237"><span class="LIDENT">b</span></span> <span id="local_i_238"><span class="LIDENT">i</span></span> <span id="local_x_239"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">set_int64_ne</span> <a href="#local_b_237"><span class="LIDENT">b</span></a> <a href="#local_i_238"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap64</span> <a href="#local_x_239"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">set_int64_ne</span> <a href="#local_b_237"><span class="LIDENT">b</span></a> <a href="#local_i_238"><span class="LIDENT">i</span></a> <a href="#local_x_239"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_int64_be"><span class="LIDENT">set_int64_be</span></span> <span id="local_b_240"><span class="LIDENT">b</span></span> <span id="local_i_241"><span class="LIDENT">i</span></span> <span id="local_x_242"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">set_int64_ne</span> <a href="#local_b_240"><span class="LIDENT">b</span></a> <a href="#local_i_241"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="LIDENT">swap64</span> <a href="#local_x_242"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LIDENT">set_int64_ne</span> <a href="#local_b_240"><span class="LIDENT">b</span></a> <a href="#local_i_241"><span class="LIDENT">i</span></a> <a href="#local_x_242"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_uint8"><span class="LIDENT">set_uint8</span></span> <span class="EQUAL">=</span> <span class="LIDENT">set_int8</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_uint16_ne"><span class="LIDENT">set_uint16_ne</span></span> <span class="EQUAL">=</span> <span class="LIDENT">set_int16_ne</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_uint16_be"><span class="LIDENT">set_uint16_be</span></span> <span class="EQUAL">=</span> <span class="LIDENT">set_int16_be</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_uint16_le"><span class="LIDENT">set_uint16_le</span></span> <span class="EQUAL">=</span> <span class="LIDENT">set_int16_le</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* UTF codecs and validations *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-dec_invalid"><span class="LIDENT">dec_invalid</span></span> <span class="EQUAL">=</span> <a href="uchar.ml.html#val-utf_decode_invalid"><span class="UIDENT">Uchar</span><span class="DOT">.</span><span class="LIDENT">utf_decode_invalid</span></a><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-dec_ret"><span class="LIDENT">dec_ret</span></span> <span id="local_n_243"><span class="LIDENT">n</span></span> <span id="local_u_244"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span> <a href="uchar.ml.html#val-utf_decode"><span class="UIDENT">Uchar</span><span class="DOT">.</span><span class="LIDENT">utf_decode</span></a> <a href="#local_n_243"><span class="LIDENT">n</span></a> <span class="LPAREN">(</span><a href="uchar.ml.html#val-unsafe_of_int"><span class="UIDENT">Uchar</span><span class="DOT">.</span><span class="LIDENT">unsafe_of_int</span></a> <a href="#local_u_244"><span class="LIDENT">u</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* In case of decoding error, if we error on the first byte, we
   consume the byte, otherwise we consume the [n] bytes preceding
   the erroring byte.

   This means that if a client uses decodes without caring about
   validity it naturally replace bogus data with Uchar.rep according
   to the WHATWG Encoding standard. Other schemes are possible by
   consulting the number of used bytes on invalid decodes. For more
   details see https://hsivonen.fi/broken-utf-8/

   For this reason in [get_utf_8_uchar] we gradually check the next
   byte is available rather than doing it immediately after the
   first byte. Contrast with [is_valid_utf_8]. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* UTF-8 *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-not_in_x80_to_xBF"><span class="LIDENT">not_in_x80_to_xBF</span></span> <span id="local_b_245"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_245"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">6</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0b10</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-not_in_xA0_to_xBF"><span class="LIDENT">not_in_xA0_to_xBF</span></span> <span id="local_b_246"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_246"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">5</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0b101</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-not_in_x80_to_x9F"><span class="LIDENT">not_in_x80_to_x9F</span></span> <span id="local_b_247"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_247"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">5</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0b100</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-not_in_x90_to_xBF"><span class="LIDENT">not_in_x90_to_xBF</span></span> <span id="local_b_248"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_248"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0x90</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="INT">0xBF</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_b_248"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-not_in_x80_to_x8F"><span class="LIDENT">not_in_x80_to_x8F</span></span> <span id="local_b_249"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_249"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">4</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0x8</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-utf_8_uchar_2"><span class="LIDENT">utf_8_uchar_2</span></span> <span id="local_b0_250"><span class="LIDENT">b0</span></span> <span id="local_b1_251"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b0_250"><span class="LIDENT">b0</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x1F</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">6</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b1_251"><span class="LIDENT">b1</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-utf_8_uchar_3"><span class="LIDENT">utf_8_uchar_3</span></span> <span id="local_b0_252"><span class="LIDENT">b0</span></span> <span id="local_b1_253"><span class="LIDENT">b1</span></span> <span id="local_b2_254"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b0_252"><span class="LIDENT">b0</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x0F</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">12</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b1_253"><span class="LIDENT">b1</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">6</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b2_254"><span class="LIDENT">b2</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span><span class="LBRACKETAT">[@</span><span class="LIDENT">inline</span><span class="RBRACKET">]</span> <span id="val-utf_8_uchar_4"><span class="LIDENT">utf_8_uchar_4</span></span> <span id="local_b0_255"><span class="LIDENT">b0</span></span> <span id="local_b1_256"><span class="LIDENT">b1</span></span> <span id="local_b2_257"><span class="LIDENT">b2</span></span> <span id="local_b3_258"><span class="LIDENT">b3</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b0_255"><span class="LIDENT">b0</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x07</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">18</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b1_256"><span class="LIDENT">b1</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">12</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b2_257"><span class="LIDENT">b2</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">6</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_b3_258"><span class="LIDENT">b3</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_utf_8_uchar"><span class="LIDENT">get_utf_8_uchar</span></span> <span id="local_b_259"><span class="LIDENT">b</span></span> <span id="local_i_260"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_b0_261"><span class="LIDENT">b0</span></span> <span class="EQUAL">=</span> <span class="LIDENT">get_uint8</span> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_260"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="COMMENT">(* raises if [i] is not a valid index. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_get_262"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_263"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="char.ml.html#val-unsafe_chr"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">unsafe_chr</span></a> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <span class="WITH">with</span> <span class="COMMENT">(* See The Unicode Standard, Table 3.7 *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\x00'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\x7F'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_ret</span> <span class="INT">1</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xC2'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xDF'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_264"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_264"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_265"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_264"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b1_265"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">2</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_2</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_265"><span class="LIDENT">b1</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xE0'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_266"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_266"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_267"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_266"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_xA0_to_xBF</span> <a href="#local_b1_267"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_268"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_266"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_268"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b2_269"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_268"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b2_269"><span class="LIDENT">b2</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">3</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_3</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_267"><span class="LIDENT">b1</span></a> <a href="#local_b2_269"><span class="LIDENT">b2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xE1'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xEC'</span> <span class="BAR">|</span> <span class="CHAR">'\xEE'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xEF'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_270"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_270"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_271"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_270"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b1_271"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_272"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_270"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_272"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b2_273"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_272"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b2_273"><span class="LIDENT">b2</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">3</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_3</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_271"><span class="LIDENT">b1</span></a> <a href="#local_b2_273"><span class="LIDENT">b2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xED'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_274"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_274"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_275"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_274"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_x9F</span> <a href="#local_b1_275"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_276"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_274"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_276"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b2_277"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_276"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b2_277"><span class="LIDENT">b2</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">3</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_3</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_275"><span class="LIDENT">b1</span></a> <a href="#local_b2_277"><span class="LIDENT">b2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xF0'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_278"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_278"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_279"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_278"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x90_to_xBF</span> <a href="#local_b1_279"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_280"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_278"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_280"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b2_281"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_280"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b2_281"><span class="LIDENT">b2</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_282"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_280"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_282"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">3</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b3_283"><span class="LIDENT">b3</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_282"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b3_283"><span class="LIDENT">b3</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">3</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">4</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_4</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_279"><span class="LIDENT">b1</span></a> <a href="#local_b2_281"><span class="LIDENT">b2</span></a> <a href="#local_b3_283"><span class="LIDENT">b3</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xF1'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xF3'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_284"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_284"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_285"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_284"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b1_285"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_286"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_284"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_286"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b2_287"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_286"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b2_287"><span class="LIDENT">b2</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_288"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_286"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_288"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">3</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b3_289"><span class="LIDENT">b3</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_288"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b3_289"><span class="LIDENT">b3</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">3</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">4</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_4</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_285"><span class="LIDENT">b1</span></a> <a href="#local_b2_287"><span class="LIDENT">b2</span></a> <a href="#local_b3_289"><span class="LIDENT">b3</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'\xF4'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_290"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_260"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_290"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b1_291"><span class="LIDENT">b1</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_290"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_x8F</span> <a href="#local_b1_291"><span class="LIDENT">b1</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_292"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_290"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_292"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b2_293"><span class="LIDENT">b2</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_292"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b2_293"><span class="LIDENT">b2</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_i_294"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <a href="#local_i_292"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span> <span class="IF">if</span> <a href="#local_i_294"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_263"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">3</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_b3_295"><span class="LIDENT">b3</span></span> <span class="EQUAL">=</span> <a href="#local_get_262"><span class="LIDENT">get</span></a> <a href="#local_b_259"><span class="LIDENT">b</span></a> <a href="#local_i_294"><span class="LIDENT">i</span></a> <span class="IN">in</span> <span class="IF">if</span> <span class="LIDENT">not_in_x80_to_xBF</span> <a href="#local_b3_295"><span class="LIDENT">b3</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">3</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LIDENT">dec_ret</span> <span class="INT">4</span> <span class="LPAREN">(</span><span class="LIDENT">utf_8_uchar_4</span> <a href="#local_b0_261"><span class="LIDENT">b0</span></a> <a href="#local_b1_291"><span class="LIDENT">b1</span></a> <a href="#local_b2_293"><span class="LIDENT">b2</span></a> <a href="#local_b3_295"><span class="LIDENT">b3</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_utf_8_uchar"><span class="LIDENT">set_utf_8_uchar</span></span> <span id="local_b_296"><span class="LIDENT">b</span></span> <span id="local_i_297"><span class="LIDENT">i</span></span> <span id="local_u_298"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_set_299"><span class="LIDENT">set</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_set_uint8</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_300"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="uchar.ml.html#val-to_int"><span class="UIDENT">Uchar</span><span class="DOT">.</span><span class="LIDENT">to_int</span></a> <a href="#local_u_298"><span class="LIDENT">u</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_301"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_301"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_302"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_302"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0x007F</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">set_uint8</span> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="#local_u_302"><span class="LIDENT">u</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="INT">1</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_303"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_303"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0x07FF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_304"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_304"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_300"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">set_uint8</span> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_i_297"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="INT">0xC0</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u_303"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">6</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <a href="#local_set_299"><span class="LIDENT">set</span></a> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_last_304"><span class="LIDENT">last</span></a> <span class="LPAREN">(</span><span class="INT">0x80</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u_303"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_305"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_305"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0xFFFF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_306"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_306"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_300"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">set_uint8</span> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_i_297"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="INT">0xE0</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u_305"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">12</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <a href="#local_set_299"><span class="LIDENT">set</span></a> <a href="#local_b_296"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="INT">0x80</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_u_305"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">6</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <a href="#local_set_299"><span class="LIDENT">set</span></a> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_last_306"><span class="LIDENT">last</span></a> <span class="LPAREN">(</span><span class="INT">0x80</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u_305"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <span class="INT">3</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_307"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_307"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0x10FFFF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_308"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_308"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_300"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">set_uint8</span> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_i_297"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><span class="INT">0xF0</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u_307"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">18</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <a href="#local_set_299"><span class="LIDENT">set</span></a> <a href="#local_b_296"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="INT">0x80</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_u_307"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">12</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <a href="#local_set_299"><span class="LIDENT">set</span></a> <a href="#local_b_296"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_297"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="INT">0x80</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_u_307"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">6</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <a href="#local_set_299"><span class="LIDENT">set</span></a> <a href="#local_b_296"><span class="LIDENT">b</span></a> <a href="#local_last_308"><span class="LIDENT">last</span></a> <span class="LPAREN">(</span><span class="INT">0x80</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u_307"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3F</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>       <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_valid_utf_8"><span class="LIDENT">is_valid_utf_8</span></span> <span id="local_b_309"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_310"><span class="LIDENT">loop</span></span> <span id="local_max_311"><span class="LIDENT">max</span></span> <span id="local_b_312"><span class="LIDENT">b</span></span> <span id="local_i_313"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="TRUE">true</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_314"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint8</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="char.ml.html#val-unsafe_chr"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">unsafe_chr</span></a> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_i_313"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\x00'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\x7F'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xC2'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xDF'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_315"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_315"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_315"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_315"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xE0'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_316"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_316"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_xA0_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_316"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_316"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xE1'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xEC'</span> <span class="BAR">|</span> <span class="CHAR">'\xEE'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xEF'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_317"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_317"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_317"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_317"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xED'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_318"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_318"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_x9F</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_318"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_318"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xF0'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_319"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_319"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x90_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_319"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_319"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xF1'</span> <span class="DOTDOT">..</span> <span class="CHAR">'\xF3'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_320"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_320"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_320"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_320"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\xF4'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_321"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_321"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_x8F</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_313"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <span class="LIDENT">not_in_x80_to_xBF</span> <span class="LPAREN">(</span><a href="#local_get_314"><span class="LIDENT">get</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <a href="#local_last_321"><span class="LIDENT">last</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <a href="#local_max_311"><span class="LIDENT">max</span></a> <a href="#local_b_312"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_last_321"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_310"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_b_309"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_b_309"><span class="LIDENT">b</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* UTF-16BE *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_utf_16be_uchar"><span class="LIDENT">get_utf_16be_uchar</span></span> <span id="local_b_322"><span class="LIDENT">b</span></span> <span id="local_i_323"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_get_324"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16_be</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_325"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_b_322"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_323"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_323"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_325"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;index out of bounds&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_323"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_max_325"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_get_324"><span class="LIDENT">get</span></a> <a href="#local_b_322"><span class="LIDENT">b</span></a> <a href="#local_i_323"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_326"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_326"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xD800</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_326"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_ret</span> <span class="INT">2</span> <a href="#local_u_326"><span class="LIDENT">u</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_327"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_327"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDBFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hi_328"><span class="LIDENT">hi</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="COMMENT">(* combine [hi] with a low surrogate *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_329"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_323"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_329"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_325"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="LPAREN">(</span><a href="#local_max_325"><span class="LIDENT">max</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_i_323"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_get_324"><span class="LIDENT">get</span></a> <a href="#local_b_322"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_323"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_u_330"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_330"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xDC00</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_330"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="COMMENT">(* retry here *)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_lo_331"><span class="LIDENT">lo</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_u_332"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_hi_328"><span class="LIDENT">hi</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3FF</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">10</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_lo_331"><span class="LIDENT">lo</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3FF</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">0x10000</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">dec_ret</span> <span class="INT">4</span> <a href="#local_u_332"><span class="LIDENT">u</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_utf_16be_uchar"><span class="LIDENT">set_utf_16be_uchar</span></span> <span id="local_b_333"><span class="LIDENT">b</span></span> <span id="local_i_334"><span class="LIDENT">i</span></span> <span id="local_u_335"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_set_336"><span class="LIDENT">set</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_set_uint16_be</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_337"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_b_333"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_337"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;index out of bounds&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="uchar.ml.html#val-to_int"><span class="UIDENT">Uchar</span><span class="DOT">.</span><span class="LIDENT">to_int</span></a> <a href="#local_u_335"><span class="LIDENT">u</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_338"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_338"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_339"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_339"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0xFFFF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_340"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_340"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_337"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span> <span class="LPAREN">(</span><a href="#local_set_336"><span class="LIDENT">set</span></a> <a href="#local_b_333"><span class="LIDENT">b</span></a> <a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="#local_u_339"><span class="LIDENT">u</span></a><span class="SEMI">;</span> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_341"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_341"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0x10FFFF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_342"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_342"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_337"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_u'_343"><span class="LIDENT">u'</span></span> <span class="EQUAL">=</span> <a href="#local_u_341"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">0x10000</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_hi_344"><span class="LIDENT">hi</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">0xD800</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u'_343"><span class="LIDENT">u'</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">10</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_lo_345"><span class="LIDENT">lo</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">0xDC00</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u'_343"><span class="LIDENT">u'</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3FF</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_set_336"><span class="LIDENT">set</span></a> <a href="#local_b_333"><span class="LIDENT">b</span></a> <a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="#local_hi_344"><span class="LIDENT">hi</span></a><span class="SEMI">;</span> <a href="#local_set_336"><span class="LIDENT">set</span></a> <a href="#local_b_333"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_334"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_lo_345"><span class="LIDENT">lo</span></a><span class="SEMI">;</span> <span class="INT">4</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_valid_utf_16be"><span class="LIDENT">is_valid_utf_16be</span></span> <span id="local_b_346"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_347"><span class="LIDENT">loop</span></span> <span id="local_max_348"><span class="LIDENT">max</span></span> <span id="local_b_349"><span class="LIDENT">b</span></span> <span id="local_i_350"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_351"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16_be</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_350"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_348"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="TRUE">true</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_350"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_max_348"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="FALSE">false</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_get_351"><span class="LIDENT">get</span></a> <a href="#local_b_349"><span class="LIDENT">b</span></a> <a href="#local_i_350"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_u_352"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_352"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xD800</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_352"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_347"><span class="LIDENT">loop</span></a> <a href="#local_max_348"><span class="LIDENT">max</span></a> <a href="#local_b_349"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_350"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_u_353"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_353"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDBFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local__hi_354"><span class="LIDENT">_hi</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_355"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_350"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_355"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_348"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="FALSE">false</span> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_get_351"><span class="LIDENT">get</span></a> <a href="#local_b_349"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_350"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local_u_356"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_356"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xDC00</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_356"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local__lo_357"><span class="LIDENT">_lo</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_347"><span class="LIDENT">loop</span></a> <a href="#local_max_348"><span class="LIDENT">max</span></a> <a href="#local_b_349"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_350"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_347"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_b_346"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_b_346"><span class="LIDENT">b</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* UTF-16LE *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-get_utf_16le_uchar"><span class="LIDENT">get_utf_16le_uchar</span></span> <span id="local_b_358"><span class="LIDENT">b</span></span> <span id="local_i_359"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_get_360"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16_le</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_361"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_b_358"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_359"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_359"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_361"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;index out of bounds&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_359"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_max_361"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="INT">1</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_get_360"><span class="LIDENT">get</span></a> <a href="#local_b_358"><span class="LIDENT">b</span></a> <a href="#local_i_359"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_362"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_362"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xD800</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_362"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_ret</span> <span class="INT">2</span> <a href="#local_u_362"><span class="LIDENT">u</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_363"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_363"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDBFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_hi_364"><span class="LIDENT">hi</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="COMMENT">(* combine [hi] with a low surrogate *)</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_365"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_359"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_365"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_361"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="LIDENT">dec_invalid</span> <span class="LPAREN">(</span><a href="#local_max_361"><span class="LIDENT">max</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_i_359"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_get_360"><span class="LIDENT">get</span></a> <a href="#local_b_358"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_359"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_u_366"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_366"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xDC00</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_366"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">dec_invalid</span> <span class="INT">2</span> <span class="COMMENT">(* retry here *)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_lo_367"><span class="LIDENT">lo</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_u_368"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_hi_364"><span class="LIDENT">hi</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3FF</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="INT">10</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_lo_367"><span class="LIDENT">lo</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3FF</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">0x10000</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="LIDENT">dec_ret</span> <span class="INT">4</span> <a href="#local_u_368"><span class="LIDENT">u</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-set_utf_16le_uchar"><span class="LIDENT">set_utf_16le_uchar</span></span> <span id="local_b_369"><span class="LIDENT">b</span></span> <span id="local_i_370"><span class="LIDENT">i</span></span> <span id="local_u_371"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_set_372"><span class="LIDENT">set</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_set_uint16_le</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_max_373"><span class="LIDENT">max</span></span> <span class="EQUAL">=</span> <span class="LIDENT">length</span> <a href="#local_b_369"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_373"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;index out of bounds&quot;</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="uchar.ml.html#val-to_int"><span class="UIDENT">Uchar</span><span class="DOT">.</span><span class="LIDENT">to_int</span></a> <a href="#local_u_371"><span class="LIDENT">u</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_374"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_374"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_375"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_375"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0xFFFF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_376"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_376"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_373"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span> <span class="LPAREN">(</span><a href="#local_set_372"><span class="LIDENT">set</span></a> <a href="#local_b_369"><span class="LIDENT">b</span></a> <a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="#local_u_375"><span class="LIDENT">u</span></a><span class="SEMI">;</span> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span id="local_u_377"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_377"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <span class="INT">0x10FFFF</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_last_378"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_last_378"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_373"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_u'_379"><span class="LIDENT">u'</span></span> <span class="EQUAL">=</span> <a href="#local_u_377"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">0x10000</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_hi_380"><span class="LIDENT">hi</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">0xD800</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u'_379"><span class="LIDENT">u'</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">10</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_lo_381"><span class="LIDENT">lo</span></span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="INT">0xDC00</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <span class="LPAREN">(</span><a href="#local_u'_379"><span class="LIDENT">u'</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0x3FF</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_set_372"><span class="LIDENT">set</span></a> <a href="#local_b_369"><span class="LIDENT">b</span></a> <a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="#local_hi_380"><span class="LIDENT">hi</span></a><span class="SEMI">;</span> <a href="#local_set_372"><span class="LIDENT">set</span></a> <a href="#local_b_369"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_370"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_lo_381"><span class="LIDENT">lo</span></a><span class="SEMI">;</span> <span class="INT">4</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_valid_utf_16le"><span class="LIDENT">is_valid_utf_16le</span></span> <span id="local_b_382"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_383"><span class="LIDENT">loop</span></span> <span id="local_max_384"><span class="LIDENT">max</span></span> <span id="local_b_385"><span class="LIDENT">b</span></span> <span id="local_i_386"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_387"><span class="LIDENT">get</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_get_uint16_le</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_386"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_384"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="TRUE">true</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_386"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_max_384"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="FALSE">false</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_get_387"><span class="LIDENT">get</span></a> <a href="#local_b_385"><span class="LIDENT">b</span></a> <a href="#local_i_386"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_u_388"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_388"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xD800</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_388"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_383"><span class="LIDENT">loop</span></a> <a href="#local_max_384"><span class="LIDENT">max</span></a> <a href="#local_b_385"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_386"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_u_389"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_389"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDBFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local__hi_390"><span class="LIDENT">_hi</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_last_391"><span class="LIDENT">last</span></span> <span class="EQUAL">=</span> <a href="#local_i_386"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_last_391"><span class="LIDENT">last</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_max_384"><span class="LIDENT">max</span></a> <span class="THEN">then</span> <span class="FALSE">false</span> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_get_387"><span class="LIDENT">get</span></a> <a href="#local_b_385"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_386"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local_u_392"><span class="LIDENT">u</span></span> <span class="WHEN">when</span> <a href="#local_u_392"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0xDC00</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_u_392"><span class="LIDENT">u</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0xDFFF</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local__lo_393"><span class="LIDENT">_lo</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_loop_383"><span class="LIDENT">loop</span></a> <a href="#local_max_384"><span class="LIDENT">max</span></a> <a href="#local_b_385"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_i_386"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_loop_383"><span class="LIDENT">loop</span></a> <span class="LPAREN">(</span><span class="LIDENT">length</span> <a href="#local_b_382"><span class="LIDENT">b</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_b_382"><span class="LIDENT">b</span></a> <span class="INT">0</span><span class="EOL">
</span></span></code></pre></body></html>
