<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: buffer.ml (ocaml-base-compiler.src.stdlib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocaml-base-compiler</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; stdlib &#x00BB; buffer.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>buffer.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocaml-base-compiler</a><ul><li>Library <code>compiler-libs.bytecomp</code><ul><li><a href="../../compiler-libs.bytecomp/Bytegen/index.html">Bytegen</a></li><li><a href="../../compiler-libs.bytecomp/Bytelibrarian/index.html">Bytelibrarian</a></li><li><a href="../../compiler-libs.bytecomp/Bytelink/index.html">Bytelink</a></li><li><a href="../../compiler-libs.bytecomp/Bytepackager/index.html">Bytepackager</a></li><li><a href="../../compiler-libs.bytecomp/Compile/index.html">Compile</a></li><li><a href="../../compiler-libs.bytecomp/Emitcode/index.html">Emitcode</a></li><li><a href="../../compiler-libs.bytecomp/Errors/index.html">Errors</a></li><li><a href="../../compiler-libs.bytecomp/Instruct/index.html">Instruct</a></li><li><a href="../../compiler-libs.bytecomp/Maindriver/index.html">Maindriver</a></li><li><a href="../../compiler-libs.bytecomp/Printinstr/index.html">Printinstr</a></li></ul></li><li>Library <code>compiler-libs.common</code><ul><li><a href="../../compiler-libs.common/Annot/index.html">Annot</a></li><li><a href="../../compiler-libs.common/Arg_helper/index.html">Arg_helper</a></li><li><a href="../../compiler-libs.common/Ast_helper/index.html">Ast_helper</a></li><li><a href="../../compiler-libs.common/Ast_invariants/index.html">Ast_invariants</a></li><li><a href="../../compiler-libs.common/Ast_iterator/index.html">Ast_iterator</a></li><li><a href="../../compiler-libs.common/Ast_mapper/index.html">Ast_mapper</a></li><li><a href="../../compiler-libs.common/Asttypes/index.html">Asttypes</a></li><li><a href="../../compiler-libs.common/Attr_helper/index.html">Attr_helper</a></li><li><a href="../../compiler-libs.common/Binutils/index.html">Binutils</a></li><li><a href="../../compiler-libs.common/Btype/index.html">Btype</a></li><li><a href="../../compiler-libs.common/Build_path_prefix_map/index.html">Build_path_prefix_map</a></li><li><a href="../../compiler-libs.common/Builtin_attributes/index.html">Builtin_attributes</a></li><li><a href="../../compiler-libs.common/Bytesections/index.html">Bytesections</a></li><li><a href="../../compiler-libs.common/CamlinternalMenhirLib/index.html">CamlinternalMenhirLib</a></li><li><a href="../../compiler-libs.common/Ccomp/index.html">Ccomp</a></li><li><a href="../../compiler-libs.common/Clflags/index.html">Clflags</a></li><li><a href="../../compiler-libs.common/Cmi_format/index.html">Cmi_format</a></li><li><a href="../../compiler-libs.common/Cmo_format/index.html">Cmo_format</a></li><li><a href="../../compiler-libs.common/Cmt2annot/index.html">Cmt2annot</a></li><li><a href="../../compiler-libs.common/Cmt_format/index.html">Cmt_format</a></li><li><a href="../../compiler-libs.common/Compenv/index.html">Compenv</a></li><li><a href="../../compiler-libs.common/Compile_common/index.html">Compile_common</a></li><li><a href="../../compiler-libs.common/Compmisc/index.html">Compmisc</a></li><li><a href="../../compiler-libs.common/Compression/index.html">Compression</a></li><li><a href="../../compiler-libs.common/Config/index.html">Config</a></li><li><a href="../../compiler-libs.common/Config_boot/index.html">Config_boot</a></li><li><a href="../../compiler-libs.common/Config_main/index.html">Config_main</a></li><li><a href="../../compiler-libs.common/Consistbl/index.html">Consistbl</a></li><li><a href="../../compiler-libs.common/Ctype/index.html">Ctype</a></li><li><a href="../../compiler-libs.common/Datarepr/index.html">Datarepr</a></li><li><a href="../../compiler-libs.common/Debuginfo/index.html">Debuginfo</a></li><li><a href="../../compiler-libs.common/Depend/index.html">Depend</a></li><li><a href="../../compiler-libs.common/Diffing/index.html">Diffing</a></li><li><a href="../../compiler-libs.common/Diffing_with_keys/index.html">Diffing_with_keys</a></li><li><a href="../../compiler-libs.common/Dll/index.html">Dll</a></li><li><a href="../../compiler-libs.common/Docstrings/index.html">Docstrings</a></li><li><a href="../../compiler-libs.common/Domainstate/index.html">Domainstate</a></li><li><a href="../../compiler-libs.common/Env/index.html">Env</a></li><li><a href="../../compiler-libs.common/Envaux/index.html">Envaux</a></li><li><a href="../../compiler-libs.common/Errortrace/index.html">Errortrace</a></li><li><a href="../../compiler-libs.common/Expunge/index.html">Expunge</a></li><li><a href="../../compiler-libs.common/Ident/index.html">Ident</a></li><li><a href="../../compiler-libs.common/Identifiable/index.html">Identifiable</a></li><li><a href="../../compiler-libs.common/Includeclass/index.html">Includeclass</a></li><li><a href="../../compiler-libs.common/Includecore/index.html">Includecore</a></li><li><a href="../../compiler-libs.common/Includemod/index.html">Includemod</a></li><li><a href="../../compiler-libs.common/Includemod_errorprinter/index.html">Includemod_errorprinter</a></li><li><a href="../../compiler-libs.common/Int_replace_polymorphic_compare/index.html">Int_replace_polymorphic_compare</a></li><li><a href="../../compiler-libs.common/Lambda/index.html">Lambda</a></li><li><a href="../../compiler-libs.common/Lazy_backtrack/index.html">Lazy_backtrack</a></li><li><a href="../../compiler-libs.common/Lexer/index.html">Lexer</a></li><li><a href="../../compiler-libs.common/Load_path/index.html">Load_path</a></li><li><a href="../../compiler-libs.common/Local_store/index.html">Local_store</a></li><li><a href="../../compiler-libs.common/Location/index.html">Location</a></li><li><a href="../../compiler-libs.common/Longident/index.html">Longident</a></li><li><a href="../../compiler-libs.common/Main_args/index.html">Main_args</a></li><li><a href="../../compiler-libs.common/Makedepend/index.html">Makedepend</a></li><li><a href="../../compiler-libs.common/Matching/index.html">Matching</a></li><li><a href="../../compiler-libs.common/Meta/index.html">Meta</a></li><li><a href="../../compiler-libs.common/Misc/index.html">Misc</a></li><li><a href="../../compiler-libs.common/Mtype/index.html">Mtype</a></li><li><a href="../../compiler-libs.common/Numbers/index.html">Numbers</a></li><li><a href="../../compiler-libs.common/Opcodes/index.html">Opcodes</a></li><li><a href="../../compiler-libs.common/Oprint/index.html">Oprint</a></li><li><a href="../../compiler-libs.common/Outcometree/index.html">Outcometree</a></li><li><a href="../../compiler-libs.common/Parmatch/index.html">Parmatch</a></li><li><a href="../../compiler-libs.common/Parse/index.html">Parse</a></li><li><a href="../../compiler-libs.common/Parser/index.html">Parser</a></li><li><a href="../../compiler-libs.common/Parsetree/index.html">Parsetree</a></li><li><a href="../../compiler-libs.common/Path/index.html">Path</a></li><li><a href="../../compiler-libs.common/Patterns/index.html">Patterns</a></li><li><a href="../../compiler-libs.common/Persistent_env/index.html">Persistent_env</a></li><li><a href="../../compiler-libs.common/Pparse/index.html">Pparse</a></li><li><a href="../../compiler-libs.common/Pprintast/index.html">Pprintast</a></li><li><a href="../../compiler-libs.common/Predef/index.html">Predef</a></li><li><a href="../../compiler-libs.common/Primitive/index.html">Primitive</a></li><li><a href="../../compiler-libs.common/Printast/index.html">Printast</a></li><li><a href="../../compiler-libs.common/Printlambda/index.html">Printlambda</a></li><li><a href="../../compiler-libs.common/Printpat/index.html">Printpat</a></li><li><a href="../../compiler-libs.common/Printtyp/index.html">Printtyp</a></li><li><a href="../../compiler-libs.common/Printtyped/index.html">Printtyped</a></li><li><a href="../../compiler-libs.common/Profile/index.html">Profile</a></li><li><a href="../../compiler-libs.common/Runtimedef/index.html">Runtimedef</a></li><li><a href="../../compiler-libs.common/Shape/index.html">Shape</a></li><li><a href="../../compiler-libs.common/Shape_reduce/index.html">Shape_reduce</a></li><li><a href="../../compiler-libs.common/Signature_group/index.html">Signature_group</a></li><li><a href="../../compiler-libs.common/Simplif/index.html">Simplif</a></li><li><a href="../../compiler-libs.common/Strongly_connected_components/index.html">Strongly_connected_components</a></li><li><a href="../../compiler-libs.common/Stypes/index.html">Stypes</a></li><li><a href="../../compiler-libs.common/Subst/index.html">Subst</a></li><li><a href="../../compiler-libs.common/Switch/index.html">Switch</a></li><li><a href="../../compiler-libs.common/Symtable/index.html">Symtable</a></li><li><a href="../../compiler-libs.common/Syntaxerr/index.html">Syntaxerr</a></li><li><a href="../../compiler-libs.common/Targetint/index.html">Targetint</a></li><li><a href="../../compiler-libs.common/Tast_iterator/index.html">Tast_iterator</a></li><li><a href="../../compiler-libs.common/Tast_mapper/index.html">Tast_mapper</a></li><li><a href="../../compiler-libs.common/Terminfo/index.html">Terminfo</a></li><li><a href="../../compiler-libs.common/Tmc/index.html">Tmc</a></li><li><a href="../../compiler-libs.common/Translattribute/index.html">Translattribute</a></li><li><a href="../../compiler-libs.common/Translclass/index.html">Translclass</a></li><li><a href="../../compiler-libs.common/Translcore/index.html">Translcore</a></li><li><a href="../../compiler-libs.common/Translmod/index.html">Translmod</a></li><li><a href="../../compiler-libs.common/Translobj/index.html">Translobj</a></li><li><a href="../../compiler-libs.common/Translprim/index.html">Translprim</a></li><li><a href="../../compiler-libs.common/Type_immediacy/index.html">Type_immediacy</a></li><li><a href="../../compiler-libs.common/Typeclass/index.html">Typeclass</a></li><li><a href="../../compiler-libs.common/Typecore/index.html">Typecore</a></li><li><a href="../../compiler-libs.common/Typedecl/index.html">Typedecl</a></li><li><a href="../../compiler-libs.common/Typedecl_immediacy/index.html">Typedecl_immediacy</a></li><li><a href="../../compiler-libs.common/Typedecl_properties/index.html">Typedecl_properties</a></li><li><a href="../../compiler-libs.common/Typedecl_separability/index.html">Typedecl_separability</a></li><li><a href="../../compiler-libs.common/Typedecl_unboxed/index.html">Typedecl_unboxed</a></li><li><a href="../../compiler-libs.common/Typedecl_variance/index.html">Typedecl_variance</a></li><li><a href="../../compiler-libs.common/Typedtree/index.html">Typedtree</a></li><li><a href="../../compiler-libs.common/Typemod/index.html">Typemod</a></li><li><a href="../../compiler-libs.common/Typeopt/index.html">Typeopt</a></li><li><a href="../../compiler-libs.common/Types/index.html">Types</a></li><li><a href="../../compiler-libs.common/Typetexp/index.html">Typetexp</a></li><li><a href="../../compiler-libs.common/Unit_info/index.html">Unit_info</a></li><li><a href="../../compiler-libs.common/Untypeast/index.html">Untypeast</a></li><li><a href="../../compiler-libs.common/Value_rec_check/index.html">Value_rec_check</a></li><li><a href="../../compiler-libs.common/Value_rec_compiler/index.html">Value_rec_compiler</a></li><li><a href="../../compiler-libs.common/Value_rec_types/index.html">Value_rec_types</a></li><li><a href="../../compiler-libs.common/Warnings/index.html">Warnings</a></li><li><a href="../../compiler-libs.common/X86_ast/index.html">X86_ast</a></li></ul></li><li>Library <code>compiler-libs.optcomp</code><ul><li><a href="../../compiler-libs.optcomp/Afl_instrument/index.html">Afl_instrument</a></li><li><a href="../../compiler-libs.optcomp/Alias_analysis/index.html">Alias_analysis</a></li><li><a href="../../compiler-libs.optcomp/Allocated_const/index.html">Allocated_const</a></li><li><a href="../../compiler-libs.optcomp/Arch/index.html">Arch</a></li><li><a href="../../compiler-libs.optcomp/Asmgen/index.html">Asmgen</a></li><li><a href="../../compiler-libs.optcomp/Asmlibrarian/index.html">Asmlibrarian</a></li><li><a href="../../compiler-libs.optcomp/Asmlink/index.html">Asmlink</a></li><li><a href="../../compiler-libs.optcomp/Asmpackager/index.html">Asmpackager</a></li><li><a href="../../compiler-libs.optcomp/Augment_specialised_args/index.html">Augment_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Backend_intf/index.html">Backend_intf</a></li><li><a href="../../compiler-libs.optcomp/Backend_var/index.html">Backend_var</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation/index.html">Branch_relaxation</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation_intf/index.html">Branch_relaxation_intf</a></li><li><a href="../../compiler-libs.optcomp/Build_export_info/index.html">Build_export_info</a></li><li><a href="../../compiler-libs.optcomp/CSE/index.html">CSE</a></li><li><a href="../../compiler-libs.optcomp/CSEgen/index.html">CSEgen</a></li><li><a href="../../compiler-libs.optcomp/Clambda/index.html">Clambda</a></li><li><a href="../../compiler-libs.optcomp/Clambda_primitives/index.html">Clambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Closure/index.html">Closure</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion/index.html">Closure_conversion</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion_aux/index.html">Closure_conversion_aux</a></li><li><a href="../../compiler-libs.optcomp/Closure_element/index.html">Closure_element</a></li><li><a href="../../compiler-libs.optcomp/Closure_id/index.html">Closure_id</a></li><li><a href="../../compiler-libs.optcomp/Closure_middle_end/index.html">Closure_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Closure_offsets/index.html">Closure_offsets</a></li><li><a href="../../compiler-libs.optcomp/Closure_origin/index.html">Closure_origin</a></li><li><a href="../../compiler-libs.optcomp/Cmm/index.html">Cmm</a></li><li><a href="../../compiler-libs.optcomp/Cmm_helpers/index.html">Cmm_helpers</a></li><li><a href="../../compiler-libs.optcomp/Cmm_invariants/index.html">Cmm_invariants</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen/index.html">Cmmgen</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen_state/index.html">Cmmgen_state</a></li><li><a href="../../compiler-libs.optcomp/Cmx_format/index.html">Cmx_format</a></li><li><a href="../../compiler-libs.optcomp/Cmxs_format/index.html">Cmxs_format</a></li><li><a href="../../compiler-libs.optcomp/Coloring/index.html">Coloring</a></li><li><a href="../../compiler-libs.optcomp/Comballoc/index.html">Comballoc</a></li><li><a href="../../compiler-libs.optcomp/Compilation_unit/index.html">Compilation_unit</a></li><li><a href="../../compiler-libs.optcomp/Compilenv/index.html">Compilenv</a></li><li><a href="../../compiler-libs.optcomp/Convert_primitives/index.html">Convert_primitives</a></li><li><a href="../../compiler-libs.optcomp/Dataflow/index.html">Dataflow</a></li><li><a href="../../compiler-libs.optcomp/Deadcode/index.html">Deadcode</a></li><li><a href="../../compiler-libs.optcomp/Effect_analysis/index.html">Effect_analysis</a></li><li><a href="../../compiler-libs.optcomp/Emit/index.html">Emit</a></li><li><a href="../../compiler-libs.optcomp/Emitaux/index.html">Emitaux</a></li><li><a href="../../compiler-libs.optcomp/Emitenv/index.html">Emitenv</a></li><li><a href="../../compiler-libs.optcomp/Export_id/index.html">Export_id</a></li><li><a href="../../compiler-libs.optcomp/Export_info/index.html">Export_info</a></li><li><a href="../../compiler-libs.optcomp/Export_info_for_pack/index.html">Export_info_for_pack</a></li><li><a href="../../compiler-libs.optcomp/Extract_projections/index.html">Extract_projections</a></li><li><a href="../../compiler-libs.optcomp/Find_recursive_functions/index.html">Find_recursive_functions</a></li><li><a href="../../compiler-libs.optcomp/Flambda/index.html">Flambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_invariants/index.html">Flambda_invariants</a></li><li><a href="../../compiler-libs.optcomp/Flambda_iterators/index.html">Flambda_iterators</a></li><li><a href="../../compiler-libs.optcomp/Flambda_middle_end/index.html">Flambda_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Flambda_to_clambda/index.html">Flambda_to_clambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_utils/index.html">Flambda_utils</a></li><li><a href="../../compiler-libs.optcomp/Freshening/index.html">Freshening</a></li><li><a href="../../compiler-libs.optcomp/Id_types/index.html">Id_types</a></li><li><a href="../../compiler-libs.optcomp/Import_approx/index.html">Import_approx</a></li><li><a href="../../compiler-libs.optcomp/Inconstant_idents/index.html">Inconstant_idents</a></li><li><a href="../../compiler-libs.optcomp/Initialize_symbol_to_let_symbol/index.html">Initialize_symbol_to_let_symbol</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify/index.html">Inline_and_simplify</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify_aux/index.html">Inline_and_simplify_aux</a></li><li><a href="../../compiler-libs.optcomp/Inlining_cost/index.html">Inlining_cost</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision/index.html">Inlining_decision</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision_intf/index.html">Inlining_decision_intf</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats/index.html">Inlining_stats</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats_types/index.html">Inlining_stats_types</a></li><li><a href="../../compiler-libs.optcomp/Inlining_transforms/index.html">Inlining_transforms</a></li><li><a href="../../compiler-libs.optcomp/Interf/index.html">Interf</a></li><li><a href="../../compiler-libs.optcomp/Internal_variable_names/index.html">Internal_variable_names</a></li><li><a href="../../compiler-libs.optcomp/Interval/index.html">Interval</a></li><li><a href="../../compiler-libs.optcomp/Invariant_params/index.html">Invariant_params</a></li><li><a href="../../compiler-libs.optcomp/Lift_code/index.html">Lift_code</a></li><li><a href="../../compiler-libs.optcomp/Lift_constants/index.html">Lift_constants</a></li><li><a href="../../compiler-libs.optcomp/Lift_let_to_initialize_symbol/index.html">Lift_let_to_initialize_symbol</a></li><li><a href="../../compiler-libs.optcomp/Linear/index.html">Linear</a></li><li><a href="../../compiler-libs.optcomp/Linear_format/index.html">Linear_format</a></li><li><a href="../../compiler-libs.optcomp/Linearize/index.html">Linearize</a></li><li><a href="../../compiler-libs.optcomp/Linkage_name/index.html">Linkage_name</a></li><li><a href="../../compiler-libs.optcomp/Linscan/index.html">Linscan</a></li><li><a href="../../compiler-libs.optcomp/Liveness/index.html">Liveness</a></li><li><a href="../../compiler-libs.optcomp/Mach/index.html">Mach</a></li><li><a href="../../compiler-libs.optcomp/Mutable_variable/index.html">Mutable_variable</a></li><li><a href="../../compiler-libs.optcomp/Optcompile/index.html">Optcompile</a></li><li><a href="../../compiler-libs.optcomp/Opterrors/index.html">Opterrors</a></li><li><a href="../../compiler-libs.optcomp/Optmaindriver/index.html">Optmaindriver</a></li><li><a href="../../compiler-libs.optcomp/Parameter/index.html">Parameter</a></li><li><a href="../../compiler-libs.optcomp/Pass_wrapper/index.html">Pass_wrapper</a></li><li><a href="../../compiler-libs.optcomp/Polling/index.html">Polling</a></li><li><a href="../../compiler-libs.optcomp/Printclambda/index.html">Printclambda</a></li><li><a href="../../compiler-libs.optcomp/Printclambda_primitives/index.html">Printclambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Printcmm/index.html">Printcmm</a></li><li><a href="../../compiler-libs.optcomp/Printlinear/index.html">Printlinear</a></li><li><a href="../../compiler-libs.optcomp/Printmach/index.html">Printmach</a></li><li><a href="../../compiler-libs.optcomp/Proc/index.html">Proc</a></li><li><a href="../../compiler-libs.optcomp/Projection/index.html">Projection</a></li><li><a href="../../compiler-libs.optcomp/Ref_to_variables/index.html">Ref_to_variables</a></li><li><a href="../../compiler-libs.optcomp/Reg/index.html">Reg</a></li><li><a href="../../compiler-libs.optcomp/Reload/index.html">Reload</a></li><li><a href="../../compiler-libs.optcomp/Reloadgen/index.html">Reloadgen</a></li><li><a href="../../compiler-libs.optcomp/Remove_free_vars_equal_to_args/index.html">Remove_free_vars_equal_to_args</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_arguments/index.html">Remove_unused_arguments</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_closure_vars/index.html">Remove_unused_closure_vars</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_program_constructs/index.html">Remove_unused_program_constructs</a></li><li><a href="../../compiler-libs.optcomp/Schedgen/index.html">Schedgen</a></li><li><a href="../../compiler-libs.optcomp/Scheduling/index.html">Scheduling</a></li><li><a href="../../compiler-libs.optcomp/Selectgen/index.html">Selectgen</a></li><li><a href="../../compiler-libs.optcomp/Selection/index.html">Selection</a></li><li><a href="../../compiler-libs.optcomp/Semantics_of_primitives/index.html">Semantics_of_primitives</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_id/index.html">Set_of_closures_id</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_origin/index.html">Set_of_closures_origin</a></li><li><a href="../../compiler-libs.optcomp/Share_constants/index.html">Share_constants</a></li><li><a href="../../compiler-libs.optcomp/Simple_value_approx/index.html">Simple_value_approx</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops/index.html">Simplify_boxed_integer_ops</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops_intf/index.html">Simplify_boxed_integer_ops_intf</a></li><li><a href="../../compiler-libs.optcomp/Simplify_common/index.html">Simplify_common</a></li><li><a href="../../compiler-libs.optcomp/Simplify_primitives/index.html">Simplify_primitives</a></li><li><a href="../../compiler-libs.optcomp/Spill/index.html">Spill</a></li><li><a href="../../compiler-libs.optcomp/Split/index.html">Split</a></li><li><a href="../../compiler-libs.optcomp/Stackframe/index.html">Stackframe</a></li><li><a href="../../compiler-libs.optcomp/Stackframegen/index.html">Stackframegen</a></li><li><a href="../../compiler-libs.optcomp/Static_exception/index.html">Static_exception</a></li><li><a href="../../compiler-libs.optcomp/Strmatch/index.html">Strmatch</a></li><li><a href="../../compiler-libs.optcomp/Symbol/index.html">Symbol</a></li><li><a href="../../compiler-libs.optcomp/Tag/index.html">Tag</a></li><li><a href="../../compiler-libs.optcomp/Thread_sanitizer/index.html">Thread_sanitizer</a></li><li><a href="../../compiler-libs.optcomp/Traverse_for_exported_symbols/index.html">Traverse_for_exported_symbols</a></li><li><a href="../../compiler-libs.optcomp/Un_anf/index.html">Un_anf</a></li><li><a href="../../compiler-libs.optcomp/Unbox_closures/index.html">Unbox_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_free_vars_of_closures/index.html">Unbox_free_vars_of_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_specialised_args/index.html">Unbox_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Var_within_closure/index.html">Var_within_closure</a></li><li><a href="../../compiler-libs.optcomp/Variable/index.html">Variable</a></li></ul></li><li>Library <code>compiler-libs.toplevel</code><ul><li><a href="../../compiler-libs.toplevel/Genprintval/index.html">Genprintval</a></li><li><a href="../../compiler-libs.toplevel/Topcommon/index.html">Topcommon</a></li><li><a href="../../compiler-libs.toplevel/Topdirs/index.html">Topdirs</a></li><li><a href="../../compiler-libs.toplevel/Topeval/index.html">Topeval</a></li><li><a href="../../compiler-libs.toplevel/Toploop/index.html">Toploop</a></li><li><a href="../../compiler-libs.toplevel/Topmain/index.html">Topmain</a></li><li><a href="../../compiler-libs.toplevel/Topprinters/index.html">Topprinters</a></li><li><a href="../../compiler-libs.toplevel/Trace/index.html">Trace</a></li></ul></li><li>Library <code>dynlink</code><ul><li><a href="../../dynlink/Dynlink/index.html">Dynlink</a></li></ul></li><li>Library <code>runtime_events</code><ul><li><a href="../../runtime_events/Runtime_events/index.html">Runtime_events</a></li></ul></li><li>Library <code>stdlib</code><ul><li><a href="../../stdlib/CamlinternalFormat/index.html">CamlinternalFormat</a></li><li><a href="../../stdlib/CamlinternalFormatBasics/index.html">CamlinternalFormatBasics</a></li><li><a href="../../stdlib/CamlinternalLazy/index.html">CamlinternalLazy</a></li><li><a href="../../stdlib/CamlinternalMod/index.html">CamlinternalMod</a></li><li><a href="../../stdlib/CamlinternalOO/index.html">CamlinternalOO</a></li><li><a href="../../stdlib/Stdlib/index.html">Stdlib</a></li></ul></li><li>Library <code>str</code><ul><li><a href="../../str/Str/index.html">Str</a></li></ul></li><li>Library <code>threads</code><ul><li><a href="../../threads/Event/index.html">Event</a></li><li><a href="../../threads/Thread/index.html">Thread</a></li></ul></li><li>Library <code>unix</code><ul><li><a href="../../unix/Unix/index.html">Unix</a></li><li><a href="../../unix/UnixLabels/index.html">UnixLabels</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>stdlib<ul><li><a href="arg.ml.html">arg.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="arrayLabels.ml.html">arrayLabels.ml</a></li><li><a href="atomic.ml.html">atomic.ml</a></li><li><a href="bigarray.ml.html">bigarray.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="#" class="current_unit">buffer.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytesLabels.ml.html">bytesLabels.ml</a></li><li><a href="callback.ml.html">callback.ml</a></li><li><a href="camlinternalFormat.ml.html">camlinternalFormat.ml</a></li><li><a href="camlinternalFormatBasics.ml.html">camlinternalFormatBasics.ml</a></li><li><a href="camlinternalLazy.ml.html">camlinternalLazy.ml</a></li><li><a href="camlinternalMod.ml.html">camlinternalMod.ml</a></li><li><a href="camlinternalOO.ml.html">camlinternalOO.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="complex.ml.html">complex.ml</a></li><li><a href="condition.ml.html">condition.ml</a></li><li><a href="digest.ml.html">digest.ml</a></li><li><a href="domain.ml.html">domain.ml</a></li><li><a href="dynarray.ml.html">dynarray.ml</a></li><li><a href="effect.ml.html">effect.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="ephemeron.ml.html">ephemeron.ml</a></li><li><a href="filename.ml.html">filename.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="format.ml.html">format.ml</a></li><li><a href="fun.ml.html">fun.ml</a></li><li><a href="gc.ml.html">gc.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="in_channel.ml.html">in_channel.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="lexing.ml.html">lexing.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="listLabels.ml.html">listLabels.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="marshal.ml.html">marshal.ml</a></li><li><a href="moreLabels.ml.html">moreLabels.ml</a></li><li><a href="mutex.ml.html">mutex.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="obj.ml.html">obj.ml</a></li><li><a href="oo.ml.html">oo.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="out_channel.ml.html">out_channel.ml</a></li><li><a href="parsing.ml.html">parsing.ml</a></li><li><a href="printexc.ml.html">printexc.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="scanf.ml.html">scanf.ml</a></li><li><a href="semaphore.ml.html">semaphore.ml</a></li><li><a href="seq.ml.html">seq.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stdLabels.ml.html">stdLabels.ml</a></li><li><a href="stdlib.ml.html">stdlib.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="stringLabels.ml.html">stringLabels.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="type.ml.html">type.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="weak.ml.html">weak.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                 OCaml                                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*    Pierre Weis and Xavier Leroy, projet Cristal, INRIA Rocquencourt    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   Copyright 1999 Institut National de Recherche en Informatique et     *)</span><span class="EOL">
</span><span class="COMMENT">(*     en Automatique.                                                    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   All rights reserved.  This file is distributed under the terms of    *)</span><span class="EOL">
</span><span class="COMMENT">(*   the GNU Lesser General Public License version 2.1, with the          *)</span><span class="EOL">
</span><span class="COMMENT">(*   special exception on linking described in the file LICENSE.          *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Extensible buffers *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* The [inner_buffer] type ensures that the [length] and [buffer] fields are
   always synchronized, [length = Bytes.length buffer], even in presence
   of data races.
*)</span><span class="EOL">
</span><span id="type-inner_buffer"><span class="TYPE">type</span> <span class="LIDENT">inner_buffer</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_181"><span class="LIDENT">buffer</span><span class="COLON">:</span> <span class="LIDENT">bytes</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_187"><span class="LIDENT">length</span><span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-t"><span class="TYPE">type</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="LBRACE">{</span><span id="def_186"><span class="MUTABLE">mutable</span> <span class="LIDENT">inner</span> <span class="COLON">:</span> <span class="LIDENT">inner_buffer</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_183"><span class="MUTABLE">mutable</span> <span class="LIDENT">position</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_189"><span class="LIDENT">initial_buffer</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span></span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="COMMENT">(* Invariants: all parts of the code preserve the invariants that:
   - [inner.length = Bytes.length inner.buffer]
   In absence of data races, we also have
   - [0 &lt;= b.position &lt;= b.inner.length]

   Note in particular that [b.position = b.inner.length] is legal,
   it means that the buffer is full and will have to be extended
   before any further addition. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-create"><span class="LIDENT">create</span></span> <span id="local_n_1"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="LET">let</span> <span id="local_n_2"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_n_1"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">1</span> <span class="THEN">then</span> <span class="INT">1</span> <span class="ELSE">else</span> <a href="#local_n_1"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span> <span class="LET">let</span> <span id="local_n_3"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="IF">if</span> <a href="#local_n_2"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a> <span class="THEN">then</span> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a> <span class="ELSE">else</span> <a href="#local_n_2"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span> <span class="LET">let</span> <span id="local_s_4"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_n_3"><span class="LIDENT">n</span></a> <span class="IN">in</span><span class="EOL">
</span> <span class="LBRACE">{</span> <span class="LIDENT">inner</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">buffer</span> <span class="EQUAL">=</span> <a href="#local_s_4"><span class="LIDENT">s</span></a><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <a href="#local_n_3"><span class="LIDENT">n</span></a><span class="RBRACE">}</span><span class="SEMI">;</span> <span class="LIDENT">position</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">initial_buffer</span> <span class="EQUAL">=</span> <a href="#local_s_4"><span class="LIDENT">s</span></a><span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-contents"><span class="LIDENT">contents</span></span> <span id="local_b_5"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-sub_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">sub_string</span></a> <a href="#local_b_5"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <span class="INT">0</span> <a href="#local_b_5"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_bytes"><span class="LIDENT">to_bytes</span></span> <span id="local_b_6"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-sub"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_b_6"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <span class="INT">0</span> <a href="#local_b_6"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-sub"><span class="LIDENT">sub</span></span> <span id="local_b_7"><span class="LIDENT">b</span></span> <span id="local_ofs_8"><span class="LIDENT">ofs</span></span> <span id="local_len_9"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_ofs_8"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_len_9"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs_8"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_b_7"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_9"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Buffer.sub&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="bytes.ml.html#val-sub_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">sub_string</span></a> <a href="#local_b_7"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_ofs_8"><span class="LIDENT">ofs</span></a> <a href="#local_len_9"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-blit"><span class="LIDENT">blit</span></span> <span id="local_src_10"><span class="LIDENT">src</span></span> <span id="local_srcoff_11"><span class="LIDENT">srcoff</span></span> <span id="local_dst_12"><span class="LIDENT">dst</span></span> <span id="local_dstoff_13"><span class="LIDENT">dstoff</span></span> <span id="local_len_14"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_len_14"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_srcoff_11"><span class="LIDENT">srcoff</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_srcoff_11"><span class="LIDENT">srcoff</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_src_10"><span class="LIDENT">src</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_14"><span class="LIDENT">len</span></a><span class="EOL">
</span>             <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_dstoff_13"><span class="LIDENT">dstoff</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_dstoff_13"><span class="LIDENT">dstoff</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LPAREN">(</span><a href="bytes.ml.html#val-length"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_dst_12"><span class="LIDENT">dst</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_14"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Buffer.blit&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-blit"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_src_10"><span class="LIDENT">src</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_srcoff_11"><span class="LIDENT">srcoff</span></a> <a href="#local_dst_12"><span class="LIDENT">dst</span></a> <a href="#local_dstoff_13"><span class="LIDENT">dstoff</span></a> <a href="#local_len_14"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-nth"><span class="LIDENT">nth</span></span> <span id="local_b_15"><span class="LIDENT">b</span></span> <span id="local_ofs_16"><span class="LIDENT">ofs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_17"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_15"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_178"><span class="LBRACE">{</span><span id="local_buffer_18"><span class="LIDENT">buffer</span></span><span class="SEMI">;</span><span id="local_length_19"><span class="LIDENT">length</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_15"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_ofs_16"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_ofs_16"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_position_17"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_position_17"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_19"><span class="LIDENT">length</span></a> <span class="THEN">then</span><span class="EOL">
</span>   <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Buffer.nth&quot;</span><span class="EOL">
</span>  <span class="ELSE">else</span> <a href="bytes.ml.html#val-unsafe_get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_buffer_18"><span class="LIDENT">buffer</span></a> <a href="#local_ofs_16"><span class="LIDENT">ofs</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-length"><span class="LIDENT">length</span></span> <span id="local_b_20"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_20"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-clear"><span class="LIDENT">clear</span></span> <span id="local_b_21"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <a href="#local_b_21"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-reset"><span class="LIDENT">reset</span></span> <span id="local_b_22"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="#local_b_22"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <span class="INT">0</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_inner_23"><span class="LIDENT">inner</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LBRACE">{</span> <span class="LIDENT">buffer</span> <span class="EQUAL">=</span> <a href="#local_b_22"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">initial_buffer</span><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-length"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_b_22"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">initial_buffer</span> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_b_22"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_inner_23"><span class="LIDENT">inner</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* [resize b more] ensures that [b.position + more &lt;= b.inner.length] holds
   by dynamically extending [b.inner] if necessary -- and thus
   increasing [b.inner.length].
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-resize"><span class="LIDENT">resize</span></span> <span id="local_b_24"><span class="LIDENT">b</span></span> <span id="local_more_25"><span class="LIDENT">more</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_old_pos_26"><span class="LIDENT">old_pos</span></span> <span class="EQUAL">=</span> <a href="#local_b_24"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_old_len_27"><span class="LIDENT">old_len</span></span> <span class="EQUAL">=</span> <a href="#local_b_24"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">length</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_len_28"><span class="LIDENT">new_len</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <a href="#local_old_len_27"><span class="LIDENT">old_len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="WHILE">while</span> <a href="#local_old_pos_26"><span class="LIDENT">old_pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_more_25"><span class="LIDENT">more</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <span class="DO">do</span> <a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">2</span> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_old_pos_26"><span class="LIDENT">old_pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_more_25"><span class="LIDENT">more</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a><span class="EOL">
</span>    <span class="THEN">then</span> <a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="STRING">&quot;Buffer.add: cannot grow buffer&quot;</span><span class="EOL">
</span>  <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_buffer_29"><span class="LIDENT">new_buffer</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* PR#6148: let's keep using [blit] rather than [unsafe_blit] in
     this tricky function that is slow anyway. *)</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-blit"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_b_24"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <span class="INT">0</span> <a href="#local_new_buffer_29"><span class="LIDENT">new_buffer</span></a> <span class="INT">0</span> <a href="#local_b_24"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_24"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="LESSMINUS">&lt;-</span> <span class="LBRACE">{</span> <span class="LIDENT">buffer</span> <span class="EQUAL">=</span> <a href="#local_new_buffer_29"><span class="LIDENT">new_buffer</span></a><span class="SEMI">;</span> <span class="LIDENT">length</span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_new_len_28"><span class="LIDENT">new_len</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Note:
    Some of the functions below have a fast path when the inner
  buffer doesn't need to be extended.
    In this case, it is possible to use unsafe accesses on the
  contents of the [inner] field since its fields are immutable.
  In presence of data races, we may access the wrong inner buffer, but we
  will use this buffer safely.
  As soon as we need to resize the buffer, we fall back to safe accesses.
*)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_char"><span class="LIDENT">add_char</span></span> <span id="local_b_30"><span class="LIDENT">b</span></span> <span id="local_c_31"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pos_32"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <a href="#local_b_30"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_184"><span class="LBRACE">{</span><span id="local_buffer_33"><span class="LIDENT">buffer</span></span><span class="SEMI">;</span><span id="local_length_34"><span class="LIDENT">length</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_30"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_pos_32"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_length_34"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_30"><span class="LIDENT">b</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_b_30"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_30"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_c_31"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_set</span></a> <a href="#local_buffer_33"><span class="LIDENT">buffer</span></a> <a href="#local_pos_32"><span class="LIDENT">pos</span></a> <a href="#local_c_31"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_30"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pos_32"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-uchar_utf_8_byte_length_max"><span class="LIDENT">uchar_utf_8_byte_length_max</span></span> <span class="EQUAL">=</span> <span class="INT">4</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-uchar_utf_16_byte_length_max"><span class="LIDENT">uchar_utf_16_byte_length_max</span></span> <span class="EQUAL">=</span> <span class="INT">4</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-add_utf_8_uchar"><span class="LIDENT">add_utf_8_uchar</span></span> <span id="local_b_35"><span class="LIDENT">b</span></span> <span id="local_u_36"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pos_37"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <a href="#local_b_35"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_pos_37"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_b_35"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">length</span> <span class="THEN">then</span> <span class="LIDENT">resize</span> <a href="#local_b_35"><span class="LIDENT">b</span></a> <span class="LIDENT">uchar_utf_8_byte_length_max</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_38"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-set_utf_8_uchar"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set_utf_8_uchar</span></a> <a href="#local_b_35"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_pos_37"><span class="LIDENT">pos</span></a> <a href="#local_u_36"><span class="LIDENT">u</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_38"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="LIDENT">resize</span> <a href="#local_b_35"><span class="LIDENT">b</span></a> <span class="LIDENT">uchar_utf_8_byte_length_max</span><span class="SEMI">;</span> <span class="LIDENT">add_utf_8_uchar</span> <a href="#local_b_35"><span class="LIDENT">b</span></a> <a href="#local_u_36"><span class="LIDENT">u</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><a href="#local_b_35"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pos_37"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_n_38"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-add_utf_16be_uchar"><span class="LIDENT">add_utf_16be_uchar</span></span> <span id="local_b_39"><span class="LIDENT">b</span></span> <span id="local_u_40"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pos_41"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <a href="#local_b_39"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_pos_41"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_b_39"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">length</span> <span class="THEN">then</span> <span class="LIDENT">resize</span> <a href="#local_b_39"><span class="LIDENT">b</span></a> <span class="LIDENT">uchar_utf_16_byte_length_max</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_42"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-set_utf_16be_uchar"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set_utf_16be_uchar</span></a> <a href="#local_b_39"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_pos_41"><span class="LIDENT">pos</span></a> <a href="#local_u_40"><span class="LIDENT">u</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_42"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="LIDENT">resize</span> <a href="#local_b_39"><span class="LIDENT">b</span></a> <span class="LIDENT">uchar_utf_16_byte_length_max</span><span class="SEMI">;</span> <span class="LIDENT">add_utf_16be_uchar</span> <a href="#local_b_39"><span class="LIDENT">b</span></a> <a href="#local_u_40"><span class="LIDENT">u</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><a href="#local_b_39"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pos_41"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_n_42"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-add_utf_16le_uchar"><span class="LIDENT">add_utf_16le_uchar</span></span> <span id="local_b_43"><span class="LIDENT">b</span></span> <span id="local_u_44"><span class="LIDENT">u</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_pos_45"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <a href="#local_b_43"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_pos_45"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_b_43"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">length</span> <span class="THEN">then</span> <span class="LIDENT">resize</span> <a href="#local_b_43"><span class="LIDENT">b</span></a> <span class="LIDENT">uchar_utf_16_byte_length_max</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_46"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-set_utf_16le_uchar"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set_utf_16le_uchar</span></a> <a href="#local_b_43"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_pos_45"><span class="LIDENT">pos</span></a> <a href="#local_u_44"><span class="LIDENT">u</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_46"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span><span class="EOL">
</span>  <span class="THEN">then</span> <span class="LPAREN">(</span><span class="LIDENT">resize</span> <a href="#local_b_43"><span class="LIDENT">b</span></a> <span class="LIDENT">uchar_utf_16_byte_length_max</span><span class="SEMI">;</span> <span class="LIDENT">add_utf_16le_uchar</span> <a href="#local_b_43"><span class="LIDENT">b</span></a> <a href="#local_u_44"><span class="LIDENT">u</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="ELSE">else</span> <span class="LPAREN">(</span><a href="#local_b_43"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_pos_45"><span class="LIDENT">pos</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_n_46"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_substring"><span class="LIDENT">add_substring</span></span> <span id="local_b_47"><span class="LIDENT">b</span></span> <span id="local_s_48"><span class="LIDENT">s</span></span> <span id="local_offset_49"><span class="LIDENT">offset</span></span> <span id="local_len_50"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_offset_49"><span class="LIDENT">offset</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_len_50"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_offset_49"><span class="LIDENT">offset</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_48"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_50"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="THEN">then</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Buffer.add_substring/add_subbytes&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_51"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_47"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_177"><span class="LBRACE">{</span><span id="local_buffer_52"><span class="LIDENT">buffer</span></span><span class="SEMI">;</span><span id="local_length_53"><span class="LIDENT">length</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_47"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_position_54"><span class="LIDENT">new_position</span></span> <span class="EQUAL">=</span> <a href="#local_position_51"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_50"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_new_position_54"><span class="LIDENT">new_position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_53"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_47"><span class="LIDENT">b</span></a> <a href="#local_len_50"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-blit_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">blit_string</span></a> <a href="#local_s_48"><span class="LIDENT">s</span></a> <a href="#local_offset_49"><span class="LIDENT">offset</span></a> <a href="#local_b_47"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_47"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_len_50"><span class="LIDENT">len</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_blit_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_blit_string</span></a> <a href="#local_s_48"><span class="LIDENT">s</span></a> <a href="#local_offset_49"><span class="LIDENT">offset</span></a> <a href="#local_buffer_52"><span class="LIDENT">buffer</span></a> <a href="#local_position_51"><span class="LIDENT">position</span></a> <a href="#local_len_50"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_47"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_position_54"><span class="LIDENT">new_position</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_subbytes"><span class="LIDENT">add_subbytes</span></span> <span id="local_b_55"><span class="LIDENT">b</span></span> <span id="local_s_56"><span class="LIDENT">s</span></span> <span id="local_offset_57"><span class="LIDENT">offset</span></span> <span id="local_len_58"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_substring</span> <a href="#local_b_55"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_s_56"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_offset_57"><span class="LIDENT">offset</span></a> <a href="#local_len_58"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_string"><span class="LIDENT">add_string</span></span> <span id="local_b_59"><span class="LIDENT">b</span></span> <span id="local_s_60"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_61"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_60"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_62"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_59"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_179"><span class="LBRACE">{</span><span id="local_buffer_63"><span class="LIDENT">buffer</span></span><span class="SEMI">;</span> <span id="local_length_64"><span class="LIDENT">length</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_59"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_position_65"><span class="LIDENT">new_position</span></span> <span class="EQUAL">=</span> <a href="#local_position_62"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_61"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_new_position_65"><span class="LIDENT">new_position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_64"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_59"><span class="LIDENT">b</span></a> <a href="#local_len_61"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-blit_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">blit_string</span></a> <a href="#local_s_60"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="#local_b_59"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_59"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_len_61"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_blit_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_blit_string</span></a> <a href="#local_s_60"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="#local_buffer_63"><span class="LIDENT">buffer</span></a> <a href="#local_position_62"><span class="LIDENT">position</span></a> <a href="#local_len_61"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_59"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_position_65"><span class="LIDENT">new_position</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_bytes"><span class="LIDENT">add_bytes</span></span> <span id="local_b_66"><span class="LIDENT">b</span></span> <span id="local_s_67"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_string</span> <a href="#local_b_66"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_s_67"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_buffer"><span class="LIDENT">add_buffer</span></span> <span id="local_b_68"><span class="LIDENT">b</span></span> <span id="local_bs_69"><span class="LIDENT">bs</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_subbytes</span> <a href="#local_b_68"><span class="LIDENT">b</span></a> <a href="#local_bs_69"><span class="LIDENT">bs</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <span class="INT">0</span> <a href="#local_bs_69"><span class="LIDENT">bs</span></a><span class="DOT">.</span><span class="LIDENT">position</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* this (private) function could move into the standard library *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-really_input_up_to"><span class="LIDENT">really_input_up_to</span></span> <span id="local_ic_70"><span class="LIDENT">ic</span></span> <span id="local_buf_71"><span class="LIDENT">buf</span></span> <span id="local_ofs_72"><span class="LIDENT">ofs</span></span> <span id="local_len_73"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_loop_74"><span class="LIDENT">loop</span></span> <span id="local_ic_75"><span class="LIDENT">ic</span></span> <span id="local_buf_76"><span class="LIDENT">buf</span></span> <span class="TILDE">~</span><span id="local_already_read_77"><span class="LIDENT">already_read</span></span> <span class="TILDE">~</span><span id="local_ofs_78"><span class="LIDENT">ofs</span></span> <span class="TILDE">~</span><span id="local_to_read_79"><span class="LIDENT">to_read</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_to_read_79"><span class="LIDENT">to_read</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_already_read_77"><span class="LIDENT">already_read</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_r_80"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-input"><span class="LIDENT">input</span></a> <a href="#local_ic_75"><span class="LIDENT">ic</span></a> <a href="#local_buf_76"><span class="LIDENT">buf</span></a> <a href="#local_ofs_78"><span class="LIDENT">ofs</span></a> <a href="#local_to_read_79"><span class="LIDENT">to_read</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_r_80"><span class="LIDENT">r</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_already_read_77"><span class="LIDENT">already_read</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="BEGIN">begin</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_already_read_81"><span class="LIDENT">already_read</span></span> <span class="EQUAL">=</span> <a href="#local_already_read_77"><span class="LIDENT">already_read</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_r_80"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ofs_82"><span class="LIDENT">ofs</span></span> <span class="EQUAL">=</span> <a href="#local_ofs_78"><span class="LIDENT">ofs</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_r_80"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_to_read_83"><span class="LIDENT">to_read</span></span> <span class="EQUAL">=</span> <a href="#local_to_read_79"><span class="LIDENT">to_read</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_r_80"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_loop_74"><span class="LIDENT">loop</span></a> <a href="#local_ic_75"><span class="LIDENT">ic</span></a> <a href="#local_buf_76"><span class="LIDENT">buf</span></a> <span class="TILDE">~</span><a href="#local_already_read_81"><span class="LIDENT">already_read</span></a> <span class="TILDE">~</span><a href="#local_ofs_82"><span class="LIDENT">ofs</span></a> <span class="TILDE">~</span><a href="#local_to_read_83"><span class="LIDENT">to_read</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>    <span class="END">end</span><span class="EOL">
</span>  <span class="IN">in</span> <a href="#local_loop_74"><span class="LIDENT">loop</span></a> <a href="#local_ic_70"><span class="LIDENT">ic</span></a> <a href="#local_buf_71"><span class="LIDENT">buf</span></a> <span class="LABEL">~already_read:</span><span class="INT">0</span> <span class="TILDE">~</span><a href="#local_ofs_72"><span class="LIDENT">ofs</span></a> <span class="LABEL">~to_read:</span><a href="#local_len_73"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unsafe_add_channel_up_to"><span class="LIDENT">unsafe_add_channel_up_to</span></span> <span id="local_b_84"><span class="LIDENT">b</span></span> <span id="local_ic_85"><span class="LIDENT">ic</span></span> <span id="local_len_86"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_b_84"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_len_86"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_b_84"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">length</span> <span class="THEN">then</span> <span class="LIDENT">resize</span> <a href="#local_b_84"><span class="LIDENT">b</span></a> <a href="#local_len_86"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_87"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">really_input_up_to</span> <a href="#local_ic_85"><span class="LIDENT">ic</span></a> <a href="#local_b_84"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_84"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_len_86"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_b_84"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_b_84"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_n_87"><span class="LIDENT">n</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_n_87"><span class="LIDENT">n</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_channel"><span class="LIDENT">add_channel</span></span> <span id="local_b_88"><span class="LIDENT">b</span></span> <span id="local_ic_89"><span class="LIDENT">ic</span></span> <span id="local_len_90"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_len_90"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_len_90"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a> <span class="THEN">then</span>   <span class="COMMENT">(* PR#5004 *)</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Buffer.add_channel&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_n_91"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <span class="LIDENT">unsafe_add_channel_up_to</span> <a href="#local_b_88"><span class="LIDENT">b</span></a> <a href="#local_ic_89"><span class="LIDENT">ic</span></a> <a href="#local_len_90"><span class="LIDENT">len</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* It is intentional that a consumer catching End_of_file
     will see the data written (see #6719, #7136). *)</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_n_91"><span class="LIDENT">n</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_len_90"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">End_of_file</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-output_buffer"><span class="LIDENT">output_buffer</span></span> <span id="local_oc_92"><span class="LIDENT">oc</span></span> <span id="local_b_93"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="stdlib.ml.html#val-output"><span class="LIDENT">output</span></a> <a href="#local_oc_92"><span class="LIDENT">oc</span></a> <a href="#local_b_93"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <span class="INT">0</span> <a href="#local_b_93"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-closing"><span class="LIDENT">closing</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'('</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">')'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'{'</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'}'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* opening and closing: open and close characters, typically ( and )
   k: balance of opening and closing chars
   s: the string where we are searching
   start: the index where we start the search. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-advance_to_closing"><span class="LIDENT">advance_to_closing</span></span> <span id="local_opening_94"><span class="LIDENT">opening</span></span> <span id="local_closing_95"><span class="LIDENT">closing</span></span> <span id="local_k_96"><span class="LIDENT">k</span></span> <span id="local_s_97"><span class="LIDENT">s</span></span> <span id="local_start_98"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_advance_99"><span class="LIDENT">advance</span></span> <span id="local_k_100"><span class="LIDENT">k</span></span> <span id="local_i_101"><span class="LIDENT">i</span></span> <span id="local_lim_102"><span class="LIDENT">lim</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_101"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_lim_102"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_s_97"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_101"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_opening_94"><span class="LIDENT">opening</span></a> <span class="THEN">then</span> <a href="#local_advance_99"><span class="LIDENT">advance</span></a> <span class="LPAREN">(</span><a href="#local_k_100"><span class="LIDENT">k</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_i_101"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_lim_102"><span class="LIDENT">lim</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_s_97"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_101"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_closing_95"><span class="LIDENT">closing</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_k_100"><span class="LIDENT">k</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_i_101"><span class="LIDENT">i</span></a> <span class="ELSE">else</span> <a href="#local_advance_99"><span class="LIDENT">advance</span></a> <span class="LPAREN">(</span><a href="#local_k_100"><span class="LIDENT">k</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_i_101"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_lim_102"><span class="LIDENT">lim</span></a><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_advance_99"><span class="LIDENT">advance</span></a> <a href="#local_k_100"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><a href="#local_i_101"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_lim_102"><span class="LIDENT">lim</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_advance_99"><span class="LIDENT">advance</span></a> <a href="#local_k_96"><span class="LIDENT">k</span></a> <a href="#local_start_98"><span class="LIDENT">start</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_97"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-advance_to_non_alpha"><span class="LIDENT">advance_to_non_alpha</span></span> <span id="local_s_103"><span class="LIDENT">s</span></span> <span id="local_start_104"><span class="LIDENT">start</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_advance_105"><span class="LIDENT">advance</span></span> <span id="local_i_106"><span class="LIDENT">i</span></span> <span id="local_lim_107"><span class="LIDENT">lim</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_106"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_lim_107"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <a href="#local_lim_107"><span class="LIDENT">lim</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_s_103"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_106"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'a'</span> <span class="DOTDOT">..</span> <span class="CHAR">'z'</span> <span class="BAR">|</span> <span class="CHAR">'A'</span> <span class="DOTDOT">..</span> <span class="CHAR">'Z'</span> <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'_'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_advance_105"><span class="LIDENT">advance</span></a> <span class="LPAREN">(</span><a href="#local_i_106"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_lim_107"><span class="LIDENT">lim</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_i_106"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_advance_105"><span class="LIDENT">advance</span></a> <a href="#local_start_104"><span class="LIDENT">start</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_103"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* We are just at the beginning of an ident in s, starting at start. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-find_ident"><span class="LIDENT">find_ident</span></span> <span id="local_s_108"><span class="LIDENT">s</span></span> <span id="local_start_109"><span class="LIDENT">start</span></span> <span id="local_lim_110"><span class="LIDENT">lim</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_start_109"><span class="LIDENT">start</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_lim_110"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span> <span class="ELSE">else</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_s_108"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_start_109"><span class="LIDENT">start</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="COMMENT">(* Parenthesized ident ? *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'('</span> <span class="BAR">|</span> <span class="CHAR">'{'</span> <span class="AS">as</span> <span id="local_c_111"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LET">let</span> <span id="local_new_start_112"><span class="LIDENT">new_start</span></span> <span class="EQUAL">=</span> <a href="#local_start_109"><span class="LIDENT">start</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>     <span class="LET">let</span> <span id="local_stop_113"><span class="LIDENT">stop</span></span> <span class="EQUAL">=</span> <span class="LIDENT">advance_to_closing</span> <a href="#local_c_111"><span class="LIDENT">c</span></a> <span class="LPAREN">(</span><span class="LIDENT">closing</span> <a href="#local_c_111"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="INT">0</span> <a href="#local_s_108"><span class="LIDENT">s</span></a> <a href="#local_new_start_112"><span class="LIDENT">new_start</span></a> <span class="IN">in</span><span class="EOL">
</span>     <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_s_108"><span class="LIDENT">s</span></a> <a href="#local_new_start_112"><span class="LIDENT">new_start</span></a> <span class="LPAREN">(</span><a href="#local_stop_113"><span class="LIDENT">stop</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_start_109"><span class="LIDENT">start</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_stop_113"><span class="LIDENT">stop</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>  <span class="COMMENT">(* Regular ident *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LET">let</span> <span id="local_stop_114"><span class="LIDENT">stop</span></span> <span class="EQUAL">=</span> <span class="LIDENT">advance_to_non_alpha</span> <a href="#local_s_108"><span class="LIDENT">s</span></a> <a href="#local_start_109"><span class="LIDENT">start</span></a> <span class="IN">in</span><span class="EOL">
</span>     <span class="IF">if</span> <a href="#local_stop_114"><span class="LIDENT">stop</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_start_109"><span class="LIDENT">start</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span> <span class="ELSE">else</span><span class="EOL">
</span>     <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_s_108"><span class="LIDENT">s</span></a> <a href="#local_start_109"><span class="LIDENT">start</span></a> <span class="LPAREN">(</span><a href="#local_stop_114"><span class="LIDENT">stop</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_start_109"><span class="LIDENT">start</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_stop_114"><span class="LIDENT">stop</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Substitute $ident, $(ident), or ${ident} in s,
    according to the function mapping f. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_substitute"><span class="LIDENT">add_substitute</span></span> <span id="local_b_115"><span class="LIDENT">b</span></span> <span id="local_f_116"><span class="LIDENT">f</span></span> <span id="local_s_117"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_lim_118"><span class="LIDENT">lim</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_117"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_subst_119"><span class="LIDENT">subst</span></span> <span id="local_previous_120"><span class="LIDENT">previous</span></span> <span id="local_i_121"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_lim_118"><span class="LIDENT">lim</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_s_117"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_121"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'$'</span> <span class="AS">as</span> <span id="local_current_122"><span class="LIDENT">current</span></span> <span class="WHEN">when</span> <a href="#local_previous_120"><span class="LIDENT">previous</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'\\'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LIDENT">add_char</span> <a href="#local_b_115"><span class="LIDENT">b</span></a> <a href="#local_current_122"><span class="LIDENT">current</span></a><span class="SEMI">;</span><span class="EOL">
</span>         <a href="#local_subst_119"><span class="LIDENT">subst</span></a> <span class="CHAR">' '</span> <span class="LPAREN">(</span><a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'$'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="LET">let</span> <span id="local_j_123"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span> <a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>         <span class="BEGIN">begin</span> <span class="MATCH">match</span> <span class="LIDENT">find_ident</span> <a href="#local_s_117"><span class="LIDENT">s</span></a> <a href="#local_j_123"><span class="LIDENT">j</span></a> <a href="#local_lim_118"><span class="LIDENT">lim</span></a> <span class="WITH">with</span><span class="EOL">
</span>         <span class="BAR">|</span> <span id="local_ident_124"><span class="LIDENT">ident</span></span><span class="COMMA">,</span> <span id="local_next_i_125"><span class="LIDENT">next_i</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="LIDENT">add_string</span> <a href="#local_b_115"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_f_116"><span class="LIDENT">f</span></a> <a href="#local_ident_124"><span class="LIDENT">ident</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>           <a href="#local_subst_119"><span class="LIDENT">subst</span></a> <span class="CHAR">' '</span> <a href="#local_next_i_125"><span class="LIDENT">next_i</span></a><span class="EOL">
</span>         <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="LIDENT">add_char</span> <a href="#local_b_115"><span class="LIDENT">b</span></a> <span class="CHAR">'$'</span><span class="SEMI">;</span><span class="EOL">
</span>           <a href="#local_subst_119"><span class="LIDENT">subst</span></a> <span class="CHAR">' '</span> <a href="#local_j_123"><span class="LIDENT">j</span></a><span class="EOL">
</span>         <span class="END">end</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_current_126"><span class="LIDENT">current</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="IF">if</span> <a href="#local_previous_120"><span class="LIDENT">previous</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'\\'</span> <span class="THEN">then</span> <span class="LIDENT">add_char</span> <a href="#local_b_115"><span class="LIDENT">b</span></a> <a href="#local_previous_120"><span class="LIDENT">previous</span></a><span class="SEMI">;</span><span class="EOL">
</span>         <span class="IF">if</span> <a href="#local_current_126"><span class="LIDENT">current</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="CHAR">'\\'</span> <span class="THEN">then</span> <span class="LIDENT">add_char</span> <a href="#local_b_115"><span class="LIDENT">b</span></a> <a href="#local_current_126"><span class="LIDENT">current</span></a><span class="SEMI">;</span><span class="EOL">
</span>         <a href="#local_subst_119"><span class="LIDENT">subst</span></a> <a href="#local_current_126"><span class="LIDENT">current</span></a> <span class="LPAREN">(</span><a href="#local_i_121"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="END">end</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_previous_120"><span class="LIDENT">previous</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'\\'</span> <span class="THEN">then</span> <span class="LIDENT">add_char</span> <a href="#local_b_115"><span class="LIDENT">b</span></a> <a href="#local_previous_120"><span class="LIDENT">previous</span></a> <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_subst_119"><span class="LIDENT">subst</span></a> <span class="CHAR">' '</span> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-truncate"><span class="LIDENT">truncate</span></span> <span id="local_b_127"><span class="LIDENT">b</span></span> <span id="local_len_128"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_len_128"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_len_128"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="LIDENT">length</span> <a href="#local_b_127"><span class="LIDENT">b</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <span class="STRING">&quot;Buffer.truncate&quot;</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <a href="#local_b_127"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_len_128"><span class="LIDENT">len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** {1 Iterators} *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_seq"><span class="LIDENT">to_seq</span></span> <span id="local_b_129"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_130"><span class="LIDENT">aux</span></span> <span id="local_i_131"><span class="LIDENT">i</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* Note that b.position is not a constant and cannot be lifted out of aux *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_131"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_b_129"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="THEN">then</span> <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Nil</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_x_132"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_b_129"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_i_131"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><a href="#local_x_132"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_aux_130"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><a href="#local_i_131"><span class="LIDENT">i</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_aux_130"><span class="LIDENT">aux</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-to_seqi"><span class="LIDENT">to_seqi</span></span> <span id="local_b_133"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_aux_134"><span class="LIDENT">aux</span></span> <span id="local_i_135"><span class="LIDENT">i</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="COMMENT">(* Note that b.position is not a constant and cannot be lifted out of aux *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_135"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_b_133"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="THEN">then</span> <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Nil</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_x_136"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_b_133"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_i_135"><span class="LIDENT">i</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Seq</span><span class="DOT">.</span><span class="UIDENT">Cons</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_i_135"><span class="LIDENT">i</span></a><span class="COMMA">,</span><a href="#local_x_136"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_aux_134"><span class="LIDENT">aux</span></a> <span class="LPAREN">(</span><a href="#local_i_135"><span class="LIDENT">i</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <a href="#local_aux_134"><span class="LIDENT">aux</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_seq"><span class="LIDENT">add_seq</span></span> <span id="local_b_137"><span class="LIDENT">b</span></span> <span id="local_seq_138"><span class="LIDENT">seq</span></span> <span class="EQUAL">=</span> <a href="seq.ml.html#val-iter"><span class="UIDENT">Seq</span><span class="DOT">.</span><span class="LIDENT">iter</span></a> <span class="LPAREN">(</span><span class="LIDENT">add_char</span> <a href="#local_b_137"><span class="LIDENT">b</span></a><span class="RPAREN">)</span> <a href="#local_seq_138"><span class="LIDENT">seq</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-of_seq"><span class="LIDENT">of_seq</span></span> <span id="local_i_139"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_b_140"><span class="LIDENT">b</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create</span> <span class="INT">32</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">add_seq</span> <a href="#local_b_140"><span class="LIDENT">b</span></a> <a href="#local_i_139"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_140"><span class="LIDENT">b</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="DOCSTRING">(** {6 Binary encoding of integers} *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-unsafe_set_int8"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_int8</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_unsafe_set&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_set_int16"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_int16</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set16u&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_set_int32"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_int32</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set32u&quot;</span></span><span class="EOL">
</span><span id="val-unsafe_set_int64"><span class="EXTERNAL">external</span> <span class="LIDENT">unsafe_set_int64</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set64u&quot;</span></span><span class="EOL">
</span><span id="val-set_int8"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int8</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bytes_safe_set&quot;</span></span><span class="EOL">
</span><span id="val-set_int16"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int16</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set16&quot;</span></span><span class="EOL">
</span><span id="val-set_int32"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int32</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set32&quot;</span></span><span class="EOL">
</span><span id="val-set_int64"><span class="EXTERNAL">external</span> <span class="LIDENT">set_int64</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%caml_bytes_set64&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="val-swap16"><span class="EXTERNAL">external</span> <span class="LIDENT">swap16</span> <span class="COLON">:</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap16&quot;</span></span><span class="EOL">
</span><span id="val-swap32"><span class="EXTERNAL">external</span> <span class="LIDENT">swap32</span> <span class="COLON">:</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap_int32&quot;</span></span><span class="EOL">
</span><span id="val-swap64"><span class="EXTERNAL">external</span> <span class="LIDENT">swap64</span> <span class="COLON">:</span> <span class="LIDENT">int64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="EQUAL">=</span> <span class="STRING">&quot;%bswap_int64&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int8"><span class="LIDENT">add_int8</span></span> <span id="local_b_141"><span class="LIDENT">b</span></span> <span id="local_x_142"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_143"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_141"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_182"><span class="LBRACE">{</span><span id="local_length_145"><span class="LIDENT">length</span></span><span class="SEMI">;</span> <span id="local_buffer_144"><span class="LIDENT">buffer</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_141"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_position_146"><span class="LIDENT">new_position</span></span> <span class="EQUAL">=</span> <a href="#local_position_143"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_new_position_146"><span class="LIDENT">new_position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_145"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_141"><span class="LIDENT">b</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">set_int8</span> <a href="#local_b_141"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_141"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_x_142"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_int8</span> <a href="#local_buffer_144"><span class="LIDENT">buffer</span></a> <a href="#local_position_143"><span class="LIDENT">position</span></a> <a href="#local_x_142"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_141"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_position_146"><span class="LIDENT">new_position</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int16_ne"><span class="LIDENT">add_int16_ne</span></span> <span id="local_b_147"><span class="LIDENT">b</span></span> <span id="local_x_148"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_149"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_147"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_188"><span class="LBRACE">{</span><span id="local_length_151"><span class="LIDENT">length</span></span><span class="SEMI">;</span> <span id="local_buffer_150"><span class="LIDENT">buffer</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_147"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_position_152"><span class="LIDENT">new_position</span></span> <span class="EQUAL">=</span> <a href="#local_position_149"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_new_position_152"><span class="LIDENT">new_position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_151"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_147"><span class="LIDENT">b</span></a> <span class="INT">2</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">set_int16</span> <a href="#local_b_147"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_147"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_x_148"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_int16</span> <a href="#local_buffer_150"><span class="LIDENT">buffer</span></a> <a href="#local_position_149"><span class="LIDENT">position</span></a> <a href="#local_x_148"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_147"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_position_152"><span class="LIDENT">new_position</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int32_ne"><span class="LIDENT">add_int32_ne</span></span> <span id="local_b_153"><span class="LIDENT">b</span></span> <span id="local_x_154"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_155"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_153"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_185"><span class="LBRACE">{</span><span id="local_length_157"><span class="LIDENT">length</span></span><span class="SEMI">;</span> <span id="local_buffer_156"><span class="LIDENT">buffer</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_153"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_position_158"><span class="LIDENT">new_position</span></span> <span class="EQUAL">=</span> <a href="#local_position_155"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_new_position_158"><span class="LIDENT">new_position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_157"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_153"><span class="LIDENT">b</span></a> <span class="INT">4</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">set_int32</span> <a href="#local_b_153"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_153"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_x_154"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_int32</span> <a href="#local_buffer_156"><span class="LIDENT">buffer</span></a> <a href="#local_position_155"><span class="LIDENT">position</span></a> <a href="#local_x_154"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_153"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_position_158"><span class="LIDENT">new_position</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int64_ne"><span class="LIDENT">add_int64_ne</span></span> <span id="local_b_159"><span class="LIDENT">b</span></span> <span id="local_x_160"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_position_161"><span class="LIDENT">position</span></span> <span class="EQUAL">=</span> <a href="#local_b_159"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_180"><span class="LBRACE">{</span><span id="local_length_163"><span class="LIDENT">length</span></span><span class="SEMI">;</span> <span id="local_buffer_162"><span class="LIDENT">buffer</span></span><span class="RBRACE">}</span></span> <span class="EQUAL">=</span> <a href="#local_b_159"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_position_164"><span class="LIDENT">new_position</span></span> <span class="EQUAL">=</span> <a href="#local_position_161"><span class="LIDENT">position</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">8</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_new_position_164"><span class="LIDENT">new_position</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_length_163"><span class="LIDENT">length</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LIDENT">resize</span> <a href="#local_b_159"><span class="LIDENT">b</span></a> <span class="INT">8</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">set_int64</span> <a href="#local_b_159"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">inner</span><span class="DOT">.</span><span class="LIDENT">buffer</span> <a href="#local_b_159"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <a href="#local_x_160"><span class="LIDENT">x</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LIDENT">unsafe_set_int64</span> <a href="#local_buffer_162"><span class="LIDENT">buffer</span></a> <a href="#local_position_161"><span class="LIDENT">position</span></a> <a href="#local_x_160"><span class="LIDENT">x</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_b_159"><span class="LIDENT">b</span></a><span class="DOT">.</span><span class="LIDENT">position</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_position_164"><span class="LIDENT">new_position</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int16_le"><span class="LIDENT">add_int16_le</span></span> <span id="local_b_165"><span class="LIDENT">b</span></span> <span id="local_x_166"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_int16_ne</span> <a href="#local_b_165"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap16</span> <a href="#local_x_166"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_x_166"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int16_be"><span class="LIDENT">add_int16_be</span></span> <span id="local_b_167"><span class="LIDENT">b</span></span> <span id="local_x_168"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_int16_ne</span> <a href="#local_b_167"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <a href="#local_x_168"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="LIDENT">swap16</span> <a href="#local_x_168"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int32_le"><span class="LIDENT">add_int32_le</span></span> <span id="local_b_169"><span class="LIDENT">b</span></span> <span id="local_x_170"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_int32_ne</span> <a href="#local_b_169"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap32</span> <a href="#local_x_170"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_x_170"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int32_be"><span class="LIDENT">add_int32_be</span></span> <span id="local_b_171"><span class="LIDENT">b</span></span> <span id="local_x_172"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_int32_ne</span> <a href="#local_b_171"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <a href="#local_x_172"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="LIDENT">swap32</span> <a href="#local_x_172"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int64_le"><span class="LIDENT">add_int64_le</span></span> <span id="local_b_173"><span class="LIDENT">b</span></span> <span id="local_x_174"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_int64_ne</span> <a href="#local_b_173"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <span class="LIDENT">swap64</span> <a href="#local_x_174"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <a href="#local_x_174"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_int64_be"><span class="LIDENT">add_int64_be</span></span> <span id="local_b_175"><span class="LIDENT">b</span></span> <span id="local_x_176"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">add_int64_ne</span> <a href="#local_b_175"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="sys.ml.html#val-big_endian"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">big_endian</span></a> <span class="THEN">then</span> <a href="#local_x_176"><span class="LIDENT">x</span></a> <span class="ELSE">else</span> <span class="LIDENT">swap64</span> <a href="#local_x_176"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_uint8"><span class="LIDENT">add_uint8</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_int8</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_uint16_ne"><span class="LIDENT">add_uint16_ne</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_int16_ne</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_uint16_le"><span class="LIDENT">add_uint16_le</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_int16_le</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_uint16_be"><span class="LIDENT">add_uint16_be</span></span> <span class="EQUAL">=</span> <span class="LIDENT">add_int16_be</span><span class="EOL">
</span></span></code></pre></body></html>
