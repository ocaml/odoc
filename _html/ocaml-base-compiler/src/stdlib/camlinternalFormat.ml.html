<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: camlinternalFormat.ml (ocaml-base-compiler.src.stdlib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ocaml-base-compiler</a> &#x00BB; <a href="../index.html">Sources</a> &#x00BB; stdlib &#x00BB; camlinternalFormat.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>camlinternalFormat.ml</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-global-toc"><ul><li><a href="../../index.html">ocaml-base-compiler</a><ul><li>Library <code>compiler-libs.bytecomp</code><ul><li><a href="../../compiler-libs.bytecomp/Bytegen/index.html">Bytegen</a></li><li><a href="../../compiler-libs.bytecomp/Bytelibrarian/index.html">Bytelibrarian</a></li><li><a href="../../compiler-libs.bytecomp/Bytelink/index.html">Bytelink</a></li><li><a href="../../compiler-libs.bytecomp/Bytepackager/index.html">Bytepackager</a></li><li><a href="../../compiler-libs.bytecomp/Compile/index.html">Compile</a></li><li><a href="../../compiler-libs.bytecomp/Emitcode/index.html">Emitcode</a></li><li><a href="../../compiler-libs.bytecomp/Errors/index.html">Errors</a></li><li><a href="../../compiler-libs.bytecomp/Instruct/index.html">Instruct</a></li><li><a href="../../compiler-libs.bytecomp/Maindriver/index.html">Maindriver</a></li><li><a href="../../compiler-libs.bytecomp/Printinstr/index.html">Printinstr</a></li></ul></li><li>Library <code>compiler-libs.common</code><ul><li><a href="../../compiler-libs.common/Annot/index.html">Annot</a></li><li><a href="../../compiler-libs.common/Arg_helper/index.html">Arg_helper</a></li><li><a href="../../compiler-libs.common/Ast_helper/index.html">Ast_helper</a></li><li><a href="../../compiler-libs.common/Ast_invariants/index.html">Ast_invariants</a></li><li><a href="../../compiler-libs.common/Ast_iterator/index.html">Ast_iterator</a></li><li><a href="../../compiler-libs.common/Ast_mapper/index.html">Ast_mapper</a></li><li><a href="../../compiler-libs.common/Asttypes/index.html">Asttypes</a></li><li><a href="../../compiler-libs.common/Attr_helper/index.html">Attr_helper</a></li><li><a href="../../compiler-libs.common/Binutils/index.html">Binutils</a></li><li><a href="../../compiler-libs.common/Btype/index.html">Btype</a></li><li><a href="../../compiler-libs.common/Build_path_prefix_map/index.html">Build_path_prefix_map</a></li><li><a href="../../compiler-libs.common/Builtin_attributes/index.html">Builtin_attributes</a></li><li><a href="../../compiler-libs.common/Bytesections/index.html">Bytesections</a></li><li><a href="../../compiler-libs.common/CamlinternalMenhirLib/index.html">CamlinternalMenhirLib</a></li><li><a href="../../compiler-libs.common/Ccomp/index.html">Ccomp</a></li><li><a href="../../compiler-libs.common/Clflags/index.html">Clflags</a></li><li><a href="../../compiler-libs.common/Cmi_format/index.html">Cmi_format</a></li><li><a href="../../compiler-libs.common/Cmo_format/index.html">Cmo_format</a></li><li><a href="../../compiler-libs.common/Cmt2annot/index.html">Cmt2annot</a></li><li><a href="../../compiler-libs.common/Cmt_format/index.html">Cmt_format</a></li><li><a href="../../compiler-libs.common/Compenv/index.html">Compenv</a></li><li><a href="../../compiler-libs.common/Compile_common/index.html">Compile_common</a></li><li><a href="../../compiler-libs.common/Compmisc/index.html">Compmisc</a></li><li><a href="../../compiler-libs.common/Compression/index.html">Compression</a></li><li><a href="../../compiler-libs.common/Config/index.html">Config</a></li><li><a href="../../compiler-libs.common/Config_boot/index.html">Config_boot</a></li><li><a href="../../compiler-libs.common/Config_main/index.html">Config_main</a></li><li><a href="../../compiler-libs.common/Consistbl/index.html">Consistbl</a></li><li><a href="../../compiler-libs.common/Ctype/index.html">Ctype</a></li><li><a href="../../compiler-libs.common/Datarepr/index.html">Datarepr</a></li><li><a href="../../compiler-libs.common/Debuginfo/index.html">Debuginfo</a></li><li><a href="../../compiler-libs.common/Depend/index.html">Depend</a></li><li><a href="../../compiler-libs.common/Diffing/index.html">Diffing</a></li><li><a href="../../compiler-libs.common/Diffing_with_keys/index.html">Diffing_with_keys</a></li><li><a href="../../compiler-libs.common/Dll/index.html">Dll</a></li><li><a href="../../compiler-libs.common/Docstrings/index.html">Docstrings</a></li><li><a href="../../compiler-libs.common/Domainstate/index.html">Domainstate</a></li><li><a href="../../compiler-libs.common/Env/index.html">Env</a></li><li><a href="../../compiler-libs.common/Envaux/index.html">Envaux</a></li><li><a href="../../compiler-libs.common/Errortrace/index.html">Errortrace</a></li><li><a href="../../compiler-libs.common/Expunge/index.html">Expunge</a></li><li><a href="../../compiler-libs.common/Ident/index.html">Ident</a></li><li><a href="../../compiler-libs.common/Identifiable/index.html">Identifiable</a></li><li><a href="../../compiler-libs.common/Includeclass/index.html">Includeclass</a></li><li><a href="../../compiler-libs.common/Includecore/index.html">Includecore</a></li><li><a href="../../compiler-libs.common/Includemod/index.html">Includemod</a></li><li><a href="../../compiler-libs.common/Includemod_errorprinter/index.html">Includemod_errorprinter</a></li><li><a href="../../compiler-libs.common/Int_replace_polymorphic_compare/index.html">Int_replace_polymorphic_compare</a></li><li><a href="../../compiler-libs.common/Lambda/index.html">Lambda</a></li><li><a href="../../compiler-libs.common/Lazy_backtrack/index.html">Lazy_backtrack</a></li><li><a href="../../compiler-libs.common/Lexer/index.html">Lexer</a></li><li><a href="../../compiler-libs.common/Load_path/index.html">Load_path</a></li><li><a href="../../compiler-libs.common/Local_store/index.html">Local_store</a></li><li><a href="../../compiler-libs.common/Location/index.html">Location</a></li><li><a href="../../compiler-libs.common/Longident/index.html">Longident</a></li><li><a href="../../compiler-libs.common/Main_args/index.html">Main_args</a></li><li><a href="../../compiler-libs.common/Makedepend/index.html">Makedepend</a></li><li><a href="../../compiler-libs.common/Matching/index.html">Matching</a></li><li><a href="../../compiler-libs.common/Meta/index.html">Meta</a></li><li><a href="../../compiler-libs.common/Misc/index.html">Misc</a></li><li><a href="../../compiler-libs.common/Mtype/index.html">Mtype</a></li><li><a href="../../compiler-libs.common/Numbers/index.html">Numbers</a></li><li><a href="../../compiler-libs.common/Opcodes/index.html">Opcodes</a></li><li><a href="../../compiler-libs.common/Oprint/index.html">Oprint</a></li><li><a href="../../compiler-libs.common/Outcometree/index.html">Outcometree</a></li><li><a href="../../compiler-libs.common/Parmatch/index.html">Parmatch</a></li><li><a href="../../compiler-libs.common/Parse/index.html">Parse</a></li><li><a href="../../compiler-libs.common/Parser/index.html">Parser</a></li><li><a href="../../compiler-libs.common/Parsetree/index.html">Parsetree</a></li><li><a href="../../compiler-libs.common/Path/index.html">Path</a></li><li><a href="../../compiler-libs.common/Patterns/index.html">Patterns</a></li><li><a href="../../compiler-libs.common/Persistent_env/index.html">Persistent_env</a></li><li><a href="../../compiler-libs.common/Pparse/index.html">Pparse</a></li><li><a href="../../compiler-libs.common/Pprintast/index.html">Pprintast</a></li><li><a href="../../compiler-libs.common/Predef/index.html">Predef</a></li><li><a href="../../compiler-libs.common/Primitive/index.html">Primitive</a></li><li><a href="../../compiler-libs.common/Printast/index.html">Printast</a></li><li><a href="../../compiler-libs.common/Printlambda/index.html">Printlambda</a></li><li><a href="../../compiler-libs.common/Printpat/index.html">Printpat</a></li><li><a href="../../compiler-libs.common/Printtyp/index.html">Printtyp</a></li><li><a href="../../compiler-libs.common/Printtyped/index.html">Printtyped</a></li><li><a href="../../compiler-libs.common/Profile/index.html">Profile</a></li><li><a href="../../compiler-libs.common/Runtimedef/index.html">Runtimedef</a></li><li><a href="../../compiler-libs.common/Shape/index.html">Shape</a></li><li><a href="../../compiler-libs.common/Shape_reduce/index.html">Shape_reduce</a></li><li><a href="../../compiler-libs.common/Signature_group/index.html">Signature_group</a></li><li><a href="../../compiler-libs.common/Simplif/index.html">Simplif</a></li><li><a href="../../compiler-libs.common/Strongly_connected_components/index.html">Strongly_connected_components</a></li><li><a href="../../compiler-libs.common/Stypes/index.html">Stypes</a></li><li><a href="../../compiler-libs.common/Subst/index.html">Subst</a></li><li><a href="../../compiler-libs.common/Switch/index.html">Switch</a></li><li><a href="../../compiler-libs.common/Symtable/index.html">Symtable</a></li><li><a href="../../compiler-libs.common/Syntaxerr/index.html">Syntaxerr</a></li><li><a href="../../compiler-libs.common/Targetint/index.html">Targetint</a></li><li><a href="../../compiler-libs.common/Tast_iterator/index.html">Tast_iterator</a></li><li><a href="../../compiler-libs.common/Tast_mapper/index.html">Tast_mapper</a></li><li><a href="../../compiler-libs.common/Terminfo/index.html">Terminfo</a></li><li><a href="../../compiler-libs.common/Tmc/index.html">Tmc</a></li><li><a href="../../compiler-libs.common/Translattribute/index.html">Translattribute</a></li><li><a href="../../compiler-libs.common/Translclass/index.html">Translclass</a></li><li><a href="../../compiler-libs.common/Translcore/index.html">Translcore</a></li><li><a href="../../compiler-libs.common/Translmod/index.html">Translmod</a></li><li><a href="../../compiler-libs.common/Translobj/index.html">Translobj</a></li><li><a href="../../compiler-libs.common/Translprim/index.html">Translprim</a></li><li><a href="../../compiler-libs.common/Type_immediacy/index.html">Type_immediacy</a></li><li><a href="../../compiler-libs.common/Typeclass/index.html">Typeclass</a></li><li><a href="../../compiler-libs.common/Typecore/index.html">Typecore</a></li><li><a href="../../compiler-libs.common/Typedecl/index.html">Typedecl</a></li><li><a href="../../compiler-libs.common/Typedecl_immediacy/index.html">Typedecl_immediacy</a></li><li><a href="../../compiler-libs.common/Typedecl_properties/index.html">Typedecl_properties</a></li><li><a href="../../compiler-libs.common/Typedecl_separability/index.html">Typedecl_separability</a></li><li><a href="../../compiler-libs.common/Typedecl_unboxed/index.html">Typedecl_unboxed</a></li><li><a href="../../compiler-libs.common/Typedecl_variance/index.html">Typedecl_variance</a></li><li><a href="../../compiler-libs.common/Typedtree/index.html">Typedtree</a></li><li><a href="../../compiler-libs.common/Typemod/index.html">Typemod</a></li><li><a href="../../compiler-libs.common/Typeopt/index.html">Typeopt</a></li><li><a href="../../compiler-libs.common/Types/index.html">Types</a></li><li><a href="../../compiler-libs.common/Typetexp/index.html">Typetexp</a></li><li><a href="../../compiler-libs.common/Unit_info/index.html">Unit_info</a></li><li><a href="../../compiler-libs.common/Untypeast/index.html">Untypeast</a></li><li><a href="../../compiler-libs.common/Value_rec_check/index.html">Value_rec_check</a></li><li><a href="../../compiler-libs.common/Value_rec_compiler/index.html">Value_rec_compiler</a></li><li><a href="../../compiler-libs.common/Value_rec_types/index.html">Value_rec_types</a></li><li><a href="../../compiler-libs.common/Warnings/index.html">Warnings</a></li><li><a href="../../compiler-libs.common/X86_ast/index.html">X86_ast</a></li></ul></li><li>Library <code>compiler-libs.optcomp</code><ul><li><a href="../../compiler-libs.optcomp/Afl_instrument/index.html">Afl_instrument</a></li><li><a href="../../compiler-libs.optcomp/Alias_analysis/index.html">Alias_analysis</a></li><li><a href="../../compiler-libs.optcomp/Allocated_const/index.html">Allocated_const</a></li><li><a href="../../compiler-libs.optcomp/Arch/index.html">Arch</a></li><li><a href="../../compiler-libs.optcomp/Asmgen/index.html">Asmgen</a></li><li><a href="../../compiler-libs.optcomp/Asmlibrarian/index.html">Asmlibrarian</a></li><li><a href="../../compiler-libs.optcomp/Asmlink/index.html">Asmlink</a></li><li><a href="../../compiler-libs.optcomp/Asmpackager/index.html">Asmpackager</a></li><li><a href="../../compiler-libs.optcomp/Augment_specialised_args/index.html">Augment_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Backend_intf/index.html">Backend_intf</a></li><li><a href="../../compiler-libs.optcomp/Backend_var/index.html">Backend_var</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation/index.html">Branch_relaxation</a></li><li><a href="../../compiler-libs.optcomp/Branch_relaxation_intf/index.html">Branch_relaxation_intf</a></li><li><a href="../../compiler-libs.optcomp/Build_export_info/index.html">Build_export_info</a></li><li><a href="../../compiler-libs.optcomp/CSE/index.html">CSE</a></li><li><a href="../../compiler-libs.optcomp/CSEgen/index.html">CSEgen</a></li><li><a href="../../compiler-libs.optcomp/Clambda/index.html">Clambda</a></li><li><a href="../../compiler-libs.optcomp/Clambda_primitives/index.html">Clambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Closure/index.html">Closure</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion/index.html">Closure_conversion</a></li><li><a href="../../compiler-libs.optcomp/Closure_conversion_aux/index.html">Closure_conversion_aux</a></li><li><a href="../../compiler-libs.optcomp/Closure_element/index.html">Closure_element</a></li><li><a href="../../compiler-libs.optcomp/Closure_id/index.html">Closure_id</a></li><li><a href="../../compiler-libs.optcomp/Closure_middle_end/index.html">Closure_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Closure_offsets/index.html">Closure_offsets</a></li><li><a href="../../compiler-libs.optcomp/Closure_origin/index.html">Closure_origin</a></li><li><a href="../../compiler-libs.optcomp/Cmm/index.html">Cmm</a></li><li><a href="../../compiler-libs.optcomp/Cmm_helpers/index.html">Cmm_helpers</a></li><li><a href="../../compiler-libs.optcomp/Cmm_invariants/index.html">Cmm_invariants</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen/index.html">Cmmgen</a></li><li><a href="../../compiler-libs.optcomp/Cmmgen_state/index.html">Cmmgen_state</a></li><li><a href="../../compiler-libs.optcomp/Cmx_format/index.html">Cmx_format</a></li><li><a href="../../compiler-libs.optcomp/Cmxs_format/index.html">Cmxs_format</a></li><li><a href="../../compiler-libs.optcomp/Coloring/index.html">Coloring</a></li><li><a href="../../compiler-libs.optcomp/Comballoc/index.html">Comballoc</a></li><li><a href="../../compiler-libs.optcomp/Compilation_unit/index.html">Compilation_unit</a></li><li><a href="../../compiler-libs.optcomp/Compilenv/index.html">Compilenv</a></li><li><a href="../../compiler-libs.optcomp/Convert_primitives/index.html">Convert_primitives</a></li><li><a href="../../compiler-libs.optcomp/Dataflow/index.html">Dataflow</a></li><li><a href="../../compiler-libs.optcomp/Deadcode/index.html">Deadcode</a></li><li><a href="../../compiler-libs.optcomp/Effect_analysis/index.html">Effect_analysis</a></li><li><a href="../../compiler-libs.optcomp/Emit/index.html">Emit</a></li><li><a href="../../compiler-libs.optcomp/Emitaux/index.html">Emitaux</a></li><li><a href="../../compiler-libs.optcomp/Emitenv/index.html">Emitenv</a></li><li><a href="../../compiler-libs.optcomp/Export_id/index.html">Export_id</a></li><li><a href="../../compiler-libs.optcomp/Export_info/index.html">Export_info</a></li><li><a href="../../compiler-libs.optcomp/Export_info_for_pack/index.html">Export_info_for_pack</a></li><li><a href="../../compiler-libs.optcomp/Extract_projections/index.html">Extract_projections</a></li><li><a href="../../compiler-libs.optcomp/Find_recursive_functions/index.html">Find_recursive_functions</a></li><li><a href="../../compiler-libs.optcomp/Flambda/index.html">Flambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_invariants/index.html">Flambda_invariants</a></li><li><a href="../../compiler-libs.optcomp/Flambda_iterators/index.html">Flambda_iterators</a></li><li><a href="../../compiler-libs.optcomp/Flambda_middle_end/index.html">Flambda_middle_end</a></li><li><a href="../../compiler-libs.optcomp/Flambda_to_clambda/index.html">Flambda_to_clambda</a></li><li><a href="../../compiler-libs.optcomp/Flambda_utils/index.html">Flambda_utils</a></li><li><a href="../../compiler-libs.optcomp/Freshening/index.html">Freshening</a></li><li><a href="../../compiler-libs.optcomp/Id_types/index.html">Id_types</a></li><li><a href="../../compiler-libs.optcomp/Import_approx/index.html">Import_approx</a></li><li><a href="../../compiler-libs.optcomp/Inconstant_idents/index.html">Inconstant_idents</a></li><li><a href="../../compiler-libs.optcomp/Initialize_symbol_to_let_symbol/index.html">Initialize_symbol_to_let_symbol</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify/index.html">Inline_and_simplify</a></li><li><a href="../../compiler-libs.optcomp/Inline_and_simplify_aux/index.html">Inline_and_simplify_aux</a></li><li><a href="../../compiler-libs.optcomp/Inlining_cost/index.html">Inlining_cost</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision/index.html">Inlining_decision</a></li><li><a href="../../compiler-libs.optcomp/Inlining_decision_intf/index.html">Inlining_decision_intf</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats/index.html">Inlining_stats</a></li><li><a href="../../compiler-libs.optcomp/Inlining_stats_types/index.html">Inlining_stats_types</a></li><li><a href="../../compiler-libs.optcomp/Inlining_transforms/index.html">Inlining_transforms</a></li><li><a href="../../compiler-libs.optcomp/Interf/index.html">Interf</a></li><li><a href="../../compiler-libs.optcomp/Internal_variable_names/index.html">Internal_variable_names</a></li><li><a href="../../compiler-libs.optcomp/Interval/index.html">Interval</a></li><li><a href="../../compiler-libs.optcomp/Invariant_params/index.html">Invariant_params</a></li><li><a href="../../compiler-libs.optcomp/Lift_code/index.html">Lift_code</a></li><li><a href="../../compiler-libs.optcomp/Lift_constants/index.html">Lift_constants</a></li><li><a href="../../compiler-libs.optcomp/Lift_let_to_initialize_symbol/index.html">Lift_let_to_initialize_symbol</a></li><li><a href="../../compiler-libs.optcomp/Linear/index.html">Linear</a></li><li><a href="../../compiler-libs.optcomp/Linear_format/index.html">Linear_format</a></li><li><a href="../../compiler-libs.optcomp/Linearize/index.html">Linearize</a></li><li><a href="../../compiler-libs.optcomp/Linkage_name/index.html">Linkage_name</a></li><li><a href="../../compiler-libs.optcomp/Linscan/index.html">Linscan</a></li><li><a href="../../compiler-libs.optcomp/Liveness/index.html">Liveness</a></li><li><a href="../../compiler-libs.optcomp/Mach/index.html">Mach</a></li><li><a href="../../compiler-libs.optcomp/Mutable_variable/index.html">Mutable_variable</a></li><li><a href="../../compiler-libs.optcomp/Optcompile/index.html">Optcompile</a></li><li><a href="../../compiler-libs.optcomp/Opterrors/index.html">Opterrors</a></li><li><a href="../../compiler-libs.optcomp/Optmaindriver/index.html">Optmaindriver</a></li><li><a href="../../compiler-libs.optcomp/Parameter/index.html">Parameter</a></li><li><a href="../../compiler-libs.optcomp/Pass_wrapper/index.html">Pass_wrapper</a></li><li><a href="../../compiler-libs.optcomp/Polling/index.html">Polling</a></li><li><a href="../../compiler-libs.optcomp/Printclambda/index.html">Printclambda</a></li><li><a href="../../compiler-libs.optcomp/Printclambda_primitives/index.html">Printclambda_primitives</a></li><li><a href="../../compiler-libs.optcomp/Printcmm/index.html">Printcmm</a></li><li><a href="../../compiler-libs.optcomp/Printlinear/index.html">Printlinear</a></li><li><a href="../../compiler-libs.optcomp/Printmach/index.html">Printmach</a></li><li><a href="../../compiler-libs.optcomp/Proc/index.html">Proc</a></li><li><a href="../../compiler-libs.optcomp/Projection/index.html">Projection</a></li><li><a href="../../compiler-libs.optcomp/Ref_to_variables/index.html">Ref_to_variables</a></li><li><a href="../../compiler-libs.optcomp/Reg/index.html">Reg</a></li><li><a href="../../compiler-libs.optcomp/Reload/index.html">Reload</a></li><li><a href="../../compiler-libs.optcomp/Reloadgen/index.html">Reloadgen</a></li><li><a href="../../compiler-libs.optcomp/Remove_free_vars_equal_to_args/index.html">Remove_free_vars_equal_to_args</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_arguments/index.html">Remove_unused_arguments</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_closure_vars/index.html">Remove_unused_closure_vars</a></li><li><a href="../../compiler-libs.optcomp/Remove_unused_program_constructs/index.html">Remove_unused_program_constructs</a></li><li><a href="../../compiler-libs.optcomp/Schedgen/index.html">Schedgen</a></li><li><a href="../../compiler-libs.optcomp/Scheduling/index.html">Scheduling</a></li><li><a href="../../compiler-libs.optcomp/Selectgen/index.html">Selectgen</a></li><li><a href="../../compiler-libs.optcomp/Selection/index.html">Selection</a></li><li><a href="../../compiler-libs.optcomp/Semantics_of_primitives/index.html">Semantics_of_primitives</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_id/index.html">Set_of_closures_id</a></li><li><a href="../../compiler-libs.optcomp/Set_of_closures_origin/index.html">Set_of_closures_origin</a></li><li><a href="../../compiler-libs.optcomp/Share_constants/index.html">Share_constants</a></li><li><a href="../../compiler-libs.optcomp/Simple_value_approx/index.html">Simple_value_approx</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops/index.html">Simplify_boxed_integer_ops</a></li><li><a href="../../compiler-libs.optcomp/Simplify_boxed_integer_ops_intf/index.html">Simplify_boxed_integer_ops_intf</a></li><li><a href="../../compiler-libs.optcomp/Simplify_common/index.html">Simplify_common</a></li><li><a href="../../compiler-libs.optcomp/Simplify_primitives/index.html">Simplify_primitives</a></li><li><a href="../../compiler-libs.optcomp/Spill/index.html">Spill</a></li><li><a href="../../compiler-libs.optcomp/Split/index.html">Split</a></li><li><a href="../../compiler-libs.optcomp/Stackframe/index.html">Stackframe</a></li><li><a href="../../compiler-libs.optcomp/Stackframegen/index.html">Stackframegen</a></li><li><a href="../../compiler-libs.optcomp/Static_exception/index.html">Static_exception</a></li><li><a href="../../compiler-libs.optcomp/Strmatch/index.html">Strmatch</a></li><li><a href="../../compiler-libs.optcomp/Symbol/index.html">Symbol</a></li><li><a href="../../compiler-libs.optcomp/Tag/index.html">Tag</a></li><li><a href="../../compiler-libs.optcomp/Thread_sanitizer/index.html">Thread_sanitizer</a></li><li><a href="../../compiler-libs.optcomp/Traverse_for_exported_symbols/index.html">Traverse_for_exported_symbols</a></li><li><a href="../../compiler-libs.optcomp/Un_anf/index.html">Un_anf</a></li><li><a href="../../compiler-libs.optcomp/Unbox_closures/index.html">Unbox_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_free_vars_of_closures/index.html">Unbox_free_vars_of_closures</a></li><li><a href="../../compiler-libs.optcomp/Unbox_specialised_args/index.html">Unbox_specialised_args</a></li><li><a href="../../compiler-libs.optcomp/Var_within_closure/index.html">Var_within_closure</a></li><li><a href="../../compiler-libs.optcomp/Variable/index.html">Variable</a></li></ul></li><li>Library <code>compiler-libs.toplevel</code><ul><li><a href="../../compiler-libs.toplevel/Genprintval/index.html">Genprintval</a></li><li><a href="../../compiler-libs.toplevel/Topcommon/index.html">Topcommon</a></li><li><a href="../../compiler-libs.toplevel/Topdirs/index.html">Topdirs</a></li><li><a href="../../compiler-libs.toplevel/Topeval/index.html">Topeval</a></li><li><a href="../../compiler-libs.toplevel/Toploop/index.html">Toploop</a></li><li><a href="../../compiler-libs.toplevel/Topmain/index.html">Topmain</a></li><li><a href="../../compiler-libs.toplevel/Topprinters/index.html">Topprinters</a></li><li><a href="../../compiler-libs.toplevel/Trace/index.html">Trace</a></li></ul></li><li>Library <code>dynlink</code><ul><li><a href="../../dynlink/Dynlink/index.html">Dynlink</a></li></ul></li><li>Library <code>runtime_events</code><ul><li><a href="../../runtime_events/Runtime_events/index.html">Runtime_events</a></li></ul></li><li>Library <code>stdlib</code><ul><li><a href="../../stdlib/CamlinternalFormat/index.html">CamlinternalFormat</a></li><li><a href="../../stdlib/CamlinternalFormatBasics/index.html">CamlinternalFormatBasics</a></li><li><a href="../../stdlib/CamlinternalLazy/index.html">CamlinternalLazy</a></li><li><a href="../../stdlib/CamlinternalMod/index.html">CamlinternalMod</a></li><li><a href="../../stdlib/CamlinternalOO/index.html">CamlinternalOO</a></li><li><a href="../../stdlib/Stdlib/index.html">Stdlib</a></li></ul></li><li>Library <code>str</code><ul><li><a href="../../str/Str/index.html">Str</a></li></ul></li><li>Library <code>threads</code><ul><li><a href="../../threads/Event/index.html">Event</a></li><li><a href="../../threads/Thread/index.html">Thread</a></li></ul></li><li>Library <code>unix</code><ul><li><a href="../../unix/Unix/index.html">Unix</a></li><li><a href="../../unix/UnixLabels/index.html">UnixLabels</a></li></ul></li><li><a href="../index.html">Sources</a><ul><li>stdlib<ul><li><a href="arg.ml.html">arg.ml</a></li><li><a href="array.ml.html">array.ml</a></li><li><a href="arrayLabels.ml.html">arrayLabels.ml</a></li><li><a href="atomic.ml.html">atomic.ml</a></li><li><a href="bigarray.ml.html">bigarray.ml</a></li><li><a href="bool.ml.html">bool.ml</a></li><li><a href="buffer.ml.html">buffer.ml</a></li><li><a href="bytes.ml.html">bytes.ml</a></li><li><a href="bytesLabels.ml.html">bytesLabels.ml</a></li><li><a href="callback.ml.html">callback.ml</a></li><li><a href="#" class="current_unit">camlinternalFormat.ml</a></li><li><a href="camlinternalFormatBasics.ml.html">camlinternalFormatBasics.ml</a></li><li><a href="camlinternalLazy.ml.html">camlinternalLazy.ml</a></li><li><a href="camlinternalMod.ml.html">camlinternalMod.ml</a></li><li><a href="camlinternalOO.ml.html">camlinternalOO.ml</a></li><li><a href="char.ml.html">char.ml</a></li><li><a href="complex.ml.html">complex.ml</a></li><li><a href="condition.ml.html">condition.ml</a></li><li><a href="digest.ml.html">digest.ml</a></li><li><a href="domain.ml.html">domain.ml</a></li><li><a href="dynarray.ml.html">dynarray.ml</a></li><li><a href="effect.ml.html">effect.ml</a></li><li><a href="either.ml.html">either.ml</a></li><li><a href="ephemeron.ml.html">ephemeron.ml</a></li><li><a href="filename.ml.html">filename.ml</a></li><li><a href="float.ml.html">float.ml</a></li><li><a href="format.ml.html">format.ml</a></li><li><a href="fun.ml.html">fun.ml</a></li><li><a href="gc.ml.html">gc.ml</a></li><li><a href="hashtbl.ml.html">hashtbl.ml</a></li><li><a href="in_channel.ml.html">in_channel.ml</a></li><li><a href="int.ml.html">int.ml</a></li><li><a href="int32.ml.html">int32.ml</a></li><li><a href="int64.ml.html">int64.ml</a></li><li><a href="lazy.ml.html">lazy.ml</a></li><li><a href="lexing.ml.html">lexing.ml</a></li><li><a href="list.ml.html">list.ml</a></li><li><a href="listLabels.ml.html">listLabels.ml</a></li><li><a href="map.ml.html">map.ml</a></li><li><a href="marshal.ml.html">marshal.ml</a></li><li><a href="moreLabels.ml.html">moreLabels.ml</a></li><li><a href="mutex.ml.html">mutex.ml</a></li><li><a href="nativeint.ml.html">nativeint.ml</a></li><li><a href="obj.ml.html">obj.ml</a></li><li><a href="oo.ml.html">oo.ml</a></li><li><a href="option.ml.html">option.ml</a></li><li><a href="out_channel.ml.html">out_channel.ml</a></li><li><a href="parsing.ml.html">parsing.ml</a></li><li><a href="printexc.ml.html">printexc.ml</a></li><li><a href="printf.ml.html">printf.ml</a></li><li><a href="queue.ml.html">queue.ml</a></li><li><a href="random.ml.html">random.ml</a></li><li><a href="result.ml.html">result.ml</a></li><li><a href="scanf.ml.html">scanf.ml</a></li><li><a href="semaphore.ml.html">semaphore.ml</a></li><li><a href="seq.ml.html">seq.ml</a></li><li><a href="set.ml.html">set.ml</a></li><li><a href="stack.ml.html">stack.ml</a></li><li><a href="stdLabels.ml.html">stdLabels.ml</a></li><li><a href="stdlib.ml.html">stdlib.ml</a></li><li><a href="string.ml.html">string.ml</a></li><li><a href="stringLabels.ml.html">stringLabels.ml</a></li><li><a href="sys.ml.html">sys.ml</a></li><li><a href="type.ml.html">type.ml</a></li><li><a href="uchar.ml.html">uchar.ml</a></li><li><a href="unit.ml.html">unit.ml</a></li><li><a href="weak.ml.html">weak.ml</a></li></ul></li></ul></li></ul></li></ul></nav></div><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
<a id="L948" class="source_line" href="#L948">948</a>
<a id="L949" class="source_line" href="#L949">949</a>
<a id="L950" class="source_line" href="#L950">950</a>
<a id="L951" class="source_line" href="#L951">951</a>
<a id="L952" class="source_line" href="#L952">952</a>
<a id="L953" class="source_line" href="#L953">953</a>
<a id="L954" class="source_line" href="#L954">954</a>
<a id="L955" class="source_line" href="#L955">955</a>
<a id="L956" class="source_line" href="#L956">956</a>
<a id="L957" class="source_line" href="#L957">957</a>
<a id="L958" class="source_line" href="#L958">958</a>
<a id="L959" class="source_line" href="#L959">959</a>
<a id="L960" class="source_line" href="#L960">960</a>
<a id="L961" class="source_line" href="#L961">961</a>
<a id="L962" class="source_line" href="#L962">962</a>
<a id="L963" class="source_line" href="#L963">963</a>
<a id="L964" class="source_line" href="#L964">964</a>
<a id="L965" class="source_line" href="#L965">965</a>
<a id="L966" class="source_line" href="#L966">966</a>
<a id="L967" class="source_line" href="#L967">967</a>
<a id="L968" class="source_line" href="#L968">968</a>
<a id="L969" class="source_line" href="#L969">969</a>
<a id="L970" class="source_line" href="#L970">970</a>
<a id="L971" class="source_line" href="#L971">971</a>
<a id="L972" class="source_line" href="#L972">972</a>
<a id="L973" class="source_line" href="#L973">973</a>
<a id="L974" class="source_line" href="#L974">974</a>
<a id="L975" class="source_line" href="#L975">975</a>
<a id="L976" class="source_line" href="#L976">976</a>
<a id="L977" class="source_line" href="#L977">977</a>
<a id="L978" class="source_line" href="#L978">978</a>
<a id="L979" class="source_line" href="#L979">979</a>
<a id="L980" class="source_line" href="#L980">980</a>
<a id="L981" class="source_line" href="#L981">981</a>
<a id="L982" class="source_line" href="#L982">982</a>
<a id="L983" class="source_line" href="#L983">983</a>
<a id="L984" class="source_line" href="#L984">984</a>
<a id="L985" class="source_line" href="#L985">985</a>
<a id="L986" class="source_line" href="#L986">986</a>
<a id="L987" class="source_line" href="#L987">987</a>
<a id="L988" class="source_line" href="#L988">988</a>
<a id="L989" class="source_line" href="#L989">989</a>
<a id="L990" class="source_line" href="#L990">990</a>
<a id="L991" class="source_line" href="#L991">991</a>
<a id="L992" class="source_line" href="#L992">992</a>
<a id="L993" class="source_line" href="#L993">993</a>
<a id="L994" class="source_line" href="#L994">994</a>
<a id="L995" class="source_line" href="#L995">995</a>
<a id="L996" class="source_line" href="#L996">996</a>
<a id="L997" class="source_line" href="#L997">997</a>
<a id="L998" class="source_line" href="#L998">998</a>
<a id="L999" class="source_line" href="#L999">999</a>
<a id="L1000" class="source_line" href="#L1000">1000</a>
<a id="L1001" class="source_line" href="#L1001">1001</a>
<a id="L1002" class="source_line" href="#L1002">1002</a>
<a id="L1003" class="source_line" href="#L1003">1003</a>
<a id="L1004" class="source_line" href="#L1004">1004</a>
<a id="L1005" class="source_line" href="#L1005">1005</a>
<a id="L1006" class="source_line" href="#L1006">1006</a>
<a id="L1007" class="source_line" href="#L1007">1007</a>
<a id="L1008" class="source_line" href="#L1008">1008</a>
<a id="L1009" class="source_line" href="#L1009">1009</a>
<a id="L1010" class="source_line" href="#L1010">1010</a>
<a id="L1011" class="source_line" href="#L1011">1011</a>
<a id="L1012" class="source_line" href="#L1012">1012</a>
<a id="L1013" class="source_line" href="#L1013">1013</a>
<a id="L1014" class="source_line" href="#L1014">1014</a>
<a id="L1015" class="source_line" href="#L1015">1015</a>
<a id="L1016" class="source_line" href="#L1016">1016</a>
<a id="L1017" class="source_line" href="#L1017">1017</a>
<a id="L1018" class="source_line" href="#L1018">1018</a>
<a id="L1019" class="source_line" href="#L1019">1019</a>
<a id="L1020" class="source_line" href="#L1020">1020</a>
<a id="L1021" class="source_line" href="#L1021">1021</a>
<a id="L1022" class="source_line" href="#L1022">1022</a>
<a id="L1023" class="source_line" href="#L1023">1023</a>
<a id="L1024" class="source_line" href="#L1024">1024</a>
<a id="L1025" class="source_line" href="#L1025">1025</a>
<a id="L1026" class="source_line" href="#L1026">1026</a>
<a id="L1027" class="source_line" href="#L1027">1027</a>
<a id="L1028" class="source_line" href="#L1028">1028</a>
<a id="L1029" class="source_line" href="#L1029">1029</a>
<a id="L1030" class="source_line" href="#L1030">1030</a>
<a id="L1031" class="source_line" href="#L1031">1031</a>
<a id="L1032" class="source_line" href="#L1032">1032</a>
<a id="L1033" class="source_line" href="#L1033">1033</a>
<a id="L1034" class="source_line" href="#L1034">1034</a>
<a id="L1035" class="source_line" href="#L1035">1035</a>
<a id="L1036" class="source_line" href="#L1036">1036</a>
<a id="L1037" class="source_line" href="#L1037">1037</a>
<a id="L1038" class="source_line" href="#L1038">1038</a>
<a id="L1039" class="source_line" href="#L1039">1039</a>
<a id="L1040" class="source_line" href="#L1040">1040</a>
<a id="L1041" class="source_line" href="#L1041">1041</a>
<a id="L1042" class="source_line" href="#L1042">1042</a>
<a id="L1043" class="source_line" href="#L1043">1043</a>
<a id="L1044" class="source_line" href="#L1044">1044</a>
<a id="L1045" class="source_line" href="#L1045">1045</a>
<a id="L1046" class="source_line" href="#L1046">1046</a>
<a id="L1047" class="source_line" href="#L1047">1047</a>
<a id="L1048" class="source_line" href="#L1048">1048</a>
<a id="L1049" class="source_line" href="#L1049">1049</a>
<a id="L1050" class="source_line" href="#L1050">1050</a>
<a id="L1051" class="source_line" href="#L1051">1051</a>
<a id="L1052" class="source_line" href="#L1052">1052</a>
<a id="L1053" class="source_line" href="#L1053">1053</a>
<a id="L1054" class="source_line" href="#L1054">1054</a>
<a id="L1055" class="source_line" href="#L1055">1055</a>
<a id="L1056" class="source_line" href="#L1056">1056</a>
<a id="L1057" class="source_line" href="#L1057">1057</a>
<a id="L1058" class="source_line" href="#L1058">1058</a>
<a id="L1059" class="source_line" href="#L1059">1059</a>
<a id="L1060" class="source_line" href="#L1060">1060</a>
<a id="L1061" class="source_line" href="#L1061">1061</a>
<a id="L1062" class="source_line" href="#L1062">1062</a>
<a id="L1063" class="source_line" href="#L1063">1063</a>
<a id="L1064" class="source_line" href="#L1064">1064</a>
<a id="L1065" class="source_line" href="#L1065">1065</a>
<a id="L1066" class="source_line" href="#L1066">1066</a>
<a id="L1067" class="source_line" href="#L1067">1067</a>
<a id="L1068" class="source_line" href="#L1068">1068</a>
<a id="L1069" class="source_line" href="#L1069">1069</a>
<a id="L1070" class="source_line" href="#L1070">1070</a>
<a id="L1071" class="source_line" href="#L1071">1071</a>
<a id="L1072" class="source_line" href="#L1072">1072</a>
<a id="L1073" class="source_line" href="#L1073">1073</a>
<a id="L1074" class="source_line" href="#L1074">1074</a>
<a id="L1075" class="source_line" href="#L1075">1075</a>
<a id="L1076" class="source_line" href="#L1076">1076</a>
<a id="L1077" class="source_line" href="#L1077">1077</a>
<a id="L1078" class="source_line" href="#L1078">1078</a>
<a id="L1079" class="source_line" href="#L1079">1079</a>
<a id="L1080" class="source_line" href="#L1080">1080</a>
<a id="L1081" class="source_line" href="#L1081">1081</a>
<a id="L1082" class="source_line" href="#L1082">1082</a>
<a id="L1083" class="source_line" href="#L1083">1083</a>
<a id="L1084" class="source_line" href="#L1084">1084</a>
<a id="L1085" class="source_line" href="#L1085">1085</a>
<a id="L1086" class="source_line" href="#L1086">1086</a>
<a id="L1087" class="source_line" href="#L1087">1087</a>
<a id="L1088" class="source_line" href="#L1088">1088</a>
<a id="L1089" class="source_line" href="#L1089">1089</a>
<a id="L1090" class="source_line" href="#L1090">1090</a>
<a id="L1091" class="source_line" href="#L1091">1091</a>
<a id="L1092" class="source_line" href="#L1092">1092</a>
<a id="L1093" class="source_line" href="#L1093">1093</a>
<a id="L1094" class="source_line" href="#L1094">1094</a>
<a id="L1095" class="source_line" href="#L1095">1095</a>
<a id="L1096" class="source_line" href="#L1096">1096</a>
<a id="L1097" class="source_line" href="#L1097">1097</a>
<a id="L1098" class="source_line" href="#L1098">1098</a>
<a id="L1099" class="source_line" href="#L1099">1099</a>
<a id="L1100" class="source_line" href="#L1100">1100</a>
<a id="L1101" class="source_line" href="#L1101">1101</a>
<a id="L1102" class="source_line" href="#L1102">1102</a>
<a id="L1103" class="source_line" href="#L1103">1103</a>
<a id="L1104" class="source_line" href="#L1104">1104</a>
<a id="L1105" class="source_line" href="#L1105">1105</a>
<a id="L1106" class="source_line" href="#L1106">1106</a>
<a id="L1107" class="source_line" href="#L1107">1107</a>
<a id="L1108" class="source_line" href="#L1108">1108</a>
<a id="L1109" class="source_line" href="#L1109">1109</a>
<a id="L1110" class="source_line" href="#L1110">1110</a>
<a id="L1111" class="source_line" href="#L1111">1111</a>
<a id="L1112" class="source_line" href="#L1112">1112</a>
<a id="L1113" class="source_line" href="#L1113">1113</a>
<a id="L1114" class="source_line" href="#L1114">1114</a>
<a id="L1115" class="source_line" href="#L1115">1115</a>
<a id="L1116" class="source_line" href="#L1116">1116</a>
<a id="L1117" class="source_line" href="#L1117">1117</a>
<a id="L1118" class="source_line" href="#L1118">1118</a>
<a id="L1119" class="source_line" href="#L1119">1119</a>
<a id="L1120" class="source_line" href="#L1120">1120</a>
<a id="L1121" class="source_line" href="#L1121">1121</a>
<a id="L1122" class="source_line" href="#L1122">1122</a>
<a id="L1123" class="source_line" href="#L1123">1123</a>
<a id="L1124" class="source_line" href="#L1124">1124</a>
<a id="L1125" class="source_line" href="#L1125">1125</a>
<a id="L1126" class="source_line" href="#L1126">1126</a>
<a id="L1127" class="source_line" href="#L1127">1127</a>
<a id="L1128" class="source_line" href="#L1128">1128</a>
<a id="L1129" class="source_line" href="#L1129">1129</a>
<a id="L1130" class="source_line" href="#L1130">1130</a>
<a id="L1131" class="source_line" href="#L1131">1131</a>
<a id="L1132" class="source_line" href="#L1132">1132</a>
<a id="L1133" class="source_line" href="#L1133">1133</a>
<a id="L1134" class="source_line" href="#L1134">1134</a>
<a id="L1135" class="source_line" href="#L1135">1135</a>
<a id="L1136" class="source_line" href="#L1136">1136</a>
<a id="L1137" class="source_line" href="#L1137">1137</a>
<a id="L1138" class="source_line" href="#L1138">1138</a>
<a id="L1139" class="source_line" href="#L1139">1139</a>
<a id="L1140" class="source_line" href="#L1140">1140</a>
<a id="L1141" class="source_line" href="#L1141">1141</a>
<a id="L1142" class="source_line" href="#L1142">1142</a>
<a id="L1143" class="source_line" href="#L1143">1143</a>
<a id="L1144" class="source_line" href="#L1144">1144</a>
<a id="L1145" class="source_line" href="#L1145">1145</a>
<a id="L1146" class="source_line" href="#L1146">1146</a>
<a id="L1147" class="source_line" href="#L1147">1147</a>
<a id="L1148" class="source_line" href="#L1148">1148</a>
<a id="L1149" class="source_line" href="#L1149">1149</a>
<a id="L1150" class="source_line" href="#L1150">1150</a>
<a id="L1151" class="source_line" href="#L1151">1151</a>
<a id="L1152" class="source_line" href="#L1152">1152</a>
<a id="L1153" class="source_line" href="#L1153">1153</a>
<a id="L1154" class="source_line" href="#L1154">1154</a>
<a id="L1155" class="source_line" href="#L1155">1155</a>
<a id="L1156" class="source_line" href="#L1156">1156</a>
<a id="L1157" class="source_line" href="#L1157">1157</a>
<a id="L1158" class="source_line" href="#L1158">1158</a>
<a id="L1159" class="source_line" href="#L1159">1159</a>
<a id="L1160" class="source_line" href="#L1160">1160</a>
<a id="L1161" class="source_line" href="#L1161">1161</a>
<a id="L1162" class="source_line" href="#L1162">1162</a>
<a id="L1163" class="source_line" href="#L1163">1163</a>
<a id="L1164" class="source_line" href="#L1164">1164</a>
<a id="L1165" class="source_line" href="#L1165">1165</a>
<a id="L1166" class="source_line" href="#L1166">1166</a>
<a id="L1167" class="source_line" href="#L1167">1167</a>
<a id="L1168" class="source_line" href="#L1168">1168</a>
<a id="L1169" class="source_line" href="#L1169">1169</a>
<a id="L1170" class="source_line" href="#L1170">1170</a>
<a id="L1171" class="source_line" href="#L1171">1171</a>
<a id="L1172" class="source_line" href="#L1172">1172</a>
<a id="L1173" class="source_line" href="#L1173">1173</a>
<a id="L1174" class="source_line" href="#L1174">1174</a>
<a id="L1175" class="source_line" href="#L1175">1175</a>
<a id="L1176" class="source_line" href="#L1176">1176</a>
<a id="L1177" class="source_line" href="#L1177">1177</a>
<a id="L1178" class="source_line" href="#L1178">1178</a>
<a id="L1179" class="source_line" href="#L1179">1179</a>
<a id="L1180" class="source_line" href="#L1180">1180</a>
<a id="L1181" class="source_line" href="#L1181">1181</a>
<a id="L1182" class="source_line" href="#L1182">1182</a>
<a id="L1183" class="source_line" href="#L1183">1183</a>
<a id="L1184" class="source_line" href="#L1184">1184</a>
<a id="L1185" class="source_line" href="#L1185">1185</a>
<a id="L1186" class="source_line" href="#L1186">1186</a>
<a id="L1187" class="source_line" href="#L1187">1187</a>
<a id="L1188" class="source_line" href="#L1188">1188</a>
<a id="L1189" class="source_line" href="#L1189">1189</a>
<a id="L1190" class="source_line" href="#L1190">1190</a>
<a id="L1191" class="source_line" href="#L1191">1191</a>
<a id="L1192" class="source_line" href="#L1192">1192</a>
<a id="L1193" class="source_line" href="#L1193">1193</a>
<a id="L1194" class="source_line" href="#L1194">1194</a>
<a id="L1195" class="source_line" href="#L1195">1195</a>
<a id="L1196" class="source_line" href="#L1196">1196</a>
<a id="L1197" class="source_line" href="#L1197">1197</a>
<a id="L1198" class="source_line" href="#L1198">1198</a>
<a id="L1199" class="source_line" href="#L1199">1199</a>
<a id="L1200" class="source_line" href="#L1200">1200</a>
<a id="L1201" class="source_line" href="#L1201">1201</a>
<a id="L1202" class="source_line" href="#L1202">1202</a>
<a id="L1203" class="source_line" href="#L1203">1203</a>
<a id="L1204" class="source_line" href="#L1204">1204</a>
<a id="L1205" class="source_line" href="#L1205">1205</a>
<a id="L1206" class="source_line" href="#L1206">1206</a>
<a id="L1207" class="source_line" href="#L1207">1207</a>
<a id="L1208" class="source_line" href="#L1208">1208</a>
<a id="L1209" class="source_line" href="#L1209">1209</a>
<a id="L1210" class="source_line" href="#L1210">1210</a>
<a id="L1211" class="source_line" href="#L1211">1211</a>
<a id="L1212" class="source_line" href="#L1212">1212</a>
<a id="L1213" class="source_line" href="#L1213">1213</a>
<a id="L1214" class="source_line" href="#L1214">1214</a>
<a id="L1215" class="source_line" href="#L1215">1215</a>
<a id="L1216" class="source_line" href="#L1216">1216</a>
<a id="L1217" class="source_line" href="#L1217">1217</a>
<a id="L1218" class="source_line" href="#L1218">1218</a>
<a id="L1219" class="source_line" href="#L1219">1219</a>
<a id="L1220" class="source_line" href="#L1220">1220</a>
<a id="L1221" class="source_line" href="#L1221">1221</a>
<a id="L1222" class="source_line" href="#L1222">1222</a>
<a id="L1223" class="source_line" href="#L1223">1223</a>
<a id="L1224" class="source_line" href="#L1224">1224</a>
<a id="L1225" class="source_line" href="#L1225">1225</a>
<a id="L1226" class="source_line" href="#L1226">1226</a>
<a id="L1227" class="source_line" href="#L1227">1227</a>
<a id="L1228" class="source_line" href="#L1228">1228</a>
<a id="L1229" class="source_line" href="#L1229">1229</a>
<a id="L1230" class="source_line" href="#L1230">1230</a>
<a id="L1231" class="source_line" href="#L1231">1231</a>
<a id="L1232" class="source_line" href="#L1232">1232</a>
<a id="L1233" class="source_line" href="#L1233">1233</a>
<a id="L1234" class="source_line" href="#L1234">1234</a>
<a id="L1235" class="source_line" href="#L1235">1235</a>
<a id="L1236" class="source_line" href="#L1236">1236</a>
<a id="L1237" class="source_line" href="#L1237">1237</a>
<a id="L1238" class="source_line" href="#L1238">1238</a>
<a id="L1239" class="source_line" href="#L1239">1239</a>
<a id="L1240" class="source_line" href="#L1240">1240</a>
<a id="L1241" class="source_line" href="#L1241">1241</a>
<a id="L1242" class="source_line" href="#L1242">1242</a>
<a id="L1243" class="source_line" href="#L1243">1243</a>
<a id="L1244" class="source_line" href="#L1244">1244</a>
<a id="L1245" class="source_line" href="#L1245">1245</a>
<a id="L1246" class="source_line" href="#L1246">1246</a>
<a id="L1247" class="source_line" href="#L1247">1247</a>
<a id="L1248" class="source_line" href="#L1248">1248</a>
<a id="L1249" class="source_line" href="#L1249">1249</a>
<a id="L1250" class="source_line" href="#L1250">1250</a>
<a id="L1251" class="source_line" href="#L1251">1251</a>
<a id="L1252" class="source_line" href="#L1252">1252</a>
<a id="L1253" class="source_line" href="#L1253">1253</a>
<a id="L1254" class="source_line" href="#L1254">1254</a>
<a id="L1255" class="source_line" href="#L1255">1255</a>
<a id="L1256" class="source_line" href="#L1256">1256</a>
<a id="L1257" class="source_line" href="#L1257">1257</a>
<a id="L1258" class="source_line" href="#L1258">1258</a>
<a id="L1259" class="source_line" href="#L1259">1259</a>
<a id="L1260" class="source_line" href="#L1260">1260</a>
<a id="L1261" class="source_line" href="#L1261">1261</a>
<a id="L1262" class="source_line" href="#L1262">1262</a>
<a id="L1263" class="source_line" href="#L1263">1263</a>
<a id="L1264" class="source_line" href="#L1264">1264</a>
<a id="L1265" class="source_line" href="#L1265">1265</a>
<a id="L1266" class="source_line" href="#L1266">1266</a>
<a id="L1267" class="source_line" href="#L1267">1267</a>
<a id="L1268" class="source_line" href="#L1268">1268</a>
<a id="L1269" class="source_line" href="#L1269">1269</a>
<a id="L1270" class="source_line" href="#L1270">1270</a>
<a id="L1271" class="source_line" href="#L1271">1271</a>
<a id="L1272" class="source_line" href="#L1272">1272</a>
<a id="L1273" class="source_line" href="#L1273">1273</a>
<a id="L1274" class="source_line" href="#L1274">1274</a>
<a id="L1275" class="source_line" href="#L1275">1275</a>
<a id="L1276" class="source_line" href="#L1276">1276</a>
<a id="L1277" class="source_line" href="#L1277">1277</a>
<a id="L1278" class="source_line" href="#L1278">1278</a>
<a id="L1279" class="source_line" href="#L1279">1279</a>
<a id="L1280" class="source_line" href="#L1280">1280</a>
<a id="L1281" class="source_line" href="#L1281">1281</a>
<a id="L1282" class="source_line" href="#L1282">1282</a>
<a id="L1283" class="source_line" href="#L1283">1283</a>
<a id="L1284" class="source_line" href="#L1284">1284</a>
<a id="L1285" class="source_line" href="#L1285">1285</a>
<a id="L1286" class="source_line" href="#L1286">1286</a>
<a id="L1287" class="source_line" href="#L1287">1287</a>
<a id="L1288" class="source_line" href="#L1288">1288</a>
<a id="L1289" class="source_line" href="#L1289">1289</a>
<a id="L1290" class="source_line" href="#L1290">1290</a>
<a id="L1291" class="source_line" href="#L1291">1291</a>
<a id="L1292" class="source_line" href="#L1292">1292</a>
<a id="L1293" class="source_line" href="#L1293">1293</a>
<a id="L1294" class="source_line" href="#L1294">1294</a>
<a id="L1295" class="source_line" href="#L1295">1295</a>
<a id="L1296" class="source_line" href="#L1296">1296</a>
<a id="L1297" class="source_line" href="#L1297">1297</a>
<a id="L1298" class="source_line" href="#L1298">1298</a>
<a id="L1299" class="source_line" href="#L1299">1299</a>
<a id="L1300" class="source_line" href="#L1300">1300</a>
<a id="L1301" class="source_line" href="#L1301">1301</a>
<a id="L1302" class="source_line" href="#L1302">1302</a>
<a id="L1303" class="source_line" href="#L1303">1303</a>
<a id="L1304" class="source_line" href="#L1304">1304</a>
<a id="L1305" class="source_line" href="#L1305">1305</a>
<a id="L1306" class="source_line" href="#L1306">1306</a>
<a id="L1307" class="source_line" href="#L1307">1307</a>
<a id="L1308" class="source_line" href="#L1308">1308</a>
<a id="L1309" class="source_line" href="#L1309">1309</a>
<a id="L1310" class="source_line" href="#L1310">1310</a>
<a id="L1311" class="source_line" href="#L1311">1311</a>
<a id="L1312" class="source_line" href="#L1312">1312</a>
<a id="L1313" class="source_line" href="#L1313">1313</a>
<a id="L1314" class="source_line" href="#L1314">1314</a>
<a id="L1315" class="source_line" href="#L1315">1315</a>
<a id="L1316" class="source_line" href="#L1316">1316</a>
<a id="L1317" class="source_line" href="#L1317">1317</a>
<a id="L1318" class="source_line" href="#L1318">1318</a>
<a id="L1319" class="source_line" href="#L1319">1319</a>
<a id="L1320" class="source_line" href="#L1320">1320</a>
<a id="L1321" class="source_line" href="#L1321">1321</a>
<a id="L1322" class="source_line" href="#L1322">1322</a>
<a id="L1323" class="source_line" href="#L1323">1323</a>
<a id="L1324" class="source_line" href="#L1324">1324</a>
<a id="L1325" class="source_line" href="#L1325">1325</a>
<a id="L1326" class="source_line" href="#L1326">1326</a>
<a id="L1327" class="source_line" href="#L1327">1327</a>
<a id="L1328" class="source_line" href="#L1328">1328</a>
<a id="L1329" class="source_line" href="#L1329">1329</a>
<a id="L1330" class="source_line" href="#L1330">1330</a>
<a id="L1331" class="source_line" href="#L1331">1331</a>
<a id="L1332" class="source_line" href="#L1332">1332</a>
<a id="L1333" class="source_line" href="#L1333">1333</a>
<a id="L1334" class="source_line" href="#L1334">1334</a>
<a id="L1335" class="source_line" href="#L1335">1335</a>
<a id="L1336" class="source_line" href="#L1336">1336</a>
<a id="L1337" class="source_line" href="#L1337">1337</a>
<a id="L1338" class="source_line" href="#L1338">1338</a>
<a id="L1339" class="source_line" href="#L1339">1339</a>
<a id="L1340" class="source_line" href="#L1340">1340</a>
<a id="L1341" class="source_line" href="#L1341">1341</a>
<a id="L1342" class="source_line" href="#L1342">1342</a>
<a id="L1343" class="source_line" href="#L1343">1343</a>
<a id="L1344" class="source_line" href="#L1344">1344</a>
<a id="L1345" class="source_line" href="#L1345">1345</a>
<a id="L1346" class="source_line" href="#L1346">1346</a>
<a id="L1347" class="source_line" href="#L1347">1347</a>
<a id="L1348" class="source_line" href="#L1348">1348</a>
<a id="L1349" class="source_line" href="#L1349">1349</a>
<a id="L1350" class="source_line" href="#L1350">1350</a>
<a id="L1351" class="source_line" href="#L1351">1351</a>
<a id="L1352" class="source_line" href="#L1352">1352</a>
<a id="L1353" class="source_line" href="#L1353">1353</a>
<a id="L1354" class="source_line" href="#L1354">1354</a>
<a id="L1355" class="source_line" href="#L1355">1355</a>
<a id="L1356" class="source_line" href="#L1356">1356</a>
<a id="L1357" class="source_line" href="#L1357">1357</a>
<a id="L1358" class="source_line" href="#L1358">1358</a>
<a id="L1359" class="source_line" href="#L1359">1359</a>
<a id="L1360" class="source_line" href="#L1360">1360</a>
<a id="L1361" class="source_line" href="#L1361">1361</a>
<a id="L1362" class="source_line" href="#L1362">1362</a>
<a id="L1363" class="source_line" href="#L1363">1363</a>
<a id="L1364" class="source_line" href="#L1364">1364</a>
<a id="L1365" class="source_line" href="#L1365">1365</a>
<a id="L1366" class="source_line" href="#L1366">1366</a>
<a id="L1367" class="source_line" href="#L1367">1367</a>
<a id="L1368" class="source_line" href="#L1368">1368</a>
<a id="L1369" class="source_line" href="#L1369">1369</a>
<a id="L1370" class="source_line" href="#L1370">1370</a>
<a id="L1371" class="source_line" href="#L1371">1371</a>
<a id="L1372" class="source_line" href="#L1372">1372</a>
<a id="L1373" class="source_line" href="#L1373">1373</a>
<a id="L1374" class="source_line" href="#L1374">1374</a>
<a id="L1375" class="source_line" href="#L1375">1375</a>
<a id="L1376" class="source_line" href="#L1376">1376</a>
<a id="L1377" class="source_line" href="#L1377">1377</a>
<a id="L1378" class="source_line" href="#L1378">1378</a>
<a id="L1379" class="source_line" href="#L1379">1379</a>
<a id="L1380" class="source_line" href="#L1380">1380</a>
<a id="L1381" class="source_line" href="#L1381">1381</a>
<a id="L1382" class="source_line" href="#L1382">1382</a>
<a id="L1383" class="source_line" href="#L1383">1383</a>
<a id="L1384" class="source_line" href="#L1384">1384</a>
<a id="L1385" class="source_line" href="#L1385">1385</a>
<a id="L1386" class="source_line" href="#L1386">1386</a>
<a id="L1387" class="source_line" href="#L1387">1387</a>
<a id="L1388" class="source_line" href="#L1388">1388</a>
<a id="L1389" class="source_line" href="#L1389">1389</a>
<a id="L1390" class="source_line" href="#L1390">1390</a>
<a id="L1391" class="source_line" href="#L1391">1391</a>
<a id="L1392" class="source_line" href="#L1392">1392</a>
<a id="L1393" class="source_line" href="#L1393">1393</a>
<a id="L1394" class="source_line" href="#L1394">1394</a>
<a id="L1395" class="source_line" href="#L1395">1395</a>
<a id="L1396" class="source_line" href="#L1396">1396</a>
<a id="L1397" class="source_line" href="#L1397">1397</a>
<a id="L1398" class="source_line" href="#L1398">1398</a>
<a id="L1399" class="source_line" href="#L1399">1399</a>
<a id="L1400" class="source_line" href="#L1400">1400</a>
<a id="L1401" class="source_line" href="#L1401">1401</a>
<a id="L1402" class="source_line" href="#L1402">1402</a>
<a id="L1403" class="source_line" href="#L1403">1403</a>
<a id="L1404" class="source_line" href="#L1404">1404</a>
<a id="L1405" class="source_line" href="#L1405">1405</a>
<a id="L1406" class="source_line" href="#L1406">1406</a>
<a id="L1407" class="source_line" href="#L1407">1407</a>
<a id="L1408" class="source_line" href="#L1408">1408</a>
<a id="L1409" class="source_line" href="#L1409">1409</a>
<a id="L1410" class="source_line" href="#L1410">1410</a>
<a id="L1411" class="source_line" href="#L1411">1411</a>
<a id="L1412" class="source_line" href="#L1412">1412</a>
<a id="L1413" class="source_line" href="#L1413">1413</a>
<a id="L1414" class="source_line" href="#L1414">1414</a>
<a id="L1415" class="source_line" href="#L1415">1415</a>
<a id="L1416" class="source_line" href="#L1416">1416</a>
<a id="L1417" class="source_line" href="#L1417">1417</a>
<a id="L1418" class="source_line" href="#L1418">1418</a>
<a id="L1419" class="source_line" href="#L1419">1419</a>
<a id="L1420" class="source_line" href="#L1420">1420</a>
<a id="L1421" class="source_line" href="#L1421">1421</a>
<a id="L1422" class="source_line" href="#L1422">1422</a>
<a id="L1423" class="source_line" href="#L1423">1423</a>
<a id="L1424" class="source_line" href="#L1424">1424</a>
<a id="L1425" class="source_line" href="#L1425">1425</a>
<a id="L1426" class="source_line" href="#L1426">1426</a>
<a id="L1427" class="source_line" href="#L1427">1427</a>
<a id="L1428" class="source_line" href="#L1428">1428</a>
<a id="L1429" class="source_line" href="#L1429">1429</a>
<a id="L1430" class="source_line" href="#L1430">1430</a>
<a id="L1431" class="source_line" href="#L1431">1431</a>
<a id="L1432" class="source_line" href="#L1432">1432</a>
<a id="L1433" class="source_line" href="#L1433">1433</a>
<a id="L1434" class="source_line" href="#L1434">1434</a>
<a id="L1435" class="source_line" href="#L1435">1435</a>
<a id="L1436" class="source_line" href="#L1436">1436</a>
<a id="L1437" class="source_line" href="#L1437">1437</a>
<a id="L1438" class="source_line" href="#L1438">1438</a>
<a id="L1439" class="source_line" href="#L1439">1439</a>
<a id="L1440" class="source_line" href="#L1440">1440</a>
<a id="L1441" class="source_line" href="#L1441">1441</a>
<a id="L1442" class="source_line" href="#L1442">1442</a>
<a id="L1443" class="source_line" href="#L1443">1443</a>
<a id="L1444" class="source_line" href="#L1444">1444</a>
<a id="L1445" class="source_line" href="#L1445">1445</a>
<a id="L1446" class="source_line" href="#L1446">1446</a>
<a id="L1447" class="source_line" href="#L1447">1447</a>
<a id="L1448" class="source_line" href="#L1448">1448</a>
<a id="L1449" class="source_line" href="#L1449">1449</a>
<a id="L1450" class="source_line" href="#L1450">1450</a>
<a id="L1451" class="source_line" href="#L1451">1451</a>
<a id="L1452" class="source_line" href="#L1452">1452</a>
<a id="L1453" class="source_line" href="#L1453">1453</a>
<a id="L1454" class="source_line" href="#L1454">1454</a>
<a id="L1455" class="source_line" href="#L1455">1455</a>
<a id="L1456" class="source_line" href="#L1456">1456</a>
<a id="L1457" class="source_line" href="#L1457">1457</a>
<a id="L1458" class="source_line" href="#L1458">1458</a>
<a id="L1459" class="source_line" href="#L1459">1459</a>
<a id="L1460" class="source_line" href="#L1460">1460</a>
<a id="L1461" class="source_line" href="#L1461">1461</a>
<a id="L1462" class="source_line" href="#L1462">1462</a>
<a id="L1463" class="source_line" href="#L1463">1463</a>
<a id="L1464" class="source_line" href="#L1464">1464</a>
<a id="L1465" class="source_line" href="#L1465">1465</a>
<a id="L1466" class="source_line" href="#L1466">1466</a>
<a id="L1467" class="source_line" href="#L1467">1467</a>
<a id="L1468" class="source_line" href="#L1468">1468</a>
<a id="L1469" class="source_line" href="#L1469">1469</a>
<a id="L1470" class="source_line" href="#L1470">1470</a>
<a id="L1471" class="source_line" href="#L1471">1471</a>
<a id="L1472" class="source_line" href="#L1472">1472</a>
<a id="L1473" class="source_line" href="#L1473">1473</a>
<a id="L1474" class="source_line" href="#L1474">1474</a>
<a id="L1475" class="source_line" href="#L1475">1475</a>
<a id="L1476" class="source_line" href="#L1476">1476</a>
<a id="L1477" class="source_line" href="#L1477">1477</a>
<a id="L1478" class="source_line" href="#L1478">1478</a>
<a id="L1479" class="source_line" href="#L1479">1479</a>
<a id="L1480" class="source_line" href="#L1480">1480</a>
<a id="L1481" class="source_line" href="#L1481">1481</a>
<a id="L1482" class="source_line" href="#L1482">1482</a>
<a id="L1483" class="source_line" href="#L1483">1483</a>
<a id="L1484" class="source_line" href="#L1484">1484</a>
<a id="L1485" class="source_line" href="#L1485">1485</a>
<a id="L1486" class="source_line" href="#L1486">1486</a>
<a id="L1487" class="source_line" href="#L1487">1487</a>
<a id="L1488" class="source_line" href="#L1488">1488</a>
<a id="L1489" class="source_line" href="#L1489">1489</a>
<a id="L1490" class="source_line" href="#L1490">1490</a>
<a id="L1491" class="source_line" href="#L1491">1491</a>
<a id="L1492" class="source_line" href="#L1492">1492</a>
<a id="L1493" class="source_line" href="#L1493">1493</a>
<a id="L1494" class="source_line" href="#L1494">1494</a>
<a id="L1495" class="source_line" href="#L1495">1495</a>
<a id="L1496" class="source_line" href="#L1496">1496</a>
<a id="L1497" class="source_line" href="#L1497">1497</a>
<a id="L1498" class="source_line" href="#L1498">1498</a>
<a id="L1499" class="source_line" href="#L1499">1499</a>
<a id="L1500" class="source_line" href="#L1500">1500</a>
<a id="L1501" class="source_line" href="#L1501">1501</a>
<a id="L1502" class="source_line" href="#L1502">1502</a>
<a id="L1503" class="source_line" href="#L1503">1503</a>
<a id="L1504" class="source_line" href="#L1504">1504</a>
<a id="L1505" class="source_line" href="#L1505">1505</a>
<a id="L1506" class="source_line" href="#L1506">1506</a>
<a id="L1507" class="source_line" href="#L1507">1507</a>
<a id="L1508" class="source_line" href="#L1508">1508</a>
<a id="L1509" class="source_line" href="#L1509">1509</a>
<a id="L1510" class="source_line" href="#L1510">1510</a>
<a id="L1511" class="source_line" href="#L1511">1511</a>
<a id="L1512" class="source_line" href="#L1512">1512</a>
<a id="L1513" class="source_line" href="#L1513">1513</a>
<a id="L1514" class="source_line" href="#L1514">1514</a>
<a id="L1515" class="source_line" href="#L1515">1515</a>
<a id="L1516" class="source_line" href="#L1516">1516</a>
<a id="L1517" class="source_line" href="#L1517">1517</a>
<a id="L1518" class="source_line" href="#L1518">1518</a>
<a id="L1519" class="source_line" href="#L1519">1519</a>
<a id="L1520" class="source_line" href="#L1520">1520</a>
<a id="L1521" class="source_line" href="#L1521">1521</a>
<a id="L1522" class="source_line" href="#L1522">1522</a>
<a id="L1523" class="source_line" href="#L1523">1523</a>
<a id="L1524" class="source_line" href="#L1524">1524</a>
<a id="L1525" class="source_line" href="#L1525">1525</a>
<a id="L1526" class="source_line" href="#L1526">1526</a>
<a id="L1527" class="source_line" href="#L1527">1527</a>
<a id="L1528" class="source_line" href="#L1528">1528</a>
<a id="L1529" class="source_line" href="#L1529">1529</a>
<a id="L1530" class="source_line" href="#L1530">1530</a>
<a id="L1531" class="source_line" href="#L1531">1531</a>
<a id="L1532" class="source_line" href="#L1532">1532</a>
<a id="L1533" class="source_line" href="#L1533">1533</a>
<a id="L1534" class="source_line" href="#L1534">1534</a>
<a id="L1535" class="source_line" href="#L1535">1535</a>
<a id="L1536" class="source_line" href="#L1536">1536</a>
<a id="L1537" class="source_line" href="#L1537">1537</a>
<a id="L1538" class="source_line" href="#L1538">1538</a>
<a id="L1539" class="source_line" href="#L1539">1539</a>
<a id="L1540" class="source_line" href="#L1540">1540</a>
<a id="L1541" class="source_line" href="#L1541">1541</a>
<a id="L1542" class="source_line" href="#L1542">1542</a>
<a id="L1543" class="source_line" href="#L1543">1543</a>
<a id="L1544" class="source_line" href="#L1544">1544</a>
<a id="L1545" class="source_line" href="#L1545">1545</a>
<a id="L1546" class="source_line" href="#L1546">1546</a>
<a id="L1547" class="source_line" href="#L1547">1547</a>
<a id="L1548" class="source_line" href="#L1548">1548</a>
<a id="L1549" class="source_line" href="#L1549">1549</a>
<a id="L1550" class="source_line" href="#L1550">1550</a>
<a id="L1551" class="source_line" href="#L1551">1551</a>
<a id="L1552" class="source_line" href="#L1552">1552</a>
<a id="L1553" class="source_line" href="#L1553">1553</a>
<a id="L1554" class="source_line" href="#L1554">1554</a>
<a id="L1555" class="source_line" href="#L1555">1555</a>
<a id="L1556" class="source_line" href="#L1556">1556</a>
<a id="L1557" class="source_line" href="#L1557">1557</a>
<a id="L1558" class="source_line" href="#L1558">1558</a>
<a id="L1559" class="source_line" href="#L1559">1559</a>
<a id="L1560" class="source_line" href="#L1560">1560</a>
<a id="L1561" class="source_line" href="#L1561">1561</a>
<a id="L1562" class="source_line" href="#L1562">1562</a>
<a id="L1563" class="source_line" href="#L1563">1563</a>
<a id="L1564" class="source_line" href="#L1564">1564</a>
<a id="L1565" class="source_line" href="#L1565">1565</a>
<a id="L1566" class="source_line" href="#L1566">1566</a>
<a id="L1567" class="source_line" href="#L1567">1567</a>
<a id="L1568" class="source_line" href="#L1568">1568</a>
<a id="L1569" class="source_line" href="#L1569">1569</a>
<a id="L1570" class="source_line" href="#L1570">1570</a>
<a id="L1571" class="source_line" href="#L1571">1571</a>
<a id="L1572" class="source_line" href="#L1572">1572</a>
<a id="L1573" class="source_line" href="#L1573">1573</a>
<a id="L1574" class="source_line" href="#L1574">1574</a>
<a id="L1575" class="source_line" href="#L1575">1575</a>
<a id="L1576" class="source_line" href="#L1576">1576</a>
<a id="L1577" class="source_line" href="#L1577">1577</a>
<a id="L1578" class="source_line" href="#L1578">1578</a>
<a id="L1579" class="source_line" href="#L1579">1579</a>
<a id="L1580" class="source_line" href="#L1580">1580</a>
<a id="L1581" class="source_line" href="#L1581">1581</a>
<a id="L1582" class="source_line" href="#L1582">1582</a>
<a id="L1583" class="source_line" href="#L1583">1583</a>
<a id="L1584" class="source_line" href="#L1584">1584</a>
<a id="L1585" class="source_line" href="#L1585">1585</a>
<a id="L1586" class="source_line" href="#L1586">1586</a>
<a id="L1587" class="source_line" href="#L1587">1587</a>
<a id="L1588" class="source_line" href="#L1588">1588</a>
<a id="L1589" class="source_line" href="#L1589">1589</a>
<a id="L1590" class="source_line" href="#L1590">1590</a>
<a id="L1591" class="source_line" href="#L1591">1591</a>
<a id="L1592" class="source_line" href="#L1592">1592</a>
<a id="L1593" class="source_line" href="#L1593">1593</a>
<a id="L1594" class="source_line" href="#L1594">1594</a>
<a id="L1595" class="source_line" href="#L1595">1595</a>
<a id="L1596" class="source_line" href="#L1596">1596</a>
<a id="L1597" class="source_line" href="#L1597">1597</a>
<a id="L1598" class="source_line" href="#L1598">1598</a>
<a id="L1599" class="source_line" href="#L1599">1599</a>
<a id="L1600" class="source_line" href="#L1600">1600</a>
<a id="L1601" class="source_line" href="#L1601">1601</a>
<a id="L1602" class="source_line" href="#L1602">1602</a>
<a id="L1603" class="source_line" href="#L1603">1603</a>
<a id="L1604" class="source_line" href="#L1604">1604</a>
<a id="L1605" class="source_line" href="#L1605">1605</a>
<a id="L1606" class="source_line" href="#L1606">1606</a>
<a id="L1607" class="source_line" href="#L1607">1607</a>
<a id="L1608" class="source_line" href="#L1608">1608</a>
<a id="L1609" class="source_line" href="#L1609">1609</a>
<a id="L1610" class="source_line" href="#L1610">1610</a>
<a id="L1611" class="source_line" href="#L1611">1611</a>
<a id="L1612" class="source_line" href="#L1612">1612</a>
<a id="L1613" class="source_line" href="#L1613">1613</a>
<a id="L1614" class="source_line" href="#L1614">1614</a>
<a id="L1615" class="source_line" href="#L1615">1615</a>
<a id="L1616" class="source_line" href="#L1616">1616</a>
<a id="L1617" class="source_line" href="#L1617">1617</a>
<a id="L1618" class="source_line" href="#L1618">1618</a>
<a id="L1619" class="source_line" href="#L1619">1619</a>
<a id="L1620" class="source_line" href="#L1620">1620</a>
<a id="L1621" class="source_line" href="#L1621">1621</a>
<a id="L1622" class="source_line" href="#L1622">1622</a>
<a id="L1623" class="source_line" href="#L1623">1623</a>
<a id="L1624" class="source_line" href="#L1624">1624</a>
<a id="L1625" class="source_line" href="#L1625">1625</a>
<a id="L1626" class="source_line" href="#L1626">1626</a>
<a id="L1627" class="source_line" href="#L1627">1627</a>
<a id="L1628" class="source_line" href="#L1628">1628</a>
<a id="L1629" class="source_line" href="#L1629">1629</a>
<a id="L1630" class="source_line" href="#L1630">1630</a>
<a id="L1631" class="source_line" href="#L1631">1631</a>
<a id="L1632" class="source_line" href="#L1632">1632</a>
<a id="L1633" class="source_line" href="#L1633">1633</a>
<a id="L1634" class="source_line" href="#L1634">1634</a>
<a id="L1635" class="source_line" href="#L1635">1635</a>
<a id="L1636" class="source_line" href="#L1636">1636</a>
<a id="L1637" class="source_line" href="#L1637">1637</a>
<a id="L1638" class="source_line" href="#L1638">1638</a>
<a id="L1639" class="source_line" href="#L1639">1639</a>
<a id="L1640" class="source_line" href="#L1640">1640</a>
<a id="L1641" class="source_line" href="#L1641">1641</a>
<a id="L1642" class="source_line" href="#L1642">1642</a>
<a id="L1643" class="source_line" href="#L1643">1643</a>
<a id="L1644" class="source_line" href="#L1644">1644</a>
<a id="L1645" class="source_line" href="#L1645">1645</a>
<a id="L1646" class="source_line" href="#L1646">1646</a>
<a id="L1647" class="source_line" href="#L1647">1647</a>
<a id="L1648" class="source_line" href="#L1648">1648</a>
<a id="L1649" class="source_line" href="#L1649">1649</a>
<a id="L1650" class="source_line" href="#L1650">1650</a>
<a id="L1651" class="source_line" href="#L1651">1651</a>
<a id="L1652" class="source_line" href="#L1652">1652</a>
<a id="L1653" class="source_line" href="#L1653">1653</a>
<a id="L1654" class="source_line" href="#L1654">1654</a>
<a id="L1655" class="source_line" href="#L1655">1655</a>
<a id="L1656" class="source_line" href="#L1656">1656</a>
<a id="L1657" class="source_line" href="#L1657">1657</a>
<a id="L1658" class="source_line" href="#L1658">1658</a>
<a id="L1659" class="source_line" href="#L1659">1659</a>
<a id="L1660" class="source_line" href="#L1660">1660</a>
<a id="L1661" class="source_line" href="#L1661">1661</a>
<a id="L1662" class="source_line" href="#L1662">1662</a>
<a id="L1663" class="source_line" href="#L1663">1663</a>
<a id="L1664" class="source_line" href="#L1664">1664</a>
<a id="L1665" class="source_line" href="#L1665">1665</a>
<a id="L1666" class="source_line" href="#L1666">1666</a>
<a id="L1667" class="source_line" href="#L1667">1667</a>
<a id="L1668" class="source_line" href="#L1668">1668</a>
<a id="L1669" class="source_line" href="#L1669">1669</a>
<a id="L1670" class="source_line" href="#L1670">1670</a>
<a id="L1671" class="source_line" href="#L1671">1671</a>
<a id="L1672" class="source_line" href="#L1672">1672</a>
<a id="L1673" class="source_line" href="#L1673">1673</a>
<a id="L1674" class="source_line" href="#L1674">1674</a>
<a id="L1675" class="source_line" href="#L1675">1675</a>
<a id="L1676" class="source_line" href="#L1676">1676</a>
<a id="L1677" class="source_line" href="#L1677">1677</a>
<a id="L1678" class="source_line" href="#L1678">1678</a>
<a id="L1679" class="source_line" href="#L1679">1679</a>
<a id="L1680" class="source_line" href="#L1680">1680</a>
<a id="L1681" class="source_line" href="#L1681">1681</a>
<a id="L1682" class="source_line" href="#L1682">1682</a>
<a id="L1683" class="source_line" href="#L1683">1683</a>
<a id="L1684" class="source_line" href="#L1684">1684</a>
<a id="L1685" class="source_line" href="#L1685">1685</a>
<a id="L1686" class="source_line" href="#L1686">1686</a>
<a id="L1687" class="source_line" href="#L1687">1687</a>
<a id="L1688" class="source_line" href="#L1688">1688</a>
<a id="L1689" class="source_line" href="#L1689">1689</a>
<a id="L1690" class="source_line" href="#L1690">1690</a>
<a id="L1691" class="source_line" href="#L1691">1691</a>
<a id="L1692" class="source_line" href="#L1692">1692</a>
<a id="L1693" class="source_line" href="#L1693">1693</a>
<a id="L1694" class="source_line" href="#L1694">1694</a>
<a id="L1695" class="source_line" href="#L1695">1695</a>
<a id="L1696" class="source_line" href="#L1696">1696</a>
<a id="L1697" class="source_line" href="#L1697">1697</a>
<a id="L1698" class="source_line" href="#L1698">1698</a>
<a id="L1699" class="source_line" href="#L1699">1699</a>
<a id="L1700" class="source_line" href="#L1700">1700</a>
<a id="L1701" class="source_line" href="#L1701">1701</a>
<a id="L1702" class="source_line" href="#L1702">1702</a>
<a id="L1703" class="source_line" href="#L1703">1703</a>
<a id="L1704" class="source_line" href="#L1704">1704</a>
<a id="L1705" class="source_line" href="#L1705">1705</a>
<a id="L1706" class="source_line" href="#L1706">1706</a>
<a id="L1707" class="source_line" href="#L1707">1707</a>
<a id="L1708" class="source_line" href="#L1708">1708</a>
<a id="L1709" class="source_line" href="#L1709">1709</a>
<a id="L1710" class="source_line" href="#L1710">1710</a>
<a id="L1711" class="source_line" href="#L1711">1711</a>
<a id="L1712" class="source_line" href="#L1712">1712</a>
<a id="L1713" class="source_line" href="#L1713">1713</a>
<a id="L1714" class="source_line" href="#L1714">1714</a>
<a id="L1715" class="source_line" href="#L1715">1715</a>
<a id="L1716" class="source_line" href="#L1716">1716</a>
<a id="L1717" class="source_line" href="#L1717">1717</a>
<a id="L1718" class="source_line" href="#L1718">1718</a>
<a id="L1719" class="source_line" href="#L1719">1719</a>
<a id="L1720" class="source_line" href="#L1720">1720</a>
<a id="L1721" class="source_line" href="#L1721">1721</a>
<a id="L1722" class="source_line" href="#L1722">1722</a>
<a id="L1723" class="source_line" href="#L1723">1723</a>
<a id="L1724" class="source_line" href="#L1724">1724</a>
<a id="L1725" class="source_line" href="#L1725">1725</a>
<a id="L1726" class="source_line" href="#L1726">1726</a>
<a id="L1727" class="source_line" href="#L1727">1727</a>
<a id="L1728" class="source_line" href="#L1728">1728</a>
<a id="L1729" class="source_line" href="#L1729">1729</a>
<a id="L1730" class="source_line" href="#L1730">1730</a>
<a id="L1731" class="source_line" href="#L1731">1731</a>
<a id="L1732" class="source_line" href="#L1732">1732</a>
<a id="L1733" class="source_line" href="#L1733">1733</a>
<a id="L1734" class="source_line" href="#L1734">1734</a>
<a id="L1735" class="source_line" href="#L1735">1735</a>
<a id="L1736" class="source_line" href="#L1736">1736</a>
<a id="L1737" class="source_line" href="#L1737">1737</a>
<a id="L1738" class="source_line" href="#L1738">1738</a>
<a id="L1739" class="source_line" href="#L1739">1739</a>
<a id="L1740" class="source_line" href="#L1740">1740</a>
<a id="L1741" class="source_line" href="#L1741">1741</a>
<a id="L1742" class="source_line" href="#L1742">1742</a>
<a id="L1743" class="source_line" href="#L1743">1743</a>
<a id="L1744" class="source_line" href="#L1744">1744</a>
<a id="L1745" class="source_line" href="#L1745">1745</a>
<a id="L1746" class="source_line" href="#L1746">1746</a>
<a id="L1747" class="source_line" href="#L1747">1747</a>
<a id="L1748" class="source_line" href="#L1748">1748</a>
<a id="L1749" class="source_line" href="#L1749">1749</a>
<a id="L1750" class="source_line" href="#L1750">1750</a>
<a id="L1751" class="source_line" href="#L1751">1751</a>
<a id="L1752" class="source_line" href="#L1752">1752</a>
<a id="L1753" class="source_line" href="#L1753">1753</a>
<a id="L1754" class="source_line" href="#L1754">1754</a>
<a id="L1755" class="source_line" href="#L1755">1755</a>
<a id="L1756" class="source_line" href="#L1756">1756</a>
<a id="L1757" class="source_line" href="#L1757">1757</a>
<a id="L1758" class="source_line" href="#L1758">1758</a>
<a id="L1759" class="source_line" href="#L1759">1759</a>
<a id="L1760" class="source_line" href="#L1760">1760</a>
<a id="L1761" class="source_line" href="#L1761">1761</a>
<a id="L1762" class="source_line" href="#L1762">1762</a>
<a id="L1763" class="source_line" href="#L1763">1763</a>
<a id="L1764" class="source_line" href="#L1764">1764</a>
<a id="L1765" class="source_line" href="#L1765">1765</a>
<a id="L1766" class="source_line" href="#L1766">1766</a>
<a id="L1767" class="source_line" href="#L1767">1767</a>
<a id="L1768" class="source_line" href="#L1768">1768</a>
<a id="L1769" class="source_line" href="#L1769">1769</a>
<a id="L1770" class="source_line" href="#L1770">1770</a>
<a id="L1771" class="source_line" href="#L1771">1771</a>
<a id="L1772" class="source_line" href="#L1772">1772</a>
<a id="L1773" class="source_line" href="#L1773">1773</a>
<a id="L1774" class="source_line" href="#L1774">1774</a>
<a id="L1775" class="source_line" href="#L1775">1775</a>
<a id="L1776" class="source_line" href="#L1776">1776</a>
<a id="L1777" class="source_line" href="#L1777">1777</a>
<a id="L1778" class="source_line" href="#L1778">1778</a>
<a id="L1779" class="source_line" href="#L1779">1779</a>
<a id="L1780" class="source_line" href="#L1780">1780</a>
<a id="L1781" class="source_line" href="#L1781">1781</a>
<a id="L1782" class="source_line" href="#L1782">1782</a>
<a id="L1783" class="source_line" href="#L1783">1783</a>
<a id="L1784" class="source_line" href="#L1784">1784</a>
<a id="L1785" class="source_line" href="#L1785">1785</a>
<a id="L1786" class="source_line" href="#L1786">1786</a>
<a id="L1787" class="source_line" href="#L1787">1787</a>
<a id="L1788" class="source_line" href="#L1788">1788</a>
<a id="L1789" class="source_line" href="#L1789">1789</a>
<a id="L1790" class="source_line" href="#L1790">1790</a>
<a id="L1791" class="source_line" href="#L1791">1791</a>
<a id="L1792" class="source_line" href="#L1792">1792</a>
<a id="L1793" class="source_line" href="#L1793">1793</a>
<a id="L1794" class="source_line" href="#L1794">1794</a>
<a id="L1795" class="source_line" href="#L1795">1795</a>
<a id="L1796" class="source_line" href="#L1796">1796</a>
<a id="L1797" class="source_line" href="#L1797">1797</a>
<a id="L1798" class="source_line" href="#L1798">1798</a>
<a id="L1799" class="source_line" href="#L1799">1799</a>
<a id="L1800" class="source_line" href="#L1800">1800</a>
<a id="L1801" class="source_line" href="#L1801">1801</a>
<a id="L1802" class="source_line" href="#L1802">1802</a>
<a id="L1803" class="source_line" href="#L1803">1803</a>
<a id="L1804" class="source_line" href="#L1804">1804</a>
<a id="L1805" class="source_line" href="#L1805">1805</a>
<a id="L1806" class="source_line" href="#L1806">1806</a>
<a id="L1807" class="source_line" href="#L1807">1807</a>
<a id="L1808" class="source_line" href="#L1808">1808</a>
<a id="L1809" class="source_line" href="#L1809">1809</a>
<a id="L1810" class="source_line" href="#L1810">1810</a>
<a id="L1811" class="source_line" href="#L1811">1811</a>
<a id="L1812" class="source_line" href="#L1812">1812</a>
<a id="L1813" class="source_line" href="#L1813">1813</a>
<a id="L1814" class="source_line" href="#L1814">1814</a>
<a id="L1815" class="source_line" href="#L1815">1815</a>
<a id="L1816" class="source_line" href="#L1816">1816</a>
<a id="L1817" class="source_line" href="#L1817">1817</a>
<a id="L1818" class="source_line" href="#L1818">1818</a>
<a id="L1819" class="source_line" href="#L1819">1819</a>
<a id="L1820" class="source_line" href="#L1820">1820</a>
<a id="L1821" class="source_line" href="#L1821">1821</a>
<a id="L1822" class="source_line" href="#L1822">1822</a>
<a id="L1823" class="source_line" href="#L1823">1823</a>
<a id="L1824" class="source_line" href="#L1824">1824</a>
<a id="L1825" class="source_line" href="#L1825">1825</a>
<a id="L1826" class="source_line" href="#L1826">1826</a>
<a id="L1827" class="source_line" href="#L1827">1827</a>
<a id="L1828" class="source_line" href="#L1828">1828</a>
<a id="L1829" class="source_line" href="#L1829">1829</a>
<a id="L1830" class="source_line" href="#L1830">1830</a>
<a id="L1831" class="source_line" href="#L1831">1831</a>
<a id="L1832" class="source_line" href="#L1832">1832</a>
<a id="L1833" class="source_line" href="#L1833">1833</a>
<a id="L1834" class="source_line" href="#L1834">1834</a>
<a id="L1835" class="source_line" href="#L1835">1835</a>
<a id="L1836" class="source_line" href="#L1836">1836</a>
<a id="L1837" class="source_line" href="#L1837">1837</a>
<a id="L1838" class="source_line" href="#L1838">1838</a>
<a id="L1839" class="source_line" href="#L1839">1839</a>
<a id="L1840" class="source_line" href="#L1840">1840</a>
<a id="L1841" class="source_line" href="#L1841">1841</a>
<a id="L1842" class="source_line" href="#L1842">1842</a>
<a id="L1843" class="source_line" href="#L1843">1843</a>
<a id="L1844" class="source_line" href="#L1844">1844</a>
<a id="L1845" class="source_line" href="#L1845">1845</a>
<a id="L1846" class="source_line" href="#L1846">1846</a>
<a id="L1847" class="source_line" href="#L1847">1847</a>
<a id="L1848" class="source_line" href="#L1848">1848</a>
<a id="L1849" class="source_line" href="#L1849">1849</a>
<a id="L1850" class="source_line" href="#L1850">1850</a>
<a id="L1851" class="source_line" href="#L1851">1851</a>
<a id="L1852" class="source_line" href="#L1852">1852</a>
<a id="L1853" class="source_line" href="#L1853">1853</a>
<a id="L1854" class="source_line" href="#L1854">1854</a>
<a id="L1855" class="source_line" href="#L1855">1855</a>
<a id="L1856" class="source_line" href="#L1856">1856</a>
<a id="L1857" class="source_line" href="#L1857">1857</a>
<a id="L1858" class="source_line" href="#L1858">1858</a>
<a id="L1859" class="source_line" href="#L1859">1859</a>
<a id="L1860" class="source_line" href="#L1860">1860</a>
<a id="L1861" class="source_line" href="#L1861">1861</a>
<a id="L1862" class="source_line" href="#L1862">1862</a>
<a id="L1863" class="source_line" href="#L1863">1863</a>
<a id="L1864" class="source_line" href="#L1864">1864</a>
<a id="L1865" class="source_line" href="#L1865">1865</a>
<a id="L1866" class="source_line" href="#L1866">1866</a>
<a id="L1867" class="source_line" href="#L1867">1867</a>
<a id="L1868" class="source_line" href="#L1868">1868</a>
<a id="L1869" class="source_line" href="#L1869">1869</a>
<a id="L1870" class="source_line" href="#L1870">1870</a>
<a id="L1871" class="source_line" href="#L1871">1871</a>
<a id="L1872" class="source_line" href="#L1872">1872</a>
<a id="L1873" class="source_line" href="#L1873">1873</a>
<a id="L1874" class="source_line" href="#L1874">1874</a>
<a id="L1875" class="source_line" href="#L1875">1875</a>
<a id="L1876" class="source_line" href="#L1876">1876</a>
<a id="L1877" class="source_line" href="#L1877">1877</a>
<a id="L1878" class="source_line" href="#L1878">1878</a>
<a id="L1879" class="source_line" href="#L1879">1879</a>
<a id="L1880" class="source_line" href="#L1880">1880</a>
<a id="L1881" class="source_line" href="#L1881">1881</a>
<a id="L1882" class="source_line" href="#L1882">1882</a>
<a id="L1883" class="source_line" href="#L1883">1883</a>
<a id="L1884" class="source_line" href="#L1884">1884</a>
<a id="L1885" class="source_line" href="#L1885">1885</a>
<a id="L1886" class="source_line" href="#L1886">1886</a>
<a id="L1887" class="source_line" href="#L1887">1887</a>
<a id="L1888" class="source_line" href="#L1888">1888</a>
<a id="L1889" class="source_line" href="#L1889">1889</a>
<a id="L1890" class="source_line" href="#L1890">1890</a>
<a id="L1891" class="source_line" href="#L1891">1891</a>
<a id="L1892" class="source_line" href="#L1892">1892</a>
<a id="L1893" class="source_line" href="#L1893">1893</a>
<a id="L1894" class="source_line" href="#L1894">1894</a>
<a id="L1895" class="source_line" href="#L1895">1895</a>
<a id="L1896" class="source_line" href="#L1896">1896</a>
<a id="L1897" class="source_line" href="#L1897">1897</a>
<a id="L1898" class="source_line" href="#L1898">1898</a>
<a id="L1899" class="source_line" href="#L1899">1899</a>
<a id="L1900" class="source_line" href="#L1900">1900</a>
<a id="L1901" class="source_line" href="#L1901">1901</a>
<a id="L1902" class="source_line" href="#L1902">1902</a>
<a id="L1903" class="source_line" href="#L1903">1903</a>
<a id="L1904" class="source_line" href="#L1904">1904</a>
<a id="L1905" class="source_line" href="#L1905">1905</a>
<a id="L1906" class="source_line" href="#L1906">1906</a>
<a id="L1907" class="source_line" href="#L1907">1907</a>
<a id="L1908" class="source_line" href="#L1908">1908</a>
<a id="L1909" class="source_line" href="#L1909">1909</a>
<a id="L1910" class="source_line" href="#L1910">1910</a>
<a id="L1911" class="source_line" href="#L1911">1911</a>
<a id="L1912" class="source_line" href="#L1912">1912</a>
<a id="L1913" class="source_line" href="#L1913">1913</a>
<a id="L1914" class="source_line" href="#L1914">1914</a>
<a id="L1915" class="source_line" href="#L1915">1915</a>
<a id="L1916" class="source_line" href="#L1916">1916</a>
<a id="L1917" class="source_line" href="#L1917">1917</a>
<a id="L1918" class="source_line" href="#L1918">1918</a>
<a id="L1919" class="source_line" href="#L1919">1919</a>
<a id="L1920" class="source_line" href="#L1920">1920</a>
<a id="L1921" class="source_line" href="#L1921">1921</a>
<a id="L1922" class="source_line" href="#L1922">1922</a>
<a id="L1923" class="source_line" href="#L1923">1923</a>
<a id="L1924" class="source_line" href="#L1924">1924</a>
<a id="L1925" class="source_line" href="#L1925">1925</a>
<a id="L1926" class="source_line" href="#L1926">1926</a>
<a id="L1927" class="source_line" href="#L1927">1927</a>
<a id="L1928" class="source_line" href="#L1928">1928</a>
<a id="L1929" class="source_line" href="#L1929">1929</a>
<a id="L1930" class="source_line" href="#L1930">1930</a>
<a id="L1931" class="source_line" href="#L1931">1931</a>
<a id="L1932" class="source_line" href="#L1932">1932</a>
<a id="L1933" class="source_line" href="#L1933">1933</a>
<a id="L1934" class="source_line" href="#L1934">1934</a>
<a id="L1935" class="source_line" href="#L1935">1935</a>
<a id="L1936" class="source_line" href="#L1936">1936</a>
<a id="L1937" class="source_line" href="#L1937">1937</a>
<a id="L1938" class="source_line" href="#L1938">1938</a>
<a id="L1939" class="source_line" href="#L1939">1939</a>
<a id="L1940" class="source_line" href="#L1940">1940</a>
<a id="L1941" class="source_line" href="#L1941">1941</a>
<a id="L1942" class="source_line" href="#L1942">1942</a>
<a id="L1943" class="source_line" href="#L1943">1943</a>
<a id="L1944" class="source_line" href="#L1944">1944</a>
<a id="L1945" class="source_line" href="#L1945">1945</a>
<a id="L1946" class="source_line" href="#L1946">1946</a>
<a id="L1947" class="source_line" href="#L1947">1947</a>
<a id="L1948" class="source_line" href="#L1948">1948</a>
<a id="L1949" class="source_line" href="#L1949">1949</a>
<a id="L1950" class="source_line" href="#L1950">1950</a>
<a id="L1951" class="source_line" href="#L1951">1951</a>
<a id="L1952" class="source_line" href="#L1952">1952</a>
<a id="L1953" class="source_line" href="#L1953">1953</a>
<a id="L1954" class="source_line" href="#L1954">1954</a>
<a id="L1955" class="source_line" href="#L1955">1955</a>
<a id="L1956" class="source_line" href="#L1956">1956</a>
<a id="L1957" class="source_line" href="#L1957">1957</a>
<a id="L1958" class="source_line" href="#L1958">1958</a>
<a id="L1959" class="source_line" href="#L1959">1959</a>
<a id="L1960" class="source_line" href="#L1960">1960</a>
<a id="L1961" class="source_line" href="#L1961">1961</a>
<a id="L1962" class="source_line" href="#L1962">1962</a>
<a id="L1963" class="source_line" href="#L1963">1963</a>
<a id="L1964" class="source_line" href="#L1964">1964</a>
<a id="L1965" class="source_line" href="#L1965">1965</a>
<a id="L1966" class="source_line" href="#L1966">1966</a>
<a id="L1967" class="source_line" href="#L1967">1967</a>
<a id="L1968" class="source_line" href="#L1968">1968</a>
<a id="L1969" class="source_line" href="#L1969">1969</a>
<a id="L1970" class="source_line" href="#L1970">1970</a>
<a id="L1971" class="source_line" href="#L1971">1971</a>
<a id="L1972" class="source_line" href="#L1972">1972</a>
<a id="L1973" class="source_line" href="#L1973">1973</a>
<a id="L1974" class="source_line" href="#L1974">1974</a>
<a id="L1975" class="source_line" href="#L1975">1975</a>
<a id="L1976" class="source_line" href="#L1976">1976</a>
<a id="L1977" class="source_line" href="#L1977">1977</a>
<a id="L1978" class="source_line" href="#L1978">1978</a>
<a id="L1979" class="source_line" href="#L1979">1979</a>
<a id="L1980" class="source_line" href="#L1980">1980</a>
<a id="L1981" class="source_line" href="#L1981">1981</a>
<a id="L1982" class="source_line" href="#L1982">1982</a>
<a id="L1983" class="source_line" href="#L1983">1983</a>
<a id="L1984" class="source_line" href="#L1984">1984</a>
<a id="L1985" class="source_line" href="#L1985">1985</a>
<a id="L1986" class="source_line" href="#L1986">1986</a>
<a id="L1987" class="source_line" href="#L1987">1987</a>
<a id="L1988" class="source_line" href="#L1988">1988</a>
<a id="L1989" class="source_line" href="#L1989">1989</a>
<a id="L1990" class="source_line" href="#L1990">1990</a>
<a id="L1991" class="source_line" href="#L1991">1991</a>
<a id="L1992" class="source_line" href="#L1992">1992</a>
<a id="L1993" class="source_line" href="#L1993">1993</a>
<a id="L1994" class="source_line" href="#L1994">1994</a>
<a id="L1995" class="source_line" href="#L1995">1995</a>
<a id="L1996" class="source_line" href="#L1996">1996</a>
<a id="L1997" class="source_line" href="#L1997">1997</a>
<a id="L1998" class="source_line" href="#L1998">1998</a>
<a id="L1999" class="source_line" href="#L1999">1999</a>
<a id="L2000" class="source_line" href="#L2000">2000</a>
<a id="L2001" class="source_line" href="#L2001">2001</a>
<a id="L2002" class="source_line" href="#L2002">2002</a>
<a id="L2003" class="source_line" href="#L2003">2003</a>
<a id="L2004" class="source_line" href="#L2004">2004</a>
<a id="L2005" class="source_line" href="#L2005">2005</a>
<a id="L2006" class="source_line" href="#L2006">2006</a>
<a id="L2007" class="source_line" href="#L2007">2007</a>
<a id="L2008" class="source_line" href="#L2008">2008</a>
<a id="L2009" class="source_line" href="#L2009">2009</a>
<a id="L2010" class="source_line" href="#L2010">2010</a>
<a id="L2011" class="source_line" href="#L2011">2011</a>
<a id="L2012" class="source_line" href="#L2012">2012</a>
<a id="L2013" class="source_line" href="#L2013">2013</a>
<a id="L2014" class="source_line" href="#L2014">2014</a>
<a id="L2015" class="source_line" href="#L2015">2015</a>
<a id="L2016" class="source_line" href="#L2016">2016</a>
<a id="L2017" class="source_line" href="#L2017">2017</a>
<a id="L2018" class="source_line" href="#L2018">2018</a>
<a id="L2019" class="source_line" href="#L2019">2019</a>
<a id="L2020" class="source_line" href="#L2020">2020</a>
<a id="L2021" class="source_line" href="#L2021">2021</a>
<a id="L2022" class="source_line" href="#L2022">2022</a>
<a id="L2023" class="source_line" href="#L2023">2023</a>
<a id="L2024" class="source_line" href="#L2024">2024</a>
<a id="L2025" class="source_line" href="#L2025">2025</a>
<a id="L2026" class="source_line" href="#L2026">2026</a>
<a id="L2027" class="source_line" href="#L2027">2027</a>
<a id="L2028" class="source_line" href="#L2028">2028</a>
<a id="L2029" class="source_line" href="#L2029">2029</a>
<a id="L2030" class="source_line" href="#L2030">2030</a>
<a id="L2031" class="source_line" href="#L2031">2031</a>
<a id="L2032" class="source_line" href="#L2032">2032</a>
<a id="L2033" class="source_line" href="#L2033">2033</a>
<a id="L2034" class="source_line" href="#L2034">2034</a>
<a id="L2035" class="source_line" href="#L2035">2035</a>
<a id="L2036" class="source_line" href="#L2036">2036</a>
<a id="L2037" class="source_line" href="#L2037">2037</a>
<a id="L2038" class="source_line" href="#L2038">2038</a>
<a id="L2039" class="source_line" href="#L2039">2039</a>
<a id="L2040" class="source_line" href="#L2040">2040</a>
<a id="L2041" class="source_line" href="#L2041">2041</a>
<a id="L2042" class="source_line" href="#L2042">2042</a>
<a id="L2043" class="source_line" href="#L2043">2043</a>
<a id="L2044" class="source_line" href="#L2044">2044</a>
<a id="L2045" class="source_line" href="#L2045">2045</a>
<a id="L2046" class="source_line" href="#L2046">2046</a>
<a id="L2047" class="source_line" href="#L2047">2047</a>
<a id="L2048" class="source_line" href="#L2048">2048</a>
<a id="L2049" class="source_line" href="#L2049">2049</a>
<a id="L2050" class="source_line" href="#L2050">2050</a>
<a id="L2051" class="source_line" href="#L2051">2051</a>
<a id="L2052" class="source_line" href="#L2052">2052</a>
<a id="L2053" class="source_line" href="#L2053">2053</a>
<a id="L2054" class="source_line" href="#L2054">2054</a>
<a id="L2055" class="source_line" href="#L2055">2055</a>
<a id="L2056" class="source_line" href="#L2056">2056</a>
<a id="L2057" class="source_line" href="#L2057">2057</a>
<a id="L2058" class="source_line" href="#L2058">2058</a>
<a id="L2059" class="source_line" href="#L2059">2059</a>
<a id="L2060" class="source_line" href="#L2060">2060</a>
<a id="L2061" class="source_line" href="#L2061">2061</a>
<a id="L2062" class="source_line" href="#L2062">2062</a>
<a id="L2063" class="source_line" href="#L2063">2063</a>
<a id="L2064" class="source_line" href="#L2064">2064</a>
<a id="L2065" class="source_line" href="#L2065">2065</a>
<a id="L2066" class="source_line" href="#L2066">2066</a>
<a id="L2067" class="source_line" href="#L2067">2067</a>
<a id="L2068" class="source_line" href="#L2068">2068</a>
<a id="L2069" class="source_line" href="#L2069">2069</a>
<a id="L2070" class="source_line" href="#L2070">2070</a>
<a id="L2071" class="source_line" href="#L2071">2071</a>
<a id="L2072" class="source_line" href="#L2072">2072</a>
<a id="L2073" class="source_line" href="#L2073">2073</a>
<a id="L2074" class="source_line" href="#L2074">2074</a>
<a id="L2075" class="source_line" href="#L2075">2075</a>
<a id="L2076" class="source_line" href="#L2076">2076</a>
<a id="L2077" class="source_line" href="#L2077">2077</a>
<a id="L2078" class="source_line" href="#L2078">2078</a>
<a id="L2079" class="source_line" href="#L2079">2079</a>
<a id="L2080" class="source_line" href="#L2080">2080</a>
<a id="L2081" class="source_line" href="#L2081">2081</a>
<a id="L2082" class="source_line" href="#L2082">2082</a>
<a id="L2083" class="source_line" href="#L2083">2083</a>
<a id="L2084" class="source_line" href="#L2084">2084</a>
<a id="L2085" class="source_line" href="#L2085">2085</a>
<a id="L2086" class="source_line" href="#L2086">2086</a>
<a id="L2087" class="source_line" href="#L2087">2087</a>
<a id="L2088" class="source_line" href="#L2088">2088</a>
<a id="L2089" class="source_line" href="#L2089">2089</a>
<a id="L2090" class="source_line" href="#L2090">2090</a>
<a id="L2091" class="source_line" href="#L2091">2091</a>
<a id="L2092" class="source_line" href="#L2092">2092</a>
<a id="L2093" class="source_line" href="#L2093">2093</a>
<a id="L2094" class="source_line" href="#L2094">2094</a>
<a id="L2095" class="source_line" href="#L2095">2095</a>
<a id="L2096" class="source_line" href="#L2096">2096</a>
<a id="L2097" class="source_line" href="#L2097">2097</a>
<a id="L2098" class="source_line" href="#L2098">2098</a>
<a id="L2099" class="source_line" href="#L2099">2099</a>
<a id="L2100" class="source_line" href="#L2100">2100</a>
<a id="L2101" class="source_line" href="#L2101">2101</a>
<a id="L2102" class="source_line" href="#L2102">2102</a>
<a id="L2103" class="source_line" href="#L2103">2103</a>
<a id="L2104" class="source_line" href="#L2104">2104</a>
<a id="L2105" class="source_line" href="#L2105">2105</a>
<a id="L2106" class="source_line" href="#L2106">2106</a>
<a id="L2107" class="source_line" href="#L2107">2107</a>
<a id="L2108" class="source_line" href="#L2108">2108</a>
<a id="L2109" class="source_line" href="#L2109">2109</a>
<a id="L2110" class="source_line" href="#L2110">2110</a>
<a id="L2111" class="source_line" href="#L2111">2111</a>
<a id="L2112" class="source_line" href="#L2112">2112</a>
<a id="L2113" class="source_line" href="#L2113">2113</a>
<a id="L2114" class="source_line" href="#L2114">2114</a>
<a id="L2115" class="source_line" href="#L2115">2115</a>
<a id="L2116" class="source_line" href="#L2116">2116</a>
<a id="L2117" class="source_line" href="#L2117">2117</a>
<a id="L2118" class="source_line" href="#L2118">2118</a>
<a id="L2119" class="source_line" href="#L2119">2119</a>
<a id="L2120" class="source_line" href="#L2120">2120</a>
<a id="L2121" class="source_line" href="#L2121">2121</a>
<a id="L2122" class="source_line" href="#L2122">2122</a>
<a id="L2123" class="source_line" href="#L2123">2123</a>
<a id="L2124" class="source_line" href="#L2124">2124</a>
<a id="L2125" class="source_line" href="#L2125">2125</a>
<a id="L2126" class="source_line" href="#L2126">2126</a>
<a id="L2127" class="source_line" href="#L2127">2127</a>
<a id="L2128" class="source_line" href="#L2128">2128</a>
<a id="L2129" class="source_line" href="#L2129">2129</a>
<a id="L2130" class="source_line" href="#L2130">2130</a>
<a id="L2131" class="source_line" href="#L2131">2131</a>
<a id="L2132" class="source_line" href="#L2132">2132</a>
<a id="L2133" class="source_line" href="#L2133">2133</a>
<a id="L2134" class="source_line" href="#L2134">2134</a>
<a id="L2135" class="source_line" href="#L2135">2135</a>
<a id="L2136" class="source_line" href="#L2136">2136</a>
<a id="L2137" class="source_line" href="#L2137">2137</a>
<a id="L2138" class="source_line" href="#L2138">2138</a>
<a id="L2139" class="source_line" href="#L2139">2139</a>
<a id="L2140" class="source_line" href="#L2140">2140</a>
<a id="L2141" class="source_line" href="#L2141">2141</a>
<a id="L2142" class="source_line" href="#L2142">2142</a>
<a id="L2143" class="source_line" href="#L2143">2143</a>
<a id="L2144" class="source_line" href="#L2144">2144</a>
<a id="L2145" class="source_line" href="#L2145">2145</a>
<a id="L2146" class="source_line" href="#L2146">2146</a>
<a id="L2147" class="source_line" href="#L2147">2147</a>
<a id="L2148" class="source_line" href="#L2148">2148</a>
<a id="L2149" class="source_line" href="#L2149">2149</a>
<a id="L2150" class="source_line" href="#L2150">2150</a>
<a id="L2151" class="source_line" href="#L2151">2151</a>
<a id="L2152" class="source_line" href="#L2152">2152</a>
<a id="L2153" class="source_line" href="#L2153">2153</a>
<a id="L2154" class="source_line" href="#L2154">2154</a>
<a id="L2155" class="source_line" href="#L2155">2155</a>
<a id="L2156" class="source_line" href="#L2156">2156</a>
<a id="L2157" class="source_line" href="#L2157">2157</a>
<a id="L2158" class="source_line" href="#L2158">2158</a>
<a id="L2159" class="source_line" href="#L2159">2159</a>
<a id="L2160" class="source_line" href="#L2160">2160</a>
<a id="L2161" class="source_line" href="#L2161">2161</a>
<a id="L2162" class="source_line" href="#L2162">2162</a>
<a id="L2163" class="source_line" href="#L2163">2163</a>
<a id="L2164" class="source_line" href="#L2164">2164</a>
<a id="L2165" class="source_line" href="#L2165">2165</a>
<a id="L2166" class="source_line" href="#L2166">2166</a>
<a id="L2167" class="source_line" href="#L2167">2167</a>
<a id="L2168" class="source_line" href="#L2168">2168</a>
<a id="L2169" class="source_line" href="#L2169">2169</a>
<a id="L2170" class="source_line" href="#L2170">2170</a>
<a id="L2171" class="source_line" href="#L2171">2171</a>
<a id="L2172" class="source_line" href="#L2172">2172</a>
<a id="L2173" class="source_line" href="#L2173">2173</a>
<a id="L2174" class="source_line" href="#L2174">2174</a>
<a id="L2175" class="source_line" href="#L2175">2175</a>
<a id="L2176" class="source_line" href="#L2176">2176</a>
<a id="L2177" class="source_line" href="#L2177">2177</a>
<a id="L2178" class="source_line" href="#L2178">2178</a>
<a id="L2179" class="source_line" href="#L2179">2179</a>
<a id="L2180" class="source_line" href="#L2180">2180</a>
<a id="L2181" class="source_line" href="#L2181">2181</a>
<a id="L2182" class="source_line" href="#L2182">2182</a>
<a id="L2183" class="source_line" href="#L2183">2183</a>
<a id="L2184" class="source_line" href="#L2184">2184</a>
<a id="L2185" class="source_line" href="#L2185">2185</a>
<a id="L2186" class="source_line" href="#L2186">2186</a>
<a id="L2187" class="source_line" href="#L2187">2187</a>
<a id="L2188" class="source_line" href="#L2188">2188</a>
<a id="L2189" class="source_line" href="#L2189">2189</a>
<a id="L2190" class="source_line" href="#L2190">2190</a>
<a id="L2191" class="source_line" href="#L2191">2191</a>
<a id="L2192" class="source_line" href="#L2192">2192</a>
<a id="L2193" class="source_line" href="#L2193">2193</a>
<a id="L2194" class="source_line" href="#L2194">2194</a>
<a id="L2195" class="source_line" href="#L2195">2195</a>
<a id="L2196" class="source_line" href="#L2196">2196</a>
<a id="L2197" class="source_line" href="#L2197">2197</a>
<a id="L2198" class="source_line" href="#L2198">2198</a>
<a id="L2199" class="source_line" href="#L2199">2199</a>
<a id="L2200" class="source_line" href="#L2200">2200</a>
<a id="L2201" class="source_line" href="#L2201">2201</a>
<a id="L2202" class="source_line" href="#L2202">2202</a>
<a id="L2203" class="source_line" href="#L2203">2203</a>
<a id="L2204" class="source_line" href="#L2204">2204</a>
<a id="L2205" class="source_line" href="#L2205">2205</a>
<a id="L2206" class="source_line" href="#L2206">2206</a>
<a id="L2207" class="source_line" href="#L2207">2207</a>
<a id="L2208" class="source_line" href="#L2208">2208</a>
<a id="L2209" class="source_line" href="#L2209">2209</a>
<a id="L2210" class="source_line" href="#L2210">2210</a>
<a id="L2211" class="source_line" href="#L2211">2211</a>
<a id="L2212" class="source_line" href="#L2212">2212</a>
<a id="L2213" class="source_line" href="#L2213">2213</a>
<a id="L2214" class="source_line" href="#L2214">2214</a>
<a id="L2215" class="source_line" href="#L2215">2215</a>
<a id="L2216" class="source_line" href="#L2216">2216</a>
<a id="L2217" class="source_line" href="#L2217">2217</a>
<a id="L2218" class="source_line" href="#L2218">2218</a>
<a id="L2219" class="source_line" href="#L2219">2219</a>
<a id="L2220" class="source_line" href="#L2220">2220</a>
<a id="L2221" class="source_line" href="#L2221">2221</a>
<a id="L2222" class="source_line" href="#L2222">2222</a>
<a id="L2223" class="source_line" href="#L2223">2223</a>
<a id="L2224" class="source_line" href="#L2224">2224</a>
<a id="L2225" class="source_line" href="#L2225">2225</a>
<a id="L2226" class="source_line" href="#L2226">2226</a>
<a id="L2227" class="source_line" href="#L2227">2227</a>
<a id="L2228" class="source_line" href="#L2228">2228</a>
<a id="L2229" class="source_line" href="#L2229">2229</a>
<a id="L2230" class="source_line" href="#L2230">2230</a>
<a id="L2231" class="source_line" href="#L2231">2231</a>
<a id="L2232" class="source_line" href="#L2232">2232</a>
<a id="L2233" class="source_line" href="#L2233">2233</a>
<a id="L2234" class="source_line" href="#L2234">2234</a>
<a id="L2235" class="source_line" href="#L2235">2235</a>
<a id="L2236" class="source_line" href="#L2236">2236</a>
<a id="L2237" class="source_line" href="#L2237">2237</a>
<a id="L2238" class="source_line" href="#L2238">2238</a>
<a id="L2239" class="source_line" href="#L2239">2239</a>
<a id="L2240" class="source_line" href="#L2240">2240</a>
<a id="L2241" class="source_line" href="#L2241">2241</a>
<a id="L2242" class="source_line" href="#L2242">2242</a>
<a id="L2243" class="source_line" href="#L2243">2243</a>
<a id="L2244" class="source_line" href="#L2244">2244</a>
<a id="L2245" class="source_line" href="#L2245">2245</a>
<a id="L2246" class="source_line" href="#L2246">2246</a>
<a id="L2247" class="source_line" href="#L2247">2247</a>
<a id="L2248" class="source_line" href="#L2248">2248</a>
<a id="L2249" class="source_line" href="#L2249">2249</a>
<a id="L2250" class="source_line" href="#L2250">2250</a>
<a id="L2251" class="source_line" href="#L2251">2251</a>
<a id="L2252" class="source_line" href="#L2252">2252</a>
<a id="L2253" class="source_line" href="#L2253">2253</a>
<a id="L2254" class="source_line" href="#L2254">2254</a>
<a id="L2255" class="source_line" href="#L2255">2255</a>
<a id="L2256" class="source_line" href="#L2256">2256</a>
<a id="L2257" class="source_line" href="#L2257">2257</a>
<a id="L2258" class="source_line" href="#L2258">2258</a>
<a id="L2259" class="source_line" href="#L2259">2259</a>
<a id="L2260" class="source_line" href="#L2260">2260</a>
<a id="L2261" class="source_line" href="#L2261">2261</a>
<a id="L2262" class="source_line" href="#L2262">2262</a>
<a id="L2263" class="source_line" href="#L2263">2263</a>
<a id="L2264" class="source_line" href="#L2264">2264</a>
<a id="L2265" class="source_line" href="#L2265">2265</a>
<a id="L2266" class="source_line" href="#L2266">2266</a>
<a id="L2267" class="source_line" href="#L2267">2267</a>
<a id="L2268" class="source_line" href="#L2268">2268</a>
<a id="L2269" class="source_line" href="#L2269">2269</a>
<a id="L2270" class="source_line" href="#L2270">2270</a>
<a id="L2271" class="source_line" href="#L2271">2271</a>
<a id="L2272" class="source_line" href="#L2272">2272</a>
<a id="L2273" class="source_line" href="#L2273">2273</a>
<a id="L2274" class="source_line" href="#L2274">2274</a>
<a id="L2275" class="source_line" href="#L2275">2275</a>
<a id="L2276" class="source_line" href="#L2276">2276</a>
<a id="L2277" class="source_line" href="#L2277">2277</a>
<a id="L2278" class="source_line" href="#L2278">2278</a>
<a id="L2279" class="source_line" href="#L2279">2279</a>
<a id="L2280" class="source_line" href="#L2280">2280</a>
<a id="L2281" class="source_line" href="#L2281">2281</a>
<a id="L2282" class="source_line" href="#L2282">2282</a>
<a id="L2283" class="source_line" href="#L2283">2283</a>
<a id="L2284" class="source_line" href="#L2284">2284</a>
<a id="L2285" class="source_line" href="#L2285">2285</a>
<a id="L2286" class="source_line" href="#L2286">2286</a>
<a id="L2287" class="source_line" href="#L2287">2287</a>
<a id="L2288" class="source_line" href="#L2288">2288</a>
<a id="L2289" class="source_line" href="#L2289">2289</a>
<a id="L2290" class="source_line" href="#L2290">2290</a>
<a id="L2291" class="source_line" href="#L2291">2291</a>
<a id="L2292" class="source_line" href="#L2292">2292</a>
<a id="L2293" class="source_line" href="#L2293">2293</a>
<a id="L2294" class="source_line" href="#L2294">2294</a>
<a id="L2295" class="source_line" href="#L2295">2295</a>
<a id="L2296" class="source_line" href="#L2296">2296</a>
<a id="L2297" class="source_line" href="#L2297">2297</a>
<a id="L2298" class="source_line" href="#L2298">2298</a>
<a id="L2299" class="source_line" href="#L2299">2299</a>
<a id="L2300" class="source_line" href="#L2300">2300</a>
<a id="L2301" class="source_line" href="#L2301">2301</a>
<a id="L2302" class="source_line" href="#L2302">2302</a>
<a id="L2303" class="source_line" href="#L2303">2303</a>
<a id="L2304" class="source_line" href="#L2304">2304</a>
<a id="L2305" class="source_line" href="#L2305">2305</a>
<a id="L2306" class="source_line" href="#L2306">2306</a>
<a id="L2307" class="source_line" href="#L2307">2307</a>
<a id="L2308" class="source_line" href="#L2308">2308</a>
<a id="L2309" class="source_line" href="#L2309">2309</a>
<a id="L2310" class="source_line" href="#L2310">2310</a>
<a id="L2311" class="source_line" href="#L2311">2311</a>
<a id="L2312" class="source_line" href="#L2312">2312</a>
<a id="L2313" class="source_line" href="#L2313">2313</a>
<a id="L2314" class="source_line" href="#L2314">2314</a>
<a id="L2315" class="source_line" href="#L2315">2315</a>
<a id="L2316" class="source_line" href="#L2316">2316</a>
<a id="L2317" class="source_line" href="#L2317">2317</a>
<a id="L2318" class="source_line" href="#L2318">2318</a>
<a id="L2319" class="source_line" href="#L2319">2319</a>
<a id="L2320" class="source_line" href="#L2320">2320</a>
<a id="L2321" class="source_line" href="#L2321">2321</a>
<a id="L2322" class="source_line" href="#L2322">2322</a>
<a id="L2323" class="source_line" href="#L2323">2323</a>
<a id="L2324" class="source_line" href="#L2324">2324</a>
<a id="L2325" class="source_line" href="#L2325">2325</a>
<a id="L2326" class="source_line" href="#L2326">2326</a>
<a id="L2327" class="source_line" href="#L2327">2327</a>
<a id="L2328" class="source_line" href="#L2328">2328</a>
<a id="L2329" class="source_line" href="#L2329">2329</a>
<a id="L2330" class="source_line" href="#L2330">2330</a>
<a id="L2331" class="source_line" href="#L2331">2331</a>
<a id="L2332" class="source_line" href="#L2332">2332</a>
<a id="L2333" class="source_line" href="#L2333">2333</a>
<a id="L2334" class="source_line" href="#L2334">2334</a>
<a id="L2335" class="source_line" href="#L2335">2335</a>
<a id="L2336" class="source_line" href="#L2336">2336</a>
<a id="L2337" class="source_line" href="#L2337">2337</a>
<a id="L2338" class="source_line" href="#L2338">2338</a>
<a id="L2339" class="source_line" href="#L2339">2339</a>
<a id="L2340" class="source_line" href="#L2340">2340</a>
<a id="L2341" class="source_line" href="#L2341">2341</a>
<a id="L2342" class="source_line" href="#L2342">2342</a>
<a id="L2343" class="source_line" href="#L2343">2343</a>
<a id="L2344" class="source_line" href="#L2344">2344</a>
<a id="L2345" class="source_line" href="#L2345">2345</a>
<a id="L2346" class="source_line" href="#L2346">2346</a>
<a id="L2347" class="source_line" href="#L2347">2347</a>
<a id="L2348" class="source_line" href="#L2348">2348</a>
<a id="L2349" class="source_line" href="#L2349">2349</a>
<a id="L2350" class="source_line" href="#L2350">2350</a>
<a id="L2351" class="source_line" href="#L2351">2351</a>
<a id="L2352" class="source_line" href="#L2352">2352</a>
<a id="L2353" class="source_line" href="#L2353">2353</a>
<a id="L2354" class="source_line" href="#L2354">2354</a>
<a id="L2355" class="source_line" href="#L2355">2355</a>
<a id="L2356" class="source_line" href="#L2356">2356</a>
<a id="L2357" class="source_line" href="#L2357">2357</a>
<a id="L2358" class="source_line" href="#L2358">2358</a>
<a id="L2359" class="source_line" href="#L2359">2359</a>
<a id="L2360" class="source_line" href="#L2360">2360</a>
<a id="L2361" class="source_line" href="#L2361">2361</a>
<a id="L2362" class="source_line" href="#L2362">2362</a>
<a id="L2363" class="source_line" href="#L2363">2363</a>
<a id="L2364" class="source_line" href="#L2364">2364</a>
<a id="L2365" class="source_line" href="#L2365">2365</a>
<a id="L2366" class="source_line" href="#L2366">2366</a>
<a id="L2367" class="source_line" href="#L2367">2367</a>
<a id="L2368" class="source_line" href="#L2368">2368</a>
<a id="L2369" class="source_line" href="#L2369">2369</a>
<a id="L2370" class="source_line" href="#L2370">2370</a>
<a id="L2371" class="source_line" href="#L2371">2371</a>
<a id="L2372" class="source_line" href="#L2372">2372</a>
<a id="L2373" class="source_line" href="#L2373">2373</a>
<a id="L2374" class="source_line" href="#L2374">2374</a>
<a id="L2375" class="source_line" href="#L2375">2375</a>
<a id="L2376" class="source_line" href="#L2376">2376</a>
<a id="L2377" class="source_line" href="#L2377">2377</a>
<a id="L2378" class="source_line" href="#L2378">2378</a>
<a id="L2379" class="source_line" href="#L2379">2379</a>
<a id="L2380" class="source_line" href="#L2380">2380</a>
<a id="L2381" class="source_line" href="#L2381">2381</a>
<a id="L2382" class="source_line" href="#L2382">2382</a>
<a id="L2383" class="source_line" href="#L2383">2383</a>
<a id="L2384" class="source_line" href="#L2384">2384</a>
<a id="L2385" class="source_line" href="#L2385">2385</a>
<a id="L2386" class="source_line" href="#L2386">2386</a>
<a id="L2387" class="source_line" href="#L2387">2387</a>
<a id="L2388" class="source_line" href="#L2388">2388</a>
<a id="L2389" class="source_line" href="#L2389">2389</a>
<a id="L2390" class="source_line" href="#L2390">2390</a>
<a id="L2391" class="source_line" href="#L2391">2391</a>
<a id="L2392" class="source_line" href="#L2392">2392</a>
<a id="L2393" class="source_line" href="#L2393">2393</a>
<a id="L2394" class="source_line" href="#L2394">2394</a>
<a id="L2395" class="source_line" href="#L2395">2395</a>
<a id="L2396" class="source_line" href="#L2396">2396</a>
<a id="L2397" class="source_line" href="#L2397">2397</a>
<a id="L2398" class="source_line" href="#L2398">2398</a>
<a id="L2399" class="source_line" href="#L2399">2399</a>
<a id="L2400" class="source_line" href="#L2400">2400</a>
<a id="L2401" class="source_line" href="#L2401">2401</a>
<a id="L2402" class="source_line" href="#L2402">2402</a>
<a id="L2403" class="source_line" href="#L2403">2403</a>
<a id="L2404" class="source_line" href="#L2404">2404</a>
<a id="L2405" class="source_line" href="#L2405">2405</a>
<a id="L2406" class="source_line" href="#L2406">2406</a>
<a id="L2407" class="source_line" href="#L2407">2407</a>
<a id="L2408" class="source_line" href="#L2408">2408</a>
<a id="L2409" class="source_line" href="#L2409">2409</a>
<a id="L2410" class="source_line" href="#L2410">2410</a>
<a id="L2411" class="source_line" href="#L2411">2411</a>
<a id="L2412" class="source_line" href="#L2412">2412</a>
<a id="L2413" class="source_line" href="#L2413">2413</a>
<a id="L2414" class="source_line" href="#L2414">2414</a>
<a id="L2415" class="source_line" href="#L2415">2415</a>
<a id="L2416" class="source_line" href="#L2416">2416</a>
<a id="L2417" class="source_line" href="#L2417">2417</a>
<a id="L2418" class="source_line" href="#L2418">2418</a>
<a id="L2419" class="source_line" href="#L2419">2419</a>
<a id="L2420" class="source_line" href="#L2420">2420</a>
<a id="L2421" class="source_line" href="#L2421">2421</a>
<a id="L2422" class="source_line" href="#L2422">2422</a>
<a id="L2423" class="source_line" href="#L2423">2423</a>
<a id="L2424" class="source_line" href="#L2424">2424</a>
<a id="L2425" class="source_line" href="#L2425">2425</a>
<a id="L2426" class="source_line" href="#L2426">2426</a>
<a id="L2427" class="source_line" href="#L2427">2427</a>
<a id="L2428" class="source_line" href="#L2428">2428</a>
<a id="L2429" class="source_line" href="#L2429">2429</a>
<a id="L2430" class="source_line" href="#L2430">2430</a>
<a id="L2431" class="source_line" href="#L2431">2431</a>
<a id="L2432" class="source_line" href="#L2432">2432</a>
<a id="L2433" class="source_line" href="#L2433">2433</a>
<a id="L2434" class="source_line" href="#L2434">2434</a>
<a id="L2435" class="source_line" href="#L2435">2435</a>
<a id="L2436" class="source_line" href="#L2436">2436</a>
<a id="L2437" class="source_line" href="#L2437">2437</a>
<a id="L2438" class="source_line" href="#L2438">2438</a>
<a id="L2439" class="source_line" href="#L2439">2439</a>
<a id="L2440" class="source_line" href="#L2440">2440</a>
<a id="L2441" class="source_line" href="#L2441">2441</a>
<a id="L2442" class="source_line" href="#L2442">2442</a>
<a id="L2443" class="source_line" href="#L2443">2443</a>
<a id="L2444" class="source_line" href="#L2444">2444</a>
<a id="L2445" class="source_line" href="#L2445">2445</a>
<a id="L2446" class="source_line" href="#L2446">2446</a>
<a id="L2447" class="source_line" href="#L2447">2447</a>
<a id="L2448" class="source_line" href="#L2448">2448</a>
<a id="L2449" class="source_line" href="#L2449">2449</a>
<a id="L2450" class="source_line" href="#L2450">2450</a>
<a id="L2451" class="source_line" href="#L2451">2451</a>
<a id="L2452" class="source_line" href="#L2452">2452</a>
<a id="L2453" class="source_line" href="#L2453">2453</a>
<a id="L2454" class="source_line" href="#L2454">2454</a>
<a id="L2455" class="source_line" href="#L2455">2455</a>
<a id="L2456" class="source_line" href="#L2456">2456</a>
<a id="L2457" class="source_line" href="#L2457">2457</a>
<a id="L2458" class="source_line" href="#L2458">2458</a>
<a id="L2459" class="source_line" href="#L2459">2459</a>
<a id="L2460" class="source_line" href="#L2460">2460</a>
<a id="L2461" class="source_line" href="#L2461">2461</a>
<a id="L2462" class="source_line" href="#L2462">2462</a>
<a id="L2463" class="source_line" href="#L2463">2463</a>
<a id="L2464" class="source_line" href="#L2464">2464</a>
<a id="L2465" class="source_line" href="#L2465">2465</a>
<a id="L2466" class="source_line" href="#L2466">2466</a>
<a id="L2467" class="source_line" href="#L2467">2467</a>
<a id="L2468" class="source_line" href="#L2468">2468</a>
<a id="L2469" class="source_line" href="#L2469">2469</a>
<a id="L2470" class="source_line" href="#L2470">2470</a>
<a id="L2471" class="source_line" href="#L2471">2471</a>
<a id="L2472" class="source_line" href="#L2472">2472</a>
<a id="L2473" class="source_line" href="#L2473">2473</a>
<a id="L2474" class="source_line" href="#L2474">2474</a>
<a id="L2475" class="source_line" href="#L2475">2475</a>
<a id="L2476" class="source_line" href="#L2476">2476</a>
<a id="L2477" class="source_line" href="#L2477">2477</a>
<a id="L2478" class="source_line" href="#L2478">2478</a>
<a id="L2479" class="source_line" href="#L2479">2479</a>
<a id="L2480" class="source_line" href="#L2480">2480</a>
<a id="L2481" class="source_line" href="#L2481">2481</a>
<a id="L2482" class="source_line" href="#L2482">2482</a>
<a id="L2483" class="source_line" href="#L2483">2483</a>
<a id="L2484" class="source_line" href="#L2484">2484</a>
<a id="L2485" class="source_line" href="#L2485">2485</a>
<a id="L2486" class="source_line" href="#L2486">2486</a>
<a id="L2487" class="source_line" href="#L2487">2487</a>
<a id="L2488" class="source_line" href="#L2488">2488</a>
<a id="L2489" class="source_line" href="#L2489">2489</a>
<a id="L2490" class="source_line" href="#L2490">2490</a>
<a id="L2491" class="source_line" href="#L2491">2491</a>
<a id="L2492" class="source_line" href="#L2492">2492</a>
<a id="L2493" class="source_line" href="#L2493">2493</a>
<a id="L2494" class="source_line" href="#L2494">2494</a>
<a id="L2495" class="source_line" href="#L2495">2495</a>
<a id="L2496" class="source_line" href="#L2496">2496</a>
<a id="L2497" class="source_line" href="#L2497">2497</a>
<a id="L2498" class="source_line" href="#L2498">2498</a>
<a id="L2499" class="source_line" href="#L2499">2499</a>
<a id="L2500" class="source_line" href="#L2500">2500</a>
<a id="L2501" class="source_line" href="#L2501">2501</a>
<a id="L2502" class="source_line" href="#L2502">2502</a>
<a id="L2503" class="source_line" href="#L2503">2503</a>
<a id="L2504" class="source_line" href="#L2504">2504</a>
<a id="L2505" class="source_line" href="#L2505">2505</a>
<a id="L2506" class="source_line" href="#L2506">2506</a>
<a id="L2507" class="source_line" href="#L2507">2507</a>
<a id="L2508" class="source_line" href="#L2508">2508</a>
<a id="L2509" class="source_line" href="#L2509">2509</a>
<a id="L2510" class="source_line" href="#L2510">2510</a>
<a id="L2511" class="source_line" href="#L2511">2511</a>
<a id="L2512" class="source_line" href="#L2512">2512</a>
<a id="L2513" class="source_line" href="#L2513">2513</a>
<a id="L2514" class="source_line" href="#L2514">2514</a>
<a id="L2515" class="source_line" href="#L2515">2515</a>
<a id="L2516" class="source_line" href="#L2516">2516</a>
<a id="L2517" class="source_line" href="#L2517">2517</a>
<a id="L2518" class="source_line" href="#L2518">2518</a>
<a id="L2519" class="source_line" href="#L2519">2519</a>
<a id="L2520" class="source_line" href="#L2520">2520</a>
<a id="L2521" class="source_line" href="#L2521">2521</a>
<a id="L2522" class="source_line" href="#L2522">2522</a>
<a id="L2523" class="source_line" href="#L2523">2523</a>
<a id="L2524" class="source_line" href="#L2524">2524</a>
<a id="L2525" class="source_line" href="#L2525">2525</a>
<a id="L2526" class="source_line" href="#L2526">2526</a>
<a id="L2527" class="source_line" href="#L2527">2527</a>
<a id="L2528" class="source_line" href="#L2528">2528</a>
<a id="L2529" class="source_line" href="#L2529">2529</a>
<a id="L2530" class="source_line" href="#L2530">2530</a>
<a id="L2531" class="source_line" href="#L2531">2531</a>
<a id="L2532" class="source_line" href="#L2532">2532</a>
<a id="L2533" class="source_line" href="#L2533">2533</a>
<a id="L2534" class="source_line" href="#L2534">2534</a>
<a id="L2535" class="source_line" href="#L2535">2535</a>
<a id="L2536" class="source_line" href="#L2536">2536</a>
<a id="L2537" class="source_line" href="#L2537">2537</a>
<a id="L2538" class="source_line" href="#L2538">2538</a>
<a id="L2539" class="source_line" href="#L2539">2539</a>
<a id="L2540" class="source_line" href="#L2540">2540</a>
<a id="L2541" class="source_line" href="#L2541">2541</a>
<a id="L2542" class="source_line" href="#L2542">2542</a>
<a id="L2543" class="source_line" href="#L2543">2543</a>
<a id="L2544" class="source_line" href="#L2544">2544</a>
<a id="L2545" class="source_line" href="#L2545">2545</a>
<a id="L2546" class="source_line" href="#L2546">2546</a>
<a id="L2547" class="source_line" href="#L2547">2547</a>
<a id="L2548" class="source_line" href="#L2548">2548</a>
<a id="L2549" class="source_line" href="#L2549">2549</a>
<a id="L2550" class="source_line" href="#L2550">2550</a>
<a id="L2551" class="source_line" href="#L2551">2551</a>
<a id="L2552" class="source_line" href="#L2552">2552</a>
<a id="L2553" class="source_line" href="#L2553">2553</a>
<a id="L2554" class="source_line" href="#L2554">2554</a>
<a id="L2555" class="source_line" href="#L2555">2555</a>
<a id="L2556" class="source_line" href="#L2556">2556</a>
<a id="L2557" class="source_line" href="#L2557">2557</a>
<a id="L2558" class="source_line" href="#L2558">2558</a>
<a id="L2559" class="source_line" href="#L2559">2559</a>
<a id="L2560" class="source_line" href="#L2560">2560</a>
<a id="L2561" class="source_line" href="#L2561">2561</a>
<a id="L2562" class="source_line" href="#L2562">2562</a>
<a id="L2563" class="source_line" href="#L2563">2563</a>
<a id="L2564" class="source_line" href="#L2564">2564</a>
<a id="L2565" class="source_line" href="#L2565">2565</a>
<a id="L2566" class="source_line" href="#L2566">2566</a>
<a id="L2567" class="source_line" href="#L2567">2567</a>
<a id="L2568" class="source_line" href="#L2568">2568</a>
<a id="L2569" class="source_line" href="#L2569">2569</a>
<a id="L2570" class="source_line" href="#L2570">2570</a>
<a id="L2571" class="source_line" href="#L2571">2571</a>
<a id="L2572" class="source_line" href="#L2572">2572</a>
<a id="L2573" class="source_line" href="#L2573">2573</a>
<a id="L2574" class="source_line" href="#L2574">2574</a>
<a id="L2575" class="source_line" href="#L2575">2575</a>
<a id="L2576" class="source_line" href="#L2576">2576</a>
<a id="L2577" class="source_line" href="#L2577">2577</a>
<a id="L2578" class="source_line" href="#L2578">2578</a>
<a id="L2579" class="source_line" href="#L2579">2579</a>
<a id="L2580" class="source_line" href="#L2580">2580</a>
<a id="L2581" class="source_line" href="#L2581">2581</a>
<a id="L2582" class="source_line" href="#L2582">2582</a>
<a id="L2583" class="source_line" href="#L2583">2583</a>
<a id="L2584" class="source_line" href="#L2584">2584</a>
<a id="L2585" class="source_line" href="#L2585">2585</a>
<a id="L2586" class="source_line" href="#L2586">2586</a>
<a id="L2587" class="source_line" href="#L2587">2587</a>
<a id="L2588" class="source_line" href="#L2588">2588</a>
<a id="L2589" class="source_line" href="#L2589">2589</a>
<a id="L2590" class="source_line" href="#L2590">2590</a>
<a id="L2591" class="source_line" href="#L2591">2591</a>
<a id="L2592" class="source_line" href="#L2592">2592</a>
<a id="L2593" class="source_line" href="#L2593">2593</a>
<a id="L2594" class="source_line" href="#L2594">2594</a>
<a id="L2595" class="source_line" href="#L2595">2595</a>
<a id="L2596" class="source_line" href="#L2596">2596</a>
<a id="L2597" class="source_line" href="#L2597">2597</a>
<a id="L2598" class="source_line" href="#L2598">2598</a>
<a id="L2599" class="source_line" href="#L2599">2599</a>
<a id="L2600" class="source_line" href="#L2600">2600</a>
<a id="L2601" class="source_line" href="#L2601">2601</a>
<a id="L2602" class="source_line" href="#L2602">2602</a>
<a id="L2603" class="source_line" href="#L2603">2603</a>
<a id="L2604" class="source_line" href="#L2604">2604</a>
<a id="L2605" class="source_line" href="#L2605">2605</a>
<a id="L2606" class="source_line" href="#L2606">2606</a>
<a id="L2607" class="source_line" href="#L2607">2607</a>
<a id="L2608" class="source_line" href="#L2608">2608</a>
<a id="L2609" class="source_line" href="#L2609">2609</a>
<a id="L2610" class="source_line" href="#L2610">2610</a>
<a id="L2611" class="source_line" href="#L2611">2611</a>
<a id="L2612" class="source_line" href="#L2612">2612</a>
<a id="L2613" class="source_line" href="#L2613">2613</a>
<a id="L2614" class="source_line" href="#L2614">2614</a>
<a id="L2615" class="source_line" href="#L2615">2615</a>
<a id="L2616" class="source_line" href="#L2616">2616</a>
<a id="L2617" class="source_line" href="#L2617">2617</a>
<a id="L2618" class="source_line" href="#L2618">2618</a>
<a id="L2619" class="source_line" href="#L2619">2619</a>
<a id="L2620" class="source_line" href="#L2620">2620</a>
<a id="L2621" class="source_line" href="#L2621">2621</a>
<a id="L2622" class="source_line" href="#L2622">2622</a>
<a id="L2623" class="source_line" href="#L2623">2623</a>
<a id="L2624" class="source_line" href="#L2624">2624</a>
<a id="L2625" class="source_line" href="#L2625">2625</a>
<a id="L2626" class="source_line" href="#L2626">2626</a>
<a id="L2627" class="source_line" href="#L2627">2627</a>
<a id="L2628" class="source_line" href="#L2628">2628</a>
<a id="L2629" class="source_line" href="#L2629">2629</a>
<a id="L2630" class="source_line" href="#L2630">2630</a>
<a id="L2631" class="source_line" href="#L2631">2631</a>
<a id="L2632" class="source_line" href="#L2632">2632</a>
<a id="L2633" class="source_line" href="#L2633">2633</a>
<a id="L2634" class="source_line" href="#L2634">2634</a>
<a id="L2635" class="source_line" href="#L2635">2635</a>
<a id="L2636" class="source_line" href="#L2636">2636</a>
<a id="L2637" class="source_line" href="#L2637">2637</a>
<a id="L2638" class="source_line" href="#L2638">2638</a>
<a id="L2639" class="source_line" href="#L2639">2639</a>
<a id="L2640" class="source_line" href="#L2640">2640</a>
<a id="L2641" class="source_line" href="#L2641">2641</a>
<a id="L2642" class="source_line" href="#L2642">2642</a>
<a id="L2643" class="source_line" href="#L2643">2643</a>
<a id="L2644" class="source_line" href="#L2644">2644</a>
<a id="L2645" class="source_line" href="#L2645">2645</a>
<a id="L2646" class="source_line" href="#L2646">2646</a>
<a id="L2647" class="source_line" href="#L2647">2647</a>
<a id="L2648" class="source_line" href="#L2648">2648</a>
<a id="L2649" class="source_line" href="#L2649">2649</a>
<a id="L2650" class="source_line" href="#L2650">2650</a>
<a id="L2651" class="source_line" href="#L2651">2651</a>
<a id="L2652" class="source_line" href="#L2652">2652</a>
<a id="L2653" class="source_line" href="#L2653">2653</a>
<a id="L2654" class="source_line" href="#L2654">2654</a>
<a id="L2655" class="source_line" href="#L2655">2655</a>
<a id="L2656" class="source_line" href="#L2656">2656</a>
<a id="L2657" class="source_line" href="#L2657">2657</a>
<a id="L2658" class="source_line" href="#L2658">2658</a>
<a id="L2659" class="source_line" href="#L2659">2659</a>
<a id="L2660" class="source_line" href="#L2660">2660</a>
<a id="L2661" class="source_line" href="#L2661">2661</a>
<a id="L2662" class="source_line" href="#L2662">2662</a>
<a id="L2663" class="source_line" href="#L2663">2663</a>
<a id="L2664" class="source_line" href="#L2664">2664</a>
<a id="L2665" class="source_line" href="#L2665">2665</a>
<a id="L2666" class="source_line" href="#L2666">2666</a>
<a id="L2667" class="source_line" href="#L2667">2667</a>
<a id="L2668" class="source_line" href="#L2668">2668</a>
<a id="L2669" class="source_line" href="#L2669">2669</a>
<a id="L2670" class="source_line" href="#L2670">2670</a>
<a id="L2671" class="source_line" href="#L2671">2671</a>
<a id="L2672" class="source_line" href="#L2672">2672</a>
<a id="L2673" class="source_line" href="#L2673">2673</a>
<a id="L2674" class="source_line" href="#L2674">2674</a>
<a id="L2675" class="source_line" href="#L2675">2675</a>
<a id="L2676" class="source_line" href="#L2676">2676</a>
<a id="L2677" class="source_line" href="#L2677">2677</a>
<a id="L2678" class="source_line" href="#L2678">2678</a>
<a id="L2679" class="source_line" href="#L2679">2679</a>
<a id="L2680" class="source_line" href="#L2680">2680</a>
<a id="L2681" class="source_line" href="#L2681">2681</a>
<a id="L2682" class="source_line" href="#L2682">2682</a>
<a id="L2683" class="source_line" href="#L2683">2683</a>
<a id="L2684" class="source_line" href="#L2684">2684</a>
<a id="L2685" class="source_line" href="#L2685">2685</a>
<a id="L2686" class="source_line" href="#L2686">2686</a>
<a id="L2687" class="source_line" href="#L2687">2687</a>
<a id="L2688" class="source_line" href="#L2688">2688</a>
<a id="L2689" class="source_line" href="#L2689">2689</a>
<a id="L2690" class="source_line" href="#L2690">2690</a>
<a id="L2691" class="source_line" href="#L2691">2691</a>
<a id="L2692" class="source_line" href="#L2692">2692</a>
<a id="L2693" class="source_line" href="#L2693">2693</a>
<a id="L2694" class="source_line" href="#L2694">2694</a>
<a id="L2695" class="source_line" href="#L2695">2695</a>
<a id="L2696" class="source_line" href="#L2696">2696</a>
<a id="L2697" class="source_line" href="#L2697">2697</a>
<a id="L2698" class="source_line" href="#L2698">2698</a>
<a id="L2699" class="source_line" href="#L2699">2699</a>
<a id="L2700" class="source_line" href="#L2700">2700</a>
<a id="L2701" class="source_line" href="#L2701">2701</a>
<a id="L2702" class="source_line" href="#L2702">2702</a>
<a id="L2703" class="source_line" href="#L2703">2703</a>
<a id="L2704" class="source_line" href="#L2704">2704</a>
<a id="L2705" class="source_line" href="#L2705">2705</a>
<a id="L2706" class="source_line" href="#L2706">2706</a>
<a id="L2707" class="source_line" href="#L2707">2707</a>
<a id="L2708" class="source_line" href="#L2708">2708</a>
<a id="L2709" class="source_line" href="#L2709">2709</a>
<a id="L2710" class="source_line" href="#L2710">2710</a>
<a id="L2711" class="source_line" href="#L2711">2711</a>
<a id="L2712" class="source_line" href="#L2712">2712</a>
<a id="L2713" class="source_line" href="#L2713">2713</a>
<a id="L2714" class="source_line" href="#L2714">2714</a>
<a id="L2715" class="source_line" href="#L2715">2715</a>
<a id="L2716" class="source_line" href="#L2716">2716</a>
<a id="L2717" class="source_line" href="#L2717">2717</a>
<a id="L2718" class="source_line" href="#L2718">2718</a>
<a id="L2719" class="source_line" href="#L2719">2719</a>
<a id="L2720" class="source_line" href="#L2720">2720</a>
<a id="L2721" class="source_line" href="#L2721">2721</a>
<a id="L2722" class="source_line" href="#L2722">2722</a>
<a id="L2723" class="source_line" href="#L2723">2723</a>
<a id="L2724" class="source_line" href="#L2724">2724</a>
<a id="L2725" class="source_line" href="#L2725">2725</a>
<a id="L2726" class="source_line" href="#L2726">2726</a>
<a id="L2727" class="source_line" href="#L2727">2727</a>
<a id="L2728" class="source_line" href="#L2728">2728</a>
<a id="L2729" class="source_line" href="#L2729">2729</a>
<a id="L2730" class="source_line" href="#L2730">2730</a>
<a id="L2731" class="source_line" href="#L2731">2731</a>
<a id="L2732" class="source_line" href="#L2732">2732</a>
<a id="L2733" class="source_line" href="#L2733">2733</a>
<a id="L2734" class="source_line" href="#L2734">2734</a>
<a id="L2735" class="source_line" href="#L2735">2735</a>
<a id="L2736" class="source_line" href="#L2736">2736</a>
<a id="L2737" class="source_line" href="#L2737">2737</a>
<a id="L2738" class="source_line" href="#L2738">2738</a>
<a id="L2739" class="source_line" href="#L2739">2739</a>
<a id="L2740" class="source_line" href="#L2740">2740</a>
<a id="L2741" class="source_line" href="#L2741">2741</a>
<a id="L2742" class="source_line" href="#L2742">2742</a>
<a id="L2743" class="source_line" href="#L2743">2743</a>
<a id="L2744" class="source_line" href="#L2744">2744</a>
<a id="L2745" class="source_line" href="#L2745">2745</a>
<a id="L2746" class="source_line" href="#L2746">2746</a>
<a id="L2747" class="source_line" href="#L2747">2747</a>
<a id="L2748" class="source_line" href="#L2748">2748</a>
<a id="L2749" class="source_line" href="#L2749">2749</a>
<a id="L2750" class="source_line" href="#L2750">2750</a>
<a id="L2751" class="source_line" href="#L2751">2751</a>
<a id="L2752" class="source_line" href="#L2752">2752</a>
<a id="L2753" class="source_line" href="#L2753">2753</a>
<a id="L2754" class="source_line" href="#L2754">2754</a>
<a id="L2755" class="source_line" href="#L2755">2755</a>
<a id="L2756" class="source_line" href="#L2756">2756</a>
<a id="L2757" class="source_line" href="#L2757">2757</a>
<a id="L2758" class="source_line" href="#L2758">2758</a>
<a id="L2759" class="source_line" href="#L2759">2759</a>
<a id="L2760" class="source_line" href="#L2760">2760</a>
<a id="L2761" class="source_line" href="#L2761">2761</a>
<a id="L2762" class="source_line" href="#L2762">2762</a>
<a id="L2763" class="source_line" href="#L2763">2763</a>
<a id="L2764" class="source_line" href="#L2764">2764</a>
<a id="L2765" class="source_line" href="#L2765">2765</a>
<a id="L2766" class="source_line" href="#L2766">2766</a>
<a id="L2767" class="source_line" href="#L2767">2767</a>
<a id="L2768" class="source_line" href="#L2768">2768</a>
<a id="L2769" class="source_line" href="#L2769">2769</a>
<a id="L2770" class="source_line" href="#L2770">2770</a>
<a id="L2771" class="source_line" href="#L2771">2771</a>
<a id="L2772" class="source_line" href="#L2772">2772</a>
<a id="L2773" class="source_line" href="#L2773">2773</a>
<a id="L2774" class="source_line" href="#L2774">2774</a>
<a id="L2775" class="source_line" href="#L2775">2775</a>
<a id="L2776" class="source_line" href="#L2776">2776</a>
<a id="L2777" class="source_line" href="#L2777">2777</a>
<a id="L2778" class="source_line" href="#L2778">2778</a>
<a id="L2779" class="source_line" href="#L2779">2779</a>
<a id="L2780" class="source_line" href="#L2780">2780</a>
<a id="L2781" class="source_line" href="#L2781">2781</a>
<a id="L2782" class="source_line" href="#L2782">2782</a>
<a id="L2783" class="source_line" href="#L2783">2783</a>
<a id="L2784" class="source_line" href="#L2784">2784</a>
<a id="L2785" class="source_line" href="#L2785">2785</a>
<a id="L2786" class="source_line" href="#L2786">2786</a>
<a id="L2787" class="source_line" href="#L2787">2787</a>
<a id="L2788" class="source_line" href="#L2788">2788</a>
<a id="L2789" class="source_line" href="#L2789">2789</a>
<a id="L2790" class="source_line" href="#L2790">2790</a>
<a id="L2791" class="source_line" href="#L2791">2791</a>
<a id="L2792" class="source_line" href="#L2792">2792</a>
<a id="L2793" class="source_line" href="#L2793">2793</a>
<a id="L2794" class="source_line" href="#L2794">2794</a>
<a id="L2795" class="source_line" href="#L2795">2795</a>
<a id="L2796" class="source_line" href="#L2796">2796</a>
<a id="L2797" class="source_line" href="#L2797">2797</a>
<a id="L2798" class="source_line" href="#L2798">2798</a>
<a id="L2799" class="source_line" href="#L2799">2799</a>
<a id="L2800" class="source_line" href="#L2800">2800</a>
<a id="L2801" class="source_line" href="#L2801">2801</a>
<a id="L2802" class="source_line" href="#L2802">2802</a>
<a id="L2803" class="source_line" href="#L2803">2803</a>
<a id="L2804" class="source_line" href="#L2804">2804</a>
<a id="L2805" class="source_line" href="#L2805">2805</a>
<a id="L2806" class="source_line" href="#L2806">2806</a>
<a id="L2807" class="source_line" href="#L2807">2807</a>
<a id="L2808" class="source_line" href="#L2808">2808</a>
<a id="L2809" class="source_line" href="#L2809">2809</a>
<a id="L2810" class="source_line" href="#L2810">2810</a>
<a id="L2811" class="source_line" href="#L2811">2811</a>
<a id="L2812" class="source_line" href="#L2812">2812</a>
<a id="L2813" class="source_line" href="#L2813">2813</a>
<a id="L2814" class="source_line" href="#L2814">2814</a>
<a id="L2815" class="source_line" href="#L2815">2815</a>
<a id="L2816" class="source_line" href="#L2816">2816</a>
<a id="L2817" class="source_line" href="#L2817">2817</a>
<a id="L2818" class="source_line" href="#L2818">2818</a>
<a id="L2819" class="source_line" href="#L2819">2819</a>
<a id="L2820" class="source_line" href="#L2820">2820</a>
<a id="L2821" class="source_line" href="#L2821">2821</a>
<a id="L2822" class="source_line" href="#L2822">2822</a>
<a id="L2823" class="source_line" href="#L2823">2823</a>
<a id="L2824" class="source_line" href="#L2824">2824</a>
<a id="L2825" class="source_line" href="#L2825">2825</a>
<a id="L2826" class="source_line" href="#L2826">2826</a>
<a id="L2827" class="source_line" href="#L2827">2827</a>
<a id="L2828" class="source_line" href="#L2828">2828</a>
<a id="L2829" class="source_line" href="#L2829">2829</a>
<a id="L2830" class="source_line" href="#L2830">2830</a>
<a id="L2831" class="source_line" href="#L2831">2831</a>
<a id="L2832" class="source_line" href="#L2832">2832</a>
<a id="L2833" class="source_line" href="#L2833">2833</a>
<a id="L2834" class="source_line" href="#L2834">2834</a>
<a id="L2835" class="source_line" href="#L2835">2835</a>
<a id="L2836" class="source_line" href="#L2836">2836</a>
<a id="L2837" class="source_line" href="#L2837">2837</a>
<a id="L2838" class="source_line" href="#L2838">2838</a>
<a id="L2839" class="source_line" href="#L2839">2839</a>
<a id="L2840" class="source_line" href="#L2840">2840</a>
<a id="L2841" class="source_line" href="#L2841">2841</a>
<a id="L2842" class="source_line" href="#L2842">2842</a>
<a id="L2843" class="source_line" href="#L2843">2843</a>
<a id="L2844" class="source_line" href="#L2844">2844</a>
<a id="L2845" class="source_line" href="#L2845">2845</a>
<a id="L2846" class="source_line" href="#L2846">2846</a>
<a id="L2847" class="source_line" href="#L2847">2847</a>
<a id="L2848" class="source_line" href="#L2848">2848</a>
<a id="L2849" class="source_line" href="#L2849">2849</a>
<a id="L2850" class="source_line" href="#L2850">2850</a>
<a id="L2851" class="source_line" href="#L2851">2851</a>
<a id="L2852" class="source_line" href="#L2852">2852</a>
<a id="L2853" class="source_line" href="#L2853">2853</a>
<a id="L2854" class="source_line" href="#L2854">2854</a>
<a id="L2855" class="source_line" href="#L2855">2855</a>
<a id="L2856" class="source_line" href="#L2856">2856</a>
<a id="L2857" class="source_line" href="#L2857">2857</a>
<a id="L2858" class="source_line" href="#L2858">2858</a>
<a id="L2859" class="source_line" href="#L2859">2859</a>
<a id="L2860" class="source_line" href="#L2860">2860</a>
<a id="L2861" class="source_line" href="#L2861">2861</a>
<a id="L2862" class="source_line" href="#L2862">2862</a>
<a id="L2863" class="source_line" href="#L2863">2863</a>
<a id="L2864" class="source_line" href="#L2864">2864</a>
<a id="L2865" class="source_line" href="#L2865">2865</a>
<a id="L2866" class="source_line" href="#L2866">2866</a>
<a id="L2867" class="source_line" href="#L2867">2867</a>
<a id="L2868" class="source_line" href="#L2868">2868</a>
<a id="L2869" class="source_line" href="#L2869">2869</a>
<a id="L2870" class="source_line" href="#L2870">2870</a>
<a id="L2871" class="source_line" href="#L2871">2871</a>
<a id="L2872" class="source_line" href="#L2872">2872</a>
<a id="L2873" class="source_line" href="#L2873">2873</a>
<a id="L2874" class="source_line" href="#L2874">2874</a>
<a id="L2875" class="source_line" href="#L2875">2875</a>
<a id="L2876" class="source_line" href="#L2876">2876</a>
<a id="L2877" class="source_line" href="#L2877">2877</a>
<a id="L2878" class="source_line" href="#L2878">2878</a>
<a id="L2879" class="source_line" href="#L2879">2879</a>
<a id="L2880" class="source_line" href="#L2880">2880</a>
<a id="L2881" class="source_line" href="#L2881">2881</a>
<a id="L2882" class="source_line" href="#L2882">2882</a>
<a id="L2883" class="source_line" href="#L2883">2883</a>
<a id="L2884" class="source_line" href="#L2884">2884</a>
<a id="L2885" class="source_line" href="#L2885">2885</a>
<a id="L2886" class="source_line" href="#L2886">2886</a>
<a id="L2887" class="source_line" href="#L2887">2887</a>
<a id="L2888" class="source_line" href="#L2888">2888</a>
<a id="L2889" class="source_line" href="#L2889">2889</a>
<a id="L2890" class="source_line" href="#L2890">2890</a>
<a id="L2891" class="source_line" href="#L2891">2891</a>
<a id="L2892" class="source_line" href="#L2892">2892</a>
<a id="L2893" class="source_line" href="#L2893">2893</a>
<a id="L2894" class="source_line" href="#L2894">2894</a>
<a id="L2895" class="source_line" href="#L2895">2895</a>
<a id="L2896" class="source_line" href="#L2896">2896</a>
<a id="L2897" class="source_line" href="#L2897">2897</a>
<a id="L2898" class="source_line" href="#L2898">2898</a>
<a id="L2899" class="source_line" href="#L2899">2899</a>
<a id="L2900" class="source_line" href="#L2900">2900</a>
<a id="L2901" class="source_line" href="#L2901">2901</a>
<a id="L2902" class="source_line" href="#L2902">2902</a>
<a id="L2903" class="source_line" href="#L2903">2903</a>
<a id="L2904" class="source_line" href="#L2904">2904</a>
<a id="L2905" class="source_line" href="#L2905">2905</a>
<a id="L2906" class="source_line" href="#L2906">2906</a>
<a id="L2907" class="source_line" href="#L2907">2907</a>
<a id="L2908" class="source_line" href="#L2908">2908</a>
<a id="L2909" class="source_line" href="#L2909">2909</a>
<a id="L2910" class="source_line" href="#L2910">2910</a>
<a id="L2911" class="source_line" href="#L2911">2911</a>
<a id="L2912" class="source_line" href="#L2912">2912</a>
<a id="L2913" class="source_line" href="#L2913">2913</a>
<a id="L2914" class="source_line" href="#L2914">2914</a>
<a id="L2915" class="source_line" href="#L2915">2915</a>
<a id="L2916" class="source_line" href="#L2916">2916</a>
<a id="L2917" class="source_line" href="#L2917">2917</a>
<a id="L2918" class="source_line" href="#L2918">2918</a>
<a id="L2919" class="source_line" href="#L2919">2919</a>
<a id="L2920" class="source_line" href="#L2920">2920</a>
<a id="L2921" class="source_line" href="#L2921">2921</a>
<a id="L2922" class="source_line" href="#L2922">2922</a>
<a id="L2923" class="source_line" href="#L2923">2923</a>
<a id="L2924" class="source_line" href="#L2924">2924</a>
<a id="L2925" class="source_line" href="#L2925">2925</a>
<a id="L2926" class="source_line" href="#L2926">2926</a>
<a id="L2927" class="source_line" href="#L2927">2927</a>
<a id="L2928" class="source_line" href="#L2928">2928</a>
<a id="L2929" class="source_line" href="#L2929">2929</a>
<a id="L2930" class="source_line" href="#L2930">2930</a>
<a id="L2931" class="source_line" href="#L2931">2931</a>
<a id="L2932" class="source_line" href="#L2932">2932</a>
<a id="L2933" class="source_line" href="#L2933">2933</a>
<a id="L2934" class="source_line" href="#L2934">2934</a>
<a id="L2935" class="source_line" href="#L2935">2935</a>
<a id="L2936" class="source_line" href="#L2936">2936</a>
<a id="L2937" class="source_line" href="#L2937">2937</a>
<a id="L2938" class="source_line" href="#L2938">2938</a>
<a id="L2939" class="source_line" href="#L2939">2939</a>
<a id="L2940" class="source_line" href="#L2940">2940</a>
<a id="L2941" class="source_line" href="#L2941">2941</a>
<a id="L2942" class="source_line" href="#L2942">2942</a>
<a id="L2943" class="source_line" href="#L2943">2943</a>
<a id="L2944" class="source_line" href="#L2944">2944</a>
<a id="L2945" class="source_line" href="#L2945">2945</a>
<a id="L2946" class="source_line" href="#L2946">2946</a>
<a id="L2947" class="source_line" href="#L2947">2947</a>
<a id="L2948" class="source_line" href="#L2948">2948</a>
<a id="L2949" class="source_line" href="#L2949">2949</a>
<a id="L2950" class="source_line" href="#L2950">2950</a>
<a id="L2951" class="source_line" href="#L2951">2951</a>
<a id="L2952" class="source_line" href="#L2952">2952</a>
<a id="L2953" class="source_line" href="#L2953">2953</a>
<a id="L2954" class="source_line" href="#L2954">2954</a>
<a id="L2955" class="source_line" href="#L2955">2955</a>
<a id="L2956" class="source_line" href="#L2956">2956</a>
<a id="L2957" class="source_line" href="#L2957">2957</a>
<a id="L2958" class="source_line" href="#L2958">2958</a>
<a id="L2959" class="source_line" href="#L2959">2959</a>
<a id="L2960" class="source_line" href="#L2960">2960</a>
<a id="L2961" class="source_line" href="#L2961">2961</a>
<a id="L2962" class="source_line" href="#L2962">2962</a>
<a id="L2963" class="source_line" href="#L2963">2963</a>
<a id="L2964" class="source_line" href="#L2964">2964</a>
<a id="L2965" class="source_line" href="#L2965">2965</a>
<a id="L2966" class="source_line" href="#L2966">2966</a>
<a id="L2967" class="source_line" href="#L2967">2967</a>
<a id="L2968" class="source_line" href="#L2968">2968</a>
<a id="L2969" class="source_line" href="#L2969">2969</a>
<a id="L2970" class="source_line" href="#L2970">2970</a>
<a id="L2971" class="source_line" href="#L2971">2971</a>
<a id="L2972" class="source_line" href="#L2972">2972</a>
<a id="L2973" class="source_line" href="#L2973">2973</a>
<a id="L2974" class="source_line" href="#L2974">2974</a>
<a id="L2975" class="source_line" href="#L2975">2975</a>
<a id="L2976" class="source_line" href="#L2976">2976</a>
<a id="L2977" class="source_line" href="#L2977">2977</a>
<a id="L2978" class="source_line" href="#L2978">2978</a>
<a id="L2979" class="source_line" href="#L2979">2979</a>
<a id="L2980" class="source_line" href="#L2980">2980</a>
<a id="L2981" class="source_line" href="#L2981">2981</a>
<a id="L2982" class="source_line" href="#L2982">2982</a>
<a id="L2983" class="source_line" href="#L2983">2983</a>
<a id="L2984" class="source_line" href="#L2984">2984</a>
<a id="L2985" class="source_line" href="#L2985">2985</a>
<a id="L2986" class="source_line" href="#L2986">2986</a>
<a id="L2987" class="source_line" href="#L2987">2987</a>
<a id="L2988" class="source_line" href="#L2988">2988</a>
<a id="L2989" class="source_line" href="#L2989">2989</a>
<a id="L2990" class="source_line" href="#L2990">2990</a>
<a id="L2991" class="source_line" href="#L2991">2991</a>
</code><code class="source_code"><span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*                                 OCaml                                  *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*                          Benoit Vaugon, ENSTA                          *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   Copyright 2014 Institut National de Recherche en Informatique et     *)</span><span class="EOL">
</span><span class="COMMENT">(*     en Automatique.                                                    *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(*   All rights reserved.  This file is distributed under the terms of    *)</span><span class="EOL">
</span><span class="COMMENT">(*   the GNU Lesser General Public License version 2.1, with the          *)</span><span class="EOL">
</span><span class="COMMENT">(*   special exception on linking described in the file LICENSE.          *)</span><span class="EOL">
</span><span class="COMMENT">(*                                                                        *)</span><span class="EOL">
</span><span class="COMMENT">(**************************************************************************)</span><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <a href="camlinternalFormatBasics.ml.html"><span class="UIDENT">CamlinternalFormatBasics</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>           <span class="COMMENT">(* Tools to manipulate scanning set of chars (see %[...]) *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-mutable_char_set"><span class="TYPE">type</span> <span class="LIDENT">mutable_char_set</span> <span class="EQUAL">=</span> <span class="LIDENT">bytes</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Create a fresh, empty, mutable char set. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-create_char_set"><span class="LIDENT">create_char_set</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">32</span> <span class="CHAR">'\000'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add a char in a mutable char set. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_in_char_set"><span class="LIDENT">add_in_char_set</span></span> <span id="local_char_set_1"><span class="LIDENT">char_set</span></span> <span id="local_c_2"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ind_3"><span class="LIDENT">ind</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_2"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_ind_4"><span class="LIDENT">str_ind</span></span> <span class="EQUAL">=</span> <a href="#local_ind_3"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">3</span> <span class="AND">and</span> <span id="local_mask_5"><span class="LIDENT">mask</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="#local_ind_3"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0b111</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_char_set_1"><span class="LIDENT">char_set</span></a> <a href="#local_str_ind_4"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="LPAREN">(</span><a href="bytes.ml.html#val-get"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_char_set_1"><span class="LIDENT">char_set</span></a> <a href="#local_str_ind_4"><span class="LIDENT">str_ind</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lor)"><span class="INFIXOP3">lor</span></a> <a href="#local_mask_5"><span class="LIDENT">mask</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-freeze_char_set"><span class="LIDENT">freeze_char_set</span></span> <span id="local_char_set_6"><span class="LIDENT">char_set</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_char_set_6"><span class="LIDENT">char_set</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Compute the complement of a char set. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rev_char_set"><span class="LIDENT">rev_char_set</span></span> <span id="local_char_set_7"><span class="LIDENT">char_set</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_char_set'_8"><span class="LIDENT">char_set'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create_char_set</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <span class="INT">31</span> <span class="DO">do</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_char_set'_8"><span class="LIDENT">char_set'</span></a> <span class="LIDENT">i</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-get"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_char_set_7"><span class="LIDENT">char_set</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(lxor)"><span class="INFIXOP3">lxor</span></a> <span class="INT">0xFF</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_char_set'_8"><span class="LIDENT">char_set'</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Return true if a `c' is in `char_set'. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-is_in_char_set"><span class="LIDENT">is_in_char_set</span></span> <span id="local_char_set_9"><span class="LIDENT">char_set</span></span> <span id="local_c_10"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_ind_11"><span class="LIDENT">ind</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_10"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_ind_12"><span class="LIDENT">str_ind</span></span> <span class="EQUAL">=</span> <a href="#local_ind_11"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(lsr)"><span class="INFIXOP4">lsr</span></a> <span class="INT">3</span> <span class="AND">and</span> <span id="local_mask_13"><span class="LIDENT">mask</span></span> <span class="EQUAL">=</span> <span class="INT">1</span> <a href="stdlib.ml.html#val-(lsl)"><span class="INFIXOP4">lsl</span></a> <span class="LPAREN">(</span><a href="#local_ind_11"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <span class="INT">0b111</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-get"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">get</span></a> <a href="#local_char_set_9"><span class="LIDENT">char_set</span></a> <a href="#local_str_ind_12"><span class="LIDENT">str_ind</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(land)"><span class="INFIXOP3">land</span></a> <a href="#local_mask_13"><span class="LIDENT">mask</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="INT">0</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                         <span class="COMMENT">(* Ignored param conversion *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT used to abstract an existential type parameter. *)</span><span class="EOL">
</span><span class="COMMENT">(* See param_format_of_ignored_format. *)</span><span class="EOL">
</span><span id="type-param_format_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">param_format_ebb</span> <span class="EQUAL">=</span> <span id="type-param_format_ebb.constructor-Param_format_EBB"><span class="UIDENT">Param_format_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">param_format_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Compute a padding associated to a pad_option (see &quot;%_42d&quot;). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-pad_of_pad_opt"><span class="LIDENT">pad_of_pad_opt</span></span> <span id="local_pad_opt_14"><span class="LIDENT">pad_opt</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_pad_opt_14"><span class="LIDENT">pad_opt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">No_padding</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_width_15"><span class="LIDENT">width</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Right</span><span class="COMMA">,</span> <a href="#local_width_15"><span class="LIDENT">width</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Compute a precision associated to a prec_option (see &quot;%_.42f&quot;). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-prec_of_prec_opt"><span class="LIDENT">prec_of_prec_opt</span></span> <span id="local_prec_opt_16"><span class="LIDENT">prec_opt</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_prec_opt_16"><span class="LIDENT">prec_opt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">No_precision</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_ndec_17"><span class="LIDENT">ndec</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Lit_precision</span> <a href="#local_ndec_17"><span class="LIDENT">ndec</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Turn an ignored param into its equivalent not-ignored format node. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used for format pretty-printing and Scanf. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-param_format_of_ignored_format"><span class="LIDENT">param_format_of_ignored_format</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-ignored"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LIDENT">ignored</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">param_format_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_ign_18"><span class="LIDENT">ign</span></span> <span id="local_fmt_19"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_ign_18"><span class="LIDENT">ign</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_char</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_char</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Caml_char</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_string</span> <span id="local_pad_opt_20"><span class="LIDENT">pad_opt</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">String</span> <span class="LPAREN">(</span><span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_20"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_string</span> <span id="local_pad_opt_21"><span class="LIDENT">pad_opt</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_21"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int</span> <span class="LPAREN">(</span><span id="local_iconv_22"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_opt_23"><span class="LIDENT">pad_opt</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int</span> <span class="LPAREN">(</span><a href="#local_iconv_22"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_23"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <span class="UIDENT">No_precision</span><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int32</span> <span class="LPAREN">(</span><span id="local_iconv_24"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_opt_25"><span class="LIDENT">pad_opt</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Int32</span> <span class="LPAREN">(</span><a href="#local_iconv_24"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_25"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <span class="UIDENT">No_precision</span><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_nativeint</span> <span class="LPAREN">(</span><span id="local_iconv_26"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_opt_27"><span class="LIDENT">pad_opt</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><a href="#local_iconv_26"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_27"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <span class="UIDENT">No_precision</span><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int64</span> <span class="LPAREN">(</span><span id="local_iconv_28"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_opt_29"><span class="LIDENT">pad_opt</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Int64</span> <span class="LPAREN">(</span><a href="#local_iconv_28"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_29"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <span class="UIDENT">No_precision</span><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_float</span> <span class="LPAREN">(</span><span id="local_pad_opt_30"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_prec_opt_31"><span class="LIDENT">prec_opt</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UIDENT">Float_flag_</span><span class="COMMA">,</span> <span class="UIDENT">Float_f</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>              <span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_30"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <span class="LIDENT">prec_of_prec_opt</span> <a href="#local_prec_opt_31"><span class="LIDENT">prec_opt</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_bool</span> <span id="local_pad_opt_32"><span class="LIDENT">pad_opt</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span class="LIDENT">pad_of_pad_opt</span> <a href="#local_pad_opt_32"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_arg</span> <span class="LPAREN">(</span><span id="local_pad_opt_33"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_fmtty_34"><span class="LIDENT">fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><a href="#local_pad_opt_33"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_fmtty_34"><span class="LIDENT">fmtty</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><span id="local_pad_opt_35"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_fmtty_36"><span class="LIDENT">fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><a href="#local_pad_opt_35"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_fmtty_36"><span class="LIDENT">fmtty</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Reader</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_char_set</span> <span class="LPAREN">(</span><span id="local_width_opt_37"><span class="LIDENT">width_opt</span></span><span class="COMMA">,</span> <span id="local_char_set_38"><span class="LIDENT">char_set</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><a href="#local_width_opt_37"><span class="LIDENT">width_opt</span></a><span class="COMMA">,</span> <a href="#local_char_set_38"><span class="LIDENT">char_set</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_get_counter</span> <span id="local_counter_39"><span class="LIDENT">counter</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><a href="#local_counter_39"><span class="LIDENT">counter</span></a><span class="COMMA">,</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_next_char</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Param_format_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_next_char</span> <a href="#local_fmt_19"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                                 <span class="COMMENT">(* Types *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-acc_formatting_gen"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc_formatting_gen</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-acc_formatting_gen.constructor-Acc_open_tag"><span class="BAR">|</span> <span class="UIDENT">Acc_open_tag</span> <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span></span><span class="EOL">
</span>  <span id="type-acc_formatting_gen.constructor-Acc_open_box"><span class="BAR">|</span> <span class="UIDENT">Acc_open_box</span> <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Reversed list of printing atoms. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to accumulate printf arguments. *)</span><span class="EOL">
</span><span id="type-acc"><span class="AND">and</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_formatting_lit"><span class="BAR">|</span> <span class="UIDENT">Acc_formatting_lit</span> <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <a href="camlinternalFormatBasics.ml.html#type-formatting_lit"><span class="LIDENT">formatting_lit</span></a></span><span class="EOL">
</span>      <span class="COMMENT">(* Special fmtting (box) *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_formatting_gen"><span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc_formatting_gen</span></span><span class="EOL">
</span>      <span class="COMMENT">(* Special fmtting (box) *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_string_literal"><span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LIDENT">string</span></span>     <span class="COMMENT">(* Literal string *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_char_literal"><span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span>   <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LIDENT">char</span></span>       <span class="COMMENT">(* Literal char *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_data_string"><span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span>    <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LIDENT">string</span></span>     <span class="COMMENT">(* Generated string *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_data_char"><span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span>      <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LIDENT">char</span></span>       <span class="COMMENT">(* Generated char *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_delay"><span class="BAR">|</span> <span class="UIDENT">Acc_delay</span>          <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span></span><span class="EOL">
</span>                                                <span class="COMMENT">(* Delayed printing (%a, %t) *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_flush"><span class="BAR">|</span> <span class="UIDENT">Acc_flush</span>          <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span></span>              <span class="COMMENT">(* Flush *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-Acc_invalid_arg"><span class="BAR">|</span> <span class="UIDENT">Acc_invalid_arg</span>    <span class="OF">of</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="STAR">*</span> <span class="LIDENT">string</span></span><span class="EOL">
</span>      <span class="COMMENT">(* Raise Invalid_argument msg *)</span><span class="EOL">
</span>  <span id="type-acc.constructor-End_of_acc"><span class="BAR">|</span> <span class="UIDENT">End_of_acc</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* List of heterogeneous values. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to accumulate scanf callback arguments. *)</span><span class="EOL">
</span><span id="type-heter_list"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span id="type-heter_list.constructor-Cons"><span class="BAR">|</span> <span class="UIDENT">Cons</span> <span class="COLON">:</span> <span class="QUOTE">'</span><span class="LIDENT">c</span> <span class="STAR">*</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">c</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></span><span class="EOL">
</span>  <span id="type-heter_list.constructor-Nil"><span class="BAR">|</span> <span class="UIDENT">Nil</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">heter_list</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Existential Black Boxes. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to abstract some existential type parameters. *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating a padding and an fmtty. *)</span><span class="EOL">
</span><span class="COMMENT">(* See the type_padding function. *)</span><span class="EOL">
</span><span id="type-padding_fmtty_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padding_fmtty_ebb</span> <span class="EQUAL">=</span> <span id="type-padding_fmtty_ebb.constructor-Padding_fmtty_EBB"><span class="UIDENT">Padding_fmtty_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="STAR">*</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padding_fmtty_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating a padding, a precision and an fmtty. *)</span><span class="EOL">
</span><span class="COMMENT">(* See the type_padprec function. *)</span><span class="EOL">
</span><span id="type-padprec_fmtty_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padprec_fmtty_ebb</span> <span class="EQUAL">=</span> <span id="type-padprec_fmtty_ebb.constructor-Padprec_fmtty_EBB"><span class="UIDENT">Padprec_fmtty_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="STAR">*</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">z</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="STAR">*</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">z</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padprec_fmtty_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating a padding and an fmt. *)</span><span class="EOL">
</span><span class="COMMENT">(* See make_padding_fmt_ebb and parse_format functions. *)</span><span class="EOL">
</span><span id="type-padding_fmt_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padding_fmt_ebb</span> <span class="EQUAL">=</span> <span id="type-padding_fmt_ebb.constructor-Padding_fmt_EBB"><span class="UIDENT">Padding_fmt_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">x</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="STAR">*</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padding_fmt_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating a precision and an fmt. *)</span><span class="EOL">
</span><span class="COMMENT">(* See make_precision_fmt_ebb and parse_format functions. *)</span><span class="EOL">
</span><span id="type-precision_fmt_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">precision_fmt_ebb</span> <span class="EQUAL">=</span> <span id="type-precision_fmt_ebb.constructor-Precision_fmt_EBB"><span class="UIDENT">Precision_fmt_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">x</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="STAR">*</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">precision_fmt_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating a padding, a precision and an fmt. *)</span><span class="EOL">
</span><span class="COMMENT">(* See make_padprec_fmt_ebb and parse_format functions. *)</span><span class="EOL">
</span><span id="type-padprec_fmt_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">p</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padprec_fmt_ebb</span> <span class="EQUAL">=</span> <span id="type-padprec_fmt_ebb.constructor-Padprec_fmt_EBB"><span class="UIDENT">Padprec_fmt_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="STAR">*</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">p</span> <span class="MINUSGREATER">-&gt;</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="STAR">*</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">p</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padprec_fmt_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Abstract the 'a and 'd parameters of an fmt. *)</span><span class="EOL">
</span><span class="COMMENT">(* Output type of the format parsing function. *)</span><span class="EOL">
</span><span id="type-fmt_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span> <span id="type-fmt_ebb.constructor-Fmt_EBB"><span class="UIDENT">Fmt_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating an fmtty and an fmt. *)</span><span class="EOL">
</span><span class="COMMENT">(* See the type_format_gen function. *)</span><span class="EOL">
</span><span id="type-fmt_fmtty_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span> <span class="EQUAL">=</span> <span id="type-fmt_fmtty_ebb.constructor-Fmt_fmtty_EBB"><span class="UIDENT">Fmt_fmtty_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="STAR">*</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* GADT type associating an fmtty and an fmt. *)</span><span class="EOL">
</span><span class="COMMENT">(* See the type_ignored_format_substitution function. *)</span><span class="EOL">
</span><span id="type-fmtty_fmt_ebb"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_fmt_ebb</span> <span class="EQUAL">=</span> <span id="type-fmtty_fmt_ebb.constructor-Fmtty_fmt_EBB"><span class="UIDENT">Fmtty_fmt_EBB</span> <span class="COLON">:</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="STAR">*</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>     <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_fmt_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Abstract all fmtty type parameters. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to compare format types. *)</span><span class="EOL">
</span><span id="type-fmtty_ebb"><span class="TYPE">type</span> <span class="LIDENT">fmtty_ebb</span> <span class="EQUAL">=</span> <span id="type-fmtty_ebb.constructor-Fmtty_EBB"><span class="UIDENT">Fmtty_EBB</span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">c</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">d</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">e</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Abstract all padding type parameters. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to compare paddings. *)</span><span class="EOL">
</span><span id="type-padding_ebb"><span class="TYPE">type</span> <span class="LIDENT">padding_ebb</span> <span class="EQUAL">=</span> <span id="type-padding_ebb.constructor-Padding_EBB"><span class="UIDENT">Padding_EBB</span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">padding_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Abstract all precision type parameters. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to compare precisions. *)</span><span class="EOL">
</span><span id="type-precision_ebb"><span class="TYPE">type</span> <span class="LIDENT">precision_ebb</span> <span class="EQUAL">=</span> <span id="type-precision_ebb.constructor-Precision_EBB"><span class="UIDENT">Precision_EBB</span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">precision_ebb</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                               <span class="COMMENT">(* Constants *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Default precision for float printing. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-default_float_precision"><span class="LIDENT">default_float_precision</span></span> <span id="local_fconv_40"><span class="LIDENT">fconv</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a> <a href="#local_fconv_40"><span class="LIDENT">fconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_f</span> <span class="BAR">|</span> <span class="UIDENT">Float_e</span> <span class="BAR">|</span> <span class="UIDENT">Float_E</span> <span class="BAR">|</span> <span class="UIDENT">Float_g</span> <span class="BAR">|</span> <span class="UIDENT">Float_G</span> <span class="BAR">|</span> <span class="UIDENT">Float_h</span> <span class="BAR">|</span> <span class="UIDENT">Float_H</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_CF</span> <span class="MINUSGREATER">-&gt;</span> <span class="MINUS">-</span><span class="INT">6</span><span class="EOL">
</span>  <span class="COMMENT">(* For %h %H and %#F formats, a negative precision means &quot;as many digits as
     necessary&quot;.  For the other FP formats, we take the absolute value
     of the precision, hence 6 digits by default. *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_F</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">12</span><span class="EOL">
</span>  <span class="COMMENT">(* Default precision for OCaml float printing (%F). *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                               <span class="COMMENT">(* Externals *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="val-format_float"><span class="EXTERNAL">external</span> <span class="LIDENT">format_float</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">float</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_format_float&quot;</span></span><span class="EOL">
</span><span id="val-format_int"><span class="EXTERNAL">external</span> <span class="LIDENT">format_int</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_format_int&quot;</span></span><span class="EOL">
</span><span id="val-format_int32"><span class="EXTERNAL">external</span> <span class="LIDENT">format_int32</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int32</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_int32_format&quot;</span></span><span class="EOL">
</span><span id="val-format_nativeint"><span class="EXTERNAL">external</span> <span class="LIDENT">format_nativeint</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">nativeint</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_nativeint_format&quot;</span></span><span class="EOL">
</span><span id="val-format_int64"><span class="EXTERNAL">external</span> <span class="LIDENT">format_int64</span><span class="COLON">:</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int64</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_int64_format&quot;</span></span><span class="EOL">
</span><span id="val-hexstring_of_float"><span class="EXTERNAL">external</span> <span class="LIDENT">hexstring_of_float</span><span class="COLON">:</span> <span class="LIDENT">float</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="EOL">
</span>  <span class="EQUAL">=</span> <span class="STRING">&quot;caml_hexstring_of_float&quot;</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                     <span class="COMMENT">(* Tools to pretty-print formats *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Type of extensible character buffers. *)</span><span class="EOL">
</span><span id="type-buffer"><span class="TYPE">type</span> <span class="LIDENT">buffer</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span><span class="EOL">
</span>  <span id="def_1547"><span class="MUTABLE">mutable</span> <span class="LIDENT">ind</span> <span class="COLON">:</span> <span class="LIDENT">int</span><span class="SEMI">;</span></span><span class="EOL">
</span>  <span id="def_1548"><span class="MUTABLE">mutable</span> <span class="LIDENT">bytes</span> <span class="COLON">:</span> <span class="LIDENT">bytes</span><span class="SEMI">;</span></span><span class="EOL">
</span><span class="RBRACE">}</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Create a fresh buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffer_create"><span class="LIDENT">buffer_create</span></span> <span id="local_init_size_41"><span class="LIDENT">init_size</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <span class="LIDENT">ind</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="SEMI">;</span> <span class="LIDENT">bytes</span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_init_size_41"><span class="LIDENT">init_size</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Check size of the buffer and grow it if needed. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffer_check_size"><span class="LIDENT">buffer_check_size</span></span> <span id="local_buf_42"><span class="LIDENT">buf</span></span> <span id="local_overhead_43"><span class="LIDENT">overhead</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_44"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-length"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_buf_42"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">bytes</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_min_len_45"><span class="LIDENT">min_len</span></span> <span class="EQUAL">=</span> <a href="#local_buf_42"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_overhead_43"><span class="LIDENT">overhead</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_min_len_45"><span class="LIDENT">min_len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_len_44"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_len_46"><span class="LIDENT">new_len</span></span> <span class="EQUAL">=</span> <a href="int.ml.html#val-max"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">max</span></a> <span class="LPAREN">(</span><a href="#local_len_44"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_min_len_45"><span class="LIDENT">min_len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_str_47"><span class="LIDENT">new_str</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <a href="#local_new_len_46"><span class="LIDENT">new_len</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-blit"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_buf_42"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">bytes</span> <span class="INT">0</span> <a href="#local_new_str_47"><span class="LIDENT">new_str</span></a> <span class="INT">0</span> <a href="#local_len_44"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_buf_42"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">bytes</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_new_str_47"><span class="LIDENT">new_str</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add the character `c' to the buffer `buf'. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffer_add_char"><span class="LIDENT">buffer_add_char</span></span> <span id="local_buf_48"><span class="LIDENT">buf</span></span> <span id="local_c_49"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">buffer_check_size</span> <a href="#local_buf_48"><span class="LIDENT">buf</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_buf_48"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">bytes</span> <a href="#local_buf_48"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <a href="#local_c_49"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_buf_48"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_buf_48"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add the string `s' to the buffer `buf'. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffer_add_string"><span class="LIDENT">buffer_add_string</span></span> <span id="local_buf_50"><span class="LIDENT">buf</span></span> <span id="local_s_51"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_len_52"><span class="LIDENT">str_len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_51"><span class="LIDENT">s</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">buffer_check_size</span> <a href="#local_buf_50"><span class="LIDENT">buf</span></a> <a href="#local_str_len_52"><span class="LIDENT">str_len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_s_51"><span class="LIDENT">s</span></a> <span class="INT">0</span> <a href="#local_buf_50"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">bytes</span> <a href="#local_buf_50"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <a href="#local_str_len_52"><span class="LIDENT">str_len</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_buf_50"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <span class="LESSMINUS">&lt;-</span> <a href="#local_buf_50"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <a href="#local_str_len_52"><span class="LIDENT">str_len</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Get the content of the buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-buffer_contents"><span class="LIDENT">buffer_contents</span></span> <span id="local_buf_53"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-sub_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">sub_string</span></a> <a href="#local_buf_53"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">bytes</span> <span class="INT">0</span> <a href="#local_buf_53"><span class="LIDENT">buf</span></a><span class="DOT">.</span><span class="LIDENT">ind</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert an integer conversion to char. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_of_iconv"><span class="LIDENT">char_of_iconv</span></span> <span id="local_iconv_54"><span class="LIDENT">iconv</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_iconv_54"><span class="LIDENT">iconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_d</span> <span class="BAR">|</span> <span class="UIDENT">Int_pd</span> <span class="BAR">|</span> <span class="UIDENT">Int_sd</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'d'</span> <span class="BAR">|</span> <span class="UIDENT">Int_i</span> <span class="BAR">|</span> <span class="UIDENT">Int_pi</span> <span class="BAR">|</span> <span class="UIDENT">Int_si</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'i'</span> <span class="BAR">|</span> <span class="UIDENT">Int_x</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cx</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'x'</span> <span class="BAR">|</span> <span class="UIDENT">Int_X</span> <span class="BAR">|</span> <span class="UIDENT">Int_CX</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'X'</span> <span class="BAR">|</span> <span class="UIDENT">Int_o</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_Co</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'o'</span> <span class="BAR">|</span> <span class="UIDENT">Int_u</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'u'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a float conversion to char. *)</span><span class="EOL">
</span><span class="COMMENT">(* `cF' will be 'F' for displaying format and 'g' to call libc printf *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_of_fconv"><span class="LIDENT">char_of_fconv</span></span> <span class="QUESTION">?</span><span class="LPAREN">(</span><span id="local_cF_55"><span class="LIDENT">cF</span></span><span class="EQUAL">=</span><span class="CHAR">'F'</span><span class="RPAREN">)</span> <span id="local_fconv_56"><span class="LIDENT">fconv</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a> <a href="#local_fconv_56"><span class="LIDENT">fconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_f</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'f'</span> <span class="BAR">|</span> <span class="UIDENT">Float_e</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'e'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_E</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'E'</span> <span class="BAR">|</span> <span class="UIDENT">Float_g</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'g'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_G</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'G'</span> <span class="BAR">|</span> <span class="UIDENT">Float_F</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_cF_55"><span class="LIDENT">cF</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_h</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'h'</span> <span class="BAR">|</span> <span class="UIDENT">Float_H</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'H'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_CF</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'F'</span><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a scanning counter to char. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-char_of_counter"><span class="LIDENT">char_of_counter</span></span> <span id="local_counter_57"><span class="LIDENT">counter</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_counter_57"><span class="LIDENT">counter</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Line_counter</span>  <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'l'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_counter</span>  <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'n'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Token_counter</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'N'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a char_set in a buffer with the OCaml format lexical convention. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_char_set"><span class="LIDENT">bprint_char_set</span></span> <span id="local_buf_58"><span class="LIDENT">buf</span></span> <span id="local_char_set_59"><span class="LIDENT">char_set</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_print_start_60"><span class="LIDENT">print_start</span></span> <span id="local_set_61"><span class="LIDENT">set</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_is_alone_62"><span class="LIDENT">is_alone</span></span> <span id="local_c_63"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1529"><span id="local_before_64"><span class="LIDENT">before</span></span><span class="COMMA">,</span> <span id="local_after_65"><span class="LIDENT">after</span></span></span> <span class="EQUAL">=</span> <a href="char.ml.html"><span class="UIDENT">Char</span></a><span class="DOT">.</span><span class="LPAREN">(</span><a href="char.ml.html#val-chr"><span class="LIDENT">chr</span></a> <span class="LPAREN">(</span><a href="char.ml.html#val-code"><span class="LIDENT">code</span></a> <a href="#local_c_63"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="char.ml.html#val-chr"><span class="LIDENT">chr</span></a> <span class="LPAREN">(</span><a href="char.ml.html#val-code"><span class="LIDENT">code</span></a> <a href="#local_c_63"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">is_in_char_set</span> <a href="#local_set_61"><span class="LIDENT">set</span></a> <a href="#local_c_63"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_in_char_set</span> <a href="#local_set_61"><span class="LIDENT">set</span></a> <a href="#local_before_64"><span class="LIDENT">before</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LIDENT">is_in_char_set</span> <a href="#local_set_61"><span class="LIDENT">set</span></a> <a href="#local_after_65"><span class="LIDENT">after</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_is_alone_62"><span class="LIDENT">is_alone</span></a> <span class="CHAR">']'</span> <span class="THEN">then</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="CHAR">']'</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_61"><span class="LIDENT">set</span></a> <span class="INT">1</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_is_alone_62"><span class="LIDENT">is_alone</span></a> <span class="CHAR">'-'</span> <span class="THEN">then</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="CHAR">'-'</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_print_out_66"><span class="LIDENT">print_out</span></span> <span id="local_set_67"><span class="LIDENT">set</span></span> <span id="local_i_68"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_i_68"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">256</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="LIDENT">is_in_char_set</span> <a href="#local_set_67"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_i_68"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span> <a href="#local_print_first_69"><span class="LIDENT">print_first</span></a> <a href="#local_set_67"><span class="LIDENT">set</span></a> <a href="#local_i_68"><span class="LIDENT">i</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_67"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_68"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_print_first_69"><span class="LIDENT">print_first</span></span> <span id="local_set_70"><span class="LIDENT">set</span></span> <span id="local_i_71"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_i_71"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'\255'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="INT">255</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">']'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_70"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_71"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_print_second_72"><span class="LIDENT">print_second</span></a> <a href="#local_set_70"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_71"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_print_second_72"><span class="LIDENT">print_second</span></span> <span id="local_set_73"><span class="LIDENT">set</span></span> <span id="local_i_74"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">is_in_char_set</span> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_i_74"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_i_74"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\255'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="INT">254</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="INT">255</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">']'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="WHEN">when</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_in_char_set</span> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="WHEN">when</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_in_char_set</span> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <a href="#local_i_74"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_print_in_75"><span class="LIDENT">print_in</span></a> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="ELSE">else</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_73"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_i_74"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_print_in_75"><span class="LIDENT">print_in</span></span> <span id="local_set_76"><span class="LIDENT">set</span></span> <span id="local_i_77"><span class="LIDENT">i</span></span> <span id="local_j_78"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_j_78"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">256</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><span class="LIDENT">is_in_char_set</span> <a href="#local_set_76"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_j_78"><span class="LIDENT">j</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <a href="#local_i_77"><span class="LIDENT">i</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'-'</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_print_char_79"><span class="LIDENT">print_char</span></a> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="#local_j_78"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_j_78"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">256</span> <span class="THEN">then</span> <a href="#local_print_out_66"><span class="LIDENT">print_out</span></a> <a href="#local_set_76"><span class="LIDENT">set</span></a> <span class="LPAREN">(</span><a href="#local_j_78"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>      <a href="#local_print_in_75"><span class="LIDENT">print_in</span></a> <a href="#local_set_76"><span class="LIDENT">set</span></a> <a href="#local_i_77"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_j_78"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_print_char_79"><span class="LIDENT">print_char</span></span> <span id="local_buf_80"><span class="LIDENT">buf</span></span> <span id="local_i_81"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <a href="#local_i_81"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_80"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_80"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'@'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_80"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_80"><span class="LIDENT">buf</span></a> <span class="CHAR">'@'</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_c_82"><span class="LIDENT">c</span></span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_80"><span class="LIDENT">buf</span></a> <a href="#local_c_82"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="CHAR">'['</span><span class="SEMI">;</span><span class="EOL">
</span>  <a href="#local_print_start_60"><span class="LIDENT">print_start</span></a> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="LIDENT">is_in_char_set</span> <a href="#local_char_set_59"><span class="LIDENT">char_set</span></a> <span class="CHAR">'\000'</span><span class="EOL">
</span>    <span class="THEN">then</span> <span class="LPAREN">(</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="CHAR">'^'</span><span class="SEMI">;</span> <span class="LIDENT">rev_char_set</span> <a href="#local_char_set_59"><span class="LIDENT">char_set</span></a> <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span> <a href="#local_char_set_59"><span class="LIDENT">char_set</span></a><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_58"><span class="LIDENT">buf</span></a> <span class="CHAR">']'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a padty in a buffer with the format-like syntax. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_padty"><span class="LIDENT">bprint_padty</span></span> <span id="local_buf_83"><span class="LIDENT">buf</span></span> <span id="local_padty_84"><span class="LIDENT">padty</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_padty_84"><span class="LIDENT">padty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Left</span>  <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_83"><span class="LIDENT">buf</span></a> <span class="CHAR">'-'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Right</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Zeros</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_83"><span class="LIDENT">buf</span></a> <span class="CHAR">'0'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print the '_' of an ignored flag if needed. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_ignored_flag"><span class="LIDENT">bprint_ignored_flag</span></span> <span id="local_buf_85"><span class="LIDENT">buf</span></span> <span id="local_ign_flag_86"><span class="LIDENT">ign_flag</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_ign_flag_86"><span class="LIDENT">ign_flag</span></a> <span class="THEN">then</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_85"><span class="LIDENT">buf</span></a> <span class="CHAR">'_'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_pad_opt"><span class="LIDENT">bprint_pad_opt</span></span> <span id="local_buf_87"><span class="LIDENT">buf</span></span> <span id="local_pad_opt_88"><span class="LIDENT">pad_opt</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_pad_opt_88"><span class="LIDENT">pad_opt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_width_89"><span class="LIDENT">width</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_87"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="int.ml.html#val-to_string"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_width_89"><span class="LIDENT">width</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print padding in a buffer with the format-like syntax. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_padding"><span class="LIDENT">bprint_padding</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="DOT">.</span> <span class="LIDENT">buffer</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_buf_90"><span class="LIDENT">buf</span></span> <span id="local_pad_91"><span class="LIDENT">pad</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_91"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_92"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_n_93"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">bprint_padty</span> <a href="#local_buf_90"><span class="LIDENT">buf</span></a> <a href="#local_padty_92"><span class="LIDENT">padty</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_90"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="int.ml.html#val-to_string"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_n_93"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_94"><span class="LIDENT">padty</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">bprint_padty</span> <a href="#local_buf_90"><span class="LIDENT">buf</span></a> <a href="#local_padty_94"><span class="LIDENT">padty</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_90"><span class="LIDENT">buf</span></a> <span class="CHAR">'*'</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print precision in a buffer with the format-like syntax. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_precision"><span class="LIDENT">bprint_precision</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="DOT">.</span> <span class="LIDENT">buffer</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_buf_95"><span class="LIDENT">buf</span></span> <span id="local_prec_96"><span class="LIDENT">prec</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_prec_96"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_precision</span> <span id="local_n_97"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_95"><span class="LIDENT">buf</span></a> <span class="CHAR">'.'</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_95"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="int.ml.html#val-to_string"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_n_97"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_95"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;.*&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print the optional '+', ' ' or '#' associated to an int conversion. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_iconv_flag"><span class="LIDENT">bprint_iconv_flag</span></span> <span id="local_buf_98"><span class="LIDENT">buf</span></span> <span id="local_iconv_99"><span class="LIDENT">iconv</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_iconv_99"><span class="LIDENT">iconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_pd</span> <span class="BAR">|</span> <span class="UIDENT">Int_pi</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_98"><span class="LIDENT">buf</span></a> <span class="CHAR">'+'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_sd</span> <span class="BAR">|</span> <span class="UIDENT">Int_si</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_98"><span class="LIDENT">buf</span></a> <span class="CHAR">' '</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_Cx</span> <span class="BAR">|</span> <span class="UIDENT">Int_CX</span> <span class="BAR">|</span> <span class="UIDENT">Int_Co</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_98"><span class="LIDENT">buf</span></a> <span class="CHAR">'#'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_d</span> <span class="BAR">|</span> <span class="UIDENT">Int_i</span> <span class="BAR">|</span> <span class="UIDENT">Int_x</span> <span class="BAR">|</span> <span class="UIDENT">Int_X</span> <span class="BAR">|</span> <span class="UIDENT">Int_o</span> <span class="BAR">|</span> <span class="UIDENT">Int_u</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print an complete int format in a buffer (ex: &quot;%3.*d&quot;). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_int_fmt"><span class="LIDENT">bprint_int_fmt</span></span> <span id="local_buf_100"><span class="LIDENT">buf</span></span> <span id="local_ign_flag_101"><span class="LIDENT">ign_flag</span></span> <span id="local_iconv_102"><span class="LIDENT">iconv</span></span> <span id="local_pad_103"><span class="LIDENT">pad</span></span> <span id="local_prec_104"><span class="LIDENT">prec</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_100"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_100"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_101"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_iconv_flag</span> <a href="#local_buf_100"><span class="LIDENT">buf</span></a> <a href="#local_iconv_102"><span class="LIDENT">iconv</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_padding</span> <a href="#local_buf_100"><span class="LIDENT">buf</span></a> <a href="#local_pad_103"><span class="LIDENT">pad</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_precision</span> <a href="#local_buf_100"><span class="LIDENT">buf</span></a> <a href="#local_prec_104"><span class="LIDENT">prec</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_100"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_of_iconv</span> <a href="#local_iconv_102"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a complete int32, nativeint or int64 format in a buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_altint_fmt"><span class="LIDENT">bprint_altint_fmt</span></span> <span id="local_buf_105"><span class="LIDENT">buf</span></span> <span id="local_ign_flag_106"><span class="LIDENT">ign_flag</span></span> <span id="local_iconv_107"><span class="LIDENT">iconv</span></span> <span id="local_pad_108"><span class="LIDENT">pad</span></span> <span id="local_prec_109"><span class="LIDENT">prec</span></span> <span id="local_c_110"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_106"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_iconv_flag</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <a href="#local_iconv_107"><span class="LIDENT">iconv</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_padding</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <a href="#local_pad_108"><span class="LIDENT">pad</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_precision</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <a href="#local_prec_109"><span class="LIDENT">prec</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <a href="#local_c_110"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_105"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_of_iconv</span> <a href="#local_iconv_107"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print the optional '+', ' ' and/or '#' associated to a float conversion. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_fconv_flag"><span class="LIDENT">bprint_fconv_flag</span></span> <span id="local_buf_111"><span class="LIDENT">buf</span></span> <span id="local_fconv_112"><span class="LIDENT">fconv</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="stdlib.ml.html#val-fst"><span class="LIDENT">fst</span></a> <a href="#local_fconv_112"><span class="LIDENT">fconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_flag_p</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_111"><span class="LIDENT">buf</span></a> <span class="CHAR">'+'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_flag_s</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_111"><span class="LIDENT">buf</span></a> <span class="CHAR">' '</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_flag_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a> <a href="#local_fconv_112"><span class="LIDENT">fconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_CF</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_111"><span class="LIDENT">buf</span></a> <span class="CHAR">'#'</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_f</span> <span class="BAR">|</span> <span class="UIDENT">Float_e</span> <span class="BAR">|</span> <span class="UIDENT">Float_E</span> <span class="BAR">|</span> <span class="UIDENT">Float_g</span> <span class="BAR">|</span> <span class="UIDENT">Float_G</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_F</span> <span class="BAR">|</span> <span class="UIDENT">Float_h</span> <span class="BAR">|</span> <span class="UIDENT">Float_H</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a complete float format in a buffer (ex: &quot;%+*.3f&quot;). *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_float_fmt"><span class="LIDENT">bprint_float_fmt</span></span> <span id="local_buf_113"><span class="LIDENT">buf</span></span> <span id="local_ign_flag_114"><span class="LIDENT">ign_flag</span></span> <span id="local_fconv_115"><span class="LIDENT">fconv</span></span> <span id="local_pad_116"><span class="LIDENT">pad</span></span> <span id="local_prec_117"><span class="LIDENT">prec</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_113"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_113"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_114"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_fconv_flag</span> <a href="#local_buf_113"><span class="LIDENT">buf</span></a> <a href="#local_fconv_115"><span class="LIDENT">fconv</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_padding</span> <a href="#local_buf_113"><span class="LIDENT">buf</span></a> <a href="#local_pad_116"><span class="LIDENT">pad</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">bprint_precision</span> <a href="#local_buf_113"><span class="LIDENT">buf</span></a> <a href="#local_prec_117"><span class="LIDENT">prec</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_113"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_of_fconv</span> <a href="#local_fconv_115"><span class="LIDENT">fconv</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Compute the literal string representation of a Formatting_lit. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used by Printf and Scanf where formatting is not interpreted. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-string_of_formatting_lit"><span class="LIDENT">string_of_formatting_lit</span></span> <span id="local_formatting_lit_118"><span class="LIDENT">formatting_lit</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_formatting_lit_118"><span class="LIDENT">formatting_lit</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Close_box</span>            <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@]&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Close_tag</span>            <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@}&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Break</span> <span class="LPAREN">(</span><span id="local_str_119"><span class="LIDENT">str</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>    <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_119"><span class="LIDENT">str</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">FFlush</span>               <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@?&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Force_newline</span>        <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@\n&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush_newline</span>        <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@.&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><span id="local_str_120"><span class="LIDENT">str</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>  <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_120"><span class="LIDENT">str</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Escaped_at</span>           <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@@&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Escaped_percent</span>      <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@%&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_indic</span> <span id="local_c_121"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;@&quot;</span> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-make"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="INT">1</span> <a href="#local_c_121"><span class="LIDENT">c</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a literal char in a buffer, escape '%' by &quot;%%&quot;. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_char_literal"><span class="LIDENT">bprint_char_literal</span></span> <span id="local_buf_122"><span class="LIDENT">buf</span></span> <span id="local_chr_123"><span class="LIDENT">chr</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_chr_123"><span class="LIDENT">chr</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_122"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%%&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_122"><span class="LIDENT">buf</span></a> <a href="#local_chr_123"><span class="LIDENT">chr</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a literal string in a buffer, escape all '%' by &quot;%%&quot;. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_string_literal"><span class="LIDENT">bprint_string_literal</span></span> <span id="local_buf_124"><span class="LIDENT">buf</span></span> <span id="local_str_125"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_125"><span class="LIDENT">str</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>    <span class="LIDENT">bprint_char_literal</span> <a href="#local_buf_124"><span class="LIDENT">buf</span></a> <a href="#local_str_125"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="LIDENT">i</span><span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="DONE">done</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                          <span class="COMMENT">(* Format pretty-printing *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a complete format type (an fmtty) in a buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-bprint_fmtty"><span class="LIDENT">bprint_fmtty</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">g</span> <span class="LIDENT">h</span> <span class="LIDENT">i</span> <span class="LIDENT">j</span> <span class="LIDENT">k</span> <span class="LIDENT">l</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LIDENT">buffer</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="COMMA">,</span> <span class="LIDENT">g</span><span class="COMMA">,</span> <span class="LIDENT">h</span><span class="COMMA">,</span> <span class="LIDENT">i</span><span class="COMMA">,</span> <span class="LIDENT">j</span><span class="COMMA">,</span> <span class="LIDENT">k</span><span class="COMMA">,</span> <span class="LIDENT">l</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_buf_126"><span class="LIDENT">buf</span></span> <span id="local_fmtty_127"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmtty_127"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_rest_128"><span class="LIDENT">rest</span></span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%c&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_128"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_rest_129"><span class="LIDENT">rest</span></span>    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%s&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_129"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_130"><span class="LIDENT">rest</span></span>       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%i&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_130"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest_131"><span class="LIDENT">rest</span></span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%li&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_131"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest_132"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%ni&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_132"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest_133"><span class="LIDENT">rest</span></span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%Li&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_133"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_rest_134"><span class="LIDENT">rest</span></span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%f&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_134"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest_135"><span class="LIDENT">rest</span></span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%B&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_135"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest_136"><span class="LIDENT">rest</span></span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%a&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_136"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest_137"><span class="LIDENT">rest</span></span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%t&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_137"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span id="local_rest_138"><span class="LIDENT">rest</span></span>       <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%?&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_138"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span id="local_rest_139"><span class="LIDENT">rest</span></span>    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%r&quot;</span><span class="SEMI">;</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_139"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_rest_140"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%_r&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_140"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_141"><span class="LIDENT">sub_fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_142"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%{&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_sub_fmtty_141"><span class="LIDENT">sub_fmtty</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%}&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_142"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_143"><span class="LIDENT">sub_fmtty</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_144"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%(&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_sub_fmtty_143"><span class="LIDENT">sub_fmtty</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%)&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_126"><span class="LIDENT">buf</span></a> <a href="#local_rest_144"><span class="LIDENT">rest</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-int_of_custom_arity"><span class="LIDENT">int_of_custom_arity</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="DOT">.</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-custom_arity"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">custom_arity</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom_zero</span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom_succ</span> <span id="local_x_145"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="INT">1</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LIDENT">int_of_custom_arity</span> <a href="#local_x_145"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Print a complete format in a buffer. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-bprint_fmt"><span class="LIDENT">bprint_fmt</span></span> <span id="local_buf_146"><span class="LIDENT">buf</span></span> <span id="local_fmt_147"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_fmtiter_148"><span class="LIDENT">fmtiter</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">unit</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_fmt_149"><span class="LIDENT">fmt</span></span> <span id="local_ign_flag_150"><span class="LIDENT">ign_flag</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmt_149"><span class="LIDENT">fmt</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_151"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_152"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_padding</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_pad_151"><span class="LIDENT">pad</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'s'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_152"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span id="local_pad_153"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_154"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_padding</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_pad_153"><span class="LIDENT">pad</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'S'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_154"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span id="local_iconv_155"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_156"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_157"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_158"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_int_fmt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a> <a href="#local_iconv_155"><span class="LIDENT">iconv</span></a> <a href="#local_pad_156"><span class="LIDENT">pad</span></a> <a href="#local_prec_157"><span class="LIDENT">prec</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_158"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span id="local_iconv_159"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_160"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_161"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_162"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_altint_fmt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a> <a href="#local_iconv_159"><span class="LIDENT">iconv</span></a> <a href="#local_pad_160"><span class="LIDENT">pad</span></a> <a href="#local_prec_161"><span class="LIDENT">prec</span></a> <span class="CHAR">'l'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_162"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span id="local_iconv_163"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_164"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_165"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_166"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_altint_fmt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a> <a href="#local_iconv_163"><span class="LIDENT">iconv</span></a> <a href="#local_pad_164"><span class="LIDENT">pad</span></a> <a href="#local_prec_165"><span class="LIDENT">prec</span></a> <span class="CHAR">'n'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_166"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span id="local_iconv_167"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_168"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_169"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_170"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_altint_fmt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a> <a href="#local_iconv_167"><span class="LIDENT">iconv</span></a> <a href="#local_pad_168"><span class="LIDENT">pad</span></a> <a href="#local_prec_169"><span class="LIDENT">prec</span></a> <span class="CHAR">'L'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_170"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span id="local_fconv_171"><span class="LIDENT">fconv</span></span><span class="COMMA">,</span> <span id="local_pad_172"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_173"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_174"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_float_fmt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a> <a href="#local_fconv_171"><span class="LIDENT">fconv</span></a> <a href="#local_pad_172"><span class="LIDENT">pad</span></a> <a href="#local_prec_173"><span class="LIDENT">prec</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_174"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_rest_175"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'c'</span><span class="SEMI">;</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_175"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_rest_176"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'C'</span><span class="SEMI">;</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_176"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span id="local_pad_177"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_178"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_padding</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_pad_177"><span class="LIDENT">pad</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'B'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_178"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span id="local_rest_179"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'a'</span><span class="SEMI">;</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_179"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span id="local_rest_180"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'t'</span><span class="SEMI">;</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_180"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Custom</span> <span class="LPAREN">(</span><span id="local_arity_181"><span class="LIDENT">arity</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_182"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">_i</span> <span class="EQUAL">=</span> <span class="INT">1</span> <span class="TO">to</span> <span class="LIDENT">int_of_custom_arity</span> <a href="#local_arity_181"><span class="LIDENT">arity</span></a> <span class="DO">do</span><span class="EOL">
</span>        <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'?'</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_182"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span id="local_rest_183"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'r'</span><span class="SEMI">;</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_183"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_rest_184"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;%!&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_184"><span class="LIDENT">rest</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span id="local_str_185"><span class="LIDENT">str</span></span><span class="COMMA">,</span> <span id="local_rest_186"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_string_literal</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_str_185"><span class="LIDENT">str</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_186"><span class="LIDENT">rest</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span id="local_chr_187"><span class="LIDENT">chr</span></span><span class="COMMA">,</span> <span id="local_rest_188"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_char_literal</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_chr_187"><span class="LIDENT">chr</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_188"><span class="LIDENT">rest</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span id="local_pad_opt_189"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_fmtty_190"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_191"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_pad_opt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_pad_opt_189"><span class="LIDENT">pad_opt</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'{'</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_fmtty_190"><span class="LIDENT">fmtty</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'}'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_191"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span id="local_pad_opt_192"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_fmtty_193"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_194"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_pad_opt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_pad_opt_192"><span class="LIDENT">pad_opt</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'('</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_fmtty_193"><span class="LIDENT">fmtty</span></a><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">')'</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_194"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span id="local_width_opt_195"><span class="LIDENT">width_opt</span></span><span class="COMMA">,</span> <span id="local_char_set_196"><span class="LIDENT">char_set</span></span><span class="COMMA">,</span> <span id="local_rest_197"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_pad_opt</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_width_opt_195"><span class="LIDENT">width_opt</span></a><span class="SEMI">;</span> <span class="LIDENT">bprint_char_set</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_char_set_196"><span class="LIDENT">char_set</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_197"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span id="local_counter_198"><span class="LIDENT">counter</span></span><span class="COMMA">,</span> <span id="local_rest_199"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><span class="LIDENT">char_of_counter</span> <a href="#local_counter_198"><span class="LIDENT">counter</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_199"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Scan_next_char</span> <span id="local_rest_200"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span> <span class="LIDENT">bprint_ignored_flag</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_string_literal</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;0c&quot;</span><span class="SEMI">;</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_200"><span class="LIDENT">rest</span></a> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_201"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_202"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Param_format_EBB</span> <span id="local_fmt'_203"><span class="LIDENT">fmt'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">param_format_of_ignored_format</span> <a href="#local_ign_201"><span class="LIDENT">ign</span></a> <a href="#local_rest_202"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_fmt'_203"><span class="LIDENT">fmt'</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span id="local_fmting_lit_204"><span class="LIDENT">fmting_lit</span></span><span class="COMMA">,</span> <span id="local_rest_205"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">bprint_string_literal</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><span class="LIDENT">string_of_formatting_lit</span> <a href="#local_fmting_lit_204"><span class="LIDENT">fmting_lit</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_205"><span class="LIDENT">rest</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span id="local_fmting_gen_206"><span class="LIDENT">fmting_gen</span></span><span class="COMMA">,</span> <span id="local_rest_207"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_fmting_gen_206"><span class="LIDENT">fmting_gen</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_str_208"><span class="LIDENT">str</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;@{&quot;</span><span class="SEMI">;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_str_208"><span class="LIDENT">str</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_str_209"><span class="LIDENT">str</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <span class="STRING">&quot;@[&quot;</span><span class="SEMI">;</span> <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_146"><span class="LIDENT">buf</span></a> <a href="#local_str_209"><span class="LIDENT">str</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_rest_207"><span class="LIDENT">rest</span></a> <a href="#local_ign_flag_150"><span class="LIDENT">ign_flag</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End_of_format</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="IN">in</span> <a href="#local_fmtiter_148"><span class="LIDENT">fmtiter</span></a> <a href="#local_fmt_147"><span class="LIDENT">fmt</span></a> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(***)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a format to string. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-string_of_fmt"><span class="LIDENT">string_of_fmt</span></span> <span id="local_fmt_210"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_211"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">buffer_create</span> <span class="INT">16</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">bprint_fmt</span> <a href="#local_buf_211"><span class="LIDENT">buf</span></a> <a href="#local_fmt_210"><span class="LIDENT">fmt</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_contents</span> <a href="#local_buf_211"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                          <span class="COMMENT">(* Type extraction *)</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-eq"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span> <span class="EQUAL">=</span> <span id="type-eq.constructor-Refl"><span class="UIDENT">Refl</span> <span class="COLON">:</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Invariant: this function is the identity on values.

   In particular, if (ty1, ty2) have equal values, then
   (trans (symm ty1) ty2) respects the 'trans' precondition. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-symm"><span class="LIDENT">symm</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">b1</span> <span class="LIDENT">c1</span> <span class="LIDENT">d1</span> <span class="LIDENT">e1</span> <span class="LIDENT">f1</span> <span class="LIDENT">a2</span> <span class="LIDENT">b2</span> <span class="LIDENT">c2</span> <span class="LIDENT">d2</span> <span class="LIDENT">e2</span> <span class="LIDENT">f2</span> <span class="DOT">.</span><span class="EOL">
</span>   <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a><span class="EOL">
</span><span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_rest_212"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Char_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_212"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_213"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_213"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest_214"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int32_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_214"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest_215"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int64_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_215"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest_216"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Nativeint_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_216"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_rest_217"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_217"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest_218"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Bool_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_218"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_rest_219"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">String_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_219"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest_220"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Theta_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_220"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest_221"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Alpha_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_221"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span id="local_rest_222"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Any_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_222"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span id="local_rest_223"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Reader_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_223"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_rest_224"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ignored_reader_ty</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_rest_224"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_ty_225"><span class="LIDENT">ty</span></span><span class="COMMA">,</span> <span id="local_rest_226"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><a href="#local_ty_225"><span class="LIDENT">ty</span></a><span class="COMMA">,</span> <span class="LIDENT">symm</span> <a href="#local_rest_226"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_ty1_227"><span class="LIDENT">ty1</span></span><span class="COMMA">,</span> <span id="local_ty2_228"><span class="LIDENT">ty2</span></span><span class="COMMA">,</span> <span id="local_rest_229"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><a href="#local_ty2_228"><span class="LIDENT">ty2</span></a><span class="COMMA">,</span> <a href="#local_ty1_227"><span class="LIDENT">ty1</span></a><span class="COMMA">,</span> <span class="LIDENT">symm</span> <a href="#local_rest_229"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">End_of_fmtty</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-fmtty_rel_det"><span class="LIDENT">fmtty_rel_det</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d1</span> <span class="LIDENT">e1</span> <span class="LIDENT">f1</span> <span class="LIDENT">a2</span> <span class="LIDENT">d2</span> <span class="LIDENT">e2</span> <span class="LIDENT">f2</span> <span class="DOT">.</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="COMMA">,</span><span class="EOL">
</span>   <span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">f1</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">a2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="STAR">*</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">a2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">f1</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="STAR">*</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="STAR">*</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="RPAREN">)</span> <span class="LIDENT">eq</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_rest_230"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1530"><span id="local_fa_231"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_232"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_233"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_234"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_230"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_231"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_232"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_233"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_234"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_rest_235"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1536"><span id="local_fa_236"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_237"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_238"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_239"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_235"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_236"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_237"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_238"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_239"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_240"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1531"><span id="local_fa_241"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_242"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_243"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_244"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_240"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_241"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_242"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_243"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_244"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest_245"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1532"><span id="local_fa_246"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_247"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_248"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_249"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_245"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_246"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_247"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_248"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_249"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest_250"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1523"><span id="local_fa_251"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_252"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_253"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_254"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_250"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_251"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_252"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_253"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_254"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest_255"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1538"><span id="local_fa_256"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_257"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_258"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_259"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_255"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_256"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_257"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_258"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_259"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_rest_260"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1524"><span id="local_fa_261"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_262"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_263"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_264"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_260"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_261"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_262"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_263"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_264"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest_265"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1537"><span id="local_fa_266"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_267"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_268"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_269"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_265"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_266"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_267"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_268"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_269"><span class="LIDENT">de</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest_270"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1542"><span id="local_fa_271"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_272"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_273"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_274"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_270"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_271"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_272"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_273"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_274"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest_275"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1539"><span id="local_fa_276"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_277"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_278"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_279"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_275"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_276"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_277"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_278"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_279"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span id="local_rest_280"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1535"><span id="local_fa_281"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_282"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_283"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_284"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_280"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_281"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_282"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_283"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_284"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span id="local_rest_285"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1521"><span id="local_fa_286"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_287"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_288"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_289"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_285"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_286"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_287"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_ed_288"><span class="LIDENT">ed</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_de_289"><span class="LIDENT">de</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_rest_290"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1522"><span id="local_fa_291"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_292"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_293"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_294"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_290"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_291"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_292"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_ed_293"><span class="LIDENT">ed</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_de_294"><span class="LIDENT">de</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local__ty_295"><span class="LIDENT">_ty</span></span><span class="COMMA">,</span> <span id="local_rest_296"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1544"><span id="local_fa_297"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_298"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_299"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_300"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_296"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_297"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_298"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <a href="#local_ed_299"><span class="LIDENT">ed</span></a><span class="COMMA">,</span> <a href="#local_de_300"><span class="LIDENT">de</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_ty1_301"><span class="LIDENT">ty1</span></span><span class="COMMA">,</span> <span id="local_ty2_302"><span class="LIDENT">ty2</span></span><span class="COMMA">,</span> <span id="local_rest_303"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1533"><span id="local_fa_304"><span class="LIDENT">fa</span></span><span class="COMMA">,</span> <span id="local_af_305"><span class="LIDENT">af</span></span><span class="COMMA">,</span> <span id="local_ed_306"><span class="LIDENT">ed</span></span><span class="COMMA">,</span> <span id="local_de_307"><span class="LIDENT">de</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_rest_303"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_308"><span class="LIDENT">ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">trans</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_ty1_301"><span class="LIDENT">ty1</span></a><span class="RPAREN">)</span> <a href="#local_ty2_302"><span class="LIDENT">ty2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1526"><span id="local_ag_309"><span class="LIDENT">ag</span></span><span class="COMMA">,</span> <span id="local_ga_310"><span class="LIDENT">ga</span></span><span class="COMMA">,</span> <span id="local_dj_311"><span class="LIDENT">dj</span></span><span class="COMMA">,</span> <span id="local_jd_312"><span class="LIDENT">jd</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_ty_308"><span class="LIDENT">ty</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_fa_304"><span class="LIDENT">fa</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_ag_309"><span class="LIDENT">ag</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_ga_310"><span class="LIDENT">ga</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_af_305"><span class="LIDENT">af</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_ed_306"><span class="LIDENT">ed</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_dj_311"><span class="LIDENT">dj</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UIDENT">Refl</span> <span class="MINUSGREATER">-&gt;</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_jd_312"><span class="LIDENT">jd</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_de_307"><span class="LIDENT">de</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span> <span class="UIDENT">Refl</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Precondition: we assume that the two fmtty_rel arguments have equal
   values (at possibly distinct types); this invariant comes from the way
   fmtty_rel witnesses are produced by the type-checker

   The code below uses (assert false) when this assumption is broken. The
   code pattern is the following:

     | Foo x, Foo y -&gt;
       (* case where indeed both values
          start with constructor Foo *)
     | Foo _, _
     | _, Foo _ -&gt;
       (* different head constructors: broken precondition *)
       assert false
*)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-trans"><span class="LIDENT">trans</span></span> <span class="COLON">:</span> <span class="TYPE">type</span><span class="EOL">
</span>  <span class="LIDENT">a1</span> <span class="LIDENT">b1</span> <span class="LIDENT">c1</span> <span class="LIDENT">d1</span> <span class="LIDENT">e1</span> <span class="LIDENT">f1</span><span class="EOL">
</span>  <span class="LIDENT">a2</span> <span class="LIDENT">b2</span> <span class="LIDENT">c2</span> <span class="LIDENT">d2</span> <span class="LIDENT">e2</span> <span class="LIDENT">f2</span><span class="EOL">
</span>  <span class="LIDENT">a3</span> <span class="LIDENT">b3</span> <span class="LIDENT">c3</span> <span class="LIDENT">d3</span> <span class="LIDENT">e3</span> <span class="LIDENT">f3</span><span class="EOL">
</span><span class="DOT">.</span><span class="EOL">
</span>   <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a><span class="EOL">
</span><span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LIDENT">a3</span><span class="COMMA">,</span> <span class="LIDENT">b3</span><span class="COMMA">,</span> <span class="LIDENT">c3</span><span class="COMMA">,</span> <span class="LIDENT">d3</span><span class="COMMA">,</span> <span class="LIDENT">e3</span><span class="COMMA">,</span> <span class="LIDENT">f3</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a><span class="EOL">
</span><span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="LIDENT">a3</span><span class="COMMA">,</span> <span class="LIDENT">b3</span><span class="COMMA">,</span> <span class="LIDENT">c3</span><span class="COMMA">,</span> <span class="LIDENT">d3</span><span class="COMMA">,</span> <span class="LIDENT">e3</span><span class="COMMA">,</span> <span class="LIDENT">f3</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUN">fun</span> <span id="local_ty1_313"><span class="LIDENT">ty1</span></span> <span id="local_ty2_314"><span class="LIDENT">ty2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_ty1_313"><span class="LIDENT">ty1</span></a><span class="COMMA">,</span> <a href="#local_ty2_314"><span class="LIDENT">ty2</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_rest1_315"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Char_ty</span> <span id="local_rest2_316"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Char_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_315"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_316"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_rest1_317"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">String_ty</span> <span id="local_rest2_318"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">String_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_317"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_318"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest1_319"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest2_320"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Bool_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_319"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_320"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_rest1_321"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Int_ty</span> <span id="local_rest2_322"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_321"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_322"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest1_323"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest2_324"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int32_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_323"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_324"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest1_325"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest2_326"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int64_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_325"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_326"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest1_327"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest2_328"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Nativeint_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_327"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_328"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_rest1_329"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Float_ty</span> <span id="local_rest2_330"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_329"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_330"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest1_331"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest2_332"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Alpha_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_331"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_332"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Alpha_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest1_333"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest2_334"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Theta_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_333"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_334"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Theta_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span id="local_rest1_335"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Any_ty</span> <span id="local_rest2_336"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Any_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_335"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_336"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Any_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span id="local_rest1_337"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Reader_ty</span> <span id="local_rest2_338"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Reader_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_337"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_338"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Reader_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_rest1_339"><span class="LIDENT">rest1</span></span><span class="COMMA">,</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_rest2_340"><span class="LIDENT">rest2</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Ignored_reader_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_rest1_339"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_340"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Ignored_reader_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_ty1_341"><span class="LIDENT">ty1</span></span><span class="COMMA">,</span> <span id="local_rest1_342"><span class="LIDENT">rest1</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_ty2_343"><span class="LIDENT">ty2</span></span><span class="COMMA">,</span> <span id="local_rest2_344"><span class="LIDENT">rest2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span class="LIDENT">trans</span> <a href="#local_ty1_341"><span class="LIDENT">ty1</span></a> <a href="#local_ty2_343"><span class="LIDENT">ty2</span></a><span class="COMMA">,</span> <span class="LIDENT">trans</span> <a href="#local_rest1_342"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_344"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Format_arg_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_ty11_345"><span class="LIDENT">ty11</span></span><span class="COMMA">,</span> <span id="local_ty12_346"><span class="LIDENT">ty12</span></span><span class="COMMA">,</span> <span id="local_rest1_347"><span class="LIDENT">rest1</span></span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_ty21_348"><span class="LIDENT">ty21</span></span><span class="COMMA">,</span> <span id="local_ty22_349"><span class="LIDENT">ty22</span></span><span class="COMMA">,</span> <span id="local_rest2_350"><span class="LIDENT">rest2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_351"><span class="LIDENT">ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">trans</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_ty12_346"><span class="LIDENT">ty12</span></a><span class="RPAREN">)</span> <a href="#local_ty21_348"><span class="LIDENT">ty21</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1534"><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_f2_352"><span class="LIDENT">f2</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_f4_353"><span class="LIDENT">f4</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_ty_351"><span class="LIDENT">ty</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_f2_352"><span class="LIDENT">f2</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_f4_353"><span class="LIDENT">f4</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><a href="#local_ty11_345"><span class="LIDENT">ty11</span></a><span class="COMMA">,</span> <a href="#local_ty22_349"><span class="LIDENT">ty22</span></a><span class="COMMA">,</span> <span class="LIDENT">trans</span> <a href="#local_rest1_347"><span class="LIDENT">rest1</span></a> <a href="#local_rest2_350"><span class="LIDENT">rest2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Format_subst_ty</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span><span class="COMMA">,</span> <span class="UIDENT">End_of_fmtty</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">End_of_fmtty</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">End_of_fmtty</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-fmtty_of_formatting_gen"><span class="LIDENT">fmtty_of_formatting_gen</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-formatting_gen"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">formatting_gen</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_formatting_gen_354"><span class="LIDENT">formatting_gen</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_formatting_gen_354"><span class="LIDENT">formatting_gen</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_355"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_355"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_356"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_356"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Extract the type representation (an fmtty) of a format. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-fmtty_of_fmt"><span class="LIDENT">fmtty_of_fmt</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_fmtty_357"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmtty_357"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_358"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_359"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_358"><span class="LIDENT">pad</span></a> <span class="LPAREN">(</span><span class="UIDENT">String_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_359"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span id="local_pad_360"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_361"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_360"><span class="LIDENT">pad</span></a> <span class="LPAREN">(</span><span class="UIDENT">String_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_361"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_362"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_363"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_364"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_rest_365"><span class="LIDENT">ty_rest</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_364"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prec_ty_366"><span class="LIDENT">prec_ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_precision_fmtty</span> <a href="#local_prec_363"><span class="LIDENT">prec</span></a> <span class="LPAREN">(</span><span class="UIDENT">Int_ty</span> <a href="#local_ty_rest_365"><span class="LIDENT">ty_rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_362"><span class="LIDENT">pad</span></a> <a href="#local_prec_ty_366"><span class="LIDENT">prec_ty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_367"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_368"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_369"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_rest_370"><span class="LIDENT">ty_rest</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_369"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prec_ty_371"><span class="LIDENT">prec_ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_precision_fmtty</span> <a href="#local_prec_368"><span class="LIDENT">prec</span></a> <span class="LPAREN">(</span><span class="UIDENT">Int32_ty</span> <a href="#local_ty_rest_370"><span class="LIDENT">ty_rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_367"><span class="LIDENT">pad</span></a> <a href="#local_prec_ty_371"><span class="LIDENT">prec_ty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_372"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_373"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_374"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_rest_375"><span class="LIDENT">ty_rest</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_374"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prec_ty_376"><span class="LIDENT">prec_ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_precision_fmtty</span> <a href="#local_prec_373"><span class="LIDENT">prec</span></a> <span class="LPAREN">(</span><span class="UIDENT">Nativeint_ty</span> <a href="#local_ty_rest_375"><span class="LIDENT">ty_rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_372"><span class="LIDENT">pad</span></a> <a href="#local_prec_ty_376"><span class="LIDENT">prec_ty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_377"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_378"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_379"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_rest_380"><span class="LIDENT">ty_rest</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_379"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prec_ty_381"><span class="LIDENT">prec_ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_precision_fmtty</span> <a href="#local_prec_378"><span class="LIDENT">prec</span></a> <span class="LPAREN">(</span><span class="UIDENT">Int64_ty</span> <a href="#local_ty_rest_380"><span class="LIDENT">ty_rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_377"><span class="LIDENT">pad</span></a> <a href="#local_prec_ty_381"><span class="LIDENT">prec_ty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_382"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_383"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_384"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_rest_385"><span class="LIDENT">ty_rest</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_384"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prec_ty_386"><span class="LIDENT">prec_ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_precision_fmtty</span> <a href="#local_prec_383"><span class="LIDENT">prec</span></a> <span class="LPAREN">(</span><span class="UIDENT">Float_ty</span> <a href="#local_ty_rest_385"><span class="LIDENT">ty_rest</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_382"><span class="LIDENT">pad</span></a> <a href="#local_prec_ty_386"><span class="LIDENT">prec_ty</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_rest_387"><span class="LIDENT">rest</span></span>                  <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Char_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_387"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_rest_388"><span class="LIDENT">rest</span></span>             <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Char_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_388"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span id="local_pad_389"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_390"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>           <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">fmtty_of_padding_fmtty</span> <a href="#local_pad_389"><span class="LIDENT">pad</span></a> <span class="LPAREN">(</span><span class="UIDENT">Bool_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_390"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span id="local_rest_391"><span class="LIDENT">rest</span></span>                 <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Alpha_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_391"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span id="local_rest_392"><span class="LIDENT">rest</span></span>                 <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Theta_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_392"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom</span> <span class="LPAREN">(</span><span id="local_arity_393"><span class="LIDENT">arity</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_394"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_custom</span> <a href="#local_arity_393"><span class="LIDENT">arity</span></a> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_394"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span id="local_rest_395"><span class="LIDENT">rest</span></span>                <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Reader_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_395"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_ty_396"><span class="LIDENT">ty</span></span><span class="COMMA">,</span> <span id="local_rest_397"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><a href="#local_ty_396"><span class="LIDENT">ty</span></a><span class="COMMA">,</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_397"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_ty_398"><span class="LIDENT">ty</span></span><span class="COMMA">,</span> <span id="local_rest_399"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><a href="#local_ty_398"><span class="LIDENT">ty</span></a><span class="COMMA">,</span> <a href="#local_ty_398"><span class="LIDENT">ty</span></a><span class="COMMA">,</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_399"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_rest_400"><span class="LIDENT">rest</span></span>                 <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_400"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_401"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_401"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_402"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_402"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_403"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">String_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_403"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_404"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_404"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_next_char</span> <span id="local_rest_405"><span class="LIDENT">rest</span></span>        <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Char_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_405"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_406"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_407"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>  <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_ignored_format</span> <a href="#local_ign_406"><span class="LIDENT">ign</span></a> <a href="#local_rest_407"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_408"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_408"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span id="local_fmting_gen_409"><span class="LIDENT">fmting_gen</span></span><span class="COMMA">,</span> <span id="local_rest_410"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span>  <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#val-concat_fmtty"><span class="LIDENT">concat_fmtty</span></a> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_formatting_gen</span> <a href="#local_fmting_gen_409"><span class="LIDENT">fmting_gen</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_rest_410"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_format</span>              <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">End_of_fmtty</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-fmtty_of_custom"><span class="LIDENT">fmtty_of_custom</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-custom_arity"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">custom_arity</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_arity_411"><span class="LIDENT">arity</span></span> <span id="local_fmtty_412"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_arity_411"><span class="LIDENT">arity</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom_zero</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_fmtty_412"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom_succ</span> <span id="local_arity_413"><span class="LIDENT">arity</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Any_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_custom</span> <a href="#local_arity_413"><span class="LIDENT">arity</span></a> <a href="#local_fmtty_412"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Extract the fmtty of an ignored parameter followed by the rest of
   the format. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-fmtty_of_ignored_format"><span class="LIDENT">fmtty_of_ignored_format</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-ignored"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LIDENT">ignored</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_ign_414"><span class="LIDENT">ign</span></span> <span id="local_fmt_415"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_ign_414"><span class="LIDENT">ign</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_char</span>                    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_char</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_string</span> <span class="UNDERSCORE">_</span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_string</span> <span class="UNDERSCORE">_</span>           <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int32</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_nativeint</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int64</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_float</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_bool</span> <span class="UNDERSCORE">_</span>                  <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_arg</span> <span class="UNDERSCORE">_</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_fmtty_416"><span class="LIDENT">fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#val-concat_fmtty"><span class="LIDENT">concat_fmtty</span></a> <a href="#local_fmtty_416"><span class="LIDENT">fmtty</span></a> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader</span>                  <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ignored_reader_ty</span> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_char_set</span> <span class="UNDERSCORE">_</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_get_counter</span> <span class="UNDERSCORE">_</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_next_char</span>          <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt_415"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add an Int_ty node if padding is taken as an extra argument (ex: &quot;%*s&quot;). *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-fmtty_of_padding_fmtty"><span class="LIDENT">fmtty_of_padding_fmtty</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pad_417"><span class="LIDENT">pad</span></span> <span id="local_fmtty_418"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_417"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_padding</span>    <span class="MINUSGREATER">-&gt;</span> <a href="#local_fmtty_418"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_fmtty_418"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_ty</span> <a href="#local_fmtty_418"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add an Int_ty node if precision is taken as an extra argument (ex: &quot;%.*f&quot;).*)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-fmtty_of_precision_fmtty"><span class="LIDENT">fmtty_of_precision_fmtty</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_prec_419"><span class="LIDENT">prec</span></span> <span id="local_fmtty_420"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_prec_419"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_precision</span>    <span class="MINUSGREATER">-&gt;</span> <a href="#local_fmtty_420"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Lit_precision</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_fmtty_420"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Arg_precision</span>   <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_ty</span> <a href="#local_fmtty_420"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                            <span class="COMMENT">(* Format typing *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Exception raised when a format does not match a given format type. *)</span><span class="EOL">
</span><span id="exception-Type_mismatch"><span class="EXCEPTION">exception</span> <span class="UIDENT">Type_mismatch</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Type a padding. *)</span><span class="EOL">
</span><span class="COMMENT">(* Take an Int_ty from the fmtty if the integer should be kept as argument. *)</span><span class="EOL">
</span><span class="COMMENT">(* Raise Type_mismatch in case of type mismatch. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-type_padding"><span class="LIDENT">type_padding</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padding_fmtty_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_pad_421"><span class="LIDENT">pad</span></span> <span id="local_fmtty_422"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_421"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_fmtty_422"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">No_padding</span><span class="COMMA">,</span> <a href="#local_fmtty_422"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_423"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_424"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><a href="#local_padty_423"><span class="LIDENT">padty</span></a><span class="COMMA">,</span><a href="#local_w_424"><span class="LIDENT">w</span></a><span class="RPAREN">)</span><span class="COMMA">,</span><a href="#local_fmtty_422"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_425"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_426"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <a href="#local_padty_425"><span class="LIDENT">padty</span></a><span class="COMMA">,</span><a href="#local_rest_426"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a (upadding, uprecision) to a (padding, precision). *)</span><span class="EOL">
</span><span class="COMMENT">(* Take one or two Int_ty from the fmtty if needed. *)</span><span class="EOL">
</span><span class="COMMENT">(* Raise Type_mismatch in case of type mismatch. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-type_padprec"><span class="LIDENT">type_padprec</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="DOT">.</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">padprec_fmtty_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_pad_427"><span class="LIDENT">pad</span></span> <span id="local_prec_428"><span class="LIDENT">prec</span></span> <span id="local_fmtty_429"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_prec_428"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <span class="LIDENT">type_padding</span> <a href="#local_pad_427"><span class="LIDENT">pad</span></a> <a href="#local_fmtty_429"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_precision</span><span class="COMMA">,</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_430"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_431"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><a href="#local_pad_430"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <span class="UIDENT">No_precision</span><span class="COMMA">,</span> <a href="#local_rest_431"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_432"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_433"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_434"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><a href="#local_pad_433"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <a href="#local_p_432"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_rest_434"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_precision</span><span class="COMMA">,</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_435"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_436"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><a href="#local_pad_435"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span><span class="COMMA">,</span> <a href="#local_rest_436"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Type a format according to an fmtty. *)</span><span class="EOL">
</span><span class="COMMENT">(* If typing succeed, generate a copy of the format with the same
    type parameters as the fmtty. *)</span><span class="EOL">
</span><span class="COMMENT">(* Raise [Failure] with an error message in case of type mismatch. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-type_format"><span class="LIDENT">type_format</span></span> <span class="COLON">:</span><span class="EOL">
</span>  <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">b1</span> <span class="LIDENT">c1</span> <span class="LIDENT">d1</span> <span class="LIDENT">e1</span> <span class="LIDENT">f1</span><span class="EOL">
</span>       <span class="LIDENT">a2</span> <span class="LIDENT">b2</span> <span class="LIDENT">c2</span> <span class="LIDENT">d2</span> <span class="LIDENT">e2</span> <span class="LIDENT">f2</span>  <span class="DOT">.</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUN">fun</span> <span id="local_fmt_437"><span class="LIDENT">fmt</span></span> <span id="local_fmtty_438"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_437"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_438"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_439"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UIDENT">End_of_fmtty</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_fmt'_439"><span class="LIDENT">fmt'</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_format_gen"><span class="LIDENT">type_format_gen</span></span> <span class="COLON">:</span><span class="EOL">
</span>  <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">b1</span> <span class="LIDENT">c1</span> <span class="LIDENT">d1</span> <span class="LIDENT">e1</span> <span class="LIDENT">f1</span><span class="EOL">
</span>       <span class="LIDENT">a2</span> <span class="LIDENT">b2</span> <span class="LIDENT">c2</span> <span class="LIDENT">d2</span> <span class="LIDENT">e2</span> <span class="LIDENT">f2</span>  <span class="DOT">.</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUN">fun</span> <span id="local_fmt_440"><span class="LIDENT">fmt</span></span> <span id="local_fmtty_441"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmt_440"><span class="LIDENT">fmt</span></a><span class="COMMA">,</span> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_fmt_rest_442"><span class="LIDENT">fmt_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Char_ty</span> <span id="local_fmtty_rest_443"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_444"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_445"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_442"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_443"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char</span> <a href="#local_fmt'_444"><span class="LIDENT">fmt'</span></a><span class="COMMA">,</span> <a href="#local_fmtty'_445"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_fmt_rest_446"><span class="LIDENT">fmt_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Char_ty</span> <span id="local_fmtty_rest_447"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_448"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_449"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_446"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_447"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Caml_char</span> <a href="#local_fmt'_448"><span class="LIDENT">fmt'</span></a><span class="COMMA">,</span> <a href="#local_fmtty'_449"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_450"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_451"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padding</span> <a href="#local_pad_450"><span class="LIDENT">pad</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_452"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">String_ty</span> <span id="local_fmtty_rest_453"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_454"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_455"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_451"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_453"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">String</span> <span class="LPAREN">(</span><a href="#local_pad_452"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_fmt'_454"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_455"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span id="local_pad_456"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_457"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padding</span> <a href="#local_pad_456"><span class="LIDENT">pad</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_458"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">String_ty</span> <span id="local_fmtty_rest_459"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_460"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_461"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_457"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_459"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><a href="#local_pad_458"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_fmt'_460"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_461"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span id="local_iconv_462"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_463"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_464"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_465"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padprec</span> <a href="#local_pad_463"><span class="LIDENT">pad</span></a> <a href="#local_prec_464"><span class="LIDENT">prec</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_466"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_467"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span class="UIDENT">Int_ty</span> <span id="local_fmtty_rest_468"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_469"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_470"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_465"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_468"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int</span> <span class="LPAREN">(</span><a href="#local_iconv_462"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad_466"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_467"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_469"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_470"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span id="local_iconv_471"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_472"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_473"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_474"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padprec</span> <a href="#local_pad_472"><span class="LIDENT">pad</span></a> <a href="#local_prec_473"><span class="LIDENT">prec</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_475"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_476"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span class="UIDENT">Int32_ty</span> <span id="local_fmtty_rest_477"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_478"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_479"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_474"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_477"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int32</span> <span class="LPAREN">(</span><a href="#local_iconv_471"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad_475"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_476"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_478"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_479"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span id="local_iconv_480"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_481"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_482"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_483"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padprec</span> <a href="#local_pad_481"><span class="LIDENT">pad</span></a> <a href="#local_prec_482"><span class="LIDENT">prec</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_484"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_485"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_fmtty_rest_486"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_487"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_488"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_483"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_486"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><a href="#local_iconv_480"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad_484"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_485"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_487"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_488"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span id="local_iconv_489"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_490"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_491"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_492"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padprec</span> <a href="#local_pad_490"><span class="LIDENT">pad</span></a> <a href="#local_prec_491"><span class="LIDENT">prec</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_493"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_494"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span class="UIDENT">Int64_ty</span> <span id="local_fmtty_rest_495"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_496"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_497"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_492"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_495"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int64</span> <span class="LPAREN">(</span><a href="#local_iconv_489"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad_493"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_494"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_496"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_497"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span id="local_fconv_498"><span class="LIDENT">fconv</span></span><span class="COMMA">,</span> <span id="local_pad_499"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_500"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_501"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padprec</span> <a href="#local_pad_499"><span class="LIDENT">pad</span></a> <a href="#local_prec_500"><span class="LIDENT">prec</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_502"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_503"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span class="UIDENT">Float_ty</span> <span id="local_fmtty_rest_504"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_505"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_506"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_501"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_504"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Float</span> <span class="LPAREN">(</span><a href="#local_fconv_498"><span class="LIDENT">fconv</span></a><span class="COMMA">,</span> <a href="#local_pad_502"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_503"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_505"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_506"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padprec_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span id="local_pad_507"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_508"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <span class="LIDENT">type_padding</span> <a href="#local_pad_507"><span class="LIDENT">pad</span></a> <a href="#local_fmtty_441"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_pad_509"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">Bool_ty</span> <span id="local_fmtty_rest_510"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_511"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_512"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_508"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_510"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Bool</span> <span class="LPAREN">(</span><a href="#local_pad_509"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_fmt'_511"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_512"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Padding_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_fmt_rest_513"><span class="LIDENT">fmt_rest</span></span><span class="COMMA">,</span> <span id="local_fmtty_rest_514"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_515"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_516"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_513"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_514"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Flush</span> <a href="#local_fmt'_515"><span class="LIDENT">fmt'</span></a><span class="COMMA">,</span> <a href="#local_fmtty'_516"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span id="local_str_517"><span class="LIDENT">str</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_518"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_fmtty_rest_519"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_520"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_521"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_518"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_519"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><a href="#local_str_517"><span class="LIDENT">str</span></a><span class="COMMA">,</span> <a href="#local_fmt'_520"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_521"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span id="local_chr_522"><span class="LIDENT">chr</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_523"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_fmtty_rest_524"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_525"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_526"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_523"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_524"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><a href="#local_chr_522"><span class="LIDENT">chr</span></a><span class="COMMA">,</span> <a href="#local_fmt'_525"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_526"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span id="local_pad_opt_527"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_sub_fmtty_528"><span class="LIDENT">sub_fmtty</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_529"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_sub_fmtty'_530"><span class="LIDENT">sub_fmtty'</span></span><span class="COMMA">,</span> <span id="local_fmtty_rest_531"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Fmtty_EBB</span> <a href="#local_sub_fmtty_528"><span class="LIDENT">sub_fmtty</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Fmtty_EBB</span> <a href="#local_sub_fmtty'_530"><span class="LIDENT">sub_fmtty'</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_532"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_533"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_529"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_531"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><a href="#local_pad_opt_527"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_sub_fmtty'_530"><span class="LIDENT">sub_fmtty'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_532"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_533"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span id="local_pad_opt_534"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_sub_fmtty_535"><span class="LIDENT">sub_fmtty</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_536"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_sub_fmtty1_537"><span class="LIDENT">sub_fmtty1</span></span><span class="COMMA">,</span> <span id="local__sub_fmtty2_538"><span class="LIDENT">_sub_fmtty2</span></span><span class="COMMA">,</span> <span id="local_fmtty_rest_539"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Fmtty_EBB</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub_fmtty_535"><span class="LIDENT">sub_fmtty</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Fmtty_EBB</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub_fmtty1_537"><span class="LIDENT">sub_fmtty1</span></a><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_540"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_541"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_536"><span class="LIDENT">fmt_rest</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_fmtty_rest_539"><span class="LIDENT">fmtty_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><a href="#local_pad_opt_534"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_sub_fmtty1_537"><span class="LIDENT">sub_fmtty1</span></a><span class="COMMA">,</span> <a href="#local_fmt'_540"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_541"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="COMMENT">(* Printf and Format specific constructors: *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span id="local_fmt_rest_542"><span class="LIDENT">fmt_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Alpha_ty</span> <span id="local_fmtty_rest_543"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_544"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_545"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_542"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_543"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Alpha</span> <a href="#local_fmt'_544"><span class="LIDENT">fmt'</span></a><span class="COMMA">,</span> <a href="#local_fmtty'_545"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span id="local_fmt_rest_546"><span class="LIDENT">fmt_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Theta_ty</span> <span id="local_fmtty_rest_547"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_548"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_549"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_546"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_547"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Theta</span> <a href="#local_fmt'_548"><span class="LIDENT">fmt'</span></a><span class="COMMA">,</span> <a href="#local_fmtty'_549"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Format specific constructors: *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span id="local_formatting_lit_550"><span class="LIDENT">formatting_lit</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_551"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_fmtty_rest_552"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_553"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_554"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_551"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_552"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><a href="#local_formatting_lit_550"><span class="LIDENT">formatting_lit</span></a><span class="COMMA">,</span> <a href="#local_fmt'_553"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_554"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span id="local_formatting_gen_555"><span class="LIDENT">formatting_gen</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_556"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_fmtty_rest_557"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">type_formatting_gen</span> <a href="#local_formatting_gen_555"><span class="LIDENT">formatting_gen</span></a> <a href="#local_fmt_rest_556"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_557"><span class="LIDENT">fmtty_rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Scanf specific constructors: *)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span id="local_fmt_rest_558"><span class="LIDENT">fmt_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Reader_ty</span> <span id="local_fmtty_rest_559"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_560"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_561"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_558"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_559"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Reader</span> <a href="#local_fmt'_560"><span class="LIDENT">fmt'</span></a><span class="COMMA">,</span> <a href="#local_fmtty'_561"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span id="local_width_opt_562"><span class="LIDENT">width_opt</span></span><span class="COMMA">,</span> <span id="local_char_set_563"><span class="LIDENT">char_set</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_564"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">String_ty</span> <span id="local_fmtty_rest_565"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_566"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_567"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_564"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_565"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><a href="#local_width_opt_562"><span class="LIDENT">width_opt</span></a><span class="COMMA">,</span> <a href="#local_char_set_563"><span class="LIDENT">char_set</span></a><span class="COMMA">,</span> <a href="#local_fmt'_566"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_567"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span id="local_counter_568"><span class="LIDENT">counter</span></span><span class="COMMA">,</span> <span id="local_fmt_rest_569"><span class="LIDENT">fmt_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Int_ty</span> <span id="local_fmtty_rest_570"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_571"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_572"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_rest_569"><span class="LIDENT">fmt_rest</span></a> <a href="#local_fmtty_rest_570"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><a href="#local_counter_568"><span class="LIDENT">counter</span></a><span class="COMMA">,</span> <a href="#local_fmt'_571"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_572"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_573"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_574"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_fmtty_rest_575"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">type_ignored_param</span> <a href="#local_ign_573"><span class="LIDENT">ign</span></a> <a href="#local_rest_574"><span class="LIDENT">rest</span></a> <a href="#local_fmtty_rest_575"><span class="LIDENT">fmtty_rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_format</span><span class="COMMA">,</span> <span id="local_fmtty_rest_576"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">End_of_format</span><span class="COMMA">,</span> <a href="#local_fmtty_rest_576"><span class="LIDENT">fmtty_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_formatting_gen"><span class="LIDENT">type_formatting_gen</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">a3</span> <span class="LIDENT">b1</span> <span class="LIDENT">b3</span> <span class="LIDENT">c1</span> <span class="LIDENT">c3</span> <span class="LIDENT">d1</span> <span class="LIDENT">d3</span> <span class="LIDENT">e1</span> <span class="LIDENT">e2</span> <span class="LIDENT">e3</span> <span class="LIDENT">f1</span> <span class="LIDENT">f2</span> <span class="LIDENT">f3</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-formatting_gen"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="RPAREN">)</span> <span class="LIDENT">formatting_gen</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">f1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a3</span><span class="COMMA">,</span> <span class="LIDENT">b3</span><span class="COMMA">,</span> <span class="LIDENT">c3</span><span class="COMMA">,</span> <span class="LIDENT">d3</span><span class="COMMA">,</span> <span class="LIDENT">e3</span><span class="COMMA">,</span> <span class="LIDENT">f3</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LIDENT">a3</span><span class="COMMA">,</span> <span class="LIDENT">b3</span><span class="COMMA">,</span> <span class="LIDENT">c3</span><span class="COMMA">,</span> <span class="LIDENT">d3</span><span class="COMMA">,</span> <span class="LIDENT">e3</span><span class="COMMA">,</span> <span class="LIDENT">f3</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_formatting_gen_577"><span class="LIDENT">formatting_gen</span></span> <span id="local_fmt0_578"><span class="LIDENT">fmt0</span></span> <span id="local_fmtty0_579"><span class="LIDENT">fmtty0</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_formatting_gen_577"><span class="LIDENT">formatting_gen</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt1_580"><span class="LIDENT">fmt1</span></span><span class="COMMA">,</span> <span id="local_str_581"><span class="LIDENT">str</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt2_582"><span class="LIDENT">fmt2</span></span><span class="COMMA">,</span> <span id="local_fmtty2_583"><span class="LIDENT">fmtty2</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt1_580"><span class="LIDENT">fmt1</span></a> <a href="#local_fmtty0_579"><span class="LIDENT">fmtty0</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt3_584"><span class="LIDENT">fmt3</span></span><span class="COMMA">,</span> <span id="local_fmtty3_585"><span class="LIDENT">fmtty3</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt0_578"><span class="LIDENT">fmt0</span></a> <a href="#local_fmtty2_583"><span class="LIDENT">fmtty2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><a href="#local_fmt2_582"><span class="LIDENT">fmt2</span></a><span class="COMMA">,</span> <a href="#local_str_581"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmt3_584"><span class="LIDENT">fmt3</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty3_585"><span class="LIDENT">fmtty3</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt1_586"><span class="LIDENT">fmt1</span></span><span class="COMMA">,</span> <span id="local_str_587"><span class="LIDENT">str</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt2_588"><span class="LIDENT">fmt2</span></span><span class="COMMA">,</span> <span id="local_fmtty2_589"><span class="LIDENT">fmtty2</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt1_586"><span class="LIDENT">fmt1</span></a> <a href="#local_fmtty0_579"><span class="LIDENT">fmtty0</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt3_590"><span class="LIDENT">fmt3</span></span><span class="COMMA">,</span> <span id="local_fmtty3_591"><span class="LIDENT">fmtty3</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt0_578"><span class="LIDENT">fmt0</span></a> <a href="#local_fmtty2_589"><span class="LIDENT">fmtty2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><a href="#local_fmt2_588"><span class="LIDENT">fmt2</span></a><span class="COMMA">,</span> <a href="#local_str_587"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmt3_590"><span class="LIDENT">fmt3</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty3_591"><span class="LIDENT">fmtty3</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Type an Ignored_param node according to an fmtty. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_ignored_param"><span class="LIDENT">type_ignored_param</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">p</span> <span class="LIDENT">q</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">t</span> <span class="LIDENT">u</span> <span class="LIDENT">v</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-ignored"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span><span class="COMMA">,</span> <span class="LIDENT">t</span><span class="COMMA">,</span> <span class="LIDENT">q</span><span class="COMMA">,</span> <span class="LIDENT">p</span><span class="RPAREN">)</span> <span class="LIDENT">ignored</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">p</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span><span class="COMMA">,</span> <span class="LIDENT">q</span><span class="COMMA">,</span> <span class="LIDENT">u</span><span class="COMMA">,</span> <span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_ign_592"><span class="LIDENT">ign</span></span> <span id="local_fmt_593"><span class="LIDENT">fmt</span></span> <span id="local_fmtty_594"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_ign_592"><span class="LIDENT">ign</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_char</span>               <span class="AS">as</span> <span id="local_ign'_595"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_595"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_char</span>          <span class="AS">as</span> <span id="local_ign'_596"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_596"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_string</span> <span class="UNDERSCORE">_</span>           <span class="AS">as</span> <span id="local_ign'_597"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_597"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_string</span> <span class="UNDERSCORE">_</span>      <span class="AS">as</span> <span id="local_ign'_598"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_598"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int</span> <span class="UNDERSCORE">_</span>              <span class="AS">as</span> <span id="local_ign'_599"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_599"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int32</span> <span class="UNDERSCORE">_</span>            <span class="AS">as</span> <span id="local_ign'_600"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_600"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_nativeint</span> <span class="UNDERSCORE">_</span>        <span class="AS">as</span> <span id="local_ign'_601"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_601"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int64</span> <span class="UNDERSCORE">_</span>            <span class="AS">as</span> <span id="local_ign'_602"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_602"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_float</span> <span class="UNDERSCORE">_</span>            <span class="AS">as</span> <span id="local_ign'_603"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_603"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_bool</span> <span class="UNDERSCORE">_</span>             <span class="AS">as</span> <span id="local_ign'_604"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_604"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_char_set</span> <span class="UNDERSCORE">_</span>    <span class="AS">as</span> <span id="local_ign'_605"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_605"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_get_counter</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_ign'_606"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_606"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_next_char</span>     <span class="AS">as</span> <span id="local_ign'_607"><span class="LIDENT">ign'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">type_ignored_param_one</span> <a href="#local_ign'_607"><span class="LIDENT">ign'</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_arg</span> <span class="LPAREN">(</span><span id="local_pad_opt_608"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_sub_fmtty_609"><span class="LIDENT">sub_fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">type_ignored_param_one</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_format_arg</span> <span class="LPAREN">(</span><a href="#local_pad_opt_608"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_sub_fmtty_609"><span class="LIDENT">sub_fmtty</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><span id="local_pad_opt_610"><span class="LIDENT">pad_opt</span></span><span class="COMMA">,</span> <span id="local_sub_fmtty_611"><span class="LIDENT">sub_fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty'_612"><span class="LIDENT">sub_fmtty'</span></span><span class="COMMA">,</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_613"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_614"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_611"><span class="LIDENT">sub_fmtty</span></a> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><a href="#local_pad_opt_610"><span class="LIDENT">pad_opt</span></a><span class="COMMA">,</span> <a href="#local_sub_fmtty'_612"><span class="LIDENT">sub_fmtty'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>                                  <a href="#local_fmt'_613"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>                   <a href="#local_fmtty'_614"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_fmtty_594"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_fmtty_rest_615"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_616"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_617"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_593"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_615"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_reader</span><span class="COMMA">,</span> <a href="#local_fmt'_616"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_617"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span>  <span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_ignored_param_one"><span class="LIDENT">type_ignored_param_one</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">a2</span> <span class="LIDENT">b1</span> <span class="LIDENT">b2</span> <span class="LIDENT">c1</span> <span class="LIDENT">c2</span> <span class="LIDENT">d1</span> <span class="LIDENT">d2</span> <span class="LIDENT">e1</span> <span class="LIDENT">e2</span> <span class="LIDENT">f1</span> <span class="LIDENT">f2</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-ignored"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">a2</span><span class="RPAREN">)</span> <span class="LIDENT">ignored</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_fmtty_ebb</span><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUN">fun</span> <span id="local_ign_618"><span class="LIDENT">ign</span></span> <span id="local_fmt_619"><span class="LIDENT">fmt</span></span> <span id="local_fmtty_620"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span id="local_fmt'_621"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_fmtty'_622"><span class="LIDENT">fmtty'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_619"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_620"><span class="LIDENT">fmtty</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">Fmt_fmtty_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ign_618"><span class="LIDENT">ign</span></a><span class="COMMA">,</span> <a href="#local_fmt'_621"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmtty'_622"><span class="LIDENT">fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Typing of the complex case: &quot;%_(...%)&quot;. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_ignored_format_substitution"><span class="LIDENT">type_ignored_format_substitution</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">w</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">p</span> <span class="LIDENT">s</span> <span class="LIDENT">t</span> <span class="LIDENT">u</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">w</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span><span class="COMMA">,</span> <span class="LIDENT">s</span><span class="COMMA">,</span> <span class="LIDENT">p</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">p</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">s</span><span class="COMMA">,</span> <span class="LIDENT">t</span><span class="COMMA">,</span> <span class="LIDENT">u</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_sub_fmtty_623"><span class="LIDENT">sub_fmtty</span></span> <span id="local_fmt_624"><span class="LIDENT">fmt</span></span> <span id="local_fmtty_625"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_sub_fmtty_623"><span class="LIDENT">sub_fmtty</span></a><span class="COMMA">,</span> <a href="#local_fmtty_625"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_sub_fmtty_rest_626"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Char_ty</span> <span id="local_fmtty_rest_627"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_628"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_629"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_626"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_627"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char_ty</span> <a href="#local_sub_fmtty_rest'_628"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_629"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_sub_fmtty_rest_630"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">String_ty</span> <span id="local_fmtty_rest_631"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_632"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_633"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_630"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_631"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">String_ty</span> <a href="#local_sub_fmtty_rest'_632"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_633"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_sub_fmtty_rest_634"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Int_ty</span> <span id="local_fmtty_rest_635"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_636"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_637"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_634"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_635"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int_ty</span> <a href="#local_sub_fmtty_rest'_636"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_637"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_sub_fmtty_rest_638"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Int32_ty</span> <span id="local_fmtty_rest_639"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_640"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_641"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_638"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_639"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int32_ty</span> <a href="#local_sub_fmtty_rest'_640"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_641"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_sub_fmtty_rest_642"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_fmtty_rest_643"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_644"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_645"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_642"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_643"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Nativeint_ty</span> <a href="#local_sub_fmtty_rest'_644"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_645"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_sub_fmtty_rest_646"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Int64_ty</span> <span id="local_fmtty_rest_647"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_648"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_649"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_646"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_647"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int64_ty</span> <a href="#local_sub_fmtty_rest'_648"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_649"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_sub_fmtty_rest_650"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Float_ty</span> <span id="local_fmtty_rest_651"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_652"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_653"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_650"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_651"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Float_ty</span> <a href="#local_sub_fmtty_rest'_652"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_653"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_sub_fmtty_rest_654"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Bool_ty</span> <span id="local_fmtty_rest_655"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_656"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_657"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_654"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_655"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Bool_ty</span> <a href="#local_sub_fmtty_rest'_656"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_657"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_sub_fmtty_rest_658"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Alpha_ty</span> <span id="local_fmtty_rest_659"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_660"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_661"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_658"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_659"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Alpha_ty</span> <a href="#local_sub_fmtty_rest'_660"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_661"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_sub_fmtty_rest_662"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Theta_ty</span> <span id="local_fmtty_rest_663"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_664"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_665"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_662"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_663"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Theta_ty</span> <a href="#local_sub_fmtty_rest'_664"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_665"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span id="local_sub_fmtty_rest_666"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Reader_ty</span> <span id="local_fmtty_rest_667"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_668"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_669"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_666"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_667"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Reader_ty</span> <a href="#local_sub_fmtty_rest'_668"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_669"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_sub_fmtty_rest_670"><span class="LIDENT">sub_fmtty_rest</span></span><span class="COMMA">,</span> <span class="UIDENT">Ignored_reader_ty</span> <span id="local_fmtty_rest_671"><span class="LIDENT">fmtty_rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_672"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_673"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_670"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_671"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_reader_ty</span> <a href="#local_sub_fmtty_rest'_672"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="COMMA">,</span> <a href="#local_fmt'_673"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_sub2_fmtty_674"><span class="LIDENT">sub2_fmtty</span></span><span class="COMMA">,</span> <span id="local_sub_fmtty_rest_675"><span class="LIDENT">sub_fmtty_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span id="local_sub2_fmtty'_676"><span class="LIDENT">sub2_fmtty'</span></span><span class="COMMA">,</span> <span id="local_fmtty_rest_677"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Fmtty_EBB</span> <a href="#local_sub2_fmtty_674"><span class="LIDENT">sub2_fmtty</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Fmtty_EBB</span> <a href="#local_sub2_fmtty'_676"><span class="LIDENT">sub2_fmtty'</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_678"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_679"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <a href="#local_sub_fmtty_rest_675"><span class="LIDENT">sub_fmtty_rest</span></a> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_677"><span class="LIDENT">fmtty_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><a href="#local_sub2_fmtty'_676"><span class="LIDENT">sub2_fmtty'</span></a><span class="COMMA">,</span> <a href="#local_sub_fmtty_rest'_678"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmt'_679"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_sub1_fmtty_680"><span class="LIDENT">sub1_fmtty</span></span><span class="COMMA">,</span>  <span id="local_sub2_fmtty_681"><span class="LIDENT">sub2_fmtty</span></span><span class="COMMA">,</span>  <span id="local_sub_fmtty_rest_682"><span class="LIDENT">sub_fmtty_rest</span></span><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>    <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_sub1_fmtty'_683"><span class="LIDENT">sub1_fmtty'</span></span><span class="COMMA">,</span> <span id="local_sub2_fmtty'_684"><span class="LIDENT">sub2_fmtty'</span></span><span class="COMMA">,</span> <span id="local_fmtty_rest_685"><span class="LIDENT">fmtty_rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="COMMENT">(* TODO define Fmtty_rel_EBB to remove those erase_rel *)</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Fmtty_EBB</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub1_fmtty_680"><span class="LIDENT">sub1_fmtty</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Fmtty_EBB</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub1_fmtty'_683"><span class="LIDENT">sub1_fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <span class="UIDENT">Fmtty_EBB</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub2_fmtty_681"><span class="LIDENT">sub2_fmtty</span></a><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Fmtty_EBB</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub2_fmtty'_684"><span class="LIDENT">sub2_fmtty'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sub_fmtty'_686"><span class="LIDENT">sub_fmtty'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">trans</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_sub1_fmtty'_683"><span class="LIDENT">sub1_fmtty'</span></a><span class="RPAREN">)</span> <a href="#local_sub2_fmtty'_684"><span class="LIDENT">sub2_fmtty'</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1520"><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_f2_687"><span class="LIDENT">f2</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_f4_688"><span class="LIDENT">f4</span></span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_rel_det</span> <a href="#local_sub_fmtty'_686"><span class="LIDENT">sub_fmtty'</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_f2_687"><span class="LIDENT">f2</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Refl</span> <span class="EQUAL">=</span> <a href="#local_f4_688"><span class="LIDENT">f4</span></a> <span class="UIDENT">Refl</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_sub_fmtty_rest'_689"><span class="LIDENT">sub_fmtty_rest'</span></span><span class="COMMA">,</span> <span id="local_fmt'_690"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">type_ignored_format_substitution</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <a href="#local_sub_fmtty_rest_682"><span class="LIDENT">sub_fmtty_rest</span></a><span class="RPAREN">)</span> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_rest_685"><span class="LIDENT">fmtty_rest</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><a href="#local_sub1_fmtty'_683"><span class="LIDENT">sub1_fmtty'</span></a><span class="COMMA">,</span> <a href="#local_sub2_fmtty'_684"><span class="LIDENT">sub2_fmtty'</span></a><span class="COMMA">,</span><span class="EOL">
</span>                                    <span class="LIDENT">symm</span> <a href="#local_sub_fmtty_rest'_689"><span class="LIDENT">sub_fmtty_rest'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span><span class="EOL">
</span>                   <a href="#local_fmt'_690"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span><span class="COMMA">,</span> <span id="local_fmtty_691"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Fmtty_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">End_of_fmtty</span><span class="COMMA">,</span> <span class="LIDENT">type_format_gen</span> <a href="#local_fmt_624"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_691"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Type_mismatch</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* This implementation of `recast` is a bit disappointing. The
   invariant provided by the type are very strong: the input format's
   type is in relation to the output type's as witnessed by the
   fmtty_rel argument. One would at first expect this function to be
   total, and implementable by exhaustive pattern matching. Instead,
   we reuse the highly partial and much less well-defined function
   `type_format` that has lost all knowledge of the correspondence
   between the argument's types.

   Besides the fact that this function reuses a lot of the
   `type_format` logic (eg.: seeing Int_ty in the fmtty parameter does
   not let you match on Int only, as you may in fact have Float
   (Arg_padding, ...) (&quot;%.*d&quot;) beginning with an Int_ty), it is also
   a partial function, because the typing information in a format is
   not quite enough to reconstruct it unambiguously. For example, the
   format types of &quot;%d%_r&quot; and &quot;%_r%d&quot; have the same format6
   parameters, but they are not at all exchangeable, and putting one
   in place of the other must result in a dynamic failure.

   Given that:
   - we'd have to duplicate a lot of non-trivial typing logic from type_format
   - this wouldn't even eliminate (all) the dynamic failures
   we decided to just reuse type_format directly for now.
*)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-recast"><span class="LIDENT">recast</span></span> <span class="COLON">:</span><span class="EOL">
</span>  <span class="TYPE">type</span> <span class="LIDENT">a1</span> <span class="LIDENT">b1</span> <span class="LIDENT">c1</span> <span class="LIDENT">d1</span> <span class="LIDENT">e1</span> <span class="LIDENT">f1</span><span class="EOL">
</span>       <span class="LIDENT">a2</span> <span class="LIDENT">b2</span> <span class="LIDENT">c2</span> <span class="LIDENT">d2</span> <span class="LIDENT">e2</span> <span class="LIDENT">f2</span><span class="EOL">
</span>  <span class="DOT">.</span><span class="EOL">
</span>     <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmtty_rel"><span class="LPAREN">(</span><span class="LIDENT">a1</span><span class="COMMA">,</span> <span class="LIDENT">b1</span><span class="COMMA">,</span> <span class="LIDENT">c1</span><span class="COMMA">,</span> <span class="LIDENT">d1</span><span class="COMMA">,</span> <span class="LIDENT">e1</span><span class="COMMA">,</span> <span class="LIDENT">f1</span><span class="COMMA">,</span><span class="EOL">
</span>      <span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty_rel</span></a><span class="EOL">
</span>  <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a2</span><span class="COMMA">,</span> <span class="LIDENT">b2</span><span class="COMMA">,</span> <span class="LIDENT">c2</span><span class="COMMA">,</span> <span class="LIDENT">d2</span><span class="COMMA">,</span> <span class="LIDENT">e2</span><span class="COMMA">,</span> <span class="LIDENT">f2</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EQUAL">=</span> <span class="FUN">fun</span> <span id="local_fmt_692"><span class="LIDENT">fmt</span></span> <span id="local_fmtty_693"><span class="LIDENT">fmtty</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LIDENT">type_format</span> <a href="#local_fmt_692"><span class="LIDENT">fmt</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-erase_rel"><span class="LIDENT">erase_rel</span></a> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_fmtty_693"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                             <span class="COMMENT">(* Printing tools *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add padding spaces around a string. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fix_padding"><span class="LIDENT">fix_padding</span></span> <span id="local_padty_694"><span class="LIDENT">padty</span></span> <span id="local_width_695"><span class="LIDENT">width</span></span> <span id="local_str_696"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_697"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="def_1543"><span id="local_width_698"><span class="LIDENT">width</span></span><span class="COMMA">,</span> <span id="local_padty_699"><span class="LIDENT">padty</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="stdlib.ml.html#val-abs"><span class="LIDENT">abs</span></a> <a href="#local_width_695"><span class="LIDENT">width</span></a><span class="COMMA">,</span><span class="EOL">
</span>    <span class="COMMENT">(* while literal padding widths are always non-negative,
       dynamically-set widths (Arg_padding, eg. %*d) may be negative;
       we interpret those as specifying a padding-to-the-left; this
       means that '0' may get dropped even if it was explicitly set,
       but:
       - this is what the legacy implementation does, and
         we preserve compatibility if possible
       - we could only signal this issue by failing at runtime,
         which is not very nice... *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_width_695"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="UIDENT">Left</span> <span class="ELSE">else</span> <a href="#local_padty_694"><span class="LIDENT">padty</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_width_698"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(&lt;=)"><span class="INFIXOP0">&lt;=</span></a> <a href="#local_len_697"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_700"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_width_698"><span class="LIDENT">width</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_padty_699"><span class="LIDENT">padty</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="UIDENT">Zeros</span> <span class="THEN">then</span> <span class="CHAR">'0'</span> <span class="ELSE">else</span> <span class="CHAR">' '</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_padty_699"><span class="LIDENT">padty</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Left</span>  <span class="MINUSGREATER">-&gt;</span> <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="INT">0</span> <a href="#local_len_697"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Right</span> <span class="MINUSGREATER">-&gt;</span> <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_width_698"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_697"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="#local_len_697"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Zeros</span> <span class="WHEN">when</span> <a href="#local_len_697"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">0</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'+'</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'-'</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">' '</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="INT">0</span> <a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="INT">1</span> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_width_698"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_697"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_len_697"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Zeros</span> <span class="WHEN">when</span> <a href="#local_len_697"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'0'</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'x'</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'X'</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="INT">1</span> <a href="#local_str_696"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="INT">2</span> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_width_698"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_697"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_len_697"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Zeros</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_696"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_res_700"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_width_698"><span class="LIDENT">width</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_697"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="#local_len_697"><span class="LIDENT">len</span></a><span class="EOL">
</span>    <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_700"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Add '0' padding to int, int32, nativeint or int64 string representation. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fix_int_precision"><span class="LIDENT">fix_int_precision</span></span> <span id="local_prec_701"><span class="LIDENT">prec</span></span> <span id="local_str_702"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_prec_703"><span class="LIDENT">prec</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-abs"><span class="LIDENT">abs</span></a> <a href="#local_prec_701"><span class="LIDENT">prec</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_len_704"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_702"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_str_702"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">0</span><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'+'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="BAR">|</span> <span class="CHAR">' '</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_c_705"><span class="LIDENT">c</span></span> <span class="WHEN">when</span> <a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_706"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="CHAR">'0'</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_res_706"><span class="LIDENT">res</span></a> <span class="INT">0</span> <a href="#local_c_705"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_702"><span class="LIDENT">str</span></a> <span class="INT">1</span> <a href="#local_res_706"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_len_704"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_706"><span class="LIDENT">res</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="WHEN">when</span> <a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="LPAREN">(</span><a href="#local_str_702"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'x'</span> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_str_702"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'X'</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_707"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="CHAR">'0'</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_res_707"><span class="LIDENT">res</span></a> <span class="INT">1</span> <a href="#local_str_702"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><span class="INT">1</span><span class="RBRACKET">]</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_702"><span class="LIDENT">str</span></a> <span class="INT">2</span> <a href="#local_res_707"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">4</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_len_704"><span class="LIDENT">len</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_707"><span class="LIDENT">res</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'a'</span> <span class="DOTDOT">..</span> <span class="CHAR">'f'</span> <span class="BAR">|</span> <span class="CHAR">'A'</span> <span class="DOTDOT">..</span> <span class="CHAR">'F'</span> <span class="WHEN">when</span> <a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_res_708"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <a href="#local_prec_703"><span class="LIDENT">prec</span></a> <span class="CHAR">'0'</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="string.ml.html#val-blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">blit</span></a> <a href="#local_str_702"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_res_708"><span class="LIDENT">res</span></a> <span class="LPAREN">(</span><a href="#local_prec_703"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_len_704"><span class="LIDENT">len</span></a><span class="RPAREN">)</span> <a href="#local_len_704"><span class="LIDENT">len</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_708"><span class="LIDENT">res</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="#local_str_702"><span class="LIDENT">str</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Escape a string according to the OCaml lexing convention. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-string_to_caml_string"><span class="LIDENT">string_to_caml_string</span></span> <span id="local_str_709"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_710"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-escaped"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">escaped</span></a> <a href="#local_str_709"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_711"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_710"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_712"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="#local_l_711"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="CHAR">'\&quot;'</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="string.ml.html#val-unsafe_blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">unsafe_blit</span></a> <a href="#local_str_710"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_res_712"><span class="LIDENT">res</span></a> <span class="INT">1</span> <a href="#local_l_711"><span class="LIDENT">l</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_712"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Generate the format_int/int32/nativeint/int64 first argument
   from an int_conv. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_iconv"><span class="LIDENT">format_of_iconv</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_d</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%d&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+d&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_sd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% d&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_i</span> <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%i&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pi</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+i&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_si</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% i&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_x</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%x&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cx</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#x&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_X</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%X&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_CX</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#X&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_o</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%o&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Co</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#o&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_u</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%u&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_iconvL"><span class="LIDENT">format_of_iconvL</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_d</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%Ld&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+Ld&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_sd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% Ld&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_i</span> <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%Li&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pi</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+Li&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_si</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% Li&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_x</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%Lx&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cx</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#Lx&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_X</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%LX&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_CX</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#LX&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_o</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%Lo&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Co</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#Lo&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_u</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%Lu&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_iconvl"><span class="LIDENT">format_of_iconvl</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_d</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%ld&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+ld&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_sd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% ld&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_i</span> <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%li&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pi</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+li&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_si</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% li&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_x</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%lx&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cx</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#lx&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_X</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%lX&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_CX</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#lX&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_o</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%lo&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Co</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#lo&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_u</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%lu&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_iconvn"><span class="LIDENT">format_of_iconvn</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_d</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%nd&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+nd&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_sd</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% nd&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_i</span> <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%ni&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_pi</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%+ni&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_si</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;% ni&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_x</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%nx&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cx</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#nx&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_X</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%nX&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_CX</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#nX&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_o</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%no&quot;</span> <span class="BAR">|</span> <span class="UIDENT">Int_Co</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%#no&quot;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_u</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;%nu&quot;</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Generate the format_float first argument from a float_conv. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_fconv"><span class="LIDENT">format_of_fconv</span></span> <span id="local_fconv_713"><span class="LIDENT">fconv</span></span> <span id="local_prec_714"><span class="LIDENT">prec</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_prec_715"><span class="LIDENT">prec</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-abs"><span class="LIDENT">abs</span></a> <a href="#local_prec_714"><span class="LIDENT">prec</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_symb_716"><span class="LIDENT">symb</span></span> <span class="EQUAL">=</span> <span class="LIDENT">char_of_fconv</span> <span class="LABEL">~cF:</span><span class="CHAR">'g'</span> <a href="#local_fconv_713"><span class="LIDENT">fconv</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_buf_717"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">buffer_create</span> <span class="INT">16</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_717"><span class="LIDENT">buf</span></a> <span class="CHAR">'%'</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">bprint_fconv_flag</span> <a href="#local_buf_717"><span class="LIDENT">buf</span></a> <a href="#local_fconv_713"><span class="LIDENT">fconv</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_717"><span class="LIDENT">buf</span></a> <span class="CHAR">'.'</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_string</span> <a href="#local_buf_717"><span class="LIDENT">buf</span></a> <span class="LPAREN">(</span><a href="int.ml.html#val-to_string"><span class="UIDENT">Int</span><span class="DOT">.</span><span class="LIDENT">to_string</span></a> <a href="#local_prec_715"><span class="LIDENT">prec</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_add_char</span> <a href="#local_buf_717"><span class="LIDENT">buf</span></a> <a href="#local_symb_716"><span class="LIDENT">symb</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">buffer_contents</span> <a href="#local_buf_717"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-transform_int_alt"><span class="LIDENT">transform_int_alt</span></span> <span id="local_iconv_718"><span class="LIDENT">iconv</span></span> <span id="local_s_719"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_iconv_718"><span class="LIDENT">iconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_Cd</span> <span class="BAR">|</span> <span class="UIDENT">Int_Ci</span> <span class="BAR">|</span> <span class="UIDENT">Int_Cu</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_digits_720"><span class="LIDENT">digits</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_n_721"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_719"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="string.ml.html#val-unsafe_get"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_s_719"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'0'</span><span class="DOTDOT">..</span><span class="CHAR">'9'</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_n_721"><span class="LIDENT">n</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_n_721"><span class="LIDENT">n</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_buf_722"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-create"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_719"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="#local_digits_720"><span class="LIDENT">digits</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(/)"><span class="INFIXOP3">/</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_pos_723"><span class="LIDENT">pos</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_put_724"><span class="LIDENT">put</span></span> <span id="local_c_725"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-set"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">set</span></a> <a href="#local_buf_722"><span class="LIDENT">buf</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_pos_723"><span class="LIDENT">pos</span></a> <a href="#local_c_725"><span class="LIDENT">c</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-incr"><span class="LIDENT">incr</span></a> <a href="#local_pos_723"><span class="LIDENT">pos</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_left_726"><span class="LIDENT">left</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_digits_720"><span class="LIDENT">digits</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="stdlib.ml.html#val-(mod)"><span class="INFIXOP3">mod</span></a> <span class="INT">3</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <span class="INT">0</span> <span class="TO">to</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_s_719"><span class="LIDENT">s</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span> <span class="DO">do</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="string.ml.html#val-unsafe_get"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">unsafe_get</span></a> <a href="#local_s_719"><span class="LIDENT">s</span></a> <span class="LIDENT">i</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'0'</span><span class="DOTDOT">..</span><span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_727"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_left_726"><span class="LIDENT">left</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="INT">0</span> <span class="THEN">then</span> <span class="LPAREN">(</span><a href="#local_put_724"><span class="LIDENT">put</span></a> <span class="CHAR">'_'</span><span class="SEMI">;</span> <a href="#local_left_726"><span class="LIDENT">left</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="INT">3</span><span class="RPAREN">)</span><span class="SEMI">;</span> <a href="stdlib.ml.html#val-decr"><span class="LIDENT">decr</span></a> <a href="#local_left_726"><span class="LIDENT">left</span></a><span class="SEMI">;</span> <a href="#local_put_724"><span class="LIDENT">put</span></a> <a href="#local_c_727"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_728"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_put_724"><span class="LIDENT">put</span></a> <a href="#local_c_728"><span class="LIDENT">c</span></a><span class="EOL">
</span>    <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_buf_722"><span class="LIDENT">buf</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_s_719"><span class="LIDENT">s</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert an integer to a string according to a conversion. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-convert_int"><span class="LIDENT">convert_int</span></span> <span id="local_iconv_729"><span class="LIDENT">iconv</span></span> <span id="local_n_730"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">transform_int_alt</span> <a href="#local_iconv_729"><span class="LIDENT">iconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">format_int</span> <span class="LPAREN">(</span><span class="LIDENT">format_of_iconv</span> <a href="#local_iconv_729"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <a href="#local_n_730"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-convert_int32"><span class="LIDENT">convert_int32</span></span> <span id="local_iconv_731"><span class="LIDENT">iconv</span></span> <span id="local_n_732"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">transform_int_alt</span> <a href="#local_iconv_731"><span class="LIDENT">iconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">format_int32</span> <span class="LPAREN">(</span><span class="LIDENT">format_of_iconvl</span> <a href="#local_iconv_731"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <a href="#local_n_732"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-convert_nativeint"><span class="LIDENT">convert_nativeint</span></span> <span id="local_iconv_733"><span class="LIDENT">iconv</span></span> <span id="local_n_734"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">transform_int_alt</span> <a href="#local_iconv_733"><span class="LIDENT">iconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">format_nativeint</span> <span class="LPAREN">(</span><span class="LIDENT">format_of_iconvn</span> <a href="#local_iconv_733"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <a href="#local_n_734"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-convert_int64"><span class="LIDENT">convert_int64</span></span> <span id="local_iconv_735"><span class="LIDENT">iconv</span></span> <span id="local_n_736"><span class="LIDENT">n</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LIDENT">transform_int_alt</span> <a href="#local_iconv_735"><span class="LIDENT">iconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">format_int64</span> <span class="LPAREN">(</span><span class="LIDENT">format_of_iconvL</span> <a href="#local_iconv_735"><span class="LIDENT">iconv</span></a><span class="RPAREN">)</span> <a href="#local_n_736"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a float to string. *)</span><span class="EOL">
</span><span class="COMMENT">(* Fix special case of &quot;OCaml float format&quot;. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-convert_float"><span class="LIDENT">convert_float</span></span> <span id="local_fconv_737"><span class="LIDENT">fconv</span></span> <span id="local_prec_738"><span class="LIDENT">prec</span></span> <span id="local_x_739"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_hex_740"><span class="LIDENT">hex</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_sign_741"><span class="LIDENT">sign</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="stdlib.ml.html#val-fst"><span class="LIDENT">fst</span></a> <a href="#local_fconv_737"><span class="LIDENT">fconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Float_flag_p</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'+'</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Float_flag_s</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">' '</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="CHAR">'-'</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">hexstring_of_float</span> <a href="#local_x_739"><span class="LIDENT">x</span></a> <a href="#local_prec_738"><span class="LIDENT">prec</span></a> <a href="#local_sign_741"><span class="LIDENT">sign</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_add_dot_if_needed_742"><span class="LIDENT">add_dot_if_needed</span></span> <span id="local_str_743"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_744"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_743"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_is_valid_745"><span class="LIDENT">is_valid</span></span> <span id="local_i_746"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_i_746"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_744"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <span class="FALSE">false</span> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_str_743"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_746"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="BAR">|</span> <span class="CHAR">'e'</span> <span class="BAR">|</span> <span class="CHAR">'E'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_is_valid_745"><span class="LIDENT">is_valid</span></a> <span class="LPAREN">(</span><a href="#local_i_746"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_is_valid_745"><span class="LIDENT">is_valid</span></a> <span class="INT">0</span> <span class="THEN">then</span> <a href="#local_str_743"><span class="LIDENT">str</span></a> <span class="ELSE">else</span> <a href="#local_str_743"><span class="LIDENT">str</span></a> <a href="stdlib.ml.html#val-(^)"><span class="INFIXOP1">^</span></a> <span class="STRING">&quot;.&quot;</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_caml_special_val_747"><span class="LIDENT">caml_special_val</span></span> <span id="local_str_748"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="stdlib.ml.html#val-classify_float"><span class="LIDENT">classify_float</span></a> <a href="#local_x_739"><span class="LIDENT">x</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">FP_normal</span> <span class="BAR">|</span> <span class="UIDENT">FP_subnormal</span> <span class="BAR">|</span> <span class="UIDENT">FP_zero</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_748"><span class="LIDENT">str</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">FP_infinite</span> <span class="MINUSGREATER">-&gt;</span> <span class="IF">if</span> <a href="#local_x_739"><span class="LIDENT">x</span></a> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <span class="FLOAT">0.0</span> <span class="THEN">then</span> <span class="STRING">&quot;neg_infinity&quot;</span> <span class="ELSE">else</span> <span class="STRING">&quot;infinity&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">FP_nan</span> <span class="MINUSGREATER">-&gt;</span> <span class="STRING">&quot;nan&quot;</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="stdlib.ml.html#val-snd"><span class="LIDENT">snd</span></a> <a href="#local_fconv_737"><span class="LIDENT">fconv</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_h</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_hex_740"><span class="LIDENT">hex</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_H</span> <span class="MINUSGREATER">-&gt;</span> <a href="string.ml.html#val-uppercase_ascii"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">uppercase_ascii</span></a> <span class="LPAREN">(</span><a href="#local_hex_740"><span class="LIDENT">hex</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_CF</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_caml_special_val_747"><span class="LIDENT">caml_special_val</span></a> <span class="LPAREN">(</span><a href="#local_hex_740"><span class="LIDENT">hex</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_F</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_str_749"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">format_float</span> <span class="LPAREN">(</span><span class="LIDENT">format_of_fconv</span> <a href="#local_fconv_737"><span class="LIDENT">fconv</span></a> <a href="#local_prec_738"><span class="LIDENT">prec</span></a><span class="RPAREN">)</span> <a href="#local_x_739"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_caml_special_val_747"><span class="LIDENT">caml_special_val</span></a> <span class="LPAREN">(</span><a href="#local_add_dot_if_needed_742"><span class="LIDENT">add_dot_if_needed</span></a> <a href="#local_str_749"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_f</span> <span class="BAR">|</span> <span class="UIDENT">Float_e</span> <span class="BAR">|</span> <span class="UIDENT">Float_E</span> <span class="BAR">|</span> <span class="UIDENT">Float_g</span> <span class="BAR">|</span> <span class="UIDENT">Float_G</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">format_float</span> <span class="LPAREN">(</span><span class="LIDENT">format_of_fconv</span> <a href="#local_fconv_737"><span class="LIDENT">fconv</span></a> <a href="#local_prec_738"><span class="LIDENT">prec</span></a><span class="RPAREN">)</span> <a href="#local_x_739"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a char to a string according to the OCaml lexical convention. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_caml_char"><span class="LIDENT">format_caml_char</span></span> <span id="local_c_750"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_str_751"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="char.ml.html#val-escaped"><span class="UIDENT">Char</span><span class="DOT">.</span><span class="LIDENT">escaped</span></a> <a href="#local_c_750"><span class="LIDENT">c</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_l_752"><span class="LIDENT">l</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_751"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_753"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="bytes.ml.html#val-make"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">make</span></a> <span class="LPAREN">(</span><a href="#local_l_752"><span class="LIDENT">l</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="CHAR">'\''</span> <span class="IN">in</span><span class="EOL">
</span>  <a href="string.ml.html#val-unsafe_blit"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">unsafe_blit</span></a> <a href="#local_str_751"><span class="LIDENT">str</span></a> <span class="INT">0</span> <a href="#local_res_753"><span class="LIDENT">res</span></a> <span class="INT">1</span> <a href="#local_l_752"><span class="LIDENT">l</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <a href="bytes.ml.html#val-unsafe_to_string"><span class="UIDENT">Bytes</span><span class="DOT">.</span><span class="LIDENT">unsafe_to_string</span></a> <a href="#local_res_753"><span class="LIDENT">res</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a format type to string *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-string_of_fmtty"><span class="LIDENT">string_of_fmtty</span></span> <span id="local_fmtty_754"><span class="LIDENT">fmtty</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_755"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <span class="LIDENT">buffer_create</span> <span class="INT">16</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">bprint_fmtty</span> <a href="#local_buf_755"><span class="LIDENT">buf</span></a> <a href="#local_fmtty_754"><span class="LIDENT">fmtty</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="LIDENT">buffer_contents</span> <a href="#local_buf_755"><span class="LIDENT">buf</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                        <span class="COMMENT">(* Generic printing function *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Make a generic printing function. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used to generate Printf and Format printing functions. *)</span><span class="EOL">
</span><span class="COMMENT">(* Parameters:
     k: a continuation finally applied to the output stream and the accumulator.
     o: the output stream (see k, %a and %t).
     acc: rev list of printing entities (string, char, flush, formatting, ...).
     fmt: the format. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-make_printf"><span class="LIDENT">make_printf</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_756"><span class="LIDENT">k</span></span> <span id="local_acc_757"><span class="LIDENT">acc</span></span> <span id="local_fmt_758"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmt_758"><span class="LIDENT">fmt</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_rest_759"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_c_760"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_761"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_c_760"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_new_acc_761"><span class="LIDENT">new_acc</span></a> <a href="#local_rest_759"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_rest_762"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_c_763"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_764"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="LIDENT">format_caml_char</span> <a href="#local_c_763"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_new_acc_764"><span class="LIDENT">new_acc</span></a> <a href="#local_rest_762"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span id="local_pad_765"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_766"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_padding</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_766"><span class="LIDENT">rest</span></a> <a href="#local_pad_765"><span class="LIDENT">pad</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_str_767"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_767"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span id="local_pad_768"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_769"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_padding</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_769"><span class="LIDENT">rest</span></a> <a href="#local_pad_768"><span class="LIDENT">pad</span></a> <span class="LIDENT">string_to_caml_string</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span id="local_iconv_770"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_771"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_772"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_773"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_int_padding_precision</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_773"><span class="LIDENT">rest</span></a> <a href="#local_pad_771"><span class="LIDENT">pad</span></a> <a href="#local_prec_772"><span class="LIDENT">prec</span></a> <span class="LIDENT">convert_int</span> <a href="#local_iconv_770"><span class="LIDENT">iconv</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span id="local_iconv_774"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_775"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_776"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_777"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_int_padding_precision</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_777"><span class="LIDENT">rest</span></a> <a href="#local_pad_775"><span class="LIDENT">pad</span></a> <a href="#local_prec_776"><span class="LIDENT">prec</span></a> <span class="LIDENT">convert_int32</span> <a href="#local_iconv_774"><span class="LIDENT">iconv</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span id="local_iconv_778"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_779"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_780"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_781"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_int_padding_precision</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_781"><span class="LIDENT">rest</span></a> <a href="#local_pad_779"><span class="LIDENT">pad</span></a> <a href="#local_prec_780"><span class="LIDENT">prec</span></a> <span class="LIDENT">convert_nativeint</span> <a href="#local_iconv_778"><span class="LIDENT">iconv</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span id="local_iconv_782"><span class="LIDENT">iconv</span></span><span class="COMMA">,</span> <span id="local_pad_783"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_784"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_785"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_int_padding_precision</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_785"><span class="LIDENT">rest</span></a> <a href="#local_pad_783"><span class="LIDENT">pad</span></a> <a href="#local_prec_784"><span class="LIDENT">prec</span></a> <span class="LIDENT">convert_int64</span> <a href="#local_iconv_782"><span class="LIDENT">iconv</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span id="local_fconv_786"><span class="LIDENT">fconv</span></span><span class="COMMA">,</span> <span id="local_pad_787"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_788"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_789"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_float_padding_precision</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_789"><span class="LIDENT">rest</span></a> <a href="#local_pad_787"><span class="LIDENT">pad</span></a> <a href="#local_prec_788"><span class="LIDENT">prec</span></a> <a href="#local_fconv_786"><span class="LIDENT">fconv</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span id="local_pad_790"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_rest_791"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_padding</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_791"><span class="LIDENT">rest</span></a> <a href="#local_pad_790"><span class="LIDENT">pad</span></a> <a href="stdlib.ml.html#val-string_of_bool"><span class="LIDENT">string_of_bool</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span id="local_rest_792"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_f_793"><span class="LIDENT">f</span></span> <span id="local_x_794"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="FUN">fun</span> <span id="local_o_795"><span class="LIDENT">o</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_f_793"><span class="LIDENT">f</span></a> <a href="#local_o_795"><span class="LIDENT">o</span></a> <a href="#local_x_794"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_792"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span id="local_rest_796"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_f_797"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_f_797"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_796"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom</span> <span class="LPAREN">(</span><span id="local_arity_798"><span class="LIDENT">arity</span></span><span class="COMMA">,</span> <span id="local_f_799"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_rest_800"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_custom</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_rest_800"><span class="LIDENT">rest</span></a> <a href="#local_arity_798"><span class="LIDENT">arity</span></a> <span class="LPAREN">(</span><a href="#local_f_799"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="COMMENT">(* This case is impossible, by typing of formats. *)</span><span class="EOL">
</span>    <span class="COMMENT">(* Indeed, since printf and co. take a format4 as argument, the 'd and 'e
       type parameters of fmt are obviously equals. The Reader is the
       only constructor which touch 'd and 'e type parameters of the format
       type, it adds an (-&gt;) to the 'd parameters. Consequently, a format4
       cannot contain a Reader node, except in the sub-format associated to
       an %{...%}. It's not a problem because make_printf do not call
       itself recursively on the sub-format associated to %{...%}. *)</span><span class="EOL">
</span>    <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_rest_801"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_flush</span> <a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span> <a href="#local_rest_801"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span id="local_str_802"><span class="LIDENT">str</span></span><span class="COMMA">,</span> <span id="local_rest_803"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_802"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_803"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span id="local_chr_804"><span class="LIDENT">chr</span></span><span class="COMMA">,</span> <span id="local_rest_805"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_chr_804"><span class="LIDENT">chr</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_805"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_sub_fmtty_806"><span class="LIDENT">sub_fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_807"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_808"><span class="LIDENT">ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">string_of_fmtty</span> <a href="#local_sub_fmtty_806"><span class="LIDENT">sub_fmtty</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_str_809"><span class="LIDENT">str</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="stdlib.ml.html#val-ignore"><span class="LIDENT">ignore</span></a> <a href="#local_str_809"><span class="LIDENT">str</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_ty_808"><span class="LIDENT">ty</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_807"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_fmtty_810"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_811"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_812"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <span class="LPAREN">(</span><span class="LIDENT">recast</span> <a href="#local_fmt_812"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_810"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span> <a href="#local_rest_811"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_813"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_new_acc_814"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="STRING">&quot;Printf: bad conversion %[&quot;</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_new_acc_814"><span class="LIDENT">new_acc</span></a> <a href="#local_rest_813"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_815"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="COMMENT">(* This case should be refused for Printf. *)</span><span class="EOL">
</span>    <span class="COMMENT">(* Accepted for backward compatibility. *)</span><span class="EOL">
</span>    <span class="COMMENT">(* Interpret %l, %n and %L as %u. *)</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_n_816"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_817"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="LIDENT">format_int</span> <span class="STRING">&quot;%u&quot;</span> <a href="#local_n_816"><span class="LIDENT">n</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_new_acc_817"><span class="LIDENT">new_acc</span></a> <a href="#local_rest_815"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Scan_next_char</span> <span id="local_rest_818"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_c_819"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_820"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_c_819"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_new_acc_820"><span class="LIDENT">new_acc</span></a> <a href="#local_rest_818"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_821"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_822"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_ignored_param</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a> <a href="#local_ign_821"><span class="LIDENT">ign</span></a> <a href="#local_rest_822"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span id="local_fmting_lit_823"><span class="LIDENT">fmting_lit</span></span><span class="COMMA">,</span> <span id="local_rest_824"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_fmting_lit_823"><span class="LIDENT">fmting_lit</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_824"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_825"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_826"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k'_827"><span class="LIDENT">k'</span></span> <span id="local_kacc_828"><span class="LIDENT">kacc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="UIDENT">Acc_open_tag</span> <a href="#local_kacc_828"><span class="LIDENT">kacc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_826"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">make_printf</span> <a href="#local_k'_827"><span class="LIDENT">k'</span></a> <span class="UIDENT">End_of_acc</span> <a href="#local_fmt'_825"><span class="LIDENT">fmt'</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_829"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_830"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_k'_831"><span class="LIDENT">k'</span></span> <span id="local_kacc_832"><span class="LIDENT">kacc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_756"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="UIDENT">Acc_open_box</span> <a href="#local_kacc_832"><span class="LIDENT">kacc</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_830"><span class="LIDENT">rest</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">make_printf</span> <a href="#local_k'_831"><span class="LIDENT">k'</span></a> <span class="UIDENT">End_of_acc</span> <a href="#local_fmt'_829"><span class="LIDENT">fmt'</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_format</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="#local_k_756"><span class="LIDENT">k</span></a> <a href="#local_acc_757"><span class="LIDENT">acc</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Delay the error (Invalid_argument &quot;Printf: bad conversion %_&quot;). *)</span><span class="EOL">
</span><span class="COMMENT">(* Generate functions to take remaining arguments (after the &quot;%_&quot;). *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_ignored_param"><span class="LIDENT">make_ignored_param</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-ignored"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LIDENT">ignored</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_833"><span class="LIDENT">k</span></span> <span id="local_acc_834"><span class="LIDENT">acc</span></span> <span id="local_ign_835"><span class="LIDENT">ign</span></span> <span id="local_fmt_836"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_ign_835"><span class="LIDENT">ign</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_char</span>                    <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_char</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_string</span> <span class="UNDERSCORE">_</span>                <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_caml_string</span> <span class="UNDERSCORE">_</span>           <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int32</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_nativeint</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>        <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_int64</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_float</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_bool</span> <span class="UNDERSCORE">_</span>                  <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_arg</span> <span class="UNDERSCORE">_</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_fmtty_837"><span class="LIDENT">fmtty</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmtty_837"><span class="LIDENT">fmtty</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader</span>                  <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_char_set</span> <span class="UNDERSCORE">_</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_get_counter</span> <span class="UNDERSCORE">_</span>      <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_scan_next_char</span>          <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_833"><span class="LIDENT">k</span></a> <a href="#local_acc_834"><span class="LIDENT">acc</span></a> <a href="#local_fmt_836"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Special case of printf &quot;%_(&quot;. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_from_fmtty"><span class="LIDENT">make_from_fmtty</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmtty"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="RPAREN">)</span> <span class="LIDENT">fmtty</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_838"><span class="LIDENT">k</span></span> <span id="local_acc_839"><span class="LIDENT">acc</span></span> <span id="local_fmtty_840"><span class="LIDENT">fmtty</span></span> <span id="local_fmt_841"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmtty_840"><span class="LIDENT">fmtty</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Char_ty</span> <span id="local_rest_842"><span class="LIDENT">rest</span></span>            <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_842"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">String_ty</span> <span id="local_rest_843"><span class="LIDENT">rest</span></span>          <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_843"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int_ty</span> <span id="local_rest_844"><span class="LIDENT">rest</span></span>             <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_844"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int32_ty</span> <span id="local_rest_845"><span class="LIDENT">rest</span></span>           <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_845"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Nativeint_ty</span> <span id="local_rest_846"><span class="LIDENT">rest</span></span>       <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_846"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Int64_ty</span> <span id="local_rest_847"><span class="LIDENT">rest</span></span>           <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_847"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Float_ty</span> <span id="local_rest_848"><span class="LIDENT">rest</span></span>           <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_848"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Bool_ty</span> <span id="local_rest_849"><span class="LIDENT">rest</span></span>            <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_849"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alpha_ty</span> <span id="local_rest_850"><span class="LIDENT">rest</span></span>           <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_850"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Theta_ty</span> <span id="local_rest_851"><span class="LIDENT">rest</span></span>           <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_851"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any_ty</span> <span id="local_rest_852"><span class="LIDENT">rest</span></span>             <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_852"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Reader_ty</span> <span class="UNDERSCORE">_</span>             <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Ignored_reader_ty</span> <span class="UNDERSCORE">_</span>     <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_arg_ty</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_853"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_rest_853"><span class="LIDENT">rest</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_fmtty</span>            <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_invalid_arg</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Format_subst_ty</span> <span class="LPAREN">(</span><span id="local_ty1_854"><span class="LIDENT">ty1</span></span><span class="COMMA">,</span> <span id="local_ty2_855"><span class="LIDENT">ty2</span></span><span class="COMMA">,</span> <span id="local_rest_856"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_ty_857"><span class="LIDENT">ty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">trans</span> <span class="LPAREN">(</span><span class="LIDENT">symm</span> <a href="#local_ty1_854"><span class="LIDENT">ty1</span></a><span class="RPAREN">)</span> <a href="#local_ty2_855"><span class="LIDENT">ty2</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_from_fmtty</span> <a href="#local_k_838"><span class="LIDENT">k</span></a> <a href="#local_acc_839"><span class="LIDENT">acc</span></a> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmtty"><span class="LIDENT">concat_fmtty</span></a> <a href="#local_ty_857"><span class="LIDENT">ty</span></a> <a href="#local_rest_856"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_fmt_841"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Insert an Acc_invalid_arg in the accumulator and continue to generate
   closures to get the remaining arguments. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_invalid_arg"><span class="LIDENT">make_invalid_arg</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_k_858"><span class="LIDENT">k</span></span> <span id="local_acc_859"><span class="LIDENT">acc</span></span> <span id="local_fmt_860"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LIDENT">make_printf</span> <a href="#local_k_858"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><a href="#local_acc_859"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="STRING">&quot;Printf: bad conversion %_&quot;</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_860"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Fix padding, take it as an extra integer argument if needed. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_padding"><span class="LIDENT">make_padding</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">z</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">z</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">z</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">x</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_861"><span class="LIDENT">k</span></span> <span id="local_acc_862"><span class="LIDENT">acc</span></span> <span id="local_fmt_863"><span class="LIDENT">fmt</span></span> <span id="local_pad_864"><span class="LIDENT">pad</span></span> <span id="local_trans_865"><span class="LIDENT">trans</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_864"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_866"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_867"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_862"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_trans_865"><span class="LIDENT">trans</span></a> <a href="#local_x_866"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_861"><span class="LIDENT">k</span></a> <a href="#local_new_acc_867"><span class="LIDENT">new_acc</span></a> <a href="#local_fmt_863"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_868"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_width_869"><span class="LIDENT">width</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_870"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_871"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_862"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_868"><span class="LIDENT">padty</span></a> <a href="#local_width_869"><span class="LIDENT">width</span></a> <span class="LPAREN">(</span><a href="#local_trans_865"><span class="LIDENT">trans</span></a> <a href="#local_x_870"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_861"><span class="LIDENT">k</span></a> <a href="#local_new_acc_871"><span class="LIDENT">new_acc</span></a> <a href="#local_fmt_863"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_872"><span class="LIDENT">padty</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_873"><span class="LIDENT">w</span></span> <span id="local_x_874"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_875"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_862"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_872"><span class="LIDENT">padty</span></a> <a href="#local_w_873"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><a href="#local_trans_865"><span class="LIDENT">trans</span></a> <a href="#local_x_874"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_861"><span class="LIDENT">k</span></a> <a href="#local_new_acc_875"><span class="LIDENT">new_acc</span></a> <a href="#local_fmt_863"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Fix padding and precision for int, int32, nativeint or int64. *)</span><span class="EOL">
</span><span class="COMMENT">(* Take one or two extra integer arguments if needed. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_int_padding_precision"><span class="LIDENT">make_int_padding_precision</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#type-int_conv"><span class="LIDENT">int_conv</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">z</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-int_conv"><span class="LIDENT">int_conv</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">x</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_876"><span class="LIDENT">k</span></span> <span id="local_acc_877"><span class="LIDENT">acc</span></span> <span id="local_fmt_878"><span class="LIDENT">fmt</span></span> <span id="local_pad_879"><span class="LIDENT">pad</span></span> <span id="local_prec_880"><span class="LIDENT">prec</span></span> <span id="local_trans_881"><span class="LIDENT">trans</span></span> <span id="local_iconv_882"><span class="LIDENT">iconv</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_879"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_880"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_883"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_884"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_883"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_884"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_885"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_886"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_887"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_int_precision</span> <a href="#local_p_885"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_886"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_887"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_p_888"><span class="LIDENT">p</span></span> <span id="local_x_889"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_890"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_int_precision</span> <a href="#local_p_888"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_889"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_890"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_891"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_892"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_893"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_894"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_891"><span class="LIDENT">padty</span></a> <a href="#local_w_892"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_893"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_894"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_895"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_896"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_897"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_898"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_899"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_895"><span class="LIDENT">padty</span></a> <a href="#local_w_896"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">fix_int_precision</span> <a href="#local_p_897"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_898"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_899"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_900"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_901"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_p_902"><span class="LIDENT">p</span></span> <span id="local_x_903"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_904"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_900"><span class="LIDENT">padty</span></a> <a href="#local_w_901"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">fix_int_precision</span> <a href="#local_p_902"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_903"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_904"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_905"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_906"><span class="LIDENT">w</span></span> <span id="local_x_907"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_908"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_905"><span class="LIDENT">padty</span></a> <a href="#local_w_906"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_907"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_908"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_909"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_910"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_911"><span class="LIDENT">w</span></span> <span id="local_x_912"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_913"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_909"><span class="LIDENT">padty</span></a> <a href="#local_w_911"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">fix_int_precision</span> <a href="#local_p_910"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_912"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_913"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_914"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_915"><span class="LIDENT">w</span></span> <span id="local_p_916"><span class="LIDENT">p</span></span> <span id="local_x_917"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_918"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_914"><span class="LIDENT">padty</span></a> <a href="#local_w_915"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">fix_int_precision</span> <a href="#local_p_916"><span class="LIDENT">p</span></a> <span class="LPAREN">(</span><a href="#local_trans_881"><span class="LIDENT">trans</span></a> <a href="#local_iconv_882"><span class="LIDENT">iconv</span></a> <a href="#local_x_917"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_876"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_877"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_918"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_878"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a float, fix padding and precision if needed. *)</span><span class="EOL">
</span><span class="COMMENT">(* Take the float argument and one or two extra integer arguments if needed. *)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_float_padding_precision"><span class="LIDENT">make_float_padding_precision</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">float</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-float_conv"><span class="LIDENT">float_conv</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">x</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_919"><span class="LIDENT">k</span></span> <span id="local_acc_920"><span class="LIDENT">acc</span></span> <span id="local_fmt_921"><span class="LIDENT">fmt</span></span> <span id="local_pad_922"><span class="LIDENT">pad</span></span> <span id="local_prec_923"><span class="LIDENT">prec</span></span> <span id="local_fconv_924"><span class="LIDENT">fconv</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_922"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_923"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_925"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_926"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">default_float_precision</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a><span class="RPAREN">)</span> <a href="#local_x_925"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_926"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_927"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_928"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_929"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <a href="#local_p_927"><span class="LIDENT">p</span></a> <a href="#local_x_928"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_929"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_p_930"><span class="LIDENT">p</span></span> <span id="local_x_931"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_932"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <a href="#local_p_930"><span class="LIDENT">p</span></a> <a href="#local_x_931"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_932"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_933"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_934"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_935"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_936"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">default_float_precision</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a><span class="RPAREN">)</span> <a href="#local_x_935"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str'_937"><span class="LIDENT">str'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_933"><span class="LIDENT">padty</span></a> <a href="#local_w_934"><span class="LIDENT">w</span></a> <a href="#local_str_936"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str'_937"><span class="LIDENT">str'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_938"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_939"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_940"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_941"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_942"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_938"><span class="LIDENT">padty</span></a> <a href="#local_w_939"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <a href="#local_p_940"><span class="LIDENT">p</span></a> <a href="#local_x_941"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_942"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_padty_943"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span id="local_w_944"><span class="LIDENT">w</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_p_945"><span class="LIDENT">p</span></span> <span id="local_x_946"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_947"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_943"><span class="LIDENT">padty</span></a> <a href="#local_w_944"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <a href="#local_p_945"><span class="LIDENT">p</span></a> <a href="#local_x_946"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_947"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_948"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_949"><span class="LIDENT">w</span></span> <span id="local_x_950"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_951"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <span class="LPAREN">(</span><span class="LIDENT">default_float_precision</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a><span class="RPAREN">)</span> <a href="#local_x_950"><span class="LIDENT">x</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str'_952"><span class="LIDENT">str'</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_948"><span class="LIDENT">padty</span></a> <a href="#local_w_949"><span class="LIDENT">w</span></a> <a href="#local_str_951"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str'_952"><span class="LIDENT">str'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_953"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_954"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_955"><span class="LIDENT">w</span></span> <span id="local_x_956"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_957"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_953"><span class="LIDENT">padty</span></a> <a href="#local_w_955"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <a href="#local_p_954"><span class="LIDENT">p</span></a> <a href="#local_x_956"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_957"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_padty_958"><span class="LIDENT">padty</span></span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_w_959"><span class="LIDENT">w</span></span> <span id="local_p_960"><span class="LIDENT">p</span></span> <span id="local_x_961"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_str_962"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fix_padding</span> <a href="#local_padty_958"><span class="LIDENT">padty</span></a> <a href="#local_w_959"><span class="LIDENT">w</span></a> <span class="LPAREN">(</span><span class="LIDENT">convert_float</span> <a href="#local_fconv_924"><span class="LIDENT">fconv</span></a> <a href="#local_p_960"><span class="LIDENT">p</span></a> <a href="#local_x_961"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">make_printf</span> <a href="#local_k_919"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_920"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_str_962"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_921"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-make_custom"><span class="LIDENT">make_custom</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="RPAREN">)</span> <span class="LIDENT">acc</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-custom_arity"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">custom_arity</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">x</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">y</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_963"><span class="LIDENT">k</span></span> <span id="local_acc_964"><span class="LIDENT">acc</span></span> <span id="local_rest_965"><span class="LIDENT">rest</span></span> <span id="local_arity_966"><span class="LIDENT">arity</span></span> <span id="local_f_967"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_arity_966"><span class="LIDENT">arity</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom_zero</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_printf</span> <a href="#local_k_963"><span class="LIDENT">k</span></a> <span class="LPAREN">(</span><span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><a href="#local_acc_964"><span class="LIDENT">acc</span></a><span class="COMMA">,</span> <a href="#local_f_967"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_rest_965"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Custom_succ</span> <span id="local_arity_968"><span class="LIDENT">arity</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_x_969"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">make_custom</span> <a href="#local_k_963"><span class="LIDENT">k</span></a> <a href="#local_acc_964"><span class="LIDENT">acc</span></a> <a href="#local_rest_965"><span class="LIDENT">rest</span></a> <a href="#local_arity_968"><span class="LIDENT">arity</span></a> <span class="LPAREN">(</span><a href="#local_f_967"><span class="LIDENT">f</span></a> <a href="#local_x_969"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-const"><span class="LIDENT">const</span></span> <span id="local_x_970"><span class="LIDENT">x</span></span> <span class="UNDERSCORE">_</span> <span class="EQUAL">=</span> <a href="#local_x_970"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-make_iprintf"><span class="LIDENT">make_iprintf</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">state</span><span class="DOT">.</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_971"><span class="LIDENT">k</span></span> <span id="local_o_972"><span class="LIDENT">o</span></span> <span id="local_fmt_973"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_fmt_973"><span class="LIDENT">fmt</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Char</span> <span id="local_rest_974"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_974"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Caml_char</span> <span id="local_rest_975"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_975"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span id="local_rest_976"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_976"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_977"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_977"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">String</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_978"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_978"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span id="local_rest_979"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_979"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_980"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_980"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_981"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_981"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Int</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_982"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_983"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_984"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">fn_of_padding_precision</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_984"><span class="LIDENT">rest</span></a> <a href="#local_pad_982"><span class="LIDENT">pad</span></a> <a href="#local_prec_983"><span class="LIDENT">prec</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Int32</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_985"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_986"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_987"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">fn_of_padding_precision</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_987"><span class="LIDENT">rest</span></a> <a href="#local_pad_985"><span class="LIDENT">pad</span></a> <a href="#local_prec_986"><span class="LIDENT">prec</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_988"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_989"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_990"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">fn_of_padding_precision</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_990"><span class="LIDENT">rest</span></a> <a href="#local_pad_988"><span class="LIDENT">pad</span></a> <a href="#local_prec_989"><span class="LIDENT">prec</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Int64</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_991"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_992"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_993"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">fn_of_padding_precision</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_993"><span class="LIDENT">rest</span></a> <a href="#local_pad_991"><span class="LIDENT">pad</span></a> <a href="#local_prec_992"><span class="LIDENT">prec</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Float</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_pad_994"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span id="local_prec_995"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_rest_996"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">fn_of_padding_precision</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_996"><span class="LIDENT">rest</span></a> <a href="#local_pad_994"><span class="LIDENT">pad</span></a> <a href="#local_prec_995"><span class="LIDENT">prec</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span id="local_rest_997"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_997"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_998"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_998"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Bool</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_999"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_999"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Alpha</span> <span id="local_rest_1000"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1000"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Theta</span> <span id="local_rest_1001"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1001"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Custom</span> <span class="LPAREN">(</span><span id="local_arity_1002"><span class="LIDENT">arity</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1003"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">fn_of_custom_arity</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1003"><span class="LIDENT">rest</span></a> <a href="#local_arity_1002"><span class="LIDENT">arity</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Reader</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="COMMENT">(* This case is impossible, by typing of formats.  See the
           note in the corresponding case for make_printf. *)</span><span class="EOL">
</span>        <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Flush</span> <span id="local_rest_1004"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1004"><span class="LIDENT">rest</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1005"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1005"><span class="LIDENT">rest</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1006"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1006"><span class="LIDENT">rest</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1007"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1007"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_fmtty_1008"><span class="LIDENT">fmtty</span></span><span class="COMMA">,</span> <span id="local_rest_1009"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="FUN">fun</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_1010"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a><span class="EOL">
</span>            <span class="LPAREN">(</span><a href="camlinternalFormatBasics.ml.html#val-concat_fmt"><span class="LIDENT">concat_fmt</span></a> <span class="LPAREN">(</span><span class="LIDENT">recast</span> <a href="#local_fmt_1010"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_1008"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span> <a href="#local_rest_1009"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1011"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1011"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1012"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1012"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Scan_next_char</span> <span id="local_rest_1013"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1013"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span id="local_ign_1014"><span class="LIDENT">ign</span></span><span class="COMMA">,</span> <span id="local_rest_1015"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_ignored_param</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="UIDENT">End_of_acc</span><span class="RPAREN">)</span> <a href="#local_ign_1014"><span class="LIDENT">ign</span></a> <a href="#local_rest_1015"><span class="LIDENT">rest</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_rest_1016"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_rest_1016"><span class="LIDENT">rest</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_tag</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_1017"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_1018"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_koc_1019"><span class="LIDENT">koc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_koc_1019"><span class="LIDENT">koc</span></a> <a href="#local_rest_1018"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_fmt'_1017"><span class="LIDENT">fmt'</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><span class="UIDENT">Open_box</span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_1020"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span id="local_rest_1021"><span class="LIDENT">rest</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_koc_1022"><span class="LIDENT">koc</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">make_iprintf</span> <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_koc_1022"><span class="LIDENT">koc</span></a> <a href="#local_rest_1021"><span class="LIDENT">rest</span></a><span class="RPAREN">)</span> <a href="#local_o_972"><span class="LIDENT">o</span></a> <a href="#local_fmt'_1020"><span class="LIDENT">fmt'</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">End_of_format</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_k_971"><span class="LIDENT">k</span></a> <a href="#local_o_972"><span class="LIDENT">o</span></a><span class="EOL">
</span><span class="AND">and</span> <span id="val-fn_of_padding_precision"><span class="LIDENT">fn_of_padding_precision</span></span> <span class="COLON">:</span><span class="EOL">
</span>  <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">state</span><span class="DOT">.</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">y</span><span class="COMMA">,</span> <span class="LIDENT">z</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">x</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_1023"><span class="LIDENT">k</span></span> <span id="local_o_1024"><span class="LIDENT">o</span></span> <span id="local_fmt_1025"><span class="LIDENT">fmt</span></span> <span id="local_pad_1026"><span class="LIDENT">pad</span></span> <span id="local_prec_1027"><span class="LIDENT">prec</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_1026"><span class="LIDENT">pad</span></a><span class="COMMA">,</span> <a href="#local_prec_1027"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_padding</span>   <span class="COMMA">,</span> <span class="UIDENT">No_precision</span>    <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_padding</span>   <span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_padding</span>   <span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span>   <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span>    <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span>   <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span>    <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span>   <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">make_iprintf</span> <a href="#local_k_1023"><span class="LIDENT">k</span></a> <a href="#local_o_1024"><span class="LIDENT">o</span></a> <a href="#local_fmt_1025"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-fn_of_custom_arity"><span class="LIDENT">fn_of_custom_arity</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span> <span class="LIDENT">c</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="LIDENT">state</span><span class="DOT">.</span><span class="EOL">
</span>  <span class="LPAREN">(</span><span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LIDENT">state</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="COMMA">,</span> <span class="LIDENT">c</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-custom_arity"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">custom_arity</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">y</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_k_1028"><span class="LIDENT">k</span></span> <span id="local_o_1029"><span class="LIDENT">o</span></span> <span id="local_fmt_1030"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Custom_zero</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">make_iprintf</span> <a href="#local_k_1028"><span class="LIDENT">k</span></a> <a href="#local_o_1029"><span class="LIDENT">o</span></a> <a href="#local_fmt_1030"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Custom_succ</span> <span id="local_arity_1031"><span class="LIDENT">arity</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LIDENT">const</span> <span class="LPAREN">(</span><span class="LIDENT">fn_of_custom_arity</span> <a href="#local_k_1028"><span class="LIDENT">k</span></a> <a href="#local_o_1029"><span class="LIDENT">o</span></a> <a href="#local_fmt_1030"><span class="LIDENT">fmt</span></a> <a href="#local_arity_1031"><span class="LIDENT">arity</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                          <span class="COMMENT">(* Continuations for make_printf *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Recursively output an &quot;accumulator&quot; containing a reversed list of
   printing entities (string, char, flus, ...) in an output_stream. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used as a continuation of make_printf. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-output_acc"><span class="LIDENT">output_acc</span></span> <span id="local_o_1032"><span class="LIDENT">o</span></span> <span id="local_acc_1033"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_acc_1033"><span class="LIDENT">acc</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_1034"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_fmting_lit_1035"><span class="LIDENT">fmting_lit</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_1036"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">string_of_formatting_lit</span> <a href="#local_fmting_lit_1035"><span class="LIDENT">fmting_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1034"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-output_string"><span class="LIDENT">output_string</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_s_1036"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_1037"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_tag</span> <span id="local_acc'_1038"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1037"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-output_string"><span class="LIDENT">output_string</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <span class="STRING">&quot;@{&quot;</span><span class="SEMI">;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_acc'_1038"><span class="LIDENT">acc'</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_1039"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_box</span> <span id="local_acc'_1040"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1039"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-output_string"><span class="LIDENT">output_string</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <span class="STRING">&quot;@[&quot;</span><span class="SEMI">;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_acc'_1040"><span class="LIDENT">acc'</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span id="local_p_1041"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_1042"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span id="local_p_1043"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_1044"><span class="LIDENT">s</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1043"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-output_string"><span class="LIDENT">output_string</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_s_1044"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span id="local_p_1045"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_1046"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span id="local_p_1047"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_1048"><span class="LIDENT">c</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1047"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-output_char"><span class="LIDENT">output_char</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_c_1048"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><span id="local_p_1049"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_1050"><span class="LIDENT">f</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1049"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="#local_f_1050"><span class="LIDENT">f</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_flush</span> <span id="local_p_1051"><span class="LIDENT">p</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1051"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-flush"><span class="LIDENT">flush</span></a> <a href="#local_o_1032"><span class="LIDENT">o</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><span id="local_p_1052"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_msg_1053"><span class="LIDENT">msg</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">output_acc</span> <a href="#local_o_1032"><span class="LIDENT">o</span></a> <a href="#local_p_1052"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <a href="#local_msg_1053"><span class="LIDENT">msg</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_acc</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Recursively output an &quot;accumulator&quot; containing a reversed list of
   printing entities (string, char, flus, ...) in a buffer. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used as a continuation of make_printf. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-bufput_acc"><span class="LIDENT">bufput_acc</span></span> <span id="local_b_1054"><span class="LIDENT">b</span></span> <span id="local_acc_1055"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_acc_1055"><span class="LIDENT">acc</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_1056"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_fmting_lit_1057"><span class="LIDENT">fmting_lit</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_1058"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">string_of_formatting_lit</span> <a href="#local_fmting_lit_1057"><span class="LIDENT">fmting_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1056"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_s_1058"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_1059"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_tag</span> <span id="local_acc'_1060"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1059"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <span class="STRING">&quot;@{&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_acc'_1060"><span class="LIDENT">acc'</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_1061"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_box</span> <span id="local_acc'_1062"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1061"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <span class="STRING">&quot;@[&quot;</span><span class="SEMI">;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_acc'_1062"><span class="LIDENT">acc'</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span id="local_p_1063"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_1064"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span id="local_p_1065"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_1066"><span class="LIDENT">s</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1065"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_s_1066"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span id="local_p_1067"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_1068"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span id="local_p_1069"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_1070"><span class="LIDENT">c</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1069"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_char"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_char</span></a> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_c_1070"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><span id="local_p_1071"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_1072"><span class="LIDENT">f</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1071"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="#local_f_1072"><span class="LIDENT">f</span></a> <a href="#local_b_1054"><span class="LIDENT">b</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_flush</span> <span id="local_p_1073"><span class="LIDENT">p</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1073"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><span id="local_p_1074"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_msg_1075"><span class="LIDENT">msg</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bufput_acc</span> <a href="#local_b_1054"><span class="LIDENT">b</span></a> <a href="#local_p_1074"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <a href="#local_msg_1075"><span class="LIDENT">msg</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_acc</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Recursively output an &quot;accumulator&quot; containing a reversed list of
   printing entities (string, char, flus, ...) in a buffer. *)</span><span class="EOL">
</span><span class="COMMENT">(* Differ from bufput_acc by the interpretation of %a and %t. *)</span><span class="EOL">
</span><span class="COMMENT">(* Used as a continuation of make_printf. *)</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-strput_acc"><span class="LIDENT">strput_acc</span></span> <span id="local_b_1076"><span class="LIDENT">b</span></span> <span id="local_acc_1077"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_acc_1077"><span class="LIDENT">acc</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_lit</span> <span class="LPAREN">(</span><span id="local_p_1078"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_fmting_lit_1079"><span class="LIDENT">fmting_lit</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_s_1080"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LIDENT">string_of_formatting_lit</span> <a href="#local_fmting_lit_1079"><span class="LIDENT">fmting_lit</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1078"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_s_1080"><span class="LIDENT">s</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_1081"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_tag</span> <span id="local_acc'_1082"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1081"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <span class="STRING">&quot;@{&quot;</span><span class="SEMI">;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_acc'_1082"><span class="LIDENT">acc'</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_formatting_gen</span> <span class="LPAREN">(</span><span id="local_p_1083"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UIDENT">Acc_open_box</span> <span id="local_acc'_1084"><span class="LIDENT">acc'</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1083"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <span class="STRING">&quot;@[&quot;</span><span class="SEMI">;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_acc'_1084"><span class="LIDENT">acc'</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_string_literal</span> <span class="LPAREN">(</span><span id="local_p_1085"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_1086"><span class="LIDENT">s</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_string</span> <span class="LPAREN">(</span><span id="local_p_1087"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_s_1088"><span class="LIDENT">s</span></span><span class="RPAREN">)</span>   <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1087"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_s_1088"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_char_literal</span> <span class="LPAREN">(</span><span id="local_p_1089"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_1090"><span class="LIDENT">c</span></span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_data_char</span> <span class="LPAREN">(</span><span id="local_p_1091"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_c_1092"><span class="LIDENT">c</span></span><span class="RPAREN">)</span>     <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1091"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_char"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_char</span></a> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_c_1092"><span class="LIDENT">c</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_delay</span> <span class="LPAREN">(</span><span id="local_p_1093"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_f_1094"><span class="LIDENT">f</span></span><span class="RPAREN">)</span>         <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1093"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="buffer.ml.html#val-add_string"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">add_string</span></a> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <span class="LPAREN">(</span><a href="#local_f_1094"><span class="LIDENT">f</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_flush</span> <span id="local_p_1095"><span class="LIDENT">p</span></span>              <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1095"><span class="LIDENT">p</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Acc_invalid_arg</span> <span class="LPAREN">(</span><span id="local_p_1096"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_msg_1097"><span class="LIDENT">msg</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">strput_acc</span> <a href="#local_b_1076"><span class="LIDENT">b</span></a> <a href="#local_p_1096"><span class="LIDENT">p</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-invalid_arg"><span class="LIDENT">invalid_arg</span></a> <a href="#local_msg_1097"><span class="LIDENT">msg</span></a><span class="SEMI">;</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">End_of_acc</span>               <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                          <span class="COMMENT">(* Error management *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Raise [Failure] with a pretty-printed error message. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-failwith_message"><span class="LIDENT">failwith_message</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt_1098"><span class="LIDENT">fmt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_buf_1099"><span class="LIDENT">buf</span></span> <span class="EQUAL">=</span> <a href="buffer.ml.html#val-create"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">create</span></a> <span class="INT">256</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_k_1100"><span class="LIDENT">k</span></span> <span id="local_acc_1101"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span> <span class="LIDENT">strput_acc</span> <a href="#local_buf_1099"><span class="LIDENT">buf</span></a> <a href="#local_acc_1101"><span class="LIDENT">acc</span></a><span class="SEMI">;</span> <a href="stdlib.ml.html#val-failwith"><span class="failwith">failwith</span></a> <span class="LPAREN">(</span><a href="buffer.ml.html#val-contents"><span class="UIDENT">Buffer</span><span class="DOT">.</span><span class="LIDENT">contents</span></a> <a href="#local_buf_1099"><span class="LIDENT">buf</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LIDENT">make_printf</span> <a href="#local_k_1100"><span class="LIDENT">k</span></a> <span class="UIDENT">End_of_acc</span> <a href="#local_fmt_1098"><span class="LIDENT">fmt</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                            <span class="COMMENT">(* Formatting tools *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a string to an open block description (indent, block_type) *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-open_box_of_string"><span class="LIDENT">open_box_of_string</span></span> <span id="local_str_1102"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="IF">if</span> <a href="#local_str_1102"><span class="LIDENT">str</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="STRING">&quot;&quot;</span> <span class="THEN">then</span> <span class="LPAREN">(</span><span class="INT">0</span><span class="COMMA">,</span> <span class="UIDENT">Pp_box</span><span class="RPAREN">)</span> <span class="ELSE">else</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_len_1103"><span class="LIDENT">len</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_1102"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_invalid_box_1104"><span class="LIDENT">invalid_box</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">failwith_message</span> <span class="STRING">&quot;invalid box description %S&quot;</span> <a href="#local_str_1102"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_parse_spaces_1105"><span class="LIDENT">parse_spaces</span></span> <span id="local_i_1106"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_i_1106"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_1103"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="#local_i_1106"><span class="LIDENT">i</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_str_1102"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_i_1106"><span class="LIDENT">i</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="BAR">|</span> <span class="CHAR">'\t'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_spaces_1105"><span class="LIDENT">parse_spaces</span></a> <span class="LPAREN">(</span><a href="#local_i_1106"><span class="LIDENT">i</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_i_1106"><span class="LIDENT">i</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_parse_lword_1107"><span class="LIDENT">parse_lword</span></span> <span id="local_i_1108"><span class="LIDENT">i</span></span> <span id="local_j_1109"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_j_1109"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_1103"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="#local_j_1109"><span class="LIDENT">j</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_str_1102"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_j_1109"><span class="LIDENT">j</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'a'</span> <span class="DOTDOT">..</span> <span class="CHAR">'z'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_lword_1107"><span class="LIDENT">parse_lword</span></a> <a href="#local_i_1108"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_j_1109"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_j_1109"><span class="LIDENT">j</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_parse_int_1110"><span class="LIDENT">parse_int</span></span> <span id="local_i_1111"><span class="LIDENT">i</span></span> <span id="local_j_1112"><span class="LIDENT">j</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_j_1112"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_len_1103"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="#local_j_1112"><span class="LIDENT">j</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_str_1102"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_j_1112"><span class="LIDENT">j</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_int_1110"><span class="LIDENT">parse_int</span></a> <a href="#local_i_1111"><span class="LIDENT">i</span></a> <span class="LPAREN">(</span><a href="#local_j_1112"><span class="LIDENT">j</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_j_1112"><span class="LIDENT">j</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wstart_1113"><span class="LIDENT">wstart</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1105"><span class="LIDENT">parse_spaces</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_wend_1114"><span class="LIDENT">wend</span></span> <span class="EQUAL">=</span> <a href="#local_parse_lword_1107"><span class="LIDENT">parse_lword</span></a> <a href="#local_wstart_1113"><span class="LIDENT">wstart</span></a> <a href="#local_wstart_1113"><span class="LIDENT">wstart</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_box_name_1115"><span class="LIDENT">box_name</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1102"><span class="LIDENT">str</span></a> <a href="#local_wstart_1113"><span class="LIDENT">wstart</span></a> <span class="LPAREN">(</span><a href="#local_wend_1114"><span class="LIDENT">wend</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_wstart_1113"><span class="LIDENT">wstart</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nstart_1116"><span class="LIDENT">nstart</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1105"><span class="LIDENT">parse_spaces</span></a> <a href="#local_wend_1114"><span class="LIDENT">wend</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_nend_1117"><span class="LIDENT">nend</span></span> <span class="EQUAL">=</span> <a href="#local_parse_int_1110"><span class="LIDENT">parse_int</span></a> <a href="#local_nstart_1116"><span class="LIDENT">nstart</span></a> <a href="#local_nstart_1116"><span class="LIDENT">nstart</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_indent_1118"><span class="LIDENT">indent</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_nstart_1116"><span class="LIDENT">nstart</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_nend_1117"><span class="LIDENT">nend</span></a> <span class="THEN">then</span> <span class="INT">0</span> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="TRY">try</span> <a href="stdlib.ml.html#val-int_of_string"><span class="LIDENT">int_of_string</span></a> <span class="LPAREN">(</span><a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1102"><span class="LIDENT">str</span></a> <a href="#local_nstart_1116"><span class="LIDENT">nstart</span></a> <span class="LPAREN">(</span><a href="#local_nend_1117"><span class="LIDENT">nend</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_nstart_1116"><span class="LIDENT">nstart</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="WITH">with</span> <span class="UIDENT">Failure</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_invalid_box_1104"><span class="LIDENT">invalid_box</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_exp_end_1119"><span class="LIDENT">exp_end</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1105"><span class="LIDENT">parse_spaces</span></a> <a href="#local_nend_1117"><span class="LIDENT">nend</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_exp_end_1119"><span class="LIDENT">exp_end</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <a href="#local_len_1103"><span class="LIDENT">len</span></a> <span class="THEN">then</span> <a href="#local_invalid_box_1104"><span class="LIDENT">invalid_box</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_box_type_1120"><span class="LIDENT">box_type</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_box_name_1115"><span class="LIDENT">box_name</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="STRING">&quot;&quot;</span> <span class="BAR">|</span> <span class="STRING">&quot;b&quot;</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Pp_box</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="STRING">&quot;h&quot;</span>      <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Pp_hbox</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="STRING">&quot;v&quot;</span>      <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Pp_vbox</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="STRING">&quot;hv&quot;</span>     <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Pp_hvbox</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="STRING">&quot;hov&quot;</span>    <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Pp_hovbox</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span>        <span class="MINUSGREATER">-&gt;</span> <a href="#local_invalid_box_1104"><span class="LIDENT">invalid_box</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LPAREN">(</span><a href="#local_indent_1118"><span class="LIDENT">indent</span></a><span class="COMMA">,</span> <a href="#local_box_type_1120"><span class="LIDENT">box_type</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                            <span class="COMMENT">(* Parsing tools *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Create a padding_fmt_ebb from a padding and a format. *)</span><span class="EOL">
</span><span class="COMMENT">(* Copy the padding to disjoin the type parameters of argument and result. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_padding_fmt_ebb"><span class="LIDENT">make_padding_fmt_ebb</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">padding_fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_pad_1121"><span class="LIDENT">pad</span></span> <span id="local_fmt_1122"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_pad_1121"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span>         <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padding_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">No_padding</span><span class="COMMA">,</span> <a href="#local_fmt_1122"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_s_1123"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_w_1124"><span class="LIDENT">w</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padding_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><a href="#local_s_1123"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_w_1124"><span class="LIDENT">w</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmt_1122"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_s_1125"><span class="LIDENT">s</span></span>      <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padding_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <a href="#local_s_1125"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_fmt_1122"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Create a precision_fmt_ebb from a precision and a format. *)</span><span class="EOL">
</span><span class="COMMENT">(* Copy the precision to disjoin the type parameters of argument and result. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_precision_fmt_ebb"><span class="LIDENT">make_precision_fmt_ebb</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">precision_fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_prec_1126"><span class="LIDENT">prec</span></span> <span id="local_fmt_1127"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_prec_1126"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_precision</span>    <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Precision_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">No_precision</span><span class="COMMA">,</span> <a href="#local_fmt_1127"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_precision</span> <span id="local_p_1128"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Precision_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_precision</span> <a href="#local_p_1128"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_fmt_1127"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_precision</span>   <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Precision_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_precision</span><span class="COMMA">,</span> <a href="#local_fmt_1127"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Create a padprec_fmt_ebb from a padding, a precision and a format. *)</span><span class="EOL">
</span><span class="COMMENT">(* Copy the padding and the precision to disjoin type parameters of arguments
   and result. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-make_padprec_fmt_ebb"><span class="LIDENT">make_padprec_fmt_ebb</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">t</span> <span class="DOT">.</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">z</span><span class="COMMA">,</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">padprec_fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span><span class="FUN">fun</span> <span id="local_pad_1129"><span class="LIDENT">pad</span></span> <span id="local_prec_1130"><span class="LIDENT">prec</span></span> <span id="local_fmt_1131"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="UIDENT">Precision_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_prec_1132"><span class="LIDENT">prec</span></span><span class="COMMA">,</span> <span id="local_fmt'_1133"><span class="LIDENT">fmt'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LIDENT">make_precision_fmt_ebb</span> <a href="#local_prec_1130"><span class="LIDENT">prec</span></a> <a href="#local_fmt_1131"><span class="LIDENT">fmt</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_pad_1129"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">No_padding</span>         <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">No_padding</span><span class="COMMA">,</span> <a href="#local_prec_1132"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_1133"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span id="local_s_1134"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_w_1135"><span class="LIDENT">w</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><a href="#local_s_1134"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_w_1135"><span class="LIDENT">w</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_prec_1132"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_1133"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span id="local_s_1136"><span class="LIDENT">s</span></span>      <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <a href="#local_s_1136"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_prec_1132"><span class="LIDENT">prec</span></a><span class="COMMA">,</span> <a href="#local_fmt'_1133"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                             <span class="COMMENT">(* Format parsing *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Parse a string representing a format and create a fmt_ebb. *)</span><span class="EOL">
</span><span class="COMMENT">(* Raise [Failure] in case of invalid format. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-fmt_ebb_of_string"><span class="LIDENT">fmt_ebb_of_string</span></span> <span class="QUESTION">?</span><span id="local_legacy_behavior_1137"><span class="LIDENT">legacy_behavior</span></span> <span id="local_str_1138"><span class="LIDENT">str</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="COMMENT">(* Parameters naming convention:                                    *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - lit_start: start of the literal sequence.                    *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - str_ind: current index in the string.                        *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - end_ind: end of the current (sub-)format.                    *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - pct_ind: index of the '%' in the current micro-format.       *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - zero:  is the '0' flag defined in the current micro-format.  *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - minus: is the '-' flag defined in the current micro-format.  *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - plus:  is the '+' flag defined in the current micro-format.  *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - hash:  is the '#' flag defined in the current micro-format.  *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - space: is the ' ' flag defined in the current micro-format.  *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - ign:   is the '_' flag defined in the current micro-format.  *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - pad: padding of the current micro-format.                    *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - prec: precision of the current micro-format.                 *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - symb: char representing the conversion ('c', 's', 'd', ...). *)</span><span class="EOL">
</span>  <span class="COMMENT">(*   - char_set: set of characters as bitmap (see scanf %[...]).    *)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_legacy_behavior_1137"><span class="LIDENT">legacy_behavior</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_flag_1140"><span class="LIDENT">flag</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_flag_1140"><span class="LIDENT">flag</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>  <span class="COMMENT">(*  When this flag is enabled, the format parser tries to behave as
      the &lt;4.02 implementations, in particular it ignores most benign
      nonsensical formats. When the flag is disabled, it will reject any
      format that is not accepted by the specification.

      A typical example would be &quot;%+ d&quot;: specifying both '+' (if the
      number is positive, pad with a '+' to get the same width as
      negative numbers) and ' ' (if the number is positive, pad with
      a space) does not make sense, but the legacy (&lt; 4.02)
      implementation was happy to just ignore the space.
  *)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Raise [Failure] with a friendly error message. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_invalid_format_message_1141"><span class="LIDENT">invalid_format_message</span></span> <span id="local_str_ind_1142"><span class="LIDENT">str_ind</span></span> <span id="local_msg_1143"><span class="LIDENT">msg</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">failwith_message</span><span class="EOL">
</span>      <span class="STRING">&quot;invalid format %S: at character number %d, %s&quot;</span><span class="EOL">
</span>      <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_str_ind_1142"><span class="LIDENT">str_ind</span></a> <a href="#local_msg_1143"><span class="LIDENT">msg</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Used when the end of the format (or the current sub-format) was encountered
      unexpectedly. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></span> <span id="local_end_ind_1145"><span class="LIDENT">end_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_invalid_format_message_1141"><span class="LIDENT">invalid_format_message</span></a> <a href="#local_end_ind_1145"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="STRING">&quot;unexpected end of format&quot;</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Used for %0c: no other widths are implemented *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_invalid_nonnull_char_width_1146"><span class="LIDENT">invalid_nonnull_char_width</span></span> <span id="local_str_ind_1147"><span class="LIDENT">str_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <a href="#local_invalid_format_message_1141"><span class="LIDENT">invalid_format_message</span></a> <a href="#local_str_ind_1147"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>      <span class="STRING">&quot;non-zero widths are unsupported for %c conversions&quot;</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="COMMENT">(* Raise [Failure] with a friendly error message about an option dependency
     problem. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_invalid_format_without_1148"><span class="LIDENT">invalid_format_without</span></span> <span id="local_str_ind_1149"><span class="LIDENT">str_ind</span></span> <span id="local_c_1150"><span class="LIDENT">c</span></span> <span id="local_s_1151"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">failwith_message</span><span class="EOL">
</span>      <span class="STRING">&quot;invalid format %S: at character number %d, '%c' without %s&quot;</span><span class="EOL">
</span>      <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_str_ind_1149"><span class="LIDENT">str_ind</span></a> <a href="#local_c_1150"><span class="LIDENT">c</span></a> <a href="#local_s_1151"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Raise [Failure] with a friendly error message about an unexpected
     character. *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_expected_character_1152"><span class="LIDENT">expected_character</span></span> <span id="local_str_ind_1153"><span class="LIDENT">str_ind</span></span> <span id="local_expected_1154"><span class="LIDENT">expected</span></span> <span id="local_read_1155"><span class="LIDENT">read</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LIDENT">failwith_message</span><span class="EOL">
</span>     <span class="STRING">&quot;invalid format %S: at character number %d, %s expected, read %C&quot;</span><span class="EOL">
</span>      <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_str_ind_1153"><span class="LIDENT">str_ind</span></a> <a href="#local_expected_1154"><span class="LIDENT">expected</span></a> <a href="#local_read_1155"><span class="LIDENT">read</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Parse the string from beg_ind (included) to end_ind (excluded). *)</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_parse_1156"><span class="LIDENT">parse</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_beg_ind_1157"><span class="LIDENT">beg_ind</span></span> <span id="local_end_ind_1158"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_literal_1159"><span class="LIDENT">parse_literal</span></a> <a href="#local_beg_ind_1157"><span class="LIDENT">beg_ind</span></a> <a href="#local_beg_ind_1157"><span class="LIDENT">beg_ind</span></a> <a href="#local_end_ind_1158"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Read literal characters up to '%' or '@' special characters. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_literal_1159"><span class="LIDENT">parse_literal</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_lit_start_1160"><span class="LIDENT">lit_start</span></span> <span id="local_str_ind_1161"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1162"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1162"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_add_literal_1473"><span class="LIDENT">add_literal</span></a> <a href="#local_lit_start_1160"><span class="LIDENT">lit_start</span></a> <a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <span class="UIDENT">End_of_format</span> <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1163"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_format_1165"><span class="LIDENT">parse_format</span></a> <a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1162"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_add_literal_1473"><span class="LIDENT">add_literal</span></a> <a href="#local_lit_start_1160"><span class="LIDENT">lit_start</span></a> <a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <a href="#local_fmt_rest_1163"><span class="LIDENT">fmt_rest</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'@'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1164"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_after_at_1368"><span class="LIDENT">parse_after_at</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1162"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_add_literal_1473"><span class="LIDENT">add_literal</span></a> <a href="#local_lit_start_1160"><span class="LIDENT">lit_start</span></a> <a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <a href="#local_fmt_rest_1164"><span class="LIDENT">fmt_rest</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_literal_1159"><span class="LIDENT">parse_literal</span></a> <a href="#local_lit_start_1160"><span class="LIDENT">lit_start</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1161"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1162"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Parse a format after '%' *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_format_1165"><span class="LIDENT">parse_format</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1166"><span class="LIDENT">pct_ind</span></span> <span id="local_end_ind_1167"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_ign_1168"><span class="LIDENT">parse_ign</span></a> <a href="#local_pct_ind_1166"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_pct_ind_1166"><span class="LIDENT">pct_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1167"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_ign_1168"><span class="LIDENT">parse_ign</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1169"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1170"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1171"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1170"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1171"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1171"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1170"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'_'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_flags_1172"><span class="LIDENT">parse_flags</span></a> <a href="#local_pct_ind_1169"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1170"><span class="LIDENT">str_ind</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1171"><span class="LIDENT">end_ind</span></a> <span class="TRUE">true</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_flags_1172"><span class="LIDENT">parse_flags</span></a> <a href="#local_pct_ind_1169"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1170"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1171"><span class="LIDENT">end_ind</span></a> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_flags_1172"><span class="LIDENT">parse_flags</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span><span class="EOL">
</span>  <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1173"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1174"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1175"><span class="LIDENT">end_ind</span></span> <span id="local_ign_1176"><span class="LIDENT">ign</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_zero_1177"><span class="LIDENT">zero</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="AND">and</span> <span id="local_minus_1178"><span class="LIDENT">minus</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_plus_1179"><span class="LIDENT">plus</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="AND">and</span> <span id="local_space_1180"><span class="LIDENT">space</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_hash_1181"><span class="LIDENT">hash</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_set_flag_1182"><span class="LIDENT">set_flag</span></span> <span id="local_str_ind_1183"><span class="LIDENT">str_ind</span></span> <span id="local_flag_1184"><span class="LIDENT">flag</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* in legacy mode, duplicate flags are accepted *)</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_flag_1184"><span class="LIDENT">flag</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LIDENT">failwith_message</span><span class="EOL">
</span>          <span class="STRING">&quot;invalid format %S: at character number %d, duplicate flag %C&quot;</span><span class="EOL">
</span>          <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_str_ind_1183"><span class="LIDENT">str_ind</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1183"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span><span class="SEMI">;</span><span class="EOL">
</span>      <a href="#local_flag_1184"><span class="LIDENT">flag</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_read_flags_1185"><span class="LIDENT">read_flags</span></span> <span id="local_str_ind_1186"><span class="LIDENT">str_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1175"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1175"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_set_flag_1182"><span class="LIDENT">set_flag</span></a> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="#local_zero_1177"><span class="LIDENT">zero</span></a><span class="SEMI">;</span>  <a href="#local_read_flags_1185"><span class="LIDENT">read_flags</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_set_flag_1182"><span class="LIDENT">set_flag</span></a> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="#local_minus_1178"><span class="LIDENT">minus</span></a><span class="SEMI">;</span> <a href="#local_read_flags_1185"><span class="LIDENT">read_flags</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'+'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_set_flag_1182"><span class="LIDENT">set_flag</span></a> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="#local_plus_1179"><span class="LIDENT">plus</span></a><span class="SEMI">;</span>  <a href="#local_read_flags_1185"><span class="LIDENT">read_flags</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'#'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_set_flag_1182"><span class="LIDENT">set_flag</span></a> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="#local_hash_1181"><span class="LIDENT">hash</span></a><span class="SEMI">;</span> <a href="#local_read_flags_1185"><span class="LIDENT">read_flags</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_set_flag_1182"><span class="LIDENT">set_flag</span></a> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="#local_space_1180"><span class="LIDENT">space</span></a><span class="SEMI">;</span> <a href="#local_read_flags_1185"><span class="LIDENT">read_flags</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_padding_1187"><span class="LIDENT">parse_padding</span></a> <a href="#local_pct_ind_1173"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1186"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1175"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>          <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_zero_1177"><span class="LIDENT">zero</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_minus_1178"><span class="LIDENT">minus</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_plus_1179"><span class="LIDENT">plus</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_1181"><span class="LIDENT">hash</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_space_1180"><span class="LIDENT">space</span></a> <a href="#local_ign_1176"><span class="LIDENT">ign</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_read_flags_1185"><span class="LIDENT">read_flags</span></a> <a href="#local_str_ind_1174"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Try to read a digital or a '*' padding. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_padding_1187"><span class="LIDENT">parse_padding</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1188"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1189"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1190"><span class="LIDENT">end_ind</span></span> <span id="local_zero_1191"><span class="LIDENT">zero</span></span> <span id="local_minus_1192"><span class="LIDENT">minus</span></span> <span id="local_plus_1193"><span class="LIDENT">plus</span></span> <span id="local_hash_1194"><span class="LIDENT">hash</span></span> <span id="local_space_1195"><span class="LIDENT">space</span></span> <span id="local_ign_1196"><span class="LIDENT">ign</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_padty_1197"><span class="LIDENT">padty</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_zero_1191"><span class="LIDENT">zero</span></a><span class="COMMA">,</span> <a href="#local_minus_1192"><span class="LIDENT">minus</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Right</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="TRUE">true</span>  <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Left</span><span class="EOL">
</span>      <span class="BAR">|</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Zeros</span><span class="EOL">
</span>      <span class="BAR">|</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="TRUE">true</span>  <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Left</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1188"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <span class="CHAR">'-'</span> <span class="STRING">&quot;0&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1528"><span id="local_new_ind_1198"><span class="LIDENT">new_ind</span></span><span class="COMMA">,</span> <span id="local_width_1199"><span class="LIDENT">width</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_positive_1461"><span class="LIDENT">parse_positive</span></a> <a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_parse_after_padding_1200"><span class="LIDENT">parse_after_padding</span></a> <a href="#local_pct_ind_1188"><span class="LIDENT">pct_ind</span></a> <a href="#local_new_ind_1198"><span class="LIDENT">new_ind</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1192"><span class="LIDENT">minus</span></a> <a href="#local_plus_1193"><span class="LIDENT">plus</span></a> <a href="#local_hash_1194"><span class="LIDENT">hash</span></a> <a href="#local_space_1195"><span class="LIDENT">space</span></a> <a href="#local_ign_1196"><span class="LIDENT">ign</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><a href="#local_padty_1197"><span class="LIDENT">padty</span></a><span class="COMMA">,</span> <a href="#local_width_1199"><span class="LIDENT">width</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'*'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_parse_after_padding_1200"><span class="LIDENT">parse_after_padding</span></a> <a href="#local_pct_ind_1188"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1192"><span class="LIDENT">minus</span></a> <a href="#local_plus_1193"><span class="LIDENT">plus</span></a> <a href="#local_hash_1194"><span class="LIDENT">hash</span></a> <a href="#local_space_1195"><span class="LIDENT">space</span></a><span class="EOL">
</span>        <a href="#local_ign_1196"><span class="LIDENT">ign</span></a> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <a href="#local_padty_1197"><span class="LIDENT">padty</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_padty_1197"><span class="LIDENT">padty</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Left</span>  <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span><span class="EOL">
</span>          <a href="#local_invalid_format_without_1148"><span class="LIDENT">invalid_format_without</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="CHAR">'-'</span> <span class="STRING">&quot;padding&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_parse_after_padding_1200"><span class="LIDENT">parse_after_padding</span></a> <a href="#local_pct_ind_1188"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1192"><span class="LIDENT">minus</span></a> <a href="#local_plus_1193"><span class="LIDENT">plus</span></a> <a href="#local_hash_1194"><span class="LIDENT">hash</span></a> <a href="#local_space_1195"><span class="LIDENT">space</span></a> <a href="#local_ign_1196"><span class="LIDENT">ign</span></a><span class="EOL">
</span>          <span class="UIDENT">No_padding</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Zeros</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>         <span class="COMMENT">(* a '0' padding indication not followed by anything should
           be interpreted as a Right padding of width 0. This is used
           by scanning conversions %0s and %0c *)</span><span class="EOL">
</span>        <a href="#local_parse_after_padding_1200"><span class="LIDENT">parse_after_padding</span></a> <a href="#local_pct_ind_1188"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1192"><span class="LIDENT">minus</span></a> <a href="#local_plus_1193"><span class="LIDENT">plus</span></a> <a href="#local_hash_1194"><span class="LIDENT">hash</span></a> <a href="#local_space_1195"><span class="LIDENT">space</span></a> <a href="#local_ign_1196"><span class="LIDENT">ign</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Right</span><span class="COMMA">,</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Right</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_after_padding_1200"><span class="LIDENT">parse_after_padding</span></a> <a href="#local_pct_ind_1188"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1189"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1190"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1192"><span class="LIDENT">minus</span></a> <a href="#local_plus_1193"><span class="LIDENT">plus</span></a> <a href="#local_hash_1194"><span class="LIDENT">hash</span></a> <a href="#local_space_1195"><span class="LIDENT">space</span></a> <a href="#local_ign_1196"><span class="LIDENT">ign</span></a><span class="EOL">
</span>          <span class="UIDENT">No_padding</span><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Is precision defined? *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_after_padding_1200"><span class="LIDENT">parse_after_padding</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1201"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1202"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1203"><span class="LIDENT">end_ind</span></span> <span id="local_minus_1204"><span class="LIDENT">minus</span></span> <span id="local_plus_1205"><span class="LIDENT">plus</span></span> <span id="local_hash_1206"><span class="LIDENT">hash</span></span> <span id="local_space_1207"><span class="LIDENT">space</span></span> <span id="local_ign_1208"><span class="LIDENT">ign</span></span> <span id="local_pad_1209"><span class="LIDENT">pad</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1202"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1203"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1203"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1202"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_parse_precision_1211"><span class="LIDENT">parse_precision</span></a> <a href="#local_pct_ind_1201"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1202"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1203"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1204"><span class="LIDENT">minus</span></a> <a href="#local_plus_1205"><span class="LIDENT">plus</span></a> <a href="#local_hash_1206"><span class="LIDENT">hash</span></a> <a href="#local_space_1207"><span class="LIDENT">space</span></a> <a href="#local_ign_1208"><span class="LIDENT">ign</span></a><span class="EOL">
</span>        <a href="#local_pad_1209"><span class="LIDENT">pad</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_symb_1210"><span class="LIDENT">symb</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_parse_conversion_1243"><span class="LIDENT">parse_conversion</span></a> <a href="#local_pct_ind_1201"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1202"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1203"><span class="LIDENT">end_ind</span></a> <a href="#local_plus_1205"><span class="LIDENT">plus</span></a> <a href="#local_hash_1206"><span class="LIDENT">hash</span></a> <a href="#local_space_1207"><span class="LIDENT">space</span></a> <a href="#local_ign_1208"><span class="LIDENT">ign</span></a> <a href="#local_pad_1209"><span class="LIDENT">pad</span></a><span class="EOL">
</span>        <span class="UIDENT">No_precision</span> <a href="#local_pad_1209"><span class="LIDENT">pad</span></a> <a href="#local_symb_1210"><span class="LIDENT">symb</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Read the digital or '*' precision. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_precision_1211"><span class="LIDENT">parse_precision</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1212"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1213"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1214"><span class="LIDENT">end_ind</span></span> <span id="local_minus_1215"><span class="LIDENT">minus</span></span> <span id="local_plus_1216"><span class="LIDENT">plus</span></span> <span id="local_hash_1217"><span class="LIDENT">hash</span></span> <span id="local_space_1218"><span class="LIDENT">space</span></span> <span id="local_ign_1219"><span class="LIDENT">ign</span></span> <span id="local_pad_1220"><span class="LIDENT">pad</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1214"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1214"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_parse_literal_1221"><span class="LIDENT">parse_literal</span></span> <span id="local_minus_1222"><span class="LIDENT">minus</span></span> <span id="local_str_ind_1223"><span class="LIDENT">str_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1525"><span id="local_new_ind_1224"><span class="LIDENT">new_ind</span></span><span class="COMMA">,</span> <span id="local_prec_1225"><span class="LIDENT">prec</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_positive_1461"><span class="LIDENT">parse_positive</span></a> <a href="#local_str_ind_1223"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1214"><span class="LIDENT">end_ind</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_parse_after_precision_1227"><span class="LIDENT">parse_after_precision</span></a> <a href="#local_pct_ind_1212"><span class="LIDENT">pct_ind</span></a> <a href="#local_new_ind_1224"><span class="LIDENT">new_ind</span></a> <a href="#local_end_ind_1214"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1222"><span class="LIDENT">minus</span></a> <a href="#local_plus_1216"><span class="LIDENT">plus</span></a> <a href="#local_hash_1217"><span class="LIDENT">hash</span></a> <a href="#local_space_1218"><span class="LIDENT">space</span></a> <a href="#local_ign_1219"><span class="LIDENT">ign</span></a><span class="EOL">
</span>        <a href="#local_pad_1220"><span class="LIDENT">pad</span></a> <span class="LPAREN">(</span><span class="UIDENT">Lit_precision</span> <a href="#local_prec_1225"><span class="LIDENT">prec</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_literal_1221"><span class="LIDENT">parse_literal</span></a> <a href="#local_minus_1215"><span class="LIDENT">minus</span></a> <a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'+'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_symb_1226"><span class="LIDENT">symb</span></span> <span class="WHEN">when</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="COMMENT">(* Legacy mode would accept and ignore '+' or '-' before the
         integer describing the desired precision; note that this
         cannot happen for padding width, as '+' and '-' already have
         a semantics there.

         That said, the idea (supported by this tweak) that width and
         precision literals are &quot;integer literals&quot; in the OCaml sense is
         still blatantly wrong, as 123_456 or 0xFF are rejected. *)</span><span class="EOL">
</span>      <a href="#local_parse_literal_1221"><span class="LIDENT">parse_literal</span></a> <span class="LPAREN">(</span><a href="#local_minus_1215"><span class="LIDENT">minus</span></a> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_symb_1226"><span class="LIDENT">symb</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'-'</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'*'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_parse_after_precision_1227"><span class="LIDENT">parse_after_precision</span></a> <a href="#local_pct_ind_1212"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1214"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1215"><span class="LIDENT">minus</span></a> <a href="#local_plus_1216"><span class="LIDENT">plus</span></a> <a href="#local_hash_1217"><span class="LIDENT">hash</span></a> <a href="#local_space_1218"><span class="LIDENT">space</span></a><span class="EOL">
</span>        <a href="#local_ign_1219"><span class="LIDENT">ign</span></a> <a href="#local_pad_1220"><span class="LIDENT">pad</span></a> <span class="UIDENT">Arg_precision</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="COMMENT">(* note that legacy implementation did not ignore '.' without
           a number (as it does for padding indications), but
           interprets it as '.0' *)</span><span class="EOL">
</span>        <a href="#local_parse_after_precision_1227"><span class="LIDENT">parse_after_precision</span></a> <a href="#local_pct_ind_1212"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1214"><span class="LIDENT">end_ind</span></a> <a href="#local_minus_1215"><span class="LIDENT">minus</span></a> <a href="#local_plus_1216"><span class="LIDENT">plus</span></a> <a href="#local_hash_1217"><span class="LIDENT">hash</span></a> <a href="#local_space_1218"><span class="LIDENT">space</span></a> <a href="#local_ign_1219"><span class="LIDENT">ign</span></a><span class="EOL">
</span>          <a href="#local_pad_1220"><span class="LIDENT">pad</span></a> <span class="LPAREN">(</span><span class="UIDENT">Lit_precision</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <a href="#local_invalid_format_without_1148"><span class="LIDENT">invalid_format_without</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1213"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="CHAR">'.'</span> <span class="STRING">&quot;precision&quot;</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Try to read the conversion. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_after_precision_1227"><span class="LIDENT">parse_after_precision</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">t</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">z</span><span class="COMMA">,</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1228"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1229"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1230"><span class="LIDENT">end_ind</span></span> <span id="local_minus_1231"><span class="LIDENT">minus</span></span> <span id="local_plus_1232"><span class="LIDENT">plus</span></span> <span id="local_hash_1233"><span class="LIDENT">hash</span></span> <span id="local_space_1234"><span class="LIDENT">space</span></span> <span id="local_ign_1235"><span class="LIDENT">ign</span></span> <span id="local_pad_1236"><span class="LIDENT">pad</span></span> <span id="local_prec_1237"><span class="LIDENT">prec</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1229"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1230"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1230"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_parse_conv_1238"><span class="LIDENT">parse_conv</span></span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">u</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_padprec_1239"><span class="LIDENT">padprec</span></span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">u</span><span class="COMMA">,</span> <span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_parse_conversion_1243"><span class="LIDENT">parse_conversion</span></a> <a href="#local_pct_ind_1228"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1229"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1230"><span class="LIDENT">end_ind</span></a> <a href="#local_plus_1232"><span class="LIDENT">plus</span></a> <a href="#local_hash_1233"><span class="LIDENT">hash</span></a> <a href="#local_space_1234"><span class="LIDENT">space</span></a> <a href="#local_ign_1235"><span class="LIDENT">ign</span></a> <a href="#local_pad_1236"><span class="LIDENT">pad</span></a><span class="EOL">
</span>        <a href="#local_prec_1237"><span class="LIDENT">prec</span></a> <a href="#local_padprec_1239"><span class="LIDENT">padprec</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1229"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* in legacy mode, some formats (%s and %S) accept a weird mix of
       padding and precision, which is merged as a single padding
       information. For example, in %.10s the precision is implicitly
       understood as padding %10s, but the left-padding component may
       be specified either as a left padding or a negative precision:
       %-.3s and %.-3s are equivalent to %-3s *)</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_pad_1236"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">No_padding</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_minus_1231"><span class="LIDENT">minus</span></a><span class="COMMA">,</span> <a href="#local_prec_1237"><span class="LIDENT">prec</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_conv_1238"><span class="LIDENT">parse_conv</span></a> <span class="UIDENT">No_padding</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_n_1240"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_conv_1238"><span class="LIDENT">parse_conv</span></a> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Right</span><span class="COMMA">,</span> <a href="#local_n_1240"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UIDENT">Lit_precision</span> <span id="local_n_1241"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_conv_1238"><span class="LIDENT">parse_conv</span></a> <span class="LPAREN">(</span><span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Left</span><span class="COMMA">,</span> <a href="#local_n_1241"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_conv_1238"><span class="LIDENT">parse_conv</span></a> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <span class="UIDENT">Right</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UIDENT">Arg_precision</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_conv_1238"><span class="LIDENT">parse_conv</span></a> <span class="LPAREN">(</span><span class="UIDENT">Arg_padding</span> <span class="UIDENT">Left</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_pad_1242"><span class="LIDENT">pad</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_conv_1238"><span class="LIDENT">parse_conv</span></a> <a href="#local_pad_1242"><span class="LIDENT">pad</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Case analysis on conversion. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_conversion_1243"><span class="LIDENT">parse_conversion</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">x</span> <span class="LIDENT">y</span> <span class="LIDENT">z</span> <span class="LIDENT">t</span> <span class="LIDENT">u</span> <span class="LIDENT">v</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span> <span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="camlinternalFormatBasics.ml.html#type-precision"><span class="LPAREN">(</span><span class="LIDENT">z</span><span class="COMMA">,</span> <span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">precision</span></a> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">u</span><span class="COMMA">,</span> <span class="LIDENT">v</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_pct_ind_1244"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1245"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1246"><span class="LIDENT">end_ind</span></span> <span id="local_plus_1247"><span class="LIDENT">plus</span></span> <span id="local_hash_1248"><span class="LIDENT">hash</span></span> <span id="local_space_1249"><span class="LIDENT">space</span></span> <span id="local_ign_1250"><span class="LIDENT">ign</span></span> <span id="local_pad_1251"><span class="LIDENT">pad</span></span> <span id="local_prec_1252"><span class="LIDENT">prec</span></span> <span id="local_padprec_1253"><span class="LIDENT">padprec</span></span> <span id="local_symb_1254"><span class="LIDENT">symb</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="COMMENT">(* Flags used to check option usages/compatibilities. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_plus_used_1255"><span class="LIDENT">plus_used</span></span>  <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="AND">and</span> <span id="local_hash_used_1256"><span class="LIDENT">hash_used</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_space_used_1257"><span class="LIDENT">space_used</span></span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="AND">and</span> <span id="local_ign_used_1258"><span class="LIDENT">ign_used</span></span>   <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_pad_used_1259"><span class="LIDENT">pad_used</span></span>   <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="AND">and</span> <span id="local_prec_used_1260"><span class="LIDENT">prec_used</span></span>  <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-ref"><span class="LIDENT">ref</span></a> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Access to options, update flags. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_plus_1261"><span class="LIDENT">get_plus</span></span>    <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_plus_used_1255"><span class="LIDENT">plus_used</span></a>  <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_plus_1247"><span class="LIDENT">plus</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_get_hash_1262"><span class="LIDENT">get_hash</span></span>   <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_hash_used_1256"><span class="LIDENT">hash_used</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_hash_1248"><span class="LIDENT">hash</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_get_space_1263"><span class="LIDENT">get_space</span></span>   <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_space_used_1257"><span class="LIDENT">space_used</span></a> <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_space_1249"><span class="LIDENT">space</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_get_ign_1264"><span class="LIDENT">get_ign</span></span>     <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_ign_used_1258"><span class="LIDENT">ign_used</span></a>   <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_ign_1250"><span class="LIDENT">ign</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_get_pad_1265"><span class="LIDENT">get_pad</span></span>     <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_pad_used_1259"><span class="LIDENT">pad_used</span></a>   <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_pad_1251"><span class="LIDENT">pad</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_get_prec_1266"><span class="LIDENT">get_prec</span></span>    <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_prec_used_1260"><span class="LIDENT">prec_used</span></a>  <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_prec_1252"><span class="LIDENT">prec</span></a><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_get_padprec_1267"><span class="LIDENT">get_padprec</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <a href="#local_pad_used_1259"><span class="LIDENT">pad_used</span></a>   <a href="stdlib.ml.html#val-(:=)"><span class="COLONEQUAL">:=</span></a> <span class="TRUE">true</span><span class="SEMI">;</span> <a href="#local_padprec_1253"><span class="LIDENT">padprec</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_int_pad_1268"><span class="LIDENT">get_int_pad</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">x</span><span class="COMMA">,</span><span class="LIDENT">y</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="COMMENT">(* %5.3d is accepted and meaningful: pad to length 5 with
         spaces, but first pad with zeros upto length 3 (0-padding
         is the interpretation of &quot;precision&quot; for integer formats).

         %05.3d is redundant: pad to length 5 *with zeros*, but
         first pad with zeros... To add insult to the injury, the
         legacy implementation ignores the 0-padding indication and
         does the 5 padding with spaces instead. We reuse this
         interpretation for compatibility, but statically reject this
         format when the legacy mode is disabled, to protect strict
         users from this corner case. *)</span><span class="EOL">
</span>       <span class="MATCH">match</span> <a href="#local_get_pad_1265"><span class="LIDENT">get_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>         <span class="BAR">|</span> <span id="local_pad_1269"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UIDENT">No_precision</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pad_1269"><span class="LIDENT">pad</span></a><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">No_padding</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span>     <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">No_padding</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Zeros</span><span class="COMMA">,</span> <span id="local_n_1270"><span class="LIDENT">n</span></span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Right</span><span class="COMMA">,</span> <a href="#local_n_1270"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>           <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <span class="CHAR">'0'</span> <span class="STRING">&quot;precision&quot;</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UIDENT">Zeros</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Arg_padding</span> <span class="UIDENT">Right</span><span class="EOL">
</span>           <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <span class="CHAR">'0'</span> <span class="STRING">&quot;precision&quot;</span><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_pad_1271"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pad_1271"><span class="LIDENT">pad</span></a><span class="EOL">
</span>         <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_pad_1272"><span class="LIDENT">pad</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pad_1272"><span class="LIDENT">pad</span></a> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Check that padty &lt;&gt; Zeros. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_check_no_0_1273"><span class="LIDENT">check_no_0</span></span> <span id="local_symb_1274"><span class="LIDENT">symb</span></span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_pad_1275"><span class="LIDENT">pad</span></span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a><span class="RPAREN">)</span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_pad_1275"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">No_padding</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pad_1275"><span class="LIDENT">pad</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><span class="UIDENT">Left</span> <span class="BAR">|</span> <span class="UIDENT">Right</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pad_1275"><span class="LIDENT">pad</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Left</span> <span class="BAR">|</span> <span class="UIDENT">Right</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_pad_1275"><span class="LIDENT">pad</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Zeros</span><span class="COMMA">,</span> <span id="local_width_1276"><span class="LIDENT">width</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Right</span><span class="COMMA">,</span> <a href="#local_width_1276"><span class="LIDENT">width</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1274"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;0&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UIDENT">Zeros</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Arg_padding</span> <span class="UIDENT">Right</span><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1274"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;0&quot;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Get padding as a pad_option (see &quot;%_&quot;, &quot;%{&quot;, &quot;%(&quot; and &quot;%[&quot;).
       (no need for legacy mode tweaking, those were rejected by the
       legacy parser as well) *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_opt_of_pad_1277"><span class="LIDENT">opt_of_pad</span></span> <span id="local_c_1278"><span class="LIDENT">c</span></span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">a</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="TYPE">type</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span id="local_pad_1279"><span class="LIDENT">pad</span></span> <span class="COLON">:</span> <a href="camlinternalFormatBasics.ml.html#type-padding"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">padding</span></a><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_pad_1279"><span class="LIDENT">pad</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">No_padding</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Right</span><span class="COMMA">,</span> <span id="local_width_1280"><span class="LIDENT">width</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_width_1280"><span class="LIDENT">width</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Zeros</span><span class="COMMA">,</span> <span id="local_width_1281"><span class="LIDENT">width</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Some</span> <a href="#local_width_1281"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_c_1278"><span class="LIDENT">c</span></a> <span class="STRING">&quot;'0'&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Lit_padding</span> <span class="LPAREN">(</span><span class="UIDENT">Left</span><span class="COMMA">,</span> <span id="local_width_1282"><span class="LIDENT">width</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Some</span> <a href="#local_width_1282"><span class="LIDENT">width</span></a><span class="EOL">
</span>        <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_c_1278"><span class="LIDENT">c</span></a> <span class="STRING">&quot;'-'&quot;</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Arg_padding</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_c_1278"><span class="LIDENT">c</span></a> <span class="STRING">&quot;'*'&quot;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></span> <span id="local_c_1284"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_opt_of_pad_1277"><span class="LIDENT">opt_of_pad</span></a> <a href="#local_c_1284"><span class="LIDENT">c</span></a> <span class="LPAREN">(</span><a href="#local_get_pad_1265"><span class="LIDENT">get_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_padprec_opt_1285"><span class="LIDENT">get_padprec_opt</span></span> <span id="local_c_1286"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_opt_of_pad_1277"><span class="LIDENT">opt_of_pad</span></a> <a href="#local_c_1286"><span class="LIDENT">c</span></a> <span class="LPAREN">(</span><a href="#local_get_padprec_1267"><span class="LIDENT">get_padprec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Get precision as a prec_option (see &quot;%_f&quot;).
       (no need for legacy mode tweaking, those were rejected by the
       legacy parser as well) *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_get_prec_opt_1287"><span class="LIDENT">get_prec_opt</span></span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">No_precision</span>       <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Lit_precision</span> <span id="local_ndec_1288"><span class="LIDENT">ndec</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <a href="#local_ndec_1288"><span class="LIDENT">ndec</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Arg_precision</span>      <span class="MINUSGREATER">-&gt;</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <span class="CHAR">'_'</span> <span class="STRING">&quot;'*'&quot;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_fmt_result_1289"><span class="LIDENT">fmt_result</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">','</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'c'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_char_format_1290"><span class="LIDENT">char_format</span></span> <span id="local_fmt_rest_1291"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <span class="COMMENT">(* %c *)</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_char</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1291"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char</span> <a href="#local_fmt_rest_1291"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_scan_format_1292"><span class="LIDENT">scan_format</span></span> <span id="local_fmt_rest_1293"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <span class="COMMENT">(* %0c *)</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="THEN">then</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_scan_next_char</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1293"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="ELSE">else</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_next_char</span> <a href="#local_fmt_rest_1293"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1294"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'c'</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_char_format_1290"><span class="LIDENT">char_format</span></a> <a href="#local_fmt_rest_1294"><span class="LIDENT">fmt_rest</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="INT">0</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_scan_format_1292"><span class="LIDENT">scan_format</span></a> <a href="#local_fmt_rest_1294"><span class="LIDENT">fmt_rest</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local__n_1295"><span class="LIDENT">_n</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>           <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a><span class="EOL">
</span>           <span class="THEN">then</span> <a href="#local_invalid_nonnull_char_width_1146"><span class="LIDENT">invalid_nonnull_char_width</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>           <span class="ELSE">else</span> <span class="COMMENT">(* legacy ignores %c widths *)</span> <a href="#local_char_format_1290"><span class="LIDENT">char_format</span></a> <a href="#local_fmt_rest_1294"><span class="LIDENT">fmt_rest</span></a><span class="EOL">
</span>      <span class="END">end</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'C'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1296"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_caml_char</span><span class="COMMA">,</span><a href="#local_fmt_rest_1296"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Caml_char</span> <a href="#local_fmt_rest_1296"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'s'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_pad_1297"><span class="LIDENT">pad</span></span> <span class="EQUAL">=</span> <a href="#local_check_no_0_1273"><span class="LIDENT">check_no_0</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="LPAREN">(</span><a href="#local_get_padprec_1267"><span class="LIDENT">get_padprec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1298"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1299"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_string</span> <span class="LPAREN">(</span><a href="#local_get_padprec_opt_1285"><span class="LIDENT">get_padprec_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1299"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1298"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padding_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1300"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1301"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padding_fmt_ebb</span> <a href="#local_pad_1297"><span class="LIDENT">pad</span></a> <a href="#local_fmt_rest_1298"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">String</span> <span class="LPAREN">(</span><a href="#local_pad'_1300"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1301"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'S'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_pad_1302"><span class="LIDENT">pad</span></span> <span class="EQUAL">=</span> <a href="#local_check_no_0_1273"><span class="LIDENT">check_no_0</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="LPAREN">(</span><a href="#local_get_padprec_1267"><span class="LIDENT">get_padprec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1303"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1304"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_caml_string</span> <span class="LPAREN">(</span><a href="#local_get_padprec_opt_1285"><span class="LIDENT">get_padprec_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1304"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1303"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padding_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1305"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1306"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padding_fmt_ebb</span> <a href="#local_pad_1302"><span class="LIDENT">pad</span></a> <a href="#local_fmt_rest_1303"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Caml_string</span> <span class="LPAREN">(</span><a href="#local_pad'_1305"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1306"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'d'</span> <span class="BAR">|</span> <span class="CHAR">'i'</span> <span class="BAR">|</span> <span class="CHAR">'x'</span> <span class="BAR">|</span> <span class="CHAR">'X'</span> <span class="BAR">|</span> <span class="CHAR">'o'</span> <span class="BAR">|</span> <span class="CHAR">'u'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_iconv_1307"><span class="LIDENT">iconv</span></span> <span class="EQUAL">=</span> <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <span class="LPAREN">(</span><a href="#local_get_plus_1261"><span class="LIDENT">get_plus</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_hash_1262"><span class="LIDENT">get_hash</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_get_space_1263"><span class="LIDENT">get_space</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1308"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1309"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_int</span> <span class="LPAREN">(</span><a href="#local_iconv_1307"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1309"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1308"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1310"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_prec'_1311"><span class="LIDENT">prec'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1312"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padprec_fmt_ebb</span> <span class="LPAREN">(</span><a href="#local_get_int_pad_1268"><span class="LIDENT">get_int_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_rest_1308"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int</span> <span class="LPAREN">(</span><a href="#local_iconv_1307"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad'_1310"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_prec'_1311"><span class="LIDENT">prec'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1312"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'N'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1313"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_counter_1314"><span class="LIDENT">counter</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Token_counter</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1315"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_scan_get_counter</span> <a href="#local_counter_1314"><span class="LIDENT">counter</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1315"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1313"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><a href="#local_counter_1314"><span class="LIDENT">counter</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1313"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'l'</span> <span class="BAR">|</span> <span class="CHAR">'n'</span> <span class="BAR">|</span> <span class="CHAR">'L'</span> <span class="WHEN">when</span> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a><a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <span class="LPAREN">(</span><a href="#local_is_int_base_1486"><span class="LIDENT">is_int_base</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1316"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_counter_1317"><span class="LIDENT">counter</span></span> <span class="EQUAL">=</span> <a href="#local_counter_of_char_1488"><span class="LIDENT">counter_of_char</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1318"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_scan_get_counter</span> <a href="#local_counter_1317"><span class="LIDENT">counter</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1318"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1316"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_get_counter</span> <span class="LPAREN">(</span><a href="#local_counter_1317"><span class="LIDENT">counter</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1316"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'l'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_iconv_1319"><span class="LIDENT">iconv</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_plus_1261"><span class="LIDENT">get_plus</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_hash_1262"><span class="LIDENT">get_hash</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="#local_get_space_1263"><span class="LIDENT">get_space</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1320"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1321"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_int32</span> <span class="LPAREN">(</span><a href="#local_iconv_1319"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1321"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1320"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1322"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_prec'_1323"><span class="LIDENT">prec'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1324"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padprec_fmt_ebb</span> <span class="LPAREN">(</span><a href="#local_get_int_pad_1268"><span class="LIDENT">get_int_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_rest_1320"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int32</span> <span class="LPAREN">(</span><a href="#local_iconv_1319"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad'_1322"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_prec'_1323"><span class="LIDENT">prec'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1324"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'n'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_iconv_1325"><span class="LIDENT">iconv</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_plus_1261"><span class="LIDENT">get_plus</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="#local_get_hash_1262"><span class="LIDENT">get_hash</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_space_1263"><span class="LIDENT">get_space</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1326"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1327"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_nativeint</span> <span class="LPAREN">(</span><a href="#local_iconv_1325"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1327"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1326"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1328"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_prec'_1329"><span class="LIDENT">prec'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1330"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padprec_fmt_ebb</span> <span class="LPAREN">(</span><a href="#local_get_int_pad_1268"><span class="LIDENT">get_int_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_rest_1326"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Nativeint</span> <span class="LPAREN">(</span><a href="#local_iconv_1325"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad'_1328"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_prec'_1329"><span class="LIDENT">prec'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1330"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'L'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_iconv_1331"><span class="LIDENT">iconv</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_plus_1261"><span class="LIDENT">get_plus</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_hash_1262"><span class="LIDENT">get_hash</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="#local_get_space_1263"><span class="LIDENT">get_space</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1332"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1333"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_int64</span> <span class="LPAREN">(</span><a href="#local_iconv_1331"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1333"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1332"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1334"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_prec'_1335"><span class="LIDENT">prec'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1336"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padprec_fmt_ebb</span> <span class="LPAREN">(</span><a href="#local_get_int_pad_1268"><span class="LIDENT">get_int_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_rest_1332"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Int64</span> <span class="LPAREN">(</span><a href="#local_iconv_1331"><span class="LIDENT">iconv</span></a><span class="COMMA">,</span> <a href="#local_pad'_1334"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_prec'_1335"><span class="LIDENT">prec'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1336"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'f'</span> <span class="BAR">|</span> <span class="CHAR">'e'</span> <span class="BAR">|</span> <span class="CHAR">'E'</span> <span class="BAR">|</span> <span class="CHAR">'g'</span> <span class="BAR">|</span> <span class="CHAR">'G'</span> <span class="BAR">|</span> <span class="CHAR">'F'</span> <span class="BAR">|</span> <span class="CHAR">'h'</span> <span class="BAR">|</span> <span class="CHAR">'H'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_fconv_1337"><span class="LIDENT">fconv</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <a href="#local_compute_float_conv_1497"><span class="LIDENT">compute_float_conv</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><a href="#local_get_plus_1261"><span class="LIDENT">get_plus</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_hash_1262"><span class="LIDENT">get_hash</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_space_1263"><span class="LIDENT">get_space</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1338"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1339"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_float</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="COMMA">,</span> <a href="#local_get_prec_opt_1287"><span class="LIDENT">get_prec_opt</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1339"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1338"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padprec_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1340"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_prec'_1341"><span class="LIDENT">prec'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1342"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padprec_fmt_ebb</span> <span class="LPAREN">(</span><a href="#local_get_pad_1265"><span class="LIDENT">get_pad</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_get_prec_1266"><span class="LIDENT">get_prec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_fmt_rest_1338"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Float</span> <span class="LPAREN">(</span><a href="#local_fconv_1337"><span class="LIDENT">fconv</span></a><span class="COMMA">,</span> <a href="#local_pad'_1340"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_prec'_1341"><span class="LIDENT">prec'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1342"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'b'</span> <span class="BAR">|</span> <span class="CHAR">'B'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_pad_1343"><span class="LIDENT">pad</span></span> <span class="EQUAL">=</span> <a href="#local_check_no_0_1273"><span class="LIDENT">check_no_0</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="LPAREN">(</span><a href="#local_get_padprec_1267"><span class="LIDENT">get_padprec</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1344"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1345"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_bool</span> <span class="LPAREN">(</span><a href="#local_get_padprec_opt_1285"><span class="LIDENT">get_padprec_opt</span></a> <span class="CHAR">'_'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1345"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1344"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Padding_fmt_EBB</span> <span class="LPAREN">(</span><span id="local_pad'_1346"><span class="LIDENT">pad'</span></span><span class="COMMA">,</span> <span id="local_fmt_rest'_1347"><span class="LIDENT">fmt_rest'</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="LIDENT">make_padding_fmt_ebb</span> <a href="#local_pad_1343"><span class="LIDENT">pad</span></a> <a href="#local_fmt_rest_1344"><span class="LIDENT">fmt_rest</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Bool</span> <span class="LPAREN">(</span><a href="#local_pad'_1346"><span class="LIDENT">pad'</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest'_1347"><span class="LIDENT">fmt_rest'</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'a'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1348"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Alpha</span> <a href="#local_fmt_rest_1348"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'t'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1349"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Theta</span> <a href="#local_fmt_rest_1349"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'r'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1350"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_reader</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1350"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Reader</span> <a href="#local_fmt_rest_1350"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'!'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1351"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Flush</span> <a href="#local_fmt_rest_1351"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'%'</span> <span class="BAR">|</span> <span class="CHAR">'@'</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_c_1352"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1353"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><a href="#local_c_1352"><span class="LIDENT">c</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1353"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'{'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_sub_end_1354"><span class="LIDENT">sub_end</span></span> <span class="EQUAL">=</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="CHAR">'}'</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_sub_fmt_1355"><span class="LIDENT">sub_fmt</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_sub_end_1354"><span class="LIDENT">sub_end</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1356"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_sub_end_1354"><span class="LIDENT">sub_end</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_sub_fmtty_1357"><span class="LIDENT">sub_fmtty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_sub_fmt_1355"><span class="LIDENT">sub_fmt</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1358"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_format_arg</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="COMMA">,</span> <a href="#local_sub_fmtty_1357"><span class="LIDENT">sub_fmtty</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1358"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1356"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_arg</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'{'</span><span class="COMMA">,</span> <a href="#local_sub_fmtty_1357"><span class="LIDENT">sub_fmtty</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1356"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'('</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_sub_end_1359"><span class="LIDENT">sub_end</span></span> <span class="EQUAL">=</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="CHAR">')'</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1360"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_sub_end_1359"><span class="LIDENT">sub_end</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_sub_fmt_1361"><span class="LIDENT">sub_fmt</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_sub_end_1359"><span class="LIDENT">sub_end</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_sub_fmtty_1362"><span class="LIDENT">sub_fmtty</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmtty_of_fmt</span> <a href="#local_sub_fmt_1361"><span class="LIDENT">sub_fmt</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1363"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_format_subst</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="COMMA">,</span> <a href="#local_sub_fmtty_1362"><span class="LIDENT">sub_fmtty</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1363"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1360"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Format_subst</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'('</span><span class="COMMA">,</span> <a href="#local_sub_fmtty_1362"><span class="LIDENT">sub_fmtty</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1360"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'['</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="def_1541"><span id="local_next_ind_1364"><span class="LIDENT">next_ind</span></span><span class="COMMA">,</span> <span id="local_char_set_1365"><span class="LIDENT">char_set</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_char_set_1423"><span class="LIDENT">parse_char_set</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1366"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_next_ind_1364"><span class="LIDENT">next_ind</span></a> <a href="#local_end_ind_1246"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_get_ign_1264"><span class="LIDENT">get_ign</span></a> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ignored_1367"><span class="LIDENT">ignored</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ignored_scan_char_set</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'_'</span><span class="COMMA">,</span> <a href="#local_char_set_1365"><span class="LIDENT">char_set</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Ignored_param</span> <span class="LPAREN">(</span><a href="#local_ignored_1367"><span class="LIDENT">ignored</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1366"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_char_set</span> <span class="LPAREN">(</span><a href="#local_get_pad_opt_1283"><span class="LIDENT">get_pad_opt</span></a> <span class="CHAR">'['</span><span class="COMMA">,</span> <a href="#local_char_set_1365"><span class="LIDENT">char_set</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1366"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="BAR">|</span> <span class="CHAR">'+'</span> <span class="BAR">|</span> <span class="CHAR">'#'</span> <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="BAR">|</span> <span class="CHAR">'_'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">failwith_message</span><span class="EOL">
</span>        <span class="STRING">&quot;invalid format %S: at character number %d, \
         flag %C is only allowed after the '%%', before padding and precision&quot;</span><span class="EOL">
</span>        <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LIDENT">failwith_message</span><span class="EOL">
</span>        <span class="STRING">&quot;invalid format %S: at character number %d, \
         invalid conversion \&quot;%%%c\&quot;&quot;</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="COMMENT">(* Check for unused options, and reject them as incompatible.

       Such checks need to be disabled in legacy mode, as the legacy
       parser silently ignored incompatible flags. *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="BEGIN">begin</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_plus_used_1255"><span class="LIDENT">plus_used</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_plus_1247"><span class="LIDENT">plus</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;'+'&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_hash_used_1256"><span class="LIDENT">hash_used</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_hash_1248"><span class="LIDENT">hash</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;'#'&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_space_used_1257"><span class="LIDENT">space_used</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_space_1249"><span class="LIDENT">space</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;' '&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_pad_used_1259"><span class="LIDENT">pad_used</span></a>  <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="UIDENT">Padding_EBB</span> <a href="#local_pad_1251"><span class="LIDENT">pad</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Padding_EBB</span> <span class="UIDENT">No_padding</span> <span class="THEN">then</span><span class="EOL">
</span>      <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;`padding'&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_prec_used_1260"><span class="LIDENT">prec_used</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <span class="UIDENT">Precision_EBB</span> <a href="#local_prec_1252"><span class="LIDENT">prec</span></a> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="UIDENT">Precision_EBB</span> <span class="UIDENT">No_precision</span> <span class="THEN">then</span><span class="EOL">
</span>      <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_ign_1250"><span class="LIDENT">ign</span></a> <span class="THEN">then</span> <span class="CHAR">'_'</span> <span class="ELSE">else</span> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="STRING">&quot;`precision'&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_ign_1250"><span class="LIDENT">ign</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_plus_1247"><span class="LIDENT">plus</span></a> <span class="THEN">then</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <span class="CHAR">'_'</span> <span class="STRING">&quot;'+'&quot;</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="COMMENT">(* this last test must not be disabled in legacy mode,
       as ignoring it would typically result in a different typing
       than what the legacy parser used *)</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="stdlib.ml.html#val-not"><span class="LIDENT">not</span></a> <a href="stdlib.ml.html#val-(!)"><span class="BANG">!</span></a><a href="#local_ign_used_1258"><span class="LIDENT">ign_used</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_ign_1250"><span class="LIDENT">ign</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="COMMENT">(* argument-less formats can safely be ignored in legacy mode *)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'@'</span> <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="BAR">|</span> <span class="CHAR">'!'</span> <span class="BAR">|</span> <span class="CHAR">','</span><span class="RPAREN">)</span> <span class="WHEN">when</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1244"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1245"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1254"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;'_'&quot;</span><span class="EOL">
</span>      <span class="END">end</span><span class="SEMI">;</span><span class="EOL">
</span>    <a href="#local_fmt_result_1289"><span class="LIDENT">fmt_result</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Parse formatting information (after '@'). *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_after_at_1368"><span class="LIDENT">parse_after_at</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_str_ind_1369"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1370"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span class="CHAR">'@'</span><span class="COMMA">,</span> <span class="UIDENT">End_of_format</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="ELSE">else</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'['</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_tag_1383"><span class="LIDENT">parse_tag</span></a> <span class="FALSE">false</span> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">']'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1371"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Close_box</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1371"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'{'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_tag_1383"><span class="LIDENT">parse_tag</span></a> <span class="TRUE">true</span> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'}'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1372"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Close_tag</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1372"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">','</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1373"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Break</span> <span class="LPAREN">(</span><span class="STRING">&quot;@,&quot;</span><span class="COMMA">,</span> <span class="INT">0</span><span class="COMMA">,</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1373"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">' '</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1374"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Break</span> <span class="LPAREN">(</span><span class="STRING">&quot;@ &quot;</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1374"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">';'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_good_break_1396"><span class="LIDENT">parse_good_break</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'?'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1375"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">FFlush</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1375"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'\n'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1376"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Force_newline</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1376"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'.'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1377"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Flush_newline</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1377"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'&lt;'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_magic_size_1411"><span class="LIDENT">parse_magic_size</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'@'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1378"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Escaped_at</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1378"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="WHEN">when</span> <a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(&lt;)"><span class="LESS">&lt;</span></a> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <a href="stdlib.ml.html#val-(&amp;&amp;)"><span class="AMPERAMPER">&amp;&amp;</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1379"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Escaped_percent</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1379"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1380"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><span class="CHAR">'@'</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1380"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_1381"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1382"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1369"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1370"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_indic</span> <a href="#local_c_1381"><span class="LIDENT">c</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1382"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Try to read the optional &lt;name&gt; after &quot;@{&quot; or &quot;@[&quot;. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_tag_1383"><span class="LIDENT">parse_tag</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">bool</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_is_open_tag_1384"><span class="LIDENT">is_open_tag</span></span> <span id="local_str_ind_1385"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1386"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1386"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'&lt;'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_ind_1387"><span class="LIDENT">ind</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-index_from"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">index_from</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="CHAR">'&gt;'</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_ind_1387"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(&gt;=)"><span class="INFIXOP0">&gt;=</span></a> <a href="#local_end_ind_1386"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_sub_str_1388"><span class="LIDENT">sub_str</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a> <span class="LPAREN">(</span><a href="#local_ind_1387"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1389"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="LPAREN">(</span><a href="#local_ind_1387"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1386"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_sub_fmt_1390"><span class="LIDENT">sub_fmt</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a> <span class="LPAREN">(</span><a href="#local_ind_1387"><span class="LIDENT">ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_sub_format_1391"><span class="LIDENT">sub_format</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Format</span> <span class="LPAREN">(</span><a href="#local_sub_fmt_1390"><span class="LIDENT">sub_fmt</span></a><span class="COMMA">,</span> <a href="#local_sub_str_1388"><span class="LIDENT">sub_str</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_formatting_1392"><span class="LIDENT">formatting</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_is_open_tag_1384"><span class="LIDENT">is_open_tag</span></a> <span class="THEN">then</span> <span class="UIDENT">Open_tag</span> <a href="#local_sub_format_1391"><span class="LIDENT">sub_format</span></a> <span class="ELSE">else</span> <span class="UIDENT">Open_box</span> <a href="#local_sub_format_1391"><span class="LIDENT">sub_format</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><a href="#local_formatting_1392"><span class="LIDENT">formatting</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1389"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1393"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1385"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1386"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_sub_format_1394"><span class="LIDENT">sub_format</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Format</span> <span class="LPAREN">(</span><span class="UIDENT">End_of_format</span><span class="COMMA">,</span> <span class="STRING">&quot;&quot;</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_formatting_1395"><span class="LIDENT">formatting</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_is_open_tag_1384"><span class="LIDENT">is_open_tag</span></a> <span class="THEN">then</span> <span class="UIDENT">Open_tag</span> <a href="#local_sub_format_1394"><span class="LIDENT">sub_format</span></a> <span class="ELSE">else</span> <span class="UIDENT">Open_box</span> <a href="#local_sub_format_1394"><span class="LIDENT">sub_format</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_gen</span> <span class="LPAREN">(</span><a href="#local_formatting_1395"><span class="LIDENT">formatting</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1393"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Try to read the optional &lt;width offset&gt; after &quot;@;&quot;. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_good_break_1396"><span class="LIDENT">parse_good_break</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_str_ind_1397"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1398"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1546"><span id="local_next_ind_1399"><span class="LIDENT">next_ind</span></span><span class="COMMA">,</span> <span id="local_formatting_lit_1400"><span class="LIDENT">formatting_lit</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <a href="stdlib.ml.html#val-(||)"><span class="BARBAR">||</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="CHAR">'&lt;'</span> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="SEMI">;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_str_ind_1_1401"><span class="LIDENT">str_ind_1</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1_1401"><span class="LIDENT">str_ind_1</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_1527"><span id="local_str_ind_2_1402"><span class="LIDENT">str_ind_2</span></span><span class="COMMA">,</span> <span id="local_width_1403"><span class="LIDENT">width</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_integer_1467"><span class="LIDENT">parse_integer</span></a> <a href="#local_str_ind_1_1401"><span class="LIDENT">str_ind_1</span></a> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_str_ind_3_1404"><span class="LIDENT">str_ind_3</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></a> <a href="#local_str_ind_2_1402"><span class="LIDENT">str_ind_2</span></a> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>            <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_3_1404"><span class="LIDENT">str_ind_3</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="CHAR">'&gt;'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_s_1405"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a><a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a><span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_str_ind_3_1404"><span class="LIDENT">str_ind_3</span></a><a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a><a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                <a href="#local_str_ind_3_1404"><span class="LIDENT">str_ind_3</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="COMMA">,</span> <span class="UIDENT">Break</span> <span class="LPAREN">(</span><a href="#local_s_1405"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_width_1403"><span class="LIDENT">width</span></a><span class="COMMA">,</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="def_1545"><span id="local_str_ind_4_1406"><span class="LIDENT">str_ind_4</span></span><span class="COMMA">,</span> <span id="local_offset_1407"><span class="LIDENT">offset</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_integer_1467"><span class="LIDENT">parse_integer</span></a> <a href="#local_str_ind_3_1404"><span class="LIDENT">str_ind_3</span></a> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_str_ind_5_1408"><span class="LIDENT">str_ind_5</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></a> <a href="#local_str_ind_4_1406"><span class="LIDENT">str_ind_4</span></a> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>                <span class="IF">if</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_5_1408"><span class="LIDENT">str_ind_5</span></a><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="CHAR">'&gt;'</span> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="SEMI">;</span><span class="EOL">
</span>                <span class="LET">let</span> <span id="local_s_1409"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a><a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a><span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_str_ind_5_1408"><span class="LIDENT">str_ind_5</span></a><a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a><a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a><a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a><span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>                <a href="#local_str_ind_5_1408"><span class="LIDENT">str_ind_5</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="COMMA">,</span> <span class="UIDENT">Break</span> <span class="LPAREN">(</span><a href="#local_s_1409"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_width_1403"><span class="LIDENT">width</span></a><span class="COMMA">,</span> <a href="#local_offset_1407"><span class="LIDENT">offset</span></a><span class="RPAREN">)</span><span class="EOL">
</span>              <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="EOL">
</span>        <span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="BAR">|</span> <span class="UIDENT">Failure</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_str_ind_1397"><span class="LIDENT">str_ind</span></a><span class="COMMA">,</span> <span class="UIDENT">Break</span> <span class="LPAREN">(</span><span class="STRING">&quot;@;&quot;</span><span class="COMMA">,</span> <span class="INT">1</span><span class="COMMA">,</span> <span class="INT">0</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1410"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_next_ind_1399"><span class="LIDENT">next_ind</span></a> <a href="#local_end_ind_1398"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><a href="#local_formatting_lit_1400"><span class="LIDENT">formatting_lit</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1410"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Parse the size in a &lt;n&gt;. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_magic_size_1411"><span class="LIDENT">parse_magic_size</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_str_ind_1412"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1413"><span class="LIDENT">end_ind</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="MATCH">match</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_str_ind_1_1414"><span class="LIDENT">str_ind_1</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></a> <a href="#local_str_ind_1412"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1413"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1_1414"><span class="LIDENT">str_ind_1</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="def_1540"><span id="local_str_ind_2_1415"><span class="LIDENT">str_ind_2</span></span><span class="COMMA">,</span> <span id="local_size_1416"><span class="LIDENT">size</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_integer_1467"><span class="LIDENT">parse_integer</span></a> <a href="#local_str_ind_1_1414"><span class="LIDENT">str_ind_1</span></a> <a href="#local_end_ind_1413"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_str_ind_3_1417"><span class="LIDENT">str_ind_3</span></span> <span class="EQUAL">=</span> <a href="#local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></a> <a href="#local_str_ind_2_1415"><span class="LIDENT">str_ind_2</span></a> <a href="#local_end_ind_1413"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_3_1417"><span class="LIDENT">str_ind_3</span></a><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(&lt;&gt;)"><span class="INFIXOP0">&lt;&gt;</span></a> <span class="CHAR">'&gt;'</span> <span class="THEN">then</span> <a href="stdlib.ml.html#val-raise"><span class="LIDENT">raise</span></a> <span class="UIDENT">Not_found</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_s_1418"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1412"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_str_ind_3_1417"><span class="LIDENT">str_ind_3</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_str_ind_1412"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>          <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_str_ind_3_1417"><span class="LIDENT">str_ind_3</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="COMMA">,</span> <span class="UIDENT">Magic_size</span> <span class="LPAREN">(</span><a href="#local_s_1418"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_size_1416"><span class="LIDENT">size</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="BAR">|</span> <span class="UIDENT">Failure</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="UIDENT">None</span><span class="EOL">
</span>    <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span id="local_next_ind_1419"><span class="LIDENT">next_ind</span></span><span class="COMMA">,</span> <span id="local_formatting_lit_1420"><span class="LIDENT">formatting_lit</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1421"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_next_ind_1419"><span class="LIDENT">next_ind</span></a> <a href="#local_end_ind_1413"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><a href="#local_formatting_lit_1420"><span class="LIDENT">formatting_lit</span></a><span class="COMMA">,</span> <a href="#local_fmt_rest_1421"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_rest_1422"><span class="LIDENT">fmt_rest</span></span> <span class="EQUAL">=</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <a href="#local_str_ind_1412"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1413"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Formatting_lit</span> <span class="LPAREN">(</span><span class="UIDENT">Scan_indic</span> <span class="CHAR">'&lt;'</span><span class="COMMA">,</span> <a href="#local_fmt_rest_1422"><span class="LIDENT">fmt_rest</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Parse and construct a char set. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_char_set_1423"><span class="LIDENT">parse_char_set</span></span> <span id="local_str_ind_1424"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1425"><span class="LIDENT">end_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1424"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1425"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1425"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_char_set_1426"><span class="LIDENT">char_set</span></span> <span class="EQUAL">=</span> <span class="LIDENT">create_char_set</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_add_char_1427"><span class="LIDENT">add_char</span></span> <span id="local_c_1428"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">add_in_char_set</span> <a href="#local_char_set_1426"><span class="LIDENT">char_set</span></a> <a href="#local_c_1428"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_add_range_1429"><span class="LIDENT">add_range</span></span> <span id="local_c_1430"><span class="LIDENT">c</span></span> <span id="local_c'_1431"><span class="LIDENT">c'</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="FOR">for</span> <span class="LIDENT">i</span> <span class="EQUAL">=</span> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_1430"><span class="LIDENT">c</span></a> <span class="TO">to</span> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c'_1431"><span class="LIDENT">c'</span></a> <span class="DO">do</span><span class="EOL">
</span>        <span class="LIDENT">add_in_char_set</span> <a href="#local_char_set_1426"><span class="LIDENT">char_set</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-char_of_int"><span class="LIDENT">char_of_int</span></a> <span class="LIDENT">i</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="DONE">done</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_fail_single_percent_1432"><span class="LIDENT">fail_single_percent</span></span> <span id="local_str_ind_1433"><span class="LIDENT">str_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LIDENT">failwith_message</span><span class="EOL">
</span>        <span class="STRING">&quot;invalid format %S: '%%' alone is not accepted in character sets, \
         use %%%% instead at position %d.&quot;</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_str_ind_1433"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Parse the first character of a char set. *)</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="REC">rec</span> <span id="local_parse_char_set_start_1434"><span class="LIDENT">parse_char_set_start</span></span> <span id="local_str_ind_1435"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1436"><span class="LIDENT">end_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1435"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1436"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1436"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_c_1437"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1435"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#local_parse_char_set_after_char_1442"><span class="LIDENT">parse_char_set_after_char</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1435"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1436"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1437"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Parse the content of a char set until the first ']'. *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_parse_char_set_content_1438"><span class="LIDENT">parse_char_set_content</span></span> <span id="local_str_ind_1439"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1440"><span class="LIDENT">end_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1439"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1440"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1440"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1439"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">']'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_str_ind_1439"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_add_char_1427"><span class="LIDENT">add_char</span></a> <span class="CHAR">'-'</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_parse_char_set_content_1438"><span class="LIDENT">parse_char_set_content</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1439"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1440"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_1441"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_char_set_after_char_1442"><span class="LIDENT">parse_char_set_after_char</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1439"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1440"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1441"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Test for range in char set. *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_parse_char_set_after_char_1442"><span class="LIDENT">parse_char_set_after_char</span></span> <span id="local_str_ind_1443"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1444"><span class="LIDENT">end_ind</span></span> <span id="local_c_1445"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1444"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1444"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">']'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_add_char_1427"><span class="LIDENT">add_char</span></a> <a href="#local_c_1445"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_parse_char_set_after_minus_1448"><span class="LIDENT">parse_char_set_after_minus</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1444"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1445"><span class="LIDENT">c</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'%'</span> <span class="BAR">|</span> <span class="CHAR">'@'</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_c'_1446"><span class="LIDENT">c'</span></span> <span class="WHEN">when</span> <a href="#local_c_1445"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_add_char_1427"><span class="LIDENT">add_char</span></a> <a href="#local_c'_1446"><span class="LIDENT">c'</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_parse_char_set_content_1438"><span class="LIDENT">parse_char_set_content</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1444"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c'_1447"><span class="LIDENT">c'</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_c_1445"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">'%'</span> <span class="THEN">then</span> <a href="#local_fail_single_percent_1432"><span class="LIDENT">fail_single_percent</span></a> <a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="COMMENT">(* note that '@' alone is accepted, as done by the legacy
           implementation; the documentation specifically requires %@
           so we could warn on that *)</span><span class="EOL">
</span>        <a href="#local_add_char_1427"><span class="LIDENT">add_char</span></a> <a href="#local_c_1445"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_parse_char_set_after_char_1442"><span class="LIDENT">parse_char_set_after_char</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1443"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1444"><span class="LIDENT">end_ind</span></a> <a href="#local_c'_1447"><span class="LIDENT">c'</span></a><span class="EOL">
</span><span class="EOL">
</span>    <span class="COMMENT">(* Manage range in char set (except if the '-' the last char before ']') *)</span><span class="EOL">
</span>    <span class="AND">and</span> <span id="local_parse_char_set_after_minus_1448"><span class="LIDENT">parse_char_set_after_minus</span></span> <span id="local_str_ind_1449"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1450"><span class="LIDENT">end_ind</span></span> <span id="local_c_1451"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1450"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1450"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">']'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_add_char_1427"><span class="LIDENT">add_char</span></a> <a href="#local_c_1451"><span class="LIDENT">c</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_add_char_1427"><span class="LIDENT">add_char</span></a> <span class="CHAR">'-'</span><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="IF">if</span> <a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1450"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1450"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="LPAREN">(</span><span class="CHAR">'%'</span> <span class="BAR">|</span> <span class="CHAR">'@'</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_c'_1452"><span class="LIDENT">c'</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <a href="#local_add_range_1429"><span class="LIDENT">add_range</span></a> <a href="#local_c_1451"><span class="LIDENT">c</span></a> <a href="#local_c'_1452"><span class="LIDENT">c'</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <a href="#local_parse_char_set_content_1438"><span class="LIDENT">parse_char_set_content</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1450"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_fail_single_percent_1432"><span class="LIDENT">fail_single_percent</span></a> <a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c'_1453"><span class="LIDENT">c'</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_add_range_1429"><span class="LIDENT">add_range</span></a> <a href="#local_c_1451"><span class="LIDENT">c</span></a> <a href="#local_c'_1453"><span class="LIDENT">c'</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <a href="#local_parse_char_set_content_1438"><span class="LIDENT">parse_char_set_content</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1449"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1450"><span class="LIDENT">end_ind</span></a><span class="EOL">
</span>    <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="def_1519"><span id="local_str_ind_1454"><span class="LIDENT">str_ind</span></span><span class="COMMA">,</span> <span id="local_reverse_1455"><span class="LIDENT">reverse</span></span></span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1424"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1425"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1425"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1424"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'^'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_ind_1424"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_ind_1424"><span class="LIDENT">str_ind</span></a><span class="COMMA">,</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_next_ind_1456"><span class="LIDENT">next_ind</span></span> <span class="EQUAL">=</span> <a href="#local_parse_char_set_start_1434"><span class="LIDENT">parse_char_set_start</span></a> <a href="#local_str_ind_1454"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1425"><span class="LIDENT">end_ind</span></a> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_char_set_1457"><span class="LIDENT">char_set</span></span> <span class="EQUAL">=</span> <span class="LIDENT">freeze_char_set</span> <a href="#local_char_set_1426"><span class="LIDENT">char_set</span></a> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_next_ind_1456"><span class="LIDENT">next_ind</span></a><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="IF">if</span> <a href="#local_reverse_1455"><span class="LIDENT">reverse</span></a> <span class="THEN">then</span> <span class="LIDENT">rev_char_set</span> <a href="#local_char_set_1457"><span class="LIDENT">char_set</span></a> <span class="ELSE">else</span> <a href="#local_char_set_1457"><span class="LIDENT">char_set</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Consume all next spaces, raise an Failure if end_ind is reached. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></span> <span id="local_str_ind_1459"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1460"><span class="LIDENT">end_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1459"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1460"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1460"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1459"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <span class="CHAR">' '</span> <span class="THEN">then</span> <a href="#local_parse_spaces_1458"><span class="LIDENT">parse_spaces</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1459"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1460"><span class="LIDENT">end_ind</span></a> <span class="ELSE">else</span> <a href="#local_str_ind_1459"><span class="LIDENT">str_ind</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Read a positive integer from the string, raise a Failure if end_ind is
     reached. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_positive_1461"><span class="LIDENT">parse_positive</span></span> <span id="local_str_ind_1462"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1463"><span class="LIDENT">end_ind</span></span> <span id="local_acc_1464"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1462"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1463"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1463"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1462"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="AS">as</span> <span id="local_c_1465"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_new_acc_1466"><span class="LIDENT">new_acc</span></span> <span class="EQUAL">=</span> <a href="#local_acc_1464"><span class="LIDENT">acc</span></a> <a href="stdlib.ml.html#val-(*)"><span class="STAR">*</span></a> <span class="INT">10</span> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="LPAREN">(</span><a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <a href="#local_c_1465"><span class="LIDENT">c</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="stdlib.ml.html#val-int_of_char"><span class="LIDENT">int_of_char</span></a> <span class="CHAR">'0'</span><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_new_acc_1466"><span class="LIDENT">new_acc</span></a> <a href="stdlib.ml.html#val-(&gt;)"><span class="GREATER">&gt;</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="LIDENT">failwith_message</span><span class="EOL">
</span>          <span class="STRING">&quot;invalid format %S: integer %d is greater than the limit %d&quot;</span><span class="EOL">
</span>          <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_new_acc_1466"><span class="LIDENT">new_acc</span></a> <a href="sys.ml.html#val-max_string_length"><span class="UIDENT">Sys</span><span class="DOT">.</span><span class="LIDENT">max_string_length</span></a><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <a href="#local_parse_positive_1461"><span class="LIDENT">parse_positive</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1462"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1463"><span class="LIDENT">end_ind</span></a> <a href="#local_new_acc_1466"><span class="LIDENT">new_acc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_str_ind_1462"><span class="LIDENT">str_ind</span></a><span class="COMMA">,</span> <a href="#local_acc_1464"><span class="LIDENT">acc</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Read a positive or negative integer from the string, raise a Failure
     if end_ind is reached. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_parse_integer_1467"><span class="LIDENT">parse_integer</span></span> <span id="local_str_ind_1468"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1469"><span class="LIDENT">end_ind</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1469"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1469"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_parse_positive_1461"><span class="LIDENT">parse_positive</span></a> <a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a> <a href="#local_end_ind_1469"><span class="LIDENT">end_ind</span></a> <span class="INT">0</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'-'</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1469"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1469"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="CHAR">'0'</span> <span class="DOTDOT">..</span> <span class="CHAR">'9'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="def_1549"><span id="local_next_ind_1470"><span class="LIDENT">next_ind</span></span><span class="COMMA">,</span> <span id="local_n_1471"><span class="LIDENT">n</span></span></span> <span class="EQUAL">=</span> <a href="#local_parse_positive_1461"><span class="LIDENT">parse_positive</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1469"><span class="LIDENT">end_ind</span></a> <span class="INT">0</span> <span class="IN">in</span><span class="EOL">
</span>        <a href="#local_next_ind_1470"><span class="LIDENT">next_ind</span></a><span class="COMMA">,</span> <a href="stdlib.ml.html#val-(~-)"><span class="MINUS">-</span></a><a href="#local_n_1471"><span class="LIDENT">n</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_c_1472"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_expected_character_1152"><span class="LIDENT">expected_character</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1468"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="STRING">&quot;digit&quot;</span> <a href="#local_c_1472"><span class="LIDENT">c</span></a><span class="EOL">
</span>    <span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Add a literal to a format from a literal character sub-sequence. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_add_literal_1473"><span class="LIDENT">add_literal</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="LIDENT">d</span> <span class="LIDENT">e</span> <span class="LIDENT">f</span> <span class="DOT">.</span><span class="EOL">
</span>      <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <a href="camlinternalFormatBasics.ml.html#type-fmt"><span class="LPAREN">(</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">d</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt</span></a> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LIDENT">e</span><span class="COMMA">,</span> <span class="LIDENT">f</span><span class="RPAREN">)</span> <span class="LIDENT">fmt_ebb</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUN">fun</span> <span id="local_lit_start_1474"><span class="LIDENT">lit_start</span></span> <span id="local_str_ind_1475"><span class="LIDENT">str_ind</span></span> <span id="local_fmt_1476"><span class="LIDENT">fmt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="MATCH">match</span> <a href="#local_str_ind_1475"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_lit_start_1474"><span class="LIDENT">lit_start</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="INT">0</span>    <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Fmt_EBB</span> <a href="#local_fmt_1476"><span class="LIDENT">fmt</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="INT">1</span>    <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">Char_literal</span> <span class="LPAREN">(</span><a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_lit_start_1474"><span class="LIDENT">lit_start</span></a><span class="RBRACKET">]</span><span class="COMMA">,</span> <a href="#local_fmt_1476"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span id="local_size_1477"><span class="LIDENT">size</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Fmt_EBB</span> <span class="LPAREN">(</span><span class="UIDENT">String_literal</span> <span class="LPAREN">(</span><a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_lit_start_1474"><span class="LIDENT">lit_start</span></a> <a href="#local_size_1477"><span class="LIDENT">size</span></a><span class="COMMA">,</span> <a href="#local_fmt_1476"><span class="LIDENT">fmt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Search the end of the current sub-format
     (i.e. the corresponding &quot;%}&quot; or &quot;%)&quot;) *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></span> <span id="local_str_ind_1479"><span class="LIDENT">str_ind</span></span> <span id="local_end_ind_1480"><span class="LIDENT">end_ind</span></span> <span id="local_c_1481"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="IF">if</span> <a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span><span class="EOL">
</span>      <span class="LIDENT">failwith_message</span><span class="EOL">
</span>        <span class="STRING">&quot;invalid format %S: unclosed sub-format, \
         expected \&quot;%%%c\&quot; at character number %d&quot;</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'%'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a> <span class="THEN">then</span> <span class="COMMENT">(* End of format found *)</span> <a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <span class="ELSE">else</span><span class="EOL">
</span>        <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'_'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* Search for &quot;%_(&quot; or &quot;%_{&quot;. *)</span><span class="EOL">
</span>          <span class="IF">if</span> <a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span> <a href="stdlib.ml.html#val-(=)"><span class="EQUAL">=</span></a> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="THEN">then</span> <a href="#local_unexpected_end_of_format_1144"><span class="LIDENT">unexpected_end_of_format</span></a> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="BEGIN">begin</span> <span class="MATCH">match</span> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="DOT">.</span><span class="LBRACKET">[</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RBRACKET">]</span> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="CHAR">'{'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_sub_end_1482"><span class="LIDENT">sub_end</span></span> <span class="EQUAL">=</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="CHAR">'}'</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_sub_end_1482"><span class="LIDENT">sub_end</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="CHAR">'('</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="LET">let</span> <span id="local_sub_end_1483"><span class="LIDENT">sub_end</span></span> <span class="EQUAL">=</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="CHAR">')'</span> <span class="IN">in</span><span class="EOL">
</span>            <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_sub_end_1483"><span class="LIDENT">sub_end</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">3</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span>          <span class="END">end</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'{'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* %{...%} sub-format found. *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_sub_end_1484"><span class="LIDENT">sub_end</span></span> <span class="EQUAL">=</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="CHAR">'}'</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_sub_end_1484"><span class="LIDENT">sub_end</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'('</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* %(...%) sub-format found. *)</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_sub_end_1485"><span class="LIDENT">sub_end</span></span> <span class="EQUAL">=</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <span class="CHAR">')'</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_sub_end_1485"><span class="LIDENT">sub_end</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">'}'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* Error: %(...%}. *)</span><span class="EOL">
</span>          <a href="#local_expected_character_1152"><span class="LIDENT">expected_character</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="STRING">&quot;character ')'&quot;</span> <span class="CHAR">'}'</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="CHAR">')'</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* Error: %{...%). *)</span><span class="EOL">
</span>          <a href="#local_expected_character_1152"><span class="LIDENT">expected_character</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <span class="STRING">&quot;character '}'&quot;</span> <span class="CHAR">')'</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">2</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span>        <span class="END">end</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_search_subformat_end_1478"><span class="LIDENT">search_subformat_end</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1479"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(+)"><span class="PLUS">+</span></a> <span class="INT">1</span><span class="RPAREN">)</span> <a href="#local_end_ind_1480"><span class="LIDENT">end_ind</span></a> <a href="#local_c_1481"><span class="LIDENT">c</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Check if symb is a valid int conversion after &quot;%l&quot;, &quot;%n&quot; or &quot;%L&quot; *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_is_int_base_1486"><span class="LIDENT">is_int_base</span></span> <span id="local_symb_1487"><span class="LIDENT">symb</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_symb_1487"><span class="LIDENT">symb</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'d'</span> <span class="BAR">|</span> <span class="CHAR">'i'</span> <span class="BAR">|</span> <span class="CHAR">'x'</span> <span class="BAR">|</span> <span class="CHAR">'X'</span> <span class="BAR">|</span> <span class="CHAR">'o'</span> <span class="BAR">|</span> <span class="CHAR">'u'</span> <span class="MINUSGREATER">-&gt;</span> <span class="TRUE">true</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Convert a char (l, n or L) to its associated counter. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_counter_of_char_1488"><span class="LIDENT">counter_of_char</span></span> <span id="local_symb_1489"><span class="LIDENT">symb</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_symb_1489"><span class="LIDENT">symb</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'l'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Line_counter</span>  <span class="BAR">|</span> <span class="CHAR">'n'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Char_counter</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="CHAR">'L'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Token_counter</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Convert (plus, symb) to its associated int_conv. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></span> <span id="local_pct_ind_1491"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1492"><span class="LIDENT">str_ind</span></span> <span id="local_plus_1493"><span class="LIDENT">plus</span></span> <span id="local_hash_1494"><span class="LIDENT">hash</span></span> <span id="local_space_1495"><span class="LIDENT">space</span></span> <span id="local_symb_1496"><span class="LIDENT">symb</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_plus_1493"><span class="LIDENT">plus</span></a><span class="COMMA">,</span> <a href="#local_hash_1494"><span class="LIDENT">hash</span></a><span class="COMMA">,</span> <a href="#local_space_1495"><span class="LIDENT">space</span></a><span class="COMMA">,</span> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'d'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_d</span>  <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'i'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_i</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="CHAR">'d'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_sd</span> <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="CHAR">'i'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_si</span><span class="EOL">
</span>    <span class="BAR">|</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'d'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_pd</span> <span class="BAR">|</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'i'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_pi</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'x'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_x</span>  <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'X'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_X</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'x'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Cx</span> <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'X'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_CX</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'o'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_o</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'o'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Co</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'u'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_u</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'d'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Cd</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'i'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Ci</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'u'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Cu</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'x'</span> <span class="WHEN">when</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Cx</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'X'</span> <span class="WHEN">when</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_CX</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'o'</span> <span class="WHEN">when</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Int_Co</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="LPAREN">(</span><span class="CHAR">'d'</span> <span class="BAR">|</span> <span class="CHAR">'i'</span> <span class="BAR">|</span> <span class="CHAR">'u'</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="COMMENT">(* ignore *)</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <a href="#local_plus_1493"><span class="LIDENT">plus</span></a> <span class="FALSE">false</span> <a href="#local_space_1495"><span class="LIDENT">space</span></a> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;'#'&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span><span class="EOL">
</span>        <span class="COMMENT">(* plus and space: legacy implementation prefers plus *)</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <a href="#local_plus_1493"><span class="LIDENT">plus</span></a> <a href="#local_hash_1494"><span class="LIDENT">hash</span></a> <span class="FALSE">false</span> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <span class="CHAR">' '</span> <span class="STRING">&quot;'+'&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span>    <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="COMMENT">(* ignore *)</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <a href="#local_plus_1493"><span class="LIDENT">plus</span></a> <a href="#local_hash_1494"><span class="LIDENT">hash</span></a> <span class="FALSE">false</span> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;' '&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span>    <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="COMMENT">(* ignore *)</span><span class="EOL">
</span>        <a href="#local_compute_int_conv_1490"><span class="LIDENT">compute_int_conv</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <span class="FALSE">false</span> <a href="#local_hash_1494"><span class="LIDENT">hash</span></a> <a href="#local_space_1495"><span class="LIDENT">space</span></a> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1491"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1492"><span class="LIDENT">str_ind</span></a> <a href="#local_symb_1496"><span class="LIDENT">symb</span></a> <span class="STRING">&quot;'+'&quot;</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Convert (plus, space, symb) to its associated float_conv. *)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_compute_float_conv_1497"><span class="LIDENT">compute_float_conv</span></span> <span id="local_pct_ind_1498"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1499"><span class="LIDENT">str_ind</span></span> <span id="local_plus_1500"><span class="LIDENT">plus</span></span> <span id="local_hash_1501"><span class="LIDENT">hash</span></span> <span id="local_space_1502"><span class="LIDENT">space</span></span> <span id="local_symb_1503"><span class="LIDENT">symb</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_flag_1504"><span class="LIDENT">flag</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_plus_1500"><span class="LIDENT">plus</span></a><span class="COMMA">,</span> <a href="#local_space_1502"><span class="LIDENT">space</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_flag_</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span>  <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_flag_s</span><span class="EOL">
</span>    <span class="BAR">|</span>  <span class="TRUE">true</span><span class="COMMA">,</span> <span class="FALSE">false</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_flag_p</span><span class="EOL">
</span>    <span class="BAR">|</span>  <span class="TRUE">true</span><span class="COMMA">,</span>  <span class="TRUE">true</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="COMMENT">(* plus and space: legacy implementation prefers plus *)</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_legacy_behavior_1139"><span class="LIDENT">legacy_behavior</span></a> <span class="THEN">then</span> <span class="UIDENT">Float_flag_p</span><span class="EOL">
</span>      <span class="ELSE">else</span> <a href="#local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></a> <a href="#local_pct_ind_1498"><span class="LIDENT">pct_ind</span></a> <a href="#local_str_ind_1499"><span class="LIDENT">str_ind</span></a> <span class="CHAR">' '</span> <span class="STRING">&quot;'+'&quot;</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LET">let</span> <span id="local_kind_1505"><span class="LIDENT">kind</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_hash_1501"><span class="LIDENT">hash</span></a><span class="COMMA">,</span> <a href="#local_symb_1503"><span class="LIDENT">symb</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'f'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_f</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'e'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_e</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'E'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_E</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'g'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_g</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'G'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_G</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'h'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_h</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="CHAR">'H'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_H</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="FALSE">false</span><span class="COMMA">,</span> <span class="CHAR">'F'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_F</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="TRUE">true</span><span class="COMMA">,</span> <span class="CHAR">'F'</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Float_CF</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span> <span class="IN">in</span><span class="EOL">
</span>    <a href="#local_flag_1504"><span class="LIDENT">flag</span></a><span class="COMMA">,</span> <a href="#local_kind_1505"><span class="LIDENT">kind</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="COMMENT">(* Raise [Failure] with a friendly error message about incompatible options.*)</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_incompatible_flag_1506"><span class="LIDENT">incompatible_flag</span></span> <span class="COLON">:</span> <span class="TYPE">type</span> <span class="LIDENT">a</span> <span class="DOT">.</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">int</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">char</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">string</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">a</span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="FUN">fun</span> <span id="local_pct_ind_1507"><span class="LIDENT">pct_ind</span></span> <span id="local_str_ind_1508"><span class="LIDENT">str_ind</span></span> <span id="local_symb_1509"><span class="LIDENT">symb</span></span> <span id="local_option_1510"><span class="LIDENT">option</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_subfmt_1511"><span class="LIDENT">subfmt</span></span> <span class="EQUAL">=</span> <a href="string.ml.html#val-sub"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">sub</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_pct_ind_1507"><span class="LIDENT">pct_ind</span></a> <span class="LPAREN">(</span><a href="#local_str_ind_1508"><span class="LIDENT">str_ind</span></a> <a href="stdlib.ml.html#val-(-)"><span class="MINUS">-</span></a> <a href="#local_pct_ind_1507"><span class="LIDENT">pct_ind</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>      <span class="LIDENT">failwith_message</span><span class="EOL">
</span>        <span class="STRING">&quot;invalid format %S: at character number %d, \
         %s is incompatible with '%c' in sub-format %S&quot;</span><span class="EOL">
</span>        <a href="#local_str_1138"><span class="LIDENT">str</span></a> <a href="#local_pct_ind_1507"><span class="LIDENT">pct_ind</span></a> <a href="#local_option_1510"><span class="LIDENT">option</span></a> <a href="#local_symb_1509"><span class="LIDENT">symb</span></a> <a href="#local_subfmt_1511"><span class="LIDENT">subfmt</span></a><span class="EOL">
</span><span class="EOL">
</span>  <span class="IN">in</span> <a href="#local_parse_1156"><span class="LIDENT">parse</span></a> <span class="INT">0</span> <span class="LPAREN">(</span><a href="string.ml.html#val-length"><span class="UIDENT">String</span><span class="DOT">.</span><span class="LIDENT">length</span></a> <a href="#local_str_1138"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(******************************************************************************)</span><span class="EOL">
</span>                  <span class="COMMENT">(* Guarded string to format conversions *)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a string to a format according to an fmtty. *)</span><span class="EOL">
</span><span class="COMMENT">(* Raise [Failure] with an error message in case of type mismatch. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_string_fmtty"><span class="LIDENT">format_of_string_fmtty</span></span> <span id="local_str_1512"><span class="LIDENT">str</span></span> <span id="local_fmtty_1513"><span class="LIDENT">fmtty</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_1514"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmt_ebb_of_string</span> <a href="#local_str_1512"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="UIDENT">Format</span> <span class="LPAREN">(</span><span class="LIDENT">type_format</span> <a href="#local_fmt_1514"><span class="LIDENT">fmt</span></a> <a href="#local_fmtty_1513"><span class="LIDENT">fmtty</span></a><span class="COMMA">,</span> <a href="#local_str_1512"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="WITH">with</span> <span class="UIDENT">Type_mismatch</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">failwith_message</span><span class="EOL">
</span>      <span class="STRING">&quot;bad input: format type mismatch between %S and %S&quot;</span><span class="EOL">
</span>      <a href="#local_str_1512"><span class="LIDENT">str</span></a> <span class="LPAREN">(</span><span class="LIDENT">string_of_fmtty</span> <a href="#local_fmtty_1513"><span class="LIDENT">fmtty</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="COMMENT">(* Convert a string to a format compatible with an other format. *)</span><span class="EOL">
</span><span class="COMMENT">(* Raise [Failure] with an error message in case of type mismatch. *)</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-format_of_string_format"><span class="LIDENT">format_of_string_format</span></span> <span id="local_str_1515"><span class="LIDENT">str</span></span> <span class="LPAREN">(</span><span class="UIDENT">Format</span> <span class="LPAREN">(</span><span id="local_fmt'_1516"><span class="LIDENT">fmt'</span></span><span class="COMMA">,</span> <span id="local_str'_1517"><span class="LIDENT">str'</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="UIDENT">Fmt_EBB</span> <span id="local_fmt_1518"><span class="LIDENT">fmt</span></span> <span class="EQUAL">=</span> <span class="LIDENT">fmt_ebb_of_string</span> <a href="#local_str_1515"><span class="LIDENT">str</span></a> <span class="IN">in</span><span class="EOL">
</span>  <span class="TRY">try</span> <span class="UIDENT">Format</span> <span class="LPAREN">(</span><span class="LIDENT">type_format</span> <a href="#local_fmt_1518"><span class="LIDENT">fmt</span></a> <span class="LPAREN">(</span><span class="LIDENT">fmtty_of_fmt</span> <a href="#local_fmt'_1516"><span class="LIDENT">fmt'</span></a><span class="RPAREN">)</span><span class="COMMA">,</span> <a href="#local_str_1515"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="WITH">with</span> <span class="UIDENT">Type_mismatch</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LIDENT">failwith_message</span><span class="EOL">
</span>      <span class="STRING">&quot;bad input: format type mismatch between %S and %S&quot;</span> <a href="#local_str_1515"><span class="LIDENT">str</span></a> <a href="#local_str'_1517"><span class="LIDENT">str'</span></a><span class="EOL">
</span></span></code></pre></body></html>
